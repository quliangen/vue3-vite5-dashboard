import{e as t,r as e,g as n,B as r,f as i,K as o,d as a,o as s,j as u,k as c,a as l,w as h,L as f,x as p,n as d,y as m,M as v,O as g,P as y,Q as x,R as b,D as _,C as w,c as S,p as M,S as E,m as A,F as T,l as C,U as O,V as k,W as P,J as L,E as R,X as I,Y as N,Z as D,_ as F,z as j,A as B,q as z,$ as U,a0 as V,a1 as G,a2 as W,a3 as H,a4 as Y}from"./index-7c0464a8.js";import{r as X,s as q,t as Z,v as $,x as K,y as J,z as Q,A as tt,B as et,u as nt,d as rt,g as it,k as ot,_ as at,w as st,j as ut,e as ct,C as lt,m as ht,D as ft,F as pt,E as dt,G as mt,H as vt,I as gt,J as yt,K as xt,L as bt,M as _t,N as wt,O as St,P as Mt,i as Et,T as At,Q as Tt,R as Ct,S as Ot}from"./index-5483de15.js";const kt="object"==typeof global&&global&&global.Object===Object&&global;var Pt="object"==typeof self&&self&&self.Object===Object&&self;const Lt=kt||Pt||Function("return this")();const Rt=Lt.Symbol;var It=Object.prototype,Nt=It.hasOwnProperty,Dt=It.toString,Ft=Rt?Rt.toStringTag:void 0;var jt=Object.prototype.toString;var Bt=Rt?Rt.toStringTag:void 0;function zt(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":Bt&&Bt in Object(t)?function(t){var e=Nt.call(t,Ft),n=t[Ft];try{t[Ft]=void 0;var r=!0}catch(o){}var i=Dt.call(t);return r&&(e?t[Ft]=n:delete t[Ft]),i}(t):function(t){return jt.call(t)}(t)}function Ut(t){return"symbol"==typeof t||function(t){return null!=t&&"object"==typeof t}(t)&&"[object Symbol]"==zt(t)}const Vt=Array.isArray;var Gt=Rt?Rt.prototype:void 0,Wt=Gt?Gt.toString:void 0;function Ht(t){if("string"==typeof t)return t;if(Vt(t))return function(t,e){for(var n=-1,r=null==t?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}(t,Ht)+"";if(Ut(t))return Wt?Wt.call(t):"";var e=t+"";return"0"==e&&1/t==-Infinity?"-0":e}var Yt=/\s/;var Xt=/^\s+/;function qt(t){return t?t.slice(0,function(t){for(var e=t.length;e--&&Yt.test(t.charAt(e)););return e}(t)+1).replace(Xt,""):t}function Zt(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}var $t=/^[-+]0x[0-9a-f]+$/i,Kt=/^0b[01]+$/i,Jt=/^0o[0-7]+$/i,Qt=parseInt;function te(t){if("number"==typeof t)return t;if(Ut(t))return NaN;if(Zt(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=Zt(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=qt(t);var n=Kt.test(t);return n||Jt.test(t)?Qt(t.slice(2),n?2:8):$t.test(t)?NaN:+t}const ee=Lt["__core-js_shared__"];var ne,re=(ne=/[^.]+$/.exec(ee&&ee.keys&&ee.keys.IE_PROTO||""))?"Symbol(src)_1."+ne:"";var ie=Function.prototype.toString;var oe=/^\[object .+?Constructor\]$/,ae=Function.prototype,se=Object.prototype,ue=ae.toString,ce=se.hasOwnProperty,le=RegExp("^"+ue.call(ce).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function he(t){if(!Zt(t)||(e=t,re&&re in e))return!1;var e,n=function(t){if(!Zt(t))return!1;var e=zt(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}(t)?le:oe;return n.test(function(t){if(null!=t){try{return ie.call(t)}catch(e){}try{return t+""}catch(e){}}return""}(t))}function fe(t,e){var n=function(t,e){return null==t?void 0:t[e]}(t,e);return he(n)?n:void 0}var pe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,de=/^\w*$/;const me=fe(Object,"create");var ve=Object.prototype.hasOwnProperty;var ge=Object.prototype.hasOwnProperty;function ye(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function xe(t,e){for(var n,r,i=t.length;i--;)if((n=t[i][0])===(r=e)||n!=n&&r!=r)return i;return-1}ye.prototype.clear=function(){this.__data__=me?me(null):{},this.size=0},ye.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},ye.prototype.get=function(t){var e=this.__data__;if(me){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return ve.call(e,t)?e[t]:void 0},ye.prototype.has=function(t){var e=this.__data__;return me?void 0!==e[t]:ge.call(e,t)},ye.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=me&&void 0===e?"__lodash_hash_undefined__":e,this};var be=Array.prototype.splice;function _e(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}_e.prototype.clear=function(){this.__data__=[],this.size=0},_e.prototype.delete=function(t){var e=this.__data__,n=xe(e,t);return!(n<0)&&(n==e.length-1?e.pop():be.call(e,n,1),--this.size,!0)},_e.prototype.get=function(t){var e=this.__data__,n=xe(e,t);return n<0?void 0:e[n][1]},_e.prototype.has=function(t){return xe(this.__data__,t)>-1},_e.prototype.set=function(t,e){var n=this.__data__,r=xe(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this};const we=fe(Lt,"Map");function Se(t,e){var n,r,i=t.__data__;return("string"==(r=typeof(n=e))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof e?"string":"hash"]:i.map}function Me(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}Me.prototype.clear=function(){this.size=0,this.__data__={hash:new ye,map:new(we||_e),string:new ye}},Me.prototype.delete=function(t){var e=Se(this,t).delete(t);return this.size-=e?1:0,e},Me.prototype.get=function(t){return Se(this,t).get(t)},Me.prototype.has=function(t){return Se(this,t).has(t)},Me.prototype.set=function(t,e){var n=Se(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this};function Ee(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var n=function(){var r=arguments,i=e?e.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var a=t.apply(this,r);return n.cache=o.set(i,a)||o,a};return n.cache=new(Ee.Cache||Me),n}Ee.Cache=Me;var Ae,Te,Ce,Oe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ke=/\\(\\)?/g,Pe=(Ae=function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(Oe,(function(t,n,r,i){e.push(r?i.replace(ke,"$1"):n||t)})),e},Te=Ee(Ae,(function(t){return 500===Ce.size&&Ce.clear(),t})),Ce=Te.cache,Te);const Le=Pe;function Re(t,e){return Vt(t)?t:function(t,e){if(Vt(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!Ut(t))||de.test(t)||!pe.test(t)||null!=e&&t in Object(e)}(t,e)?[t]:Le(function(t){return null==t?"":Ht(t)}(t))}function Ie(t){if("string"==typeof t||Ut(t))return t;var e=t+"";return"0"==e&&1/t==-Infinity?"-0":e}function Ne(t,e,n){var r=null==t?void 0:function(t,e){for(var n=0,r=(e=Re(e,t)).length;null!=t&&n<r;)t=t[Ie(e[n++])];return n&&n==r?t:void 0}(t,e);return void 0===r?n:r}const De=function(){return Lt.Date.now()};var Fe=Math.max,je=Math.min;function Be(t,e,n){var r,i,o,a,s,u,c=0,l=!1,h=!1,f=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function p(e){var n=r,o=i;return r=i=void 0,c=e,a=t.apply(o,n)}function d(t){return c=t,s=setTimeout(v,e),l?p(t):a}function m(t){var n=t-u;return void 0===u||n>=e||n<0||h&&t-c>=o}function v(){var t=De();if(m(t))return g(t);s=setTimeout(v,function(t){var n=e-(t-u);return h?je(n,o-(t-c)):n}(t))}function g(t){return s=void 0,f&&r?p(t):(r=i=void 0,a)}function y(){var t=De(),n=m(t);if(r=arguments,i=this,u=t,n){if(void 0===s)return d(u);if(h)return clearTimeout(s),s=setTimeout(v,e),p(u)}return void 0===s&&(s=setTimeout(v,e)),a}return e=te(e)||0,Zt(n)&&(l=!!n.leading,o=(h="maxWait"in n)?Fe(te(n.maxWait)||0,e):o,f="trailing"in n?!!n.trailing:f),y.cancel=function(){void 0!==s&&clearTimeout(s),c=0,r=u=i=s=void 0},y.flush=function(){return void 0===s?a:g(De())},y}function ze(t,e,n){var r=!0,i=!0;if("function"!=typeof t)throw new TypeError("Expected a function");return Zt(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),Be(t,e,{leading:r,maxWait:e,trailing:i})}function Ue(t){var e;const n=$(t);return null!=(e=null==n?void 0:n.$el)?e:n}const Ve=K?window:void 0;function Ge(...e){let n,r,i,o;if(X(e[0])||Array.isArray(e[0])?([r,i,o]=e,n=Ve):[n,r,i,o]=e,!n)return q;Array.isArray(r)||(r=[r]),Array.isArray(i)||(i=[i]);const a=[],s=()=>{a.forEach((t=>t())),a.length=0},u=t((()=>Ue(n)),(t=>{s(),t&&a.push(...r.flatMap((e=>i.map((n=>((t,e,n)=>(t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)))(t,e,n))))))}),{immediate:!0,flush:"post"}),c=()=>{u(),s()};return Z(c),c}const We="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},He="__vueuse_ssr_handlers__";We[He]=We[He]||{},We[He];var Ye,Xe,qe=Object.getOwnPropertySymbols,Ze=Object.prototype.hasOwnProperty,$e=Object.prototype.propertyIsEnumerable;function Ke(n,r,i={}){const o=i,{window:a=Ve}=o,s=((t,e)=>{var n={};for(var r in t)Ze.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&qe)for(var r of qe(t))e.indexOf(r)<0&&$e.call(t,r)&&(n[r]=t[r]);return n})(o,["window"]);let u;const c=function(t,n=!1){const r=e(),i=()=>r.value=Boolean(t());return i(),J(i,n),r}((()=>a&&"ResizeObserver"in a)),l=()=>{u&&(u.disconnect(),u=void 0)},h=t((()=>Ue(n)),(t=>{l(),c.value&&a&&t&&(u=new ResizeObserver(r),u.observe(t,s))}),{immediate:!0,flush:"post"}),f=()=>{l(),h()};return Z(f),{isSupported:c,stop:f}}(Xe=Ye||(Ye={})).UP="UP",Xe.RIGHT="RIGHT",Xe.DOWN="DOWN",Xe.LEFT="LEFT",Xe.NONE="NONE";var Je=Object.defineProperty,Qe=Object.getOwnPropertySymbols,tn=Object.prototype.hasOwnProperty,en=Object.prototype.propertyIsEnumerable,nn=(t,e,n)=>e in t?Je(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;((t,e)=>{for(var n in e||(e={}))tn.call(e,n)&&nn(t,n,e[n]);if(Qe)for(var n of Qe(e))en.call(e,n)&&nn(t,n,e[n])})({linear:Q},{easeInSine:[.12,0,.39,0],easeOutSine:[.61,1,.88,1],easeInOutSine:[.37,0,.63,1],easeInQuad:[.11,0,.5,0],easeOutQuad:[.5,1,.89,1],easeInOutQuad:[.45,0,.55,1],easeInCubic:[.32,0,.67,0],easeOutCubic:[.33,1,.68,1],easeInOutCubic:[.65,0,.35,1],easeInQuart:[.5,0,.75,0],easeOutQuart:[.25,1,.5,1],easeInOutQuart:[.76,0,.24,1],easeInQuint:[.64,0,.78,0],easeOutQuint:[.22,1,.36,1],easeInOutQuint:[.83,0,.17,1],easeInExpo:[.7,0,.84,0],easeOutExpo:[.16,1,.3,1],easeInOutExpo:[.87,0,.13,1],easeInCirc:[.55,0,1,.45],easeOutCirc:[0,.55,.45,1],easeInOutCirc:[.85,0,.15,1],easeInBack:[.36,0,.66,-.56],easeOutBack:[.34,1.56,.64,1],easeInOutBack:[.68,-.6,.32,1.6]});const rn=(t,e)=>{if(!K)return!1;const n={undefined:"overflow",true:"overflow-y",false:"overflow-x"}[String(e)],r=tt(t,n);return["scroll","auto","overlay"].some((t=>r.includes(t)))},on="Space",an="ArrowLeft",sn="ArrowUp",un="ArrowRight",cn="ArrowDown",ln="Escape",hn=["class","style"],fn=/^on[A-Z]/;var pn={name:"en",el:{colorpicker:{confirm:"OK",clear:"Clear",defaultLabel:"color picker",description:"current color is {color}. press enter to select a new color."},datepicker:{now:"Now",today:"Today",cancel:"Cancel",clear:"Clear",confirm:"OK",dateTablePrompt:"Use the arrow keys and enter to select the day of the month",monthTablePrompt:"Use the arrow keys and enter to select the month",yearTablePrompt:"Use the arrow keys and enter to select the year",selectedDate:"Selected date",selectDate:"Select date",selectTime:"Select time",startDate:"Start Date",startTime:"Start Time",endDate:"End Date",endTime:"End Time",prevYear:"Previous Year",nextYear:"Next Year",prevMonth:"Previous Month",nextMonth:"Next Month",year:"",month1:"January",month2:"February",month3:"March",month4:"April",month5:"May",month6:"June",month7:"July",month8:"August",month9:"September",month10:"October",month11:"November",month12:"December",week:"week",weeks:{sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat"},weeksFull:{sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday"},months:{jan:"Jan",feb:"Feb",mar:"Mar",apr:"Apr",may:"May",jun:"Jun",jul:"Jul",aug:"Aug",sep:"Sep",oct:"Oct",nov:"Nov",dec:"Dec"}},inputNumber:{decrease:"decrease number",increase:"increase number"},select:{loading:"Loading",noMatch:"No matching data",noData:"No data",placeholder:"Select"},dropdown:{toggleDropdown:"Toggle Dropdown"},cascader:{noMatch:"No matching data",loading:"Loading",placeholder:"Select",noData:"No data"},pagination:{goto:"Go to",pagesize:"/page",total:"Total {total}",pageClassifier:"",deprecationWarning:"Deprecated usages detected, please refer to the el-pagination documentation for more details"},dialog:{close:"Close this dialog"},drawer:{close:"Close this dialog"},messagebox:{title:"Message",confirm:"OK",cancel:"Cancel",error:"Illegal input",close:"Close this dialog"},upload:{deleteTip:"press delete to remove",delete:"Delete",preview:"Preview",continue:"Continue"},slider:{defaultLabel:"slider between {min} and {max}",defaultRangeStartLabel:"pick start value",defaultRangeEndLabel:"pick end value"},table:{emptyText:"No Data",confirmFilter:"Confirm",resetFilter:"Reset",clearFilter:"All",sumText:"Sum"},tree:{emptyText:"No Data"},transfer:{noMatch:"No matching data",noData:"No data",titles:["List 1","List 2"],filterPlaceholder:"Enter keyword",noCheckedFormat:"{total} items",hasCheckedFormat:"{checked}/{total} checked"},image:{error:"FAILED"},pageHeader:{title:"Back"},popconfirm:{confirmButtonText:"Yes",cancelButtonText:"No"}}};const dn=t=>(e,n)=>mn(e,n,i(t)),mn=(t,e,n)=>Ne(n,t,t).replace(/\{(\w+)\}/g,((t,n)=>{var r;return`${null!=(r=null==e?void 0:e[n])?r:`{${n}}`}`})),vn=()=>{const t=nt("locale");return(t=>({lang:n((()=>i(t).name)),locale:o(t)?t:e(t),t:dn(t)}))(n((()=>t.value||pn)))},gn=e(0),yn=()=>{const t=nt("zIndex",2e3),e=n((()=>t.value+gn.value));return{initialZIndex:t,currentZIndex:e,nextZIndex:()=>(gn.value++,e.value)}},xn=rt({value:{type:[String,Number],default:""},max:{type:Number,default:99},isDot:Boolean,hidden:Boolean,type:{type:String,values:["primary","success","warning","info","danger"],default:"danger"}}),bn=["textContent"],_n=a({name:"ElBadge"});const wn=st(at(a({..._n,props:xn,setup(t,{expose:e}){const r=t,o=it("badge"),a=n((()=>r.isDot?"":ot(r.value)&&ot(r.max)&&r.max<r.value?`${r.max}+`:`${r.value}`));return e({content:a}),(t,e)=>(s(),u("div",{class:d(i(o).b())},[c(t.$slots,"default"),l(g,{name:`${i(o).namespace.value}-zoom-in-center`,persisted:""},{default:h((()=>[f(p("sup",{class:d([i(o).e("content"),i(o).em("content",t.type),i(o).is("fixed",!!t.$slots.default),i(o).is("dot",t.isDot)]),textContent:m(i(a))},null,10,bn),[[v,!t.hidden&&(i(a)||t.isDot)]])])),_:1},8,["name"])],2))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/badge/src/badge.vue"]])),Sn={};a({name:"ElConfigProvider",props:rt({a11y:{type:Boolean,default:!0},locale:{type:ut(Object)},size:ct,button:{type:ut(Object)},experimentalFeatures:{type:ut(Object)},keyboardNavigation:{type:Boolean,default:!0},message:{type:ut(Object)},zIndex:Number,namespace:{type:String,default:"el"}}),setup(e,{slots:n}){t((()=>e.message),(t=>{Object.assign(Sn,null!=t?t:{})}),{immediate:!0,deep:!0});const r=lt(e);return()=>c(n,"default",{config:null==r?void 0:r.value})}});const Mn=rt({urlList:{type:ut(Array),default:()=>ht([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:{type:Boolean,default:!1},teleported:{type:Boolean,default:!1},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2}}),En={close:()=>!0,switch:t=>ot(t)},An=["src"],Tn=a({name:"ElImageViewer"}),Cn=a({...Tn,props:Mn,emits:En,setup(r,{expose:o,emit:a}){const m=r,P={CONTAIN:{name:"contain",icon:y(ft)},ORIGINAL:{name:"original",icon:y(pt)}},L=K&&/firefox/i.test(window.navigator.userAgent)?"DOMMouseScroll":"mousewheel",{t:R}=vn(),I=it("image-viewer"),{nextZIndex:N}=yn(),D=e(),F=e([]),j=x(),B=e(!0),z=e(m.initialIndex),U=b(P.CONTAIN),V=e({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),G=n((()=>{const{urlList:t}=m;return t.length<=1})),W=n((()=>0===z.value)),H=n((()=>z.value===m.urlList.length-1)),Y=n((()=>m.urlList[z.value])),X=n((()=>{const{scale:t,deg:e,offsetX:n,offsetY:r,enableTransition:i}=V.value;let o=n/t,a=r/t;switch(e%360){case 90:case-270:[o,a]=[a,-o];break;case 180:case-180:[o,a]=[-o,-a];break;case 270:case-90:[o,a]=[-a,o]}const s={transform:`scale(${t}) rotate(${e}deg) translate(${o}px, ${a}px)`,transition:i?"transform .3s":""};return U.value.name===P.CONTAIN.name&&(s.maxWidth=s.maxHeight="100%"),s})),q=n((()=>ot(m.zIndex)?m.zIndex:N()));function Z(){j.stop(),a("close")}function $(){B.value=!1}function J(t){B.value=!1,t.target.alt=R("el.image.error")}function Q(t){if(B.value||0!==t.button||!D.value)return;V.value.enableTransition=!1;const{offsetX:e,offsetY:n}=V.value,r=t.pageX,i=t.pageY,o=ze((t=>{V.value={...V.value,offsetX:e+t.pageX-r,offsetY:n+t.pageY-i}})),a=Ge(document,"mousemove",o);Ge(document,"mouseup",(()=>{a()})),t.preventDefault()}function tt(){V.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function et(){if(B.value)return;const t=wt(P),e=Object.values(P),n=U.value.name,r=e.findIndex((t=>t.name===n)),i=(r+1)%t.length;U.value=P[t[i]],tt()}function nt(t){const e=m.urlList.length;z.value=(t+e)%e}function rt(){W.value&&!m.infinite||nt(z.value-1)}function at(){H.value&&!m.infinite||nt(z.value+1)}function st(t,e={}){if(B.value)return;const{zoomRate:n,rotateDeg:r,enableTransition:i}={zoomRate:m.zoomRate,rotateDeg:90,enableTransition:!0,...e};switch(t){case"zoomOut":V.value.scale>.2&&(V.value.scale=Number.parseFloat((V.value.scale/n).toFixed(3)));break;case"zoomIn":V.value.scale<7&&(V.value.scale=Number.parseFloat((V.value.scale*n).toFixed(3)));break;case"clockwise":V.value.deg+=r;break;case"anticlockwise":V.value.deg-=r}V.value.enableTransition=i}return t(Y,(()=>{_((()=>{const t=F.value[0];(null==t?void 0:t.complete)||(B.value=!0)}))})),t(z,(t=>{tt(),a("switch",t)})),w((()=>{var t,e;!function(){const t=ze((t=>{switch(t.code){case ln:m.closeOnPressEscape&&Z();break;case on:et();break;case an:rt();break;case sn:st("zoomIn");break;case un:at();break;case cn:st("zoomOut")}})),e=ze((t=>{st((t.wheelDelta?t.wheelDelta:-t.detail)>0?"zoomIn":"zoomOut",{zoomRate:m.zoomRate,enableTransition:!1})}));j.run((()=>{Ge(document,"keydown",t),Ge(document,L,e)}))}(),null==(e=null==(t=D.value)?void 0:t.focus)||e.call(t)})),o({setActiveItem:nt}),(t,e)=>(s(),S(k,{to:"body",disabled:!t.teleported},[l(g,{name:"viewer-fade",appear:""},{default:h((()=>[p("div",{ref_key:"wrapper",ref:D,tabindex:-1,class:d(i(I).e("wrapper")),style:M({zIndex:i(q)})},[p("div",{class:d(i(I).e("mask")),onClick:e[0]||(e[0]=E((e=>t.hideOnClickModal&&Z()),["self"]))},null,2),A(" CLOSE "),p("span",{class:d([i(I).e("btn"),i(I).e("close")]),onClick:Z},[l(i(dt),null,{default:h((()=>[l(i(mt))])),_:1})],2),A(" ARROW "),i(G)?A("v-if",!0):(s(),u(T,{key:0},[p("span",{class:d([i(I).e("btn"),i(I).e("prev"),i(I).is("disabled",!t.infinite&&i(W))]),onClick:rt},[l(i(dt),null,{default:h((()=>[l(i(vt))])),_:1})],2),p("span",{class:d([i(I).e("btn"),i(I).e("next"),i(I).is("disabled",!t.infinite&&i(H))]),onClick:at},[l(i(dt),null,{default:h((()=>[l(i(gt))])),_:1})],2)],64)),A(" ACTIONS "),p("div",{class:d([i(I).e("btn"),i(I).e("actions")])},[p("div",{class:d(i(I).e("actions__inner"))},[l(i(dt),{onClick:e[1]||(e[1]=t=>st("zoomOut"))},{default:h((()=>[l(i(yt))])),_:1}),l(i(dt),{onClick:e[2]||(e[2]=t=>st("zoomIn"))},{default:h((()=>[l(i(xt))])),_:1}),p("i",{class:d(i(I).e("actions__divider"))},null,2),l(i(dt),{onClick:et},{default:h((()=>[(s(),S(C(i(U).icon)))])),_:1}),p("i",{class:d(i(I).e("actions__divider"))},null,2),l(i(dt),{onClick:e[3]||(e[3]=t=>st("anticlockwise"))},{default:h((()=>[l(i(bt))])),_:1}),l(i(dt),{onClick:e[4]||(e[4]=t=>st("clockwise"))},{default:h((()=>[l(i(_t))])),_:1})],2)],2),A(" CANVAS "),p("div",{class:d(i(I).e("canvas"))},[(s(!0),u(T,null,O(t.urlList,((t,e)=>f((s(),u("img",{ref_for:!0,ref:t=>F.value[e]=t,key:t,src:t,style:M(i(X)),class:d(i(I).e("img")),onLoad:$,onError:J,onMousedown:Q},null,46,An)),[[v,e===z.value]]))),128))],2),c(t.$slots,"default")],6)])),_:3})],8,["disabled"]))}});const On=st(at(Cn,[["__file","/home/runner/work/element-plus/element-plus/packages/components/image-viewer/src/image-viewer.vue"]])),kn=rt({hideOnClickModal:{type:Boolean,default:!1},src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:{type:Boolean,default:!1},scrollContainer:{type:ut([String,Object])},previewSrcList:{type:ut(Array),default:()=>ht([])},previewTeleported:{type:Boolean,default:!1},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2}}),Pn={load:t=>t instanceof Event,error:t=>t instanceof Event,switch:t=>ot(t),close:()=>!0,show:()=>!0},Ln=["src","loading"],Rn={key:0},In=a({name:"ElImage",inheritAttrs:!1});const Nn=st(at(a({...In,props:kn,emits:Pn,setup(o,{emit:a}){const l=o;let f="";const{t:v}=vn(),g=it("image"),y=P(),x=((t={})=>{const{excludeListeners:e=!1,excludeKeys:i}=t,o=n((()=>((null==i?void 0:i.value)||[]).concat(hn))),a=r();return n(a?()=>{var t;return et(Object.entries(null==(t=a.proxy)?void 0:t.$attrs).filter((([t])=>!(o.value.includes(t)||e&&fn.test(t)))))}:()=>({}))})(),b=e(),E=e(!1),C=e(!0),O=e(!1),k=e(),I=e(),N=K&&"loading"in HTMLImageElement.prototype;let D,F;const j=n((()=>y.style)),B=n((()=>{const{fit:t}=l;return K&&t?{objectFit:t}:{}})),z=n((()=>{const{previewSrcList:t}=l;return Array.isArray(t)&&t.length>0})),U=n((()=>{const{previewSrcList:t,initialIndex:e}=l;let n=e;return e>t.length-1&&(n=0),n})),V=n((()=>"eager"!==l.loading&&(!N&&"lazy"===l.loading||l.lazy))),G=()=>{K&&(C.value=!0,E.value=!1,b.value=l.src)};function W(t){C.value=!1,E.value=!1,a("load",t)}function H(t){C.value=!1,E.value=!0,a("error",t)}function Y(){((t,e)=>{if(!K||!t||!e)return!1;const n=t.getBoundingClientRect();let r;return r=e instanceof Element?e.getBoundingClientRect():{top:0,right:window.innerWidth,bottom:window.innerHeight,left:0},n.top<r.bottom&&n.bottom>r.top&&n.right>r.left&&n.left<r.right})(k.value,I.value)&&(G(),Z())}const X=Mt(Y,200);async function q(){var t;if(!K)return;await _();const{scrollContainer:e}=l;St(e)?I.value=e:R(e)&&""!==e?I.value=null!=(t=document.querySelector(e))?t:void 0:k.value&&(I.value=((t,e)=>{if(!K)return;let n=t;for(;n;){if([window,document,document.documentElement].includes(n))return window;if(rn(n,e))return n;n=n.parentNode}return n})(k.value)),I.value&&(D=Ge(I,"scroll",X),setTimeout((()=>Y()),100))}function Z(){K&&I.value&&X&&(null==D||D(),I.value=void 0)}function $(t){if(t.ctrlKey)return t.deltaY<0||t.deltaY>0?(t.preventDefault(),!1):void 0}function J(){z.value&&(F=Ge("wheel",$,{passive:!1}),f=document.body.style.overflow,document.body.style.overflow="hidden",O.value=!0,a("show"))}function Q(){null==F||F(),document.body.style.overflow=f,O.value=!1,a("close")}function tt(t){a("switch",t)}return t((()=>l.src),(()=>{V.value?(C.value=!0,E.value=!1,Z(),q()):G()})),w((()=>{V.value?q():G()})),(t,e)=>(s(),u("div",{ref_key:"container",ref:k,class:d([i(g).b(),t.$attrs.class]),style:M(i(j))},[void 0===b.value||E.value?A("v-if",!0):(s(),u("img",L({key:0},i(x),{src:b.value,loading:t.loading,style:i(B),class:[i(g).e("inner"),i(z)&&i(g).e("preview"),C.value&&i(g).is("loading")],onClick:J,onLoad:W,onError:H}),null,16,Ln)),C.value||E.value?(s(),u("div",{key:1,class:d(i(g).e("wrapper"))},[C.value?c(t.$slots,"placeholder",{key:0},(()=>[p("div",{class:d(i(g).e("placeholder"))},null,2)])):E.value?c(t.$slots,"error",{key:1},(()=>[p("div",{class:d(i(g).e("error"))},m(i(v)("el.image.error")),3)])):A("v-if",!0)],2)):A("v-if",!0),i(z)?(s(),u(T,{key:2},[O.value?(s(),S(i(On),{key:0,"z-index":t.zIndex,"initial-index":i(U),infinite:t.infinite,"zoom-rate":t.zoomRate,"url-list":t.previewSrcList,"hide-on-click-modal":t.hideOnClickModal,teleported:t.previewTeleported,"close-on-press-escape":t.closeOnPressEscape,onClose:Q,onSwitch:tt},{default:h((()=>[t.$slots.viewer?(s(),u("div",Rn,[c(t.$slots,"viewer")])):A("v-if",!0)])),_:3},8,["z-index","initial-index","infinite","zoom-rate","url-list","hide-on-click-modal","teleported","close-on-press-escape"])):A("v-if",!0)],64)):A("v-if",!0)],6))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/image/src/image.vue"]])),Dn=["success","info","warning","error"],Fn=ht({customClass:"",center:!1,dangerouslyUseHTMLString:!1,duration:3e3,icon:void 0,id:"",message:"",onClose:void 0,showClose:!1,type:"info",offset:16,zIndex:0,grouping:!1,repeatNum:1,appendTo:K?document.body:void 0}),jn=rt({customClass:{type:String,default:Fn.customClass},center:{type:Boolean,default:Fn.center},dangerouslyUseHTMLString:{type:Boolean,default:Fn.dangerouslyUseHTMLString},duration:{type:Number,default:Fn.duration},icon:{type:Et,default:Fn.icon},id:{type:String,default:Fn.id},message:{type:ut([String,Object,Function]),default:Fn.message},onClose:{type:ut(Function),required:!1},showClose:{type:Boolean,default:Fn.showClose},type:{type:String,values:Dn,default:Fn.type},offset:{type:Number,default:Fn.offset},zIndex:{type:Number,default:Fn.zIndex},grouping:{type:Boolean,default:Fn.grouping},repeatNum:{type:Number,default:Fn.repeatNum}}),Bn=I([]),zn=t=>{const{prev:e}=(t=>{const e=Bn.findIndex((e=>e.id===t)),n=Bn[e];let r;return e>0&&(r=Bn[e-1]),{current:n,prev:r}})(t);return e?e.vm.exposed.bottom.value:0},Un=["id"],Vn=["innerHTML"],Gn=a({name:"ElMessage"});var Wn=at(a({...Gn,props:jn,emits:{destroy:()=>!0},setup(r,{expose:o}){const a=r,{Close:y}=Tt,x=it("message"),b=e(),_=e(!1),O=e(0);let k;const P=n((()=>a.type?"error"===a.type?"danger":a.type:"info")),L=n((()=>{const t=a.type;return{[x.bm("icon",t)]:t&&At[t]}})),R=n((()=>a.icon||At[a.type]||"")),I=n((()=>zn(a.id))),N=n((()=>a.offset+I.value)),D=n((()=>O.value+N.value)),F=n((()=>({top:`${N.value}px`,zIndex:a.zIndex})));function j(){0!==a.duration&&({stop:k}=Ct((()=>{z()}),a.duration))}function B(){null==k||k()}function z(){_.value=!1}return w((()=>{j(),_.value=!0})),t((()=>a.repeatNum),(()=>{B(),j()})),Ge(document,"keydown",(function({code:t}){t===ln&&z()})),Ke(b,(()=>{O.value=b.value.getBoundingClientRect().height})),o({visible:_,bottom:D,close:z}),(t,e)=>(s(),S(g,{name:i(x).b("fade"),onBeforeLeave:t.onClose,onAfterLeave:e[0]||(e[0]=e=>t.$emit("destroy")),persisted:""},{default:h((()=>[f(p("div",{id:t.id,ref_key:"messageRef",ref:b,class:d([i(x).b(),{[i(x).m(t.type)]:t.type&&!t.icon},i(x).is("center",t.center),i(x).is("closable",t.showClose),t.customClass]),style:M(i(F)),role:"alert",onMouseenter:B,onMouseleave:j},[t.repeatNum>1?(s(),S(i(wn),{key:0,value:t.repeatNum,type:i(P),class:d(i(x).e("badge"))},null,8,["value","type","class"])):A("v-if",!0),i(R)?(s(),S(i(dt),{key:1,class:d([i(x).e("icon"),i(L)])},{default:h((()=>[(s(),S(C(i(R))))])),_:1},8,["class"])):A("v-if",!0),c(t.$slots,"default",{},(()=>[t.dangerouslyUseHTMLString?(s(),u(T,{key:1},[A(" Caution here, message could've been compromised, never use user's input as message "),p("p",{class:d(i(x).e("content")),innerHTML:t.message},null,10,Vn)],2112)):(s(),u("p",{key:0,class:d(i(x).e("content"))},m(t.message),3))])),t.showClose?(s(),S(i(dt),{key:2,class:d(i(x).e("closeBtn")),onClick:E(z,["stop"])},{default:h((()=>[l(i(y))])),_:1},8,["class","onClick"])):A("v-if",!0)],46,Un),[[v,_.value]])])),_:3},8,["name","onBeforeLeave"]))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/message/src/message.vue"]]);let Hn=1;const Yn=t=>{const e=!t||R(t)||N(t)||D(t)?{message:t}:t,n={...Fn,...e};if(n.appendTo){if(R(n.appendTo)){let t=document.querySelector(n.appendTo);St(t)||(t=document.body),n.appendTo=t}}else n.appendTo=document.body;return n},Xn=({appendTo:t,...e},n)=>{const{nextZIndex:r}=yn(),i="message_"+Hn++,o=e.onClose,a=document.createElement("div"),s={...e,zIndex:r()+e.zIndex,id:i,onClose:()=>{null==o||o(),(t=>{const e=Bn.indexOf(t);if(-1===e)return;Bn.splice(e,1);const{handler:n}=t;n.close()})(f)},onDestroy:()=>{F(null,a)}},u=l(Wn,s,D(s.message)||N(s.message)?{default:D(s.message)?s.message:()=>s.message}:null);u.appContext=n||qn._context,F(u,a),t.appendChild(a.firstElementChild);const c=u.component,h={close:()=>{c.exposed.visible.value=!1}},f={id:i,vnode:u,vm:c,handler:h,props:u.component.props};return f},qn=(t={},e)=>{if(!K)return{close:()=>{}};if(ot(Sn.max)&&Bn.length>=Sn.max)return{close:()=>{}};const n=Yn(t);if(n.grouping&&Bn.length){const t=Bn.find((({vnode:t})=>{var e;return(null==(e=t.props)?void 0:e.message)===n.message}));if(t)return t.props.repeatNum+=1,t.props.type=n.type,t.handler}const r=Xn(n,e);return Bn.push(r),r.handler};Dn.forEach((t=>{qn[t]=(e={},n)=>{const r=Yn(e);return qn({...r,type:t},n)}})),qn.closeAll=function(t){for(const e of Bn)t&&t!==e.props.type||e.handler.close()},qn._context=null;const Zn=Ot(qn,"$message");var $n;const Kn="undefined"!=typeof window,Jn=()=>{};function Qn(t){return!!j()&&(B(t),!0)}function tr(t){var e;const n=i(t);return null!=(e=null==n?void 0:n.$el)?e:n}Kn&&(null==($n=null==window?void 0:window.navigator)?void 0:$n.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);const er=Kn?window:void 0,nr=Kn?window.document:void 0;function rr(...e){let n,r,i,o;if("string"==typeof e[0]?([r,i,o]=e,n=er):[n,r,i,o]=e,!n)return Jn;let a=Jn;const s=t((()=>tr(n)),(t=>{a(),t&&(t.addEventListener(r,i,o),a=()=>{t.removeEventListener(r,i,o),a=Jn})}),{immediate:!0,flush:"post"}),u=()=>{s(),a()};return Qn(u),u}Kn&&window.navigator,Kn&&window.location;const ir="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},or="__vueuse_ssr_handlers__";ir[or]=ir[or]||{},ir[or];const ar=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]];var sr;!function(t){t.UP="UP",t.RIGHT="RIGHT",t.DOWN="DOWN",t.LEFT="LEFT",t.NONE="NONE"}(sr||(sr={}));const ur=a({__name:"ScreenAdapter",setup(t){const n=e(null),{isSupported:r,isFullscreen:i,toggle:o}=function(t,n={}){const{document:r=nr,autoExit:i=!1}=n,o=t||(null==r?void 0:r.querySelector("html")),a=e(!1);let s=!1,u=ar[0];if(r){for(const e of ar)if(e[1]in r){u=e,s=!0;break}}else s=!1;const[c,l,h,,f]=u;async function p(){s&&((null==r?void 0:r[h])&&await r[l](),a.value=!1)}async function d(){if(!s)return;await p();const t=tr(o);t&&(await t[c](),a.value=!0)}return r&&rr(r,f,(()=>{a.value=!!(null==r?void 0:r[h])}),!1),i&&Qn(p),{isSupported:s,isFullscreen:a,enter:d,exit:p,toggle:async function(){a.value?await p():await d()}}}(n);return z("isFullscreen",i),w((()=>{r?rr(document,"keydown",(t=>{"Enter"===t.key&&o()})):Zn.warning("您的浏览器不支持全屏！")})),(t,e)=>(s(),u("div",{ref_key:"el",ref:n,class:"screen-adapter"},[c(t.$slots,"default",{},void 0,!0)],512))}}),cr=U(ur,[["__scopeId","data-v-7930dc2c"]]);var lr={},hr={},fr={};let pr;const dr=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];fr.getSymbolSize=function(t){if(!t)throw new Error('"version" cannot be null or undefined');if(t<1||t>40)throw new Error('"version" should be in range from 1 to 40');return 4*t+17},fr.getSymbolTotalCodewords=function(t){return dr[t]},fr.getBCHDigit=function(t){let e=0;for(;0!==t;)e++,t>>>=1;return e},fr.setToSJISFunction=function(t){if("function"!=typeof t)throw new Error('"toSJISFunc" is not a valid function.');pr=t},fr.isKanjiModeEnabled=function(){return void 0!==pr},fr.toSJIS=function(t){return pr(t)};var mr,vr={};function gr(){this.buffer=[],this.length=0}(mr=vr).L={bit:1},mr.M={bit:0},mr.Q={bit:3},mr.H={bit:2},mr.isValid=function(t){return t&&void 0!==t.bit&&t.bit>=0&&t.bit<4},mr.from=function(t,e){if(mr.isValid(t))return t;try{return function(t){if("string"!=typeof t)throw new Error("Param is not a string");switch(t.toLowerCase()){case"l":case"low":return mr.L;case"m":case"medium":return mr.M;case"q":case"quartile":return mr.Q;case"h":case"high":return mr.H;default:throw new Error("Unknown EC Level: "+t)}}(t)}catch(n){return e}},gr.prototype={get:function(t){const e=Math.floor(t/8);return 1==(this.buffer[e]>>>7-t%8&1)},put:function(t,e){for(let n=0;n<e;n++)this.putBit(1==(t>>>e-n-1&1))},getLengthInBits:function(){return this.length},putBit:function(t){const e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++}};var yr=gr;function xr(t){if(!t||t<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=t,this.data=new Uint8Array(t*t),this.reservedBit=new Uint8Array(t*t)}xr.prototype.set=function(t,e,n,r){const i=t*this.size+e;this.data[i]=n,r&&(this.reservedBit[i]=!0)},xr.prototype.get=function(t,e){return this.data[t*this.size+e]},xr.prototype.xor=function(t,e,n){this.data[t*this.size+e]^=n},xr.prototype.isReserved=function(t,e){return this.reservedBit[t*this.size+e]};var br=xr,_r={};!function(t){const e=fr.getSymbolSize;t.getRowColCoords=function(t){if(1===t)return[];const n=Math.floor(t/7)+2,r=e(t),i=145===r?26:2*Math.ceil((r-13)/(2*n-2)),o=[r-7];for(let e=1;e<n-1;e++)o[e]=o[e-1]-i;return o.push(6),o.reverse()},t.getPositions=function(e){const n=[],r=t.getRowColCoords(e),i=r.length;for(let t=0;t<i;t++)for(let e=0;e<i;e++)0===t&&0===e||0===t&&e===i-1||t===i-1&&0===e||n.push([r[t],r[e]]);return n}}(_r);var wr={};const Sr=fr.getSymbolSize;wr.getPositions=function(t){const e=Sr(t);return[[0,0],[e-7,0],[0,e-7]]};var Mr={};!function(t){t.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const e=3,n=3,r=40,i=10;function o(e,n,r){switch(e){case t.Patterns.PATTERN000:return(n+r)%2==0;case t.Patterns.PATTERN001:return n%2==0;case t.Patterns.PATTERN010:return r%3==0;case t.Patterns.PATTERN011:return(n+r)%3==0;case t.Patterns.PATTERN100:return(Math.floor(n/2)+Math.floor(r/3))%2==0;case t.Patterns.PATTERN101:return n*r%2+n*r%3==0;case t.Patterns.PATTERN110:return(n*r%2+n*r%3)%2==0;case t.Patterns.PATTERN111:return(n*r%3+(n+r)%2)%2==0;default:throw new Error("bad maskPattern:"+e)}}t.isValid=function(t){return null!=t&&""!==t&&!isNaN(t)&&t>=0&&t<=7},t.from=function(e){return t.isValid(e)?parseInt(e,10):void 0},t.getPenaltyN1=function(t){const n=t.size;let r=0,i=0,o=0,a=null,s=null;for(let u=0;u<n;u++){i=o=0,a=s=null;for(let c=0;c<n;c++){let n=t.get(u,c);n===a?i++:(i>=5&&(r+=e+(i-5)),a=n,i=1),n=t.get(c,u),n===s?o++:(o>=5&&(r+=e+(o-5)),s=n,o=1)}i>=5&&(r+=e+(i-5)),o>=5&&(r+=e+(o-5))}return r},t.getPenaltyN2=function(t){const e=t.size;let r=0;for(let n=0;n<e-1;n++)for(let i=0;i<e-1;i++){const e=t.get(n,i)+t.get(n,i+1)+t.get(n+1,i)+t.get(n+1,i+1);4!==e&&0!==e||r++}return r*n},t.getPenaltyN3=function(t){const e=t.size;let n=0,i=0,o=0;for(let r=0;r<e;r++){i=o=0;for(let a=0;a<e;a++)i=i<<1&2047|t.get(r,a),a>=10&&(1488===i||93===i)&&n++,o=o<<1&2047|t.get(a,r),a>=10&&(1488===o||93===o)&&n++}return n*r},t.getPenaltyN4=function(t){let e=0;const n=t.data.length;for(let r=0;r<n;r++)e+=t.data[r];return Math.abs(Math.ceil(100*e/n/5)-10)*i},t.applyMask=function(t,e){const n=e.size;for(let r=0;r<n;r++)for(let i=0;i<n;i++)e.isReserved(i,r)||e.xor(i,r,o(t,i,r))},t.getBestMask=function(e,n){const r=Object.keys(t.Patterns).length;let i=0,o=1/0;for(let a=0;a<r;a++){n(a),t.applyMask(a,e);const r=t.getPenaltyN1(e)+t.getPenaltyN2(e)+t.getPenaltyN3(e)+t.getPenaltyN4(e);t.applyMask(a,e),r<o&&(o=r,i=a)}return i}}(Mr);var Er={};const Ar=vr,Tr=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],Cr=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];Er.getBlocksCount=function(t,e){switch(e){case Ar.L:return Tr[4*(t-1)+0];case Ar.M:return Tr[4*(t-1)+1];case Ar.Q:return Tr[4*(t-1)+2];case Ar.H:return Tr[4*(t-1)+3];default:return}},Er.getTotalCodewordsCount=function(t,e){switch(e){case Ar.L:return Cr[4*(t-1)+0];case Ar.M:return Cr[4*(t-1)+1];case Ar.Q:return Cr[4*(t-1)+2];case Ar.H:return Cr[4*(t-1)+3];default:return}};var Or={},kr={};const Pr=new Uint8Array(512),Lr=new Uint8Array(256);!function(){let t=1;for(let e=0;e<255;e++)Pr[e]=t,Lr[t]=e,t<<=1,256&t&&(t^=285);for(let e=255;e<512;e++)Pr[e]=Pr[e-255]}(),kr.log=function(t){if(t<1)throw new Error("log("+t+")");return Lr[t]},kr.exp=function(t){return Pr[t]},kr.mul=function(t,e){return 0===t||0===e?0:Pr[Lr[t]+Lr[e]]},function(t){const e=kr;t.mul=function(t,n){const r=new Uint8Array(t.length+n.length-1);for(let i=0;i<t.length;i++)for(let o=0;o<n.length;o++)r[i+o]^=e.mul(t[i],n[o]);return r},t.mod=function(t,n){let r=new Uint8Array(t);for(;r.length-n.length>=0;){const t=r[0];for(let o=0;o<n.length;o++)r[o]^=e.mul(n[o],t);let i=0;for(;i<r.length&&0===r[i];)i++;r=r.slice(i)}return r},t.generateECPolynomial=function(n){let r=new Uint8Array([1]);for(let i=0;i<n;i++)r=t.mul(r,new Uint8Array([1,e.exp(i)]));return r}}(Or);const Rr=Or;function Ir(t){this.genPoly=void 0,this.degree=t,this.degree&&this.initialize(this.degree)}Ir.prototype.initialize=function(t){this.degree=t,this.genPoly=Rr.generateECPolynomial(this.degree)},Ir.prototype.encode=function(t){if(!this.genPoly)throw new Error("Encoder not initialized");const e=new Uint8Array(t.length+this.degree);e.set(t);const n=Rr.mod(e,this.genPoly),r=this.degree-n.length;if(r>0){const t=new Uint8Array(this.degree);return t.set(n,r),t}return n};var Nr=Ir,Dr={},Fr={},jr={isValid:function(t){return!isNaN(t)&&t>=1&&t<=40}},Br={};const zr="[0-9]+";let Ur="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";Ur=Ur.replace(/u/g,"\\u");const Vr="(?:(?![A-Z0-9 $%*+\\-./:]|"+Ur+")(?:.|[\r\n]))+";Br.KANJI=new RegExp(Ur,"g"),Br.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),Br.BYTE=new RegExp(Vr,"g"),Br.NUMERIC=new RegExp(zr,"g"),Br.ALPHANUMERIC=new RegExp("[A-Z $%*+\\-./:]+","g");const Gr=new RegExp("^"+Ur+"$"),Wr=new RegExp("^"+zr+"$"),Hr=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");Br.testKanji=function(t){return Gr.test(t)},Br.testNumeric=function(t){return Wr.test(t)},Br.testAlphanumeric=function(t){return Hr.test(t)},function(t){const e=jr,n=Br;t.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},t.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},t.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},t.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},t.MIXED={bit:-1},t.getCharCountIndicator=function(t,n){if(!t.ccBits)throw new Error("Invalid mode: "+t);if(!e.isValid(n))throw new Error("Invalid version: "+n);return n>=1&&n<10?t.ccBits[0]:n<27?t.ccBits[1]:t.ccBits[2]},t.getBestModeForData=function(e){return n.testNumeric(e)?t.NUMERIC:n.testAlphanumeric(e)?t.ALPHANUMERIC:n.testKanji(e)?t.KANJI:t.BYTE},t.toString=function(t){if(t&&t.id)return t.id;throw new Error("Invalid mode")},t.isValid=function(t){return t&&t.bit&&t.ccBits},t.from=function(e,n){if(t.isValid(e))return e;try{return function(e){if("string"!=typeof e)throw new Error("Param is not a string");switch(e.toLowerCase()){case"numeric":return t.NUMERIC;case"alphanumeric":return t.ALPHANUMERIC;case"kanji":return t.KANJI;case"byte":return t.BYTE;default:throw new Error("Unknown mode: "+e)}}(e)}catch(r){return n}}}(Fr),function(t){const e=fr,n=Er,r=vr,i=Fr,o=jr,a=e.getBCHDigit(7973);function s(t,e){return i.getCharCountIndicator(t,e)+4}function u(t,e){let n=0;return t.forEach((function(t){const r=s(t.mode,e);n+=r+t.getBitsLength()})),n}t.from=function(t,e){return o.isValid(t)?parseInt(t,10):e},t.getCapacity=function(t,r,a){if(!o.isValid(t))throw new Error("Invalid QR Code version");void 0===a&&(a=i.BYTE);const u=8*(e.getSymbolTotalCodewords(t)-n.getTotalCodewordsCount(t,r));if(a===i.MIXED)return u;const c=u-s(a,t);switch(a){case i.NUMERIC:return Math.floor(c/10*3);case i.ALPHANUMERIC:return Math.floor(c/11*2);case i.KANJI:return Math.floor(c/13);case i.BYTE:default:return Math.floor(c/8)}},t.getBestVersionForData=function(e,n){let o;const a=r.from(n,r.M);if(Array.isArray(e)){if(e.length>1)return function(e,n){for(let r=1;r<=40;r++)if(u(e,r)<=t.getCapacity(r,n,i.MIXED))return r}(e,a);if(0===e.length)return 1;o=e[0]}else o=e;return function(e,n,r){for(let i=1;i<=40;i++)if(n<=t.getCapacity(i,r,e))return i}(o.mode,o.getLength(),a)},t.getEncodedBits=function(t){if(!o.isValid(t)||t<7)throw new Error("Invalid QR Code version");let n=t<<12;for(;e.getBCHDigit(n)-a>=0;)n^=7973<<e.getBCHDigit(n)-a;return t<<12|n}}(Dr);var Yr={};const Xr=fr,qr=Xr.getBCHDigit(1335);Yr.getEncodedBits=function(t,e){const n=t.bit<<3|e;let r=n<<10;for(;Xr.getBCHDigit(r)-qr>=0;)r^=1335<<Xr.getBCHDigit(r)-qr;return 21522^(n<<10|r)};var Zr={};const $r=Fr;function Kr(t){this.mode=$r.NUMERIC,this.data=t.toString()}Kr.getBitsLength=function(t){return 10*Math.floor(t/3)+(t%3?t%3*3+1:0)},Kr.prototype.getLength=function(){return this.data.length},Kr.prototype.getBitsLength=function(){return Kr.getBitsLength(this.data.length)},Kr.prototype.write=function(t){let e,n,r;for(e=0;e+3<=this.data.length;e+=3)n=this.data.substr(e,3),r=parseInt(n,10),t.put(r,10);const i=this.data.length-e;i>0&&(n=this.data.substr(e),r=parseInt(n,10),t.put(r,3*i+1))};var Jr=Kr;const Qr=Fr,ti=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function ei(t){this.mode=Qr.ALPHANUMERIC,this.data=t}ei.getBitsLength=function(t){return 11*Math.floor(t/2)+t%2*6},ei.prototype.getLength=function(){return this.data.length},ei.prototype.getBitsLength=function(){return ei.getBitsLength(this.data.length)},ei.prototype.write=function(t){let e;for(e=0;e+2<=this.data.length;e+=2){let n=45*ti.indexOf(this.data[e]);n+=ti.indexOf(this.data[e+1]),t.put(n,11)}this.data.length%2&&t.put(ti.indexOf(this.data[e]),6)};var ni=ei;const ri=function(t){for(var e=[],n=t.length,r=0;r<n;r++){var i=t.charCodeAt(r);if(i>=55296&&i<=56319&&n>r+1){var o=t.charCodeAt(r+1);o>=56320&&o<=57343&&(i=1024*(i-55296)+o-56320+65536,r+=1)}i<128?e.push(i):i<2048?(e.push(i>>6|192),e.push(63&i|128)):i<55296||i>=57344&&i<65536?(e.push(i>>12|224),e.push(i>>6&63|128),e.push(63&i|128)):i>=65536&&i<=1114111?(e.push(i>>18|240),e.push(i>>12&63|128),e.push(i>>6&63|128),e.push(63&i|128)):e.push(239,191,189)}return new Uint8Array(e).buffer},ii=Fr;function oi(t){this.mode=ii.BYTE,"string"==typeof t&&(t=ri(t)),this.data=new Uint8Array(t)}oi.getBitsLength=function(t){return 8*t},oi.prototype.getLength=function(){return this.data.length},oi.prototype.getBitsLength=function(){return oi.getBitsLength(this.data.length)},oi.prototype.write=function(t){for(let e=0,n=this.data.length;e<n;e++)t.put(this.data[e],8)};var ai=oi;const si=Fr,ui=fr;function ci(t){this.mode=si.KANJI,this.data=t}ci.getBitsLength=function(t){return 13*t},ci.prototype.getLength=function(){return this.data.length},ci.prototype.getBitsLength=function(){return ci.getBitsLength(this.data.length)},ci.prototype.write=function(t){let e;for(e=0;e<this.data.length;e++){let n=ui.toSJIS(this.data[e]);if(n>=33088&&n<=40956)n-=33088;else{if(!(n>=57408&&n<=60351))throw new Error("Invalid SJIS character: "+this.data[e]+"\nMake sure your charset is UTF-8");n-=49472}n=192*(n>>>8&255)+(255&n),t.put(n,13)}};var li,hi=ci,fi={};li={single_source_shortest_paths:function(t,e,n){var r={},i={};i[e]=0;var o,a,s,u,c,l,h,f=li.PriorityQueue.make();for(f.push(e,0);!f.empty();)for(s in a=(o=f.pop()).value,u=o.cost,c=t[a]||{})c.hasOwnProperty(s)&&(l=u+c[s],h=i[s],(void 0===i[s]||h>l)&&(i[s]=l,f.push(s,l),r[s]=a));if(void 0!==n&&void 0===i[n]){var p=["Could not find a path from ",e," to ",n,"."].join("");throw new Error(p)}return r},extract_shortest_path_from_predecessor_list:function(t,e){for(var n=[],r=e;r;)n.push(r),t[r],r=t[r];return n.reverse(),n},find_path:function(t,e,n){var r=li.single_source_shortest_paths(t,e,n);return li.extract_shortest_path_from_predecessor_list(r,n)},PriorityQueue:{make:function(t){var e,n=li.PriorityQueue,r={};for(e in t=t||{},n)n.hasOwnProperty(e)&&(r[e]=n[e]);return r.queue=[],r.sorter=t.sorter||n.default_sorter,r},default_sorter:function(t,e){return t.cost-e.cost},push:function(t,e){var n={value:t,cost:e};this.queue.push(n),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return 0===this.queue.length}}},{get exports(){return fi},set exports(t){fi=t}}.exports=li,function(t){const e=Fr,n=Jr,r=ni,i=ai,o=hi,a=Br,s=fr,u=fi;function c(t){return unescape(encodeURIComponent(t)).length}function l(t,e,n){const r=[];let i;for(;null!==(i=t.exec(n));)r.push({data:i[0],index:i.index,mode:e,length:i[0].length});return r}function h(t){const n=l(a.NUMERIC,e.NUMERIC,t),r=l(a.ALPHANUMERIC,e.ALPHANUMERIC,t);let i,o;s.isKanjiModeEnabled()?(i=l(a.BYTE,e.BYTE,t),o=l(a.KANJI,e.KANJI,t)):(i=l(a.BYTE_KANJI,e.BYTE,t),o=[]);return n.concat(r,i,o).sort((function(t,e){return t.index-e.index})).map((function(t){return{data:t.data,mode:t.mode,length:t.length}}))}function f(t,a){switch(a){case e.NUMERIC:return n.getBitsLength(t);case e.ALPHANUMERIC:return r.getBitsLength(t);case e.KANJI:return o.getBitsLength(t);case e.BYTE:return i.getBitsLength(t)}}function p(t,a){let u;const c=e.getBestModeForData(t);if(u=e.from(a,c),u!==e.BYTE&&u.bit<c.bit)throw new Error('"'+t+'" cannot be encoded with mode '+e.toString(u)+".\n Suggested mode is: "+e.toString(c));switch(u!==e.KANJI||s.isKanjiModeEnabled()||(u=e.BYTE),u){case e.NUMERIC:return new n(t);case e.ALPHANUMERIC:return new r(t);case e.KANJI:return new o(t);case e.BYTE:return new i(t)}}t.fromArray=function(t){return t.reduce((function(t,e){return"string"==typeof e?t.push(p(e,null)):e.data&&t.push(p(e.data,e.mode)),t}),[])},t.fromString=function(n,r){const i=function(t){const n=[];for(let r=0;r<t.length;r++){const i=t[r];switch(i.mode){case e.NUMERIC:n.push([i,{data:i.data,mode:e.ALPHANUMERIC,length:i.length},{data:i.data,mode:e.BYTE,length:i.length}]);break;case e.ALPHANUMERIC:n.push([i,{data:i.data,mode:e.BYTE,length:i.length}]);break;case e.KANJI:n.push([i,{data:i.data,mode:e.BYTE,length:c(i.data)}]);break;case e.BYTE:n.push([{data:i.data,mode:e.BYTE,length:c(i.data)}])}}return n}(h(n,s.isKanjiModeEnabled())),o=function(t,n){const r={},i={start:{}};let o=["start"];for(let a=0;a<t.length;a++){const s=t[a],u=[];for(let t=0;t<s.length;t++){const c=s[t],l=""+a+t;u.push(l),r[l]={node:c,lastCount:0},i[l]={};for(let t=0;t<o.length;t++){const a=o[t];r[a]&&r[a].node.mode===c.mode?(i[a][l]=f(r[a].lastCount+c.length,c.mode)-f(r[a].lastCount,c.mode),r[a].lastCount+=c.length):(r[a]&&(r[a].lastCount=c.length),i[a][l]=f(c.length,c.mode)+4+e.getCharCountIndicator(c.mode,n))}}o=u}for(let e=0;e<o.length;e++)i[o[e]].end=0;return{map:i,table:r}}(i,r),a=u.find_path(o.map,"start","end"),l=[];for(let t=1;t<a.length-1;t++)l.push(o.table[a[t]].node);return t.fromArray(function(t){return t.reduce((function(t,e){const n=t.length-1>=0?t[t.length-1]:null;return n&&n.mode===e.mode?(t[t.length-1].data+=e.data,t):(t.push(e),t)}),[])}(l))},t.rawSplit=function(e){return t.fromArray(h(e,s.isKanjiModeEnabled()))}}(Zr);const pi=fr,di=vr,mi=yr,vi=br,gi=_r,yi=wr,xi=Mr,bi=Er,_i=Nr,wi=Dr,Si=Yr,Mi=Fr,Ei=Zr;function Ai(t,e,n){const r=t.size,i=Si.getEncodedBits(e,n);let o,a;for(o=0;o<15;o++)a=1==(i>>o&1),o<6?t.set(o,8,a,!0):o<8?t.set(o+1,8,a,!0):t.set(r-15+o,8,a,!0),o<8?t.set(8,r-o-1,a,!0):o<9?t.set(8,15-o-1+1,a,!0):t.set(8,15-o-1,a,!0);t.set(r-8,8,1,!0)}function Ti(t,e,n){const r=new mi;n.forEach((function(e){r.put(e.mode.bit,4),r.put(e.getLength(),Mi.getCharCountIndicator(e.mode,t)),e.write(r)}));const i=8*(pi.getSymbolTotalCodewords(t)-bi.getTotalCodewordsCount(t,e));for(r.getLengthInBits()+4<=i&&r.put(0,4);r.getLengthInBits()%8!=0;)r.putBit(0);const o=(i-r.getLengthInBits())/8;for(let a=0;a<o;a++)r.put(a%2?17:236,8);return function(t,e,n){const r=pi.getSymbolTotalCodewords(e),i=bi.getTotalCodewordsCount(e,n),o=r-i,a=bi.getBlocksCount(e,n),s=r%a,u=a-s,c=Math.floor(r/a),l=Math.floor(o/a),h=l+1,f=c-l,p=new _i(f);let d=0;const m=new Array(a),v=new Array(a);let g=0;const y=new Uint8Array(t.buffer);for(let S=0;S<a;S++){const t=S<u?l:h;m[S]=y.slice(d,d+t),v[S]=p.encode(m[S]),d+=t,g=Math.max(g,t)}const x=new Uint8Array(r);let b,_,w=0;for(b=0;b<g;b++)for(_=0;_<a;_++)b<m[_].length&&(x[w++]=m[_][b]);for(b=0;b<f;b++)for(_=0;_<a;_++)x[w++]=v[_][b];return x}(r,t,e)}function Ci(t,e,n,r){let i;if(Array.isArray(t))i=Ei.fromArray(t);else{if("string"!=typeof t)throw new Error("Invalid data");{let r=e;if(!r){const e=Ei.rawSplit(t);r=wi.getBestVersionForData(e,n)}i=Ei.fromString(t,r||40)}}const o=wi.getBestVersionForData(i,n);if(!o)throw new Error("The amount of data is too big to be stored in a QR Code");if(e){if(e<o)throw new Error("\nThe chosen QR Code version cannot contain this amount of data.\nMinimum version required to store current data is: "+o+".\n")}else e=o;const a=Ti(e,n,i),s=pi.getSymbolSize(e),u=new vi(s);return function(t,e){const n=t.size,r=yi.getPositions(e);for(let i=0;i<r.length;i++){const e=r[i][0],o=r[i][1];for(let r=-1;r<=7;r++)if(!(e+r<=-1||n<=e+r))for(let i=-1;i<=7;i++)o+i<=-1||n<=o+i||(r>=0&&r<=6&&(0===i||6===i)||i>=0&&i<=6&&(0===r||6===r)||r>=2&&r<=4&&i>=2&&i<=4?t.set(e+r,o+i,!0,!0):t.set(e+r,o+i,!1,!0))}}(u,e),function(t){const e=t.size;for(let n=8;n<e-8;n++){const e=n%2==0;t.set(n,6,e,!0),t.set(6,n,e,!0)}}(u),function(t,e){const n=gi.getPositions(e);for(let r=0;r<n.length;r++){const e=n[r][0],i=n[r][1];for(let n=-2;n<=2;n++)for(let r=-2;r<=2;r++)-2===n||2===n||-2===r||2===r||0===n&&0===r?t.set(e+n,i+r,!0,!0):t.set(e+n,i+r,!1,!0)}}(u,e),Ai(u,n,0),e>=7&&function(t,e){const n=t.size,r=wi.getEncodedBits(e);let i,o,a;for(let s=0;s<18;s++)i=Math.floor(s/3),o=s%3+n-8-3,a=1==(r>>s&1),t.set(i,o,a,!0),t.set(o,i,a,!0)}(u,e),function(t,e){const n=t.size;let r=-1,i=n-1,o=7,a=0;for(let s=n-1;s>0;s-=2)for(6===s&&s--;;){for(let n=0;n<2;n++)if(!t.isReserved(i,s-n)){let r=!1;a<e.length&&(r=1==(e[a]>>>o&1)),t.set(i,s-n,r),o--,-1===o&&(a++,o=7)}if(i+=r,i<0||n<=i){i-=r,r=-r;break}}}(u,a),isNaN(r)&&(r=xi.getBestMask(u,Ai.bind(null,u,n))),xi.applyMask(r,u),Ai(u,n,r),{modules:u,version:e,errorCorrectionLevel:n,maskPattern:r,segments:i}}hr.create=function(t,e){if(void 0===t||""===t)throw new Error("No input text");let n,r,i=di.M;return void 0!==e&&(i=di.from(e.errorCorrectionLevel,di.M),n=wi.from(e.version),r=xi.from(e.maskPattern),e.toSJISFunc&&pi.setToSJISFunction(e.toSJISFunc)),Ci(t,n,i,r)};var Oi={},ki={};!function(t){function e(t){if("number"==typeof t&&(t=t.toString()),"string"!=typeof t)throw new Error("Color should be defined as hex string");let e=t.slice().replace("#","").split("");if(e.length<3||5===e.length||e.length>8)throw new Error("Invalid hex color: "+t);3!==e.length&&4!==e.length||(e=Array.prototype.concat.apply([],e.map((function(t){return[t,t]})))),6===e.length&&e.push("F","F");const n=parseInt(e.join(""),16);return{r:n>>24&255,g:n>>16&255,b:n>>8&255,a:255&n,hex:"#"+e.slice(0,6).join("")}}t.getOptions=function(t){t||(t={}),t.color||(t.color={});const n=void 0===t.margin||null===t.margin||t.margin<0?4:t.margin,r=t.width&&t.width>=21?t.width:void 0,i=t.scale||4;return{width:r,scale:r?4:i,margin:n,color:{dark:e(t.color.dark||"#000000ff"),light:e(t.color.light||"#ffffffff")},type:t.type,rendererOpts:t.rendererOpts||{}}},t.getScale=function(t,e){return e.width&&e.width>=t+2*e.margin?e.width/(t+2*e.margin):e.scale},t.getImageWidth=function(e,n){const r=t.getScale(e,n);return Math.floor((e+2*n.margin)*r)},t.qrToImageData=function(e,n,r){const i=n.modules.size,o=n.modules.data,a=t.getScale(i,r),s=Math.floor((i+2*r.margin)*a),u=r.margin*a,c=[r.color.light,r.color.dark];for(let t=0;t<s;t++)for(let n=0;n<s;n++){let l=4*(t*s+n),h=r.color.light;if(t>=u&&n>=u&&t<s-u&&n<s-u){h=c[o[Math.floor((t-u)/a)*i+Math.floor((n-u)/a)]?1:0]}e[l++]=h.r,e[l++]=h.g,e[l++]=h.b,e[l]=h.a}}}(ki),function(t){const e=ki;t.render=function(t,n,r){let i=r,o=n;void 0!==i||n&&n.getContext||(i=n,n=void 0),n||(o=function(){try{return document.createElement("canvas")}catch(t){throw new Error("You need to specify a canvas element")}}()),i=e.getOptions(i);const a=e.getImageWidth(t.modules.size,i),s=o.getContext("2d"),u=s.createImageData(a,a);return e.qrToImageData(u.data,t,i),function(t,e,n){t.clearRect(0,0,e.width,e.height),e.style||(e.style={}),e.height=n,e.width=n,e.style.height=n+"px",e.style.width=n+"px"}(s,o,a),s.putImageData(u,0,0),o},t.renderToDataURL=function(e,n,r){let i=r;void 0!==i||n&&n.getContext||(i=n,n=void 0),i||(i={});const o=t.render(e,n,i),a=i.type||"image/png",s=i.rendererOpts||{};return o.toDataURL(a,s.quality)}}(Oi);var Pi={};const Li=ki;function Ri(t,e){const n=t.a/255,r=e+'="'+t.hex+'"';return n<1?r+" "+e+'-opacity="'+n.toFixed(2).slice(1)+'"':r}function Ii(t,e,n){let r=t+e;return void 0!==n&&(r+=" "+n),r}Pi.render=function(t,e,n){const r=Li.getOptions(e),i=t.modules.size,o=t.modules.data,a=i+2*r.margin,s=r.color.light.a?"<path "+Ri(r.color.light,"fill")+' d="M0 0h'+a+"v"+a+'H0z"/>':"",u="<path "+Ri(r.color.dark,"stroke")+' d="'+function(t,e,n){let r="",i=0,o=!1,a=0;for(let s=0;s<t.length;s++){const u=Math.floor(s%e),c=Math.floor(s/e);u||o||(o=!0),t[s]?(a++,s>0&&u>0&&t[s-1]||(r+=o?Ii("M",u+n,.5+c+n):Ii("m",i,0),i=0,o=!1),u+1<e&&t[s+1]||(r+=Ii("h",a),a=0)):i++}return r}(o,i,r.margin)+'"/>',c='viewBox="0 0 '+a+" "+a+'"',l='<svg xmlns="http://www.w3.org/2000/svg" '+(r.width?'width="'+r.width+'" height="'+r.width+'" ':"")+c+' shape-rendering="crispEdges">'+s+u+"</svg>\n";return"function"==typeof n&&n(null,l),l};const Ni=function(){return"function"==typeof Promise&&Promise.prototype&&Promise.prototype.then},Di=hr,Fi=Oi,ji=Pi;function Bi(t,e,n,r,i){const o=[].slice.call(arguments,1),a=o.length,s="function"==typeof o[a-1];if(!s&&!Ni())throw new Error("Callback required as last argument");if(!s){if(a<1)throw new Error("Too few arguments provided");return 1===a?(n=e,e=r=void 0):2!==a||e.getContext||(r=n,n=e,e=void 0),new Promise((function(i,o){try{const o=Di.create(n,r);i(t(o,e,r))}catch(a){o(a)}}))}if(a<2)throw new Error("Too few arguments provided");2===a?(i=n,n=e,e=r=void 0):3===a&&(e.getContext&&void 0===i?(i=r,r=void 0):(i=r,r=n,n=e,e=void 0));try{const o=Di.create(n,r);i(null,t(o,e,r))}catch(u){i(u)}}lr.create=Di.create,lr.toCanvas=Bi.bind(null,Fi.render),lr.toDataURL=Bi.bind(null,Fi.renderToDataURL),lr.toString=Bi.bind(null,(function(t,e,n){return ji.render(t,n)}));const zi=a({__name:"QrCodeImg",props:{src:{type:String,default:""}},setup(t){const n=t,r={width:200,errorCorrectionLevel:"L",type:"image/jpeg",quality:.3,margin:1.4},o=e("");return V((()=>{try{if(!n.src)throw new Error("QrCodeImg: 未获取到url");lr.toDataURL(n.src,r,((t,e)=>{if(t)throw t;o.value=e}))}catch(t){}})),(t,e)=>{const n=Nn;return s(),S(n,{style:{width:"8.5vw",height:"8.5vw","border-radius":"4px"},src:i(o),fit:"fill"},null,8,["src"])}}}),Ui="main-layer",Vi="label-layer",Gi="element",Wi="view",Hi="plot",Yi="component",Xi="label",qi="area";var Zi={};({get exports(){return Zi},set exports(t){Zi=t}}).exports=function(){function t(t,n,i,o,a){e(t,n,i||0,o||t.length-1,a||r)}function e(t,r,i,o,a){for(;o>i;){if(o-i>600){var s=o-i+1,u=r-i+1,c=Math.log(s),l=.5*Math.exp(2*c/3),h=.5*Math.sqrt(c*l*(s-l)/s)*(u-s/2<0?-1:1);e(t,r,Math.max(i,Math.floor(r-u*l/s+h)),Math.min(o,Math.floor(r+(s-u)*l/s+h)),a)}var f=t[r],p=i,d=o;for(n(t,i,r),a(t[o],f)>0&&n(t,i,o);p<d;){for(n(t,p,d),p++,d--;a(t[p],f)<0;)p++;for(;a(t[d],f)>0;)d--}0===a(t[i],f)?n(t,i,d):n(t,++d,o),d<=r&&(i=d+1),r<=d&&(o=d-1)}}function n(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function r(t,e){return t<e?-1:t>e?1:0}var i=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function o(t,e,n){if(!n)return e.indexOf(t);for(var r=0;r<e.length;r++)if(n(t,e[r]))return r;return-1}function a(t,e){s(t,0,t.children.length,e,t)}function s(t,e,n,r,i){i||(i=g(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var o=e;o<n;o++){var a=t.children[o];u(i,t.leaf?r(a):a)}return i}function u(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function c(t,e){return t.minX-e.minX}function l(t,e){return t.minY-e.minY}function h(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function f(t){return t.maxX-t.minX+(t.maxY-t.minY)}function p(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}function d(t,e){var n=Math.max(t.minX,e.minX),r=Math.max(t.minY,e.minY),i=Math.min(t.maxX,e.maxX),o=Math.min(t.maxY,e.maxY);return Math.max(0,i-n)*Math.max(0,o-r)}function m(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function v(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function g(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function y(e,n,r,i,o){for(var a=[n,r];a.length;)if(!((r=a.pop())-(n=a.pop())<=i)){var s=n+Math.ceil((r-n)/i/2)*i;t(e,s,n,r,o),a.push(n,s,s,r)}}return i.prototype.all=function(){return this._all(this.data,[])},i.prototype.search=function(t){var e=this.data,n=[];if(!v(t,e))return n;for(var r=this.toBBox,i=[];e;){for(var o=0;o<e.children.length;o++){var a=e.children[o],s=e.leaf?r(a):a;v(t,s)&&(e.leaf?n.push(a):m(t,s)?this._all(a,n):i.push(a))}e=i.pop()}return n},i.prototype.collides=function(t){var e=this.data;if(!v(t,e))return!1;for(var n=[];e;){for(var r=0;r<e.children.length;r++){var i=e.children[r],o=e.leaf?this.toBBox(i):i;if(v(t,o)){if(e.leaf||m(t,o))return!0;n.push(i)}}e=n.pop()}return!1},i.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},i.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},i.prototype.clear=function(){return this.data=g([]),this},i.prototype.remove=function(t,e){if(!t)return this;for(var n,r,i,a=this.data,s=this.toBBox(t),u=[],c=[];a||u.length;){if(a||(a=u.pop(),r=u[u.length-1],n=c.pop(),i=!0),a.leaf){var l=o(t,a.children,e);if(-1!==l)return a.children.splice(l,1),u.push(a),this._condense(u),this}i||a.leaf||!m(a,s)?r?(n++,a=r.children[n],i=!1):a=null:(u.push(a),c.push(n),n=0,r=a,a=a.children[0])}return this},i.prototype.toBBox=function(t){return t},i.prototype.compareMinX=function(t,e){return t.minX-e.minX},i.prototype.compareMinY=function(t,e){return t.minY-e.minY},i.prototype.toJSON=function(){return this.data},i.prototype.fromJSON=function(t){return this.data=t,this},i.prototype._all=function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},i.prototype._build=function(t,e,n,r){var i,o=n-e+1,s=this._maxEntries;if(o<=s)return a(i=g(t.slice(e,n+1)),this.toBBox),i;r||(r=Math.ceil(Math.log(o)/Math.log(s)),s=Math.ceil(o/Math.pow(s,r-1))),(i=g([])).leaf=!1,i.height=r;var u=Math.ceil(o/s),c=u*Math.ceil(Math.sqrt(s));y(t,e,n,c,this.compareMinX);for(var l=e;l<=n;l+=c){var h=Math.min(l+c-1,n);y(t,l,h,u,this.compareMinY);for(var f=l;f<=h;f+=u){var p=Math.min(f+u-1,h);i.children.push(this._build(t,f,p,r-1))}}return a(i,this.toBBox),i},i.prototype._chooseSubtree=function(t,e,n,r){for(;r.push(e),!e.leaf&&r.length-1!==n;){for(var i=1/0,o=1/0,a=void 0,s=0;s<e.children.length;s++){var u=e.children[s],c=h(u),l=p(t,u)-c;l<o?(o=l,i=c<i?c:i,a=u):l===o&&c<i&&(i=c,a=u)}e=a||e.children[0]}return e},i.prototype._insert=function(t,e,n){var r=n?t:this.toBBox(t),i=[],o=this._chooseSubtree(r,this.data,e,i);for(o.children.push(t),u(o,r);e>=0&&i[e].children.length>this._maxEntries;)this._split(i,e),e--;this._adjustParentBBoxes(r,i,e)},i.prototype._split=function(t,e){var n=t[e],r=n.children.length,i=this._minEntries;this._chooseSplitAxis(n,i,r);var o=this._chooseSplitIndex(n,i,r),s=g(n.children.splice(o,n.children.length-o));s.height=n.height,s.leaf=n.leaf,a(n,this.toBBox),a(s,this.toBBox),e?t[e-1].children.push(s):this._splitRoot(n,s)},i.prototype._splitRoot=function(t,e){this.data=g([t,e]),this.data.height=t.height+1,this.data.leaf=!1,a(this.data,this.toBBox)},i.prototype._chooseSplitIndex=function(t,e,n){for(var r,i=1/0,o=1/0,a=e;a<=n-e;a++){var u=s(t,0,a,this.toBBox),c=s(t,a,n,this.toBBox),l=d(u,c),f=h(u)+h(c);l<i?(i=l,r=a,o=f<o?f:o):l===i&&f<o&&(o=f,r=a)}return r||n-e},i.prototype._chooseSplitAxis=function(t,e,n){var r=t.leaf?this.compareMinX:c,i=t.leaf?this.compareMinY:l;this._allDistMargin(t,e,n,r)<this._allDistMargin(t,e,n,i)&&t.children.sort(r)},i.prototype._allDistMargin=function(t,e,n,r){t.children.sort(r);for(var i=this.toBBox,o=s(t,0,e,i),a=s(t,n-e,n,i),c=f(o)+f(a),l=e;l<n-e;l++){var h=t.children[l];u(o,t.leaf?i(h):h),c+=f(o)}for(var p=n-e-1;p>=e;p--){var d=t.children[p];u(a,t.leaf?i(d):d),c+=f(a)}return c},i.prototype._adjustParentBBoxes=function(t,e,n){for(var r=n;r>=0;r--)u(e[r],t)},i.prototype._condense=function(t){for(var e=t.length-1,n=void 0;e>=0;e--)0===t[e].children.length?e>0?(n=t[e-1].children).splice(n.indexOf(t[e]),1):this.clear():a(t[e],this.toBBox)},i}();const $i=Zi;var Ki=1e-6,Ji="undefined"!=typeof Float32Array?Float32Array:Array,Qi=Math.random;function to(){var t=new Ji(9);return Ji!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var eo=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],h=e[8],f=n[0],p=n[1],d=n[2],m=n[3],v=n[4],g=n[5],y=n[6],x=n[7],b=n[8];return t[0]=f*r+p*a+d*c,t[1]=f*i+p*s+d*l,t[2]=f*o+p*u+d*h,t[3]=m*r+v*a+g*c,t[4]=m*i+v*s+g*l,t[5]=m*o+v*u+g*h,t[6]=y*r+x*a+b*c,t[7]=y*i+x*s+b*l,t[8]=y*o+x*u+b*h,t};function no(){var t=new Ji(16);return Ji!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function ro(t){var e=new Ji(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function io(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function oo(t,e,n,r,i,o,a,s,u,c,l,h,f,p,d,m){var v=new Ji(16);return v[0]=t,v[1]=e,v[2]=n,v[3]=r,v[4]=i,v[5]=o,v[6]=a,v[7]=s,v[8]=u,v[9]=c,v[10]=l,v[11]=h,v[12]=f,v[13]=p,v[14]=d,v[15]=m,v}function ao(t,e,n,r,i,o,a,s,u,c,l,h,f,p,d,m,v){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=o,t[5]=a,t[6]=s,t[7]=u,t[8]=c,t[9]=l,t[10]=h,t[11]=f,t[12]=p,t[13]=d,t[14]=m,t[15]=v,t}function so(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function uo(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],o=e[6],a=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=o,t[11]=e[14],t[12]=i,t[13]=a,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function co(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],l=e[8],h=e[9],f=e[10],p=e[11],d=e[12],m=e[13],v=e[14],g=e[15],y=n*s-r*a,x=n*u-i*a,b=n*c-o*a,_=r*u-i*s,w=r*c-o*s,S=i*c-o*u,M=l*m-h*d,E=l*v-f*d,A=l*g-p*d,T=h*v-f*m,C=h*g-p*m,O=f*g-p*v,k=y*O-x*C+b*T+_*A-w*E+S*M;return k?(k=1/k,t[0]=(s*O-u*C+c*T)*k,t[1]=(i*C-r*O-o*T)*k,t[2]=(m*S-v*w+g*_)*k,t[3]=(f*w-h*S-p*_)*k,t[4]=(u*A-a*O-c*E)*k,t[5]=(n*O-i*A+o*E)*k,t[6]=(v*b-d*S-g*x)*k,t[7]=(l*S-f*b+p*x)*k,t[8]=(a*C-s*A+c*M)*k,t[9]=(r*A-n*C-o*M)*k,t[10]=(d*w-m*b+g*y)*k,t[11]=(h*b-l*w-p*y)*k,t[12]=(s*E-a*T-u*M)*k,t[13]=(n*T-r*E+i*M)*k,t[14]=(m*x-d*_-v*y)*k,t[15]=(l*_-h*x+f*y)*k,t):null}function lo(t){var e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],s=t[6],u=t[7],c=t[8],l=t[9],h=t[10],f=t[11],p=t[12],d=t[13],m=t[14],v=t[15];return(e*a-n*o)*(h*v-f*m)-(e*s-r*o)*(l*v-f*d)+(e*u-i*o)*(l*m-h*d)+(n*s-r*a)*(c*v-f*p)-(n*u-i*a)*(c*m-h*p)+(r*u-i*s)*(c*d-l*p)}function ho(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],h=e[8],f=e[9],p=e[10],d=e[11],m=e[12],v=e[13],g=e[14],y=e[15],x=n[0],b=n[1],_=n[2],w=n[3];return t[0]=x*r+b*s+_*h+w*m,t[1]=x*i+b*u+_*f+w*v,t[2]=x*o+b*c+_*p+w*g,t[3]=x*a+b*l+_*d+w*y,x=n[4],b=n[5],_=n[6],w=n[7],t[4]=x*r+b*s+_*h+w*m,t[5]=x*i+b*u+_*f+w*v,t[6]=x*o+b*c+_*p+w*g,t[7]=x*a+b*l+_*d+w*y,x=n[8],b=n[9],_=n[10],w=n[11],t[8]=x*r+b*s+_*h+w*m,t[9]=x*i+b*u+_*f+w*v,t[10]=x*o+b*c+_*p+w*g,t[11]=x*a+b*l+_*d+w*y,x=n[12],b=n[13],_=n[14],w=n[15],t[12]=x*r+b*s+_*h+w*m,t[13]=x*i+b*u+_*f+w*v,t[14]=x*o+b*c+_*p+w*g,t[15]=x*a+b*l+_*d+w*y,t}function fo(t,e,n){var r,i,o,a,s,u,c,l,h,f,p,d,m=n[0],v=n[1],g=n[2];return e===t?(t[12]=e[0]*m+e[4]*v+e[8]*g+e[12],t[13]=e[1]*m+e[5]*v+e[9]*g+e[13],t[14]=e[2]*m+e[6]*v+e[10]*g+e[14],t[15]=e[3]*m+e[7]*v+e[11]*g+e[15]):(r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],h=e[8],f=e[9],p=e[10],d=e[11],t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=s,t[5]=u,t[6]=c,t[7]=l,t[8]=h,t[9]=f,t[10]=p,t[11]=d,t[12]=r*m+s*v+h*g+e[12],t[13]=i*m+u*v+f*g+e[13],t[14]=o*m+c*v+p*g+e[14],t[15]=a*m+l*v+d*g+e[15]),t}function po(t,e,n){var r=n[0],i=n[1],o=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function mo(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[4],a=e[5],s=e[6],u=e[7],c=e[8],l=e[9],h=e[10],f=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*i+c*r,t[5]=a*i+l*r,t[6]=s*i+h*r,t[7]=u*i+f*r,t[8]=c*i-o*r,t[9]=l*i-a*r,t[10]=h*i-s*r,t[11]=f*i-u*r,t}function vo(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],s=e[2],u=e[3],c=e[8],l=e[9],h=e[10],f=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i-c*r,t[1]=a*i-l*r,t[2]=s*i-h*r,t[3]=u*i-f*r,t[8]=o*r+c*i,t[9]=a*r+l*i,t[10]=s*r+h*i,t[11]=u*r+f*i,t}function go(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],s=e[2],u=e[3],c=e[4],l=e[5],h=e[6],f=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i+c*r,t[1]=a*i+l*r,t[2]=s*i+h*r,t[3]=u*i+f*r,t[4]=c*i-o*r,t[5]=l*i-a*r,t[6]=h*i-s*r,t[7]=f*i-u*r,t}function yo(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function xo(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function bo(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=r+r,u=i+i,c=o+o,l=r*s,h=r*u,f=r*c,p=i*u,d=i*c,m=o*c,v=a*s,g=a*u,y=a*c;return t[0]=1-(p+m),t[1]=h+y,t[2]=f-g,t[3]=0,t[4]=h-y,t[5]=1-(l+m),t[6]=d+v,t[7]=0,t[8]=f+g,t[9]=d-v,t[10]=1-(l+p),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function _o(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function wo(t,e){var n=e[0],r=e[1],i=e[2],o=e[4],a=e[5],s=e[6],u=e[8],c=e[9],l=e[10];return t[0]=Math.hypot(n,r,i),t[1]=Math.hypot(o,a,s),t[2]=Math.hypot(u,c,l),t}function So(t,e){var n=new Ji(3);wo(n,e);var r=1/n[0],i=1/n[1],o=1/n[2],a=e[0]*r,s=e[1]*i,u=e[2]*o,c=e[4]*r,l=e[5]*i,h=e[6]*o,f=e[8]*r,p=e[9]*i,d=e[10]*o,m=a+l+d,v=0;return m>0?(v=2*Math.sqrt(m+1),t[3]=.25*v,t[0]=(h-p)/v,t[1]=(f-u)/v,t[2]=(s-c)/v):a>l&&a>d?(v=2*Math.sqrt(1+a-l-d),t[3]=(h-p)/v,t[0]=.25*v,t[1]=(s+c)/v,t[2]=(f+u)/v):l>d?(v=2*Math.sqrt(1+l-a-d),t[3]=(f-u)/v,t[0]=(s+c)/v,t[1]=.25*v,t[2]=(h+p)/v):(v=2*Math.sqrt(1+d-a-l),t[3]=(s-c)/v,t[0]=(f+u)/v,t[1]=(h+p)/v,t[2]=.25*v),t}function Mo(t,e,n,r,i){var o=e[0],a=e[1],s=e[2],u=e[3],c=o+o,l=a+a,h=s+s,f=o*c,p=o*l,d=o*h,m=a*l,v=a*h,g=s*h,y=u*c,x=u*l,b=u*h,_=r[0],w=r[1],S=r[2],M=i[0],E=i[1],A=i[2],T=(1-(m+g))*_,C=(p+b)*_,O=(d-x)*_,k=(p-b)*w,P=(1-(f+g))*w,L=(v+y)*w,R=(d+x)*S,I=(v-y)*S,N=(1-(f+m))*S;return t[0]=T,t[1]=C,t[2]=O,t[3]=0,t[4]=k,t[5]=P,t[6]=L,t[7]=0,t[8]=R,t[9]=I,t[10]=N,t[11]=0,t[12]=n[0]+M-(T*M+k*E+R*A),t[13]=n[1]+E-(C*M+P*E+I*A),t[14]=n[2]+A-(O*M+L*E+N*A),t[15]=1,t}function Eo(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n+n,s=r+r,u=i+i,c=n*a,l=r*a,h=r*s,f=i*a,p=i*s,d=i*u,m=o*a,v=o*s,g=o*u;return t[0]=1-h-d,t[1]=l+g,t[2]=f-v,t[3]=0,t[4]=l-g,t[5]=1-c-d,t[6]=p+m,t[7]=0,t[8]=f+v,t[9]=p-m,t[10]=1-c-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Ao(t,e,n,r,i){var o,a=1/Math.tan(e/2);return t[0]=a/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(o=1/(r-i),t[10]=(i+r)*o,t[14]=2*i*r*o):(t[10]=-1,t[14]=-2*r),t}var To=Ao;function Co(t,e,n,r,i,o,a){var s=1/(e-n),u=1/(r-i),c=1/(o-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*s,t[13]=(i+r)*u,t[14]=(a+o)*c,t[15]=1,t}var Oo=Co;function ko(t,e,n,r){var i,o,a,s,u,c,l,h,f,p,d=e[0],m=e[1],v=e[2],g=r[0],y=r[1],x=r[2],b=n[0],_=n[1],w=n[2];return Math.abs(d-b)<Ki&&Math.abs(m-_)<Ki&&Math.abs(v-w)<Ki?so(t):(l=d-b,h=m-_,f=v-w,i=y*(f*=p=1/Math.hypot(l,h,f))-x*(h*=p),o=x*(l*=p)-g*f,a=g*h-y*l,(p=Math.hypot(i,o,a))?(i*=p=1/p,o*=p,a*=p):(i=0,o=0,a=0),s=h*a-f*o,u=f*i-l*a,c=l*o-h*i,(p=Math.hypot(s,u,c))?(s*=p=1/p,u*=p,c*=p):(s=0,u=0,c=0),t[0]=i,t[1]=s,t[2]=l,t[3]=0,t[4]=o,t[5]=u,t[6]=h,t[7]=0,t[8]=a,t[9]=c,t[10]=f,t[11]=0,t[12]=-(i*d+o*m+a*v),t[13]=-(s*d+u*m+c*v),t[14]=-(l*d+h*m+f*v),t[15]=1,t)}function Po(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}function Lo(t,e){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],l=t[8],h=t[9],f=t[10],p=t[11],d=t[12],m=t[13],v=t[14],g=t[15],y=e[0],x=e[1],b=e[2],_=e[3],w=e[4],S=e[5],M=e[6],E=e[7],A=e[8],T=e[9],C=e[10],O=e[11],k=e[12],P=e[13],L=e[14],R=e[15];return Math.abs(n-y)<=Ki*Math.max(1,Math.abs(n),Math.abs(y))&&Math.abs(r-x)<=Ki*Math.max(1,Math.abs(r),Math.abs(x))&&Math.abs(i-b)<=Ki*Math.max(1,Math.abs(i),Math.abs(b))&&Math.abs(o-_)<=Ki*Math.max(1,Math.abs(o),Math.abs(_))&&Math.abs(a-w)<=Ki*Math.max(1,Math.abs(a),Math.abs(w))&&Math.abs(s-S)<=Ki*Math.max(1,Math.abs(s),Math.abs(S))&&Math.abs(u-M)<=Ki*Math.max(1,Math.abs(u),Math.abs(M))&&Math.abs(c-E)<=Ki*Math.max(1,Math.abs(c),Math.abs(E))&&Math.abs(l-A)<=Ki*Math.max(1,Math.abs(l),Math.abs(A))&&Math.abs(h-T)<=Ki*Math.max(1,Math.abs(h),Math.abs(T))&&Math.abs(f-C)<=Ki*Math.max(1,Math.abs(f),Math.abs(C))&&Math.abs(p-O)<=Ki*Math.max(1,Math.abs(p),Math.abs(O))&&Math.abs(d-k)<=Ki*Math.max(1,Math.abs(d),Math.abs(k))&&Math.abs(m-P)<=Ki*Math.max(1,Math.abs(m),Math.abs(P))&&Math.abs(v-L)<=Ki*Math.max(1,Math.abs(v),Math.abs(L))&&Math.abs(g-R)<=Ki*Math.max(1,Math.abs(g),Math.abs(R))}var Ro=ho,Io=Po;const No=Object.freeze(Object.defineProperty({__proto__:null,add:function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t},adjoint:function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],l=e[8],h=e[9],f=e[10],p=e[11],d=e[12],m=e[13],v=e[14],g=e[15];return t[0]=s*(f*g-p*v)-h*(u*g-c*v)+m*(u*p-c*f),t[1]=-(r*(f*g-p*v)-h*(i*g-o*v)+m*(i*p-o*f)),t[2]=r*(u*g-c*v)-s*(i*g-o*v)+m*(i*c-o*u),t[3]=-(r*(u*p-c*f)-s*(i*p-o*f)+h*(i*c-o*u)),t[4]=-(a*(f*g-p*v)-l*(u*g-c*v)+d*(u*p-c*f)),t[5]=n*(f*g-p*v)-l*(i*g-o*v)+d*(i*p-o*f),t[6]=-(n*(u*g-c*v)-a*(i*g-o*v)+d*(i*c-o*u)),t[7]=n*(u*p-c*f)-a*(i*p-o*f)+l*(i*c-o*u),t[8]=a*(h*g-p*m)-l*(s*g-c*m)+d*(s*p-c*h),t[9]=-(n*(h*g-p*m)-l*(r*g-o*m)+d*(r*p-o*h)),t[10]=n*(s*g-c*m)-a*(r*g-o*m)+d*(r*c-o*s),t[11]=-(n*(s*p-c*h)-a*(r*p-o*h)+l*(r*c-o*s)),t[12]=-(a*(h*v-f*m)-l*(s*v-u*m)+d*(s*f-u*h)),t[13]=n*(h*v-f*m)-l*(r*v-i*m)+d*(r*f-i*h),t[14]=-(n*(s*v-u*m)-a*(r*v-i*m)+d*(r*u-i*s)),t[15]=n*(s*f-u*h)-a*(r*f-i*h)+l*(r*u-i*s),t},clone:ro,copy:io,create:no,determinant:lo,equals:Lo,exactEquals:function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]},frob:function(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])},fromQuat:Eo,fromQuat2:function(t,e){var n=new Ji(3),r=-e[0],i=-e[1],o=-e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],h=r*r+i*i+o*o+a*a;return h>0?(n[0]=2*(s*a+l*r+u*o-c*i)/h,n[1]=2*(u*a+l*i+c*r-s*o)/h,n[2]=2*(c*a+l*o+s*i-u*r)/h):(n[0]=2*(s*a+l*r+u*o-c*i),n[1]=2*(u*a+l*i+c*r-s*o),n[2]=2*(c*a+l*o+s*i-u*r)),bo(t,e,n),t},fromRotation:function(t,e,n){var r,i,o,a=n[0],s=n[1],u=n[2],c=Math.hypot(a,s,u);return c<Ki?null:(a*=c=1/c,s*=c,u*=c,r=Math.sin(e),o=1-(i=Math.cos(e)),t[0]=a*a*o+i,t[1]=s*a*o+u*r,t[2]=u*a*o-s*r,t[3]=0,t[4]=a*s*o-u*r,t[5]=s*s*o+i,t[6]=u*s*o+a*r,t[7]=0,t[8]=a*u*o+s*r,t[9]=s*u*o-a*r,t[10]=u*u*o+i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},fromRotationTranslation:bo,fromRotationTranslationScale:function(t,e,n,r){var i=e[0],o=e[1],a=e[2],s=e[3],u=i+i,c=o+o,l=a+a,h=i*u,f=i*c,p=i*l,d=o*c,m=o*l,v=a*l,g=s*u,y=s*c,x=s*l,b=r[0],_=r[1],w=r[2];return t[0]=(1-(d+v))*b,t[1]=(f+x)*b,t[2]=(p-y)*b,t[3]=0,t[4]=(f-x)*_,t[5]=(1-(h+v))*_,t[6]=(m+g)*_,t[7]=0,t[8]=(p+y)*w,t[9]=(m-g)*w,t[10]=(1-(h+d))*w,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},fromRotationTranslationScaleOrigin:Mo,fromScaling:xo,fromTranslation:yo,fromValues:oo,fromXRotation:function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},fromYRotation:function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},fromZRotation:function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},frustum:function(t,e,n,r,i,o,a){var s=1/(n-e),u=1/(i-r),c=1/(o-a);return t[0]=2*o*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*u,t[6]=0,t[7]=0,t[8]=(n+e)*s,t[9]=(i+r)*u,t[10]=(a+o)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*o*2*c,t[15]=0,t},getRotation:So,getScaling:wo,getTranslation:_o,identity:so,invert:co,lookAt:ko,mul:Ro,multiply:ho,multiplyScalar:function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t},multiplyScalarAndAdd:function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t[9]=e[9]+n[9]*r,t[10]=e[10]+n[10]*r,t[11]=e[11]+n[11]*r,t[12]=e[12]+n[12]*r,t[13]=e[13]+n[13]*r,t[14]=e[14]+n[14]*r,t[15]=e[15]+n[15]*r,t},ortho:Oo,orthoNO:Co,orthoZO:function(t,e,n,r,i,o,a){var s=1/(e-n),u=1/(r-i),c=1/(o-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=c,t[11]=0,t[12]=(e+n)*s,t[13]=(i+r)*u,t[14]=o*c,t[15]=1,t},perspective:To,perspectiveFromFieldOfView:function(t,e,n,r){var i=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),a=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),u=2/(a+s),c=2/(i+o);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-(a-s)*u*.5,t[9]=(i-o)*c*.5,t[10]=r/(n-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*n/(n-r),t[15]=0,t},perspectiveNO:Ao,perspectiveZO:function(t,e,n,r,i){var o,a=1/Math.tan(e/2);return t[0]=a/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(o=1/(r-i),t[10]=i*o,t[14]=i*r*o):(t[10]=-1,t[14]=-r),t},rotate:function(t,e,n,r){var i,o,a,s,u,c,l,h,f,p,d,m,v,g,y,x,b,_,w,S,M,E,A,T,C=r[0],O=r[1],k=r[2],P=Math.hypot(C,O,k);return P<Ki?null:(C*=P=1/P,O*=P,k*=P,i=Math.sin(n),a=1-(o=Math.cos(n)),s=e[0],u=e[1],c=e[2],l=e[3],h=e[4],f=e[5],p=e[6],d=e[7],m=e[8],v=e[9],g=e[10],y=e[11],x=C*C*a+o,b=O*C*a+k*i,_=k*C*a-O*i,w=C*O*a-k*i,S=O*O*a+o,M=k*O*a+C*i,E=C*k*a+O*i,A=O*k*a-C*i,T=k*k*a+o,t[0]=s*x+h*b+m*_,t[1]=u*x+f*b+v*_,t[2]=c*x+p*b+g*_,t[3]=l*x+d*b+y*_,t[4]=s*w+h*S+m*M,t[5]=u*w+f*S+v*M,t[6]=c*w+p*S+g*M,t[7]=l*w+d*S+y*M,t[8]=s*E+h*A+m*T,t[9]=u*E+f*A+v*T,t[10]=c*E+p*A+g*T,t[11]=l*E+d*A+y*T,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)},rotateX:mo,rotateY:vo,rotateZ:go,scale:po,set:ao,str:function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},sub:Io,subtract:Po,targetTo:function(t,e,n,r){var i=e[0],o=e[1],a=e[2],s=r[0],u=r[1],c=r[2],l=i-n[0],h=o-n[1],f=a-n[2],p=l*l+h*h+f*f;p>0&&(l*=p=1/Math.sqrt(p),h*=p,f*=p);var d=u*f-c*h,m=c*l-s*f,v=s*h-u*l;return(p=d*d+m*m+v*v)>0&&(d*=p=1/Math.sqrt(p),m*=p,v*=p),t[0]=d,t[1]=m,t[2]=v,t[3]=0,t[4]=h*v-f*m,t[5]=f*d-l*v,t[6]=l*m-h*d,t[7]=0,t[8]=l,t[9]=h,t[10]=f,t[11]=0,t[12]=i,t[13]=o,t[14]=a,t[15]=1,t},translate:fo,transpose:uo},Symbol.toStringTag,{value:"Module"}));function Do(){var t=new Ji(3);return Ji!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function Fo(t){var e=new Ji(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function jo(t){var e=t[0],n=t[1],r=t[2];return Math.hypot(e,n,r)}function Bo(t,e,n){var r=new Ji(3);return r[0]=t,r[1]=e,r[2]=n,r}function zo(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Uo(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t}function Vo(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function Go(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function Wo(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function Ho(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function Yo(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t}function Xo(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}function qo(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function Zo(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return Math.hypot(n,r,i)}function $o(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return n*n+r*r+i*i}function Ko(t){var e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r}function Jo(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function Qo(t,e){var n=e[0],r=e[1],i=e[2],o=n*n+r*r+i*i;return o>0&&(o=1/Math.sqrt(o)),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t}function ta(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function ea(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[0],s=n[1],u=n[2];return t[0]=i*u-o*s,t[1]=o*a-r*u,t[2]=r*s-i*a,t}function na(t,e,n,r){var i=e[0],o=e[1],a=e[2];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t[2]=a+r*(n[2]-a),t}function ra(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[3]*r+n[7]*i+n[11]*o+n[15];return a=a||1,t[0]=(n[0]*r+n[4]*i+n[8]*o+n[12])/a,t[1]=(n[1]*r+n[5]*i+n[9]*o+n[13])/a,t[2]=(n[2]*r+n[6]*i+n[10]*o+n[14])/a,t}function ia(t,e,n){var r=e[0],i=e[1],o=e[2];return t[0]=r*n[0]+i*n[3]+o*n[6],t[1]=r*n[1]+i*n[4]+o*n[7],t[2]=r*n[2]+i*n[5]+o*n[8],t}function oa(t,e,n){var r=n[0],i=n[1],o=n[2],a=n[3],s=e[0],u=e[1],c=e[2],l=i*c-o*u,h=o*s-r*c,f=r*u-i*s,p=i*f-o*h,d=o*l-r*f,m=r*h-i*l,v=2*a;return l*=v,h*=v,f*=v,p*=2,d*=2,m*=2,t[0]=s+l+p,t[1]=u+h+d,t[2]=c+f+m,t}function aa(t,e){var n=t[0],r=t[1],i=t[2],o=e[0],a=e[1],s=e[2],u=Math.sqrt(n*n+r*r+i*i)*Math.sqrt(o*o+a*a+s*s),c=u&&ta(t,e)/u;return Math.acos(Math.min(Math.max(c,-1),1))}function sa(t,e){var n=t[0],r=t[1],i=t[2],o=e[0],a=e[1],s=e[2];return Math.abs(n-o)<=Ki*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-a)<=Ki*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(i-s)<=Ki*Math.max(1,Math.abs(i),Math.abs(s))}var ua,ca=Go,la=Wo,ha=Ho,fa=Zo,pa=$o,da=jo,ma=Ko,va=(ua=Do(),function(t,e,n,r,i,o){var a,s;for(e||(e=3),n||(n=0),s=r?Math.min(r*e+n,t.length):t.length,a=n;a<s;a+=e)ua[0]=t[a],ua[1]=t[a+1],ua[2]=t[a+2],i(ua,ua,o),t[a]=ua[0],t[a+1]=ua[1],t[a+2]=ua[2];return t});const ga=Object.freeze(Object.defineProperty({__proto__:null,add:Vo,angle:aa,bezier:function(t,e,n,r,i,o){var a=1-o,s=a*a,u=o*o,c=s*a,l=3*o*s,h=3*u*a,f=u*o;return t[0]=e[0]*c+n[0]*l+r[0]*h+i[0]*f,t[1]=e[1]*c+n[1]*l+r[1]*h+i[1]*f,t[2]=e[2]*c+n[2]*l+r[2]*h+i[2]*f,t},ceil:function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t},clone:Fo,copy:zo,create:Do,cross:ea,dist:fa,distance:Zo,div:ha,divide:Ho,dot:ta,equals:sa,exactEquals:function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},floor:function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t},forEach:va,fromValues:Bo,hermite:function(t,e,n,r,i,o){var a=o*o,s=a*(2*o-3)+1,u=a*(o-2)+o,c=a*(o-1),l=a*(3-2*o);return t[0]=e[0]*s+n[0]*u+r[0]*c+i[0]*l,t[1]=e[1]*s+n[1]*u+r[1]*c+i[1]*l,t[2]=e[2]*s+n[2]*u+r[2]*c+i[2]*l,t},inverse:function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},len:da,length:jo,lerp:na,max:Xo,min:Yo,mul:la,multiply:Wo,negate:Jo,normalize:Qo,random:function(t,e){e=e||1;var n=2*Qi()*Math.PI,r=2*Qi()-1,i=Math.sqrt(1-r*r)*e;return t[0]=Math.cos(n)*i,t[1]=Math.sin(n)*i,t[2]=r*e,t},rotateX:function(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0],o[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),o[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t},rotateY:function(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),o[1]=i[1],o[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t},rotateZ:function(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),o[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),o[2]=i[2],t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t},round:function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t},scale:qo,scaleAndAdd:function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t},set:Uo,sqrDist:pa,sqrLen:ma,squaredDistance:$o,squaredLength:Ko,str:function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},sub:ca,subtract:Go,transformMat3:ia,transformMat4:ra,transformQuat:oa,zero:function(t){return t[0]=0,t[1]=0,t[2]=0,t}},Symbol.toStringTag,{value:"Module"}));function ya(){var t=new Ji(4);return Ji!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function xa(t,e,n,r){var i=new Ji(4);return i[0]=t,i[1]=e,i[2]=n,i[3]=r,i}function ba(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*a,t[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*a,t[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*a,t[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*a,t}function _a(){var t=new Ji(4);return Ji!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function wa(t,e,n){n*=.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function Sa(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=n[0],u=n[1],c=n[2],l=n[3];return t[0]=r*l+a*s+i*c-o*u,t[1]=i*l+a*u+o*s-r*c,t[2]=o*l+a*c+r*u-i*s,t[3]=a*l-r*s-i*u-o*c,t}function Ma(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n*n+r*r+i*i+o*o,s=a?1/a:0;return t[0]=-n*s,t[1]=-r*s,t[2]=-i*s,t[3]=o*s,t}function Ea(t,e,n,r){var i=.5*Math.PI/180;e*=i,n*=i,r*=i;var o=Math.sin(e),a=Math.cos(e),s=Math.sin(n),u=Math.cos(n),c=Math.sin(r),l=Math.cos(r);return t[0]=o*u*l-a*s*c,t[1]=a*s*l+o*u*c,t[2]=a*u*c-o*s*l,t[3]=a*u*l+o*s*c,t}!function(){var t=ya()}();var Aa=xa,Ta=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},Ca=Sa,Oa=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n*n+r*r+i*i+o*o;return a>0&&(a=1/Math.sqrt(a)),t[0]=n*a,t[1]=r*a,t[2]=i*a,t[3]=o*a,t};function ka(){var t=new Ji(2);return Ji!=Float32Array&&(t[0]=0,t[1]=0),t}function Pa(t,e){var n=new Ji(2);return n[0]=t,n[1]=e,n}function La(t,e){return t[0]=e[0],t[1]=e[1],t}function Ra(t,e,n){return t[0]=e,t[1]=n,t}function Ia(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function Na(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function Da(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t}function Fa(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t}function ja(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}function Ba(t,e){var n=e[0]-t[0],r=e[1]-t[1];return Math.hypot(n,r)}function za(t,e){var n=e[0],r=e[1],i=n*n+r*r;return i>0&&(i=1/Math.sqrt(i)),t[0]=e[0]*i,t[1]=e[1]*i,t}function Ua(t,e){return t[0]*e[0]+t[1]*e[1]}function Va(t,e,n,r){var i=e[0],o=e[1];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t}function Ga(t,e,n,r){var i=e[0]-n[0],o=e[1]-n[1],a=Math.sin(r),s=Math.cos(r);return t[0]=i*s-o*a+n[0],t[1]=i*a+o*s+n[1],t}function Wa(t,e){return t[0]===e[0]&&t[1]===e[1]}Do(),Bo(1,0,0),Bo(0,1,0),_a(),_a(),to();var Ha=Na;function Ya(t){return t.map((function(t){return Array.isArray(t)?[].concat(t):t}))}!function(){var t=ka()}();var Xa=function(t,e){return(Xa=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function qa(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}Xa(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var Za=function(){return Za=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},Za.apply(this,arguments)};function $a(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}function Ka(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a}function Ja(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Qa(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function ts(t,e,n){if(n||2===arguments.length)for(var r,i=0,o=e.length;i<o;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))}function es(t,e,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(t):r?r.value:e.get(t)}var ns={x1:0,y1:0,x2:0,y2:0,x:0,y:0,qx:null,qy:null};function rs(t,e,n){if(t[n].length>7){t[n].shift();for(var r=t[n],i=n;r.length;)e[n]="A",t.splice(i+=1,0,["C"].concat(r.splice(0,6)));t.splice(n,1)}}var is={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0};function os(t){return Array.isArray(t)&&t.every((function(t){var e=t[0].toLowerCase();return is[e]===t.length-1&&"achlmqstvz".includes(e)}))}function as(t){return os(t)&&t.every((function(t){var e=t[0];return e===e.toUpperCase()}))}function ss(t){return as(t)&&t.every((function(t){var e=t[0];return"ACLMQZ".includes(e)}))}function us(t){for(var e=t.pathValue[t.segmentStart],n=e.toLowerCase(),r=t.data;r.length>=is[n]&&("m"===n&&r.length>2?(t.segments.push([e].concat(r.splice(0,2))),n="l",e="m"===e?"l":"L"):t.segments.push([e].concat(r.splice(0,is[n]))),is[n]););}function cs(t){var e=t.index,n=t.pathValue,r=n.charCodeAt(e);return 48===r?(t.param=0,void(t.index+=1)):49===r?(t.param=1,void(t.index+=1)):void(t.err='[path-util]: invalid Arc flag "'+n[e]+'", expecting 0 or 1 at index '+e)}function ls(t){return t>=48&&t<=57||43===t||45===t||46===t}function hs(t){return t>=48&&t<=57}function fs(t){var e,n=t.max,r=t.pathValue,i=t.index,o=i,a=!1,s=!1,u=!1,c=!1;if(o>=n)t.err="[path-util]: Invalid path value at index "+o+', "pathValue" is missing param';else if(43!==(e=r.charCodeAt(o))&&45!==e||(o+=1,e=r.charCodeAt(o)),hs(e)||46===e){if(46!==e){if(a=48===e,o+=1,e=r.charCodeAt(o),a&&o<n&&e&&hs(e))return void(t.err="[path-util]: Invalid path value at index "+i+', "'+r[i]+'" illegal number');for(;o<n&&hs(r.charCodeAt(o));)o+=1,s=!0;e=r.charCodeAt(o)}if(46===e){for(c=!0,o+=1;hs(r.charCodeAt(o));)o+=1,u=!0;e=r.charCodeAt(o)}if(101===e||69===e){if(c&&!s&&!u)return void(t.err="[path-util]: Invalid path value at index "+o+', "'+r[o]+'" invalid float exponent');if(o+=1,43!==(e=r.charCodeAt(o))&&45!==e||(o+=1),!(o<n&&hs(r.charCodeAt(o))))return void(t.err="[path-util]: Invalid path value at index "+o+', "'+r[o]+'" invalid integer exponent');for(;o<n&&hs(r.charCodeAt(o));)o+=1}t.index=o,t.param=+t.pathValue.slice(i,o)}else t.err="[path-util]: Invalid path value at index "+o+', "'+r[o]+'" is not a number'}function ps(t){for(var e,n=t.pathValue,r=t.max;t.index<r&&(10===(e=n.charCodeAt(t.index))||13===e||8232===e||8233===e||32===e||9===e||11===e||12===e||160===e||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].includes(e));)t.index+=1}function ds(t){var e=t.max,n=t.pathValue,r=t.index,i=n.charCodeAt(r),o=is[n[r].toLowerCase()];if(t.segmentStart=r,function(t){switch(32|t){case 109:case 122:case 108:case 104:case 118:case 99:case 115:case 113:case 116:case 97:return!0;default:return!1}}(i))if(t.index+=1,ps(t),t.data=[],o){for(;;){for(var a=o;a>0;a-=1){if(97!=(32|i)||3!==a&&4!==a?fs(t):cs(t),t.err.length)return;t.data.push(t.param),ps(t),t.index<e&&44===n.charCodeAt(t.index)&&(t.index+=1,ps(t))}if(t.index>=t.max)break;if(!ls(n.charCodeAt(t.index)))break}us(t)}else us(t);else t.err='[path-util]: Invalid path value "'+n[r]+'" is not a path command'}var ms=function(t){this.pathValue=t,this.segments=[],this.max=t.length,this.index=0,this.param=0,this.segmentStart=0,this.data=[],this.err=""};function vs(t){if(as(t))return Ya(t);var e=function(t){if(os(t))return Ya(t);var e=new ms(t);for(ps(e);e.index<e.max&&!e.err.length;)ds(e);return e.err?e.err:e.segments}(t),n=0,r=0,i=0,o=0;return e.map((function(t){var e,a=t.slice(1).map(Number),s=t[0],u=s.toUpperCase();if("M"===s)return n=a[0],r=a[1],i=n,o=r,["M",n,r];if(s!==u)switch(u){case"A":e=[u,a[0],a[1],a[2],a[3],a[4],a[5]+n,a[6]+r];break;case"V":e=[u,a[0]+r];break;case"H":e=[u,a[0]+n];break;default:var c=a.map((function(t,e){return t+(e%2?r:n)}));e=[u].concat(c)}else e=[u].concat(a);var l=e.length;switch(u){case"Z":n=i,r=o;break;case"H":n=e[1];break;case"V":r=e[1];break;default:n=e[l-2],r=e[l-1],"M"===u&&(i=n,o=r)}return e}))}function gs(t,e){var n=t[0],r=e.x1,i=e.y1,o=e.x2,a=e.y2,s=t.slice(1).map(Number),u=t;if("TQ".includes(n)||(e.qx=null,e.qy=null),"H"===n)u=["L",t[1],i];else if("V"===n)u=["L",r,t[1]];else if("S"===n){var c=2*r-o,l=2*i-a;e.x1=c,e.y1=l,u=["C",c,l].concat(s)}else if("T"===n){var h=2*r-e.qx,f=2*i-e.qy;e.qx=h,e.qy=f,u=["Q",h,f].concat(s)}else if("Q"===n){var p=s[0],d=s[1];e.qx=p,e.qy=d}return u}function ys(t){if(ss(t))return Ya(t);for(var e=vs(t),n=Za({},ns),r=0;r<e.length;r+=1){e[r]=gs(e[r],n);var i=e[r],o=i.length;n.x1=+i[o-2],n.y1=+i[o-1],n.x2=+i[o-4]||n.x1,n.y2=+i[o-3]||n.y1}return e}function xs(t,e,n){return{x:t*Math.cos(n)-e*Math.sin(n),y:t*Math.sin(n)+e*Math.cos(n)}}function bs(t,e,n,r,i,o,a,s,u,c){var l,h,f,p,d,m=t,v=e,g=n,y=r,x=s,b=u,_=120*Math.PI/180,w=Math.PI/180*(+i||0),S=[];if(c)h=c[0],f=c[1],p=c[2],d=c[3];else{m=(l=xs(m,v,-w)).x,v=l.y;var M=(m-(x=(l=xs(x,b,-w)).x))/2,E=(v-(b=l.y))/2,A=M*M/(g*g)+E*E/(y*y);A>1&&(g*=A=Math.sqrt(A),y*=A);var T=g*g,C=y*y,O=(o===a?-1:1)*Math.sqrt(Math.abs((T*C-T*E*E-C*M*M)/(T*E*E+C*M*M)));p=O*g*E/y+(m+x)/2,d=O*-y*M/g+(v+b)/2,h=Math.asin(((v-d)/y*Math.pow(10,9)>>0)/Math.pow(10,9)),f=Math.asin(((b-d)/y*Math.pow(10,9)>>0)/Math.pow(10,9)),h=m<p?Math.PI-h:h,f=x<p?Math.PI-f:f,h<0&&(h=2*Math.PI+h),f<0&&(f=2*Math.PI+f),a&&h>f&&(h-=2*Math.PI),!a&&f>h&&(f-=2*Math.PI)}var k=f-h;if(Math.abs(k)>_){var P=f,L=x,R=b;f=h+_*(a&&f>h?1:-1),S=bs(x=p+g*Math.cos(f),b=d+y*Math.sin(f),g,y,i,0,a,L,R,[f,P,p,d])}k=f-h;var I=Math.cos(h),N=Math.sin(h),D=Math.cos(f),F=Math.sin(f),j=Math.tan(k/4),B=4/3*g*j,z=4/3*y*j,U=[m,v],V=[m+B*N,v-z*I],G=[x+B*F,b-z*D],W=[x,b];if(V[0]=2*U[0]-V[0],V[1]=2*U[1]-V[1],c)return V.concat(G,W,S);for(var H=[],Y=0,X=(S=V.concat(G,W,S)).length;Y<X;Y+=1)H[Y]=Y%2?xs(S[Y-1],S[Y],w).y:xs(S[Y],S[Y+1],w).x;return H}function _s(t,e,n){var r=t[0],i=t[1];return[r+(e[0]-r)*n,i+(e[1]-i)*n]}function ws(t,e){return Math.sqrt((t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1]))}function Ss(t,e,n,r,i){var o=ws([t,e],[n,r]),a={x:0,y:0};if("number"==typeof i)if(i<=0)a={x:t,y:e};else if(i>=o)a={x:n,y:r};else{var s=_s([t,e],[n,r],i/o);a={x:s[0],y:s[1]}}return{length:o,point:a,min:{x:Math.min(t,n),y:Math.min(e,r)},max:{x:Math.max(t,n),y:Math.max(e,r)}}}function Ms(t,e,n,r){var i=.5,o=[t,e],a=[n,r],s=_s(o,a,i),u=_s(a,s,i),c=_s(s,u,i),l=_s(u,c,i),h=_s(c,l,i),f=Ss(o[0],o[1],s[0],s[1],c[0]).point,p=Ss(h[0],h[1],l[0],l[1],u[0]).point;return[f.x,f.y,p.x,p.y,n,r]}function Es(t,e){var n,r=t[0],i=t.slice(1).map(Number),o=i[0],a=i[1],s=e.x1,u=e.y1,c=e.x,l=e.y;switch("TQ".includes(r)||(e.qx=null,e.qy=null),r){case"M":return e.x=o,e.y=a,t;case"A":return n=[s,u].concat(i),["C"].concat(bs(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8],n[9]));case"Q":return e.qx=o,e.qy=a,n=[s,u].concat(i),["C"].concat(function(t,e,n,r,i,o){var a=1/3,s=2/3;return[a*t+s*n,a*e+s*r,a*i+s*n,a*o+s*r,i,o]}(n[0],n[1],n[2],n[3],n[4],n[5]));case"L":return["C"].concat(Ms(s,u,o,a));case"Z":return s===c&&u===l?["C",s,u,c,l,c,l]:["C"].concat(Ms(s,u,c,l))}return t}function As(t,e){if(void 0===e&&(e=!1),function(t){return ss(t)&&t.every((function(t){var e=t[0];return"MC".includes(e)}))}(t)){var n=Ya(t);return e?[n,[]]:n}for(var r,i,o=ys(t),a=Za({},ns),s=[],u="",c=o.length,l=[],h=0;h<c;h+=1){o[h]&&(u=o[h][0]),s[h]=u;var f=Es(o[h],a);o[h]=f,rs(o,s,h),c=o.length,"Z"===u&&l.push(h),i=(r=o[h]).length,a.x1=+r[i-2],a.y1=+r[i-1],a.x2=+r[i-4]||a.x1,a.y2=+r[i-3]||a.y1}return e?[o,l]:o}function Ts(t,e){var n=t.x,r=t.y,i=e.x,o=e.y,a=n*i+r*o,s=Math.sqrt((Math.pow(n,2)+Math.pow(r,2))*(Math.pow(i,2)+Math.pow(o,2)));return(n*o-r*i<0?-1:1)*Math.acos(a/s)}function Cs(t,e,n,r,i,o,a,s,u,c){var l=Math.abs,h=Math.sin,f=Math.cos,p=Math.sqrt,d=Math.PI,m=l(n),v=l(r),g=(i%360+360)%360*(d/180);if(t===s&&e===u)return{x:t,y:e};if(0===m||0===v)return Ss(t,e,s,u,c).point;var y=(t-s)/2,x=(e-u)/2,b={x:f(g)*y+h(g)*x,y:-h(g)*y+f(g)*x},_=Math.pow(b.x,2)/Math.pow(m,2)+Math.pow(b.y,2)/Math.pow(v,2);_>1&&(m*=p(_),v*=p(_));var w=(Math.pow(m,2)*Math.pow(v,2)-Math.pow(m,2)*Math.pow(b.y,2)-Math.pow(v,2)*Math.pow(b.x,2))/(Math.pow(m,2)*Math.pow(b.y,2)+Math.pow(v,2)*Math.pow(b.x,2)),S=(o!==a?1:-1)*p(w=w<0?0:w),M=S*(m*b.y/v),E=S*(-v*b.x/m),A=f(g)*M-h(g)*E+(t+s)/2,T=h(g)*M+f(g)*E+(e+u)/2,C={x:(b.x-M)/m,y:(b.y-E)/v},O=Ts({x:1,y:0},C),k=Ts(C,{x:(-b.x-M)/m,y:(-b.y-E)/v});!a&&k>0?k-=2*d:a&&k<0&&(k+=2*d);var P=O+(k%=2*d)*c,L=m*f(P),R=v*h(P);return{x:f(g)*L-h(g)*R+A,y:h(g)*L+f(g)*R+T}}function Os(t,e,n,r,i,o,a,s,u,c,l){var h,f=l.bbox,p=void 0===f||f,d=l.length,m=void 0===d||d,v=l.sampleSize,g=void 0===v?30:v,y="number"==typeof c,x=t,b=e,_=0,w=[x,b,_],S=[x,b],M={x:0,y:0},E=[{x:x,y:b}];y&&c<=0&&(M={x:x,y:b});for(var A=0;A<=g;A+=1){if(x=(h=Cs(t,e,n,r,i,o,a,s,u,A/g)).x,b=h.y,p&&E.push({x:x,y:b}),m&&(_+=ws(S,[x,b])),S=[x,b],y&&_>=c&&c>w[2]){var T=(_-c)/(_-w[2]);M={x:S[0]*(1-T)+w[0]*T,y:S[1]*(1-T)+w[1]*T}}w=[x,b,_]}return y&&c>=_&&(M={x:s,y:u}),{length:_,point:M,min:{x:Math.min.apply(null,E.map((function(t){return t.x}))),y:Math.min.apply(null,E.map((function(t){return t.y})))},max:{x:Math.max.apply(null,E.map((function(t){return t.x}))),y:Math.max.apply(null,E.map((function(t){return t.y})))}}}function ks(t,e,n,r,i,o,a,s,u){var c=1-u;return{x:Math.pow(c,3)*t+3*Math.pow(c,2)*u*n+3*c*Math.pow(u,2)*i+Math.pow(u,3)*a,y:Math.pow(c,3)*e+3*Math.pow(c,2)*u*r+3*c*Math.pow(u,2)*o+Math.pow(u,3)*s}}function Ps(t,e,n,r,i,o,a,s,u,c){var l,h=c.bbox,f=void 0===h||h,p=c.length,d=void 0===p||p,m=c.sampleSize,v=void 0===m?10:m,g="number"==typeof u,y=t,x=e,b=0,_=[y,x,b],w=[y,x],S={x:0,y:0},M=[{x:y,y:x}];g&&u<=0&&(S={x:y,y:x});for(var E=0;E<=v;E+=1){if(y=(l=ks(t,e,n,r,i,o,a,s,E/v)).x,x=l.y,f&&M.push({x:y,y:x}),d&&(b+=ws(w,[y,x])),w=[y,x],g&&b>=u&&u>_[2]){var A=(b-u)/(b-_[2]);S={x:w[0]*(1-A)+_[0]*A,y:w[1]*(1-A)+_[1]*A}}_=[y,x,b]}return g&&u>=b&&(S={x:a,y:s}),{length:b,point:S,min:{x:Math.min.apply(null,M.map((function(t){return t.x}))),y:Math.min.apply(null,M.map((function(t){return t.y})))},max:{x:Math.max.apply(null,M.map((function(t){return t.x}))),y:Math.max.apply(null,M.map((function(t){return t.y})))}}}function Ls(t,e,n,r,i,o,a){var s=1-a;return{x:Math.pow(s,2)*t+2*s*a*n+Math.pow(a,2)*i,y:Math.pow(s,2)*e+2*s*a*r+Math.pow(a,2)*o}}function Rs(t,e,n,r,i,o,a,s){var u,c=s.bbox,l=void 0===c||c,h=s.length,f=void 0===h||h,p=s.sampleSize,d=void 0===p?10:p,m="number"==typeof a,v=t,g=e,y=0,x=[v,g,y],b=[v,g],_={x:0,y:0},w=[{x:v,y:g}];m&&a<=0&&(_={x:v,y:g});for(var S=0;S<=d;S+=1){if(v=(u=Ls(t,e,n,r,i,o,S/d)).x,g=u.y,l&&w.push({x:v,y:g}),f&&(y+=ws(b,[v,g])),b=[v,g],m&&y>=a&&a>x[2]){var M=(y-a)/(y-x[2]);_={x:b[0]*(1-M)+x[0]*M,y:b[1]*(1-M)+x[1]*M}}x=[v,g,y]}return m&&a>=y&&(_={x:i,y:o}),{length:y,point:_,min:{x:Math.min.apply(null,w.map((function(t){return t.x}))),y:Math.min.apply(null,w.map((function(t){return t.y})))},max:{x:Math.max.apply(null,w.map((function(t){return t.x}))),y:Math.max.apply(null,w.map((function(t){return t.y})))}}}function Is(t,e,n){for(var r,i,o,a,s,u,c,l,h,f=ys(t),p="number"==typeof e,d=[],m=0,v=0,g=0,y=0,x=[],b=[],_=0,w={x:0,y:0},S=w,M=w,E=w,A=0,T=0,C=f.length;T<C;T+=1)d=(c="M"===(l=(h=f[T])[0]))?d:[m,v].concat(h.slice(1)),c?(S=w={x:g=h[1],y:y=h[2]},_=0,p&&e<.001&&(E=w)):"L"===l?(_=(r=Ss(d[0],d[1],d[2],d[3],(e||0)-A)).length,w=r.min,S=r.max,M=r.point):"A"===l?(_=(i=Os(d[0],d[1],d[2],d[3],d[4],d[5],d[6],d[7],d[8],(e||0)-A,n||{})).length,w=i.min,S=i.max,M=i.point):"C"===l?(_=(o=Ps(d[0],d[1],d[2],d[3],d[4],d[5],d[6],d[7],(e||0)-A,n||{})).length,w=o.min,S=o.max,M=o.point):"Q"===l?(_=(a=Rs(d[0],d[1],d[2],d[3],d[4],d[5],(e||0)-A,n||{})).length,w=a.min,S=a.max,M=a.point):"Z"===l&&(_=(s=Ss((d=[m,v,g,y])[0],d[1],d[2],d[3],(e||0)-A)).length,w=s.min,S=s.max,M=s.point),p&&A<e&&A+_>=e&&(E=M),b.push(S),x.push(w),A+=_,m=(u="Z"!==l?h.slice(-2):[g,y])[0],v=u[1];return p&&e>=A&&(E={x:m,y:v}),{length:A,point:E,min:{x:Math.min.apply(null,x.map((function(t){return t.x}))),y:Math.min.apply(null,x.map((function(t){return t.y})))},max:{x:Math.max.apply(null,b.map((function(t){return t.x}))),y:Math.max.apply(null,b.map((function(t){return t.y})))}}}function Ns(t){return e=0,n=0,r=0,As(t).map((function(t){var i;if("M"===t[0])return e=t[1],n=t[2],0;var o=t.slice(1),a=o[0],s=o[1],u=o[2],c=o[3],l=o[4],h=o[5];return r=function(t,e,n,r,i,o,a,s){return 3*((s-e)*(n+i)-(a-t)*(r+o)+r*(t-i)-n*(e-o)+s*(i+t/3)-a*(o+e/3))/20}(e,n,a,s,u,c,l,h),i=t.slice(-2),e=i[0],n=i[1],r})).reduce((function(t,e){return t+e}),0)>=0;var e,n,r}function Ds(t){return t.map((function(t,e,n){var r=e&&n[e-1].slice(-2).concat(t.slice(1)),i=e?Ps(r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7],r[8],{bbox:!1}).length:0;return{s:t,ss:e?i?function(t,e){void 0===e&&(e=.5);var n=t.slice(0,2),r=t.slice(2,4),i=t.slice(4,6),o=t.slice(6,8),a=_s(n,r,e),s=_s(r,i,e),u=_s(i,o,e),c=_s(a,s,e),l=_s(s,u,e),h=_s(c,l,e);return[["C"].concat(a,c,h),["C"].concat(l,u,o)]}(r):[t,t]:[t],l:i}}))}function Fs(t,e,n){var r=Ds(t),i=Ds(e),o=r.length,a=i.length,s=r.filter((function(t){return t.l})).length,u=i.filter((function(t){return t.l})).length,c=r.filter((function(t){return t.l})).reduce((function(t,e){return t+e.l}),0)/s||0,l=i.filter((function(t){return t.l})).reduce((function(t,e){return t+e.l}),0)/u||0,h=n||Math.max(o,a),f=[c,l],p=[h-o,h-a],d=0,m=[r,i].map((function(t,e){return t.l===h?t.map((function(t){return t.s})):t.map((function(t,n){return d=n&&p[e]&&t.l>=f[e],p[e]-=d?1:0,d?t.ss:[t.s]})).flat()}));return m[0].length===m[1].length?m:Fs(m[0],m[1],h)}const js=function(t){return null!==t&&"function"!=typeof t&&isFinite(t.length)},Bs=function(t){return"function"==typeof t};const zs=function(t){return null==t};var Us={}.toString;const Vs=function(t,e){return Us.call(t)==="[object "+e+"]"},Gs=function(t){return Array.isArray?Array.isArray(t):Vs(t,"Array")},Ws=function(t){var e=typeof t;return null!==t&&"object"===e||"function"===e};function Hs(t,e){if(t)if(Gs(t))for(var n=0,r=t.length;n<r&&!1!==e(t[n],n);n++);else if(Ws(t))for(var i in t)if(t.hasOwnProperty(i)&&!1===e(t[i],i))break}const Ys=function(t){return"object"==typeof t&&null!==t};const Xs=function(t){if(!Ys(t)||!Vs(t,"Object"))return!1;if(null===Object.getPrototypeOf(t))return!0;for(var e=t;null!==Object.getPrototypeOf(e);)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e},qs=function(t){if(Gs(t))return t.reduce((function(t,e){return Math.max(t,e)}),t[0])},Zs=function(t){if(Gs(t))return t.reduce((function(t,e){return Math.min(t,e)}),t[0])},$s=function(t){return Vs(t,"String")};const Ks=function(t,e,n){return t<e?e:t>n?n:t};const Js=function(t){return Vs(t,"Number")};const Qs=function(t,e){if(Gs(t)){for(var n,r=-1/0,i=0;i<t.length;i++){var o=t[i],a=Bs(e)?e(o):o[e];a>r&&(n=o,r=a)}return n}},tu=function(t,e){if(Gs(t)){for(var n,r=1/0,i=0;i<t.length;i++){var o=t[i],a=Bs(e)?e(o):o[e];a<r&&(n=o,r=a)}return n}};const eu=function(t,e){return(t%e+e)%e};var nu=Object.values?function(t){return Object.values(t)}:function(t){var e=[];return Hs(t,(function(n,r){Bs(t)&&"prototype"===r||e.push(n)})),e};const ru=nu;const iu=function(t){return Vs(t,"Boolean")};const ou=function(t){return void 0===t};const au=function(t){return t instanceof Element||t instanceof HTMLDocument};function su(t,e){for(var n in e)e.hasOwnProperty(n)&&"constructor"!==n&&void 0!==e[n]&&(t[n]=e[n])}function uu(t,e,n,r){return e&&su(t,e),n&&su(t,n),r&&su(t,r),t}var cu=function(t){if("object"!=typeof t||null===t)return t;var e;if(Gs(t)){e=[];for(var n=0,r=t.length;n<r;n++)"object"==typeof t[n]&&null!=t[n]?e[n]=cu(t[n]):e[n]=t[n]}else for(var i in e={},t)"object"==typeof t[i]&&null!=t[i]?e[i]=cu(t[i]):e[i]=t[i];return e};const lu=cu;const hu=function(t,e){if(!Bs(t))throw new TypeError("Expected a function");var n=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var o=e?e.apply(this,r):r[0],a=n.cache;if(a.has(o))return a.get(o);var s=t.apply(this,r);return a.set(o,s),s};return n.cache=new Map,n};function fu(t,e,n,r){for(var i in n=n||0,r=r||5,e)if(e.hasOwnProperty(i)){var o=e[i];null!==o&&Xs(o)?(Xs(t[i])||(t[i]={}),n<r?fu(t[i],o,n+1,r):t[i]=e[i]):Gs(o)?(t[i]=[],t[i]=t[i].concat(o)):void 0!==o&&(t[i]=o)}}const pu=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0;r<e.length;r+=1)fu(t,e[r]);return t};var du=function(t,e){if(t===e)return!0;if(!t||!e)return!1;if($s(t)||$s(e))return!1;if(js(t)||js(e)){if(t.length!==e.length)return!1;for(var n=!0,r=0;r<t.length&&(n=du(t[r],e[r]));r++);return n}if(Ys(t)||Ys(e)){var i=Object.keys(t),o=Object.keys(e);if(i.length!==o.length)return!1;for(n=!0,r=0;r<i.length&&(n=du(t[i[r]],e[i[r]]));r++);return n}return!1};const mu=du,vu=function(t,e,n){for(var r=0,i=$s(e)?e.split("."):e;t&&r<i.length;)t=t[i[r++]];return void 0===t||r<i.length?n:t};var gu=Object.prototype.hasOwnProperty;const yu=function(t,e){if(null===t||!Xs(t))return{};var n={};return Hs(e,(function(e){gu.call(t,e)&&(n[e]=t[e])})),n},xu=function(){};function bu(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function _u(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function wu(){}var Su=.7,Mu=1/Su,Eu="\\s*([+-]?\\d+)\\s*",Au="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Tu="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Cu=/^#([0-9a-f]{3,8})$/,Ou=new RegExp("^rgb\\("+[Eu,Eu,Eu]+"\\)$"),ku=new RegExp("^rgb\\("+[Tu,Tu,Tu]+"\\)$"),Pu=new RegExp("^rgba\\("+[Eu,Eu,Eu,Au]+"\\)$"),Lu=new RegExp("^rgba\\("+[Tu,Tu,Tu,Au]+"\\)$"),Ru=new RegExp("^hsl\\("+[Au,Tu,Tu]+"\\)$"),Iu=new RegExp("^hsla\\("+[Au,Tu,Tu,Au]+"\\)$"),Nu={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Du(){return this.rgb().formatHex()}function Fu(){return this.rgb().formatRgb()}function ju(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Cu.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?Bu(e):3===n?new Gu(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?zu(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?zu(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=Ou.exec(t))?new Gu(e[1],e[2],e[3],1):(e=ku.exec(t))?new Gu(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Pu.exec(t))?zu(e[1],e[2],e[3],e[4]):(e=Lu.exec(t))?zu(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Ru.exec(t))?Xu(e[1],e[2]/100,e[3]/100,1):(e=Iu.exec(t))?Xu(e[1],e[2]/100,e[3]/100,e[4]):Nu.hasOwnProperty(t)?Bu(Nu[t]):"transparent"===t?new Gu(NaN,NaN,NaN,0):null}function Bu(t){return new Gu(t>>16&255,t>>8&255,255&t,1)}function zu(t,e,n,r){return r<=0&&(t=e=n=NaN),new Gu(t,e,n,r)}function Uu(t){return t instanceof wu||(t=ju(t)),t?new Gu((t=t.rgb()).r,t.g,t.b,t.opacity):new Gu}function Vu(t,e,n,r){return 1===arguments.length?Uu(t):new Gu(t,e,n,null==r?1:r)}function Gu(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function Wu(){return"#"+Yu(this.r)+Yu(this.g)+Yu(this.b)}function Hu(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function Yu(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function Xu(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Zu(t,e,n,r)}function qu(t){if(t instanceof Zu)return new Zu(t.h,t.s,t.l,t.opacity);if(t instanceof wu||(t=ju(t)),!t)return new Zu;if(t instanceof Zu)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),o=Math.max(e,n,r),a=NaN,s=o-i,u=(o+i)/2;return s?(a=e===o?(n-r)/s+6*(n<r):n===o?(r-e)/s+2:(e-n)/s+4,s/=u<.5?o+i:2-o-i,a*=60):s=u>0&&u<1?0:a,new Zu(a,s,u,t.opacity)}function Zu(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function $u(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function Ku(t,e,n,r){var i=t-n,o=e-r;return Math.sqrt(i*i+o*o)}function Ju(t,e){return Math.abs(t-e)<.001}function Qu(t,e){var n=Math.min.apply(Math,t),r=Math.min.apply(Math,e);return{x:n,y:r,width:Math.max.apply(Math,t)-n,height:Math.max.apply(Math,e)-r}}bu(wu,ju,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:Du,formatHex:Du,formatHsl:function(){return qu(this).formatHsl()},formatRgb:Fu,toString:Fu}),bu(Gu,Vu,_u(wu,{brighter:function(t){return t=null==t?Mu:Math.pow(Mu,t),new Gu(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?Su:Math.pow(Su,t),new Gu(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Wu,formatHex:Wu,formatRgb:Hu,toString:Hu})),bu(Zu,(function(t,e,n,r){return 1===arguments.length?qu(t):new Zu(t,e,n,null==r?1:r)}),_u(wu,{brighter:function(t){return t=null==t?Mu:Math.pow(Mu,t),new Zu(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?Su:Math.pow(Su,t),new Zu(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new Gu($u(t>=240?t-240:t+120,i,r),$u(t,i,r),$u(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var tc={box:function(t,e,n,r){return Qu([t,n],[e,r])},length:function(t,e,n,r){return Ku(t,e,n,r)},pointAt:function(t,e,n,r,i){return{x:(1-i)*t+i*n,y:(1-i)*e+i*r}},pointDistance:function(t,e,n,r,i,o){var a=(n-t)*(i-t)+(r-e)*(o-e);return a<0?Ku(t,e,i,o):a>(n-t)*(n-t)+(r-e)*(r-e)?Ku(n,r,i,o):this.pointToLine(t,e,n,r,i,o)},pointToLine:function(t,e,n,r,i,o){var a=[n-t,r-e];if(Wa(a,[0,0]))return Math.sqrt((i-t)*(i-t)+(o-e)*(o-e));var s=[-a[1],a[0]];za(s,s);var u=[i-t,o-e];return Math.abs(Ua(u,s))},tangentAngle:function(t,e,n,r){return Math.atan2(r-e,n-t)}};function ec(t,e,n,r){var i=1-r;return i*i*t+2*r*i*e+r*r*n}function nc(t,e,n){var r=t+n-2*e;if(Ju(r,0))return[.5];var i=(t-e)/r;return i<=1&&i>=0?[i]:[]}var rc=function(t,e,n,r,i,o){var a=nc(t,n,i)[0],s=nc(e,r,o)[0],u=[t,i],c=[e,o];return void 0!==a&&u.push(ec(t,n,i,a)),void 0!==s&&c.push(ec(e,r,o,s)),Qu(u,c)};function ic(t,e,n,r,i){var o=1-i;return o*o*o*t+3*e*i*o*o+3*n*i*i*o+r*i*i*i}function oc(t,e,n,r){var i,o,a,s=-3*t+9*e-9*n+3*r,u=6*t-12*e+6*n,c=3*e-3*t,l=[];if(Ju(s,0))Ju(u,0)||(i=-c/u)>=0&&i<=1&&l.push(i);else{var h=u*u-4*s*c;Ju(h,0)?l.push(-u/(2*s)):h>0&&(o=(-u-(a=Math.sqrt(h)))/(2*s),(i=(-u+a)/(2*s))>=0&&i<=1&&l.push(i),o>=0&&o<=1&&l.push(o))}return l}var ac=function(t,e,n,r,i,o,a,s){for(var u=[t,a],c=[e,s],l=oc(t,n,i,a),h=oc(e,r,o,s),f=0;f<l.length;f++)u.push(ic(t,n,i,a,l[f]));for(var p=0;p<h.length;p++)c.push(ic(e,r,o,s,h[p]));return Qu(u,c)};function sc(t,e,n,r,i,o){return n*Math.cos(i)*Math.cos(o)-r*Math.sin(i)*Math.sin(o)+t}function uc(t,e,n,r,i,o){return n*Math.sin(i)*Math.cos(o)+r*Math.cos(i)*Math.sin(o)+e}var cc=function(t,e,n,r,i,o,a){for(var s=function(t,e,n){return Math.atan(-e/t*Math.tan(n))}(n,r,i),u=1/0,c=-1/0,l=[o,a],h=2*-Math.PI;h<=2*Math.PI;h+=Math.PI){var f=s+h;o<a?o<f&&f<a&&l.push(f):a<f&&f<o&&l.push(f)}for(var p=0;p<l.length;p++){var d=sc(t,0,n,r,i,l[p]);d<u&&(u=d),d>c&&(c=d)}for(var m=function(t,e,n){return Math.atan(e/(t*Math.tan(n)))}(n,r,i),v=1/0,g=-1/0,y=[o,a],x=2*-Math.PI;x<=2*Math.PI;x+=Math.PI){var b=m+x;o<a?o<b&&b<a&&y.push(b):a<b&&b<o&&y.push(b)}for(var _=0;_<y.length;_++){var w=uc(0,e,n,r,i,y[_]);w<v&&(v=w),w>g&&(g=w)}return{x:u,y:v,width:c-u,height:g-v}};var lc=function(t){return function(t){if(t.length<2)return 0;for(var e=0,n=0;n<t.length-1;n++){var r=t[n],i=t[n+1];e+=Ku(r[0],r[1],i[0],i[1])}return e}(t)},hc={};!function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}function i(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function o(t,e,r,o,a){if("function"!=typeof r)throw new TypeError("The listener must be a function");var s=new i(r,o||t,a),u=n?n+e:e;return t._events[u]?t._events[u].fn?t._events[u]=[t._events[u],s]:t._events[u].push(s):(t._events[u]=s,t._eventsCount++),t}function a(t,e){0==--t._eventsCount?t._events=new r:delete t._events[e]}function s(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),s.prototype.eventNames=function(){var t,r,i=[];if(0===this._eventsCount)return i;for(r in t=this._events)e.call(t,r)&&i.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(t)):i},s.prototype.listeners=function(t){var e=n?n+t:t,r=this._events[e];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,o=r.length,a=new Array(o);i<o;i++)a[i]=r[i].fn;return a},s.prototype.listenerCount=function(t){var e=n?n+t:t,r=this._events[e];return r?r.fn?1:r.length:0},s.prototype.emit=function(t,e,r,i,o,a){var s=n?n+t:t;if(!this._events[s])return!1;var u,c,l=this._events[s],h=arguments.length;if(l.fn){switch(l.once&&this.removeListener(t,l.fn,void 0,!0),h){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,e),!0;case 3:return l.fn.call(l.context,e,r),!0;case 4:return l.fn.call(l.context,e,r,i),!0;case 5:return l.fn.call(l.context,e,r,i,o),!0;case 6:return l.fn.call(l.context,e,r,i,o,a),!0}for(c=1,u=new Array(h-1);c<h;c++)u[c-1]=arguments[c];l.fn.apply(l.context,u)}else{var f,p=l.length;for(c=0;c<p;c++)switch(l[c].once&&this.removeListener(t,l[c].fn,void 0,!0),h){case 1:l[c].fn.call(l[c].context);break;case 2:l[c].fn.call(l[c].context,e);break;case 3:l[c].fn.call(l[c].context,e,r);break;case 4:l[c].fn.call(l[c].context,e,r,i);break;default:if(!u)for(f=1,u=new Array(h-1);f<h;f++)u[f-1]=arguments[f];l[c].fn.apply(l[c].context,u)}}return!0},s.prototype.on=function(t,e,n){return o(this,t,e,n,!1)},s.prototype.once=function(t,e,n){return o(this,t,e,n,!0)},s.prototype.removeListener=function(t,e,r,i){var o=n?n+t:t;if(!this._events[o])return this;if(!e)return a(this,o),this;var s=this._events[o];if(s.fn)s.fn!==e||i&&!s.once||r&&s.context!==r||a(this,o);else{for(var u=0,c=[],l=s.length;u<l;u++)(s[u].fn!==e||i&&!s[u].once||r&&s[u].context!==r)&&c.push(s[u]);c.length?this._events[o]=1===c.length?c[0]:c:a(this,o)}return this},s.prototype.removeAllListeners=function(t){var e;return t?(e=n?n+t:t,this._events[e]&&a(this,e)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,t.exports=s}({get exports(){return hc},set exports(t){hc=t}});const fc=hc;var pc,dc;(dc=pc||(pc={})).COORDINATE="<coordinate>",dc.COLOR="<color>",dc.PAINT="<paint>",dc.NUMBER="<number>",dc.ANGLE="<angle>",dc.OPACITY_VALUE="<opacity-value>",dc.SHADOW_BLUR="<shadow-blur>",dc.LENGTH="<length>",dc.PERCENTAGE="<percentage>",dc.LENGTH_PERCENTAGE="<length> | <percentage>",dc.LENGTH_PERCENTAGE_12="[<length> | <percentage>]{1,2}",dc.LENGTH_PERCENTAGE_14="[<length> | <percentage>]{1,4}",dc.LIST_OF_POINTS="<list-of-points>",dc.PATH="<path>",dc.FILTER="<filter>",dc.Z_INDEX="<z-index>",dc.OFFSET_DISTANCE="<offset-distance>",dc.DEFINED_PATH="<defined-path>",dc.MARKER="<marker>",dc.TRANSFORM="<transform>",dc.TRANSFORM_ORIGIN="<transform-origin>",dc.TEXT="<text>",dc.TEXT_TRANSFORM="<text-transform>";var mc,vc,gc=function(){function t(t,e){void 0===t&&(t=[0,0,0]),void 0===e&&(e=[0,0,0]),this.center=Do(),this.halfExtents=Do(),this.min=Do(),this.max=Do(),this.update(t,e)}t.isEmpty=function(t){return!t||0===t.halfExtents[0]&&0===t.halfExtents[1]&&0===t.halfExtents[2]};var e=t.prototype;return e.update=function(t,e){zo(this.center,t),zo(this.halfExtents,e),ca(this.min,this.center,this.halfExtents),Vo(this.max,this.center,this.halfExtents)},e.setMinMax=function(t,e){Vo(this.center,e,t),qo(this.center,this.center,.5),ca(this.halfExtents,e,t),qo(this.halfExtents,this.halfExtents,.5),zo(this.min,t),zo(this.max,e)},e.getMin=function(){return this.min},e.getMax=function(){return this.max},e.add=function(e){if(!t.isEmpty(e))if(t.isEmpty(this))this.setMinMax(e.getMin(),e.getMax());else{var n=this.center,r=n[0],i=n[1],o=n[2],a=this.halfExtents,s=a[0],u=a[1],c=a[2],l=r-s,h=r+s,f=i-u,p=i+u,d=o-c,m=o+c,v=e.center,g=v[0],y=v[1],x=v[2],b=e.halfExtents,_=b[0],w=b[1],S=b[2],M=g-_,E=g+_,A=y-w,T=y+w,C=x-S,O=x+S;M<l&&(l=M),E>h&&(h=E),A<f&&(f=A),T>p&&(p=T),C<d&&(d=C),O>m&&(m=O),n[0]=.5*(l+h),n[1]=.5*(f+p),n[2]=.5*(d+m),a[0]=.5*(h-l),a[1]=.5*(p-f),a[2]=.5*(m-d),this.min[0]=l,this.min[1]=f,this.min[2]=d,this.max[0]=h,this.max[1]=p,this.max[2]=m}},e.setFromTransformedAABB=function(t,e){var n=this.center,r=this.halfExtents,i=t.center,o=t.halfExtents,a=e[0],s=e[4],u=e[8],c=e[1],l=e[5],h=e[9],f=e[2],p=e[6],d=e[10],m=Math.abs(a),v=Math.abs(s),g=Math.abs(u),y=Math.abs(c),x=Math.abs(l),b=Math.abs(h),_=Math.abs(f),w=Math.abs(p),S=Math.abs(d);Uo(n,e[12]+a*i[0]+s*i[1]+u*i[2],e[13]+c*i[0]+l*i[1]+h*i[2],e[14]+f*i[0]+p*i[1]+d*i[2]),Uo(r,m*o[0]+v*o[1]+g*o[2],y*o[0]+x*o[1]+b*o[2],_*o[0]+w*o[1]+S*o[2]),this.min=ca(this.min,n,r),this.max=Vo(this.max,n,r)},e.intersects=function(t){var e=this.getMax(),n=this.getMin(),r=t.getMax(),i=t.getMin();return n[0]<=r[0]&&e[0]>=i[0]&&n[1]<=r[1]&&e[1]>=i[1]&&n[2]<=r[2]&&e[2]>=i[2]},e.intersection=function(e){if(!this.intersects(e))return null;var n=new t,r=Xo(Do(),this.getMin(),e.getMin()),i=Yo(Do(),this.getMax(),e.getMax());return n.setMinMax(r,i),n},e.containsPoint=function(t){var e=this.getMin(),n=this.getMax();return!(t[0]<e[0]||t[0]>n[0]||t[1]<e[1]||t[1]>n[1]||t[2]<e[2]||t[2]>n[2])},e.getNegativeFarPoint=function(t){return 273===t.pnVertexFlag?zo(Do(),this.min):272===t.pnVertexFlag?Bo(this.min[0],this.min[1],this.max[2]):257===t.pnVertexFlag?Bo(this.min[0],this.max[1],this.min[2]):256===t.pnVertexFlag?Bo(this.min[0],this.max[1],this.max[2]):17===t.pnVertexFlag?Bo(this.max[0],this.min[1],this.min[2]):16===t.pnVertexFlag?Bo(this.max[0],this.min[1],this.max[2]):1===t.pnVertexFlag?Bo(this.max[0],this.max[1],this.min[2]):Bo(this.max[0],this.max[1],this.max[2])},e.getPositiveFarPoint=function(t){return 273===t.pnVertexFlag?zo(Do(),this.max):272===t.pnVertexFlag?Bo(this.max[0],this.max[1],this.min[2]):257===t.pnVertexFlag?Bo(this.max[0],this.min[1],this.max[2]):256===t.pnVertexFlag?Bo(this.max[0],this.min[1],this.min[2]):17===t.pnVertexFlag?Bo(this.min[0],this.max[1],this.max[2]):16===t.pnVertexFlag?Bo(this.min[0],this.max[1],this.min[2]):1===t.pnVertexFlag?Bo(this.min[0],this.min[1],this.max[2]):Bo(this.min[0],this.min[1],this.min[2])},t}(),yc=function(){function t(t,e){this.distance=void 0,this.normal=void 0,this.pnVertexFlag=void 0,this.distance=t||0,this.normal=e||Bo(0,1,0),this.updatePNVertexFlag()}var e=t.prototype;return e.updatePNVertexFlag=function(){this.pnVertexFlag=(Number(this.normal[0]>=0)<<8)+(Number(this.normal[1]>=0)<<4)+Number(this.normal[2]>=0)},e.distanceToPoint=function(t){return ta(t,this.normal)-this.distance},e.normalize=function(){var t=1/da(this.normal);qo(this.normal,this.normal,t),this.distance*=t},e.intersectsLine=function(t,e,n){var r=this.distanceToPoint(t),i=r/(r-this.distanceToPoint(e)),o=i>=0&&i<=1;return o&&n&&na(n,t,e,i),o},t}();(vc=mc||(mc={}))[vc.OUTSIDE=4294967295]="OUTSIDE",vc[vc.INSIDE=0]="INSIDE",vc[vc.INDETERMINATE=2147483647]="INDETERMINATE";var xc,bc,_c=function(){function t(t){if(this.planes=[],t)this.planes=t;else for(var e=0;e<6;e++)this.planes.push(new yc)}return t.prototype.extractFromVPMatrix=function(t){var e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],s=t[6],u=t[7],c=t[8],l=t[9],h=t[10],f=t[11],p=t[12],d=t[13],m=t[14],v=t[15];Uo(this.planes[0].normal,i-e,u-o,f-c),this.planes[0].distance=v-p,Uo(this.planes[1].normal,i+e,u+o,f+c),this.planes[1].distance=v+p,Uo(this.planes[2].normal,i+n,u+a,f+l),this.planes[2].distance=v+d,Uo(this.planes[3].normal,i-n,u-a,f-l),this.planes[3].distance=v-d,Uo(this.planes[4].normal,i-r,u-s,f-h),this.planes[4].distance=v-m,Uo(this.planes[5].normal,i+r,u+s,f+h),this.planes[5].distance=v+m,this.planes.forEach((function(t){t.normalize(),t.updatePNVertexFlag()}))},t}(),wc=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=0,this.y=0,this.x=t,this.y=e}var e=t.prototype;return e.clone=function(){return new t(this.x,this.y)},e.copyFrom=function(t){this.x=t.x,this.y=t.y},t}(),Sc=function(){function t(t,e,n,r){this.x=void 0,this.y=void 0,this.width=void 0,this.height=void 0,this.left=void 0,this.right=void 0,this.top=void 0,this.bottom=void 0,this.x=t,this.y=e,this.width=n,this.height=r,this.left=t,this.right=t+n,this.top=e,this.bottom=e+r}return t.prototype.toJSON=function(){},t}();function Mc(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var n=function n(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];var a=e?e.apply(this,i):i[0],s=n.cache;if(s.has(a))return s.get(a);var u=t.apply(this,i);return n.cache=s.set(a,u)||s,u};return n.cache=new(Mc.Cache||Map),n}(bc=xc||(xc={})).GROUP="g",bc.CIRCLE="circle",bc.ELLIPSE="ellipse",bc.IMAGE="image",bc.RECT="rect",bc.LINE="line",bc.POLYLINE="polyline",bc.POLYGON="polygon",bc.TEXT="text",bc.PATH="path",bc.HTML="html",bc.MESH="mesh",Mc.Cache=Map;var Ec=Mc((function(t){return void 0===t&&(t=""),t.replace(/-([a-z])/g,(function(t){return t[1].toUpperCase()}))}));function Ac(t){if(!t)throw new Error}function Tc(t,e){if(t===e)throw new Error}function Cc(t){return"function"==typeof t}var Oc={d:{alias:"path"},strokeDasharray:{alias:"lineDash"},strokeWidth:{alias:"lineWidth"},textAnchor:{alias:"textAlign"},src:{alias:"img"}},kc=Mc((function(t){var e=Ec(t),n=Oc[e];return e=(null==n?void 0:n.alias)||e})),Pc={},Lc=0;var Rc="undefined"!=typeof window&&void 0!==window.document;function Ic(t,e){var n=Number(t.style.zIndex),r=Number(e.style.zIndex);if(n===r){var i=t.parentNode;if(i){var o=i.childNodes||[];return o.indexOf(t)-o.indexOf(e)}}return n-r}function Nc(t){var e=t;do{var n;if(null===(n=e.style)||void 0===n?void 0:n.clipPath)return e;e=e.parentElement}while(null!==e);return null}function Dc(t,e){if(Rc)return document.defaultView.getComputedStyle(t,null).getPropertyValue(e)}var Fc,jc,Bc,zc,Uc,Vc,Gc,Wc,Hc,Yc,Xc="Method not implemented.",qc="Use document.documentElement instead.",Zc={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"};function $c(){$c=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(C){u=function(t,e,n){return t[e]=n}}function c(t,e,n,i){var o=e&&e.prototype instanceof f?e:f,a=Object.create(o.prototype),s=new E(i||[]);return r(a,"_invoke",{value:_(t,n,s)}),a}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(C){return{type:"throw",arg:C}}}t.wrap=c;var h={};function f(){}function p(){}function d(){}var m={};u(m,o,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(A([])));g&&g!==e&&n.call(g,o)&&(m=g);var y=d.prototype=f.prototype=Object.create(m);function x(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function i(r,o,a,s){var u=l(t[r],t,o);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){i("next",t,a,s)}),(function(t){i("throw",t,a,s)})):e.resolve(h).then((function(t){c.value=t,a(c)}),(function(t){return i("throw",t,a,s)}))}s(u.arg)}var o;r(this,"_invoke",{value:function(t,n){function r(){return new e((function(e,r){i(t,n,e,r)}))}return o=o?o.then(r,r):r()}})}function _(t,e,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return{value:void 0,done:!0}}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=w(a,n);if(s){if(s===h)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=l(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===h)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}function w(t,e){var n=e.method,r=t.iterator[n];if(void 0===r)return e.delegate=null,"throw"===n&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=l(r,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,h;var o=i.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function M(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function E(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function A(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:T}}function T(){return{value:void 0,done:!0}}return p.prototype=d,r(y,"constructor",{value:d,configurable:!0}),r(d,"constructor",{value:p,configurable:!0}),p.displayName=u(d,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(y),t},t.awrap=function(t){return{__await:t}},x(b.prototype),u(b.prototype,a,(function(){return this})),t.AsyncIterator=b,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new b(c(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},x(y),u(y,s,"Generator"),u(y,o,(function(){return this})),u(y,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},t.values=A,E.prototype={constructor:E,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(M),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),u=n.call(o,"finallyLoc");if(s&&u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,h):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),M(n),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;M(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:A(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),h}},t}function Kc(t,e,n,r,i,o,a){try{var s=t[o](a),u=s.value}catch(c){return void n(c)}s.done?e(u):Promise.resolve(u).then(r,i)}function Jc(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function a(t){Kc(o,r,i,a,s,"next",t)}function s(t){Kc(o,r,i,a,s,"throw",t)}a(void 0)}))}}function Qc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(i=r.key,o=void 0,"symbol"==typeof(o=function(t,e){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"))?o:String(o)),r)}var i,o}function tl(t,e,n){return e&&Qc(t.prototype,e),n&&Qc(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function el(){return el=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},el.apply(this,arguments)}function nl(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,rl(t,e)}function rl(t,e){return(rl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function il(t,e){if(null==t)return{};var n,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}function ol(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function al(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function sl(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return al(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?al(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(jc=Fc||(Fc={}))[jc.kUnknown=0]="kUnknown",jc[jc.kNumber=1]="kNumber",jc[jc.kPercentage=2]="kPercentage",jc[jc.kEms=3]="kEms",jc[jc.kPixels=4]="kPixels",jc[jc.kRems=5]="kRems",jc[jc.kDegrees=6]="kDegrees",jc[jc.kRadians=7]="kRadians",jc[jc.kGradians=8]="kGradians",jc[jc.kTurns=9]="kTurns",jc[jc.kMilliseconds=10]="kMilliseconds",jc[jc.kSeconds=11]="kSeconds",jc[jc.kInteger=12]="kInteger",(zc=Bc||(Bc={}))[zc.kUNumber=0]="kUNumber",zc[zc.kUPercent=1]="kUPercent",zc[zc.kULength=2]="kULength",zc[zc.kUAngle=3]="kUAngle",zc[zc.kUTime=4]="kUTime",zc[zc.kUOther=5]="kUOther",(Vc=Uc||(Uc={}))[Vc.kAll=0]="kAll",Vc[Vc.kNonNegative=1]="kNonNegative",Vc[Vc.kInteger=2]="kInteger",Vc[Vc.kNonNegativeInteger=3]="kNonNegativeInteger",Vc[Vc.kPositiveInteger=4]="kPositiveInteger",(Wc=Gc||(Gc={}))[Wc.kYes=0]="kYes",Wc[Wc.kNo=1]="kNo",(Yc=Hc||(Hc={}))[Yc.kYes=0]="kYes",Yc[Yc.kNo=1]="kNo";var ul,cl,ll=[{name:"em",unit_type:Fc.kEms},{name:"px",unit_type:Fc.kPixels},{name:"deg",unit_type:Fc.kDegrees},{name:"rad",unit_type:Fc.kRadians},{name:"grad",unit_type:Fc.kGradians},{name:"ms",unit_type:Fc.kMilliseconds},{name:"s",unit_type:Fc.kSeconds},{name:"rem",unit_type:Fc.kRems},{name:"turn",unit_type:Fc.kTurns}];(cl=ul||(ul={}))[cl.kUnknownType=0]="kUnknownType",cl[cl.kUnparsedType=1]="kUnparsedType",cl[cl.kKeywordType=2]="kKeywordType",cl[cl.kUnitType=3]="kUnitType",cl[cl.kSumType=4]="kSumType",cl[cl.kProductType=5]="kProductType",cl[cl.kNegateType=6]="kNegateType",cl[cl.kInvertType=7]="kInvertType",cl[cl.kMinType=8]="kMinType",cl[cl.kMaxType=9]="kMaxType",cl[cl.kClampType=10]="kClampType",cl[cl.kTransformType=11]="kTransformType",cl[cl.kPositionType=12]="kPositionType",cl[cl.kURLImageType=13]="kURLImageType",cl[cl.kColorType=14]="kColorType",cl[cl.kUnsupportedColorType=15]="kUnsupportedColorType";var hl,fl,pl=function(t){return t?"number"===t?Fc.kNumber:"percent"===t||"%"===t?Fc.kPercentage:function(t){return ll.find((function(e){return e.name===t})).unit_type}(t):Fc.kUnknown},dl=function(t){var e=1;switch(t){case Fc.kPixels:case Fc.kDegrees:case Fc.kSeconds:break;case Fc.kMilliseconds:e=.001;break;case Fc.kRadians:e=180/Math.PI;break;case Fc.kGradians:e=.9;break;case Fc.kTurns:e=360}return e},ml=function(t){switch(t){case Fc.kNumber:case Fc.kInteger:return"";case Fc.kPercentage:return"%";case Fc.kEms:return"em";case Fc.kRems:return"rem";case Fc.kPixels:return"px";case Fc.kDegrees:return"deg";case Fc.kRadians:return"rad";case Fc.kGradians:return"grad";case Fc.kMilliseconds:return"ms";case Fc.kSeconds:return"s";case Fc.kTurns:return"turn"}return""},vl=function(){function t(){}t.isAngle=function(t){return t===Fc.kDegrees||t===Fc.kRadians||t===Fc.kGradians||t===Fc.kTurns},t.isLength=function(t){return t>=Fc.kEms&&t<Fc.kDegrees},t.isRelativeUnit=function(t){return t===Fc.kPercentage||t===Fc.kEms||t===Fc.kRems},t.isTime=function(t){return t===Fc.kSeconds||t===Fc.kMilliseconds};var e=t.prototype;return e.toString=function(){return this.buildCSSText(Gc.kNo,Hc.kNo,"")},e.isNumericValue=function(){return this.getType()>=ul.kUnitType&&this.getType()<=ul.kClampType},t}(),gl=function(t){function e(e){var n;return(n=t.call(this)||this).colorSpace=void 0,n.colorSpace=e,n}nl(e,t);var n=e.prototype;return n.getType=function(){return ul.kColorType},n.to=function(t){return this},e}(vl);(fl=hl||(hl={}))[fl.Constant=0]="Constant",fl[fl.LinearGradient=1]="LinearGradient",fl[fl.RadialGradient=2]="RadialGradient";var yl,xl,bl,_l,wl=function(t){function e(e,n){var r;return(r=t.call(this)||this).type=void 0,r.value=void 0,r.type=e,r.value=n,r}nl(e,t);var n=e.prototype;return n.clone=function(){return new e(this.type,this.value)},n.buildCSSText=function(t,e,n){return n},n.getType=function(){return ul.kColorType},e}(vl),Sl=function(t){function e(e){var n;return(n=t.call(this)||this).value=void 0,n.value=e,n}nl(e,t);var n=e.prototype;return n.clone=function(){return new e(this.value)},n.getType=function(){return ul.kKeywordType},n.buildCSSText=function(t,e,n){return n+this.value},e}(vl);(xl=yl||(yl={})).kAdd="+",xl.kSubtract="-",xl.kMultiply="*",xl.kDivide="/",xl.kMin="min",xl.kMax="max",xl.kClamp="clamp",xl.kInvalid="",(_l=bl||(bl={}))[_l.kLength=0]="kLength",_l[_l.kAngle=1]="kAngle",_l[_l.kTime=2]="kTime",_l[_l.kFrequency=3]="kFrequency",_l[_l.kResolution=4]="kResolution",_l[_l.kFlex=5]="kFlex",_l[_l.kPercent=6]="kPercent",_l[_l.kNumBaseTypes=7]="kNumBaseTypes";var Ml=function(){function t(t,e){void 0===t&&(t=Fc.kNumber),void 0===e&&(e=1),this.exponents=[],this.numNonZeroEntries=0,this.percentHint=bl.kPercent,this.hasPercentHint=!1,this.exponents=new Array(bl.kNumBaseTypes).fill(0),t!==Fc.kNumber&&this.setExponent(function(t){switch(Tc(t,Fc.kNumber),t){case Fc.kEms:case Fc.kPixels:case Fc.kRems:return bl.kLength;case Fc.kMilliseconds:case Fc.kSeconds:return bl.kTime;case Fc.kDegrees:case Fc.kRadians:case Fc.kGradians:case Fc.kTurns:return bl.kAngle;case Fc.kPercentage:return bl.kPercent;default:return bl.kLength}}(t),e)}var e=t.prototype;return e.applyPercentHint=function(t){Tc(t,bl.kPercent),this.setExponent(t,this.exponent(t)+this.exponent(bl.kPercent)),this.setExponent(bl.kPercent,0),this.percentHint=t,this.hasPercentHint=!0},e.hasNonZeroEntries=function(){return this.numNonZeroEntries>0},e.isOnlyNonZeroEntry=function(t,e){return Tc(e,0),1===this.numNonZeroEntries&&this.exponent(t)===e},e.exponent=function(t){return this.exponents[t]},e.setExponent=function(t,e){var n=this.exponents[t];0==n&&0!==e?this.numNonZeroEntries++:0!==n&&0==e&&this.numNonZeroEntries--,this.exponents[t]=e},t.negateExponents=function(t){return t.exponents.forEach((function(t){return-1*t})),t},e.matchesBaseType=function(t){return Tc(t,bl.kPercent),this.isOnlyNonZeroEntry(t,1)&&!this.hasPercentHint},e.matchesPercentage=function(){return this.isOnlyNonZeroEntry(bl.kPercent,1)},e.matchesBaseTypePercentage=function(t){return Tc(t,bl.kPercent),this.isOnlyNonZeroEntry(t,1)||this.isOnlyNonZeroEntry(bl.kPercent,1)},e.matchesNumber=function(){return!this.hasNonZeroEntries()&&!this.hasPercentHint},e.matchesNumberPercentage=function(){return!this.hasNonZeroEntries()||this.isOnlyNonZeroEntry(bl.kPercent,1)},t.add=function(t,e,n){if(t.hasPercentHint&&e.hasPercentHint&&t.percentHint!=e.percentHint)return t;t.hasPercentHint?e.applyPercentHint(t.percentHint):e.hasPercentHint&&t.applyPercentHint(e.percentHint),function(t,e){if(t!==e)throw new Error}(t.percentHint,e.percentHint);for(var r=0;r<bl.kNumBaseTypes;++r){var i=r;if(t.exponents[r]!==e.exponents[r]&&(i!==bl.kPercent&&(t.applyPercentHint(i),e.applyPercentHint(i)),t.exponents[r]!==e.exponents[r]))return t}return t},t.multiply=function(t,e,n){if(t.hasPercentHint&&e.hasPercentHint&&t.percentHint!=e.percentHint)return t;t.hasPercentHint?e.applyPercentHint(t.percentHint):e.hasPercentHint&&t.applyPercentHint(e.percentHint);for(var r=0;r<bl.kNumBaseTypes;++r){var i=r;t.setExponent(i,t.exponent(i)+e.exponent(i))}return t},t}(),El=function(t){return"number"==typeof t?new Rl(t,Fc.kNumber):t},Al=function(t){function e(e){var n;return(n=t.call(this)||this).type_=void 0,n.type_=e,n}nl(e,t);var n=e.prototype;return n.getType=function(){return ul.kUnknownType},n.equals=function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=Tl(n);return i.every((function(e){return t.equals(e)}))},n.add=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=Tl(e);Cl(ul.kSumType,r,this);var i=kl(r,yl.kAdd);return i||Ul.create(r)},n.sub=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=Tl(e);r=r.map((function(t){return t.negate()})),Cl(ul.kSumType,r,this);var i=kl(r,yl.kAdd);return i||Ul.create(r)},n.mul=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=Tl(e);Cl(ul.kProductType,r,this);var i=Pl(r);return i||Vl.create(r)},n.div=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=Tl(e);r=r.map((function(t){return t.invert()})),Cl(ul.kProductType,r,this);var i=Pl(r);return i||Vl.create(r)},n.min=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=Tl(e);Cl(ul.kMinType,r,this);var i=kl(r,yl.kMin);return i||Bl.create(r)},n.max=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=Tl(e);Cl(ul.kMaxType,r,this);var i=kl(r,yl.kMax);return i||zl.create(r)},n.to=function(t){var e=this.sumValue();if(0===e.length||1!==e.length)return null;var n,r=Ol(e[0]);return r?(n="string"==typeof t?pl(t):t,r.convertTo(n)):null},n.toSum=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,o=n;i<o.length;i++){var a=o[i];if(!e.isValidUnit(pl(a)))return null}var s=this.sumValue();if(!s.length)return null;for(var u,c=[],l=sl(s);!(u=l()).done;){var h=u.value,f=Ol(h);if(!f)return null;c.push(f)}if(0===n.length){c.sort((function(t,e){return t.unit-e.unit}));var p=Ul.create(c);return Ac(!!p),p}for(var d=[],m=function(){var t=g[v],n=pl(t);Ac(e.isValidUnit(n));var r=c.reduce((function(t,e,r){if(e){var i=e.convertTo(n);i&&(t+=i.value,c[r]=null)}return t}),0);d.push(new Rl(r,n))},v=0,g=n;v<g.length;v++)m();if(c.some((function(t){return!!t})))throw new Error("There were leftover terms that were not converted");return Ul.create(d)},n.type=function(){var t={length:0,angle:0,time:0,frequency:0,resolution:0,flex:0,percent:0,percentHint:"length"},e=this.type_.exponent(bl.kLength);return e&&(t.length=e),(e=this.type_.exponent(bl.kAngle))&&(t.angle=e),(e=this.type_.exponent(bl.kTime))&&(t.time=e),(e=this.type_.exponent(bl.kFrequency))&&(t.frequency=e),(e=this.type_.exponent(bl.kResolution))&&(t.resolution=e),(e=this.type_.exponent(bl.kFlex))&&(t.flex=e),(e=this.type_.exponent(bl.kPercent))&&(t.percent=e),this.type_.hasPercentHint&&(t.percentHint=function(t){switch(t){case bl.kLength:return"length";case bl.kAngle:return"angle";case bl.kTime:return"time";case bl.kFrequency:return"frequency";case bl.kResolution:return"resolution";case bl.kFlex:return"flex";case bl.kPercent:return"percent"}return""}(this.type_.percentHint)),t},e.isValidUnit=function(t){return!!(t===Fc.kNumber||t==Fc.kPercentage||this.isLength(t)||this.isAngle(t)||this.isTime(t))},n.negate=function(){return Dl.create(this)},n.invert=function(){return Nl.create(this)},e}(vl);function Tl(t){return t.map(El)}function Cl(t,e,n){Ac(!!n),n.getType()===t?e.unshift.apply(e,n.numericValues()):e.unshift(n)}function Ol(t){return 0===Object.keys(t.units).length?new Rl(t.value):1===Object.keys(t.units).length&&1===t.units[Object.keys(t.units)[0]]?new Rl(t.value,Number(Object.keys(t.units)[0])):null}function kl(t,e){Ac(!!t.length);var n=t[0]instanceof Rl?t[0]:null;if(!n)return null;for(var r=n.value,i=1;i<t.length;i++){var o=t[i]instanceof Rl?t[i]:null;if(!o||o.unit!==n.unit)return null;e===yl.kAdd?r+=o.value:e===yl.kMax?r=Math.max(r,o.value):e===yl.kMin&&(r=Math.min(r,o.value))}return new Rl(r,n.unit)}function Pl(t){Ac(!!t.length);for(var e=Fc.kNumber,n=1,r=0;r<t.length;r++){var i=t[r]instanceof Rl?t[r]:null;if(!i)return null;if(i.unit!==Fc.kNumber){if(e!==Fc.kNumber)return null;e=i.unit}n*=i.value}return new Rl(n,e)}var Ll=function(t){return function(t){switch(t){case Bc.kUNumber:return Fc.kNumber;case Bc.kULength:return Fc.kPixels;case Bc.kUPercent:return Fc.kPercentage;case Bc.kUTime:return Fc.kSeconds;case Bc.kUAngle:return Fc.kDegrees;default:return Fc.kUnknown}}(function(t){switch(t){case Fc.kNumber:case Fc.kInteger:return Bc.kUNumber;case Fc.kPercentage:return Bc.kUPercent;case Fc.kPixels:return Bc.kULength;case Fc.kMilliseconds:case Fc.kSeconds:return Bc.kUTime;case Fc.kDegrees:case Fc.kRadians:case Fc.kGradians:case Fc.kTurns:return Bc.kUAngle;default:return Bc.kUOther}}(t))},Rl=function(t){function e(e,n){var r,i;return void 0===n&&(n=Fc.kNumber),i="string"==typeof n?pl(n):n,(r=t.call(this,new Ml(i))||this).unit=void 0,r.value=void 0,r.unit=i,r.value=e,r}nl(e,t);var n=e.prototype;return n.clone=function(){return new e(this.value,this.unit)},n.convertTo=function(t){if(this.unit===t)return new e(this.value,this.unit);var n=Ll(this.unit);if(n!==Ll(t)||n===Fc.kUnknown)return null;var r=dl(this.unit)/dl(t);return new e(this.value*r,t)},n.equals=function(t){var e=t;return this.value===e.value&&this.unit===e.unit},n.getType=function(){return ul.kUnitType},n.sumValue=function(){var t,e,n=[],r={};return this.unit!==Fc.kNumber&&(r[(t=this.unit,e=Ll(t),e===Fc.kUnknown?t:e)]=1),n.push({value:this.value*dl(this.unit),units:r}),n},n.negate=function(){return new e(-this.value,this.unit)},n.invert=function(){return this.unit===Fc.kNumber?0===this.value?null:new e(1/this.value,this.unit):Nl.create(this)},n.buildCSSText=function(t,e,n){var r;switch(this.unit){case Fc.kUnknown:break;case Fc.kInteger:r=Number(this.value).toFixed(0);break;case Fc.kNumber:case Fc.kPercentage:case Fc.kEms:case Fc.kRems:case Fc.kPixels:case Fc.kDegrees:case Fc.kRadians:case Fc.kGradians:case Fc.kMilliseconds:case Fc.kSeconds:case Fc.kTurns:var i=this.value,o=ml(this.unit);if(i<-999999||i>999999){var a=ml(this.unit);r=!Number.isFinite(i)||Number.isNaN(i)?function(t,e){void 0===e&&(e="");var n="";return Number.isFinite(t)?(Ac(Number.isNaN(t)),n="NaN"):n=t>0?"infinity":"-infinity",n+e}(i,a):i+(a||"")}else r=""+i+o}return n+=r},e}(Al),Il=function(t){function e(){return t.apply(this,arguments)||this}return nl(e,t),e.prototype.isUnitValue=function(){return!1},e}(Al),Nl=function(t){function e(e,n){var r;return(r=t.call(this,n)||this).value=void 0,r.operator="invert",r.value=e,r}nl(e,t),e.create=function(t){return new e(t,Ml.negateExponents(t.type_))};var n=e.prototype;return n.clone=function(){return new e(this.value,this.type_)},n.getType=function(){return ul.kInvertType},n.equals=function(t){if(t.getType()!==ul.kInvertType)return!1;var e=t;return this.value.equals(e.value)},n.sumValue=function(){var t=this.value.sumValue();return 0===t.length||1!==t.length||0===t[0].value?null:(Object.keys(t[0].units).forEach((function(e){t[0].units[e]*=-1})),t[0].value=1/t[0].value,t)},n.buildCSSText=function(t,e,n){return e==Hc.kNo&&(n+=t===Gc.kYes?"(":"calc("),n+="1 / ",n=this.value.buildCSSText(Gc.kYes,Hc.kNo,n),e===Hc.kNo&&(n+=")"),n},e}(Il),Dl=function(t){function e(e,n){var r;return(r=t.call(this,n)||this).value=void 0,r.operator="negate",r.value=e,r}nl(e,t),e.create=function(t){return new e(t,t.type_)};var n=e.prototype;return n.clone=function(){return new e(this.value,this.type_)},n.getType=function(){return ul.kNegateType},n.equals=function(t){if(t.getType()!==ul.kNegateType)return!1;var e=t;return this.value.equals(e.value)},n.sumValue=function(){var t=this.value.sumValue();return 0===t.length?null:(t.forEach((function(t){t.value*=-1})),t)},n.buildCSSText=function(t,e,n){return e==Hc.kNo&&(n+=t===Gc.kYes?"(":"calc("),n+="-",n=this.value.buildCSSText(Gc.kYes,Hc.kNo,n),e===Hc.kNo&&(n+=")"),n},e}(Il);function Fl(t,e,n){for(var r=t[0].type_,i=1;i<t.length;i++)r=e(r,t[i].type_,false);return r}var jl=function(t){function e(e,n){var r;return(r=t.call(this,n)||this).values=void 0,r.values=e,r}nl(e,t);var n=e.prototype;return n.numericValues=function(){return this.values},n.equals=function(t){return this.getType()===t.getType()&&this.values.every((function(e,n){return e.equals(t.values[n])}))},e}(Il),Bl=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))||this).operator="min",e}nl(e,t),e.create=function(t){return new e(t,Fl(t,Ml.add))};var n=e.prototype;return n.clone=function(){return new e(this.values,this.type_)},n.getType=function(){return ul.kMinType},n.sumValue=function(){var t=this.numericValues()[0].sumValue();if(!t.length)return null;for(var e,n=sl(this.numericValues());!(e=n()).done;){var r=e.value.sumValue();if(!r.length||JSON.stringify(r[0].units)!==JSON.stringify(t[0].units))return null;r[0].value<t[0].value&&(t=r)}return t},n.buildCSSText=function(t,e,n){n+="min(";for(var r,i=!0,o=sl(this.numericValues());!(r=o()).done;){i||(n+=", "),i=!1,n=r.value.buildCSSText(Gc.kYes,Hc.kYes,n)}return n+=")"},e}(jl),zl=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))||this).operator="max",e}nl(e,t),e.create=function(t){return new e(t,Fl(t,Ml.add))};var n=e.prototype;return n.clone=function(){return new e(this.values,this.type_)},n.getType=function(){return ul.kMaxType},n.sumValue=function(){var t=this.numericValues()[0].sumValue();if(!t.length)return null;for(var e,n=sl(this.numericValues());!(e=n()).done;){var r=e.value.sumValue();if(!r.length||JSON.stringify(r[0].units)!==JSON.stringify(t[0].units))return null;r[0].value<t[0].value&&(t=r)}return t},n.buildCSSText=function(t,e,n){n+="max(";for(var r,i=!0,o=sl(this.numericValues());!(r=o()).done;){i||(n+=", "),i=!1,n=r.value.buildCSSText(Gc.kYes,Hc.kYes,n)}return n+=")"},e}(jl),Ul=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))||this).operator="sum",e}nl(e,t),e.create=function(t){return new e(t,Fl(t,Ml.add))},e.numericTypeFromUnitMap=function(t){var e=new Ml;return Object.keys(t).forEach((function(n){var r=t[n];e=Ml.multiply(e,new Ml(Number(n),r),false),Ac(!0)})),e},e.canCreateNumericTypeFromSumValue=function(t){var e=this;Ac(!!t.length);var n=this.numericTypeFromUnitMap(t[0].units);return t.every((function(t){return Ml.add(n,e.numericTypeFromUnitMap(t.units),false),!0}))};var n=e.prototype;return n.clone=function(){return new e(this.values,this.type_)},n.getType=function(){return ul.kSumType},n.sumValue=function(){var t=[];return this.numericValues().forEach((function(e){var n=e.sumValue();if(!n.length)return null;n.forEach((function(e){var n=t.findIndex((function(t){return JSON.stringify(t.units)===JSON.stringify(e.units)}));-1===n?t.push(el({},e)):t[n].value+=e.value}))})),e.canCreateNumericTypeFromSumValue(t)?t:null},n.buildCSSText=function(t,e,n){e==Hc.kNo&&(n+=t===Gc.kYes?"(":"calc(");var r=this.numericValues();n=r[0].buildCSSText(Gc.kYes,Hc.kNo,n);for(var i=1;i<r.length;i++){var o=r[i];o.getType()===ul.kNegateType?(n+=" - ",n=o.value.buildCSSText(Gc.kYes,Hc.kNo,n)):(n+=" + ",n=o.buildCSSText(Gc.kYes,Hc.kNo,n))}return e===Hc.kNo&&(n+=")"),n},e}(jl),Vl=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))||this).operator="product",e}nl(e,t),e.create=function(t){return new e(t,Fl(t,Ml.multiply))},e.multiplyUnitMaps=function(t,e){return Object.keys(e).forEach((function(n){Tc(e[n].value,0);var r=n in t?t[n].value:0;r+e[n].value===0?delete t[n]:t[n]=r+e[n].value})),t};var n=e.prototype;return n.clone=function(){return new e(this.values,this.type_)},n.getType=function(){return ul.kProductType},n.sumValue=function(){var t=[{value:1,units:{}}];return this.numericValues().forEach((function(n){var r=n.sumValue();if(!r.length)return null;var i=[];t.forEach((function(t){r.forEach((function(n){i.push({value:t.value*n.value,units:e.multiplyUnitMaps(t.units,n.units)})}))})),t=i})),t},n.buildCSSText=function(t,e,n){e==Hc.kNo&&(n+=t===Gc.kYes?"(":"calc(");var r=this.numericValues();n=r[0].buildCSSText(Gc.kYes,Hc.kNo,n);for(var i=1;i<r.length;i++){var o=r[i];o.getType()===ul.kInvertType?(n+=" / ",n=o.value.buildCSSText(Gc.kYes,Hc.kNo,n)):(n+=" * ",n=o.buildCSSText(Gc.kYes,Hc.kNo,n))}return e===Hc.kNo&&(n+=")"),n},e}(jl),Gl=new Rl(0,"px");new Rl(1,"px");var Wl=new Rl(0,"deg"),Hl=function(t){function e(e,n,r,i,o){var a;return void 0===i&&(i=1),void 0===o&&(o=!1),(a=t.call(this,"rgb")||this).r=void 0,a.g=void 0,a.b=void 0,a.alpha=void 0,a.isNone=void 0,a.r=e,a.g=n,a.b=r,a.alpha=i,a.isNone=o,a}nl(e,t);var n=e.prototype;return n.clone=function(){return new e(this.r,this.g,this.b,this.alpha)},n.buildCSSText=function(t,e,n){return n+"rgba("+this.r+","+this.g+","+this.b+","+this.alpha+")"},e}(gl),Yl=function(t){var e=t.name,n=t.inherits,r=t.interpolable,i=t.initialValue,o=t.syntax;ym.styleValueRegistry.registerMetadata({n:e,inh:n,int:r,d:i,syntax:o})},Xl=new Sl("unset"),ql=new Sl("initial"),Zl=new Sl("inherit"),$l={"":Xl,unset:Xl,initial:ql,inherit:Zl},Kl=function(t){return $l[t]||($l[t]=new Sl(t)),$l[t]},Jl=new Hl(0,0,0,0,!0),Ql=new Hl(0,0,0,0),th=Mc((function(t,e,n,r){return new Hl(t,e,n,r)}),(function(t,e,n,r){return"rgba("+t+","+e+","+n+","+r+")"})),eh=Mc((function(t,e){return void 0===e&&(e=Fc.kNumber),new Rl(t,e)}),(function(t,e){return void 0===e&&(e=Fc.kNumber),""+t+e})),nh=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,rh=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,ih=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,oh=/[\d.]+:(#[^\s]+|[^\)]+\))/gi;var ah={left:180,top:-90,bottom:90,right:0,"left top":225,"top left":225,"left bottom":135,"bottom left":135,"right top":-45,"top right":-45,"right bottom":45,"bottom right":45},sh=Mc((function(t){var e;return e="angular"===t.type?Number(t.value):ah[t.value]||0,eh(e,"deg")})),uh=Mc((function(t){var e=50,n=50,r="%",i="%";if("position"===(null==t?void 0:t.type)){var o=t.value,a=o.x,s=o.y;"position-keyword"===(null==a?void 0:a.type)&&("left"===a.value?e=0:"center"===a.value?e=50:"right"===a.value?e=100:"top"===a.value?n=0:"bottom"===a.value&&(n=100)),"position-keyword"===(null==s?void 0:s.type)&&("left"===s.value?e=0:"center"===s.value?n=50:"right"===s.value?e=100:"top"===s.value?n=0:"bottom"===s.value&&(n=100)),"px"!==(null==a?void 0:a.type)&&"%"!==(null==a?void 0:a.type)&&"em"!==(null==a?void 0:a.type)||(r=null==a?void 0:a.type,e=Number(a.value)),"px"!==(null==s?void 0:s.type)&&"%"!==(null==s?void 0:s.type)&&"em"!==(null==s?void 0:s.type)||(i=null==s?void 0:s.type,n=Number(s.value))}return{cx:eh(e,r),cy:eh(n,i)}})),ch=Mc((function(t){if(t.indexOf("linear")>-1||t.indexOf("radial")>-1)return Op(t).map((function(t){var e=t.type,n=t.orientation,r=t.colorStops;!function(t){var e,n,r=t.length;t[r-1].length=null!==(e=t[r-1].length)&&void 0!==e?e:{type:"%",value:"100"},r>1&&(t[0].length=null!==(n=t[0].length)&&void 0!==n?n:{type:"%",value:"0"});for(var i=0,o=Number(t[0].length.value),a=1;a<r;a++){var s,u=null===(s=t[a].length)||void 0===s?void 0:s.value;if(!zs(u)&&!zs(o)){for(var c=1;c<a-i;c++)t[i+c].length={type:"%",value:""+(o+(Number(u)-o)*c/(a-i))};i=a,o=Number(u)}}}(r);var i=r.map((function(t){return{offset:eh(t.length.value,"%"),color:Cp(t)}}));if("linear-gradient"===e)return new wl(hl.LinearGradient,{angle:n?sh(n):Wl,steps:i});if("radial-gradient"===e&&(n||(n=[{type:"shape",value:"circle"}]),"shape"===n[0].type&&"circle"===n[0].value)){var o,a=uh(n[0].at),s=a.cx,u=a.cy;if(n[0].style){var c=n[0].style,l=c.type,h=c.value;o="extent-keyword"===l?Kl(h):eh(h,l)}return new wl(hl.RadialGradient,{cx:s,cy:u,size:o,steps:i})}}));var e=t[0];if("("===t[1]||"("===t[2])if("l"===e){var n=nh.exec(t);if(n){var r,i=(null===(r=n[2].match(oh))||void 0===r?void 0:r.map((function(t){return t.split(":")})))||[];return[new wl(hl.LinearGradient,{angle:eh(parseFloat(n[1]),"deg"),steps:i.map((function(t){var e=t[0],n=t[1];return{offset:eh(100*Number(e),"%"),color:n}}))})]}}else if("r"===e){var o=function(t){var e=rh.exec(t);if(e){var n,r=(null===(n=e[4].match(oh))||void 0===n?void 0:n.map((function(t){return t.split(":")})))||[];return{cx:eh(50,"%"),cy:eh(50,"%"),steps:r.map((function(t){var e=t[0],n=t[1];return{offset:eh(100*Number(e),"%"),color:n}}))}}return null}(t);if(o){if(!$s(o))return[new wl(hl.RadialGradient,o)];t=o}}else if("p"===e)return function(t){var e=ih.exec(t);if(e){var n=e[1],r=e[2];switch(n){case"a":n="repeat";break;case"x":n="repeat-x";break;case"y":n="repeat-y";break;default:n="no-repeat"}return{image:r,repetition:n}}return null}(t)}));function lh(t){return Ws(t)&&!!t.image}var hh=Mc((function(t){if(lh(t))return el({repetition:"repeat"},t);if(zs(t)&&(t=""),"transparent"===t)return Ql;"currentColor"===t&&(t="black");var e=ch(t);if(e)return e;var n=ju(t),r=[0,0,0,0];return null!==n&&(r[0]=n.r||0,r[1]=n.g||0,r[2]=n.b||0,r[3]=n.opacity),th.apply(void 0,r)}));function fh(t,e){if(t instanceof Hl&&e instanceof Hl)return[[Number(t.r),Number(t.g),Number(t.b),Number(t.alpha)],[Number(e.r),Number(e.g),Number(e.b),Number(e.alpha)],function(t){var e=t.slice();if(e[3])for(var n=0;n<3;n++)e[n]=Math.round(Ks(e[n],0,255));return e[3]=Ks(e[3],0,1),"rgba("+e.join(",")+")"}]}function ph(t,e){if(zs(e))return eh(0,"px");if(e=(""+e).trim().toLowerCase(),isFinite(Number(e))){if("px".search(t)>=0)return eh(Number(e),"px");if("deg".search(t)>=0)return eh(Number(e),"deg")}var n=[];e=e.replace(t,(function(t){return n.push(t),"U"+t}));var r="U("+t.source+")";return n.map((function(t){return eh(Number(e.replace(new RegExp("U"+t,"g"),"").replace(new RegExp(r,"g"),"*0")),t)}))[0]}var dh=Mc((function(t){return ph(new RegExp("px","g"),t)}));Mc((function(t){return ph(new RegExp("%","g"),t)}));var mh=Mc((function(t){return Js(t)||isFinite(Number(t))?eh(Number(t),"px"):ph(new RegExp("px|%|em|rem","g"),t)})),vh=Mc((function(t){return ph(new RegExp("deg|rad|grad|turn","g"),t)}));function gh(t,e,n,r,i){void 0===i&&(i=0);var o="",a=t.value||0,s=e.value||0,u=Ll(t.unit),c=t.convertTo(u),l=e.convertTo(u);return c&&l?(a=c.value,s=l.value,o=ml(t.unit)):(Rl.isLength(t.unit)||Rl.isLength(e.unit))&&(a=bh(t,i,n),s=bh(e,i,n),o="px"),[a,s,function(t){return r&&(t=Math.max(t,0)),t+o}]}function yh(t){var e=0;return t.unit===Fc.kDegrees?e=t.value:t.unit===Fc.kRadians?e=gp(Number(t.value)):t.unit===Fc.kTurns&&(e=360*Number(t.value)),e}function xh(t){return $s(t)?t.split(" ").map((function(t){return mh(t)})):t.map((function(t){return mh(t.toString())}))}function bh(t,e,n){if(t.unit===Fc.kPixels)return Number(t.value);if(t.unit===Fc.kPercentage&&n){var r=n.nodeName===xc.GROUP?n.getLocalBounds():n.getGeometryBounds(),i=0;return gc.isEmpty(r)||(i=2*r.halfExtents[e]),Number(t.value)/100*i}return 0}var _h=["blur","brightness","drop-shadow","contrast","grayscale","sepia","saturate","hue-rotate","invert"];function wh(t){if(void 0===t&&(t=""),"none"===(t=t.toLowerCase().trim()))return[];for(var e,n=/\s*([\w-]+)\(([^)]*)\)/g,r=[],i=0;e=n.exec(t);){if(e.index!==i)return[];if(i=e.index+e[0].length,_h.indexOf(e[1])>-1&&r.push({name:e[1],params:e[2].split(" ").map((function(t){return ph(/deg|rad|grad|turn|px|%/g,t)||hh(t)}))}),n.lastIndex===t.length)return r}return[]}function Sh(t){return t.toString()}var Mh=Mc((function(t){return"number"==typeof t?eh(t):/^\s*[-+]?(\d*\.)?\d+\s*$/.test(t)?eh(Number(t)):eh(0)}));function Eh(t,e){return[t,e,Sh]}function Ah(t,e){return function(n,r){return[n,r,function(n){return Sh(Ks(n,t,e))}]}}function Th(t,e){if(t.length===e.length)return[t,e,function(t){return t}]}Mc((function(t){return $s(t)?t.split(" ").map(Mh):t.map(Mh)}));var Ch=function(t){if(""===t||Array.isArray(t)&&0===t.length)return{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:{x:0,y:0,width:0,height:0}};var e;try{e=ys(t)}catch(f){e=ys("")}var n=function(t){for(var e=!1,n=t.length,r=0;r<n;r++){var i=t[r][0];if("C"===i||"A"===i||"Q"===i){e=!0;break}}return e}(e),r=function(t){for(var e=[],n=[],r=[],i=0;i<t.length;i++){var o=t[i],a=o[0];"M"===a?(r.length&&(n.push(r),r=[]),r.push([o[1],o[2]])):"Z"===a?r.length&&(e.push(r),r=[]):r.push([o[1],o[2]])}r.length>0&&n.push(r);return{polygons:e,polylines:n}}(e),i=r.polygons,o=r.polylines,a=function(t){for(var e=[],n=null,r=null,i=null,o=0,a=t.length,s=0;s<a;s++){var u=t[s];r=t[s+1];var c=u[0],l={command:c,prePoint:n,params:u,startTangent:null,endTangent:null,currentPoint:null,nextPoint:null,arcParams:null,box:null,cubicParams:null};switch(c){case"M":i=[u[1],u[2]],o=s;break;case"A":var h=zp(n,u);l.arcParams=h}if("Z"===c)n=i,r=t[o+1];else{var f=u.length;n=[u[f-2],u[f-1]]}r&&"Z"===r[0]&&(r=t[o],e[o]&&(e[o].prePoint=n)),l.currentPoint=n,e[o]&&Pp(n,e[o].currentPoint)&&(e[o].prePoint=l.prePoint);var p=r?[r[r.length-2],r[r.length-1]]:null;l.nextPoint=p;var d=l.prePoint;if(["L","H","V"].includes(c))l.startTangent=[d[0]-n[0],d[1]-n[1]],l.endTangent=[n[0]-d[0],n[1]-d[1]];else if("Q"===c){var m=[u[1],u[2]];l.startTangent=[d[0]-m[0],d[1]-m[1]],l.endTangent=[n[0]-m[0],n[1]-m[1]]}else if("T"===c){var v=e[s-1],g=Rp(v.currentPoint,d);"Q"===v.command?(l.command="Q",l.startTangent=[d[0]-g[0],d[1]-g[1]],l.endTangent=[n[0]-g[0],n[1]-g[1]]):(l.command="TL",l.startTangent=[d[0]-n[0],d[1]-n[1]],l.endTangent=[n[0]-d[0],n[1]-d[1]])}else if("C"===c){var y=[u[1],u[2]],x=[u[3],u[4]];l.startTangent=[d[0]-y[0],d[1]-y[1]],l.endTangent=[n[0]-x[0],n[1]-x[1]],0===l.startTangent[0]&&0===l.startTangent[1]&&(l.startTangent=[y[0]-x[0],y[1]-x[1]]),0===l.endTangent[0]&&0===l.endTangent[1]&&(l.endTangent=[x[0]-y[0],x[1]-y[1]])}else if("S"===c){var b=e[s-1],_=Rp(b.currentPoint,d),w=[u[1],u[2]];"C"===b.command?(l.command="C",l.startTangent=[d[0]-_[0],d[1]-_[1]],l.endTangent=[n[0]-w[0],n[1]-w[1]]):(l.command="SQ",l.startTangent=[d[0]-w[0],d[1]-w[1]],l.endTangent=[n[0]-w[0],n[1]-w[1]])}else if("A"===c){var S=Dp(l,0),M=S.x,E=S.y,A=Dp(l,1,!1),T=A.x,C=A.y;l.startTangent=[M,E],l.endTangent=[T,C]}e.push(l)}return e}(e),s=function(t,e){for(var n=[],r=[],i=[],o=0;o<t.length;o++){var a=t[o],s=a.currentPoint,u=a.params,c=a.prePoint,l=void 0;switch(a.command){case"Q":l=rc(c[0],c[1],u[1],u[2],u[3],u[4]);break;case"C":l=ac(c[0],c[1],u[1],u[2],u[3],u[4],u[5],u[6]);break;case"A":var h=a.arcParams;l=cc(h.cx,h.cy,h.rx,h.ry,h.xRotation,h.startAngle,h.endAngle);break;default:n.push(s[0]),r.push(s[1])}l&&(a.box=l,n.push(l.x,l.x+l.width),r.push(l.y,l.y+l.height)),e&&("L"===a.command||"M"===a.command)&&a.prePoint&&a.nextPoint&&i.push(a)}n=n.filter((function(t){return!Number.isNaN(t)&&t!==1/0&&t!==-1/0})),r=r.filter((function(t){return!Number.isNaN(t)&&t!==1/0&&t!==-1/0}));var f=Zs(n),p=Zs(r),d=qs(n),m=qs(r);if(0===i.length)return{x:f,y:p,width:d-f,height:m-p};for(var v=0;v<i.length;v++){var g=i[v],y=g.currentPoint;y[0]===f?f-=Lp(g,e).xExtra:y[0]===d&&(d+=Lp(g,e).xExtra),y[1]===p?p-=Lp(g,e).yExtra:y[1]===m&&(m+=Lp(g,e).yExtra)}return{x:f,y:p,width:d-f,height:m-p}}(a,0),u=s.x,c=s.y,l=s.width,h=s.height;return{absolutePath:e,hasArc:n,segments:a,polygons:i,polylines:o,totalLength:0,rect:{x:Number.isFinite(u)?u:0,y:Number.isFinite(c)?c:0,width:Number.isFinite(l)?l:0,height:Number.isFinite(h)?h:0}}},Oh=Mc(Ch);function kh(t,e){var n=$s(t)?Oh(t):Ch(t);return e&&(e.parsedStyle.defX=n.rect.x,e.parsedStyle.defY=n.rect.y),n}function Ph(t,e,n){var r=t.curve,i=e.curve;r&&0!==r.length||(r=As(t.absolutePath,!1),t.curve=r),i&&0!==i.length||(i=As(e.absolutePath,!1),e.curve=i);var o=[r,i];r.length!==i.length&&(o=Fs(r,i));var a,s,u,c,l,h,f,p,d=Ns(o[0])!==Ns(o[1])?(a=o[0],s=a.slice(1).map((function(t,e,n){return e?n[e-1].slice(-2).concat(t.slice(1)):a[0].slice(1).concat(t.slice(1))})).map((function(t){return t.map((function(e,n){return t[t.length-n-2*(1-n%2)]}))})).reverse(),[["M"].concat(s[0].slice(0,2))].concat(s.map((function(t){return["C"].concat(t.slice(2))})))):Ya(o[0]);return[d,(u=o[1],c=d,l=u.length-1,h=[],f=0,p=function(t){var e=t.length,n=e-1;return t.map((function(r,i){return t.map((function(r,o){var a,s=i+o;return 0===o||t[s]&&"M"===t[s][0]?(a=t[s],["M"].concat(a.slice(-2))):(s>=e&&(s-=n),t[s])}))}))}(u),p.forEach((function(t,e){u.slice(1).forEach((function(t,n){f+=ws(u[(e+n)%l].slice(-2),c[n%l].slice(-2))})),h[e]=f,f=0})),p[h.indexOf(Math.min.apply(null,h))]),function(t){return t}]}function Lh(t,e){var n;n=$s(t)?t.split(" ").map((function(t){var e=t.split(","),n=e[0],r=e[1];return[Number(n),Number(r)]})):t;var r,i,o=[],a=0,s=lc(n);n.forEach((function(t,e){n[e+1]&&((r=[0,0])[0]=a/s,i=tc.length(t[0],t[1],n[e+1][0],n[e+1][1]),a+=i,r[1]=a/s,o.push(r))}));var u=Math.min.apply(Math,n.map((function(t){return t[0]}))),c=Math.min.apply(Math,n.map((function(t){return t[1]})));return e&&(e.parsedStyle.defX=u,e.parsedStyle.defY=c),{points:n,totalLength:s,segments:o}}var Rh=null;function Ih(t){return function(e){var n=0;return t.map((function(t){return t===Rh?e[n++]:t}))}}function Nh(t){return t}var Dh={matrix:["NNNNNN",[Rh,Rh,0,0,Rh,Rh,0,0,0,0,1,0,Rh,Rh,0,1],Nh],matrix3d:["NNNNNNNNNNNNNNNN",Nh],rotate:["A"],rotatex:["A"],rotatey:["A"],rotatez:["A"],rotate3d:["NNNA"],perspective:["L"],scale:["Nn",Ih([Rh,Rh,new Rl(1)]),Nh],scalex:["N",Ih([Rh,new Rl(1),new Rl(1)]),Ih([Rh,new Rl(1)])],scaley:["N",Ih([new Rl(1),Rh,new Rl(1)]),Ih([new Rl(1),Rh])],scalez:["N",Ih([new Rl(1),new Rl(1),Rh])],scale3d:["NNN",Nh],skew:["Aa",null,Nh],skewx:["A",null,Ih([Rh,Wl])],skewy:["A",null,Ih([Wl,Rh])],translate:["Tt",Ih([Rh,Rh,Gl]),Nh],translatex:["T",Ih([Rh,Gl,Gl]),Ih([Rh,Gl])],translatey:["T",Ih([Gl,Rh,Gl]),Ih([Gl,Rh])],translatez:["L",Ih([Gl,Gl,Rh])],translate3d:["TTL",Nh]};function Fh(t){if("none"===(t=(t||"none").toLowerCase().trim()))return[];for(var e,n=/\s*(\w+)\(([^)]*)\)/g,r=[],i=0;e=n.exec(t);){if(e.index!==i)return[];i=e.index+e[0].length;var o=e[1],a=Dh[o];if(!a)return[];var s=e[2].split(","),u=a[0];if(u.length<s.length)return[];for(var c=[],l=0;l<u.length;l++){var h=s[l],f=u[l],p=void 0;if(void 0===(p=h?{A:function(t){return"0"===t.trim()?Wl:vh(t)},N:Mh,T:mh,L:dh}[f.toUpperCase()](h):{a:Wl,n:c[0],t:Gl}[f]))return[];c.push(p)}if(r.push({t:o,d:c}),n.lastIndex===t.length)return r}return[]}function jh(t){var e,n,r,i;switch(t.t){case"rotatex":return i=vp(yh(t.d[0])),[1,0,0,0,0,Math.cos(i),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1];case"rotatey":return i=vp(yh(t.d[0])),[Math.cos(i),0,-Math.sin(i),0,0,1,0,0,Math.sin(i),0,Math.cos(i),0,0,0,0,1];case"rotate":case"rotatez":return i=vp(yh(t.d[0])),[Math.cos(i),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1,0,0,0,0,1];case"rotate3d":e=t.d[0].value,n=t.d[1].value,r=t.d[2].value,i=vp(yh(t.d[3]));var o=e*e+n*n+r*r;if(0===o)e=1,n=0,r=0;else if(1!==o){var a=Math.sqrt(o);e/=a,n/=a,r/=a}var s=Math.sin(i/2),u=s*Math.cos(i/2),c=s*s;return[1-2*(n*n+r*r)*c,2*(e*n*c+r*u),2*(e*r*c-n*u),0,2*(e*n*c-r*u),1-2*(e*e+r*r)*c,2*(n*r*c+e*u),0,2*(e*r*c+n*u),2*(n*r*c-e*u),1-2*(e*e+n*n)*c,0,0,0,0,1];case"scale":return[t.d[0].value,0,0,0,0,t.d[1].value,0,0,0,0,1,0,0,0,0,1];case"scalex":return[t.d[0].value,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"scaley":return[1,0,0,0,0,t.d[0].value,0,0,0,0,1,0,0,0,0,1];case"scalez":return[1,0,0,0,0,1,0,0,0,0,t.d[0].value,0,0,0,0,1];case"scale3d":return[t.d[0].value,0,0,0,0,t.d[1].value,0,0,0,0,t.d[2].value,0,0,0,0,1];case"skew":var l=vp(yh(t.d[0])),h=vp(yh(t.d[1]));return[1,Math.tan(h),0,0,Math.tan(l),1,0,0,0,0,1,0,0,0,0,1];case"skewx":return i=vp(yh(t.d[0])),[1,0,0,0,Math.tan(i),1,0,0,0,0,1,0,0,0,0,1];case"skewy":return i=vp(yh(t.d[0])),[1,Math.tan(i),0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"translate":return[1,0,0,0,0,1,0,0,0,0,1,0,e=bh(t.d[0],0,null)||0,n=bh(t.d[1],0,null)||0,0,1];case"translatex":return[1,0,0,0,0,1,0,0,0,0,1,0,e=bh(t.d[0],0,null)||0,0,0,1];case"translatey":return[1,0,0,0,0,1,0,0,0,0,1,0,0,n=bh(t.d[0],0,null)||0,0,1];case"translatez":return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,r=bh(t.d[0],0,null)||0,1];case"translate3d":return[1,0,0,0,0,1,0,0,0,0,1,0,e=bh(t.d[0],0,null)||0,n=bh(t.d[1],0,null)||0,r=bh(t.d[2],0,null)||0,1];case"perspective":var f=bh(t.d[0],0,null)||0;return[1,0,0,0,0,1,0,0,0,0,1,f?-1/f:0,0,0,0,1];case"matrix":return[t.d[0].value,t.d[1].value,0,0,t.d[2].value,t.d[3].value,0,0,0,0,1,0,t.d[4].value,t.d[5].value,0,1];case"matrix3d":return t.d.map((function(t){return t.value}))}}function Bh(t,e){return[t[0]*e[0]+t[4]*e[1]+t[8]*e[2]+t[12]*e[3],t[1]*e[0]+t[5]*e[1]+t[9]*e[2]+t[13]*e[3],t[2]*e[0]+t[6]*e[1]+t[10]*e[2]+t[14]*e[3],t[3]*e[0]+t[7]*e[1]+t[11]*e[2]+t[15]*e[3],t[0]*e[4]+t[4]*e[5]+t[8]*e[6]+t[12]*e[7],t[1]*e[4]+t[5]*e[5]+t[9]*e[6]+t[13]*e[7],t[2]*e[4]+t[6]*e[5]+t[10]*e[6]+t[14]*e[7],t[3]*e[4]+t[7]*e[5]+t[11]*e[6]+t[15]*e[7],t[0]*e[8]+t[4]*e[9]+t[8]*e[10]+t[12]*e[11],t[1]*e[8]+t[5]*e[9]+t[9]*e[10]+t[13]*e[11],t[2]*e[8]+t[6]*e[9]+t[10]*e[10]+t[14]*e[11],t[3]*e[8]+t[7]*e[9]+t[11]*e[10]+t[15]*e[11],t[0]*e[12]+t[4]*e[13]+t[8]*e[14]+t[12]*e[15],t[1]*e[12]+t[5]*e[13]+t[9]*e[14]+t[13]*e[15],t[2]*e[12]+t[6]*e[13]+t[10]*e[14]+t[14]*e[15],t[3]*e[12]+t[7]*e[13]+t[11]*e[14]+t[15]*e[15]]}function zh(t){var e=[0,0,0],n=[1,1,1],r=[0,0,0],i=[0,0,0,1],o=[0,0,0,1];return function(t,e,n,r,i,o){if(!function(t,e){var n=e[15];if(0===n)return!1;for(var r=1/n,i=0;i<16;i++)t[i]=e[i]*r;return!0}(bp,t))return!1;if(io(_p,bp),_p[3]=0,_p[7]=0,_p[11]=0,_p[15]=1,Math.abs(lo(_p))<1e-8)return!1;var a=bp[3],s=bp[7],u=bp[11],c=bp[12],l=bp[13],h=bp[14],f=bp[15];if(0!==a||0!==s||0!==u){if(wp[0]=a,wp[1]=s,wp[2]=u,wp[3]=f,!co(_p,_p))return!1;uo(_p,_p),ba(i,wp,_p)}else i[0]=i[1]=i[2]=0,i[3]=1;if(e[0]=c,e[1]=l,e[2]=h,function(t,e){t[0][0]=e[0],t[0][1]=e[1],t[0][2]=e[2],t[1][0]=e[4],t[1][1]=e[5],t[1][2]=e[6],t[2][0]=e[8],t[2][1]=e[9],t[2][2]=e[10]}(Sp,bp),n[0]=jo(Sp[0]),Qo(Sp[0],Sp[0]),r[0]=ta(Sp[0],Sp[1]),Ep(Sp[1],Sp[1],Sp[0],1,-r[0]),n[1]=jo(Sp[1]),Qo(Sp[1],Sp[1]),r[0]/=n[1],r[1]=ta(Sp[0],Sp[2]),Ep(Sp[2],Sp[2],Sp[0],1,-r[1]),r[2]=ta(Sp[1],Sp[2]),Ep(Sp[2],Sp[2],Sp[1],1,-r[2]),n[2]=jo(Sp[2]),Qo(Sp[2],Sp[2]),r[1]/=n[2],r[2]/=n[2],ea(Mp,Sp[1],Sp[2]),ta(Sp[0],Mp)<0)for(var p=0;p<3;p++)n[p]*=-1,Sp[p][0]*=-1,Sp[p][1]*=-1,Sp[p][2]*=-1;o[0]=.5*Math.sqrt(Math.max(1+Sp[0][0]-Sp[1][1]-Sp[2][2],0)),o[1]=.5*Math.sqrt(Math.max(1-Sp[0][0]+Sp[1][1]-Sp[2][2],0)),o[2]=.5*Math.sqrt(Math.max(1-Sp[0][0]-Sp[1][1]+Sp[2][2],0)),o[3]=.5*Math.sqrt(Math.max(1+Sp[0][0]+Sp[1][1]+Sp[2][2],0)),Sp[2][1]>Sp[1][2]&&(o[0]=-o[0]);Sp[0][2]>Sp[2][0]&&(o[1]=-o[1]);Sp[1][0]>Sp[0][1]&&(o[2]=-o[2])}(function(t){return 0===t.length?[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]:t.map(jh).reduce(Bh)}(t),e,n,r,i,o),[[e,n,r,o,i]]}var Uh=function(){function t(t,e){for(var n=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],r=0;r<4;r++)for(var i=0;i<4;i++)for(var o=0;o<4;o++)n[r][i]+=e[r][o]*t[o][i];return n}return function(e,n,r,i,o){for(var a=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],s=0;s<4;s++)a[s][3]=o[s];for(var u=0;u<3;u++)for(var c=0;c<3;c++)a[3][u]+=e[c]*a[c][u];var l=i[0],h=i[1],f=i[2],p=i[3],d=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];d[0][0]=1-2*(h*h+f*f),d[0][1]=2*(l*h-f*p),d[0][2]=2*(l*f+h*p),d[1][0]=2*(l*h+f*p),d[1][1]=1-2*(l*l+f*f),d[1][2]=2*(h*f-l*p),d[2][0]=2*(l*f-h*p),d[2][1]=2*(h*f+l*p),d[2][2]=1-2*(l*l+h*h),a=t(a,d);var m,v=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];r[2]&&(v[2][1]=r[2],a=t(a,v)),r[1]&&(v[2][1]=0,v[2][0]=r[0],a=t(a,v)),r[0]&&(v[2][0]=0,v[1][0]=r[0],a=t(a,v));for(var g=0;g<3;g++)for(var y=0;y<3;y++)a[g][y]*=n[g];return 0==(m=a)[0][2]&&0==m[0][3]&&0==m[1][2]&&0==m[1][3]&&0==m[2][0]&&0==m[2][1]&&1==m[2][2]&&0==m[2][3]&&0==m[3][2]&&1==m[3][3]?[a[0][0],a[0][1],a[1][0],a[1][1],a[3][0],a[3][1]]:a[0].concat(a[1],a[2],a[3])}}();function Vh(t){return t.toFixed(6).replace(".000000","")}function Gh(t,e){var n,r;return t.decompositionPair!==e&&(t.decompositionPair=e,n=zh(t)),e.decompositionPair!==t&&(e.decompositionPair=t,r=zh(e)),null===n[0]||null===r[0]?[[!1],[!0],function(n){return n?e[0].d:t[0].d}]:(n[0].push(0),r[0].push(1),[n,r,function(t){var e=function(t,e,n){var r=function(t,e){for(var n=0,r=0;r<t.length;r++)n+=t[r]*e[r];return n}(t,e);r=Ks(r,-1,1);var i=[];if(1===r)i=t;else for(var o=Math.acos(r),a=1*Math.sin(n*o)/Math.sqrt(1-r*r),s=0;s<4;s++)i.push(t[s]*(Math.cos(n*o)-r*a)+e[s]*a);return i}(n[0][3],r[0][3],t[5]);return Uh(t[0],t[1],t[2],e,t[4]).map(Vh).join(",")}])}function Wh(t){return t.replace(/[xy]/,"")}function Hh(t){return t.replace(/(x|y|z|3d)?$/,"3d")}function Yh(t,e,n){var r=!1;if(!t.length||!e.length){t.length||(r=!0,t=e,e=[]);for(var i=function(n){var r=t[n],i=r.t,o=r.d,a="scale"===i.substring(0,5)?1:0;e.push({t:i,d:o.map((function(t){return"number"==typeof t?eh(a):eh(a,t.unit)}))})},o=0;o<t.length;o++)i(o)}var a,s,u=[],c=[],l=[];if(t.length!==e.length){var h=Gh(t,e);u=[h[0]],c=[h[1]],l=[["matrix",[h[2]]]]}else for(var f=0;f<t.length;f++){var p=t[f].t,d=e[f].t,m=t[f].d,v=e[f].d,g=Dh[p],y=Dh[d],x=void 0;if(s=d,"perspective"===(a=p)&&"perspective"===s||!("matrix"!==a&&"matrix3d"!==a||"matrix"!==s&&"matrix3d"!==s)){var b=Gh([t[f]],[e[f]]);u.push(b[0]),c.push(b[1]),l.push(["matrix",[b[2]]])}else{if(p===d)x=p;else if(g[2]&&y[2]&&Wh(p)===Wh(d))x=Wh(p),m=g[2](m),v=y[2](v);else{if(!g[1]||!y[1]||Hh(p)!==Hh(d)){var _=Gh(t,e);u=[_[0]],c=[_[1]],l=[["matrix",[_[2]]]];break}x=Hh(p),m=g[1](m),v=y[1](v)}for(var w=[],S=[],M=[],E=0;E<m.length;E++){var A=gh(m[E],v[E],n,!1,E);w[E]=A[0],S[E]=A[1],M.push(A[2])}u.push(w),c.push(S),l.push([x,M])}}if(r){var T=u;u=c,c=T}return[u,c,function(t){return t.map((function(t,e){var n=t.map((function(t,n){return l[e][1][n](t)})).join(",");return"matrix"===l[e][0]&&16===n.split(",").length&&(l[e][0]="matrix3d"),"matrix3d"===l[e][0]&&6===n.split(",").length&&(l[e][0]="matrix"),l[e][0]+"("+n+")"})).join(" ")}]}var Xh=Mc((function(t){if($s(t)){if("text-anchor"===t)return[eh(0,"px"),eh(0,"px")];var e=t.split(" ");return 1===e.length&&("top"===e[0]||"bottom"===e[0]?(e[1]=e[0],e[0]="center"):e[1]="center"),2!==e.length?null:[mh(qh(e[0])),mh(qh(e[1]))]}return[eh(t[0]||0,"px"),eh(t[1]||0,"px")]}));function qh(t){return"center"===t?"50%":"left"===t||"top"===t?"0":"right"===t||"bottom"===t?"100%":t}var Zh=function(){function t(){this.parser=vh,this.mixer=Eh}return t.prototype.calculator=function(t,e,n,r){return yh(n)},t}(),$h=function(){function t(){}return t.prototype.calculator=function(t,e,n,r){return n instanceof Sl&&(n=null),ym.sceneGraphService.updateDisplayObjectDependency(t,e,n,r),"clipPath"===t&&r.forEach((function(t){0===t.childNodes.length&&ym.sceneGraphService.dirtifyToRoot(t)})),n},t}(),Kh=function(){function t(){this.parser=hh,this.mixer=fh}return t.prototype.calculator=function(t,e,n,r){return n instanceof Sl?"none"===n.value?Jl:Ql:n},t}(),Jh=function(){function t(){this.parser=wh}return t.prototype.calculator=function(t,e,n){return n instanceof Sl?[]:n},t}();function Qh(t){var e=t.parsedStyle.fontSize;return zs(e)?null:e}var tf=function(){function t(){this.parser=mh,this.mixer=Eh}return t.prototype.calculator=function(t,e,n,r,i){if(!Rl.isRelativeUnit(n.unit))return n.value;if(n.unit===Fc.kPercentage)return 0;if(n.unit===Fc.kEms){if(r.parentNode){var o=Qh(r.parentNode);if(o)return o*=n.value;i.addUnresolveProperty(r,t)}else i.addUnresolveProperty(r,t);return 0}if(n.unit===Fc.kRems){var a;if(null==r||null===(a=r.ownerDocument)||void 0===a?void 0:a.documentElement){var s=Qh(r.ownerDocument.documentElement);if(s)return s*=n.value;i.addUnresolveProperty(r,t)}else i.addUnresolveProperty(r,t);return 0}},t}(),ef=function(){function t(){this.mixer=Th}var e=t.prototype;return e.parser=function(t){var e=xh(Js(t)?[t]:t);return 1===e.length?[e[0],e[0]]:[e[0],e[1]]},e.calculator=function(t,e,n){return n.map((function(t){return t.value}))},t}(),nf=function(){function t(){this.mixer=Th}var e=t.prototype;return e.parser=function(t){var e=xh(Js(t)?[t]:t);return 1===e.length?[e[0],e[0],e[0],e[0]]:2===e.length?[e[0],e[1],e[0],e[1]]:3===e.length?[e[0],e[1],e[2],e[1]]:[e[0],e[1],e[2],e[3]]},e.calculator=function(t,e,n){return n.map((function(t){return t.value}))},t}(),rf=function(t){function e(){return t.apply(this,arguments)||this}return nl(e,t),e.prototype.postProcessor=function(t){var e,n,r;switch(t.nodeName){case xc.CIRCLE:case xc.ELLIPSE:var i=t.parsedStyle,o=i.cx,a=i.cy;zs(o)||(e=o),zs(a)||(n=a);break;case xc.LINE:var s=t.parsedStyle,u=s.x1,c=s.x2,l=s.y1,h=s.y2;e=Math.min(u,c),n=Math.min(l,h),r=0;break;case xc.RECT:case xc.IMAGE:case xc.GROUP:case xc.HTML:case xc.TEXT:case xc.MESH:zs(t.parsedStyle.x)||(e=t.parsedStyle.x),zs(t.parsedStyle.y)||(n=t.parsedStyle.y)}if(t.nodeName!==xc.PATH&&t.nodeName!==xc.POLYLINE&&t.nodeName!==xc.POLYGON&&(t.parsedStyle.defX=e||0,t.parsedStyle.defY=n||0),!zs(e)||!zs(n)||!zs(r)){var f=t.getLocalPosition(),p=f[0],d=f[1],m=f[2];t.setLocalPosition(zs(e)?p:e,zs(n)?d:n,zs(r)?m:r)}},e}(tf),of=function(){function t(){}return t.prototype.calculator=function(t,e,n,r){var i;n instanceof Sl&&(n=null);var o=null===(i=n)||void 0===i?void 0:i.cloneNode(!0);return o&&(o.style.isMarker=!0),o},t}(),af=function(){function t(){this.mixer=Eh,this.parser=Mh}return t.prototype.calculator=function(t,e,n){return n.value},t}(),sf=function(){function t(){this.parser=Mh,this.mixer=Ah(0,1)}var e=t.prototype;return e.calculator=function(t,e,n){return n.value},e.postProcessor=function(t){var e=t.parsedStyle,n=e.offsetPath,r=e.offsetDistance;if(n){var i=n.nodeName;if(i===xc.LINE||i===xc.PATH||i===xc.POLYLINE){var o=n.getPoint(r);o&&(t.parsedStyle.defX=o.x,t.parsedStyle.defY=o.y,t.setLocalPosition(o.x,o.y))}}},t}(),uf=function(){function t(){this.parser=Mh,this.mixer=Ah(0,1)}return t.prototype.calculator=function(t,e,n){return n.value},t}(),cf=function(){function t(){this.parser=kh,this.mixer=Ph}var e=t.prototype;return e.calculator=function(t,e,n){return n instanceof Sl&&"unset"===n.value?{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new Sc(0,0,0,0)}:n},e.postProcessor=function(t){if(t.nodeName===xc.PATH){var e=t.parsedStyle,n=e.defX,r=void 0===n?0:n,i=e.defY,o=void 0===i?0:i;t.setLocalPosition(r,o)}},t}(),lf=function(){function t(){this.parser=Lh}return t.prototype.postProcessor=function(t){if(t.nodeName===xc.POLYGON||t.nodeName===xc.POLYLINE){var e=t.parsedStyle,n=e.defX,r=e.defY;t.setLocalPosition(n,r)}},t}(),hf=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))||this).mixer=Ah(0,1/0),e}return nl(e,t),e}(tf),ff=function(){function t(){}var e=t.prototype;return e.calculator=function(t,e,n,r){return n instanceof Sl?"unset"===n.value?"":n.value:""+n},e.postProcessor=function(t){t.nodeValue=""+t.parsedStyle.text||""},t}(),pf=function(){function t(){}return t.prototype.calculator=function(t,e,n,r){var i=r.getAttribute("text");if(i){var o=i;"capitalize"===n.value?o=i.charAt(0).toUpperCase()+i.slice(1):"lowercase"===n.value?o=i.toLowerCase():"uppercase"===n.value&&(o=i.toUpperCase()),r.parsedStyle.text=o}return n.value},t}(),df=function(){function t(){this.parser=Fh,this.mixer=Yh}var e=t.prototype;return e.calculator=function(t,e,n,r){return n instanceof Sl?[]:n},e.postProcessor=function(t){Tp(t.parsedStyle.transform,t)},t}(),mf=function(){this.parser=Xh},vf=function(){function t(){this.parser=Mh}var e=t.prototype;return e.calculator=function(t,e,n,r){return n.value},e.postProcessor=function(t){if(t.parentNode){var e=t.parentNode,n=e.renderable,r=e.sortable;n&&(n.dirty=!0),r&&(r.dirty=!0)}},t}(),gf=function(){function t(){this.registry={},this.define(xc.CIRCLE,Vf),this.define(xc.ELLIPSE,Zf),this.define(xc.RECT,hp),this.define(xc.IMAGE,ep),this.define(xc.LINE,rp),this.define(xc.GROUP,Kf),this.define(xc.PATH,op),this.define(xc.POLYGON,sp),this.define(xc.POLYLINE,cp),this.define(xc.TEXT,pp),this.define(xc.HTML,Qf)}var e=t.prototype;return e.define=function(t,e){this.registry[t]=e},e.get=function(t){return this.registry[t]},t}(),yf=function(){function t(e){this.type=void 0,this.eventPhase=t.prototype.NONE,this.target=void 0,this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.currentTarget=void 0,this.defaultPrevented=!1,this.timeStamp=void 0,this.nativeEvent=void 0,this.originalEvent=void 0,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.manager=void 0,this.detail=void 0,this.layer=new wc,this.page=new wc,this.canvas=new wc,this.viewport=new wc,this.path=void 0,this.view=void 0,this.which=void 0,this.returnValue=void 0,this.srcElement=void 0,this.composed=!1,this.isTrusted=void 0,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e}var e=t.prototype;return e.composedPath=function(){return!this.manager||this.path&&this.path[0]===this.target||(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path},e.preventDefault=function(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0},e.stopImmediatePropagation=function(){this.propagationImmediatelyStopped=!0},e.stopPropagation=function(){this.propagationStopped=!0},e.initEvent=function(){},e.initUIEvent=function(){},e.clone=function(){throw new Error(Xc)},tl(t,[{key:"name",get:function(){return this.type}},{key:"layerX",get:function(){return this.layer.x}},{key:"layerY",get:function(){return this.layer.y}},{key:"pageX",get:function(){return this.page.x}},{key:"pageY",get:function(){return this.page.y}},{key:"x",get:function(){return this.canvas.x}},{key:"y",get:function(){return this.canvas.y}},{key:"canvasX",get:function(){return this.canvas.x}},{key:"canvasY",get:function(){return this.canvas.y}},{key:"viewportX",get:function(){return this.viewport.x}},{key:"viewportY",get:function(){return this.viewport.y}},{key:"propagationPath",get:function(){return this.composedPath()}}]),t}(),xf=function(t){function e(e,n){var r;return(r=t.call(this,null)||this).type=e,r.detail=n,Object.assign(ol(r),n),r}return nl(e,t),e}(yf),bf=function(){function t(){this.emitter=new fc}var e=t.prototype;return e.on=function(t,e,n){return this.addEventListener(t,e,n),this},e.addEventListener=function(t,e,n){var r=iu(n)&&n||Ws(n)&&n.capture,i=Ws(n)&&n.once,o=Cc(e)?void 0:e,a=!1,s="";if(t.indexOf(":")>-1){var u=t.split(":"),c=u[0];t=u[1],s=c,a=!0}if(t=r?t+"capture":t,e=Cc(e)?e:e.handleEvent,a){var l=e;e=function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];(null===(t=n[0].target)||void 0===t?void 0:t.name)===s&&l.apply(void 0,n)}}return i?this.emitter.once(t,e,o):this.emitter.on(t,e,o),this},e.off=function(t,e,n){return t?this.removeEventListener(t,e,n):this.removeAllEventListeners(),this},e.removeAllEventListeners=function(){this.emitter.removeAllListeners()},e.removeEventListener=function(t,e,n){var r,i=iu(n)&&n||Ws(n)&&n.capture,o=Cc(e)?void 0:e;return t=i?t+"capture":t,e=Cc(e)?e:null===(r=e)||void 0===r?void 0:r.handleEvent,this.emitter.off(t,e,o),this},e.emit=function(t,e){this.dispatchEvent(new xf(t,e))},e.dispatchEvent=function(t,e){if(void 0===e&&(e=!1),!(t instanceof yf))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");var n;if(this.document)n=this;else if(this.defaultView)n=this.defaultView;else{var r;n=null===(r=this.ownerDocument)||void 0===r?void 0:r.defaultView}if(n){var i;if(t.manager=n.getEventService()||null,!t.manager)return!1;t.defaultPrevented=!1,t.path=[],e||(t.target=this),null===(i=t.manager)||void 0===i||i.dispatchEvent(t,t.type,e)}return!t.defaultPrevented},t}(),_f=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))||this).shadow=!1,e.ownerDocument=null,e.isConnected=!1,e.baseURI="",e.childNodes=[],e.nodeType=0,e.nodeName="",e.nodeValue=null,e.parentNode=null,e}nl(e,t),e.isNode=function(t){return!!t.childNodes};var n=e.prototype;return n.getRootNode=function(t){return void 0===t&&(t={}),this.parentNode?this.parentNode.getRootNode(t):t.composed&&this.host?this.host.getRootNode(t):this},n.hasChildNodes=function(){return this.childNodes.length>0},n.isDefaultNamespace=function(t){throw new Error(Xc)},n.lookupNamespaceURI=function(t){throw new Error(Xc)},n.lookupPrefix=function(t){throw new Error(Xc)},n.normalize=function(){throw new Error(Xc)},n.isEqualNode=function(t){return this===t},n.isSameNode=function(t){return this.isEqualNode(t)},n.compareDocumentPosition=function(t){if(t===this)return 0;if(!(t instanceof e))throw new TypeError("Node.compareDocumentPosition: Argument 1 does not implement interface Node.");for(var n=t,r=this,i=[n],o=[r];null!==(a=n.parentNode)&&void 0!==a?a:r.parentNode;){var a;n=n.parentNode?(i.push(n.parentNode),n.parentNode):n,r=r.parentNode?(o.push(r.parentNode),r.parentNode):r}if(n!==r)return e.DOCUMENT_POSITION_DISCONNECTED|e.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC|e.DOCUMENT_POSITION_PRECEDING;var s=i.length>o.length?i:o,u=s===i?o:i;if(s[s.length-u.length]===u[0])return s===i?e.DOCUMENT_POSITION_CONTAINED_BY|e.DOCUMENT_POSITION_FOLLOWING:e.DOCUMENT_POSITION_CONTAINS|e.DOCUMENT_POSITION_PRECEDING;for(var c=s.length-u.length,l=u.length-1;l>=0;l--){var h=u[l],f=s[c+l];if(f!==h){var p=h.parentNode.childNodes;return p.indexOf(h)<p.indexOf(f)?u===i?e.DOCUMENT_POSITION_PRECEDING:e.DOCUMENT_POSITION_FOLLOWING:s===i?e.DOCUMENT_POSITION_PRECEDING:e.DOCUMENT_POSITION_FOLLOWING}}return e.DOCUMENT_POSITION_FOLLOWING},n.contain=function(t){return this.contains(t)},n.contains=function(t){for(var e=t;e&&this!==e;)e=e.parentNode;return!!e},n.getAncestor=function(t){for(var e=this;t>0&&e;)e=e.parentNode,t--;return e},n.forEach=function(t){t(this)||this.childNodes.forEach((function(e){e.forEach(t)}))},tl(e,[{key:"textContent",get:function(){var t="";this.nodeName===xc.TEXT&&(t+=this.style.text);for(var e,n=sl(this.childNodes);!(e=n()).done;){var r=e.value;r.nodeName===xc.TEXT?t+=r.nodeValue:t+=r.textContent}return t},set:function(t){var e=this;this.childNodes.slice().forEach((function(t){e.removeChild(t)})),this.nodeName===xc.TEXT&&(this.style.text=""+t)}},{key:"parent",get:function(){return this.parentNode}},{key:"parentElement",get:function(){return null}},{key:"nextSibling",get:function(){return null}},{key:"previousSibling",get:function(){return null}},{key:"firstChild",get:function(){return this.childNodes.length>0?this.childNodes[0]:null}},{key:"lastChild",get:function(){return this.childNodes.length>0?this.childNodes[this.childNodes.length-1]:null}}]),e}(bf);_f.DOCUMENT_POSITION_DISCONNECTED=1,_f.DOCUMENT_POSITION_PRECEDING=2,_f.DOCUMENT_POSITION_FOLLOWING=4,_f.DOCUMENT_POSITION_CONTAINS=8,_f.DOCUMENT_POSITION_CONTAINED_BY=16,_f.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC=32;var wf,Sf,Mf,Ef,Af=function(t){function e(){var e;(e=t.call(this)||this).defaultView=null,e.documentElement=void 0,e.timeline=void 0,e.ownerDocument=null,e.nodeName="document";try{e.timeline=new ym.AnimationTimeline(ol(e))}catch(r){}var n={};return Nd.forEach((function(t){var e=t.n,r=t.inh,i=t.d;r&&i&&(n[e]=Cc(i)?i(xc.GROUP):i)})),e.documentElement=new Kf({id:"g-root",style:n}),e.documentElement.ownerDocument=ol(e),e.documentElement.parentNode=ol(e),e.childNodes=[e.documentElement],e}nl(e,t);var n=e.prototype;return n.createElement=function(t,e){if("svg"===t)return this.documentElement;var n=this.defaultView.customElements.get(t);n||(n="tspan"===t?pp:Kf);var r=new n(e);return r.ownerDocument=this,r},n.createElementNS=function(t,e,n){return this.createElement(e,n)},n.cloneNode=function(t){throw new Error(Xc)},n.destroy=function(){try{[].concat(this.documentElement.childNodes).forEach((function(t,e){t.forEach((function(t){t.destroy()}))})),this.timeline.destroy()}catch(t){}},n.elementsFromBBox=function(t,e,n,r){var i=this.defaultView.context.rBushRoot.search({minX:t,minY:e,maxX:n,maxY:r}),o=[];return i.forEach((function(t){var e=t.id,n=ym.displayObjectPool.getByEntity(e),r=n.parsedStyle.pointerEvents,i=["auto","visiblepainted","visiblefill","visiblestroke","visible"].includes(r);(!i||i&&n.isVisible())&&!n.isCulled()&&n.isInteractive()&&o.push(n)})),o.sort((function(t,e){return e.sortable.renderOrder-t.sortable.renderOrder})),o},n.elementFromPointSync=function(t,e){var n=this.defaultView.canvas2Viewport({x:t,y:e}),r=n.x,i=n.y,o=this.defaultView.getConfig(),a=o.width,s=o.height;if(r<0||i<0||r>a||i>s)return null;var u=this.defaultView.viewport2Client({x:r,y:i}),c=u.x,l=u.y,h=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!0,position:{x:t,y:e,viewportX:r,viewportY:i,clientX:c,clientY:l},picked:[]}).picked;return h&&h[0]||this.documentElement},n.elementFromPoint=function(){var t=Jc($c().mark((function t(e,n){var r,i,o,a,s,u,c,l,h,f,p;return $c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=this.defaultView.canvas2Viewport({x:e,y:n}),i=r.x,o=r.y,a=this.defaultView.getConfig(),s=a.width,u=a.height,!(i<0||o<0||i>s||o>u)){t.next=4;break}return t.abrupt("return",null);case 4:return c=this.defaultView.viewport2Client({x:i,y:o}),l=c.x,h=c.y,t.next=7,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!0,position:{x:e,y:n,viewportX:i,viewportY:o,clientX:l,clientY:h},picked:[]});case 7:return f=t.sent,p=f.picked,t.abrupt("return",p&&p[0]||this.documentElement);case 10:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}(),n.elementsFromPointSync=function(t,e){var n=this.defaultView.canvas2Viewport({x:t,y:e}),r=n.x,i=n.y,o=this.defaultView.getConfig(),a=o.width,s=o.height;if(r<0||i<0||r>a||i>s)return[];var u=this.defaultView.viewport2Client({x:r,y:i}),c=u.x,l=u.y,h=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!1,position:{x:t,y:e,viewportX:r,viewportY:i,clientX:c,clientY:l},picked:[]}).picked;return h[h.length-1]!==this.documentElement&&h.push(this.documentElement),h},n.elementsFromPoint=function(){var t=Jc($c().mark((function t(e,n){var r,i,o,a,s,u,c,l,h,f,p;return $c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=this.defaultView.canvas2Viewport({x:e,y:n}),i=r.x,o=r.y,a=this.defaultView.getConfig(),s=a.width,u=a.height,!(i<0||o<0||i>s||o>u)){t.next=4;break}return t.abrupt("return",[]);case 4:return c=this.defaultView.viewport2Client({x:i,y:o}),l=c.x,h=c.y,t.next=7,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!1,position:{x:e,y:n,viewportX:i,viewportY:o,clientX:l,clientY:h},picked:[]});case 7:return f=t.sent,(p=f.picked)[p.length-1]!==this.documentElement&&p.push(this.documentElement),t.abrupt("return",p);case 11:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}(),n.appendChild=function(t,e){throw new Error(qc)},n.insertBefore=function(t,e){throw new Error(qc)},n.removeChild=function(t,e){throw new Error(qc)},n.replaceChild=function(t,e,n){throw new Error(qc)},n.append=function(){throw new Error(qc)},n.prepend=function(){throw new Error(qc)},n.getElementById=function(t){return this.documentElement.getElementById(t)},n.getElementsByName=function(t){return this.documentElement.getElementsByName(t)},n.getElementsByTagName=function(t){return this.documentElement.getElementsByTagName(t)},n.getElementsByClassName=function(t){return this.documentElement.getElementsByClassName(t)},n.querySelector=function(t){return this.documentElement.querySelector(t)},n.querySelectorAll=function(t){return this.documentElement.querySelectorAll(t)},n.find=function(t){return this.documentElement.find(t)},n.findAll=function(t){return this.documentElement.findAll(t)},tl(e,[{key:"children",get:function(){return this.childNodes}},{key:"childElementCount",get:function(){return this.childNodes.length}},{key:"firstElementChild",get:function(){return this.firstChild}},{key:"lastElementChild",get:function(){return this.lastChild}}]),e}(_f);(Sf=wf||(wf={}))[Sf.Standard=0]="Standard",(Ef=Mf||(Mf={})).DESTROY="destroy",Ef.ATTR_MODIFIED="DOMAttrModified",Ef.INSERTED="DOMNodeInserted",Ef.REMOVED="removed",Ef.MOUNTED="DOMNodeInsertedIntoDocument",Ef.UNMOUNTED="DOMNodeRemovedFromDocument",Ef.BOUNDS_CHANGED="bounds-changed",Ef.RENDER_ORDER_CHANGED="render-order-changed",Ef.CULLED="culled";var Tf=function(t){function e(e,n,r,i,o,a,s,u){var c;return(c=t.call(this,null)||this).relatedNode=void 0,c.prevValue=void 0,c.newValue=void 0,c.attrName=void 0,c.attrChange=void 0,c.prevParsedValue=void 0,c.newParsedValue=void 0,c.relatedNode=n,c.prevValue=r,c.newValue=i,c.attrName=o,c.attrChange=a,c.prevParsedValue=s,c.newParsedValue=u,c.type=e,c}return nl(e,t),e}(yf);Tf.ADDITION=2,Tf.MODIFICATION=1,Tf.REMOVAL=3;var Cf=0,Of=new Tf(Mf.INSERTED,null,"","","",0,"",""),kf=new Tf(Mf.REMOVED,null,"","","",0,"",""),Pf=new xf(Mf.DESTROY),Lf=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))||this).entity=Cf++,e.renderable={bounds:void 0,boundsDirty:!0,renderBounds:void 0,renderBoundsDirty:!0,dirtyRenderBounds:void 0,dirty:!1,proxyNodeName:void 0},e.cullable={strategy:wf.Standard,visibilityPlaneMask:-1,visible:!0,enable:!0},e.transformable={dirtyFlag:!1,localDirtyFlag:!1,frozen:!1,localPosition:Bo(0,0,0),localRotation:Aa(0,0,0,1),localScale:Bo(1,1,1),localTransform:no(),localSkew:Pa(0,0),position:Bo(0,0,0),rotation:Aa(0,0,0,1),scaling:Bo(1,1,1),worldTransform:no(),origin:Bo(0,0,0)},e.sortable={dirty:!1,sorted:void 0,lastSortedIndex:void 0,renderOrder:0},e.geometry={contentBounds:void 0,renderBounds:void 0},e.rBushNode={aabb:void 0},e.id=void 0,e.name=void 0,e.namespaceURI="g",e.scrollLeft=0,e.scrollTop=0,e.clientTop=0,e.clientLeft=0,e.destroyed=!1,e.style={},e.computedStyle={anchor:Xl,opacity:Xl,fillOpacity:Xl,strokeOpacity:Xl,fill:Xl,stroke:Xl,transform:Xl,transformOrigin:Xl,visibility:Xl,pointerEvents:Xl,lineWidth:Xl,lineCap:Xl,lineJoin:Xl,increasedLineWidthForHitTesting:Xl,fontSize:Xl,fontFamily:Xl,fontStyle:Xl,fontWeight:Xl,fontVariant:Xl,textAlign:Xl,textBaseline:Xl,textTransform:Xl,zIndex:Xl,filter:Xl,shadowType:Xl},e.parsedStyle={},e.attributes={},e}nl(e,t),e.isElement=function(t){return!!t.getAttribute};var n=e.prototype;return n.cloneNode=function(t){throw new Error(Xc)},n.appendChild=function(t,e){var n;if(t.destroyed)throw new Error("Cannot append a destroyed element.");return ym.sceneGraphService.attach(t,this,e),(null===(n=this.ownerDocument)||void 0===n?void 0:n.defaultView)&&this.ownerDocument.defaultView.mountChildren(t),Of.relatedNode=this,t.dispatchEvent(Of),t},n.insertBefore=function(t,e){if(e){var n=this.childNodes.indexOf(e);this.appendChild(t,n-1)}else this.appendChild(t);return t},n.replaceChild=function(t,e){var n=this.childNodes.indexOf(e);return this.removeChild(e),this.appendChild(t,n),e},n.removeChild=function(t){var e;return kf.relatedNode=this,t.dispatchEvent(kf),(null===(e=t.ownerDocument)||void 0===e?void 0:e.defaultView)&&t.ownerDocument.defaultView.unmountChildren(t),ym.sceneGraphService.detach(t),t},n.removeChildren=function(){var t=this;this.childNodes.slice().forEach((function(e){t.removeChild(e)}))},n.destroyChildren=function(){this.childNodes.slice().forEach((function(t){t.destroyChildren(),t.destroy()}))},n.matches=function(t){return ym.sceneGraphService.matches(t,this)},n.getElementById=function(t){return ym.sceneGraphService.querySelector("#"+t,this)},n.getElementsByName=function(t){return ym.sceneGraphService.querySelectorAll('[name="'+t+'"]',this)},n.getElementsByClassName=function(t){return ym.sceneGraphService.querySelectorAll("."+t,this)},n.getElementsByTagName=function(t){return ym.sceneGraphService.querySelectorAll(t,this)},n.querySelector=function(t){return ym.sceneGraphService.querySelector(t,this)},n.querySelectorAll=function(t){return ym.sceneGraphService.querySelectorAll(t,this)},n.closest=function(t){var e=this;do{if(ym.sceneGraphService.matches(t,e))return e;e=e.parentElement}while(null!==e);return null},n.find=function(t){var e=this,n=null;return this.forEach((function(r){return!(r===e||!t(r))&&(n=r,!0)})),n},n.findAll=function(t){var e=this,n=[];return this.forEach((function(r){r!==e&&t(r)&&n.push(r)})),n},n.after=function(){var t=this;if(this.parentNode){for(var e=this.parentNode.childNodes.indexOf(this),n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];r.forEach((function(n,r){var i;return null===(i=t.parentNode)||void 0===i?void 0:i.appendChild(n,e+r+1)}))}},n.before=function(){if(this.parentNode){for(var t=this.parentNode.childNodes.indexOf(this),e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=n[0],o=n.slice(1);this.parentNode.appendChild(i,t),i.after.apply(i,o)}},n.replaceWith=function(){this.after.apply(this,arguments),this.remove()},n.append=function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach((function(e){return t.appendChild(e)}))},n.prepend=function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach((function(e,n){return t.appendChild(e,n)}))},n.replaceChildren=function(){for(;this.childNodes.length&&this.firstChild;)this.removeChild(this.firstChild);this.append.apply(this,arguments)},n.remove=function(){return this.parentNode?this.parentNode.removeChild(this):this},n.destroy=function(){this.dispatchEvent(Pf),this.remove(),this.emitter.removeAllListeners(),this.destroyed=!0},n.getGeometryBounds=function(){return ym.sceneGraphService.getGeometryBounds(this)},n.getRenderBounds=function(){return ym.sceneGraphService.getBounds(this,!0)},n.getBounds=function(){return ym.sceneGraphService.getBounds(this)},n.getLocalBounds=function(){return ym.sceneGraphService.getLocalBounds(this)},n.getBoundingClientRect=function(){return ym.sceneGraphService.getBoundingClientRect(this)},n.getClientRects=function(){return[this.getBoundingClientRect()]},n.computedStyleMap=function(){return new Map(Object.entries(this.computedStyle))},n.getAttributeNames=function(){return Object.keys(this.attributes)},n.getAttribute=function(t){var e=this.attributes[t];if(void 0===e){var n=kc(t);return e=this.attributes[n],zs(e)?null:e}return e},n.hasAttribute=function(t){return this.getAttributeNames().includes(t)},n.hasAttributes=function(){return!!this.getAttributeNames().length},n.removeAttribute=function(t){this.setAttribute(t,null),delete this.attributes[t]},n.setAttribute=function(t,e,n){this.attributes[t]=e},n.getAttributeNS=function(t,e){throw new Error(Xc)},n.getAttributeNode=function(t){throw new Error(Xc)},n.getAttributeNodeNS=function(t,e){throw new Error(Xc)},n.hasAttributeNS=function(t,e){throw new Error(Xc)},n.removeAttributeNS=function(t,e){throw new Error(Xc)},n.removeAttributeNode=function(t){throw new Error(Xc)},n.setAttributeNS=function(t,e,n){throw new Error(Xc)},n.setAttributeNode=function(t){throw new Error(Xc)},n.setAttributeNodeNS=function(t){throw new Error(Xc)},n.toggleAttribute=function(t,e){throw new Error(Xc)},tl(e,[{key:"className",get:function(){return this.getAttribute("class")||""},set:function(t){this.setAttribute("class",t)}},{key:"classList",get:function(){return this.className.split(" ").filter((function(t){return""!==t}))}},{key:"tagName",get:function(){return this.nodeName}},{key:"children",get:function(){return this.childNodes}},{key:"childElementCount",get:function(){return this.childNodes.length}},{key:"firstElementChild",get:function(){return this.firstChild}},{key:"lastElementChild",get:function(){return this.lastChild}},{key:"parentElement",get:function(){return this.parentNode}},{key:"nextSibling",get:function(){if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t+1]||null}return null}},{key:"previousSibling",get:function(){if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t-1]||null}return null}}]),e}(_f),Rf=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))||this).altKey=void 0,e.button=void 0,e.buttons=void 0,e.ctrlKey=void 0,e.metaKey=void 0,e.relatedTarget=void 0,e.shiftKey=void 0,e.client=new wc,e.movement=new wc,e.offset=new wc,e.global=new wc,e.screen=new wc,e}nl(e,t);var n=e.prototype;return n.getModifierState=function(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)},n.initMouseEvent=function(){throw new Error(Xc)},tl(e,[{key:"clientX",get:function(){return this.client.x}},{key:"clientY",get:function(){return this.client.y}},{key:"movementX",get:function(){return this.movement.x}},{key:"movementY",get:function(){return this.movement.y}},{key:"offsetX",get:function(){return this.offset.x}},{key:"offsetY",get:function(){return this.offset.y}},{key:"globalX",get:function(){return this.global.x}},{key:"globalY",get:function(){return this.global.y}},{key:"screenX",get:function(){return this.screen.x}},{key:"screenY",get:function(){return this.screen.y}}]),e}(yf),If=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))||this).pointerId=void 0,e.width=0,e.height=0,e.isPrimary=!1,e.pointerType=void 0,e.pressure=void 0,e.tangentialPressure=void 0,e.tiltX=void 0,e.tiltY=void 0,e.twist=void 0,e}nl(e,t);var n=e.prototype;return n.getCoalescedEvents=function(){return"pointermove"===this.type||"mousemove"===this.type||"touchmove"===this.type?[this]:[]},n.getPredictedEvents=function(){throw new Error("getPredictedEvents is not supported!")},n.clone=function(){return this.manager.clonePointerEvent(this)},e}(Rf),Nf=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))||this).deltaMode=void 0,e.deltaX=void 0,e.deltaY=void 0,e.deltaZ=void 0,e.DOM_DELTA_LINE=0,e.DOM_DELTA_PAGE=1,e.DOM_DELTA_PIXEL=2,e}return nl(e,t),e.prototype.clone=function(){return this.manager.cloneWheelEvent(this)},e}(Rf),Df=new Tf(Mf.ATTR_MODIFIED,null,null,null,null,Tf.MODIFICATION,null,null),Ff={anchor:"",opacity:"",fillOpacity:"",strokeOpacity:"",fill:"",stroke:"",transform:"",transformOrigin:"",visibility:"",pointerEvents:"",lineWidth:"",lineCap:"",lineJoin:"",increasedLineWidthForHitTesting:"",fontSize:"",fontFamily:"",fontStyle:"",fontWeight:"",fontVariant:"",textAlign:"",textBaseline:"",textTransform:"",zIndex:"",filter:"",shadowType:""},jf={anchor:[0,0],fill:Jl,stroke:Jl,transform:[],zIndex:0,filter:[],shadowType:"outer"},Bf=[].concat(["opacity","fillOpacity","strokeOpacity","transformOrigin","visibility","pointerEvents","lineWidth","lineCap","lineJoin","increasedLineWidthForHitTesting"],["fontSize","fontFamily","fontStyle","fontWeight","fontVariant","textAlign","textBaseline","textTransform"]),zf=function(t){function e(e){var n,r;return(r=t.call(this)||this).config=void 0,r.isCustomElement=!1,r.isMutationObserved=!1,r.activeAnimations=[],r.getClip=function(){return this.style.clipPath||null},r.config=e,r.config.interactive=null!==(n=r.config.capture)&&void 0!==n?n:r.config.interactive,r.id=r.config.id||"",r.name=r.config.name||"",(r.config.className||r.config.class)&&(r.className=r.config.className||r.config.class),r.nodeName=r.config.type||xc.GROUP,r.config.style=el({},r.config.style,r.config.attrs),null!=r.config.visible&&(r.config.style.visibility=!1===r.config.visible?"hidden":"visible"),null!=r.config.interactive&&(r.config.style.pointerEvents=!1===r.config.interactive?"none":"auto"),Object.assign(r.parsedStyle,jf,r.config.initialParsedStyle),Object.assign(r.attributes,Ff),r.initAttributes(r.config.style),r.style=new Proxy({setProperty:function(t,e){r.setAttribute(t,e)},getPropertyValue:function(t){return r.getAttribute(t)},removeProperty:function(t){r.removeAttribute(t)},item:function(){return""}},{get:function(t,e){return void 0!==t[e]?t[e]:r.getAttribute(e)},set:function(t,e,n){return r.setAttribute(e,n),!0}}),ym.displayObjectPool.add(r.entity,ol(r)),r}nl(e,t);var n=e.prototype;return n.destroy=function(){t.prototype.destroy.call(this),ym.displayObjectPool.remove(this.entity),this.getAnimations().forEach((function(t){t.cancel()}))},n.cloneNode=function(t,n){var r=el({},this.attributes);for(var i in r){var o=r[i];o instanceof e&&"clipPath"!==i&&"offsetPath"!==i&&"textPath"!==i&&(r[i]=o.cloneNode(t)),n&&(r[i]=n(i,o))}var a=new this.constructor({id:this.id,name:this.name,className:this.name,interactive:this.interactive,style:r});return a.setLocalTransform(this.getLocalTransform()),t&&this.children.forEach((function(e){if(!e.style.isMarker){var n=e.cloneNode(t);a.appendChild(n)}})),a},n.initAttributes=function(t){void 0===t&&(t={});var e=this.renderable;ym.styleValueRegistry.processProperties(this,t,{forceUpdateGeometry:!0,usedAttributes:Bf}),e.dirty=!0},n.setAttribute=function(e,n,r){void 0===r&&(r=!1);var i=kc(e);ou(n)||(r||n!==this.attributes[i])&&(this.internalSetAttribute(i,n),t.prototype.setAttribute.call(this,i,n))},n.internalSetAttribute=function(t,e,n){var r;void 0===n&&(n={});var i=this.renderable,o=this.attributes[t],a=this.parsedStyle[t];ym.styleValueRegistry.processProperties(this,((r={})[t]=e,r),n),i.dirty=!0;var s=this.parsedStyle[t];this.isConnected&&(Df.relatedNode=this,Df.prevValue=o,Df.newValue=e,Df.attrName=t,Df.prevParsedValue=a,Df.newParsedValue=s,this.isMutationObserved?this.dispatchEvent(Df):(Df.target=this,this.ownerDocument.defaultView.dispatchEvent(Df,!0))),(this.isCustomElement&&this.isConnected||!this.isCustomElement)&&this.attributeChangedCallback&&this.attributeChangedCallback(t,o,e,a,s)},n.getBBox=function(){var t=this.getBounds(),e=t.getMin(),n=e[0],r=e[1],i=t.getMax(),o=i[0],a=i[1];return new Sc(n,r,o-n,a-r)},n.setOrigin=function(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=0),ym.sceneGraphService.setOrigin(this,mp(t,e,n)),this},n.getOrigin=function(){return ym.sceneGraphService.getOrigin(this)},n.setPosition=function(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=0),ym.sceneGraphService.setPosition(this,mp(t,e,n)),this},n.setLocalPosition=function(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=0),ym.sceneGraphService.setLocalPosition(this,mp(t,e,n)),this},n.translate=function(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=0),ym.sceneGraphService.translate(this,mp(t,e,n)),this},n.translateLocal=function(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=0),ym.sceneGraphService.translateLocal(this,mp(t,e,n)),this},n.getPosition=function(){return ym.sceneGraphService.getPosition(this)},n.getLocalPosition=function(){return ym.sceneGraphService.getLocalPosition(this)},n.scale=function(t,e,n){return this.scaleLocal(t,e,n)},n.scaleLocal=function(t,e,n){return"number"==typeof t&&(t=mp(t,e=e||t,n=n||t)),ym.sceneGraphService.scaleLocal(this,t),this},n.setLocalScale=function(t,e,n){return"number"==typeof t&&(t=mp(t,e=e||t,n=n||t)),ym.sceneGraphService.setLocalScale(this,t),this},n.getLocalScale=function(){return ym.sceneGraphService.getLocalScale(this)},n.getScale=function(){return ym.sceneGraphService.getScale(this)},n.getEulerAngles=function(){return gp(yp(Do(),ym.sceneGraphService.getWorldTransform(this))[2])},n.getLocalEulerAngles=function(){return gp(yp(Do(),ym.sceneGraphService.getLocalRotation(this))[2])},n.setEulerAngles=function(t){return ym.sceneGraphService.setEulerAngles(this,0,0,t),this},n.setLocalEulerAngles=function(t){return ym.sceneGraphService.setLocalEulerAngles(this,0,0,t),this},n.rotateLocal=function(t,e,n){return zs(e)&&zs(n)?ym.sceneGraphService.rotateLocal(this,0,0,t):ym.sceneGraphService.rotateLocal(this,t,e,n),this},n.rotate=function(t,e,n){return zs(e)&&zs(n)?ym.sceneGraphService.rotate(this,0,0,t):ym.sceneGraphService.rotate(this,t,e,n),this},n.setRotation=function(t,e,n,r){return ym.sceneGraphService.setRotation(this,t,e,n,r),this},n.setLocalRotation=function(t,e,n,r){return ym.sceneGraphService.setLocalRotation(this,t,e,n,r),this},n.setLocalSkew=function(t,e){return ym.sceneGraphService.setLocalSkew(this,t,e),this},n.getRotation=function(){return ym.sceneGraphService.getRotation(this)},n.getLocalRotation=function(){return ym.sceneGraphService.getLocalRotation(this)},n.getLocalSkew=function(){return ym.sceneGraphService.getLocalSkew(this)},n.getLocalTransform=function(){return ym.sceneGraphService.getLocalTransform(this)},n.getWorldTransform=function(){return ym.sceneGraphService.getWorldTransform(this)},n.setLocalTransform=function(t){return ym.sceneGraphService.setLocalTransform(this,t),this},n.resetLocalTransform=function(){ym.sceneGraphService.resetLocalTransform(this)},n.getAnimations=function(){return this.activeAnimations},n.animate=function(t,e){var n,r=null===(n=this.ownerDocument)||void 0===n?void 0:n.timeline;return r?r.play(this,t,e):null},n.isVisible=function(){var t;return"visible"===(null===(t=this.parsedStyle)||void 0===t?void 0:t.visibility)},n.isInteractive=function(){var t;return"none"!==(null===(t=this.parsedStyle)||void 0===t?void 0:t.pointerEvents)},n.isCulled=function(){return!(!this.cullable||!this.cullable.enable||this.cullable.visible)},n.toFront=function(){return this.parentNode&&(this.style.zIndex=Math.max.apply(Math,this.parentNode.children.map((function(t){return Number(t.style.zIndex)})))+1),this},n.toBack=function(){return this.parentNode&&(this.style.zIndex=Math.min.apply(Math,this.parentNode.children.map((function(t){return Number(t.style.zIndex)})))-1),this},n.getConfig=function(){return this.config},n.attr=function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=n[0],o=n[1];return i?Ws(i)?(Object.keys(i).forEach((function(e){t.setAttribute(e,i[e])})),this):2===n.length?(this.setAttribute(i,o),this):this.attributes[i]:this.attributes},n.getMatrix=function(t){var e=t||this.getWorldTransform(),n=_o(Do(),e),r=n[0],i=n[1],o=wo(Do(),e),a=o[0],s=o[1],u=So(_a(),e),c=yp(Do(),u),l=c[0],h=c[2];return function(t,e,n,r,i){var o=Math.cos(t),a=Math.sin(t);return s=r*o,u=i*a,c=0,l=-r*a,h=i*o,f=0,p=e,d=n,m=1,v=new Ji(9),v[0]=s,v[1]=u,v[2]=c,v[3]=l,v[4]=h,v[5]=f,v[6]=p,v[7]=d,v[8]=m,v;var s,u,c,l,h,f,p,d,m,v}(l||h,r,i,a,s)},n.getLocalMatrix=function(){return this.getMatrix(this.getLocalTransform())},n.setMatrix=function(t){var e=xp(t),n=e[0],r=e[1],i=e[2],o=e[3],a=e[4];this.setEulerAngles(a).setPosition(n,r).setLocalScale(i,o)},n.setLocalMatrix=function(t){var e=xp(t),n=e[0],r=e[1],i=e[2],o=e[3],a=e[4];this.setLocalEulerAngles(a).setLocalPosition(n,r).setLocalScale(i,o)},n.show=function(){this.style.visibility="visible"},n.hide=function(){this.style.visibility="hidden"},n.getCount=function(){return this.childElementCount},n.getParent=function(){return this.parentElement},n.getChildren=function(){return this.children},n.getFirst=function(){return this.firstElementChild},n.getLast=function(){return this.lastElementChild},n.getChildByIndex=function(t){return this.children[t]||null},n.add=function(t,e){return this.appendChild(t,e)},n.setClip=function(t){this.style.clipPath=t},n.set=function(t,e){this.config[t]=e},n.get=function(t){return this.config[t]},n.moveTo=function(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=0),this.setPosition(t,e,n),this},n.move=function(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=0),this.setPosition(t,e,n),this},n.setZIndex=function(t){return this.style.zIndex=t,this},tl(e,[{key:"interactive",get:function(){return this.isInteractive()},set:function(t){this.style.pointerEvents=t?"auto":"none"}}]),e}(Lf),Uf=["style"],Vf=function(t){function e(e){var n=void 0===e?{}:e,r=n.style,i=il(n,Uf);return t.call(this,el({type:xc.CIRCLE,style:el({cx:"",cy:"",r:""},r),initialParsedStyle:{anchor:[.5,.5]}},i))||this}return nl(e,t),e}(zf),Gf=["style"],Wf=function(t){function e(e){var n,r=void 0===e?{}:e,i=r.style,o=il(r,Gf);return(n=t.call(this,el({style:el({x:"",y:""},i)},o))||this).isCustomElement=!0,n}return nl(e,t),e}(zf),Hf={},Yf=[],Xf=function(){function t(){}var e=t.prototype;return e.getByEntity=function(t){return Hf[t]},e.getAll=function(){return Object.keys(Hf).map((function(t){return Hf[t]}))},e.add=function(t,e){Hf[t]=e,e.nodeName===xc.HTML&&Yf.push(e)},e.remove=function(t){var e=Hf[t];if(e&&(delete Hf[t],e.nodeName===xc.HTML)){var n=Yf.indexOf(e);Yf.splice(n,1)}},e.getHTMLs=function(){return Yf},t}(),qf=["style"],Zf=function(t){function e(e){var n=void 0===e?{}:e,r=n.style,i=il(n,qf);return t.call(this,el({type:xc.ELLIPSE,style:el({cx:"",cy:"",rx:"",ry:""},r),initialParsedStyle:{anchor:[.5,.5]}},i))||this}return nl(e,t),e}(zf),$f=["style"],Kf=function(t){function e(e){var n=void 0===e?{}:e,r=n.style,i=il(n,$f);return t.call(this,el({type:xc.GROUP,style:el({x:"",y:"",width:"",height:""},r)},i))||this}return nl(e,t),e}(zf),Jf=["style"],Qf=function(t){function e(e){var n,r=void 0===e?{}:e,i=r.style,o=il(r,Jf);return(n=t.call(this,el({type:xc.HTML,style:el({x:"",y:"",width:"auto",height:"auto",innerHTML:""},i)},o))||this).cullable.enable=!1,n}nl(e,t);var n=e.prototype;return n.getDomElement=function(){return this.parsedStyle.$el},n.getBoundingClientRect=function(){return this.parsedStyle.$el.getBoundingClientRect()},n.getClientRects=function(){return[this.getBoundingClientRect()]},n.getBounds=function(){var t,e,n=this.getBoundingClientRect(),r=null===(t=this.ownerDocument)||void 0===t||null===(e=t.defaultView)||void 0===e?void 0:e.getContextService().getBoundingClientRect();if(r){var i=n.left-r.left,o=n.top-r.top,a=new gc;return a.setMinMax(Bo(i,o,0),Bo(i+n.width,o+n.height,0)),a}return null},n.getLocalBounds=function(){if(this.parentNode){var t=co(no(),this.parentNode.getWorldTransform()),e=this.getBounds();if(!gc.isEmpty(e)){var n=new gc;return n.setFromTransformedAABB(e,t),n}}return this.getBounds()},e}(zf),tp=["style"],ep=function(t){function e(e){var n=void 0===e?{}:e,r=n.style,i=il(n,tp);return t.call(this,el({type:xc.IMAGE,style:el({x:"",y:"",img:"",width:"",height:""},r)},i))||this}return nl(e,t),e}(zf),np=["style"],rp=function(t){function e(e){var n,r=void 0===e?{}:e,i=r.style,o=il(r,np);(n=t.call(this,el({type:xc.LINE,style:el({x1:0,y1:0,x2:0,y2:0,z1:0,z2:0,isBillboard:!1},i)},o))||this).markerStartAngle=0,n.markerEndAngle=0;var a=n.parsedStyle,s=a.markerStart,u=a.markerEnd;return s&&s instanceof zf&&(n.markerStartAngle=s.getLocalEulerAngles(),n.appendChild(s)),u&&u instanceof zf&&(n.markerEndAngle=u.getLocalEulerAngles(),n.appendChild(u)),n.transformMarker(!0),n.transformMarker(!1),n}nl(e,t);var n=e.prototype;return n.attributeChangedCallback=function(t,e,n,r,i){"x1"===t||"y1"===t||"x2"===t||"y2"===t||"markerStartOffset"===t||"markerEndOffset"===t?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===t?(r&&r instanceof zf&&(this.markerStartAngle=0,r.remove()),i&&i instanceof zf&&(this.markerStartAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!0))):"markerEnd"===t&&(r&&r instanceof zf&&(this.markerEndAngle=0,r.remove()),i&&i instanceof zf&&(this.markerEndAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!1)))},n.transformMarker=function(t){var e=this.parsedStyle,n=e.markerStart,r=e.markerEnd,i=e.markerStartOffset,o=e.markerEndOffset,a=e.x1,s=e.x2,u=e.y1,c=e.y2,l=e.defX,h=e.defY,f=t?n:r;if(f&&f instanceof zf){var p,d,m,v,g,y,x;t?(v=a-l,g=u-h,d=s-a,m=c-u,y=i||0,x=this.markerStartAngle):(v=s-l,g=c-h,d=a-s,m=u-c,y=o||0,x=this.markerEndAngle),p=Math.atan2(m,d),f.setLocalEulerAngles(180*p/Math.PI+x),f.setLocalPosition(v+Math.cos(p)*y,g+Math.sin(p)*y)}},n.getPoint=function(t,e){void 0===e&&(e=!1);var n=this.parsedStyle,r=n.x1,i=n.y1,o=n.x2,a=n.y2,s=n.defX,u=n.defY,c=tc.pointAt(r,i,o,a,t),l=c.x,h=c.y,f=ra(Do(),Bo(l-s,h-u,0),e?this.getWorldTransform():this.getLocalTransform());return new wc(f[0],f[1])},n.getPointAtLength=function(t,e){return void 0===e&&(e=!1),this.getPoint(t/this.getTotalLength(),e)},n.getTotalLength=function(){var t=this.parsedStyle,e=t.x1,n=t.y1,r=t.x2,i=t.y2;return tc.length(e,n,r,i)},e}(zf),ip=["style"],op=function(t){function e(e){var n,r=void 0===e?{}:e,i=r.style,o=il(r,ip);(n=t.call(this,el({type:xc.PATH,style:el({path:"",miterLimit:""},i)},o))||this).markerStartAngle=0,n.markerEndAngle=0,n.markerMidList=[];var a=n.parsedStyle,s=a.markerStart,u=a.markerEnd,c=a.markerMid;return s&&s instanceof zf&&(n.markerStartAngle=s.getLocalEulerAngles(),n.appendChild(s)),c&&c instanceof zf&&n.placeMarkerMid(c),u&&u instanceof zf&&(n.markerEndAngle=u.getLocalEulerAngles(),n.appendChild(u)),n.transformMarker(!0),n.transformMarker(!1),n}nl(e,t);var n=e.prototype;return n.attributeChangedCallback=function(t,e,n,r,i){"path"===t?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):"markerStartOffset"===t||"markerEndOffset"===t?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===t?(r&&r instanceof zf&&(this.markerStartAngle=0,r.remove()),i&&i instanceof zf&&(this.markerStartAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!0))):"markerEnd"===t?(r&&r instanceof zf&&(this.markerEndAngle=0,r.remove()),i&&i instanceof zf&&(this.markerEndAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!1))):"markerMid"===t&&this.placeMarkerMid(i)},n.transformMarker=function(t){var e=this.parsedStyle,n=e.markerStart,r=e.markerEnd,i=e.markerStartOffset,o=e.markerEndOffset,a=e.defX,s=e.defY,u=t?n:r;if(u&&u instanceof zf){var c,l,h,f,p,d,m;if(t){var v=this.getStartTangent(),g=v[0],y=v[1];f=y[0]-a,p=y[1]-s,l=g[0]-y[0],h=g[1]-y[1],d=i||0,m=this.markerStartAngle}else{var x=this.getEndTangent(),b=x[0],_=x[1];f=_[0]-a,p=_[1]-s,l=b[0]-_[0],h=b[1]-_[1],d=o||0,m=this.markerEndAngle}c=Math.atan2(h,l),u.setLocalEulerAngles(180*c/Math.PI+m),u.setLocalPosition(f+Math.cos(c)*d,p+Math.sin(c)*d)}},n.placeMarkerMid=function(t){var e=this.parsedStyle,n=e.path.segments,r=e.defX,i=e.defY;if(this.markerMidList.forEach((function(t){t.remove()})),t&&t instanceof zf)for(var o=1;o<n.length-1;o++){var a=n[o].currentPoint,s=a[0],u=a[1],c=1===o?t:t.cloneNode(!0);this.markerMidList.push(c),this.appendChild(c),c.setLocalPosition(s-r,u-i)}},n.getTotalLength=function(){return kp(this)},n.getPointAtLength=function(t,e){void 0===e&&(e=!1);var n=this.parsedStyle,r=n.defX,i=n.defY,o=function(t,e,n){return Is(t,e,Za(Za({},n),{bbox:!1,length:!0})).point}(n.path.absolutePath,t),a=o.x,s=o.y,u=ra(Do(),Bo(a-r,s-i,0),e?this.getWorldTransform():this.getLocalTransform());return new wc(u[0],u[1])},n.getPoint=function(t,e){return void 0===e&&(e=!1),this.getPointAtLength(t*kp(this),e)},n.getStartTangent=function(){var t=this.parsedStyle.path.segments,e=[];if(t.length>1){var n=t[0].currentPoint,r=t[1].currentPoint,i=t[1].startTangent;e=[],i?(e.push([n[0]-i[0],n[1]-i[1]]),e.push([n[0],n[1]])):(e.push([r[0],r[1]]),e.push([n[0],n[1]]))}return e},n.getEndTangent=function(){var t=this.parsedStyle.path.segments,e=t.length,n=[];if(e>1){var r=t[e-2].currentPoint,i=t[e-1].currentPoint,o=t[e-1].endTangent;n=[],o?(n.push([i[0]-o[0],i[1]-o[1]]),n.push([i[0],i[1]])):(n.push([r[0],r[1]]),n.push([i[0],i[1]]))}return n},e}(zf),ap=["style"],sp=function(t){function e(e){var n,r=void 0===e?{}:e,i=r.style,o=il(r,ap);(n=t.call(this,el({type:xc.POLYGON,style:el({points:"",miterLimit:"",isClosed:!0},i)},o))||this).markerStartAngle=0,n.markerEndAngle=0,n.markerMidList=[];var a=n.parsedStyle,s=a.markerStart,u=a.markerEnd,c=a.markerMid;return s&&s instanceof zf&&(n.markerStartAngle=s.getLocalEulerAngles(),n.appendChild(s)),c&&c instanceof zf&&n.placeMarkerMid(c),u&&u instanceof zf&&(n.markerEndAngle=u.getLocalEulerAngles(),n.appendChild(u)),n.transformMarker(!0),n.transformMarker(!1),n}nl(e,t);var n=e.prototype;return n.attributeChangedCallback=function(t,e,n,r,i){"points"===t?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):"markerStartOffset"===t||"markerEndOffset"===t?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===t?(r&&r instanceof zf&&(this.markerStartAngle=0,r.remove()),i&&i instanceof zf&&(this.markerStartAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!0))):"markerEnd"===t?(r&&r instanceof zf&&(this.markerEndAngle=0,r.remove()),i&&i instanceof zf&&(this.markerEndAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!1))):"markerMid"===t&&this.placeMarkerMid(i)},n.transformMarker=function(t){var e=this.parsedStyle,n=e.markerStart,r=e.markerEnd,i=e.markerStartOffset,o=e.markerEndOffset,a=e.points.points,s=e.defX,u=e.defY,c=t?n:r;if(c&&c instanceof zf){var l,h,f,p,d,m,v;if(p=a[0][0]-s,d=a[0][1]-u,t)h=a[1][0]-a[0][0],f=a[1][1]-a[0][1],m=i||0,v=this.markerStartAngle;else{var g=a.length;this.style.isClosed?(h=a[g-1][0]-a[0][0],f=a[g-1][1]-a[0][1]):(p=a[g-1][0]-s,d=a[g-1][1]-u,h=a[g-2][0]-a[g-1][0],f=a[g-2][1]-a[g-1][1]),m=o||0,v=this.markerEndAngle}l=Math.atan2(f,h),c.setLocalEulerAngles(180*l/Math.PI+v),c.setLocalPosition(p+Math.cos(l)*m,d+Math.sin(l)*m)}},n.placeMarkerMid=function(t){var e=this.parsedStyle,n=e.points.points,r=e.defX,i=e.defY;if(this.markerMidList.forEach((function(t){t.remove()})),this.markerMidList=[],t&&t instanceof zf)for(var o=1;o<(this.style.isClosed?n.length:n.length-1);o++){var a=n[o][0]-r,s=n[o][1]-i,u=1===o?t:t.cloneNode(!0);this.markerMidList.push(u),this.appendChild(u),u.setLocalPosition(a,s)}},e}(zf),up=["style"],cp=function(t){function e(e){var n=void 0===e?{}:e,r=n.style,i=il(n,up);return t.call(this,el({type:xc.POLYLINE,style:el({points:"",miterLimit:"",isClosed:!1},r)},i))||this}nl(e,t);var n=e.prototype;return n.getTotalLength=function(){return this.parsedStyle.points.totalLength},n.getPointAtLength=function(t,e){return void 0===e&&(e=!1),this.getPoint(t/this.getTotalLength(),e)},n.getPoint=function(t,e){void 0===e&&(e=!1);var n=this.parsedStyle,r=n.defX,i=n.defY,o=n.points,a=o.points,s=o.segments,u=0,c=0;s.forEach((function(e,n){t>=e[0]&&t<=e[1]&&(u=(t-e[0])/(e[1]-e[0]),c=n)}));var l=tc.pointAt(a[c][0],a[c][1],a[c+1][0],a[c+1][1],u),h=l.x,f=l.y,p=ra(Do(),Bo(h-r,f-i,0),e?this.getWorldTransform():this.getLocalTransform());return new wc(p[0],p[1])},n.getStartTangent=function(){var t=this.parsedStyle.points.points,e=[];return e.push([t[1][0],t[1][1]]),e.push([t[0][0],t[0][1]]),e},n.getEndTangent=function(){var t=this.parsedStyle.points.points,e=t.length-1,n=[];return n.push([t[e-1][0],t[e-1][1]]),n.push([t[e][0],t[e][1]]),n},e}(sp),lp=["style"],hp=function(t){function e(e){var n=void 0===e?{}:e,r=n.style,i=il(n,lp);return t.call(this,el({type:xc.RECT,style:el({x:"",y:"",width:"",height:"",radius:""},r)},i))||this}return nl(e,t),e}(zf),fp=["style"],pp=function(t){function e(e){var n=void 0===e?{}:e,r=n.style,i=il(n,fp);return t.call(this,el({type:xc.TEXT,style:el({x:"",y:"",text:"",fontSize:"",fontFamily:"",fontStyle:"",fontWeight:"",fontVariant:"",textAlign:"",textBaseline:"",textTransform:"",fill:"black",letterSpacing:"",lineHeight:"",miterLimit:"",wordWrap:!1,wordWrapWidth:0,leading:0,dx:"",dy:""},r)},i))||this}nl(e,t);var n=e.prototype;return n.getComputedTextLength=function(){var t;return(null===(t=this.parsedStyle.metrics)||void 0===t?void 0:t.maxLineWidth)||0},n.getLineBoundingRects=function(){var t;return(null===(t=this.parsedStyle.metrics)||void 0===t?void 0:t.lineMetrics)||[]},n.isOverflowing=function(){return!!this.parsedStyle.isOverflowing},e}(zf);function dp(t){return void 0===t?0:t>360||t<-360?t%360:t}function mp(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=0),Js(t)?Bo(t,e,n):Array.isArray(t)&&3===t.length?Fo(t):Bo(t[0],t[1]||e,t[2]||n)}function vp(t){return t*(Math.PI/180)}function gp(t){return t*(180/Math.PI)}function yp(t,e){return 16===e.length?function(t,e){var n,r,i=.5*Math.PI,o=wo(Do(),e),a=o[0],s=o[1],u=o[2],c=Math.asin(-e[2]/a);return c<i?c>-i?(n=Math.atan2(e[6]/s,e[10]/u),r=Math.atan2(e[1]/a,e[0]/a)):(r=0,n=-Math.atan2(e[4]/s,e[5]/s)):(r=0,n=Math.atan2(e[4]/s,e[5]/s)),t[0]=n,t[1]=c,t[2]=r,t}(t,e):function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=r*r,s=i*i,u=o*o,c=n*n+a+s+u,l=n*o-r*i;return l>.499995*c?(t[0]=Math.PI/2,t[1]=2*Math.atan2(r,n),t[2]=0):l<-.499995*c?(t[0]=-Math.PI/2,t[1]=2*Math.atan2(r,n),t[2]=0):(t[0]=Math.asin(2*(n*i-o*r)),t[1]=Math.atan2(2*(n*o+r*i),1-2*(s+u)),t[2]=Math.atan2(2*(n*r+i*o),1-2*(a+s))),t}(t,e)}function xp(t){var e=t[0],n=t[1],r=t[3],i=t[4],o=Math.sqrt(e*e+n*n),a=Math.sqrt(r*r+i*i);e*i-n*r<0&&(e<i?o=-o:a=-a),o&&(e*=1/o,n*=1/o),a&&(r*=1/a,i*=1/a);var s=gp(Math.atan2(n,e));return[t[6],t[7],o,a,s]}var bp=no(),_p=no(),wp=ya(),Sp=[Do(),Do(),Do()],Mp=Do();function Ep(t,e,n,r,i){t[0]=e[0]*r+n[0]*i,t[1]=e[1]*r+n[1]*i,t[2]=e[2]*r+n[2]*i}var Ap=no();function Tp(t,e){if(t&&t.length){var n=0,r=0;e?(n=e.parsedStyle.defX||0,r=e.parsedStyle.defY||0,e.resetLocalTransform(),e.setLocalPosition(n,r)):e=new zf({}),t.forEach((function(t){var i=t.t,o=t.d;if("scale"===i){var a=(null==o?void 0:o.map((function(t){return t.value})))||[1,1];e.scaleLocal(a[0],a[1],1)}else if("scalex"===i){var s=(null==o?void 0:o.map((function(t){return t.value})))||[1];e.scaleLocal(s[0],1,1)}else if("scaley"===i){var u=(null==o?void 0:o.map((function(t){return t.value})))||[1];e.scaleLocal(1,u[0],1)}else if("scalez"===i){var c=(null==o?void 0:o.map((function(t){return t.value})))||[1];e.scaleLocal(1,1,c[0])}else if("scale3d"===i){var l=(null==o?void 0:o.map((function(t){return t.value})))||[1,1,1];e.scaleLocal(l[0],l[1],l[2])}else if("translate"===i){var h=o||[Gl,Gl];e.translateLocal(h[0].value,h[1].value,0)}else if("translatex"===i){var f=o||[Gl];e.translateLocal(f[0].value,0,0)}else if("translatey"===i){var p=o||[Gl];e.translateLocal(0,p[0].value,0)}else if("translatez"===i){var d=o||[Gl];e.translateLocal(0,0,d[0].value)}else if("translate3d"===i){var m=o||[Gl,Gl,Gl];e.translateLocal(m[0].value,m[1].value,m[2].value)}else if("rotate"===i){var v=o||[Wl];e.rotateLocal(0,0,v[0].value)}else if("rotatex"===i){var g=o||[Wl];e.rotateLocal(g[0].value,0,0)}else if("rotatey"===i){var y=o||[Wl];e.rotateLocal(0,y[0].value,0)}else if("rotatez"===i){var x=o||[Wl];e.rotateLocal(0,0,x[0].value)}else if("rotate3d"===i);else if("skew"===i){var b=(null==o?void 0:o.map((function(t){return t.value})))||[0,0];e.setLocalSkew(vp(b[0]),vp(b[1]))}else if("skewx"===i){var _=(null==o?void 0:o.map((function(t){return t.value})))||[0];e.setLocalSkew(vp(_[0]),e.getLocalSkew()[1])}else if("skewy"===i){var w=(null==o?void 0:o.map((function(t){return t.value})))||[0];e.setLocalSkew(e.getLocalSkew()[0],vp(w[0]))}else if("matrix"===i){var S=o.map((function(t){return t.value})),M=S[0],E=S[1],A=S[2],T=S[3],C=S[4],O=S[5];e.setLocalTransform(ao(Ap,M,E,0,0,A,T,0,0,0,0,1,0,C+n,O+r,0,1))}else"matrix3d"===i&&(ao.apply(No,[Ap].concat(o.map((function(t){return t.value})))),Ap[12]+=n,Ap[13]+=r,e.setLocalTransform(Ap))}))}return e.getLocalTransform()}function Cp(t){var e=t.type,n=t.value;return"hex"===e?"#"+n:"literal"===e?n:"rgb"===e?"rgb("+n.join(",")+")":"rgba("+n.join(",")+")"}var Op=function(){var t=/^(linear\-gradient)/i,e=/^(repeating\-linear\-gradient)/i,n=/^(radial\-gradient)/i,r=/^(repeating\-radial\-gradient)/i,i=/^(conic\-gradient)/i,o=/^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,a=/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,s=/^(left|center|right|top|bottom)/i,u=/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,c=/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,l=/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,h=/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,f=/^\(/,p=/^\)/,d=/^,/,m=/^\#([0-9a-fA-F]+)/,v=/^([a-zA-Z]+)/,g=/^rgb/i,y=/^rgba/i,x=/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/,b="";function _(t){throw new Error(b+": "+t)}function w(){var t=L(S);return b.length>0&&_("Invalid input not EOF"),t}function S(){return M("linear-gradient",t,A)||M("repeating-linear-gradient",e,A)||M("radial-gradient",n,T)||M("repeating-radial-gradient",r,T)||M("conic-gradient",i,T)}function M(t,e,n){return E(e,(function(e){var r=n();return r&&(j(d)||_("Missing comma before color stops")),{type:t,orientation:r,colorStops:L(R)}}))}function E(t,e){var n=j(t);if(n){j(f)||_("Missing (");var r=e(n);return j(p)||_("Missing )"),r}}function A(){return F("directional",o,1)||F("angular",h,1)}function T(){var t,e,n=C();return n&&((t=[]).push(n),e=b,j(d)&&((n=C())?t.push(n):b=e)),t}function C(){var t=function(){var t=F("shape",/^(circle)/i,0);t&&(t.style=D()||O());return t}()||function(){var t=F("shape",/^(ellipse)/i,0);t&&(t.style=N()||O());return t}();if(t)t.at=k();else{var e=O();if(e){t=e;var n=k();n&&(t.at=n)}else{var r=P();r&&(t={type:"default-radial",at:r})}}return t}function O(){return F("extent-keyword",a,1)}function k(){if(F("position",/^at/,0)){var t=P();return t||_("Missing positioning value"),t}}function P(){var t={x:N(),y:N()};if(t.x||t.y)return{type:"position",value:t}}function L(t){var e=t(),n=[];if(e)for(n.push(e);j(d);)(e=t())?n.push(e):_("One extra comma");return n}function R(){var t=F("hex",m,1)||E(y,(function(){return{type:"rgba",value:L(I)}}))||E(g,(function(){return{type:"rgb",value:L(I)}}))||F("literal",v,0);return t||_("Expected color definition"),t.length=N(),t}function I(){return j(x)[1]}function N(){return F("%",c,1)||F("position-keyword",s,1)||D()}function D(){return F("px",u,1)||F("em",l,1)}function F(t,e,n){var r=j(e);if(r)return{type:t,value:r[n]}}function j(t){var e=/^[\n\r\t\s]+/.exec(b);e&&B(e[0].length);var n=t.exec(b);return n&&B(n[0].length),n}function B(t){b=b.substring(t)}return function(t){return b=t,w()}}();function kp(t){var e;return 0===t.parsedStyle.path.totalLength&&(t.parsedStyle.path.totalLength=Is(t.parsedStyle.path.absolutePath,void 0,Za(Za({},e),{bbox:!1,length:!0})).length),t.parsedStyle.path.totalLength}function Pp(t,e){return t[0]===e[0]&&t[1]===e[1]}function Lp(t,e){var n,r,i,o=t.prePoint,a=t.currentPoint,s=t.nextPoint,u=Math.pow(a[0]-o[0],2)+Math.pow(a[1]-o[1],2),c=Math.pow(a[0]-s[0],2)+Math.pow(a[1]-s[1],2),l=Math.pow(o[0]-s[0],2)+Math.pow(o[1]-s[1],2),h=Math.acos((u+c-l)/(2*Math.sqrt(u)*Math.sqrt(c)));if(!h||0===Math.sin(h)||(n=h,r=0,void 0===i&&(i=1e-5),Math.abs(n-r)<i))return{xExtra:0,yExtra:0};var f=Math.abs(Math.atan2(s[1]-a[1],s[0]-a[0])),p=Math.abs(Math.atan2(s[0]-a[0],s[1]-a[1]));return f=f>Math.PI/2?Math.PI-f:f,p=p>Math.PI/2?Math.PI-p:p,{xExtra:Math.cos(h/2-f)*(e/2*(1/Math.sin(h/2)))-e/2||0,yExtra:Math.cos(p-h/2)*(e/2*(1/Math.sin(h/2)))-e/2||0}}function Rp(t,e){return[e[0]+(e[0]-t[0]),e[1]+(e[1]-t[1])]}var Ip=function(t,e){var n=t.x*e.x+t.y*e.y,r=Math.sqrt((Math.pow(t.x,2)+Math.pow(t.y,2))*(Math.pow(e.x,2)+Math.pow(e.y,2)));return(t.x*e.y-t.y*e.x<0?-1:1)*Math.acos(n/r)},Np=function(t,e,n,r,i,o,a,s){e=Math.abs(e),n=Math.abs(n);var u=vp(r=eu(r,360));if(t.x===a.x&&t.y===a.y)return{x:t.x,y:t.y,ellipticalArcAngle:0};if(0===e||0===n)return{x:0,y:0,ellipticalArcAngle:0};var c=(t.x-a.x)/2,l=(t.y-a.y)/2,h={x:Math.cos(u)*c+Math.sin(u)*l,y:-Math.sin(u)*c+Math.cos(u)*l},f=Math.pow(h.x,2)/Math.pow(e,2)+Math.pow(h.y,2)/Math.pow(n,2);f>1&&(e=Math.sqrt(f)*e,n=Math.sqrt(f)*n);var p=(Math.pow(e,2)*Math.pow(n,2)-Math.pow(e,2)*Math.pow(h.y,2)-Math.pow(n,2)*Math.pow(h.x,2))/(Math.pow(e,2)*Math.pow(h.y,2)+Math.pow(n,2)*Math.pow(h.x,2));p=p<0?0:p;var d=(i!==o?1:-1)*Math.sqrt(p),m=d*(e*h.y/n),v=d*(-n*h.x/e),g={x:Math.cos(u)*m-Math.sin(u)*v+(t.x+a.x)/2,y:Math.sin(u)*m+Math.cos(u)*v+(t.y+a.y)/2},y={x:(h.x-m)/e,y:(h.y-v)/n},x=Ip({x:1,y:0},y),b=Ip(y,{x:(-h.x-m)/e,y:(-h.y-v)/n});!o&&b>0?b-=2*Math.PI:o&&b<0&&(b+=2*Math.PI);var _=x+(b%=2*Math.PI)*s,w=e*Math.cos(_),S=n*Math.sin(_);return{x:Math.cos(u)*w-Math.sin(u)*S+g.x,y:Math.sin(u)*w+Math.cos(u)*S+g.y,ellipticalArcStartAngle:x,ellipticalArcEndAngle:x+b,ellipticalArcAngle:_,ellipticalArcCenter:g,resultantRx:e,resultantRy:n}};function Dp(t,e,n){void 0===n&&(n=!0);var r=t.arcParams,i=r.rx,o=void 0===i?0:i,a=r.ry,s=void 0===a?0:a,u=r.xRotation,c=r.arcFlag,l=r.sweepFlag,h=Np({x:t.prePoint[0],y:t.prePoint[1]},o,s,u,!!c,!!l,{x:t.currentPoint[0],y:t.currentPoint[1]},e),f=Np({x:t.prePoint[0],y:t.prePoint[1]},o,s,u,!!c,!!l,{x:t.currentPoint[0],y:t.currentPoint[1]},n?e+.005:e-.005),p=f.x-h.x,d=f.y-h.y,m=Math.sqrt(p*p+d*d);return{x:-p/m,y:-d/m}}function Fp(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function jp(t,e){return Fp(t)*Fp(e)?(t[0]*e[0]+t[1]*e[1])/(Fp(t)*Fp(e)):1}function Bp(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(jp(t,e))}function zp(t,e){var n=e[1],r=e[2],i=eu(vp(e[3]),2*Math.PI),o=e[4],a=e[5],s=t[0],u=t[1],c=e[6],l=e[7],h=Math.cos(i)*(s-c)/2+Math.sin(i)*(u-l)/2,f=-1*Math.sin(i)*(s-c)/2+Math.cos(i)*(u-l)/2,p=h*h/(n*n)+f*f/(r*r);p>1&&(n*=Math.sqrt(p),r*=Math.sqrt(p));var d=n*n*(f*f)+r*r*(h*h),m=d?Math.sqrt((n*n*(r*r)-d)/d):1;o===a&&(m*=-1),isNaN(m)&&(m=0);var v=r?m*n*f/r:0,g=n?m*-r*h/n:0,y=(s+c)/2+Math.cos(i)*v-Math.sin(i)*g,x=(u+l)/2+Math.sin(i)*v+Math.cos(i)*g,b=[(h-v)/n,(f-g)/r],_=[(-1*h-v)/n,(-1*f-g)/r],w=Bp([1,0],b),S=Bp(b,_);return jp(b,_)<=-1&&(S=Math.PI),jp(b,_)>=1&&(S=0),0===a&&S>0&&(S-=2*Math.PI),1===a&&S<0&&(S+=2*Math.PI),{cx:y,cy:x,rx:Pp(t,[c,l])?0:n,ry:Pp(t,[c,l])?0:r,startAngle:w,endAngle:w+S,xRotation:i,arcFlag:o,sweepFlag:a}}function Up(t,e,n,r){var i=(-1+Math.sqrt(2))/3*4,o=t*i,a=e*i,s=n-t,u=n+t,c=r-e,l=r+e;return[["M",s,r],["C",s,r-a,n-o,c,n,c],["C",n+o,c,u,r-a,u,r],["C",u,r+a,n+o,l,n,l],["C",n-o,l,s,r+a,s,r],["Z"]]}function Vp(t,e){void 0===e&&(e=t.getLocalTransform());var n=[];switch(t.nodeName){case xc.LINE:var r=t.parsedStyle;n=function(t,e,n,r){return[["M",t,e],["L",n,r]]}(r.x1,r.y1,r.x2,r.y2);break;case xc.CIRCLE:var i=t.parsedStyle,o=i.r;n=Up(o,o,i.cx,i.cy);break;case xc.ELLIPSE:var a=t.parsedStyle;n=Up(a.rx,a.ry,a.cx,a.cy);break;case xc.POLYLINE:case xc.POLYGON:n=function(t,e){var n=t.map((function(t,e){return[0===e?"M":"L",t[0],t[1]]}));return e&&n.push(["Z"]),n}(t.parsedStyle.points.points,t.nodeName===xc.POLYGON);break;case xc.RECT:var s=t.parsedStyle,u=s.width,c=s.height,l=s.x,h=s.y,f=s.radius,p=f&&f.some((function(t){return 0!==t}));n=function(t,e,n,r,i){if(i){var o=i[0],a=i[1],s=i[2],u=i[3],c=t>0?1:-1,l=e>0?1:-1,h=c+l!==0?1:0;return[["M",c*o+n,r],["L",t-c*a+n,r],a?["A",a,a,0,0,h,t+n,l*a+r]:null,["L",t+n,e-l*s+r],s?["A",s,s,0,0,h,t+n-c*s,e+r]:null,["L",n+c*u,e+r],u?["A",u,u,0,0,h,n,e+r-l*u]:null,["L",n,l*o+r],o?["A",o,o,0,0,h,c*o+n,r]:null,["Z"]].filter((function(t){return t}))}return[["M",n,r],["L",n+t,r],["L",n+t,r+e],["L",n,r+e],["Z"]]}(u,c,l,h,p&&f.map((function(t){return Ks(t,0,Math.min(Math.abs(u)/2,Math.abs(c)/2))})));break;case xc.PATH:var d=t.parsedStyle.path.absolutePath;n=[].concat(d)}if(n.length)return function(t,e,n){var r=e.parsedStyle,i=r.defX,o=void 0===i?0:i,a=r.defY,s=void 0===a?0:a;return t.reduce((function(t,e){var r="";if("M"===e[0]||"L"===e[0]){var i=Bo(e[1]-o,e[2]-s,0);n&&ra(i,i,n),r=""+e[0]+i[0]+","+i[1]}else if("Z"===e[0])r=e[0];else if("C"===e[0]){var a=Bo(e[1]-o,e[2]-s,0),u=Bo(e[3]-o,e[4]-s,0),c=Bo(e[5]-o,e[6]-s,0);n&&(ra(a,a,n),ra(u,u,n),ra(c,c,n)),r=""+e[0]+a[0]+","+a[1]+","+u[0]+","+u[1]+","+c[0]+","+c[1]}else if("A"===e[0]){var l=Bo(e[6]-o,e[7]-s,0);n&&ra(l,l,n),r=""+e[0]+e[1]+","+e[2]+","+e[3]+","+e[4]+","+e[5]+","+l[0]+","+l[1]}else if("Q"===e[0]){var h=Bo(e[1]-o,e[2]-s,0),f=Bo(e[3]-o,e[4]-s,0);n&&(ra(h,h,n),ra(f,f,n)),r=""+e[0]+e[1]+","+e[2]+","+e[3]+","+e[4]+"}"}return t+r}),"")}(n,t,e)}function Gp(t,e,n){var r=!1,i=!1,o=!!e&&!e.isNone,a=!!n&&!n.isNone;return"visiblepainted"===t||"painted"===t||"auto"===t?(r=o,i=a):"visiblefill"===t||"fill"===t?r=!0:"visiblestroke"===t||"stroke"===t?i=!0:"visible"!==t&&"all"!==t||(r=!0,i=!0),[r,i]}var Wp=function(){return this.call=this._createCall("sync"),this.call.apply(this,arguments)},Hp=function(){return this.callAsync=this._createCall("async"),this.callAsync.apply(this,arguments)},Yp=function(){return this.promise=this._createCall("promise"),this.promise.apply(this,arguments)},Xp=function(){function t(t,e){void 0===t&&(t=[]),void 0===e&&(e=void 0),this.name=void 0,this.taps=void 0,this.promise=void 0,this._promise=void 0,this._args=t,this.name=e,this.taps=[],this.interceptors=[],this._call=Wp,this.call=Wp,this._callAsync=Hp,this.callAsync=Hp,this._promise=Yp,this.promise=Yp,this._x=void 0}var e=t.prototype;return e.compile=function(t){throw new Error("Abstract: should be overridden")},e._createCall=function(t){return this.compile({taps:this.taps,interceptors:this.interceptors,args:this._args,type:t})},e._tap=function(t,e,n){if("string"==typeof e)e={name:e.trim()};else if("object"!=typeof e||null===e)throw new Error("Invalid tap options");if("string"!=typeof e.name||""===e.name)throw new Error("Missing name for tap");e=Object.assign({type:t,fn:n},e),e=this._runRegisterInterceptors(e),this._insert(e)},e.tap=function(t,e){this._tap("sync",t,e)},e.tapAsync=function(t,e){this._tap("async",t,e)},e.tapPromise=function(t,e){this._tap("promise",t,e)},e._runRegisterInterceptors=function(t){for(var e,n=sl(this.interceptors);!(e=n()).done;){var r=e.value;if(r.register){var i=r.register(t);void 0!==i&&(t=i)}}return t},e.withOptions=function(t){var e=this,n=function(e){return Object.assign({},t,"string"==typeof e?{name:e}:e)};return{name:this.name,tap:function(t,r){return e.tap(n(t),r)},tapAsync:function(t,r){return e.tapAsync(n(t),r)},tapPromise:function(t,r){return e.tapPromise(n(t),r)},isUsed:function(){return e.isUsed()},withOptions:function(t){return e.withOptions(n(t))}}},e.isUsed=function(){return this.taps.length>0||this.interceptors.length>0},e._resetCompilation=function(){this.call=this._call,this.callAsync=this._callAsync,this.promise=this._promise},e._insert=function(t){var e;this._resetCompilation(),"string"==typeof t.before?e=new Set([t.before]):Array.isArray(t.before)&&(e=new Set(t.before));var n=0;"number"==typeof t.stage&&(n=t.stage);for(var r=this.taps.length;r>0;){r--;var i=this.taps[r];this.taps[r+1]=i;var o=i.stage||0;if(e){if(e.has(i.name)){e.delete(i.name);continue}if(e.size>0)continue}if(!(o>n)){r++;break}}this.taps[r]=t},t}(),qp=function(){function t(t){this.config=t,this.options=void 0,this._args=void 0}var e=t.prototype;return e.create=function(t){var e;switch(this.init(t),this.options.type){case"sync":e=new Function(this.args(),'"use strict";\n'+this.header()+this.contentWithInterceptors({onError:function(t){return"throw "+t+";\n"},onResult:function(t){return"return "+t+";\n"},resultReturns:!0,onDone:function(){return""},rethrowIfPossible:!0}));break;case"async":e=new Function(this.args({after:"_callback"}),'"use strict";\n'+this.header()+this.contentWithInterceptors({onError:function(t){return"_callback("+t+");\n"},onResult:function(t){return"_callback(null, "+t+");\n"},onDone:function(){return"_callback();\n"}}));break;case"promise":var n=!1,r=this.contentWithInterceptors({onError:function(t){return n=!0,"_error("+t+");\n"},onResult:function(t){return"_resolve("+t+");\n"},onDone:function(){return"_resolve();\n"}}),i="";i+='"use strict";\n',i+=this.header(),i+="return new Promise((function(_resolve, _reject) {\n",n&&(i+="var _sync = true;\n",i+="function _error(_err) {\n",i+="if(_sync)\n",i+="_resolve(Promise.resolve().then((function() { throw _err; })));\n",i+="else\n",i+="_reject(_err);\n",i+="};\n"),i+=r,n&&(i+="_sync = false;\n"),i+="}));\n",e=new Function(this.args(),i)}return this.deinit(),e},e.setup=function(t,e){t._x=e.taps.map((function(t){return t.fn}))},e.init=function(t){this.options=t,this._args=t.args.slice()},e.deinit=function(){this.options=void 0,this._args=void 0},e.contentWithInterceptors=function(t){var e=this;if(this.options.interceptors.length>0){for(var n=t.onError,r=t.onResult,i=t.onDone,o="",a=0;a<this.options.interceptors.length;a++){var s=this.options.interceptors[a];s.call&&(o+=this.getInterceptor(a)+".call("+this.args({before:s.context?"_context":void 0})+");\n")}return o+=this.content(Object.assign(t,{onError:n&&function(t){for(var r="",i=0;i<e.options.interceptors.length;i++){e.options.interceptors[i].error&&(r+=e.getInterceptor(i)+".error("+t+");\n")}return r+=n(t)},onResult:r&&function(t){for(var n="",i=0;i<e.options.interceptors.length;i++){e.options.interceptors[i].result&&(n+=e.getInterceptor(i)+".result("+t+");\n")}return n+=r(t)},onDone:i&&function(){for(var t="",n=0;n<e.options.interceptors.length;n++){e.options.interceptors[n].done&&(t+=e.getInterceptor(n)+".done();\n")}return t+=i()}})),o}return this.content(t)},e.header=function(){var t="";return this.needContext()?t+="var _context = {};\n":t+="var _context;\n",t+="var _x = this._x;\n",this.options.interceptors.length>0&&(t+="var _taps = this.taps;\n",t+="var _interceptors = this.interceptors;\n"),t},e.needContext=function(){for(var t,e=sl(this.options.taps);!(t=e()).done;){if(t.value.context)return!0}return!1},e.callTap=function(t,e){for(var n=e.onError,r=e.onResult,i=e.onDone,o=e.rethrowIfPossible,a="",s=!1,u=0;u<this.options.interceptors.length;u++){var c=this.options.interceptors[u];c.tap&&(s||(a+="var _tap"+t+" = "+this.getTap(t)+";\n",s=!0),a+=this.getInterceptor(u)+".tap("+(c.context?"_context, ":"")+"_tap"+t+");\n")}a+="var _fn"+t+" = "+this.getTapFn(t)+";\n";var l=this.options.taps[t];switch(l.type){case"sync":o||(a+="var _hasError"+t+" = false;\n",a+="try {\n"),a+=r?"var _result"+t+" = _fn"+t+"("+this.args({before:l.context?"_context":void 0})+");\n":"_fn"+t+"("+this.args({before:l.context?"_context":void 0})+");\n",o||(a+="} catch(_err) {\n",a+="_hasError"+t+" = true;\n",a+=n("_err"),a+="}\n",a+="if(!_hasError"+t+") {\n"),r&&(a+=r("_result"+t)),i&&(a+=i()),o||(a+="}\n");break;case"async":var h="";h+=r?"(function(_err"+t+", _result"+t+") {\n":"(function(_err"+t+") {\n",h+="if(_err"+t+") {\n",h+=n("_err"+t),h+="} else {\n",r&&(h+=r("_result"+t)),i&&(h+=i()),h+="}\n",h+="})",a+="_fn"+t+"("+this.args({before:l.context?"_context":void 0,after:h})+");\n";break;case"promise":a+="var _hasResult"+t+" = false;\n",a+="var _promise"+t+" = _fn"+t+"("+this.args({before:l.context?"_context":void 0})+");\n",a+="if (!_promise"+t+" || !_promise"+t+".then)\n",a+="  throw new Error('Tap function (tapPromise) did not return promise (returned ' + _promise"+t+" + ')');\n",a+="_promise"+t+".then((function(_result"+t+") {\n",a+="_hasResult"+t+" = true;\n",r&&(a+=r("_result"+t)),i&&(a+=i()),a+="}), function(_err"+t+") {\n",a+="if(_hasResult"+t+") throw _err"+t+";\n",a+=n("_err"+t),a+="});\n"}return a},e.callTapsSeries=function(t){var e=this,n=t.onError,r=t.onResult,i=t.resultReturns,o=t.onDone,a=t.doneReturns,s=t.rethrowIfPossible;if(0===this.options.taps.length)return o();for(var u=this.options.taps.findIndex((function(t){return"sync"!==t.type})),c=i||a,l="",h=o,f=0,p=function(t){var i=t;h!==o&&("sync"!==e.options.taps[i].type||f++>20)&&(f=0,l+="function _next"+i+"() {\n",l+=h(),l+="}\n",h=function(){return(c?"return ":"")+"_next"+i+"();\n"});var a=h,p=function(t){return t?"":o()},d=e.callTap(i,{onError:function(t){return n(i,t,a,p)},onResult:r&&function(t){return r(i,t,a,p)},onDone:!r&&a,rethrowIfPossible:s&&(u<0||i<u)});h=function(){return d}},d=this.options.taps.length-1;d>=0;d--)p(d);return l+=h()},e.callTapsLooping=function(t){var e=t.onError,n=t.onDone,r=t.rethrowIfPossible;if(0===this.options.taps.length)return n();var i=this.options.taps.every((function(t){return"sync"===t.type})),o="";i||(o+="var _looper = (function() {\n",o+="var _loopAsync = false;\n"),o+="var _loop;\n",o+="do {\n",o+="_loop = false;\n";for(var a=0;a<this.options.interceptors.length;a++){var s=this.options.interceptors[a];s.loop&&(o+=this.getInterceptor(a)+".loop("+this.args({before:s.context?"_context":void 0})+");\n")}return o+=this.callTapsSeries({onError:e,onResult:function(t,e,n,r){var o="";return o+="if("+e+" !== undefined) {\n",o+="_loop = true;\n",i||(o+="if(_loopAsync) _looper();\n"),o+=r(!0),o+="} else {\n",o+=n(),o+="}\n"},onDone:n&&function(){var t="";return t+="if(!_loop) {\n",t+=n(),t+="}\n"},rethrowIfPossible:r&&i}),o+="} while(_loop);\n",i||(o+="_loopAsync = true;\n",o+="});\n",o+="_looper();\n"),o},e.callTapsParallel=function(t){var e=this,n=t.onError,r=t.onResult,i=t.onDone,o=t.rethrowIfPossible,a=t.onTap,s=void 0===a?function(t,e){return e()}:a;if(this.options.taps.length<=1)return this.callTapsSeries({onError:n,onResult:r,onDone:i,rethrowIfPossible:o});var u="";u+="do {\n",u+="var _counter = "+this.options.taps.length+";\n",i&&(u+="var _done = (function() {\n",u+=i(),u+="});\n");for(var c=function(t){var a=function(){return i?"if(--_counter === 0) _done();\n":"--_counter;"},c=function(t){return t||!i?"_counter = 0;\n":"_counter = 0;\n_done();\n"};u+="if(_counter <= 0) break;\n",u+=s(t,(function(){return e.callTap(t,{onError:function(e){var r="";return r+="if(_counter > 0) {\n",r+=n(t,e,a,c),r+="}\n"},onResult:r&&function(e){var n="";return n+="if(_counter > 0) {\n",n+=r(t,e,a,c),n+="}\n"},onDone:!r&&function(){return a()},rethrowIfPossible:o})}),a,c)},l=0;l<this.options.taps.length;l++)c(l);return u+="} while(false);\n"},e.args=function(t){var e=void 0===t?{}:t,n=e.before,r=e.after,i=this._args;return n&&(i=[n].concat(i)),r&&(i=i.concat(r)),0===i.length?"":i.join(", ")},e.getTapFn=function(t){return"_x["+t+"]"},e.getTap=function(t){return"_taps["+t+"]"},e.getInterceptor=function(t){return"_interceptors["+t+"]"},t}(),Zp=function(t){function e(){return t.apply(this,arguments)||this}return nl(e,t),e.prototype.content=function(t){var e=t.onError,n=t.onDone;return this.callTapsParallel({onError:function(t,n,r,i){return e(n)+i(!0)},onDone:n})},e}(qp),$p=new Zp,Kp=function(t){return $p.setup(this,t),$p.create(t)},Jp=function(t){function e(e,n){var r;return void 0===e&&(e=[]),void 0===n&&(n=void 0),(r=t.call(this,e,n)||this).compile=Kp,r._call=void 0,r.call=void 0,r}return nl(e,t),e}(Xp),Qp=function(t){function e(){return t.apply(this,arguments)||this}return nl(e,t),e.prototype.content=function(t){var e=this,n=t.onError,r=t.onResult;return t.onDone,this.callTapsSeries({onError:function(t,e,r,i){return n(e)+i(!0)},onResult:function(t,n,r){var i="";return i+="if("+n+" !== undefined) {\n",i+=e._args[0]+" = "+n+";\n",i+="}\n",i+=r()},onDone:function(){return r(e._args[0])}})},e}(qp),td=new Qp,ed=function(t){return td.setup(this,t),td.create(t)},nd=function(t){function e(e,n){var r;return void 0===e&&(e=[]),void 0===n&&(n=void 0),(r=t.call(this,e,n)||this).compile=ed,r._call=void 0,r.call=void 0,r}return nl(e,t),e}(Xp),rd=function(t){function e(){return t.apply(this,arguments)||this}return nl(e,t),e.prototype.content=function(t){var e=t.onError,n=t.onDone,r=t.rethrowIfPossible;return this.callTapsSeries({onError:function(t,n){return e(n)},onDone:n,rethrowIfPossible:r})},e}(qp),id=new rd,od=function(){throw new Error("tapAsync is not supported on a SyncHook")},ad=function(){throw new Error("tapPromise is not supported on a SyncHook")},sd=function(t){return id.setup(this,t),id.create(t)},ud=function(t){function e(e,n){var r;return void 0===e&&(e=[]),void 0===n&&(n=void 0),(r=t.call(this,e,n)||this).tapAsync=od,r.tapPromise=ad,r.compile=sd,r}return nl(e,t),e}(Xp),cd=function(t){function e(){return t.apply(this,arguments)||this}return nl(e,t),e.prototype.content=function(t){var e=this,n=t.onError,r=t.onResult,i=t.resultReturns,o=t.rethrowIfPossible;return this.callTapsSeries({onError:function(t,e){return n(e)},onResult:function(t,n,r){var i="";return i+="if("+n+" !== undefined) {\n",i+=e._args[0]+" = "+n+";\n",i+="}\n",i+=r()},onDone:function(){return r(e._args[0])},doneReturns:i,rethrowIfPossible:o})},e}(qp),ld=new cd,hd=function(){throw new Error("tapAsync is not supported on a SyncWaterfallHook")},fd=function(){throw new Error("tapPromise is not supported on a SyncWaterfallHook")},pd=function(t){return ld.setup(this,t),ld.create(t)},dd=function(t){function e(e,n){var r;return void 0===e&&(e=[]),void 0===n&&(n=void 0),(r=t.call(this,e,n)||this).tapAsync=hd,r.tapPromise=fd,r.compile=pd,r}return nl(e,t),e}(ud),md=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],vd=/([\"\'])[^\'\"]+\1/;var gd,yd=1,xd="object"==typeof self&&self.self==self?self:"object"==typeof global&&global.global==global?global:{},bd=Date.now(),_d={},wd=Date.now(),Sd=function(t){if("function"!=typeof t)throw new TypeError(t+" is not a function");var e=Date.now(),n=e-wd,r=n>16?0:16-n,i=yd++;return _d[i]=t,Object.keys(_d).length>1||setTimeout((function(){wd=e;var t=_d;_d={},Object.keys(t).forEach((function(e){return t[e](xd.performance&&"function"==typeof xd.performance.now?xd.performance.now():Date.now()-bd)}))}),r),i},Md=function(t){delete _d[t]},Ed=function(t){return"string"!=typeof t?Sd:""===t?xd.requestAnimationFrame:xd[t+"RequestAnimationFrame"]},Ad=function(t,e){for(var n=0;void 0!==t[n];){if(e(t[n]))return t[n];n+=1}}(["","webkit","moz","ms","o"],(function(t){return!!Ed(t)})),Td=Ed(Ad),Cd="string"!=typeof(gd=Ad)?Md:""===gd?xd.cancelAnimationFrame:xd[gd+"CancelAnimationFrame"]||xd[gd+"CancelRequestAnimationFrame"];xd.requestAnimationFrame=Td,xd.cancelAnimationFrame=Cd;var Od,kd,Pd,Ld,Rd,Id,Nd=[{n:"display",k:["none"]},{n:"opacity",int:!0,inh:!0,d:"1",syntax:pc.OPACITY_VALUE},{n:"fillOpacity",int:!0,inh:!0,d:"1",syntax:pc.OPACITY_VALUE},{n:"strokeOpacity",int:!0,inh:!0,d:"1",syntax:pc.OPACITY_VALUE},{n:"fill",int:!0,k:["none"],d:"none",syntax:pc.PAINT},{n:"fillRule",k:["nonzero","evenodd"],d:"nonzero"},{n:"stroke",int:!0,k:["none"],d:"none",syntax:pc.PAINT},{n:"shadowType",k:["inner","outer","both"],d:"outer",l:!0},{n:"shadowColor",int:!0,syntax:pc.COLOR},{n:"shadowOffsetX",int:!0,l:!0,d:"0",syntax:pc.LENGTH_PERCENTAGE},{n:"shadowOffsetY",int:!0,l:!0,d:"0",syntax:pc.LENGTH_PERCENTAGE},{n:"shadowBlur",int:!0,l:!0,d:"0",syntax:pc.SHADOW_BLUR},{n:"lineWidth",int:!0,inh:!0,d:"1",l:!0,a:["strokeWidth"],syntax:pc.LENGTH_PERCENTAGE},{n:"increasedLineWidthForHitTesting",inh:!0,d:"0",l:!0,syntax:pc.LENGTH_PERCENTAGE},{n:"lineJoin",inh:!0,l:!0,a:["strokeLinejoin"],k:["miter","bevel","round"],d:"miter"},{n:"lineCap",inh:!0,l:!0,a:["strokeLinecap"],k:["butt","round","square"],d:"butt"},{n:"lineDash",int:!0,inh:!0,k:["none"],a:["strokeDasharray"],syntax:pc.LENGTH_PERCENTAGE_12},{n:"lineDashOffset",int:!0,inh:!0,d:"0",a:["strokeDashoffset"],syntax:pc.LENGTH_PERCENTAGE},{n:"offsetPath",syntax:pc.DEFINED_PATH},{n:"offsetDistance",int:!0,syntax:pc.OFFSET_DISTANCE},{n:"dx",int:!0,l:!0,d:"0",syntax:pc.LENGTH_PERCENTAGE},{n:"dy",int:!0,l:!0,d:"0",syntax:pc.LENGTH_PERCENTAGE},{n:"zIndex",ind:!0,int:!0,d:"0",k:["auto"],syntax:pc.Z_INDEX},{n:"visibility",k:["visible","hidden"],ind:!0,inh:!0,int:!0,d:"visible"},{n:"pointerEvents",inh:!0,k:["none","auto","stroke","fill","painted","visible","visiblestroke","visiblefill","visiblepainted","all"],d:"auto"},{n:"filter",ind:!0,l:!0,k:["none"],d:"none",syntax:pc.FILTER},{n:"clipPath",syntax:pc.DEFINED_PATH},{n:"textPath",syntax:pc.DEFINED_PATH},{n:"textPathSide",k:["left","right"],d:"left"},{n:"textPathStartOffset",l:!0,d:"0",syntax:pc.LENGTH_PERCENTAGE},{n:"transform",p:100,int:!0,k:["none"],d:"none",syntax:pc.TRANSFORM},{n:"transformOrigin",p:100,d:function(t){return t===xc.CIRCLE||t===xc.ELLIPSE?"center":t===xc.TEXT?"text-anchor":"left top"},l:!0,syntax:pc.TRANSFORM_ORIGIN},{n:"anchor",p:99,d:function(t){return t===xc.CIRCLE||t===xc.ELLIPSE?"0.5 0.5":"0 0"},l:!0,syntax:pc.LENGTH_PERCENTAGE_12},{n:"cx",int:!0,d:"0",syntax:pc.COORDINATE},{n:"cy",int:!0,d:"0",syntax:pc.COORDINATE},{n:"r",int:!0,l:!0,d:"0",syntax:pc.LENGTH_PERCENTAGE},{n:"rx",int:!0,l:!0,d:"0",syntax:pc.LENGTH_PERCENTAGE},{n:"ry",int:!0,l:!0,d:"0",syntax:pc.LENGTH_PERCENTAGE},{n:"x",int:!0,d:"0",syntax:pc.COORDINATE},{n:"y",int:!0,d:"0",syntax:pc.COORDINATE},{n:"z",int:!0,d:"0",syntax:pc.COORDINATE},{n:"width",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:pc.LENGTH_PERCENTAGE},{n:"height",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:pc.LENGTH_PERCENTAGE},{n:"radius",int:!0,l:!0,d:"0",syntax:pc.LENGTH_PERCENTAGE_14},{n:"x1",int:!0,l:!0,syntax:pc.COORDINATE},{n:"y1",int:!0,l:!0,syntax:pc.COORDINATE},{n:"z1",int:!0,l:!0,syntax:pc.COORDINATE},{n:"x2",int:!0,l:!0,syntax:pc.COORDINATE},{n:"y2",int:!0,l:!0,syntax:pc.COORDINATE},{n:"z2",int:!0,l:!0,syntax:pc.COORDINATE},{n:"path",int:!0,l:!0,d:"",a:["d"],syntax:pc.PATH,p:50},{n:"points",l:!0,syntax:pc.LIST_OF_POINTS,p:50},{n:"text",l:!0,d:"",syntax:pc.TEXT,p:50},{n:"textTransform",l:!0,inh:!0,k:["capitalize","uppercase","lowercase","none"],d:"none",syntax:pc.TEXT_TRANSFORM,p:51},{n:"font",l:!0},{n:"fontSize",int:!0,inh:!0,d:"16px",l:!0,syntax:pc.LENGTH_PERCENTAGE},{n:"fontFamily",l:!0,inh:!0,d:"sans-serif"},{n:"fontStyle",l:!0,inh:!0,k:["normal","italic","oblique"],d:"normal"},{n:"fontWeight",l:!0,inh:!0,k:["normal","bold","bolder","lighter"],d:"normal"},{n:"fontVariant",l:!0,inh:!0,k:["normal","small-caps"],d:"normal"},{n:"lineHeight",l:!0,syntax:pc.LENGTH,int:!0,d:"0"},{n:"letterSpacing",l:!0,syntax:pc.LENGTH,int:!0,d:"0"},{n:"miterLimit",l:!0,syntax:pc.NUMBER,d:function(t){return t===xc.PATH||t===xc.POLYGON||t===xc.POLYLINE?"4":"10"}},{n:"wordWrap",l:!0},{n:"wordWrapWidth",l:!0},{n:"maxLines",l:!0},{n:"textOverflow",l:!0,d:"clip"},{n:"leading",l:!0},{n:"textBaseline",l:!0,inh:!0,k:["top","hanging","middle","alphabetic","ideographic","bottom"],d:"alphabetic"},{n:"textAlign",l:!0,inh:!0,k:["start","center","middle","end","left","right"],d:"start"},{n:"markerStart",syntax:pc.MARKER},{n:"markerEnd",syntax:pc.MARKER},{n:"markerMid",syntax:pc.MARKER},{n:"markerStartOffset",syntax:pc.LENGTH,l:!0,int:!0,d:"0"},{n:"markerEndOffset",syntax:pc.LENGTH,l:!0,int:!0,d:"0"}],Dd={},Fd=new WeakMap,jd=Do(),Bd=Do(),zd=Do(),Ud=function(){function t(){var t=this;Nd.forEach((function(e){t.registerMetadata(e)}))}var e=t.prototype;return e.registerMetadata=function(t){[t.n].concat(t.a||[]).forEach((function(e){Dd[e]=t}))},e.unregisterMetadata=function(t){delete Dd[t]},e.getPropertySyntax=function(t){return ym.CSSPropertySyntaxFactory[t]},e.processProperties=function(t,e,n){var r=this;void 0===n&&(n={skipUpdateAttribute:!1,skipParse:!1,forceUpdateGeometry:!1,usedAttributes:[]});var i=n,o=i.skipUpdateAttribute,a=i.skipParse,s=i.forceUpdateGeometry,u=i.usedAttributes,c=s,l=Object.keys(e);l.forEach((function(n){var r,i=kc(n);o||(t.attributes[i]=e[n]),!c&&(null===(r=Dd[i])||void 0===r?void 0:r.l)&&(c=!0)})),a||l.forEach((function(e){t.computedStyle[e]=r.parseProperty(e,t.attributes[e],t)})),(null==u?void 0:u.length)&&(l=Array.from(new Set(l.concat(u)))),["path","points","text","textTransform","anchor","transform","transformOrigin"].forEach((function(t){var e=l.indexOf(t);e>-1&&(l.splice(e,1),l.push(t))})),l.forEach((function(e){e in t.computedStyle&&(t.parsedStyle[e]=r.computeProperty(e,t.computedStyle[e],t))})),c&&this.updateGeometry(t),l.forEach((function(e){e in t.parsedStyle&&r.postProcessProperty(e,t)})),t.children.length&&l.forEach((function(e){e in t.parsedStyle&&r.isPropertyInheritable(e)&&t.children.forEach((function(t){t.internalSetAttribute(e,null,{skipUpdateAttribute:!0,skipParse:!0})}))}))},e.parseProperty=function(t,e,n){var r=Dd[t],i=e;if((""===e||zs(e))&&(e="unset"),"unset"===e||"initial"===e||"inherit"===e)i=Kl(e);else if(r){var o=r.k,a=r.syntax,s=a&&this.getPropertySyntax(a);o&&o.indexOf(e)>-1?i=Kl(e):s&&s.parser&&(i=s.parser(e,n))}return i},e.computeProperty=function(t,e,n){var r=Dd[t],i="g-root"===n.id,o=e;if(r){var a=r.syntax,s=r.inh,u=r.d;if(e instanceof Sl){var c=e.value;if("unset"===c&&(c=s&&!i?"inherit":"initial"),"initial"===c)zs(u)||(e=this.parseProperty(t,Cc(u)?u(n.nodeName):u,n));else if("inherit"===c){var l=this.tryToResolveProperty(n,t,{inherited:!0});return zs(l)?void this.addUnresolveProperty(n,t):l}}var h=a&&this.getPropertySyntax(a);if(h&&h.calculator){var f=n.parsedStyle[t];o=h.calculator(t,f,e,n,this)}else o=e instanceof Sl?e.value:e}return o},e.postProcessProperty=function(t,e){var n=Dd[t];if(n&&n.syntax){var r=n.syntax&&this.getPropertySyntax(n.syntax);r&&r.postProcessor&&r.postProcessor(e)}},e.addUnresolveProperty=function(t,e){var n=Fd.get(t);n||(Fd.set(t,[]),n=Fd.get(t)),-1===n.indexOf(e)&&n.push(e)},e.tryToResolveProperty=function(t,e,n){if(void 0===n&&(n={}),n.inherited&&t.parentElement&&function(t,e){var n=Fd.get(t);return!n||0===n.length||n.includes(e)}(t.parentElement,e)){var r=t.parentElement.parsedStyle[e];if("unset"===r||"initial"===r||"inherit"===r)return;return r}},e.recalc=function(t){var e=Fd.get(t);if(e&&e.length){var n={};e.forEach((function(e){n[e]=t.attributes[e]})),this.processProperties(t,n),Fd.delete(t)}},e.updateGeometry=function(t){var e=ym.geometryUpdaterFactory[t.nodeName];if(e){var n=t.geometry;n.contentBounds||(n.contentBounds=new gc),n.renderBounds||(n.renderBounds=new gc);var r=t.parsedStyle,i=e.update(r,t),o=i.width,a=i.height,s=i.depth,u=void 0===s?0:s,c=i.offsetX,l=void 0===c?0:c,h=i.offsetY,f=void 0===h?0:h,p=i.offsetZ,d=void 0===p?0:p,m=o<0,v=a<0,g=Uo(jd,Math.abs(o)/2,Math.abs(a)/2,u/2),y=r.stroke,x=r.lineWidth,b=r.increasedLineWidthForHitTesting,_=r.shadowType,w=r.shadowColor,S=r.filter,M=void 0===S?[]:S,E=r.transformOrigin,A=r.anchor;t.nodeName===xc.TEXT&&delete r.anchor;var T=Uo(Bd,(1-2*(A&&A[0]||0))*o/2+l,(1-2*(A&&A[1]||0))*a/2+f,(1-2*(A&&A[2]||0))*g[2]+d);n.contentBounds.update(T,g);var C=t.nodeName===xc.POLYLINE||t.nodeName===xc.POLYGON||t.nodeName===xc.PATH?Math.SQRT2:.5;if(y&&!y.isNone){var O=((x||0)+(b||0))*C;Vo(g,g,Uo(zd,O,O,0))}if(n.renderBounds.update(T,g),w&&_&&"inner"!==_){var k=n.renderBounds,P=k.min,L=k.max,R=r.shadowBlur||0,I=r.shadowOffsetX||0,N=r.shadowOffsetY||0,D=P[0]-R+I,F=L[0]+R+I,j=P[1]-R+N,B=L[1]+R+N;P[0]=Math.min(P[0],D),L[0]=Math.max(L[0],F),P[1]=Math.min(P[1],j),L[1]=Math.max(L[1],B),n.renderBounds.setMinMax(P,L)}M.forEach((function(t){var e=t.name,r=t.params;if("blur"===e){var i=r[0].value;n.renderBounds.update(n.renderBounds.center,Vo(n.renderBounds.halfExtents,n.renderBounds.halfExtents,Bo(i,i,0)))}else if("drop-shadow"===e){var o=r[0].value,a=r[1].value,s=r[2].value,u=n.renderBounds,c=u.min,l=u.max,h=c[0]-s+o,f=l[0]+s+o,p=c[1]-s+a,d=l[1]+s+a;c[0]=Math.min(c[0],h),l[0]=Math.max(l[0],f),c[1]=Math.min(c[1],p),l[1]=Math.max(l[1],d),n.renderBounds.setMinMax(c,l)}})),A=r.anchor;var z=(m?-1:1)*bh(E[0],0,t),U=(v?-1:1)*bh(E[1],1,t);z-=(m?-1:1)*(A&&A[0]||0)*n.contentBounds.halfExtents[0]*2,U-=(v?-1:1)*(A&&A[1]||0)*n.contentBounds.halfExtents[1]*2,t.setOrigin(z,U),ym.sceneGraphService.dirtifyToRoot(t)}},e.isPropertyInheritable=function(t){var e=Dd[t];return!!e&&e.inh},t}();(kd=Od||(Od={}))[kd.ORBITING=0]="ORBITING",kd[kd.EXPLORING=1]="EXPLORING",kd[kd.TRACKING=2]="TRACKING",(Ld=Pd||(Pd={}))[Ld.DEFAULT=0]="DEFAULT",Ld[Ld.ROTATIONAL=1]="ROTATIONAL",Ld[Ld.TRANSLATIONAL=2]="TRANSLATIONAL",Ld[Ld.CINEMATIC=3]="CINEMATIC",(Id=Rd||(Rd={}))[Id.ORTHOGRAPHIC=0]="ORTHOGRAPHIC",Id[Id.PERSPECTIVE=1]="PERSPECTIVE";var Vd,Gd,Wd="updated",Hd=2e-4,Yd=function(){function t(){this.canvas=void 0,this.eventEmitter=new fc,this.matrix=no(),this.right=Bo(1,0,0),this.up=Bo(0,1,0),this.forward=Bo(0,0,1),this.position=Bo(0,0,1),this.focalPoint=Bo(0,0,0),this.distanceVector=Bo(0,0,-1),this.distance=1,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.dollyingStep=0,this.maxDistance=1/0,this.minDistance=-1/0,this.zoom=1,this.rotateWorld=!1,this.fov=30,this.near=.1,this.far=1e3,this.aspect=1,this.left=void 0,this.rright=void 0,this.top=void 0,this.bottom=void 0,this.projectionMatrix=no(),this.projectionMatrixInverse=no(),this.jitteredProjectionMatrix=void 0,this.view=void 0,this.enableUpdate=!0,this.type=Od.EXPLORING,this.trackingMode=Pd.DEFAULT,this.projectionMode=Rd.PERSPECTIVE,this.frustum=new _c,this.orthoMatrix=no()}var e=t.prototype;return e.isOrtho=function(){return this.projectionMode===Rd.ORTHOGRAPHIC},e.getProjectionMode=function(){return this.projectionMode},e.getPerspective=function(){return this.jitteredProjectionMatrix||this.projectionMatrix},e.getPerspectiveInverse=function(){return this.projectionMatrixInverse},e.getFrustum=function(){return this.frustum},e.getPosition=function(){return this.position},e.getFocalPoint=function(){return this.focalPoint},e.getDollyingStep=function(){return this.dollyingStep},e.getNear=function(){return this.near},e.getFar=function(){return this.far},e.getZoom=function(){return this.zoom},e.getOrthoMatrix=function(){return this.orthoMatrix},e.getView=function(){return this.view},e.setEnableUpdate=function(t){this.enableUpdate=t},e.setType=function(t,e){return this.type=t,this.type===Od.EXPLORING?this.setWorldRotation(!0):this.setWorldRotation(!1),this._getAngles(),this.type===Od.TRACKING&&void 0!==e&&this.setTrackingMode(e),this},e.setProjectionMode=function(t){return this.projectionMode=t,this},e.setTrackingMode=function(t){if(this.type!==Od.TRACKING)throw new Error("Impossible to set a tracking mode if the camera is not of tracking type");return this.trackingMode=t,this},e.setWorldRotation=function(t){return this.rotateWorld=t,this._getAngles(),this},e.getViewTransform=function(){return co(no(),this.matrix)},e.getWorldTransform=function(){return this.matrix},e.jitterProjectionMatrix=function(t,e){var n=yo(no(),[t,e,0]);this.jitteredProjectionMatrix=ho(no(),n,this.projectionMatrix)},e.clearJitterProjectionMatrix=function(){this.jitteredProjectionMatrix=void 0},e.setMatrix=function(t){return this.matrix=t,this._update(),this},e.setFov=function(t){return this.setPerspective(this.near,this.far,t,this.aspect),this},e.setAspect=function(t){return this.setPerspective(this.near,this.far,this.fov,t),this},e.setNear=function(t){return this.projectionMode===Rd.PERSPECTIVE?this.setPerspective(t,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,t,this.far),this},e.setFar=function(t){return this.projectionMode===Rd.PERSPECTIVE?this.setPerspective(this.near,t,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,t),this},e.setViewOffset=function(t,e,n,r,i,o){return this.aspect=t/e,void 0===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.projectionMode===Rd.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this},e.clearViewOffset=function(){return void 0!==this.view&&(this.view.enabled=!1),this.projectionMode===Rd.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this},e.setZoom=function(t){return this.zoom=t,this.projectionMode===Rd.ORTHOGRAPHIC?this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far):this.projectionMode===Rd.PERSPECTIVE&&this.setPerspective(this.near,this.far,this.fov,this.aspect),this},e.setZoomByViewportPoint=function(t,e){var n=this.canvas.viewport2Canvas({x:e[0],y:e[1]}),r=n.x,i=n.y,o=this.roll;this.rotate(0,0,-o),this.setPosition(r,i),this.setFocalPoint(r,i),this.setZoom(t),this.rotate(0,0,o);var a=this.canvas.viewport2Canvas({x:e[0],y:e[1]}),s=Bo(a.x-r,a.y-i,0),u=ta(s,this.right)/jo(this.right),c=ta(s,this.up)/jo(this.up);return this.pan(-u,-c),this},e.setPerspective=function(t,e,n,r){var i;this.projectionMode=Rd.PERSPECTIVE,this.fov=n,this.near=t,this.far=e,this.aspect=r;var o=this.near*Math.tan(vp(.5*this.fov))/this.zoom,a=2*o,s=this.aspect*a,u=-.5*s;if(null===(i=this.view)||void 0===i?void 0:i.enabled){var c=this.view.fullWidth,l=this.view.fullHeight;u+=this.view.offsetX*s/c,o-=this.view.offsetY*a/l,s*=this.view.width/c,a*=this.view.height/l}return function(t,e,n,r,i,o,a){var s=2*o/(n-e),u=2*o/(r-i),c=(n+e)/(n-e),l=(r+i)/(r-i),h=-(a+o)/(a-o),f=-2*a*o/(a-o);t[0]=s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=u,t[6]=0,t[7]=0,t[8]=c,t[9]=l,t[10]=h,t[11]=-1,t[12]=0,t[13]=0,t[14]=f,t[15]=0}(this.projectionMatrix,u,u+s,o,o-a,t,this.far),po(this.projectionMatrix,this.projectionMatrix,Bo(1,-1,1)),co(this.projectionMatrixInverse,this.projectionMatrix),this.triggerUpdate(),this},e.setOrthographic=function(t,e,n,r,i,o){var a;this.projectionMode=Rd.ORTHOGRAPHIC,this.rright=e,this.left=t,this.top=n,this.bottom=r,this.near=i,this.far=o;var s=(this.rright-this.left)/(2*this.zoom),u=(this.top-this.bottom)/(2*this.zoom),c=(this.rright+this.left)/2,l=(this.top+this.bottom)/2,h=c-s,f=c+s,p=l+u,d=l-u;if(null===(a=this.view)||void 0===a?void 0:a.enabled){var m=(this.rright-this.left)/this.view.fullWidth/this.zoom,v=(this.top-this.bottom)/this.view.fullHeight/this.zoom;f=(h+=m*this.view.offsetX)+m*this.view.width,d=(p-=v*this.view.offsetY)-v*this.view.height}return Oo(this.projectionMatrix,h,f,d,p,i,o),po(this.projectionMatrix,this.projectionMatrix,Bo(1,-1,1)),co(this.projectionMatrixInverse,this.projectionMatrix),this._getOrthoMatrix(),this.triggerUpdate(),this},e.setPosition=function(t,e,n){void 0===e&&(e=this.position[1]),void 0===n&&(n=this.position[2]);var r=mp(t,e,n);return this._setPosition(r),this.setFocalPoint(this.focalPoint),this.triggerUpdate(),this},e.setFocalPoint=function(t,e,n){void 0===e&&(e=this.focalPoint[1]),void 0===n&&(n=this.focalPoint[2]);var r=Bo(0,1,0);if(this.focalPoint=mp(t,e,n),this.trackingMode===Pd.CINEMATIC){var i=Go(Do(),this.focalPoint,this.position);t=i[0],e=i[1],n=i[2];var o=jo(i),a=gp(Math.asin(e/o)),s=90+gp(Math.atan2(n,t)),u=no();vo(u,u,vp(s)),mo(u,u,vp(a)),r=ra(Do(),[0,1,0],u)}return co(this.matrix,ko(no(),this.position,this.focalPoint,r)),this._getAxes(),this._getDistance(),this._getAngles(),this.triggerUpdate(),this},e.getDistance=function(){return this.distance},e.getDistanceVector=function(){return this.distanceVector},e.setDistance=function(t){if(this.distance===t||t<0)return this;this.distance=t,this.distance<Hd&&(this.distance=Hd),this.dollyingStep=this.distance/100;var e=Do();t=this.distance;var n=this.forward,r=this.focalPoint;return e[0]=t*n[0]+r[0],e[1]=t*n[1]+r[1],e[2]=t*n[2]+r[2],this._setPosition(e),this.triggerUpdate(),this},e.setMaxDistance=function(t){return this.maxDistance=t,this},e.setMinDistance=function(t){return this.minDistance=t,this},e.setAzimuth=function(t){return this.azimuth=dp(t),this.computeMatrix(),this._getAxes(),this.type===Od.ORBITING||this.type===Od.EXPLORING?this._getPosition():this.type===Od.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this},e.getAzimuth=function(){return this.azimuth},e.setElevation=function(t){return this.elevation=dp(t),this.computeMatrix(),this._getAxes(),this.type===Od.ORBITING||this.type===Od.EXPLORING?this._getPosition():this.type===Od.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this},e.getElevation=function(){return this.elevation},e.setRoll=function(t){return this.roll=dp(t),this.computeMatrix(),this._getAxes(),this.type===Od.ORBITING||this.type===Od.EXPLORING?this._getPosition():this.type===Od.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this},e.getRoll=function(){return this.roll},e._update=function(){this._getAxes(),this._getPosition(),this._getDistance(),this._getAngles(),this._getOrthoMatrix(),this.triggerUpdate()},e.computeMatrix=function(){var t=wa(_a(),[0,0,1],vp(this.roll));so(this.matrix);var e=wa(_a(),[1,0,0],vp((this.rotateWorld&&this.type!==Od.TRACKING||this.type===Od.TRACKING?1:-1)*this.elevation)),n=wa(_a(),[0,1,0],vp((this.rotateWorld&&this.type!==Od.TRACKING||this.type===Od.TRACKING?1:-1)*this.azimuth)),r=Sa(_a(),n,e);r=Sa(_a(),r,t);var i=Eo(no(),r);this.type===Od.ORBITING||this.type===Od.EXPLORING?(fo(this.matrix,this.matrix,this.focalPoint),ho(this.matrix,this.matrix,i),fo(this.matrix,this.matrix,[0,0,this.distance])):this.type===Od.TRACKING&&(fo(this.matrix,this.matrix,this.position),ho(this.matrix,this.matrix,i))},e._setPosition=function(t,e,n){this.position=mp(t,e,n);var r=this.matrix;r[12]=this.position[0],r[13]=this.position[1],r[14]=this.position[2],r[15]=1,this._getOrthoMatrix()},e._getAxes=function(){zo(this.right,mp(ba(ya(),[1,0,0,0],this.matrix))),zo(this.up,mp(ba(ya(),[0,1,0,0],this.matrix))),zo(this.forward,mp(ba(ya(),[0,0,1,0],this.matrix))),Qo(this.right,this.right),Qo(this.up,this.up),Qo(this.forward,this.forward)},e._getAngles=function(){var t=this.distanceVector[0],e=this.distanceVector[1],n=this.distanceVector[2],r=jo(this.distanceVector);if(0===r)return this.elevation=0,void(this.azimuth=0);this.type===Od.TRACKING||this.rotateWorld?(this.elevation=gp(Math.asin(e/r)),this.azimuth=gp(Math.atan2(-t,-n))):(this.elevation=-gp(Math.asin(e/r)),this.azimuth=-gp(Math.atan2(-t,-n)))},e._getPosition=function(){zo(this.position,mp(ba(ya(),[0,0,0,1],this.matrix))),this._getDistance()},e._getFocalPoint=function(){var t,e;ia(this.distanceVector,[0,0,-this.distance],(t=to(),e=this.matrix,t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t)),Vo(this.focalPoint,this.position,this.distanceVector),this._getDistance()},e._getDistance=function(){this.distanceVector=Go(Do(),this.focalPoint,this.position),this.distance=jo(this.distanceVector),this.dollyingStep=this.distance/100},e._getOrthoMatrix=function(){if(this.projectionMode===Rd.ORTHOGRAPHIC){var t=this.position,e=wa(_a(),[0,0,1],-this.roll*Math.PI/180);Mo(this.orthoMatrix,e,Bo((this.rright-this.left)/2-t[0],(this.top-this.bottom)/2-t[1],0),Bo(this.zoom,this.zoom,1),t)}},e.triggerUpdate=function(){if(this.enableUpdate){var t=this.getViewTransform(),e=ho(no(),this.getPerspective(),t);this.getFrustum().extractFromVPMatrix(e),this.eventEmitter.emit(Wd)}},e.rotate=function(t,e,n){throw new Error(Xc)},e.pan=function(t,e){throw new Error(Xc)},e.dolly=function(t){throw new Error(Xc)},e.createLandmark=function(t,e){throw new Error(Xc)},e.gotoLandmark=function(t,e){throw new Error(Xc)},t}(),Xd=function(){function t(){}return t.prototype.update=function(t,e){var n=t.r;return{width:2*n,height:2*n}},t}(),qd=function(){function t(){}return t.prototype.update=function(t,e){return{width:2*t.rx,height:2*t.ry}},t}(),Zd=function(){function t(){}return t.prototype.update=function(t){var e=t.x1,n=t.y1,r=t.x2,i=t.y2,o=Math.min(e,r),a=Math.max(e,r),s=Math.min(n,i);return{width:a-o,height:Math.max(n,i)-s}},t}(),$d=function(){function t(){}return t.prototype.update=function(t){var e=t.path.rect;return{width:e.width,height:e.height}},t}(),Kd=function(){function t(){}return t.prototype.update=function(t){var e=t.points.points,n=Math.min.apply(Math,e.map((function(t){return t[0]}))),r=Math.max.apply(Math,e.map((function(t){return t[0]}))),i=Math.min.apply(Math,e.map((function(t){return t[1]})));return{width:r-n,height:Math.max.apply(Math,e.map((function(t){return t[1]})))-i}},t}(),Jd=function(){function t(){}return t.prototype.update=function(t,e){var n=t.img,r=t.width,i=void 0===r?0:r,o=t.height,a=i,s=void 0===o?0:o;return n&&!$s(n)&&(a||(a=n.width,t.width=a),s||(s=n.height,t.height=s)),{width:a,height:s}},t}(),Qd=function(){function t(t){this.globalRuntime=void 0,this.globalRuntime=t}var e=t.prototype;return e.isReadyToMeasure=function(t,e){var n=t.text,r=t.textAlign,i=t.textBaseline,o=t.fontSize,a=t.fontStyle,s=t.fontWeight,u=t.fontVariant,c=t.lineWidth;return n&&o&&a&&s&&u&&r&&i&&!zs(c)},e.update=function(t,e){var n,r,i=t.text,o=t.textAlign,a=t.lineWidth,s=t.textBaseline,u=t.dx,c=t.dy,l=((null==e||null===(n=e.ownerDocument)||void 0===n||null===(r=n.defaultView)||void 0===r?void 0:r.getConfig())||{}).offscreenCanvas;if(!this.isReadyToMeasure(t,e))return t.metrics={font:"",width:0,height:0,lines:[],lineWidths:[],lineHeight:0,maxLineWidth:0,fontProperties:{ascent:0,descent:0,fontSize:0},lineMetrics:[]},{width:0,height:0,x:0,y:0,offsetX:0,offsetY:0};var h=this.globalRuntime.textService.measureText(i,t,l);t.metrics=h;var f=h.width,p=h.height,d=h.lineHeight,m=h.fontProperties,v=[f/2,p/2,0],g=[0,1],y=0;"center"===o||"middle"===o?(y=a/2,g=[.5,1]):"right"!==o&&"end"!==o||(y=a,g=[1,1]);var x=0;return"middle"===s?x=v[1]:"top"===s||"hanging"===s?x=2*v[1]:"alphabetic"===s?x=d-m.ascent:"bottom"!==s&&"ideographic"!==s||(x=0),u&&(y+=u),c&&(x+=c),t.anchor=[g[0],g[1],0],{width:2*v[0],height:2*v[1],offsetX:y,offsetY:x}},t}(),tm=function(){function t(t,e){var n=this;this.globalRuntime=void 0,this.context=void 0,this.rootTarget=void 0,this.emitter=new fc,this.cursor="default",this.mappingTable={},this.mappingState={trackingData:{}},this.eventPool=new Map,this.pickHandler=void 0,this.tmpMatrix=no(),this.tmpVec3=Do(),this.onPointerDown=function(){var t=Jc($c().mark((function t(e){var r,i;return $c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e instanceof If){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,n.createPointerEvent(e);case 4:r=t.sent,n.dispatchEvent(r,"pointerdown"),"touch"===r.pointerType?n.dispatchEvent(r,"touchstart"):"mouse"!==r.pointerType&&"pen"!==r.pointerType||(i=2===r.button,n.dispatchEvent(r,i?"rightdown":"mousedown")),n.trackingData(e.pointerId).pressTargetsByButton[e.button]=r.composedPath(),n.freeEvent(r);case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.onPointerUp=function(){var t=Jc($c().mark((function t(e){var r,i,o,a,s,u,c,l,h,f,p;return $c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e instanceof If){t.next=2;break}return t.abrupt("return");case 2:return r=performance.now(),t.next=5,n.createPointerEvent(e);case 5:if(i=t.sent,n.dispatchEvent(i,"pointerup"),"touch"===i.pointerType?n.dispatchEvent(i,"touchend"):"mouse"!==i.pointerType&&"pen"!==i.pointerType||(o=2===i.button,n.dispatchEvent(i,o?"rightup":"mouseup")),a=n.trackingData(e.pointerId),s=n.findMountedTarget(a.pressTargetsByButton[e.button]),u=s,s&&!i.composedPath().includes(s)){for(c=s;c&&!i.composedPath().includes(c);)i.currentTarget=c,n.notifyTarget(i,"pointerupoutside"),"touch"===i.pointerType?n.notifyTarget(i,"touchendoutside"):"mouse"!==i.pointerType&&"pen"!==i.pointerType||(l=2===i.button,n.notifyTarget(i,l?"rightupoutside":"mouseupoutside")),_f.isNode(c)&&(c=c.parentNode);delete a.pressTargetsByButton[e.button],u=c}u&&((f=n.clonePointerEvent(i,"click")).target=u,f.path=[],a.clicksByButton[e.button]||(a.clicksByButton[e.button]={clickCount:0,target:f.target,timeStamp:r}),(p=a.clicksByButton[e.button]).target===f.target&&r-p.timeStamp<200?++p.clickCount:p.clickCount=1,p.target=f.target,p.timeStamp=r,f.detail=p.clickCount,(null===(h=i.detail)||void 0===h?void 0:h.preventClick)||("mouse"!==f.pointerType&&"touch"!==f.pointerType||n.dispatchEvent(f,"click"),n.dispatchEvent(f,"pointertap")),n.freeEvent(f)),n.freeEvent(i);case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.onPointerMove=function(){var t=Jc($c().mark((function t(e){var r,i,o,a,s,u,c,l,h,f,p;return $c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e instanceof If){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,n.createPointerEvent(e);case 4:if(r=t.sent,i="mouse"===r.pointerType||"pen"===r.pointerType,o=n.trackingData(e.pointerId),a=n.findMountedTarget(o.overTargets),!o.overTargets||a===r.target){t.next=23;break}return s="mousemove"===e.type?"mouseout":"pointerout",t.next=12,n.createPointerEvent(e,s,a||void 0);case 12:if(u=t.sent,n.dispatchEvent(u,"pointerout"),i&&n.dispatchEvent(u,"mouseout"),r.composedPath().includes(a)){t.next=22;break}return t.next=18,n.createPointerEvent(e,"pointerleave",a||void 0);case 18:for((c=t.sent).eventPhase=c.AT_TARGET;c.target&&!r.composedPath().includes(c.target);)c.currentTarget=c.target,n.notifyTarget(c),i&&n.notifyTarget(c,"mouseleave"),_f.isNode(c.target)&&(c.target=c.target.parentNode);n.freeEvent(c);case 22:n.freeEvent(u);case 23:if(a===r.target){t.next=38;break}l="mousemove"===e.type?"mouseover":"pointerover",h=n.clonePointerEvent(r,l),n.dispatchEvent(h,"pointerover"),i&&n.dispatchEvent(h,"mouseover"),f=a&&_f.isNode(a)&&a.parentNode;case 29:if(!f||f===(_f.isNode(n.rootTarget)&&n.rootTarget.parentNode)){t.next=35;break}if(f!==r.target){t.next=32;break}return t.abrupt("break",35);case 32:f=f.parentNode,t.next=29;break;case 35:if(!f||f===(_f.isNode(n.rootTarget)&&n.rootTarget.parentNode)){for((p=n.clonePointerEvent(r,"pointerenter")).eventPhase=p.AT_TARGET;p.target&&p.target!==a&&p.target!==(_f.isNode(n.rootTarget)&&n.rootTarget.parentNode);)p.currentTarget=p.target,n.notifyTarget(p),i&&n.notifyTarget(p,"mouseenter"),_f.isNode(p.target)&&(p.target=p.target.parentNode);n.freeEvent(p)}n.freeEvent(h);case 38:n.dispatchEvent(r,"pointermove"),"touch"===r.pointerType&&n.dispatchEvent(r,"touchmove"),i&&(n.dispatchEvent(r,"mousemove"),n.cursor=n.getCursor(r.target)),o.overTargets=r.composedPath(),n.freeEvent(r);case 43:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.onPointerOut=function(){var t=Jc($c().mark((function t(e){var r,i,o,a,s;return $c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e instanceof If){t.next=2;break}return t.abrupt("return");case 2:if(!(r=n.trackingData(e.pointerId)).overTargets){t.next=19;break}return i="mouse"===e.pointerType||"pen"===e.pointerType,o=n.findMountedTarget(r.overTargets),t.next=8,n.createPointerEvent(e,"pointerout",o||void 0);case 8:return a=t.sent,n.dispatchEvent(a),i&&n.dispatchEvent(a,"mouseout"),t.next=13,n.createPointerEvent(e,"pointerleave",o||void 0);case 13:for((s=t.sent).eventPhase=s.AT_TARGET;s.target&&s.target!==(_f.isNode(n.rootTarget)&&n.rootTarget.parentNode);)s.currentTarget=s.target,n.notifyTarget(s),i&&n.notifyTarget(s,"mouseleave"),_f.isNode(s.target)&&(s.target=s.target.parentNode);r.overTargets=null,n.freeEvent(a),n.freeEvent(s);case 19:n.cursor=null;case 20:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.onPointerOver=function(){var t=Jc($c().mark((function t(e){var r,i,o,a;return $c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e instanceof If){t.next=2;break}return t.abrupt("return");case 2:return r=n.trackingData(e.pointerId),t.next=5,n.createPointerEvent(e);case 5:for(i=t.sent,o="mouse"===i.pointerType||"pen"===i.pointerType,n.dispatchEvent(i,"pointerover"),o&&n.dispatchEvent(i,"mouseover"),"mouse"===i.pointerType&&(n.cursor=n.getCursor(i.target)),(a=n.clonePointerEvent(i,"pointerenter")).eventPhase=a.AT_TARGET;a.target&&a.target!==(_f.isNode(n.rootTarget)&&n.rootTarget.parentNode);)a.currentTarget=a.target,n.notifyTarget(a),o&&n.notifyTarget(a,"mouseenter"),_f.isNode(a.target)&&(a.target=a.target.parentNode);r.overTargets=i.composedPath(),n.freeEvent(i),n.freeEvent(a);case 16:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.onPointerUpOutside=function(){var t=Jc($c().mark((function t(e){var r,i,o,a;return $c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e instanceof If){t.next=2;break}return t.abrupt("return");case 2:return r=n.trackingData(e.pointerId),i=n.findMountedTarget(r.pressTargetsByButton[e.button]),t.next=6,n.createPointerEvent(e);case 6:if(o=t.sent,i){for(a=i;a;)o.currentTarget=a,n.notifyTarget(o,"pointerupoutside"),"touch"===o.pointerType||"mouse"!==o.pointerType&&"pen"!==o.pointerType||n.notifyTarget(o,2===o.button?"rightupoutside":"mouseupoutside"),_f.isNode(a)&&(a=a.parentNode);delete r.pressTargetsByButton[e.button]}n.freeEvent(o);case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.onWheel=function(){var t=Jc($c().mark((function t(e){var r;return $c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e instanceof Nf){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,n.createWheelEvent(e);case 4:r=t.sent,n.dispatchEvent(r),n.freeEvent(r);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.globalRuntime=t,this.context=e}var e=t.prototype;return e.init=function(){this.rootTarget=this.context.renderingContext.root.parentNode,this.addEventMapping("pointerdown",this.onPointerDown),this.addEventMapping("pointerup",this.onPointerUp),this.addEventMapping("pointermove",this.onPointerMove),this.addEventMapping("pointerout",this.onPointerOut),this.addEventMapping("pointerleave",this.onPointerOut),this.addEventMapping("pointerover",this.onPointerOver),this.addEventMapping("pointerupoutside",this.onPointerUpOutside),this.addEventMapping("wheel",this.onWheel)},e.destroy=function(){this.emitter.removeAllListeners(),this.mappingTable={},this.mappingState={},this.eventPool.clear()},e.client2Viewport=function(t){var e=this.context.contextService.getBoundingClientRect();return new wc(t.x-((null==e?void 0:e.left)||0),t.y-((null==e?void 0:e.top)||0))},e.viewport2Client=function(t){var e=this.context.contextService.getBoundingClientRect();return new wc(t.x+((null==e?void 0:e.left)||0),t.y+((null==e?void 0:e.top)||0))},e.viewport2Canvas=function(t){var e=t.x,n=t.y,r=this.rootTarget.defaultView.getCamera(),i=this.context.config,o=i.width,a=i.height,s=r.getPerspectiveInverse(),u=r.getWorldTransform(),c=ho(this.tmpMatrix,u,s),l=Uo(this.tmpVec3,e/o*2-1,2*(1-n/a)-1,0);return ra(l,l,c),new wc(l[0],l[1])},e.canvas2Viewport=function(t){var e=this.rootTarget.defaultView.getCamera(),n=e.getPerspective(),r=e.getViewTransform(),i=ho(this.tmpMatrix,n,r),o=Uo(this.tmpVec3,t.x,t.y,0);ra(this.tmpVec3,this.tmpVec3,i);var a=this.context.config,s=a.width,u=a.height;return new wc((o[0]+1)/2*s,(1-(o[1]+1)/2)*u)},e.setPickHandler=function(t){this.pickHandler=t},e.addEventMapping=function(t,e){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:e,priority:0}),this.mappingTable[t].sort((function(t,e){return t.priority-e.priority}))},e.mapEvent=function(t){if(this.rootTarget){var e=this.mappingTable[t.type];if(e)for(var n=0,r=e.length;n<r;n++)e[n].fn(t)}},e.dispatchEvent=function(t,e,n){if(n){t.eventPhase=t.AT_TARGET;var r=this.rootTarget.defaultView||null;t.currentTarget=r,this.notifyListeners(t,e)}else t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,e);this.emitter.emit(e||t.type,t)},e.propagate=function(t,e){if(t.target){var n=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(var r=n.length-1;r>=1;r--)if(t.currentTarget=n[r],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,e),!t.propagationStopped&&!t.propagationImmediatelyStopped){var i=n.indexOf(t.currentTarget);t.eventPhase=t.BUBBLING_PHASE;for(var o=i+1;o<n.length;o++)if(t.currentTarget=n[o],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return}}},e.propagationPath=function(t){var e=[t],n=this.rootTarget.defaultView||null;if(n&&n===t)return e.unshift(n.document),e;for(var r=0;r<2048&&t!==this.rootTarget;r++)_f.isNode(t)&&t.parentNode&&(e.push(t.parentNode),t=t.parentNode);return n&&e.push(n),e},e.hitTest=function(){var t=Jc($c().mark((function t(e){var n,r,i,o,a;return $c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.viewportX,r=e.viewportY,i=this.context.config,o=i.width,a=i.height,!(n<0||r<0||n>o||r>a)){t.next=4;break}return t.abrupt("return",null);case 4:return t.next=6,this.pickHandler(e);case 6:if(t.t1=t.sent,t.t1){t.next=9;break}t.t1=this.rootTarget;case 9:if(t.t0=t.t1,t.t0){t.next=12;break}t.t0=null;case 12:return t.abrupt("return",t.t0);case 13:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),e.isNativeEventFromCanvas=function(t){var e,n=this.context.contextService.getDomElement(),r=null===(e=t.nativeEvent)||void 0===e?void 0:e.target;if(r){if(r===n)return!0;if(n&&n.contains)return n.contains(r)}return!!t.nativeEvent.composedPath&&t.nativeEvent.composedPath().indexOf(n)>-1},e.getExistedHTML=function(t){if(t.nativeEvent.composedPath)for(var e,n=sl(this.globalRuntime.displayObjectPool.getHTMLs());!(e=n()).done;){var r=e.value;if(t.nativeEvent.composedPath().indexOf(r)>-1)return r}return null},e.pickTarget=function(){var t=Jc($c().mark((function t(e){return $c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.hitTest({clientX:e.clientX,clientY:e.clientY,viewportX:e.viewportX,viewportY:e.viewportY,x:e.canvasX,y:e.canvasY}));case 1:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),e.createPointerEvent=function(){var t=Jc($c().mark((function t(e,n,r){var i,o;return $c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=this.allocateEvent(If),this.copyPointerData(e,i),this.copyMouseData(e,i),this.copyData(e,i),i.nativeEvent=e.nativeEvent,i.originalEvent=e,o=this.getExistedHTML(i),null==r){t.next=11;break}t.t0=r,t.next=20;break;case 11:if(t.t1=o,t.t1){t.next=19;break}if(t.t2=this.isNativeEventFromCanvas(i),!t.t2){t.next=18;break}return t.next=17,this.pickTarget(i);case 17:t.t2=t.sent;case 18:t.t1=t.t2;case 19:t.t0=t.t1;case 20:return i.target=t.t0,"string"==typeof n&&(i.type=n),t.abrupt("return",i);case 23:case"end":return t.stop()}}),t,this)})));return function(e,n,r){return t.apply(this,arguments)}}(),e.createWheelEvent=function(){var t=Jc($c().mark((function t(e){var n,r;return $c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this.allocateEvent(Nf),this.copyWheelData(e,n),this.copyMouseData(e,n),this.copyData(e,n),n.nativeEvent=e.nativeEvent,n.originalEvent=e,r=this.getExistedHTML(n),t.t0=r,t.t0){t.next=15;break}if(t.t1=this.isNativeEventFromCanvas(n),!t.t1){t.next=14;break}return t.next=13,this.pickTarget(n);case 13:t.t1=t.sent;case 14:t.t0=t.t1;case 15:return n.target=t.t0,t.abrupt("return",n);case 17:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),e.trackingData=function(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]},e.cloneWheelEvent=function(t){var e=this.allocateEvent(Nf);return e.nativeEvent=t.nativeEvent,e.originalEvent=t.originalEvent,this.copyWheelData(t,e),this.copyMouseData(t,e),this.copyData(t,e),e.target=t.target,e.path=t.composedPath().slice(),e.type=t.type,e},e.clonePointerEvent=function(t,e){var n=this.allocateEvent(If);return n.nativeEvent=t.nativeEvent,n.originalEvent=t.originalEvent,this.copyPointerData(t,n),this.copyMouseData(t,n),this.copyData(t,n),n.target=t.target,n.path=t.composedPath().slice(),n.type=null!=e?e:n.type,n},e.copyPointerData=function(t,e){t instanceof If&&e instanceof If&&(e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist)},e.copyMouseData=function(t,e){t instanceof Rf&&e instanceof Rf&&(e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.shiftKey=t.shiftKey,e.client.copyFrom(t.client),e.movement.copyFrom(t.movement),e.canvas.copyFrom(t.canvas),e.screen.copyFrom(t.screen),e.global.copyFrom(t.global),e.offset.copyFrom(t.offset))},e.copyWheelData=function(t,e){e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ},e.copyData=function(t,e){e.isTrusted=t.isTrusted,e.timeStamp=performance.now(),e.type=t.type,e.detail=t.detail,e.view=t.view,e.page.copyFrom(t.page),e.viewport.copyFrom(t.viewport)},e.allocateEvent=function(t){this.eventPool.has(t)||this.eventPool.set(t,[]);var e=this.eventPool.get(t).pop()||new t(this);return e.eventPhase=e.NONE,e.currentTarget=null,e.path=[],e.target=null,e},e.freeEvent=function(t){if(t.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");var e=t.constructor;this.eventPool.has(e)||this.eventPool.set(e,[]),this.eventPool.get(e).push(t)},e.notifyTarget=function(t,e){var n;e=null!==(n=e)&&void 0!==n?n:t.type;var r=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?e+"capture":e;this.notifyListeners(t,r),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,e)},e.notifyListeners=function(t,e){var n=t.currentTarget.emitter,r=n._events[e];if(r)if("fn"in r)r.once&&n.removeListener(e,r.fn,void 0,!0),r.fn.call(t.currentTarget||r.context,t);else for(var i=0;i<r.length&&!t.propagationImmediatelyStopped;i++)r[i].once&&n.removeListener(e,r[i].fn,void 0,!0),r[i].fn.call(t.currentTarget||r[i].context,t)},e.findMountedTarget=function(t){if(!t)return null;for(var e=t[t.length-1],n=t.length-2;n>=0;n--){var r=t[n];if(!(r===this.rootTarget||_f.isNode(r)&&r.parentNode===e))break;e=t[n]}return e},e.getCursor=function(t){for(var e=t;e;){var n=Lf.isElement(e)&&e.getAttribute("cursor");if(n)return n;e=_f.isNode(e)&&e.parentNode}},t}(),em=function(){function t(){this.canvas=void 0,this.context=void 0}var e=t.prototype;return e.getOrCreateCanvas=function(t){if(this.canvas)return this.canvas;if(t)this.canvas=t,this.context=this.canvas.getContext("2d");else try{this.canvas=new window.OffscreenCanvas(0,0),this.context=this.canvas.getContext("2d"),this.context&&this.context.measureText||(this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"))}catch(e){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d")}return this.canvas.width=10,this.canvas.height=10,this.canvas},e.getOrCreateContext=function(t){return this.context||this.getOrCreateCanvas(t),this.context},t}();(Gd=Vd||(Vd={}))[Gd.CAMERA_CHANGED=0]="CAMERA_CHANGED",Gd[Gd.DISPLAY_OBJECT_CHANGED=1]="DISPLAY_OBJECT_CHANGED",Gd[Gd.NONE=2]="NONE";var nm=function(){function t(t,e){this.globalRuntime=void 0,this.context=void 0,this.inited=!1,this.stats={total:0,rendered:0},this.zIndexCounter=0,this.renderOrderChangedEvent=new xf(Mf.RENDER_ORDER_CHANGED),this.hooks={init:new Jp,dirtycheck:new dd(["object"]),cull:new dd(["object","camera"]),beginFrame:new ud([]),beforeRender:new ud(["objectToRender"]),render:new ud(["objectToRender"]),afterRender:new ud(["objectToRender"]),endFrame:new ud([]),destroy:new ud([]),pick:new nd(["result"]),pickSync:new dd(["result"]),pointerDown:new ud(["event"]),pointerUp:new ud(["event"]),pointerMove:new ud(["event"]),pointerOut:new ud(["event"]),pointerOver:new ud(["event"]),pointerWheel:new ud(["event"]),pointerCancel:new ud(["event"])},this.globalRuntime=t,this.context=e}var e=t.prototype;return e.init=function(){var t=Jc($c().mark((function t(){var e;return $c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=el({},this.globalRuntime,this.context),this.context.renderingPlugins.forEach((function(t){t.apply(e)})),t.next=4,this.hooks.init.promise();case 4:this.inited=!0;case 5:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),e.getStats=function(){return this.stats},e.disableDirtyRectangleRendering=function(){return!this.context.config.renderer.getConfig().enableDirtyRectangleRendering||this.context.renderingContext.renderReasons.has(Vd.CAMERA_CHANGED)},e.render=function(t){var e=this;this.stats.total=0,this.stats.rendered=0,this.zIndexCounter=0;var n=this.context.renderingContext;this.globalRuntime.sceneGraphService.syncHierarchy(n.root),this.globalRuntime.sceneGraphService.triggerPendingEvents(),n.renderReasons.size&&this.inited&&(this.renderDisplayObject(n.root,t,n),this.hooks.beginFrame.call(),n.renderListCurrentFrame.forEach((function(t){e.hooks.beforeRender.call(t),e.hooks.render.call(t),e.hooks.afterRender.call(t)})),this.hooks.endFrame.call(),n.renderListCurrentFrame=[],n.renderReasons.clear())},e.renderDisplayObject=function(t,e,n){var r=this,i=e.renderer.getConfig(),o=i.enableDirtyCheck,a=i.enableCulling;this.globalRuntime.styleValueRegistry.recalc(t);var s=o?this.hooks.dirtycheck.call(t):t;if(s){var u=a?this.hooks.cull.call(s,this.context.camera):s;u&&(this.stats.rendered++,n.renderListCurrentFrame.push(u))}t.renderable.dirty=!1,t.sortable.renderOrder=this.zIndexCounter++,this.stats.total++;var c=t.sortable,l=!1;c.dirty&&(c.sorted=t.childNodes.slice().sort(Ic),l=!0,c.dirty=!1),(c.sorted||t.childNodes).forEach((function(t){r.renderDisplayObject(t,e,n)})),l&&t.forEach((function(t){r.renderOrderChangedEvent.target=t,r.renderOrderChangedEvent.detail={renderOrder:t.sortable.renderOrder},t.ownerDocument.defaultView.dispatchEvent(r.renderOrderChangedEvent,!0)}))},e.destroy=function(){this.inited=!1,this.hooks.destroy.call()},e.dirtify=function(){this.context.renderingContext.renderReasons.add(Vd.DISPLAY_OBJECT_CHANGED)},t}(),rm=/\[\s*(.*)=(.*)\s*\]/,im=function(){function t(){}var e=t.prototype;return e.selectOne=function(t,e){var n=this;if(t.startsWith("."))return e.find((function(e){return((null==e?void 0:e.classList)||[]).indexOf(n.getIdOrClassname(t))>-1}));if(t.startsWith("#"))return e.find((function(e){return e.id===n.getIdOrClassname(t)}));if(t.startsWith("[")){var r=this.getAttribute(t),i=r.name,o=r.value;return i?e.find((function(t){return e!==t&&("name"===i?t.name===o:n.attributeToString(t,i)===o)})):null}return e.find((function(n){return e!==n&&n.nodeName===t}))},e.selectAll=function(t,e){var n=this;if(t.startsWith("."))return e.findAll((function(r){return e!==r&&((null==r?void 0:r.classList)||[]).indexOf(n.getIdOrClassname(t))>-1}));if(t.startsWith("#"))return e.findAll((function(r){return e!==r&&r.id===n.getIdOrClassname(t)}));if(t.startsWith("[")){var r=this.getAttribute(t),i=r.name,o=r.value;return i?e.findAll((function(t){return e!==t&&("name"===i?t.name===o:n.attributeToString(t,i)===o)})):[]}return e.findAll((function(n){return e!==n&&n.nodeName===t}))},e.is=function(t,e){if(t.startsWith("."))return e.className===this.getIdOrClassname(t);if(t.startsWith("#"))return e.id===this.getIdOrClassname(t);if(t.startsWith("[")){var n=this.getAttribute(t),r=n.name,i=n.value;return"name"===r?e.name===i:this.attributeToString(e,r)===i}return e.nodeName===t},e.getIdOrClassname=function(t){return t.substring(1)},e.getAttribute=function(t){var e=t.match(rm),n="",r="";return e&&e.length>2&&(n=e[1].replace(/"/g,""),r=e[2].replace(/"/g,"")),{name:n,value:r}},e.attributeToString=function(t,e){if(!t.getAttribute)return"";var n=t.getAttribute(e);return zs(n)?"":n.toString?n.toString():""},t}();function om(t){var e=t.renderable;e&&(e.renderBoundsDirty=!0,e.boundsDirty=!0)}var am,sm,um,cm,lm,hm,fm=function(){function t(t){var e,n,r,i,o,a,s,u,c=this;this.runtime=void 0,this.pendingEvents=[],this.boundsChangedEvent=new xf(Mf.BOUNDS_CHANGED),this.rotate=(e=_a(),function(t,n,r,i){void 0===r&&(r=0),void 0===i&&(i=0),"number"==typeof n&&(n=Bo(n,r,i));var o=t.transformable;if(null!==t.parentNode&&t.parentNode.transformable){var a=_a();Ea(a,n[0],n[1],n[2]);var s=c.getRotation(t),u=c.getRotation(t.parentNode);Ta(e,u),Ma(e,e),Sa(a,e,a),Sa(o.localRotation,a,s),Oa(o.localRotation,o.localRotation),c.dirtifyLocal(t,o)}else c.rotateLocal(t,n)}),this.rotateLocal=(n=_a(),function(t,e,r,i){void 0===r&&(r=0),void 0===i&&(i=0),"number"==typeof e&&(e=Bo(e,r,i));var o=t.transformable;Ea(n,e[0],e[1],e[2]),Ca(o.localRotation,o.localRotation,n),c.dirtifyLocal(t,o)}),this.setEulerAngles=(r=_a(),function(t,e,n,i){void 0===n&&(n=0),void 0===i&&(i=0),"number"==typeof e&&(e=Bo(e,n,i));var o=t.transformable;if(null!==t.parentNode&&t.parentNode.transformable){Ea(o.localRotation,e[0],e[1],e[2]);var a=c.getRotation(t.parentNode);Ta(r,Ma(_a(),a)),Ca(o.localRotation,o.localRotation,r),c.dirtifyLocal(t,o)}else c.setLocalEulerAngles(t,e)}),this.translateLocal=function(t,e,n,r){void 0===n&&(n=0),void 0===r&&(r=0),"number"==typeof e&&(e=Bo(e,n,r));var i=t.transformable;sa(e,Do())||(oa(e,e,i.localRotation),Vo(i.localPosition,i.localPosition,e),c.dirtifyLocal(t,i))},this.setPosition=(i=no(),o=Do(),function(t,e){var n=t.transformable;if(o[0]=e[0],o[1]=e[1],o[2]=e[2]||0,!sa(c.getPosition(t),o)){if(zo(n.position,o),null!==t.parentNode&&t.parentNode.transformable){var r=t.parentNode.transformable;io(i,r.worldTransform),co(i,i),ra(n.localPosition,o,i)}else zo(n.localPosition,o);c.dirtifyLocal(t,n)}}),this.setLocalPosition=function(){var t=Do();return function(e,n){var r=e.transformable;t[0]=n[0],t[1]=n[1],t[2]=n[2]||0,sa(r.localPosition,t)||(zo(r.localPosition,t),c.dirtifyLocal(e,r))}}(),this.translate=(a=Do(),s=Do(),u=Do(),function(t,e,n,r){void 0===n&&(n=0),void 0===r&&(r=0),"number"==typeof e&&(e=Uo(s,e,n,r)),sa(e,a)||(Vo(u,c.getPosition(t),e),c.setPosition(t,u))}),this.setRotation=function(){var t=_a();return function(e,n,r,i,o){var a=e.transformable;if("number"==typeof n&&(n=Aa(n,r,i,o)),null!==e.parentNode&&e.parentNode.transformable){var s=c.getRotation(e.parentNode);Ta(t,s),Ma(t,t),Sa(a.localRotation,t,n),Oa(a.localRotation,a.localRotation),c.dirtifyLocal(e,a)}else c.setLocalRotation(e,n)}},this.displayObjectDependencyMap=new WeakMap,this.calcLocalTransform=function(){var t=no(),e=Do(),n=Aa(0,0,0,1);return function(r){if(0!==r.localSkew[0]||0!==r.localSkew[1]){if(Mo(r.localTransform,r.localRotation,r.localPosition,Bo(1,1,1),r.origin),0!==r.localSkew[0]||0!==r.localSkew[1]){var i=so(t);i[4]=Math.tan(r.localSkew[0]),i[1]=Math.tan(r.localSkew[1]),ho(r.localTransform,r.localTransform,i)}var o=Mo(t,n,e,r.localScale,r.origin);ho(r.localTransform,r.localTransform,o)}else Mo(r.localTransform,r.localRotation,r.localPosition,r.localScale,r.origin)}}(),this.runtime=t}var e=t.prototype;return e.matches=function(t,e){return this.runtime.sceneGraphSelector.is(t,e)},e.querySelector=function(t,e){return this.runtime.sceneGraphSelector.selectOne(t,e)},e.querySelectorAll=function(t,e){return this.runtime.sceneGraphSelector.selectAll(t,e)},e.attach=function(t,e,n){var r,i;t.parentNode&&this.detach(t),t.parentNode=e,zs(n)?t.parentNode.childNodes.push(t):t.parentNode.childNodes.splice(n,0,t);var o=e.sortable;((null==o||null===(r=o.sorted)||void 0===r?void 0:r.length)||(null===(i=t.style)||void 0===i?void 0:i.zIndex))&&(o.dirty=!0);var a=t.transformable;a&&this.dirtifyWorld(t,a),a.frozen&&this.unfreezeParentToRoot(t)},e.detach=function(t){if(t.parentNode){var e,n,r=t.transformable,i=t.parentNode.sortable;((null==i||null===(e=i.sorted)||void 0===e?void 0:e.length)||(null===(n=t.style)||void 0===n?void 0:n.zIndex))&&(i.dirty=!0);var o=t.parentNode.childNodes.indexOf(t);o>-1&&t.parentNode.childNodes.splice(o,1),r&&this.dirtifyWorld(t,r),t.parentNode=null}},e.getOrigin=function(t){return t.transformable.origin},e.setOrigin=function(t,e,n,r){void 0===n&&(n=0),void 0===r&&(r=0),"number"==typeof e&&(e=Bo(e,n,r));var i=t.transformable;if(!sa(e,i.origin)){var o=i.origin;o[0]=e[0],o[1]=e[1],o[2]=e[2]||0,this.dirtifyLocal(t,i)}},e.setLocalEulerAngles=function(t,e,n,r){void 0===n&&(n=0),void 0===r&&(r=0),"number"==typeof e&&(e=Bo(e,n,r));var i=t.transformable;Ea(i.localRotation,e[0],e[1],e[2]),this.dirtifyLocal(t,i)},e.scaleLocal=function(t,e){var n=t.transformable;Wo(n.localScale,n.localScale,Bo(e[0],e[1],e[2]||1)),this.dirtifyLocal(t,n)},e.setLocalScale=function(t,e){var n=t.transformable,r=Bo(e[0],e[1],e[2]||n.localScale[2]);sa(r,n.localScale)||(zo(n.localScale,r),this.dirtifyLocal(t,n))},e.setLocalRotation=function(t,e,n,r,i){"number"==typeof e&&(e=Aa(e,n,r,i));var o=t.transformable;Ta(o.localRotation,e),this.dirtifyLocal(t,o)},e.setLocalSkew=function(t,e,n){"number"==typeof e&&(e=Pa(e,n));var r=t.transformable;La(r.localSkew,e),this.dirtifyLocal(t,r)},e.dirtifyLocal=function(t,e){e.localDirtyFlag||(e.localDirtyFlag=!0,e.dirtyFlag||this.dirtifyWorld(t,e))},e.dirtifyWorld=function(t,e){e.dirtyFlag||this.unfreezeParentToRoot(t),this.dirtifyWorldInternal(t,e),this.dirtifyToRoot(t,!0)},e.triggerPendingEvents=function(){var t=this,e=new Set,n=function(n,r){n.isConnected&&!e.has(n.entity)&&(t.boundsChangedEvent.detail=r,t.boundsChangedEvent.target=n,n.ownerDocument.defaultView.dispatchEvent(t.boundsChangedEvent,!0),e.add(n.entity))};this.pendingEvents.forEach((function(t){var e=t[0],r=t[1];r.affectChildren?e.forEach((function(t){n(t,r)})):n(e,r)})),this.pendingEvents=[],e.clear()},e.dirtifyToRoot=function(t,e){void 0===e&&(e=!1);var n=t;for(n.renderable&&(n.renderable.dirty=!0);n;)om(n),n=n.parentNode;e&&t.forEach((function(t){om(t)})),this.informDependentDisplayObjects(t),this.pendingEvents.push([t,{affectChildren:e}])},e.updateDisplayObjectDependency=function(t,e,n,r){if(e&&e!==n){var i=this.displayObjectDependencyMap.get(e);if(i&&i[t]){var o=i[t].indexOf(r);i[t].splice(o,1)}}if(n){var a=this.displayObjectDependencyMap.get(n);a||(this.displayObjectDependencyMap.set(n,{}),a=this.displayObjectDependencyMap.get(n)),a[t]||(a[t]=[]),a[t].push(r)}},e.informDependentDisplayObjects=function(t){var e=this,n=this.displayObjectDependencyMap.get(t);n&&Object.keys(n).forEach((function(t){n[t].forEach((function(n){e.dirtifyToRoot(n,!0),n.dispatchEvent(new Tf(Mf.ATTR_MODIFIED,n,e,e,t,Tf.MODIFICATION,e,e)),n.isCustomElement&&n.isConnected&&n.attributeChangedCallback&&n.attributeChangedCallback(t,e,e)}))}))},e.getPosition=function(t){var e=t.transformable;return _o(e.position,this.getWorldTransform(t,e))},e.getRotation=function(t){var e=t.transformable;return So(e.rotation,this.getWorldTransform(t,e))},e.getScale=function(t){var e=t.transformable;return wo(e.scaling,this.getWorldTransform(t,e))},e.getWorldTransform=function(t,e){return void 0===e&&(e=t.transformable),e.localDirtyFlag||e.dirtyFlag?(t.parentNode&&t.parentNode.transformable&&this.getWorldTransform(t.parentNode),this.sync(t,e),e.worldTransform):e.worldTransform},e.getLocalPosition=function(t){return t.transformable.localPosition},e.getLocalRotation=function(t){return t.transformable.localRotation},e.getLocalScale=function(t){return t.transformable.localScale},e.getLocalSkew=function(t){return t.transformable.localSkew},e.getLocalTransform=function(t){var e=t.transformable;return e.localDirtyFlag&&(this.calcLocalTransform(e),e.localDirtyFlag=!1),e.localTransform},e.setLocalTransform=function(t,e){var n=_o(Do(),e),r=So(_a(),e),i=wo(Do(),e);this.setLocalScale(t,i),this.setLocalPosition(t,n),this.setLocalRotation(t,r)},e.resetLocalTransform=function(t){this.setLocalScale(t,[1,1,1]),this.setLocalPosition(t,[0,0,0]),this.setLocalEulerAngles(t,[0,0,0]),this.setLocalSkew(t,[0,0])},e.getTransformedGeometryBounds=function(t,e,n){void 0===e&&(e=!1);var r=this.getGeometryBounds(t,e);if(gc.isEmpty(r))return null;var i=n||new gc;return i.setFromTransformedAABB(r,this.getWorldTransform(t)),i},e.getGeometryBounds=function(t,e){void 0===e&&(e=!1);var n=t.geometry;return(e?n.renderBounds:n.contentBounds||null)||new gc},e.getBounds=function(t,e){var n=this;void 0===e&&(e=!1);var r=t.renderable;if(!r.boundsDirty&&!e&&r.bounds)return r.bounds;if(!r.renderBoundsDirty&&e&&r.renderBounds)return r.renderBounds;var i=e?r.renderBounds:r.bounds,o=this.getTransformedGeometryBounds(t,e,i);if(t.childNodes.forEach((function(t){var r=n.getBounds(t,e);r&&(o?o.add(r):(o=i||new gc).update(r.center,r.halfExtents))})),e){var a=Nc(t);if(a){var s=a.style.clipPath.getBounds(e);o?s&&(o=s.intersection(o)):o=s}}return o||(o=new gc),o&&(e?r.renderBounds=o:r.bounds=o),e?r.renderBoundsDirty=!1:r.boundsDirty=!1,o},e.getLocalBounds=function(t){if(t.parentNode){var e=no();t.parentNode.transformable&&(e=co(no(),this.getWorldTransform(t.parentNode)));var n=this.getBounds(t);if(!gc.isEmpty(n)){var r=new gc;return r.setFromTransformedAABB(n,e),r}}return this.getBounds(t)},e.getBoundingClientRect=function(t){var e,n,r,i=this.getGeometryBounds(t);gc.isEmpty(i)||(r=new gc).setFromTransformedAABB(i,this.getWorldTransform(t));var o=null===(e=t.ownerDocument)||void 0===e||null===(n=e.defaultView)||void 0===n?void 0:n.getContextService().getBoundingClientRect();if(r){var a=r.getMin(),s=a[0],u=a[1],c=r.getMax(),l=c[0],h=c[1];return new Sc(s+((null==o?void 0:o.left)||0),u+((null==o?void 0:o.top)||0),l-s,h-u)}return new Sc((null==o?void 0:o.left)||0,(null==o?void 0:o.top)||0,0,0)},e.dirtifyWorldInternal=function(t,e){var n=this;if(!e.dirtyFlag){e.dirtyFlag=!0,e.frozen=!1,t.childNodes.forEach((function(t){var e=t.transformable;e.dirtyFlag||n.dirtifyWorldInternal(t,e)}));var r=t.renderable;r&&(r.renderBoundsDirty=!0,r.boundsDirty=!0,r.dirty=!0)}},e.syncHierarchy=function(t){var e=t.transformable;if(!e.frozen){e.frozen=!0,(e.localDirtyFlag||e.dirtyFlag)&&this.sync(t,e);for(var n=t.childNodes,r=0;r<n.length;r++)this.syncHierarchy(n[r])}},e.sync=function(t,e){if(e.localDirtyFlag&&(this.calcLocalTransform(e),e.localDirtyFlag=!1),e.dirtyFlag){var n=t.parentNode,r=n&&n.transformable;null!==n&&r?ho(e.worldTransform,r.worldTransform,e.localTransform):io(e.worldTransform,e.localTransform),e.dirtyFlag=!1}},e.unfreezeParentToRoot=function(t){for(var e=t.parentNode;e;){var n=e.transformable;n&&(n.frozen=!1),e=e.parentNode}},t}(),pm={MetricsString:"|ÉqÅ",BaselineSymbol:"M",BaselineMultiplier:1.4,HeightMultiplier:2,Newlines:[10,13],BreakingSpaces:[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288]},dm=/[a-zA-Z0-9\u00C0-\u00D6\u00D8-\u00f6\u00f8-\u00ff!"#$%&'()*+,-./:;]/,mm=new RegExp(/[!%),.:;?\]}¢°·'""†‡›℃∶、。〃〆〕〗〞﹚﹜！＂％＇），．：；？！］｝～]/.source+"|"+/[!),.:;?\]}¢·–—'"•"、。〆〞〕〉》」︰︱︲︳﹐﹑﹒﹓﹔﹕﹖﹘﹚﹜！），．：；？︶︸︺︼︾﹀﹂﹗］｜｝､]/.source+"|"+/[)\]｝〕〉》」』】〙〗〟'"｠»ヽヾーァィゥェォッャュョヮヵヶぁぃぅぇぉっゃゅょゎゕゖㇰㇱㇲㇳㇴㇵㇶㇷㇸㇹㇺㇻㇼㇽㇾㇿ々〻‐゠–〜?!‼⁇⁈⁉・、:;,。.]/.source+"|"+/[!%),.:;?\]}¢°'"†‡℃〆〈《「『〕！％），．：；？］｝]/.source),vm=new RegExp(/[$(£¥·'"〈《「『【〔〖〝﹙﹛＄（．［｛￡￥]/.source+"|"+/[([{£¥'"‵〈《「『〔〝︴﹙﹛（｛︵︷︹︻︽︿﹁﹃﹏]/.source+"|"+/[([｛〔〈《「『【〘〖〝'"｟«—...‥〳〴〵]/.source+"|"+/[$([{£¥'"々〇〉》」〔＄（［｛｠￥￦#]/.source),gm=function(){function t(t){var e=this;this.runtime=void 0,this.fontMetricsCache={},this.shouldBreakByKinsokuShorui=function(t,n){return!e.isBreakingSpace(n)&&!(!t||!vm.exec(n)&&!mm.exec(t))},this.trimByKinsokuShorui=function(t){var e=[].concat(t),n=e[e.length-2];if(!n)return t;var r=n[n.length-1];return e[e.length-2]=n.slice(0,-1),e[e.length-1]=r+e[e.length-1],e},this.runtime=t}var e=t.prototype;return e.measureFont=function(t,e){if(this.fontMetricsCache[t])return this.fontMetricsCache[t];var n={ascent:0,descent:0,fontSize:0},r=this.runtime.offscreenCanvas.getOrCreateCanvas(e),i=this.runtime.offscreenCanvas.getOrCreateContext(e);i.font=t;var o=pm.MetricsString+pm.BaselineSymbol,a=Math.ceil(i.measureText(o).width),s=Math.ceil(i.measureText(pm.BaselineSymbol).width),u=pm.HeightMultiplier*s;s=s*pm.BaselineMultiplier|0,r.width=a,r.height=u,i.fillStyle="#f00",i.fillRect(0,0,a,u),i.font=t,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(o,0,s);var c=i.getImageData(0,0,a||1,u||1).data,l=c.length,h=4*a,f=0,p=0,d=!1;for(f=0;f<s;++f){for(var m=0;m<h;m+=4)if(255!==c[p+m]){d=!0;break}if(d)break;p+=h}for(n.ascent=s-f,p=l-h,d=!1,f=u;f>s;--f){for(var v=0;v<h;v+=4)if(255!==c[p+v]){d=!0;break}if(d)break;p-=h}return n.descent=f-s,n.fontSize=n.ascent+n.descent,this.fontMetricsCache[t]=n,n},e.measureText=function(t,e,n){var r=e.fontSize,i=e.wordWrap,o=e.lineHeight,a=e.lineWidth,s=e.textBaseline,u=e.textAlign,c=e.letterSpacing,l=e.textPath;e.textPathSide,e.textPathStartOffset;var h=e.leading,f=void 0===h?0:h,p=function(t){for(var e=t.fontSize,n=t.fontFamily,r=t.fontStyle,i=t.fontVariant,o=t.fontWeight,a=Js(e)&&e+"px"||"16px",s=$s(n)?n.split(","):[n],u=s.length-1;u>=0;u--){var c=s[u].trim();!vd.test(c)&&md.indexOf(c)<0&&(c='"'+c+'"'),s[u]=c}return r+" "+i+" "+o+" "+a+" "+s.join(",")}(e),d=this.measureFont(p,n);0===d.fontSize&&(d.fontSize=r,d.ascent=r);var m=this.runtime.offscreenCanvas.getOrCreateContext(n);m.font=p,e.isOverflowing=!1;var v=(i?this.wordWrap(t,e,n):t).split(/(?:\r\n|\r|\n)/),g=new Array(v.length),y=0;if(!l){for(var x=0;x<v.length;x++){var b=m.measureText(v[x]).width+(v[x].length-1)*c;g[x]=b,y=Math.max(y,b)}var _=y+a,w=o||d.fontSize+a,S=Math.max(w,d.fontSize+a)+(v.length-1)*(w+f),M=0;return"middle"===s?M=-S/2:"bottom"===s||"alphabetic"===s||"ideographic"===s?M=-S:"top"!==s&&"hanging"!==s||(M=0),{font:p,width:_,height:S,lines:v,lineWidths:g,lineHeight:w+=f,maxLineWidth:y,fontProperties:d,lineMetrics:g.map((function(t,e){var n=0;return"center"===u||"middle"===u?n-=t/2:"right"!==u&&"end"!==u||(n-=t),new Sc(n-a/2,M+e*w,t+a,w)}))}}l.getTotalLength();for(var E=0;E<v.length;E++)m.measureText(v[E]).width,v[E].length},e.setGraphemeOnPath=function(){},e.wordWrap=function(t,e,n){var r=this,i=e.wordWrapWidth,o=void 0===i?0:i,a=e.letterSpacing,s=e.maxLines,u=void 0===s?1/0:s,c=e.textOverflow,l=this.runtime.offscreenCanvas.getOrCreateContext(n),h=o+a,f="";"ellipsis"===c?f="...":c&&"clip"!==c&&(f=c);for(var p=[],d=0,m=0,v={},g=function(t){return r.getFromCache(t,a,v,l)},y=Array.from(f).reduce((function(t,e){return t+g(e)}),0),x=Array.from(t),b=0;b<x.length;b++){var _=x[b],w=t[b-1],S=t[b+1],M=g(_);if(this.isNewline(_)){if(++d>=u){e.isOverflowing=!0;break}m=0,p[d]=""}else{if(m>0&&m+M>h){if(d+1>=u){if(e.isOverflowing=!0,y>0&&y<=h){for(var E=p[d].length,A=0,T=E,C=0;C<E;C++){var O=g(p[d][C]);if(A+O+y>h){T=C;break}A+=O}p[d]=(p[d]||"").slice(0,T)+f}break}if(m=0,p[++d]="",this.isBreakingSpace(_))continue;this.canBreakInLastChar(_)||(p=this.trimToBreakable(p),m=this.sumTextWidthByCache(p[d]||"",v)),this.shouldBreakByKinsokuShorui(_,S)&&(p=this.trimByKinsokuShorui(p),m+=g(w||""))}m+=M,p[d]=(p[d]||"")+_}}return p.join("\n")},e.isBreakingSpace=function(t){return"string"==typeof t&&pm.BreakingSpaces.indexOf(t.charCodeAt(0))>=0},e.isNewline=function(t){return"string"==typeof t&&pm.Newlines.indexOf(t.charCodeAt(0))>=0},e.trimToBreakable=function(t){var e=[].concat(t),n=e[e.length-2],r=this.findBreakableIndex(n);if(-1===r||!n)return e;var i=n.slice(r,r+1),o=r+1,a=r+(this.isBreakingSpace(i)?0:1);return e[e.length-1]+=n.slice(o,n.length),e[e.length-2]=n.slice(0,a),e},e.canBreakInLastChar=function(t){return!t||!dm.test(t)},e.sumTextWidthByCache=function(t,e){return t.split("").reduce((function(t,n){if(!e[n])throw Error("cannot count the word without cache");return t+e[n]}),0)},e.findBreakableIndex=function(t){for(var e=t.length-1;e>=0;e--)if(!dm.test(t[e]))return e;return-1},e.getFromCache=function(t,e,n,r){var i=n[t];if("number"!=typeof i){var o=t.length*e;i=r.measureText(t).width+o,n[t]=i}return i},t}(),ym={},xm=(sm=new Jd,um=new Kd,(am={})[xc.CIRCLE]=new Xd,am[xc.ELLIPSE]=new qd,am[xc.RECT]=sm,am[xc.IMAGE]=sm,am[xc.GROUP]=sm,am[xc.LINE]=new Zd,am[xc.TEXT]=new Qd(ym),am[xc.POLYLINE]=um,am[xc.POLYGON]=um,am[xc.PATH]=new $d,am[xc.HTML]=null,am[xc.MESH]=null,am),bm=(lm=new Kh,hm=new tf,(cm={})[pc.PERCENTAGE]=null,cm[pc.NUMBER]=new af,cm[pc.ANGLE]=new Zh,cm[pc.DEFINED_PATH]=new $h,cm[pc.PAINT]=lm,cm[pc.COLOR]=lm,cm[pc.FILTER]=new Jh,cm[pc.LENGTH]=hm,cm[pc.LENGTH_PERCENTAGE]=hm,cm[pc.LENGTH_PERCENTAGE_12]=new ef,cm[pc.LENGTH_PERCENTAGE_14]=new nf,cm[pc.COORDINATE]=new rf,cm[pc.OFFSET_DISTANCE]=new sf,cm[pc.OPACITY_VALUE]=new uf,cm[pc.PATH]=new cf,cm[pc.LIST_OF_POINTS]=new lf,cm[pc.SHADOW_BLUR]=new hf,cm[pc.TEXT]=new ff,cm[pc.TEXT_TRANSFORM]=new pf,cm[pc.TRANSFORM]=new df,cm[pc.TRANSFORM_ORIGIN]=new mf,cm[pc.Z_INDEX]=new vf,cm[pc.MARKER]=new of,cm);ym.CameraContribution=Yd,ym.AnimationTimeline=null,ym.EasingFunction=null,ym.offscreenCanvas=new em,ym.displayObjectPool=new Xf,ym.sceneGraphSelector=new im,ym.sceneGraphService=new fm(ym),ym.textService=new gm(ym),ym.geometryUpdaterFactory=xm,ym.CSSPropertySyntaxFactory=bm,ym.styleValueRegistry=new Ud,ym.layoutRegistry=null,ym.globalThis=function(){if("undefined"!=typeof globalThis)return globalThis;if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("Unable to locate global `this`")}();var _m=function(){function t(){this.context=void 0,this.plugins=[]}var e=t.prototype;return e.addRenderingPlugin=function(t){this.plugins.push(t),this.context.renderingPlugins.push(t)},e.removeAllRenderingPlugins=function(){var t=this;this.plugins.forEach((function(e){var n=t.context.renderingPlugins.indexOf(e);n>=0&&t.context.renderingPlugins.splice(n,1)}))},t}(),wm=function(){function t(t){this.plugins=[],this.config=void 0,this.config=el({enableDirtyCheck:!0,enableCulling:!1,enableAutoRendering:!0,enableDirtyRectangleRendering:!0,enableDirtyRectangleRenderingDebug:!1},t)}var e=t.prototype;return e.registerPlugin=function(t){-1===this.plugins.findIndex((function(e){return e===t}))&&this.plugins.push(t)},e.unregisterPlugin=function(t){var e=this.plugins.findIndex((function(e){return e===t}));e>-1&&this.plugins.splice(e,1)},e.getPlugins=function(){return this.plugins},e.getPlugin=function(t){return this.plugins.find((function(e){return e.name===t}))},e.getConfig=function(){return this.config},e.setConfig=function(t){Object.assign(this.config,t)},t}(),Sm=function(){function t(t){this.strategies=void 0,this.strategies=t}return t.prototype.apply=function(e){var n=e.camera,r=e.renderingService,i=e.renderingContext,o=this.strategies;r.hooks.cull.tap(t.tag,(function(t){if(t){var e=t.cullable;return 0===o.length?e.visible=i.unculledEntities.indexOf(t.entity)>-1:e.visible=o.every((function(e){return e.isVisible(n,t)})),!t.isCulled()&&t.isVisible()?t:(t.dispatchEvent(new xf(Mf.CULLED)),null)}return t})),r.hooks.afterRender.tap(t.tag,(function(t){t.cullable.visibilityPlaneMask=-1}))},t}();Sm.tag="Culling";var Mm=function(){function t(){}return t.prototype.apply=function(e){var n=e.renderingService;n.hooks.dirtycheck.tap(t.tag,(function(t){return t?t.renderable.dirty||n.disableDirtyRectangleRendering()?t:null:t}))},t}();Mm.tag="DirtyCheck";var Em=function(){function t(){var t=this;this.autoPreventDefault=!1,this.rootPointerEvent=new If(null),this.rootWheelEvent=new Nf(null),this.context=void 0,this.onPointerMove=function(e){var n,r,i=null===(n=t.context.renderingContext.root)||void 0===n||null===(r=n.ownerDocument)||void 0===r?void 0:r.defaultView;if(!i.supportsTouchEvents||"touch"!==e.pointerType){for(var o,a=sl(t.normalizeToPointerEvent(e,i));!(o=a()).done;){var s=o.value,u=t.bootstrapEvent(t.rootPointerEvent,s,i);t.context.eventService.mapEvent(u)}t.setCursor(t.context.eventService.cursor)}}}var e=t.prototype;return e.apply=function(e){var n=this;this.context=e;var r=e.renderingService,i=this.context.renderingContext.root.ownerDocument.defaultView;this.context.eventService.setPickHandler(function(){var t=Jc($c().mark((function t(e){var r,i;return $c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.context.renderingService.hooks.pick.promise({position:e,picked:[],topmost:!0});case 2:return r=t.sent,i=r.picked,t.abrupt("return",i[0]||null);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),r.hooks.pointerWheel.tap(t.tag,(function(t){var e=n.normalizeWheelEvent(t);n.context.eventService.mapEvent(e)})),r.hooks.pointerDown.tap(t.tag,(function(t){if(!i.supportsTouchEvents||"touch"!==t.pointerType){var e=n.normalizeToPointerEvent(t,i);if(n.autoPreventDefault&&e[0].isNormalized)(t.cancelable||!("cancelable"in t))&&t.preventDefault();for(var r,o=sl(e);!(r=o()).done;){var a=r.value,s=n.bootstrapEvent(n.rootPointerEvent,a,i);n.context.eventService.mapEvent(s)}n.setCursor(n.context.eventService.cursor)}})),r.hooks.pointerUp.tap(t.tag,(function(t){if(!i.supportsTouchEvents||"touch"!==t.pointerType){var e=n.context.contextService.getDomElement(),r="outside";try{r=e&&t.target&&t.target!==e&&e.contains&&!e.contains(t.target)?"outside":""}catch(c){}for(var o,a=sl(n.normalizeToPointerEvent(t,i));!(o=a()).done;){var s=o.value,u=n.bootstrapEvent(n.rootPointerEvent,s,i);u.type+=r,n.context.eventService.mapEvent(u)}n.setCursor(n.context.eventService.cursor)}})),r.hooks.pointerMove.tap(t.tag,this.onPointerMove),r.hooks.pointerOver.tap(t.tag,this.onPointerMove),r.hooks.pointerOut.tap(t.tag,this.onPointerMove)},e.getViewportXY=function(t){var e,n,r=t.offsetX,i=t.offsetY,o=t.clientX,a=t.clientY;if(!this.context.config.supportsCSSTransform||zs(r)||zs(i)){var s=this.context.eventService.client2Viewport(new wc(o,a));e=s.x,n=s.y}else e=r,n=i;return{x:e,y:n}},e.bootstrapEvent=function(t,e,n){t.view=n,t.originalEvent=null,t.nativeEvent=e,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e);var r=this.getViewportXY(e),i=r.x,o=r.y;t.viewport.x=i,t.viewport.y=o;var a=this.context.eventService.viewport2Canvas(t.viewport),s=a.x,u=a.y;return t.canvas.x=s,t.canvas.y=u,t.global.copyFrom(t.canvas),t.offset.copyFrom(t.canvas),t.isTrusted=e.isTrusted,"pointerleave"===t.type&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=Zc[t.type]||t.type),t},e.normalizeWheelEvent=function(t){var e=this.rootWheelEvent;this.transferMouseData(e,t),e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ;var n=this.getViewportXY(t),r=n.x,i=n.y;e.viewport.x=r,e.viewport.y=i;var o=this.context.eventService.viewport2Canvas(e.viewport),a=o.x,s=o.y;return e.canvas.x=a,e.canvas.y=s,e.global.copyFrom(e.canvas),e.offset.copyFrom(e.canvas),e.nativeEvent=t,e.type=t.type,e},e.transferMouseData=function(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=performance.now(),t.type=e.type,t.altKey=e.altKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.ctrlKey=e.ctrlKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.screen.x=e.screenX,t.screen.y=e.screenY,t.relatedTarget=null},e.setCursor=function(t){this.context.contextService.applyCursorStyle(t||this.context.config.cursor||"default")},e.normalizeToPointerEvent=function(t,e){var n=[];if(e.isTouchEvent(t))for(var r=0;r<t.changedTouches.length;r++){var i=t.changedTouches[r];ou(i.button)&&(i.button=0),ou(i.buttons)&&(i.buttons=1),ou(i.isPrimary)&&(i.isPrimary=1===t.touches.length&&"touchstart"===t.type),ou(i.width)&&(i.width=i.radiusX||1),ou(i.height)&&(i.height=i.radiusY||1),ou(i.tiltX)&&(i.tiltX=0),ou(i.tiltY)&&(i.tiltY=0),ou(i.pointerType)&&(i.pointerType="touch"),ou(i.pointerId)&&(i.pointerId=i.identifier||0),ou(i.pressure)&&(i.pressure=i.force||.5),ou(i.twist)&&(i.twist=0),ou(i.tangentialPressure)&&(i.tangentialPressure=0),i.isNormalized=!0,i.type=t.type,n.push(i)}else if(e.isMouseEvent(t)){var o=t;ou(o.isPrimary)&&(o.isPrimary=!0),ou(o.width)&&(o.width=1),ou(o.height)&&(o.height=1),ou(o.tiltX)&&(o.tiltX=0),ou(o.tiltY)&&(o.tiltY=0),ou(o.pointerType)&&(o.pointerType="mouse"),ou(o.pointerId)&&(o.pointerId=1),ou(o.pressure)&&(o.pressure=.5),ou(o.twist)&&(o.twist=0),ou(o.tangentialPressure)&&(o.tangentialPressure=0),o.isNormalized=!0,n.push(o)}else n.push(t);return n},t}();Em.tag="Event";var Am,Tm,Cm=[xc.CIRCLE,xc.ELLIPSE,xc.IMAGE,xc.RECT,xc.LINE,xc.POLYLINE,xc.POLYGON,xc.TEXT,xc.PATH,xc.HTML],Om=function(){function t(){}var e=t.prototype;return e.isVisible=function(t,e){var n,r,i=e.cullable;if(!i.enable)return!0;var o=e.getRenderBounds();if(gc.isEmpty(o))return!1;var a=t.getFrustum(),s=null===(n=e.parentNode)||void 0===n||null===(r=n.cullable)||void 0===r?void 0:r.visibilityPlaneMask;return i.visibilityPlaneMask=this.computeVisibilityWithPlaneMask(e,o,s||mc.INDETERMINATE,a.planes),i.visible=i.visibilityPlaneMask!==mc.OUTSIDE,i.visible},e.computeVisibilityWithPlaneMask=function(t,e,n,r){if(n===mc.OUTSIDE||n===mc.INSIDE)return n;for(var i=mc.INSIDE,o=Cm.indexOf(t.nodeName)>-1,a=0,s=r.length;a<s;++a){var u=1<<a;if(0!=(n&u)&&(!o||4!==a&&5!==a)){var c=r[a],l=c.normal,h=c.distance;if(ta(l,e.getPositiveFarPoint(r[a]))+h<0)return mc.OUTSIDE;ta(l,e.getNegativeFarPoint(r[a]))+h<0&&(i|=u)}}return i},t}(),km=function(){function t(){this.rBush=void 0,this.toSync=new Set}var e=t.prototype;return e.apply=function(e){var n=this,r=e.renderingService,i=e.renderingContext,o=e.rBushRoot,a=i.root.ownerDocument.defaultView;this.rBush=o;var s=function(t){t.target.renderable.dirty=!0,r.dirtify()},u=function(t){var e=t.detail.affectChildren,i=t.target;e&&i.forEach((function(t){n.toSync.add(t)}));for(var o=i;o;)o.renderable&&n.toSync.add(o),o=o.parentElement;r.dirtify()},c=function(t){var e=t.target;ym.styleValueRegistry.recalc(e),ym.sceneGraphService.dirtifyToRoot(e),r.dirtify()},l=function(t){var e=t.target,i=e.rBushNode;i.aabb&&n.rBush.remove(i.aabb),n.toSync.delete(e),ym.sceneGraphService.dirtifyToRoot(e),r.dirtify()};r.hooks.init.tapPromise(t.tag,Jc($c().mark((function t(){return $c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a.addEventListener(Mf.MOUNTED,c),a.addEventListener(Mf.UNMOUNTED,l),a.addEventListener(Mf.ATTR_MODIFIED,s),a.addEventListener(Mf.BOUNDS_CHANGED,u);case 4:case"end":return t.stop()}}),t)})))),r.hooks.destroy.tap(t.tag,(function(){a.removeEventListener(Mf.MOUNTED,c),a.removeEventListener(Mf.UNMOUNTED,l),a.removeEventListener(Mf.ATTR_MODIFIED,s),a.removeEventListener(Mf.BOUNDS_CHANGED,u)})),r.hooks.endFrame.tap(t.tag,(function(){n.syncRTree()}))},e.syncRTree=function(){var t=this,e=[];Array.from(this.toSync).filter((function(t){return t.isConnected})).forEach((function(n){var r=n.rBushNode;r&&r.aabb&&t.rBush.remove(r.aabb);var i=n.getRenderBounds();if(i){var o=i.getMin(),a=o[0],s=o[1],u=i.getMax(),c=u[0],l=u[1];r.aabb||(r.aabb={}),r.aabb.id=n.entity,r.aabb.minX=a,r.aabb.minY=s,r.aabb.maxX=c,r.aabb.maxY=l}r.aabb&&(isNaN(r.aabb.maxX)||isNaN(r.aabb.maxX)||isNaN(r.aabb.minX)||isNaN(r.aabb.minY)||e.push(r.aabb))})),this.rBush.load(e),e.length=0,this.toSync.clear()},t}();km.tag="Prepare",(Tm=Am||(Am={})).READY="ready",Tm.BEFORE_RENDER="beforerender",Tm.AFTER_RENDER="afterrender",Tm.BEFORE_DESTROY="beforedestroy",Tm.AFTER_DESTROY="afterdestroy",Tm.RESIZE="resize",Tm.DIRTY_RECTANGLE="dirtyrectangle";var Pm=new xf(Mf.MOUNTED),Lm=new xf(Mf.UNMOUNTED),Rm=new xf(Am.BEFORE_RENDER),Im=new xf(Am.AFTER_RENDER),Nm=function(t){function e(e){var n;(n=t.call(this)||this).document=void 0,n.customElements=void 0,n.requestAnimationFrame=void 0,n.cancelAnimationFrame=void 0,n.devicePixelRatio=void 0,n.supportsPointerEvents=void 0,n.supportsTouchEvents=void 0,n.isTouchEvent=void 0,n.isMouseEvent=void 0,n.Element=zf,n.frameId=void 0,n.inited=!1,n.readyPromise=void 0,n.resolveReadyPromise=void 0,n.context={},n.document=new Af,n.document.defaultView=ol(n),n.customElements=new gf;var r=e.container,i=e.canvas,o=e.offscreenCanvas,a=e.width,s=e.height,u=e.devicePixelRatio,c=e.renderer,l=e.background,h=e.cursor,f=e.document,p=e.requestAnimationFrame,d=e.cancelAnimationFrame,m=e.createImage,v=e.supportsPointerEvents,g=e.supportsTouchEvents,y=e.supportsCSSTransform,x=e.isTouchEvent,b=e.isMouseEvent;!function(t,e){if(t){var n="string"==typeof t?t:t.id||Lc++;Pc[n]&&Pc[n].destroy(),Pc[n]=e}}(r,ol(n));var _=a,w=s,S=u;return i&&(S=(S=u||Rc&&window.devicePixelRatio||1)>=1?Math.ceil(S):1,_=a||function(t){var e=Dc(t,"width");return"auto"===e?t.offsetWidth:parseFloat(e)}(i)||i.width/S,w=s||function(t){var e=Dc(t,"height");return"auto"===e?t.offsetHeight:parseFloat(e)}(i)||i.height/S),n.devicePixelRatio=S,n.requestAnimationFrame=null!=p?p:Td.bind(ym.globalThis),n.cancelAnimationFrame=null!=d?d:Cd.bind(ym.globalThis),n.supportsTouchEvents=null!=g?g:"ontouchstart"in ym.globalThis,n.supportsPointerEvents=null!=v?v:!!ym.globalThis.PointerEvent,n.isTouchEvent=null!=x?x:function(t){return n.supportsTouchEvents&&t instanceof ym.globalThis.TouchEvent},n.isMouseEvent=null!=b?b:function(t){return!ym.globalThis.MouseEvent||t instanceof ym.globalThis.MouseEvent&&(!n.supportsPointerEvents||!(t instanceof ym.globalThis.PointerEvent))},n.initRenderingContext({container:r,canvas:i,width:_,height:w,renderer:c,offscreenCanvas:o,devicePixelRatio:S,cursor:h||"default",background:l||"transparent",createImage:m,document:f,supportsCSSTransform:y}),n.initDefaultCamera(_,w),Jc($c().mark((function t(){return $c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.initRenderer(c);case 2:n.dispatchEvent(new xf(Am.READY)),n.readyPromise&&n.resolveReadyPromise();case 4:case"end":return t.stop()}}),t)})))(),n}nl(e,t);var n=e.prototype;return n.initRenderingContext=function(t){this.context.config=t,this.context.renderingContext={root:this.document.documentElement,renderListCurrentFrame:[],unculledEntities:[],renderReasons:new Set,force:!1,dirty:!1}},n.initDefaultCamera=function(t,e){var n=this,r=new ym.CameraContribution;r.setType(Od.EXPLORING,Pd.DEFAULT).setPosition(t/2,e/2,500).setFocalPoint(t/2,e/2,0).setOrthographic(t/-2,t/2,e/2,e/-2,.1,1e3),r.canvas=this,r.eventEmitter.on(Wd,(function(){n.context.renderingContext.renderReasons.add(Vd.CAMERA_CHANGED)})),this.context.camera=r},n.getConfig=function(){return this.context.config},n.getRoot=function(){return this.document.documentElement},n.getCamera=function(){return this.context.camera},n.getContextService=function(){return this.context.contextService},n.getEventService=function(){return this.context.eventService},n.getRenderingService=function(){return this.context.renderingService},n.getRenderingContext=function(){return this.context.renderingContext},n.getStats=function(){return this.getRenderingService().getStats()},n.destroy=function(t,e){(void 0===t&&(t=!0),void 0===e&&(e=!1),e||this.dispatchEvent(new xf(Am.BEFORE_DESTROY)),this.frameId)&&(this.getConfig().cancelAnimationFrame||cancelAnimationFrame)(this.frameId);var n=this.getRoot();this.unmountChildren(n),t&&(this.document.destroy(),this.getEventService().destroy()),this.getRenderingService().destroy(),this.getContextService().destroy(),t&&this.context.rBushRoot&&(this.context.rBushRoot.clear(),this.context.rBushRoot=null,this.context.renderingContext.root=null),e||this.dispatchEvent(new xf(Am.AFTER_DESTROY))},n.changeSize=function(t,e){this.resize(t,e)},n.resize=function(t,e){var n=this.context.config;n.width=t,n.height=e,this.getContextService().resize(t,e);var r=this.context.camera,i=r.getProjectionMode();r.setPosition(t/2,e/2,500).setFocalPoint(t/2,e/2,0),i===Rd.ORTHOGRAPHIC?r.setOrthographic(t/-2,t/2,e/2,e/-2,r.getNear(),r.getFar()):r.setAspect(t/e),this.dispatchEvent(new xf(Am.RESIZE,{width:t,height:e}))},n.appendChild=function(t,e){return this.document.documentElement.appendChild(t,e)},n.insertBefore=function(t,e){return this.document.documentElement.insertBefore(t,e)},n.removeChild=function(t){return this.document.documentElement.removeChild(t)},n.removeChildren=function(){this.document.documentElement.removeChildren()},n.destroyChildren=function(){this.document.documentElement.destroyChildren()},n.render=function(){this.dispatchEvent(Rm),this.getRenderingService().render(this.getConfig()),this.dispatchEvent(Im)},n.run=function(){var t=this;!function e(){t.render(),t.frameId=requestAnimationFrame(e)}()},n.initRenderer=function(){var t=Jc($c().mark((function t(e){return $c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}throw new Error("Renderer is required.");case 2:return this.inited=!1,this.readyPromise=void 0,this.context.rBushRoot=new $i,this.context.renderingPlugins=[],this.context.renderingPlugins.push(new Em,new km,new Mm,new Sm([new Om])),this.loadRendererContainerModule(e),this.context.contextService=new this.context.ContextService(el({},ym,this.context)),this.context.renderingService=new nm(ym,this.context),this.context.eventService=new tm(ym,this.context),this.context.eventService.init(),t.next=14,this.context.contextService.init();case 14:return t.next=16,this.context.renderingService.init();case 16:this.inited=!0,this.getRoot().forEach((function(t){var e=t.renderable;e&&(e.renderBoundsDirty=!0,e.boundsDirty=!0,e.dirty=!0)})),this.mountChildren(this.getRoot()),e.getConfig().enableAutoRendering&&this.run();case 20:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.loadRendererContainerModule=function(t){var e=this;t.getPlugins().forEach((function(t){t.context=e.context,t.init()}))},n.setRenderer=function(){var t=Jc($c().mark((function t(e){var n,r;return $c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((n=this.getConfig()).renderer!==e){t.next=3;break}return t.abrupt("return");case 3:return r=n.renderer,n.renderer=e,this.destroy(!1,!0),[].concat(null==r?void 0:r.getPlugins()).reverse().forEach((function(t){t.destroy()})),t.next=9,this.initRenderer(e);case 9:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.setCursor=function(t){this.getConfig().cursor=t,this.getContextService().applyCursorStyle(t)},n.unmountChildren=function(t){var e=this;t.childNodes.forEach((function(t){e.unmountChildren(t)})),this.inited&&(t.isMutationObserved?t.dispatchEvent(Lm):(Lm.target=t,this.dispatchEvent(Lm,!0)),t!==this.document.documentElement&&(t.ownerDocument=null),t.isConnected=!1),t.isCustomElement&&t.disconnectedCallback&&t.disconnectedCallback()},n.mountChildren=function(t){var e=this;this.inited&&(t.isConnected||(t.ownerDocument=this.document,t.isConnected=!0,t.isMutationObserved?t.dispatchEvent(Pm):(Pm.target=t,this.dispatchEvent(Pm,!0)))),t.childNodes.forEach((function(t){e.mountChildren(t)})),t.isCustomElement&&t.connectedCallback&&t.connectedCallback()},n.client2Viewport=function(t){return this.getEventService().client2Viewport(t)},n.viewport2Client=function(t){return this.getEventService().viewport2Client(t)},n.viewport2Canvas=function(t){return this.getEventService().viewport2Canvas(t)},n.canvas2Viewport=function(t){return this.getEventService().canvas2Viewport(t)},n.getPointByClient=function(t,e){return this.client2Viewport({x:t,y:e})},n.getClientByPoint=function(t,e){return this.viewport2Client({x:t,y:e})},tl(e,[{key:"ready",get:function(){var t=this;return this.readyPromise||(this.readyPromise=new Promise((function(e){t.resolveReadyPromise=function(){e(t)}})),this.inited&&this.resolveReadyPromise()),this.readyPromise}}]),e}(bf);function Dm(t,e){return(Dm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Fm,jm,Bm,zm,Um,Vm,Gm,Wm,Hm=function(t){var e,n;function r(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))||this).landmarks=[],e.landmarkAnimationID=void 0,e}n=t,(e=r).prototype=Object.create(n.prototype),e.prototype.constructor=e,Dm(e,n);var i=r.prototype;return i.rotate=function(t,e,n){if(this.relElevation=dp(e),this.relAzimuth=dp(t),this.relRoll=dp(n),this.elevation+=this.relElevation,this.azimuth+=this.relAzimuth,this.roll+=this.relRoll,this.type===Od.EXPLORING){var r=wa(_a(),[1,0,0],vp((this.rotateWorld?1:-1)*this.relElevation)),i=wa(_a(),[0,1,0],vp((this.rotateWorld?1:-1)*this.relAzimuth)),o=wa(_a(),[0,0,1],vp(this.relRoll)),a=Sa(_a(),i,r);a=Sa(_a(),a,o);var s=Eo(no(),a);fo(this.matrix,this.matrix,[0,0,-this.distance]),ho(this.matrix,this.matrix,s),fo(this.matrix,this.matrix,[0,0,this.distance])}else{if(Math.abs(this.elevation)>90)return this;this.computeMatrix()}return this._getAxes(),this.type===Od.ORBITING||this.type===Od.EXPLORING?this._getPosition():this.type===Od.TRACKING&&this._getFocalPoint(),this._update(),this},i.pan=function(t,e){var n=mp(t,e,0),r=Fo(this.position);return Vo(r,r,qo(Do(),this.right,n[0])),Vo(r,r,qo(Do(),this.up,n[1])),this._setPosition(r),this.triggerUpdate(),this},i.dolly=function(t){var e=this.forward,n=Fo(this.position),r=this.dollyingStep,i=this.distance+t*this.dollyingStep;return r=Math.max(Math.min(i,this.maxDistance),this.minDistance)-this.distance,n[0]+=r*e[0],n[1]+=r*e[1],n[2]+=r*e[2],this._setPosition(n),this.type===Od.ORBITING||this.type===Od.EXPLORING?this._getDistance():this.type===Od.TRACKING&&Vo(this.focalPoint,n,this.distanceVector),this.triggerUpdate(),this},i.createLandmark=function(t,e){void 0===e&&(e={});var n=e,r=n.position,i=void 0===r?this.position:r,o=n.focalPoint,a=void 0===o?this.focalPoint:o,s=n.roll,u=n.zoom,c=new ym.CameraContribution;c.setType(this.type,void 0),c.setPosition(i[0],i[1]||this.position[1],i[2]||this.position[2]),c.setFocalPoint(a[0],a[1]||this.focalPoint[1],a[2]||this.focalPoint[2]),c.setRoll(s||this.roll),c.setZoom(u||this.zoom);var l={name:t,matrix:ro(c.getWorldTransform()),right:Fo(c.right),up:Fo(c.up),forward:Fo(c.forward),position:Fo(c.getPosition()),focalPoint:Fo(c.getFocalPoint()),distanceVector:Fo(c.getDistanceVector()),distance:c.getDistance(),dollyingStep:c.getDollyingStep(),azimuth:c.getAzimuth(),elevation:c.getElevation(),roll:c.getRoll(),relAzimuth:c.relAzimuth,relElevation:c.relElevation,relRoll:c.relRoll,zoom:c.getZoom()};return this.landmarks.push(l),l},i.gotoLandmark=function(t,e){var n=this;void 0===e&&(e={});var r=$s(t)?this.landmarks.find((function(e){return e.name===t})):t;if(r){var i=Js(e)?{duration:e}:e,o=i.easing,a=void 0===o?"linear":o,s=i.duration,u=void 0===s?100:s,c=i.easingFunction,l=void 0===c?void 0:c,h=i.onfinish,f=void 0===h?void 0:h;if(0===u)return this.syncFromLandmark(r),void(f&&f());void 0!==this.landmarkAnimationID&&this.canvas.cancelAnimationFrame(this.landmarkAnimationID);var p,d=r.position,m=r.focalPoint,v=r.zoom,g=r.roll,y=l||ym.EasingFunction(a),x=function(){n.setFocalPoint(m),n.setPosition(d),n.setRoll(g),n.setZoom(v),n.computeMatrix(),n.triggerUpdate(),f&&f()};this.canvas.requestAnimationFrame((function t(e){void 0===p&&(p=e);var r=e-p;if(r>u)x();else{var i,o,a=y(r/u),s=Do(),c=Do();na(s,n.focalPoint,m,a),na(c,n.position,d,a),o=n.roll*(1-a)+g*a,i=n.zoom*(1-a)+v*a,n.setFocalPoint(s),n.setPosition(c),n.setRoll(o),n.setZoom(i),fa(s,m)+fa(c,d)<=.01?x():(n.computeMatrix(),n.triggerUpdate(),r<u&&(n.landmarkAnimationID=n.canvas.requestAnimationFrame(t)))}}))}},i.syncFromLandmark=function(t){this.matrix=io(this.matrix,t.matrix),this.right=zo(this.right,t.right),this.up=zo(this.up,t.up),this.forward=zo(this.forward,t.forward),this.position=zo(this.position,t.position),this.focalPoint=zo(this.focalPoint,t.focalPoint),this.distanceVector=zo(this.distanceVector,t.distanceVector),this.azimuth=t.azimuth,this.elevation=t.elevation,this.roll=t.roll,this.relAzimuth=t.relAzimuth,this.relElevation=t.relElevation,this.relRoll=t.relRoll,this.dollyingStep=t.dollyingStep,this.distance=t.distance,this.zoom=t.zoom},r}(Yd);function Ym(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(i=r.key,o=void 0,"symbol"==typeof(o=function(t,e){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"))?o:String(o)),r)}var i,o}function Xm(t,e,n){return e&&Ym(t.prototype,e),n&&Ym(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function qm(t,e){return(qm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}ym.CameraContribution=Hm,(jm=Fm||(Fm={})).Layout="layout",jm.IntrinsicSizes="intrinsic-sizes",(zm=Bm||(Bm={}))[zm.block=0]="block",zm[zm.normal=1]="normal",(Vm=Um||(Um={}))[Vm["block-like"]=0]="block-like",Vm[Vm.manual=1]="manual",(Wm=Gm||(Gm={})).LAYOUT="display",Wm.LEFT="left",Wm.TOP="top",Wm.BOTTOM="bottom",Wm.RIGHT="right",Wm.WIDTH="width",Wm.HEIGHT="height",Wm.MIN_WIDTH="minWidth",Wm.MAX_WIDTH="maxWidth",Wm.MIN_HEIGHT="minHeight",Wm.MAX_HEIGHT="maxHeight",Wm.BOX_SIZING="boxSizing",Wm.PADDING="padding",Wm.PADDING_TOP="paddingTop",Wm.PADDING_BOTTOM="paddingBottom",Wm.PADDING_START="paddingLeft",Wm.PADDING_END="paddingRight",Wm.MARGIN="margin",Wm.MARGIN_TOP="marginTop",Wm.MARGIN_BOTTOM="marginBottom",Wm.MARGIN_START="marginLeft",Wm.MARGIN_END="marginRight",Wm.BORDER="border",Wm.BORDER_TOP="borderTop",Wm.BORDER_BOTTOM="borderBottom",Wm.BORDER_START="borderLeft",Wm.BORDER_END="borderRight",Wm.FLEX_DIRECTION="flexDirection",Wm.FLEX_WRAP="flexWrap",Wm.FLEX_FLOW="flexFlow",Wm.ALIGN_ITEMS="alignItems",Wm.ALIGN_CONTENT="alignContent",Wm.JUSTIFY_CONTENT="justifyContent",Wm.FLEX="flex",Wm.ALIGN_SELF="alignSelf",Wm.FLEX_SHRINK="flexShrink",Wm.FLEX_BASIS="flexBasis",Wm.FLEX_GROW="flexGrow",Wm.OFFSET_WIDTH="offsetWidth",Wm.OFFSET_HEIGHT="offsetHeight",Wm.ORDER="order";var Zm=function(t){var e,n;function r(e,n,r,i){var o;return(o=t.call(this,e)||this).currentTime=void 0,o.timelineTime=void 0,o.currentTime=r,o.timelineTime=i,o.target=n,o.type="finish",o.bubbles=!1,o.currentTarget=n,o.defaultPrevented=!1,o.eventPhase=o.AT_TARGET,o.timeStamp=Date.now(),o.currentTime=r,o.timelineTime=i,o}return n=t,(e=r).prototype=Object.create(n.prototype),e.prototype.constructor=e,qm(e,n),r}(yf),$m=0,Km=function(){function t(t,e){var n;this.effect=void 0,this.timeline=void 0,this.id=void 0,this.currentTimePending=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this.oldPlayState=void 0,this._holdTime=void 0,this.readyPromise=void 0,this.finishedPromise=void 0,this.resolveReadyPromise=void 0,this.rejectReadyPromise=void 0,this.resolveFinishedPromise=void 0,this.rejectFinishedPromise=void 0,this.onfinish=void 0,this.oncancel=void 0,this.onframe=void 0,this._currentTime=0,this._startTime=void 0,this._playbackRate=1,this._totalDuration=void 0,this._inEffect=void 0,this._inTimeline=!0,this.onremove=void 0,this.effect=t,t.animation=this,this.timeline=e,this.id=""+$m++,this._inEffect=!!this.effect.update(0),this._totalDuration=Number(null===(n=this.effect)||void 0===n?void 0:n.getComputedTiming().endTime),this._holdTime=0,this._paused=!1,this.oldPlayState="idle",this.updatePromises()}var e=t.prototype;return e.updatePromises=function(){var t=this.oldPlayState,e=this.pending?"pending":this.playState;return this.readyPromise&&e!==t&&("idle"===e?(this.rejectReadyPromise(),this.readyPromise=void 0):"pending"===t?this.resolveReadyPromise():"pending"===e&&(this.readyPromise=void 0)),this.finishedPromise&&e!==t&&("idle"===e?(this.rejectFinishedPromise(),this.finishedPromise=void 0):"finished"===e?this.resolveFinishedPromise():"finished"===t&&(this.finishedPromise=void 0)),this.oldPlayState=e,this.readyPromise||this.finishedPromise},e.play=function(){this.updatePromises(),this._paused=!1,(this._isFinished||this._idle)&&(this.rewind(),this._startTime=null),this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this),-1===this.timeline.animations.indexOf(this)&&this.timeline.animations.push(this),this.updatePromises()},e.pause=function(){this.updatePromises(),this.currentTime&&(this._holdTime=this.currentTime),this._isFinished||this._paused||this._idle?this._idle&&(this.rewind(),this._idle=!1):this.currentTimePending=!0,this._startTime=null,this._paused=!0,this.updatePromises()},e.finish=function(){this.updatePromises(),this._idle||(this.currentTime=this._playbackRate>0?this._totalDuration:0,this._startTime=this._totalDuration-this.currentTime,this.currentTimePending=!1,this.timeline.applyDirtiedAnimation(this),this.updatePromises())},e.cancel=function(){this.updatePromises(),this._inEffect&&(this._inEffect=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=0,this._startTime=null,this.effect.update(null),this.timeline.applyDirtiedAnimation(this),this.updatePromises())},e.reverse=function(){this.updatePromises();var t=this.currentTime;this.playbackRate*=-1,this.play(),null!==t&&(this.currentTime=t),this.updatePromises()},e.updatePlaybackRate=function(t){this.playbackRate=t},e.targetAnimations=function(){var t;return(null===(t=this.effect)||void 0===t?void 0:t.target).getAnimations()},e.markTarget=function(){var t=this.targetAnimations();-1===t.indexOf(this)&&t.push(this)},e.unmarkTarget=function(){var t=this.targetAnimations(),e=t.indexOf(this);-1!==e&&t.splice(e,1)},e.tick=function(t,e){this._idle||this._paused||(null===this._startTime?e&&(this.startTime=t-this._currentTime/this.playbackRate):this._isFinished||this.tickCurrentTime((t-this._startTime)*this.playbackRate)),e&&(this.currentTimePending=!1,this.fireEvents(t))},e.rewind=function(){if(this.playbackRate>=0)this.currentTime=0;else{if(!(this._totalDuration<1/0))throw new Error("Unable to rewind negative playback rate animation with infinite duration");this.currentTime=this._totalDuration}},e.persist=function(){throw new Error(Xc)},e.addEventListener=function(t,e,n){throw new Error(Xc)},e.removeEventListener=function(t,e,n){throw new Error(Xc)},e.dispatchEvent=function(t){throw new Error(Xc)},e.commitStyles=function(){throw new Error(Xc)},e.ensureAlive=function(){var t,e;this.playbackRate<0&&0===this.currentTime?this._inEffect=!!(null===(t=this.effect)||void 0===t?void 0:t.update(-1)):this._inEffect=!!(null===(e=this.effect)||void 0===e?void 0:e.update(this.currentTime));this._inTimeline||!this._inEffect&&this._finishedFlag||(this._inTimeline=!0,this.timeline.animations.push(this))},e.tickCurrentTime=function(t,e){t!==this._currentTime&&(this._currentTime=t,this._isFinished&&!e&&(this._currentTime=this._playbackRate>0?this._totalDuration:0),this.ensureAlive())},e.fireEvents=function(t){var e=this;if(this._isFinished){if(!this._finishedFlag){if(this.onfinish){var n=new Zm(null,this,this.currentTime,t);setTimeout((function(){e.onfinish&&e.onfinish(n)}))}this._finishedFlag=!0}}else{if(this.onframe&&"running"===this.playState){var r=new Zm(null,this,this.currentTime,t);this.onframe(r)}this._finishedFlag=!1}},Xm(t,[{key:"pending",get:function(){return null===this._startTime&&!this._paused&&0!==this.playbackRate||this.currentTimePending}},{key:"playState",get:function(){return this._idle?"idle":this._isFinished?"finished":this._paused?"paused":"running"}},{key:"ready",get:function(){var t=this;return this.readyPromise||(-1===this.timeline.animationsWithPromises.indexOf(this)&&this.timeline.animationsWithPromises.push(this),this.readyPromise=new Promise((function(e,n){t.resolveReadyPromise=function(){e(t)},t.rejectReadyPromise=function(){n(new Error)}})),this.pending||this.resolveReadyPromise()),this.readyPromise}},{key:"finished",get:function(){var t=this;return this.finishedPromise||(-1===this.timeline.animationsWithPromises.indexOf(this)&&this.timeline.animationsWithPromises.push(this),this.finishedPromise=new Promise((function(e,n){t.resolveFinishedPromise=function(){e(t)},t.rejectFinishedPromise=function(){n(new Error)}})),"finished"===this.playState&&this.resolveFinishedPromise()),this.finishedPromise}},{key:"currentTime",get:function(){return this.updatePromises(),this._idle||this.currentTimePending?null:this._currentTime},set:function(t){if(t=Number(t),!isNaN(t)){var e;if(this.timeline.restart(),!this._paused&&null!==this._startTime)this._startTime=Number(null===(e=this.timeline)||void 0===e?void 0:e.currentTime)-t/this.playbackRate;this.currentTimePending=!1,this._currentTime!==t&&(this._idle&&(this._idle=!1,this._paused=!0),this.tickCurrentTime(t,!0),this.timeline.applyDirtiedAnimation(this))}}},{key:"startTime",get:function(){return this._startTime},set:function(t){if(null!==t){if(this.updatePromises(),t=Number(t),isNaN(t))return;if(this._paused||this._idle)return;this._startTime=t,this.tickCurrentTime((Number(this.timeline.currentTime)-this._startTime)*this.playbackRate),this.timeline.applyDirtiedAnimation(this),this.updatePromises()}}},{key:"playbackRate",get:function(){return this._playbackRate},set:function(t){if(t!==this._playbackRate){this.updatePromises();var e=this.currentTime;this._playbackRate=t,this.startTime=null,"paused"!==this.playState&&"idle"!==this.playState&&(this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this)),null!==e&&(this.currentTime=e),this.updatePromises()}}},{key:"_isFinished",get:function(){return!this._idle&&(this._playbackRate>0&&Number(this._currentTime)>=this._totalDuration||this._playbackRate<0&&Number(this._currentTime)<=0)}},{key:"totalDuration",get:function(){return this._totalDuration}},{key:"_needsTick",get:function(){return this.pending||"running"===this.playState||!this._finishedFlag}}]),t}(),Jm=.1,Qm="function"==typeof Float32Array,tv=function(t,e){return 1-3*e+3*t},ev=function(t,e){return 3*e-6*t},nv=function(t){return 3*t},rv=function(t,e,n){return((tv(e,n)*t+ev(e,n))*t+nv(e))*t},iv=function(t,e,n){return 3*tv(e,n)*t*t+2*ev(e,n)*t+nv(e)},ov=function(t,e,n,r){if(!(0<=t&&t<=1&&0<=n&&n<=1))throw new Error("bezier x values must be in [0, 1] range");if(t===e&&n===r)return function(t){return t};for(var i=Qm?new Float32Array(11):new Array(11),o=0;o<11;++o)i[o]=rv(o*Jm,t,n);var a=function(e){for(var r=0,o=1;10!==o&&i[o]<=e;++o)r+=Jm;--o;var a=r+(e-i[o])/(i[o+1]-i[o])*Jm,s=iv(a,t,n);return s>=.001?function(t,e,n,r){for(var i=0;i<4;++i){var o=iv(e,n,r);if(0===o)return e;e-=(rv(e,n,r)-t)/o}return e}(e,a,t,n):0===s?a:function(t,e,n,r,i){var o,a,s=0;do{(o=rv(a=e+(n-e)/2,r,i)-t)>0?n=a:e=a}while(Math.abs(o)>1e-7&&++s<10);return a}(e,r,r+Jm,t,n)};return function(t){return 0===t||1===t?t:rv(a(t),e,r)}},av=function(t){return Math.pow(t,2)},sv=function(t){return Math.pow(t,3)},uv=function(t){return Math.pow(t,4)},cv=function(t){return Math.pow(t,5)},lv=function(t){return Math.pow(t,6)},hv=function(t){return 1-Math.cos(t*Math.PI/2)},fv=function(t){return 1-Math.sqrt(1-t*t)},pv=function(t){return t*t*(3*t-2)},dv=function(t){for(var e,n=4;t<((e=Math.pow(2,--n))-1)/11;);return 1/Math.pow(4,3-n)-7.5625*Math.pow((3*e-2)/22-t,2)},mv=function(t,e){void 0===e&&(e=[]);var n=e,r=n[0],i=void 0===r?1:r,o=n[1],a=void 0===o?.5:o,s=Ks(Number(i),1,10),u=Ks(Number(a),.1,2);return 0===t||1===t?t:-s*Math.pow(2,10*(t-1))*Math.sin((t-1-u/(2*Math.PI)*Math.asin(1/s))*(2*Math.PI)/u)},vv=function(t,e,n){void 0===e&&(e=[]);var r=e,i=r[0],o=void 0===i?1:i,a=r[1],s=void 0===a?100:a,u=r[2],c=void 0===u?10:u,l=r[3],h=void 0===l?0:l;o=Ks(o,.1,1e3),s=Ks(s,.1,1e3),c=Ks(c,.1,1e3),h=Ks(h,.1,1e3);var f=Math.sqrt(s/o),p=c/(2*Math.sqrt(s*o)),d=p<1?f*Math.sqrt(1-p*p):0,m=p<1?(p*f-h)/d:-h+f,v=n?n*t/1e3:t;return v=p<1?Math.exp(-v*p*f)*(1*Math.cos(d*v)+m*Math.sin(d*v)):(1+m*v)*Math.exp(-v*f),0===t||1===t?t:1-v},gv=function(t,e){void 0===e&&(e=[]);var n=e,r=n[0],i=void 0===r?10:r;return("start"==n[1]?Math.ceil:Math.floor)(Ks(t,0,1)*i)/i},yv=function(t,e){void 0===e&&(e=[]);var n=e,r=n[0],i=n[1],o=n[2],a=n[3];return ov(r,i,o,a)(t)},xv=ov(.42,0,1,1),bv=function(t){return function(e,n,r){return void 0===n&&(n=[]),1-t(1-e,n,r)}},_v=function(t){return function(e,n,r){return void 0===n&&(n=[]),e<.5?t(2*e,n,r)/2:1-t(-2*e+2,n,r)/2}},wv=function(t){return function(e,n,r){return void 0===n&&(n=[]),e<.5?(1-t(1-2*e,n,r))/2:(t(2*e-1,n,r)+1)/2}},Sv={steps:gv,"step-start":function(t){return gv(t,[1,"start"])},"step-end":function(t){return gv(t,[1,"end"])},linear:function(t){return t},"cubic-bezier":yv,ease:function(t){return yv(t,[.25,.1,.25,1])},in:xv,out:bv(xv),"in-out":_v(xv),"out-in":wv(xv),"in-quad":av,"out-quad":bv(av),"in-out-quad":_v(av),"out-in-quad":wv(av),"in-cubic":sv,"out-cubic":bv(sv),"in-out-cubic":_v(sv),"out-in-cubic":wv(sv),"in-quart":uv,"out-quart":bv(uv),"in-out-quart":_v(uv),"out-in-quart":wv(uv),"in-quint":cv,"out-quint":bv(cv),"in-out-quint":_v(cv),"out-in-quint":wv(cv),"in-expo":lv,"out-expo":bv(lv),"in-out-expo":_v(lv),"out-in-expo":wv(lv),"in-sine":hv,"out-sine":bv(hv),"in-out-sine":_v(hv),"out-in-sine":wv(hv),"in-circ":fv,"out-circ":bv(fv),"in-out-circ":_v(fv),"out-in-circ":wv(fv),"in-back":pv,"out-back":bv(pv),"in-out-back":_v(pv),"out-in-back":wv(pv),"in-bounce":dv,"out-bounce":bv(dv),"in-out-bounce":_v(dv),"out-in-bounce":wv(dv),"in-elastic":mv,"out-elastic":bv(mv),"in-out-elastic":_v(mv),"out-in-elastic":wv(mv),spring:vv,"spring-in":vv,"spring-out":bv(vv),"spring-in-out":_v(vv),"spring-out-in":wv(vv)},Mv=function(t){return t};function Ev(t,e){return function(n){if(n>=1)return 1;var r=1/t;return(n+=e*r)-n%r}}var Av="\\s*(-?\\d+\\.?\\d*|-?\\.\\d+)\\s*",Tv=new RegExp("cubic-bezier\\("+Av+","+Av+","+Av+","+Av+"\\)"),Cv=/steps\(\s*(\d+)\s*\)/,Ov=/steps\(\s*(\d+)\s*,\s*(start|middle|end)\s*\)/;function kv(t){var e=Tv.exec(t);if(e)return ov.apply(void 0,e.slice(1).map(Number));var n=Cv.exec(t);if(n)return Ev(Number(n[1]),0);var r=Ov.exec(t);return r?Ev(Number(r[1]),{start:1,middle:.5,end:0}[r[2]]):Sv[function(t){return(e=t,"-"===(e=e.replace(/([A-Z])/g,(function(t){return"-"+t.toLowerCase()}))).charAt(0)?e.substring(1):e).replace(/^ease-/,"").replace(/(\(|\s).+/,"").toLowerCase().trim();var e}(t)]||Sv.linear}function Pv(t){return Math.abs(function(t){var e;if(0===t.duration||0===t.iterations)return 0;return("auto"===t.duration?0:Number(t.duration))*(null!==(e=t.iterations)&&void 0!==e?e:1)}(t)/(t.playbackRate||1))}function Lv(t,e,n){var r=function(t,e,n){if(null===e)return 0;var r=n.endTime;return e<Math.min(n.delay,r)?1:e>=Math.min(n.delay+t+n.endDelay,r)?2:3}(t,e,n),i=function(t,e,n,r,i){switch(r){case 1:return"backwards"===e||"both"===e?0:null;case 3:return n-i;case 2:return"forwards"===e||"both"===e?t:null;case 0:return null}}(t,n.fill,e,r,n.delay);if(null===i)return null;var o="auto"===n.duration?0:n.duration,a=function(t,e,n,r,i){var o=i;return 0===t?1!==e&&(o+=n):o+=r/t,o}(o,r,n.iterations,i,n.iterationStart),s=function(t,e,n,r,i,o){var a=t===1/0?e%1:t%1;return 0!==a||2!==n||0===r||0===i&&0!==o||(a=1),a}(a,n.iterationStart,r,n.iterations,i,o),u=function(t,e,n,r){return 2===t&&e===1/0?1/0:1===n?Math.floor(r)-1:Math.floor(r)}(r,n.iterations,s,a),c=function(t,e,n){var r=t;if("normal"!==t&&"reverse"!==t){var i=e;"alternate-reverse"===t&&(i+=1),r="normal",i!==1/0&&i%2!=0&&(r="reverse")}return"normal"===r?n:1-n}(n.direction,u,s);return n.currentIteration=u,n.progress=c,n.easingFunction(c)}function Rv(t,e,n){var r=function(t,e){for(var n={},r=0;r<t.length;r++)for(var i in t[r])if(Iv(i)){var o={offset:t[r].offset,computedOffset:t[r].computedOffset,easing:t[r].easing,easingFunction:kv(t[r].easing)||e.easingFunction,value:t[r][i]};n[i]=n[i]||[],n[i].push(o)}return n}(t,e),i=function(t,e){var n=[];for(var r in t)for(var i=t[r],o=0;o<i.length-1;o++){var a=o,s=o+1,u=i[a].computedOffset,c=i[s].computedOffset,l=u,h=c;0===o&&(l=-1/0,0===c&&(s=a)),o===i.length-2&&(h=1/0,1===u&&(a=s)),n.push({applyFrom:l,applyTo:h,startOffset:i[a].computedOffset,endOffset:i[s].computedOffset,easingFunction:i[a].easingFunction,property:r,interpolation:Dv(r,i[a].value,i[s].value,e)})}return n.sort((function(t,e){return t.startOffset-e.startOffset})),n}(r,n);return function(t,e){if(null!==e)i.filter((function(t){return e>=t.applyFrom&&e<t.applyTo})).forEach((function(n){var r=e-n.startOffset,i=n.endOffset-n.startOffset,o=0===i?0:n.easingFunction(r/i);t.style[n.property]=n.interpolation(o)}));else for(var n in r)Iv(n)&&(t.style[n]=null)}}function Iv(t){return"offset"!==t&&"easing"!==t&&"composite"!==t&&"computedOffset"!==t}var Nv=function(t,e,n){return function(r){return n(Fv(t,e,r))}};function Dv(t,e,n,r){var i=Dd[t];if(i&&i.syntax&&i.int){var o=ym.styleValueRegistry.getPropertySyntax(i.syntax);if(o){var a=ym.styleValueRegistry.parseProperty(t,e,r),s=ym.styleValueRegistry.parseProperty(t,n,r),u=ym.styleValueRegistry.computeProperty(t,a,r),c=ym.styleValueRegistry.computeProperty(t,s,r),l=o.mixer(u,c,r);if(l){var h=Nv.apply(void 0,l);return function(t){return 0===t?e:1===t?n:h(t)}}}}return Nv(!1,!0,(function(t){return t?n:e}))}function Fv(t,e,n){if("number"==typeof t&&"number"==typeof e)return t*(1-n)+e*n;if("boolean"==typeof t&&"boolean"==typeof e||"string"==typeof t&&"string"==typeof e)return n<.5?t:e;if(Array.isArray(t)&&Array.isArray(e)&&t.length===e.length){for(var r=[],i=0;i<t.length;i++)r.push(Fv(t[i],e[i],n));return r}throw new Error("Mismatched interpolation arguments "+t+":"+e)}var jv=function(){function t(){this.delay=0,this.direction="normal",this.duration="auto",this._easing="linear",this.easingFunction=Mv,this.endDelay=0,this.fill="auto",this.iterationStart=0,this.iterations=1,this.playbackRate=void 0,this.effect=void 0,this.composite=void 0,this.activeDuration=void 0,this.endTime=void 0,this.currentIteration=null,this.progress=null}return Xm(t,[{key:"easing",get:function(){return this._easing},set:function(t){this.easingFunction=kv(t),this._easing=t}}]),t}();function Bv(t,e){if(null===t)return[];Array.isArray(t)||(t=function(t){var e=[];for(var n in t)if(!(n in["easing","offset","composite"])){var r=t[n];Array.isArray(r)||(r=[r]);for(var i=r.length,o=0;o<i;o++){if(!e[o]){var a={};"offset"in t&&(a.offset=Number(t.offset)),"easing"in t&&(a.easing=t.easing),"composite"in t&&(a.composite=t.composite),e[o]=a}void 0!==r[o]&&null!==r[o]&&(e[o][n]=r[o])}}return e.sort((function(t,e){return(t.computedOffset||0)-(e.computedOffset||0)})),e}(t));for(var n=t.map((function(t){var n={};for(var r in(null==e?void 0:e.composite)&&(n.composite="auto"),t){var i=t[r];if("offset"===r){if(null!==i){if(i=Number(i),!isFinite(i))throw new Error("Keyframe offsets must be numbers.");if(i<0||i>1)throw new Error("Keyframe offsets must be between 0 and 1.");n.computedOffset=i}}else if("composite"===r&&-1===["replace","add","accumulate","auto"].indexOf(i))throw new Error(i+" compositing is not supported");n[r]=i}return void 0===n.offset&&(n.offset=null),void 0===n.easing&&(n.easing=(null==e?void 0:e.easing)||"linear"),void 0===n.composite&&(n.composite="auto"),n})),r=!0,i=-1/0,o=0;o<n.length;o++){var a=n[o].offset;if(zs(a))r=!1;else{if(a<i)throw new TypeError("Keyframes are not loosely sorted by offset. Sort or specify offsets.");i=a}}return n=n.filter((function(t){return Number(t.offset)>=0&&Number(t.offset)<=1})),r||function(){var t,e,r=n.length;n[r-1].computedOffset=Number(null!==(t=n[r-1].offset)&&void 0!==t?t:1),r>1&&(n[0].computedOffset=Number(null!==(e=n[0].offset)&&void 0!==e?e:0));for(var i=0,o=Number(n[0].computedOffset),a=1;a<r;a++){var s=n[a].computedOffset;if(!zs(s)&&!zs(o)){for(var u=1;u<a-i;u++)n[i+u].computedOffset=o+(Number(s)-o)*u/(a-i);i=a,o=Number(s)}}}(),n}var zv="backwards|forwards|both|none".split("|"),Uv="reverse|alternate|alternate-reverse".split("|");function Vv(t,e){var n;return function(t,e){var n=new jv;return e&&(n.fill="both",n.duration="auto"),"number"!=typeof t||isNaN(t)?void 0!==t&&Object.keys(t).forEach((function(e){if(void 0!==t[e]&&null!==t[e]&&"auto"!==t[e]){if(("number"==typeof n[e]||"duration"===e)&&("number"!=typeof t[e]||isNaN(t[e])))return;if("fill"===e&&-1===zv.indexOf(t[e]))return;if("direction"===e&&-1===Uv.indexOf(t[e]))return;n[e]=t[e]}})):n.duration=t,n}(t=function(t){"number"==typeof t&&(t=isNaN(t)?{duration:"auto"}:{duration:t});return t}(null!==(n=t)&&void 0!==n?n:{duration:"auto"}),e)}var Gv=function(){function t(t,e,n){var r=this;this.composite="replace",this.iterationComposite="replace",this.target=void 0,this.animation=void 0,this.timing=void 0,this.computedTiming=void 0,this.normalizedKeyframes=void 0,this.timeFraction=void 0,this.interpolations=void 0,this.target=t,this.timing=Vv(n,!1),this.timing.effect=this,this.timing.activeDuration=Pv(this.timing),this.timing.endTime=Math.max(0,this.timing.delay+this.timing.activeDuration+this.timing.endDelay),this.normalizedKeyframes=Bv(e,this.timing),this.interpolations=Rv(this.normalizedKeyframes,this.timing,this.target),this.computedTiming=new Proxy(this.timing,{get:function(t,e){return"duration"===e?"auto"===t.duration?0:t.duration:"fill"===e?"auto"===t.fill?"none":t.fill:"localTime"===e?r.animation&&r.animation.currentTime||null:"currentIteration"===e?r.animation&&"running"===r.animation.playState?t.currentIteration||0:null:"progress"===e?r.animation&&"running"===r.animation.playState?t.progress||0:null:t[e]},set:function(){return!0}})}var e=t.prototype;return e.applyInterpolations=function(){this.interpolations(this.target,Number(this.timeFraction))},e.update=function(t){return null!==t&&(this.timeFraction=Lv(this.timing.activeDuration,t,this.timing),null!==this.timeFraction)},e.getKeyframes=function(){return this.normalizedKeyframes},e.setKeyframes=function(t){this.normalizedKeyframes=Bv(t)},e.getComputedTiming=function(){return this.computedTiming},e.getTiming=function(){return this.timing},e.updateTiming=function(t){var e=this;Object.keys(t||{}).forEach((function(n){e.timing[n]=t[n]}))},t}();function Wv(t,e){return Number(t.id)-Number(e.id)}var Hv=function(){function t(t){var e=this;this.document=void 0,this.animations=[],this.ticking=!1,this.timelineTicking=!1,this.hasRestartedThisFrame=!1,this.animationsWithPromises=[],this.inTick=!1,this.pendingEffects=[],this.currentTime=null,this.rafId=0,this.rafCallbacks=[],this.frameId=void 0,this.webAnimationsNextTick=function(t){e.currentTime=t,e.discardAnimations(),0===e.animations.length?e.timelineTicking=!1:e.requestAnimationFrame(e.webAnimationsNextTick)},this.processRafCallbacks=function(t){var n=e.rafCallbacks;e.rafCallbacks=[],t<Number(e.currentTime)&&(t=Number(e.currentTime)),e.animations.sort(Wv),e.animations=e.tick(t,!0,e.animations)[0],n.forEach((function(e){e[1](t)})),e.applyPendingEffects()},this.document=t}var e=t.prototype;return e.getAnimations=function(){return this.discardAnimations(),this.animations.slice()},e.isTicking=function(){return this.inTick},e.play=function(t,e,n){var r=new Gv(t,e,n),i=new Km(r,this);return this.animations.push(i),this.restartWebAnimationsNextTick(),i.updatePromises(),i.play(),i.updatePromises(),i},e.applyDirtiedAnimation=function(t){var e=this;if(!this.inTick){t.markTarget();var n=t.targetAnimations();n.sort(Wv),this.tick(Number(this.currentTime),!1,n.slice())[1].forEach((function(t){var n=e.animations.indexOf(t);-1!==n&&e.animations.splice(n,1)})),this.applyPendingEffects()}},e.restart=function(){return this.ticking||(this.ticking=!0,this.requestAnimationFrame((function(){})),this.hasRestartedThisFrame=!0),this.hasRestartedThisFrame},e.destroy=function(){this.document.defaultView.cancelAnimationFrame(this.frameId)},e.applyPendingEffects=function(){this.pendingEffects.forEach((function(t){null==t||t.applyInterpolations()})),this.pendingEffects=[]},e.updateAnimationsPromises=function(){this.animationsWithPromises=this.animationsWithPromises.filter((function(t){return t.updatePromises()}))},e.discardAnimations=function(){this.updateAnimationsPromises(),this.animations=this.animations.filter((function(t){return"finished"!==t.playState&&"idle"!==t.playState}))},e.restartWebAnimationsNextTick=function(){this.timelineTicking||(this.timelineTicking=!0,this.requestAnimationFrame(this.webAnimationsNextTick))},e.rAF=function(t){var e=this.rafId++;return 0===this.rafCallbacks.length&&(this.frameId=this.document.defaultView.requestAnimationFrame(this.processRafCallbacks)),this.rafCallbacks.push([e,t]),e},e.requestAnimationFrame=function(t){var e=this;return this.rAF((function(n){e.updateAnimationsPromises(),t(n),e.updateAnimationsPromises()}))},e.tick=function(t,e,n){var r,i,o=this;this.inTick=!0,this.hasRestartedThisFrame=!1,this.currentTime=t,this.ticking=!1;var a=[],s=[],u=[],c=[];return n.forEach((function(n){n.tick(t,e),n._inEffect?(s.push(n.effect),n.markTarget()):(a.push(n.effect),n.unmarkTarget()),n._needsTick&&(o.ticking=!0);var r=n._inEffect||n._needsTick;n._inTimeline=r,r?u.push(n):c.push(n)})),(r=this.pendingEffects).push.apply(r,a),(i=this.pendingEffects).push.apply(i,s),this.ticking&&this.requestAnimationFrame((function(){})),this.inTick=!1,[u,c]},t}();function Yv(t,e){return(Yv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Xv(t,e){var n=e.r;t.arc(n,n,n,0,2*Math.PI,!1)}function qv(t,e){var n=e.rx,r=e.ry;if(t.ellipse)t.ellipse(n,r,n,r,0,0,2*Math.PI,!1);else{var i=n>r?n:r,o=n>r?1:n/r,a=n>r?r/n:1;t.save(),t.scale(o,a),t.arc(0,0,i,0,2*Math.PI)}}function Zv(t,e){var n,r,i=e.x1,o=e.y1,a=e.x2,s=e.y2,u=e.defX,c=void 0===u?0:u,l=e.defY,h=void 0===l?0:l,f=e.markerStart,p=e.markerEnd,d=e.markerStartOffset,m=e.markerEndOffset,v=0,g=0,y=0,x=0,b=0;f&&f instanceof zf&&d&&(n=a-i,r=s-o,b=Math.atan2(r,n),v=Math.cos(b)*(d||0),g=Math.sin(b)*(d||0)),p&&p instanceof zf&&m&&(n=i-a,r=o-s,b=Math.atan2(r,n),y=Math.cos(b)*(m||0),x=Math.sin(b)*(m||0)),t.moveTo(i-c+v,o-h+g),t.lineTo(a-c+y,s-h+x)}function $v(t,e){var n,r,i=e.defX,o=void 0===i?0:i,a=e.defY,s=void 0===a?0:a,u=e.markerStart,c=e.markerEnd,l=e.markerStartOffset,h=e.markerEndOffset,f=e.path,p=f.absolutePath,d=f.segments,m=0,v=0,g=0,y=0,x=0;if(u&&u instanceof zf&&l){var b=u.parentNode.getStartTangent(),_=b[0],w=b[1];n=_[0]-w[0],r=_[1]-w[1],x=Math.atan2(r,n),m=Math.cos(x)*(l||0),v=Math.sin(x)*(l||0)}if(c&&c instanceof zf&&h){var S=c.parentNode.getEndTangent(),M=S[0],E=S[1];n=M[0]-E[0],r=M[1]-E[1],x=Math.atan2(r,n),g=Math.cos(x)*(h||0),y=Math.sin(x)*(h||0)}for(var A=0;A<p.length;A++){var T=p[A],C=T[0],O=p[A+1],k=0===A&&(0!==m||0!==v),P=(A===p.length-1||O&&("M"===O[0]||"Z"===O[0]))&&0!==g&&0!==y;switch(C){case"M":k?(t.moveTo(T[1]-o+m,T[2]-s+v),t.lineTo(T[1]-o,T[2]-s)):t.moveTo(T[1]-o,T[2]-s);break;case"L":P?t.lineTo(T[1]-o+g,T[2]-s+y):t.lineTo(T[1]-o,T[2]-s);break;case"Q":t.quadraticCurveTo(T[1]-o,T[2]-s,T[3]-o,T[4]-s),P&&t.lineTo(T[3]-o+g,T[4]-s+y);break;case"C":t.bezierCurveTo(T[1]-o,T[2]-s,T[3]-o,T[4]-s,T[5]-o,T[6]-s),P&&t.lineTo(T[5]-o+g,T[6]-s+y);break;case"A":var L=d[A].arcParams,R=L.cx,I=L.cy,N=L.rx,D=L.ry,F=L.startAngle,j=L.endAngle,B=L.xRotation,z=L.sweepFlag;if(t.ellipse)t.ellipse(R-o,I-s,N,D,B,F,j,!!(1-z));else{var U=N>D?N:D,V=N>D?1:N/D,G=N>D?D/N:1;t.translate(R-o,I-s),t.rotate(B),t.scale(V,G),t.arc(0,0,U,F,j,!!(1-z)),t.scale(1/V,1/G),t.rotate(-B),t.translate(-(R-o),-(I-s))}P&&t.lineTo(T[6]-o+g,T[7]-s+y);break;case"Z":t.closePath()}}}function Kv(t,e){var n,r,i=e.defX,o=void 0===i?0:i,a=e.defY,s=void 0===a?0:a,u=e.markerStart,c=e.markerEnd,l=e.markerStartOffset,h=e.markerEndOffset,f=e.points.points,p=f.length,d=f[0][0]-o,m=f[0][1]-s,v=f[p-1][0]-o,g=f[p-1][1]-s,y=0,x=0,b=0,_=0,w=0;u&&u instanceof zf&&l&&(n=f[1][0]-f[0][0],r=f[1][1]-f[0][1],w=Math.atan2(r,n),y=Math.cos(w)*(l||0),x=Math.sin(w)*(l||0)),c&&c instanceof zf&&h&&(n=f[p-1][0]-f[0][0],r=f[p-1][1]-f[0][1],w=Math.atan2(r,n),b=Math.cos(w)*(h||0),_=Math.sin(w)*(h||0)),t.moveTo(d+(y||b),m+(x||_));for(var S=1;S<p-1;S++){var M=f[S];t.lineTo(M[0]-o,M[1]-s)}t.lineTo(v,g)}function Jv(t,e){var n,r,i=e.defX,o=void 0===i?0:i,a=e.defY,s=void 0===a?0:a,u=e.markerStart,c=e.markerEnd,l=e.markerStartOffset,h=e.markerEndOffset,f=e.points.points,p=f.length,d=f[0][0]-o,m=f[0][1]-s,v=f[p-1][0]-o,g=f[p-1][1]-s,y=0,x=0,b=0,_=0,w=0;u&&u instanceof zf&&l&&(n=f[1][0]-f[0][0],r=f[1][1]-f[0][1],w=Math.atan2(r,n),y=Math.cos(w)*(l||0),x=Math.sin(w)*(l||0)),c&&c instanceof zf&&h&&(n=f[p-2][0]-f[p-1][0],r=f[p-2][1]-f[p-1][1],w=Math.atan2(r,n),b=Math.cos(w)*(h||0),_=Math.sin(w)*(h||0)),t.moveTo(d+y,m+x);for(var S=1;S<p-1;S++){var M=f[S];t.lineTo(M[0]-o,M[1]-s)}t.lineTo(v+b,g+_)}function Qv(t,e){var n=e.radius,r=e.width,i=e.height,o=r,a=i;if(n&&n.some((function(t){return 0!==t}))){var s=r>0?1:-1,u=i>0?1:-1,c=s+u===0,l=n.map((function(t){return Ks(t,0,Math.min(Math.abs(o)/2,Math.abs(a)/2))})),h=l[0],f=l[1],p=l[2],d=l[3];t.moveTo(s*h,0),t.lineTo(o-s*f,0),0!==f&&t.arc(o-s*f,u*f,f,-u*Math.PI/2,s>0?0:Math.PI,c),t.lineTo(o,a-u*p),0!==p&&t.arc(o-s*p,a-u*p,p,s>0?0:Math.PI,u>0?Math.PI/2:1.5*Math.PI,c),t.lineTo(s*d,a),0!==d&&t.arc(s*d,a-u*d,d,u>0?Math.PI/2:-Math.PI/2,s>0?Math.PI:0,c),t.lineTo(0,u*h),0!==h&&t.arc(s*h,u*h,h,s>0?Math.PI:0,u>0?1.5*Math.PI:Math.PI/2,c)}else t.rect(0,0,o,a)}ym.EasingFunction=kv,ym.AnimationTimeline=Hv;var tg=function(t){var e,n;function r(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))||this).name="canvas-path-generator",e}n=t,(e=r).prototype=Object.create(n.prototype),e.prototype.constructor=e,Yv(e,n);var i=r.prototype;return i.init=function(){var t,e=((t={})[xc.CIRCLE]=Xv,t[xc.ELLIPSE]=qv,t[xc.RECT]=Qv,t[xc.LINE]=Zv,t[xc.POLYLINE]=Jv,t[xc.POLYGON]=Kv,t[xc.PATH]=$v,t[xc.TEXT]=void 0,t[xc.GROUP]=void 0,t[xc.IMAGE]=void 0,t[xc.HTML]=void 0,t[xc.MESH]=void 0,t);this.context.pathGeneratorFactory=e},i.destroy=function(){delete this.context.pathGeneratorFactory},r}(_m);function eg(){eg=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(C){u=function(t,e,n){return t[e]=n}}function c(t,e,n,i){var o=e&&e.prototype instanceof f?e:f,a=Object.create(o.prototype),s=new E(i||[]);return r(a,"_invoke",{value:_(t,n,s)}),a}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(C){return{type:"throw",arg:C}}}t.wrap=c;var h={};function f(){}function p(){}function d(){}var m={};u(m,o,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(A([])));g&&g!==e&&n.call(g,o)&&(m=g);var y=d.prototype=f.prototype=Object.create(m);function x(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function i(r,o,a,s){var u=l(t[r],t,o);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){i("next",t,a,s)}),(function(t){i("throw",t,a,s)})):e.resolve(h).then((function(t){c.value=t,a(c)}),(function(t){return i("throw",t,a,s)}))}s(u.arg)}var o;r(this,"_invoke",{value:function(t,n){function r(){return new e((function(e,r){i(t,n,e,r)}))}return o=o?o.then(r,r):r()}})}function _(t,e,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return{value:void 0,done:!0}}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=w(a,n);if(s){if(s===h)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=l(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===h)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}function w(t,e){var n=e.method,r=t.iterator[n];if(void 0===r)return e.delegate=null,"throw"===n&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=l(r,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,h;var o=i.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function M(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function E(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function A(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:T}}function T(){return{value:void 0,done:!0}}return p.prototype=d,r(y,"constructor",{value:d,configurable:!0}),r(d,"constructor",{value:p,configurable:!0}),p.displayName=u(d,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(y),t},t.awrap=function(t){return{__await:t}},x(b.prototype),u(b.prototype,a,(function(){return this})),t.AsyncIterator=b,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new b(c(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},x(y),u(y,s,"Generator"),u(y,o,(function(){return this})),u(y,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},t.values=A,E.prototype={constructor:E,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(M),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),u=n.call(o,"finallyLoc");if(s&&u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,h):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),M(n),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;M(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:A(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),h}},t}function ng(t,e,n,r,i,o,a){try{var s=t[o](a),u=s.value}catch(c){return void n(c)}s.done?e(u):Promise.resolve(u).then(r,i)}function rg(t,e){return(rg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function ig(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function og(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return ig(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ig(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var ag=Do(),sg=Do(),ug=Do(),cg=no(),lg=function(){function t(){var t=this;this.canvasConfig=void 0,this.pathGeneratorFactory=void 0,this.pointInPathPickerFactory=void 0,this.isHit=function(e,n,r,i){var o=t.pointInPathPickerFactory[e.nodeName];if(o){var a=co(cg,r),s=ra(sg,Uo(ug,n[0],n[1],0),a),u=e.getGeometryBounds().halfExtents,c=e.parsedStyle.anchor;if(s[0]+=(c&&c[0]||0)*u[0]*2,s[1]+=(c&&c[1]||0)*u[1]*2,o(e,new wc(s[0],s[1]),i,t.isPointInPath))return!0}return!1},this.isPointInPath=function(e,n){var r=ym.offscreenCanvas.getOrCreateContext(t.canvasConfig.offscreenCanvas),i=t.pathGeneratorFactory[e.nodeName];return i&&(r.beginPath(),i(r,e.parsedStyle),r.closePath()),r.isPointInPath(n.x,n.y)}}var e=t.prototype;return e.apply=function(e){var n,r=this,i=e.config,o=e.renderingService,a=e.renderingContext,s=e.pathGeneratorFactory,u=e.pointInPathPickerFactory;this.canvasConfig=i,this.pathGeneratorFactory=s,this.pointInPathPickerFactory=u;var c=null===(n=a.root)||void 0===n?void 0:n.ownerDocument;o.hooks.pick.tapPromise(t.tag,function(){var t,e=(t=eg().mark((function t(e){return eg().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",r.pick(c,e));case 1:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function a(t){ng(o,r,i,a,s,"next",t)}function s(t){ng(o,r,i,a,s,"throw",t)}a(void 0)}))});return function(t){return e.apply(this,arguments)}}()),o.hooks.pickSync.tap(t.tag,(function(t){return r.pick(c,t)}))},e.pick=function(t,e){for(var n,r=e.topmost,i=e.position,o=i.x,a=i.y,s=Uo(ag,o,a,0),u=[],c=og(t.elementsFromBBox(s[0],s[1],s[0],s[1]));!(n=c()).done;){var l=n.value,h=l.getWorldTransform();if(this.isHit(l,s,h,!1)){var f=Nc(l);if(f){var p=f.parsedStyle.clipPath;if(this.isHit(p,s,p.getWorldTransform(),!0)){if(r)return e.picked=[l],e;u.push(l)}}else{if(r)return e.picked=[l],e;u.push(l)}}}return e.picked=u,e},t}();function hg(t,e,n,r){var i=t-n,o=e-r;return Math.sqrt(i*i+o*o)}function fg(t,e){return Math.abs(t-e)<.001}function pg(t,e){var n=Math.min.apply(Math,t),r=Math.min.apply(Math,e);return{x:n,y:r,width:Math.max.apply(Math,t)-n,height:Math.max.apply(Math,e)-r}}function dg(t){return(t+2*Math.PI)%(2*Math.PI)}lg.tag="CanvasPicker";var mg=function(t,e,n,r,i){return{x:(1-i)*t+i*n,y:(1-i)*e+i*r}},vg=function(t,e,n,r,i,o){var a=[n-t,r-e];if(Wa(a,[0,0]))return Math.sqrt((i-t)*(i-t)+(o-e)*(o-e));var s=[-a[1],a[0]];za(s,s);var u=[i-t,o-e];return Math.abs(Ua(u,s))};function gg(t,e,n,r,i,o){var a=-1,s=1/0,u=[n,r],c=20;o&&o>200&&(c=o/10);for(var l=1/c,h=l/10,f=0;f<=c;f++){var p=f*l,d=[i.apply(void 0,t.concat([p])),i.apply(void 0,e.concat([p]))],m=hg(u[0],u[1],d[0],d[1]);m<s&&(a=p,s=m)}if(0===a)return{x:t[0],y:e[0]};if(1===a){var v=t.length;return{x:t[v-1],y:e[v-1]}}s=1/0;for(var g=0;g<32&&!(h<1e-4);g++){var y=a-h,x=a+h,b=[i.apply(void 0,t.concat([y])),i.apply(void 0,e.concat([y]))],_=hg(u[0],u[1],b[0],b[1]);if(y>=0&&_<s)a=y,s=_;else{var w=[i.apply(void 0,t.concat([x])),i.apply(void 0,e.concat([x]))],S=hg(u[0],u[1],w[0],w[1]);x<=1&&S<s?(a=x,s=S):h*=.5}}return{x:i.apply(void 0,t.concat([a])),y:i.apply(void 0,e.concat([a]))}}function yg(t,e,n,r){var i=1-r;return i*i*t+2*r*i*e+r*r*n}function xg(t,e,n){var r=t+n-2*e;if(fg(r,0))return[.5];var i=(t-e)/r;return i<=1&&i>=0?[i]:[]}function bg(t,e,n,r){return 2*(1-r)*(e-t)+2*r*(n-e)}function _g(t,e,n,r,i,o,a){var s=yg(t,n,i,a),u=yg(e,r,o,a),c=mg(t,e,n,r,a),l=mg(n,r,i,o,a);return[[t,e,c.x,c.y,s,u],[s,u,l.x,l.y,i,o]]}function wg(t,e,n,r,i,o,a){if(0===a)return(hg(t,e,n,r)+hg(n,r,i,o)+hg(t,e,i,o))/2;var s=_g(t,e,n,r,i,o,.5),u=s[0],c=s[1];return u.push(a-1),c.push(a-1),wg.apply(void 0,u)+wg.apply(void 0,c)}var Sg={box:function(t,e,n,r,i,o){var a=xg(t,n,i)[0],s=xg(e,r,o)[0],u=[t,i],c=[e,o];return void 0!==a&&u.push(yg(t,n,i,a)),void 0!==s&&c.push(yg(e,r,o,s)),pg(u,c)},length:function(t,e,n,r,i,o){return wg(t,e,n,r,i,o,3)},nearestPoint:function(t,e,n,r,i,o,a,s){return gg([t,n,i],[e,r,o],a,s,yg)},pointDistance:function(t,e,n,r,i,o,a,s){var u=this.nearestPoint(t,e,n,r,i,o,a,s);return hg(u.x,u.y,a,s)},interpolationAt:yg,pointAt:function(t,e,n,r,i,o,a){return{x:yg(t,n,i,a),y:yg(e,r,o,a)}},divide:function(t,e,n,r,i,o,a){return _g(t,e,n,r,i,o,a)},tangentAngle:function(t,e,n,r,i,o,a){var s=bg(t,n,i,a),u=bg(e,r,o,a);return dg(Math.atan2(u,s))}};function Mg(t,e,n,r,i){var o=1-i;return o*o*o*t+3*e*i*o*o+3*n*i*i*o+r*i*i*i}function Eg(t,e,n,r,i){var o=1-i;return 3*(o*o*(e-t)+2*o*i*(n-e)+i*i*(r-n))}function Ag(t,e,n,r){var i,o,a,s=-3*t+9*e-9*n+3*r,u=6*t-12*e+6*n,c=3*e-3*t,l=[];if(fg(s,0))fg(u,0)||(i=-c/u)>=0&&i<=1&&l.push(i);else{var h=u*u-4*s*c;fg(h,0)?l.push(-u/(2*s)):h>0&&(o=(-u-(a=Math.sqrt(h)))/(2*s),(i=(-u+a)/(2*s))>=0&&i<=1&&l.push(i),o>=0&&o<=1&&l.push(o))}return l}function Tg(t,e,n,r,i,o,a,s,u){var c=Mg(t,n,i,a,u),l=Mg(e,r,o,s,u),h=mg(t,e,n,r,u),f=mg(n,r,i,o,u),p=mg(i,o,a,s,u),d=mg(h.x,h.y,f.x,f.y,u),m=mg(f.x,f.y,p.x,p.y,u);return[[t,e,h.x,h.y,d.x,d.y,c,l],[c,l,m.x,m.y,p.x,p.y,a,s]]}function Cg(t,e,n,r,i,o,a,s,u){if(0===u)return function(t,e){for(var n=0,r=t.length,i=0;i<r;i++)n+=hg(t[i],e[i],t[(i+1)%r],e[(i+1)%r]);return n/2}([t,n,i,a],[e,r,o,s]);var c=Tg(t,e,n,r,i,o,a,s,.5),l=[].concat(c[0],[u-1]),h=[].concat(c[1],[u-1]);return Cg.apply(void 0,l)+Cg.apply(void 0,h)}var Og={extrema:Ag,box:function(t,e,n,r,i,o,a,s){for(var u=[t,a],c=[e,s],l=Ag(t,n,i,a),h=Ag(e,r,o,s),f=0;f<l.length;f++)u.push(Mg(t,n,i,a,l[f]));for(var p=0;p<h.length;p++)c.push(Mg(e,r,o,s,h[p]));return pg(u,c)},length:function(t,e,n,r,i,o,a,s){return Cg(t,e,n,r,i,o,a,s,3)},nearestPoint:function(t,e,n,r,i,o,a,s,u,c,l){return gg([t,n,i,a],[e,r,o,s],u,c,Mg,l)},pointDistance:function(t,e,n,r,i,o,a,s,u,c,l){var h=this.nearestPoint(t,e,n,r,i,o,a,s,u,c,l);return hg(h.x,h.y,u,c)},interpolationAt:Mg,pointAt:function(t,e,n,r,i,o,a,s,u){return{x:Mg(t,n,i,a,u),y:Mg(e,r,o,s,u)}},divide:function(t,e,n,r,i,o,a,s,u){return Tg(t,e,n,r,i,o,a,s,u)},tangentAngle:function(t,e,n,r,i,o,a,s,u){var c=Eg(t,n,i,a,u),l=Eg(e,r,o,s,u);return dg(Math.atan2(l,c))}};function kg(t,e,n,r){var i=t-n,o=e-r;return Math.sqrt(i*i+o*o)}function Pg(t,e,n,r,i,o){return i>=t&&i<=t+n&&o>=e&&o<=e+r}function Lg(t,e,n,r,i,o,a,s){var u=(Math.atan2(s-e,a-t)+2*Math.PI)%(2*Math.PI),c={x:t+n*Math.cos(u),y:e+n*Math.sin(u)};return kg(c.x,c.y,a,s)<=o/2}function Rg(t,e,n,r,i,o,a){var s=Math.min(t,n),u=Math.max(t,n),c=Math.min(e,r),l=Math.max(e,r),h=i/2;return o>=s-h&&o<=u+h&&a>=c-h&&a<=l+h&&vg(t,e,n,r,o,a)<=i/2}function Ig(t,e,n,r,i){var o=t.length;if(o<2)return!1;for(var a=0;a<o-1;a++){if(Rg(t[a][0],t[a][1],t[a+1][0],t[a+1][1],e,n,r))return!0}if(i){var s=t[0],u=t[o-1];if(Rg(s[0],s[1],u[0],u[1],e,n,r))return!0}return!1}function Ng(t){return Math.abs(t)<1e-6?0:t<0?-1:1}function Dg(t,e,n){return(n[0]-t[0])*(e[1]-t[1])==(e[0]-t[0])*(n[1]-t[1])&&Math.min(t[0],e[0])<=n[0]&&n[0]<=Math.max(t[0],e[0])&&Math.min(t[1],e[1])<=n[1]&&n[1]<=Math.max(t[1],e[1])}function Fg(t,e,n){var r=!1,i=t.length;if(i<=2)return!1;for(var o=0;o<i;o++){var a=t[o],s=t[(o+1)%i];if(Dg(a,s,[e,n]))return!0;Ng(a[1]-n)>0!=Ng(s[1]-n)>0&&Ng(e-(n-a[1])*(a[0]-s[0])/(a[1]-s[1])-a[0])<0&&(r=!r)}return r}function jg(t,e,n){for(var r=!1,i=0;i<t.length;i++){if(r=Fg(t[i],e,n))break}return r}function Bg(t,e,n){var r=t.parsedStyle,i=r.r,o=r.fill,a=r.stroke,s=r.lineWidth,u=r.increasedLineWidthForHitTesting,c=r.pointerEvents,l=((s||0)+(u||0))/2,h=kg(i,i,e.x,e.y),f=Gp(c,o,a),p=f[0],d=f[1];return p&&d||n?h<=i+l:p?h<=i:!!d&&(h>=i-l&&h<=i+l)}function zg(t,e,n,r){return t/(n*n)+e/(r*r)}function Ug(t,e,n){var r=t.parsedStyle,i=r.rx,o=r.ry,a=r.fill,s=r.stroke,u=r.lineWidth,c=r.increasedLineWidthForHitTesting,l=r.pointerEvents,h=e.x,f=e.y,p=Gp(l,a,s),d=p[0],m=p[1],v=((u||0)+(c||0))/2,g=(h-i)*(h-i),y=(f-o)*(f-o);return d&&m||n?zg(g,y,i+v,o+v)<=1:d?zg(g,y,i,o)<=1:!!m&&(zg(g,y,i-v,o-v)>=1&&zg(g,y,i+v,o+v)<=1)}function Vg(t,e,n){var r=t.parsedStyle,i=r.x1,o=r.y1,a=r.x2,s=r.y2,u=r.lineWidth,c=r.increasedLineWidthForHitTesting,l=r.defX,h=void 0===l?0:l,f=r.defY,p=void 0===f?0:f;return!(!Gp(r.pointerEvents,r.fill,r.stroke)[1]&&!n||!u)&&Rg(i,o,a,s,(u||0)+(c||0),e.x+h,e.y+p)}function Gg(t,e,n,r){var i=t.parsedStyle,o=i.lineWidth,a=i.increasedLineWidthForHitTesting,s=i.stroke,u=i.fill,c=i.defX,l=void 0===c?0:c,h=i.defY,f=void 0===h?0:h,p=i.path,d=Gp(i.pointerEvents,u,s),m=d[0],v=d[1],g=p.segments,y=p.hasArc,x=p.polylines,b=p.polygons,_=kp(t),w=!1;return m||n?w=y?r(t,e):jg(b,e.x+l,e.y+f)||jg(x,e.x+l,e.y+f):((v||n)&&(w=function(t,e,n,r,i){for(var o=!1,a=e/2,s=0;s<t.length;s++){var u=t[s],c=u.currentPoint,l=u.params,h=u.prePoint,f=u.box;if(!f||Pg(f.x-a,f.y-a,f.width+e,f.height+e,n,r))switch(u.command){case"L":case"Z":if(o=Rg(h[0],h[1],c[0],c[1],e,n,r))return!0;break;case"Q":if(o=Sg.pointDistance(h[0],h[1],l[1],l[2],l[3],l[4],n,r)<=e/2)return!0;break;case"C":if(o=Og.pointDistance(h[0],h[1],l[1],l[2],l[3],l[4],l[5],l[6],n,r,i)<=e/2)return!0;break;case"A":u.cubicParams||(u.cubicParams=bs(h[0],h[1],l[1],l[2],l[3],l[4],l[5],l[6],l[7],void 0));for(var p=u.cubicParams,d=h,m=0;m<p.length;m+=6){var v=Og.pointDistance(d[0],d[1],p[m],p[m+1],p[m+2],p[m+3],p[m+4],p[m+5],n,r,i);if(d=[p[m+4],p[m+5]],o=v<=e/2)return!0}}}return o}(g,(o||0)+(a||0),e.x+l,e.y+f,_)),w)}function Wg(t,e,n){var r=t.parsedStyle,i=r.stroke,o=r.fill,a=r.lineWidth,s=r.increasedLineWidthForHitTesting,u=r.points,c=r.defX,l=void 0===c?0:c,h=r.defY,f=void 0===h?0:h,p=Gp(r.pointerEvents,o,i),d=p[0],m=!1;return(p[1]||n)&&(m=Ig(u.points,(a||0)+(s||0),e.x+l,e.y+f,!0)),m||!d&&!n||(m=Fg(u.points,e.x+l,e.y+f)),m}function Hg(t,e,n){var r=t.parsedStyle,i=r.lineWidth,o=r.increasedLineWidthForHitTesting,a=r.points,s=r.defX,u=void 0===s?0:s,c=r.defY,l=void 0===c?0:c;return!(!Gp(r.pointerEvents,r.fill,r.stroke)[1]&&!n||!i)&&Ig(a.points,(i||0)+(o||0),e.x+u,e.y+l,!1)}function Yg(t,e,n,r){var i=t.parsedStyle,o=i.radius,a=i.fill,s=i.stroke,u=i.lineWidth,c=i.increasedLineWidthForHitTesting,l=i.width,h=i.height,f=Gp(i.pointerEvents,a,s),p=f[0],d=f[1],m=(u||0)+(c||0);if(o&&o.some((function(t){return 0!==t}))){var v=!1;return(d||n)&&(v=function(t,e,n,r,i,o,a,s){var u=i[0],c=i[1],l=i[2],h=i[3];return Rg(t+u,e,t+n-c,e,o,a,s)||Rg(t+n,e+c,t+n,e+r-l,o,a,s)||Rg(t+n-l,e+r,t+h,e+r,o,a,s)||Rg(t,e+r-h,t,e+u,o,a,s)||Lg(t+n-c,e+c,c,Math.PI,Math.PI,o,a,s)||Lg(t+n-l,e+r-l,l,0,Math.PI,o,a,s)||Lg(t+h,e+r-h,h,Math.PI,Math.PI,o,a,s)||Lg(t+u,e+u,u,Math.PI,Math.PI,o,a,s)}(0,0,l,h,o.map((function(t){return Ks(t,0,Math.min(Math.abs(l)/2,Math.abs(h)/2))})),m,e.x,e.y)),v||!p&&!n||(v=r(t,e)),v}var g=m/2;return p&&d||n?Pg(0-g,0-g,l+g,h+g,e.x,e.y):p?Pg(0,0,l,h,e.x,e.y):!!d&&function(t,e,n,r,i,o,a){var s=i/2;return Pg(t-s,e-s,n,i,o,a)||Pg(t+n-s,e-s,i,r,o,a)||Pg(t+s,e+r-s,n,i,o,a)||Pg(t-s,e+s,i,r,o,a)}(0,0,l,h,m,e.x,e.y)}var Xg=function(t){var e,n;function r(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))||this).name="canvas-picker",e}n=t,(e=r).prototype=Object.create(n.prototype),e.prototype.constructor=e,rg(e,n);var i=r.prototype;return i.init=function(){var t,e=function(){return!0},n=((t={})[xc.CIRCLE]=Bg,t[xc.ELLIPSE]=Ug,t[xc.RECT]=Yg,t[xc.LINE]=Vg,t[xc.POLYLINE]=Hg,t[xc.POLYGON]=Wg,t[xc.PATH]=Gg,t[xc.TEXT]=e,t[xc.GROUP]=null,t[xc.IMAGE]=e,t[xc.HTML]=null,t[xc.MESH]=null,t);this.context.pointInPathPickerFactory=n,this.addRenderingPlugin(new lg)},i.destroy=function(){delete this.context.pointInPathPickerFactory,this.removeAllRenderingPlugins()},r}(_m);function qg(){qg=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(C){u=function(t,e,n){return t[e]=n}}function c(t,e,n,i){var o=e&&e.prototype instanceof f?e:f,a=Object.create(o.prototype),s=new E(i||[]);return r(a,"_invoke",{value:_(t,n,s)}),a}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(C){return{type:"throw",arg:C}}}t.wrap=c;var h={};function f(){}function p(){}function d(){}var m={};u(m,o,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(A([])));g&&g!==e&&n.call(g,o)&&(m=g);var y=d.prototype=f.prototype=Object.create(m);function x(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function i(r,o,a,s){var u=l(t[r],t,o);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){i("next",t,a,s)}),(function(t){i("throw",t,a,s)})):e.resolve(h).then((function(t){c.value=t,a(c)}),(function(t){return i("throw",t,a,s)}))}s(u.arg)}var o;r(this,"_invoke",{value:function(t,n){function r(){return new e((function(e,r){i(t,n,e,r)}))}return o=o?o.then(r,r):r()}})}function _(t,e,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return{value:void 0,done:!0}}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=w(a,n);if(s){if(s===h)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=l(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===h)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}function w(t,e){var n=e.method,r=t.iterator[n];if(void 0===r)return e.delegate=null,"throw"===n&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=l(r,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,h;var o=i.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function M(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function E(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function A(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:T}}function T(){return{value:void 0,done:!0}}return p.prototype=d,r(y,"constructor",{value:d,configurable:!0}),r(d,"constructor",{value:p,configurable:!0}),p.displayName=u(d,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(y),t},t.awrap=function(t){return{__await:t}},x(b.prototype),u(b.prototype,a,(function(){return this})),t.AsyncIterator=b,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new b(c(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},x(y),u(y,s,"Generator"),u(y,o,(function(){return this})),u(y,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},t.values=A,E.prototype={constructor:E,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(M),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),u=n.call(o,"finallyLoc");if(s&&u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,h):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),M(n),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;M(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:A(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),h}},t}function Zg(t,e,n,r,i,o,a){try{var s=t[o](a),u=s.value}catch(c){return void n(c)}s.done?e(u):Promise.resolve(u).then(r,i)}function $g(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function a(t){Zg(o,r,i,a,s,"next",t)}function s(t){Zg(o,r,i,a,s,"throw",t)}a(void 0)}))}}function Kg(){return Kg=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Kg.apply(this,arguments)}function Jg(t,e){return(Jg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Qg=function(){function t(t){this.canvasRendererPluginOptions=void 0,this.context=void 0,this.pathGeneratorFactory=void 0,this.rBush=void 0,this.removedRBushNodeAABBs=[],this.renderQueue=[],this.restoreStack=[],this.clearFullScreen=!1,this.vpMatrix=no(),this.dprMatrix=no(),this.tmpMat4=no(),this.vec3a=Do(),this.vec3b=Do(),this.vec3c=Do(),this.vec3d=Do(),this.canvasRendererPluginOptions=t}var e=t.prototype;return e.apply=function(e){var n=this;this.context=e;var r=e.config,i=e.camera,o=e.renderingService,a=e.renderingContext,s=e.rBushRoot,u=e.pathGeneratorFactory;this.rBush=s,this.pathGeneratorFactory=u;var c=e.contextService,l=a.root.ownerDocument.defaultView,h=function(t){var e=t.target.rBushNode;e.aabb&&n.removedRBushNodeAABBs.push(e.aabb)},f=function(t){var e=t.target.rBushNode;e.aabb&&n.removedRBushNodeAABBs.push(e.aabb)};o.hooks.init.tapPromise(t.tag,$g(qg().mark((function t(){var e,i,o,a;return qg().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:l.addEventListener(Mf.UNMOUNTED,h),l.addEventListener(Mf.CULLED,f),e=c.getDPR(),i=r.width,o=r.height,a=c.getContext(),n.clearRect(a,0,0,i*e,o*e,r.background);case 6:case"end":return t.stop()}}),t)})))),o.hooks.destroy.tap(t.tag,(function(){l.removeEventListener(Mf.UNMOUNTED,h),l.removeEventListener(Mf.CULLED,f)})),o.hooks.beginFrame.tap(t.tag,(function(){var t=c.getContext(),e=c.getDPR(),i=r.width,a=r.height,s=n.canvasRendererPluginOptions,u=s.dirtyObjectNumThreshold,l=s.dirtyObjectRatioThreshold,h=o.getStats(),f=h.total,p=h.rendered,d=p/f;n.clearFullScreen=o.disableDirtyRectangleRendering()||p>u&&d>l,t&&(t.resetTransform(),n.clearFullScreen&&n.clearRect(t,0,0,i*e,a*e,r.background))}));var p=function t(e,r){e.isVisible()&&!e.isCulled()&&(n.renderDisplayObject(e,r,n.context,n.restoreStack),n.saveDirtyAABB(e)),(e.sortable.sorted||e.childNodes).forEach((function(e){t(e,r)}))};o.hooks.endFrame.tap(t.tag,(function(){var t=c.getContext(),e=c.getDPR();if(xo(n.dprMatrix,Bo(e,e,1)),ho(n.vpMatrix,n.dprMatrix,i.getOrthoMatrix()),n.clearFullScreen)p(a.root,t);else{var o=n.safeMergeAABB.apply(n,[n.mergeDirtyAABBs(n.renderQueue)].concat(n.removedRBushNodeAABBs.map((function(t){var e=t.minX,n=t.minY,r=t.maxX,i=t.maxY,o=new gc;return o.setMinMax(Bo(e,n,0),Bo(r,i,0)),o}))));if(n.removedRBushNodeAABBs=[],gc.isEmpty(o))return void(n.renderQueue=[]);var s=n.convertAABB2Rect(o),u=s.x,h=s.y,f=s.width,d=s.height,m=ra(n.vec3a,Bo(u,h,0),n.vpMatrix),v=ra(n.vec3b,Bo(u+f,h,0),n.vpMatrix),g=ra(n.vec3c,Bo(u,h+d,0),n.vpMatrix),y=ra(n.vec3d,Bo(u+f,h+d,0),n.vpMatrix),x=Math.min(m[0],v[0],y[0],g[0]),b=Math.min(m[1],v[1],y[1],g[1]),_=Math.max(m[0],v[0],y[0],g[0]),w=Math.max(m[1],v[1],y[1],g[1]),S=Math.floor(x),M=Math.floor(b),E=Math.ceil(_-x),A=Math.ceil(w-b);t.save(),n.clearRect(t,S,M,E,A,r.background),t.beginPath(),t.rect(S,M,E,A),t.clip(),t.setTransform(n.vpMatrix[0],n.vpMatrix[1],n.vpMatrix[4],n.vpMatrix[5],n.vpMatrix[12],n.vpMatrix[13]),r.renderer.getConfig().enableDirtyRectangleRenderingDebug&&l.dispatchEvent(new xf(Am.DIRTY_RECTANGLE,{dirtyRect:{x:S,y:M,width:E,height:A}})),n.searchDirtyObjects(o).sort((function(t,e){return t.sortable.renderOrder-e.sortable.renderOrder})).forEach((function(e){e&&e.isVisible()&&!e.isCulled()&&n.renderDisplayObject(e,t,n.context,n.restoreStack)})),t.restore(),n.renderQueue.forEach((function(t){n.saveDirtyAABB(t)})),n.renderQueue=[]}n.restoreStack.forEach((function(){t.restore()})),n.restoreStack=[]})),o.hooks.render.tap(t.tag,(function(t){n.clearFullScreen||n.renderQueue.push(t)}))},e.clearRect=function(t,e,n,r,i,o){t.clearRect(e,n,r,i),o&&(t.fillStyle=o,t.fillRect(e,n,r,i))},e.renderDisplayObject=function(t,e,n,r){var i=t.nodeName,o=r[r.length-1];!o||t.compareDocumentPosition(o)&Node.DOCUMENT_POSITION_CONTAINS||(e.restore(),r.pop());var a=this.context.styleRendererFactory[i],s=this.pathGeneratorFactory[i],u=t.parsedStyle.clipPath;if(u){this.applyWorldTransform(e,u);var c=this.pathGeneratorFactory[u.nodeName];c&&(e.save(),r.push(t),e.beginPath(),c(e,u.parsedStyle),e.closePath(),e.clip())}a&&(this.applyWorldTransform(e,t),e.save(),this.applyAttributesToContext(e,t)),s&&(e.beginPath(),s(e,t.parsedStyle),t.nodeName!==xc.LINE&&t.nodeName!==xc.PATH&&t.nodeName!==xc.POLYLINE&&e.closePath()),a&&(a.render(e,t.parsedStyle,t,n,this),e.restore()),t.renderable.dirty=!1},e.convertAABB2Rect=function(t){var e=t.getMin(),n=t.getMax(),r=Math.floor(e[0]),i=Math.floor(e[1]);return{x:r,y:i,width:Math.ceil(n[0])-r,height:Math.ceil(n[1])-i}},e.mergeDirtyAABBs=function(t){var e=new gc;return t.forEach((function(t){var n=t.getRenderBounds();e.add(n);var r=t.renderable.dirtyRenderBounds;r&&e.add(r)})),e},e.searchDirtyObjects=function(t){var e=t.getMin(),n=e[0],r=e[1],i=t.getMax(),o=i[0],a=i[1];return this.rBush.search({minX:n,minY:r,maxX:o,maxY:a}).map((function(t){var e=t.id;return ym.displayObjectPool.getByEntity(e)}))},e.saveDirtyAABB=function(t){var e=t.renderable;e.dirtyRenderBounds||(e.dirtyRenderBounds=new gc);var n=t.getRenderBounds();n&&e.dirtyRenderBounds.update(n.center,n.halfExtents)},e.applyAttributesToContext=function(t,e){var n=e.parsedStyle,r=n.stroke,i=n.fill,o=n.opacity,a=n.lineDash,s=n.lineDashOffset;a&&t.setLineDash(a),zs(s)||(t.lineDashOffset=s),zs(o)||(t.globalAlpha*=o),zs(r)||Array.isArray(r)||r.isNone||(t.strokeStyle=e.attributes.stroke),zs(i)||Array.isArray(i)||i.isNone||(t.fillStyle=e.attributes.fill)},e.applyWorldTransform=function(t,e,n){var r=0,i=0,o=(e.parsedStyle||{}).anchor,a=o&&o[0]||0,s=o&&o[1]||0;if(0!==a||0!==s){var u=e.getGeometryBounds();r=-a*(u&&2*u.halfExtents[0]||0),i=-s*(u&&2*u.halfExtents[1]||0)}n?(io(this.tmpMat4,e.getLocalTransform()),this.vec3a[0]=r,this.vec3a[1]=i,this.vec3a[2]=0,fo(this.tmpMat4,this.tmpMat4,this.vec3a),ho(this.tmpMat4,n,this.tmpMat4),ho(this.tmpMat4,this.vpMatrix,this.tmpMat4)):(io(this.tmpMat4,e.getWorldTransform()),this.vec3a[0]=r,this.vec3a[1]=i,this.vec3a[2]=0,fo(this.tmpMat4,this.tmpMat4,this.vec3a),ho(this.tmpMat4,this.vpMatrix,this.tmpMat4)),t.setTransform(this.tmpMat4[0],this.tmpMat4[1],this.tmpMat4[4],this.tmpMat4[5],this.tmpMat4[12],this.tmpMat4[13])},e.safeMergeAABB=function(){for(var t=new gc,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return n.forEach((function(e){t.add(e)})),t},t}();Qg.tag="CanvasRenderer";var ty=function(){function t(t){this.imagePool=void 0,this.imagePool=t}var e=t.prototype;return e.render=function(t,e,n,r,i){var o=e.fill,a=e.fillRule,s=e.opacity,u=e.fillOpacity,c=e.stroke,l=e.strokeOpacity,h=e.lineWidth,f=e.lineCap,p=e.lineJoin,d=e.shadowType,m=e.shadowColor,v=e.shadowBlur,g=e.filter,y=e.miterLimit,x=!zs(o)&&!o.isNone,b=!zs(c)&&!c.isNone&&h>0,_=0===o.alpha,w=!(!g||!g.length),S=!zs(m)&&v>0,M=n.nodeName,E="inner"===d,A=b&&S&&(M===xc.PATH||M===xc.LINE||M===xc.POLYLINE||_||E);x&&(t.globalAlpha=s*u,A||ey(n,t,S),this.fill(t,n,o,a,r,i),A||this.clearShadowAndFilter(t,w,S)),b&&(t.globalAlpha=s*l,t.lineWidth=h,zs(y)||(t.miterLimit=y),zs(f)||(t.lineCap=f),zs(p)||(t.lineJoin=p),A&&(E&&(t.globalCompositeOperation="source-atop"),ey(n,t,!0),E&&(this.stroke(t,n,c,r,i),t.globalCompositeOperation="source-over",this.clearShadowAndFilter(t,w,!0))),this.stroke(t,n,c,r,i))},e.clearShadowAndFilter=function(t,e,n){if(n&&(t.shadowColor="transparent",t.shadowBlur=0),e){var r=t.filter;!zs(r)&&r.indexOf("drop-shadow")>-1&&(t.filter=r.replace(/drop-shadow\([^)]*\)/,"").trim()||"none")}},e.fill=function(t,e,n,r,i,o){var a=this;Array.isArray(n)?n.forEach((function(n){t.fillStyle=a.getColor(n,e,t),t.fill(r)})):(lh(n)&&(t.fillStyle=this.getPattern(n,e,t,i,o)),t.fill(r))},e.stroke=function(t,e,n,r,i){var o=this;Array.isArray(n)?n.forEach((function(n){t.strokeStyle=o.getColor(n,e,t),t.stroke()})):(lh(n)&&(t.strokeStyle=this.getPattern(n,e,t,r,i)),t.stroke())},e.getPattern=function(t,e,n,r,i){var o,a;if(t.image instanceof hp){var s=t.image.parsedStyle,u=s.width,c=s.height;a=r.contextService.getDPR();var l=r.config.offscreenCanvas;(o=ym.offscreenCanvas.getOrCreateCanvas(l)).width=u*a,o.height=c*a;var h=ym.offscreenCanvas.getOrCreateContext(l),f=[];t.image.forEach((function(t){i.renderDisplayObject(t,h,r,f)})),f.forEach((function(){h.restore()}))}return this.imagePool.getOrCreatePatternSync(t,n,o,a,(function(){e.renderable.dirty=!0,r.renderingService.dirtify()}))},e.getColor=function(t,e,n){var r;if(t.type===hl.LinearGradient||t.type===hl.RadialGradient){var i=e.getGeometryBounds(),o=i&&2*i.halfExtents[0]||1,a=i&&2*i.halfExtents[1]||1;r=this.imagePool.getOrCreateGradient(Kg({type:t.type},t.value,{width:o,height:a}),n)}return r},t}();function ey(t,e,n){var r=t.parsedStyle,i=r.filter,o=r.shadowColor,a=r.shadowBlur,s=r.shadowOffsetX,u=r.shadowOffsetY;i&&i.length&&(e.filter=t.style.filter),n&&(e.shadowColor=o.toString(),e.shadowBlur=a||0,e.shadowOffsetX=s||0,e.shadowOffsetY=u||0)}var ny=function(){function t(t){this.imagePool=void 0,this.imagePool=t}return t.prototype.render=function(t,e,n){var r,i=e.width,o=e.height,a=e.img,s=e.shadowColor,u=e.shadowBlur,c=i,l=o;if($s(a)?r=this.imagePool.getImageSync(a):(c||(c=a.width),l||(l=a.height),r=a),r){ey(n,t,!zs(s)&&u>0);try{t.drawImage(r,0,0,c,l)}catch(h){}}},t}(),ry=function(){function t(){}var e=t.prototype;return e.render=function(t,e,n){var r=e.lineWidth,i=e.textAlign,o=e.textBaseline,a=e.lineJoin,s=e.miterLimit,u=e.letterSpacing,c=e.stroke,l=e.fill,h=e.fillOpacity,f=e.strokeOpacity,p=e.opacity,d=e.metrics,m=e.dx,v=e.dy,g=e.shadowColor,y=e.shadowBlur,x=d.font,b=d.lines,_=d.height,w=d.lineHeight,S=d.lineMetrics;t.font=x,t.lineWidth=r,t.textAlign="middle"===i?"center":i,t.textBaseline=o,t.lineJoin=a,zs(s)||(t.miterLimit=s);var M=0;"middle"===o?M=-_/2-w/2:"bottom"===o||"alphabetic"===o||"ideographic"===o?M=-_:"top"!==o&&"hanging"!==o||(M=-w);var E=m||0;M+=v||0,ey(n,t,!zs(g)&&y>0);for(var A=0;A<b.length;A++){var T=r/2+E;M+=w,zs(c)||c.isNone||!r||this.drawLetterSpacing(t,b[A],S[A],i,T,M,u,h,f,p,!0),zs(l)||this.drawLetterSpacing(t,b[A],S[A],i,T,M,u,h,f,p)}},e.drawLetterSpacing=function(t,e,n,r,i,o,a,s,u,c,l){if(void 0===l&&(l=!1),0!==a){var h=t.textAlign;t.textAlign="left";var f=i;"center"===r||"middle"===r?f=i-n.width/2:"right"!==r&&"end"!==r||(f=i-n.width);for(var p=Array.from(e),d=t.measureText(e).width,m=0,v=0;v<p.length;++v){var g=p[v];l?this.strokeText(t,g,f,o,u):this.fillText(t,g,f,o,s,c),f+=d-(m=t.measureText(e.substring(v+1)).width)+a,d=m}t.textAlign=h}else l?this.strokeText(t,e,i,o,u):this.fillText(t,e,i,o,s,c)},e.fillText=function(t,e,n,r,i,o){var a,s=!zs(i)&&1!==i;s&&(a=t.globalAlpha,t.globalAlpha=i*o),t.fillText(e,n,r),s&&(t.globalAlpha=a)},e.strokeText=function(t,e,n,r,i){var o,a=!zs(i)&&1!==i;a&&(o=t.globalAlpha,t.globalAlpha=i),t.strokeText(e,n,r),a&&(t.globalAlpha=o)},t}(),iy=function(t){var e,n;function r(e){var n;return void 0===e&&(e={}),(n=t.call(this)||this).options=void 0,n.name="canvas-renderer",n.options=e,n}n=t,(e=r).prototype=Object.create(n.prototype),e.prototype.constructor=e,Jg(e,n);var i=r.prototype;return i.init=function(){var t,e=Kg({dirtyObjectNumThreshold:500,dirtyObjectRatioThreshold:.8},this.options),n=this.context.imagePool,r=new ty(n),i=((t={})[xc.CIRCLE]=r,t[xc.ELLIPSE]=r,t[xc.RECT]=r,t[xc.IMAGE]=new ny(n),t[xc.TEXT]=new ry,t[xc.LINE]=r,t[xc.POLYLINE]=r,t[xc.POLYGON]=r,t[xc.PATH]=r,t[xc.GROUP]=void 0,t[xc.HTML]=void 0,t[xc.MESH]=void 0,t);this.context.defaultStyleRendererFactory=i,this.context.styleRendererFactory=i,this.addRenderingPlugin(new Qg(e))},i.destroy=function(){this.removeAllRenderingPlugins(),delete this.context.defaultStyleRendererFactory,delete this.context.styleRendererFactory},r}(_m);function oy(){oy=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(C){u=function(t,e,n){return t[e]=n}}function c(t,e,n,i){var o=e&&e.prototype instanceof f?e:f,a=Object.create(o.prototype),s=new E(i||[]);return r(a,"_invoke",{value:_(t,n,s)}),a}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(C){return{type:"throw",arg:C}}}t.wrap=c;var h={};function f(){}function p(){}function d(){}var m={};u(m,o,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(A([])));g&&g!==e&&n.call(g,o)&&(m=g);var y=d.prototype=f.prototype=Object.create(m);function x(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function i(r,o,a,s){var u=l(t[r],t,o);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){i("next",t,a,s)}),(function(t){i("throw",t,a,s)})):e.resolve(h).then((function(t){c.value=t,a(c)}),(function(t){return i("throw",t,a,s)}))}s(u.arg)}var o;r(this,"_invoke",{value:function(t,n){function r(){return new e((function(e,r){i(t,n,e,r)}))}return o=o?o.then(r,r):r()}})}function _(t,e,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return{value:void 0,done:!0}}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=w(a,n);if(s){if(s===h)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=l(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===h)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}function w(t,e){var n=e.method,r=t.iterator[n];if(void 0===r)return e.delegate=null,"throw"===n&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=l(r,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,h;var o=i.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function M(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function E(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function A(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:T}}function T(){return{value:void 0,done:!0}}return p.prototype=d,r(y,"constructor",{value:d,configurable:!0}),r(d,"constructor",{value:p,configurable:!0}),p.displayName=u(d,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(y),t},t.awrap=function(t){return{__await:t}},x(b.prototype),u(b.prototype,a,(function(){return this})),t.AsyncIterator=b,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new b(c(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},x(y),u(y,s,"Generator"),u(y,o,(function(){return this})),u(y,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},t.values=A,E.prototype={constructor:E,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(M),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),u=n.call(o,"finallyLoc");if(s&&u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,h):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),M(n),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;M(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:A(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),h}},t}function ay(t,e,n,r,i,o,a){try{var s=t[o](a),u=s.value}catch(c){return void n(c)}s.done?e(u):Promise.resolve(u).then(r,i)}function sy(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function a(t){ay(o,r,i,a,s,"next",t)}function s(t){ay(o,r,i,a,s,"throw",t)}a(void 0)}))}}function uy(t,e){return(uy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var cy=function(){function t(){this.context=void 0}return t.prototype.apply=function(e){var n=this,r=e.renderingService,i=e.renderingContext;this.context=e;var o=i.root.ownerDocument.defaultView,a=function(t){r.hooks.pointerMove.call(t)},s=function(t){r.hooks.pointerUp.call(t)},u=function(t){r.hooks.pointerDown.call(t)},c=function(t){r.hooks.pointerOver.call(t)},l=function(t){r.hooks.pointerOut.call(t)},h=function(t){r.hooks.pointerCancel.call(t)},f=function(t){r.hooks.pointerWheel.call(t)},p=function(t){ym.globalThis.document.addEventListener("pointermove",a,!0),t.addEventListener("pointerdown",u,!0),t.addEventListener("pointerleave",l,!0),t.addEventListener("pointerover",c,!0),ym.globalThis.addEventListener("pointerup",s,!0)},d=function(t){t.addEventListener("touchstart",u,!0),t.addEventListener("touchend",s,!0),t.addEventListener("touchmove",a,!0),t.addEventListener("touchcancel",h,!0)},m=function(t){ym.globalThis.document.addEventListener("mousemove",a,!0),t.addEventListener("mousedown",u,!0),t.addEventListener("mouseout",l,!0),t.addEventListener("mouseover",c,!0),ym.globalThis.addEventListener("mouseup",s,!0)};r.hooks.init.tapPromise(t.tag,sy(oy().mark((function t(){var e;return oy().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=n.context.contextService.getDomElement(),ym.globalThis.navigator.msPointerEnabled?(e.style.msContentZooming="none",e.style.msTouchAction="none"):o.supportsPointerEvents&&(e.style.touchAction="none"),o.supportsPointerEvents?p(e):m(e),o.supportsTouchEvents&&d(e),e.addEventListener("wheel",f,{passive:!0,capture:!0});case 5:case"end":return t.stop()}}),t)})))),r.hooks.destroy.tap(t.tag,(function(){var t=n.context.contextService.getDomElement();ym.globalThis.navigator.msPointerEnabled?(t.style.msContentZooming="",t.style.msTouchAction=""):o.supportsPointerEvents&&(t.style.touchAction=""),o.supportsPointerEvents?function(t){ym.globalThis.document.removeEventListener("pointermove",a,!0),t.removeEventListener("pointerdown",u,!0),t.removeEventListener("pointerleave",l,!0),t.removeEventListener("pointerover",c,!0),ym.globalThis.removeEventListener("pointerup",s,!0)}(t):function(t){ym.globalThis.document.removeEventListener("mousemove",a,!0),t.removeEventListener("mousedown",u,!0),t.removeEventListener("mouseout",l,!0),t.removeEventListener("mouseover",c,!0),ym.globalThis.removeEventListener("mouseup",s,!0)}(t),o.supportsTouchEvents&&function(t){t.removeEventListener("touchstart",u,!0),t.removeEventListener("touchend",s,!0),t.removeEventListener("touchmove",a,!0),t.removeEventListener("touchcancel",h,!0)}(t),t.removeEventListener("wheel",f,!0)}))},t}();cy.tag="DOMInteraction";var ly=function(t){var e,n;function r(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))||this).name="dom-interaction",e}n=t,(e=r).prototype=Object.create(n.prototype),e.prototype.constructor=e,uy(e,n);var i=r.prototype;return i.init=function(){this.addRenderingPlugin(new cy)},i.destroy=function(){this.removeAllRenderingPlugins()},r}(_m);function hy(){hy=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(C){u=function(t,e,n){return t[e]=n}}function c(t,e,n,i){var o=e&&e.prototype instanceof f?e:f,a=Object.create(o.prototype),s=new E(i||[]);return r(a,"_invoke",{value:_(t,n,s)}),a}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(C){return{type:"throw",arg:C}}}t.wrap=c;var h={};function f(){}function p(){}function d(){}var m={};u(m,o,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(A([])));g&&g!==e&&n.call(g,o)&&(m=g);var y=d.prototype=f.prototype=Object.create(m);function x(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function i(r,o,a,s){var u=l(t[r],t,o);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){i("next",t,a,s)}),(function(t){i("throw",t,a,s)})):e.resolve(h).then((function(t){c.value=t,a(c)}),(function(t){return i("throw",t,a,s)}))}s(u.arg)}var o;r(this,"_invoke",{value:function(t,n){function r(){return new e((function(e,r){i(t,n,e,r)}))}return o=o?o.then(r,r):r()}})}function _(t,e,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return{value:void 0,done:!0}}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=w(a,n);if(s){if(s===h)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=l(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===h)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}function w(t,e){var n=e.method,r=t.iterator[n];if(void 0===r)return e.delegate=null,"throw"===n&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=l(r,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,h;var o=i.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function M(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function E(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function A(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:T}}function T(){return{value:void 0,done:!0}}return p.prototype=d,r(y,"constructor",{value:d,configurable:!0}),r(d,"constructor",{value:p,configurable:!0}),p.displayName=u(d,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(y),t},t.awrap=function(t){return{__await:t}},x(b.prototype),u(b.prototype,a,(function(){return this})),t.AsyncIterator=b,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new b(c(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},x(y),u(y,s,"Generator"),u(y,o,(function(){return this})),u(y,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},t.values=A,E.prototype={constructor:E,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(M),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),u=n.call(o,"finallyLoc");if(s&&u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,h):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),M(n),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;M(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:A(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),h}},t}function fy(t,e,n,r,i,o,a){try{var s=t[o](a),u=s.value}catch(c){return void n(c)}s.done?e(u):Promise.resolve(u).then(r,i)}function py(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function a(t){fy(o,r,i,a,s,"next",t)}function s(t){fy(o,r,i,a,s,"throw",t)}a(void 0)}))}}function dy(t,e){return(dy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var vy=function(){function t(){this.context=void 0,this.$camera=void 0}var e=t.prototype;return e.joinTransformMatrix=function(t){return"matrix("+[t[0],t[1],t[4],t[5],t[12],t[13]].join(",")+")"},e.apply=function(e){var n=this,r=e.camera,i=e.renderingContext,o=e.renderingService,a=e.displayObjectPool;this.context=e;var s=i.root.ownerDocument.defaultView,u=function(t,e){e.style.transform=n.joinTransformMatrix(t.getWorldTransform())},c=function(t){var e=t.target;if(e.nodeName===xc.HTML){n.$camera||(n.$camera=n.createCamera(r));var i=n.getOrCreateEl(e);n.$camera.appendChild(i);var o=e.ownerDocument.documentElement.attributes;Object.keys(o).forEach((function(t){i.style[t]=o[t]})),Object.keys(e.attributes).forEach((function(t){n.updateAttribute(t,e)})),u(e,i)}},l=function(t){var e=t.target;if(e.nodeName===xc.HTML&&n.$camera){var r=n.getOrCreateEl(e);r&&r.remove()}},h=function(t){var e=t.target;if(e.nodeName===xc.HTML){var r=t.attrName;n.updateAttribute(r,e)}},f=function(t){var e=t.target;if(e.nodeName===xc.HTML){var r=n.getOrCreateEl(e);u(e,r)}},p=function(){if(n.$camera){var t=n.context.config,e=t.width,r=t.height;n.$camera.style.width=(e||0)+"px",n.$camera.style.height=(r||0)+"px"}};o.hooks.init.tapPromise(t.tag,py(hy().mark((function t(){return hy().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a.getHTMLs().length&&(n.$camera=n.createCamera(r)),s.addEventListener(Am.RESIZE,p),s.addEventListener(Mf.MOUNTED,c),s.addEventListener(Mf.UNMOUNTED,l),s.addEventListener(Mf.ATTR_MODIFIED,h),s.addEventListener(Mf.BOUNDS_CHANGED,f);case 6:case"end":return t.stop()}}),t)})))),o.hooks.endFrame.tap(t.tag,(function(){n.$camera&&i.renderReasons.has(Vd.CAMERA_CHANGED)&&(n.$camera.style.transform=n.joinTransformMatrix(r.getOrthoMatrix()))})),o.hooks.destroy.tap(t.tag,(function(){n.$camera&&n.$camera.remove(),s.removeEventListener(Am.RESIZE,p),s.removeEventListener(Mf.MOUNTED,c),s.removeEventListener(Mf.UNMOUNTED,l),s.removeEventListener(Mf.ATTR_MODIFIED,h),s.removeEventListener(Mf.BOUNDS_CHANGED,f)}))},e.getId=function(t){return t.id||"g-html-"+t.entity},e.createCamera=function(t){var e=this.context.config,n=e.document,r=e.width,i=e.height,o=this.context.contextService.getDomElement(),a=o.parentNode;if(a){var s="g-canvas-camera",u=a.querySelector("#"+s);if(!u){var c=(n||document).createElement("div");u=c,c.id=s,c.style.position="absolute",c.style.left=(o.offsetLeft||0)+"px",c.style.top=(o.offsetTop||0)+"px",c.style.transformOrigin="left top",c.style.transform=this.joinTransformMatrix(t.getOrthoMatrix()),c.style.overflow="hidden",c.style.pointerEvents="none",c.style.width=(r||0)+"px",c.style.height=(i||0)+"px",a.appendChild(c)}return u}return null},e.getOrCreateEl=function(t){var e=this.context.config.document,n=this.getId(t),r=this.$camera.querySelector("#"+n);return r||(r=(e||document).createElement("div"),t.parsedStyle.$el=r,r.id=n,t.name&&r.setAttribute("name",t.name),t.className&&(r.className=t.className),r.style.position="absolute",r.style.left="0px",r.style.top="0px",r.style["will-change"]="transform",r.style.transform=this.joinTransformMatrix(t.getWorldTransform())),r},e.updateAttribute=function(t,e){var n=this.getOrCreateEl(e);switch(t){case"innerHTML":var r=e.parsedStyle.innerHTML;$s(r)?n.innerHTML=r:(n.innerHTML="",n.appendChild(r));break;case"transformOrigin":var i=e.parsedStyle.transformOrigin;n.style["transform-origin"]=i[0].value+" "+i[1].value;break;case"width":var o=e.computedStyleMap().get("width");n.style.width=o.toString();break;case"height":var a=e.computedStyleMap().get("height");n.style.height=a.toString();break;case"zIndex":var s=e.parsedStyle.zIndex;n.style["z-index"]=""+s;break;case"visibility":var u=e.parsedStyle.visibility;n.style.visibility=u;break;case"pointerEvents":var c=e.parsedStyle.pointerEvents;n.style.pointerEvents=c;break;case"opacity":var l=e.parsedStyle.opacity;n.style.opacity=""+l;break;case"fill":var h=e.parsedStyle.fill,f="";h instanceof Hl?f=h.isNone?"transparent":e.getAttribute("fill"):Array.isArray(h)?f=e.getAttribute("fill"):lh(h),n.style.background=f;break;case"stroke":var p=e.parsedStyle.stroke,d="";p instanceof Hl?d=p.isNone?"transparent":e.getAttribute("stroke"):Array.isArray(p)?d=e.getAttribute("stroke"):lh(p),n.style["border-color"]=d,n.style["border-style"]="solid";break;case"lineWidth":var m=e.parsedStyle.lineWidth;n.style["border-width"]=(m||0)+"px";break;case"lineDash":n.style["border-style"]="dashed";break;case"filter":var v=e.style.filter;n.style.filter=v}},t}();vy.tag="HTMLRendering";var gy=function(t){var e,n;function r(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))||this).name="html-renderer",e}n=t,(e=r).prototype=Object.create(n.prototype),e.prototype.constructor=e,dy(e,n);var i=r.prototype;return i.init=function(){this.addRenderingPlugin(new vy)},i.destroy=function(){this.removeAllRenderingPlugins()},r}(_m);function yy(){yy=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(C){u=function(t,e,n){return t[e]=n}}function c(t,e,n,i){var o=e&&e.prototype instanceof f?e:f,a=Object.create(o.prototype),s=new E(i||[]);return r(a,"_invoke",{value:_(t,n,s)}),a}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(C){return{type:"throw",arg:C}}}t.wrap=c;var h={};function f(){}function p(){}function d(){}var m={};u(m,o,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(A([])));g&&g!==e&&n.call(g,o)&&(m=g);var y=d.prototype=f.prototype=Object.create(m);function x(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function i(r,o,a,s){var u=l(t[r],t,o);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){i("next",t,a,s)}),(function(t){i("throw",t,a,s)})):e.resolve(h).then((function(t){c.value=t,a(c)}),(function(t){return i("throw",t,a,s)}))}s(u.arg)}var o;r(this,"_invoke",{value:function(t,n){function r(){return new e((function(e,r){i(t,n,e,r)}))}return o=o?o.then(r,r):r()}})}function _(t,e,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return{value:void 0,done:!0}}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=w(a,n);if(s){if(s===h)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=l(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===h)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}function w(t,e){var n=e.method,r=t.iterator[n];if(void 0===r)return e.delegate=null,"throw"===n&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=l(r,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,h;var o=i.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function M(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function E(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function A(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:T}}function T(){return{value:void 0,done:!0}}return p.prototype=d,r(y,"constructor",{value:d,configurable:!0}),r(d,"constructor",{value:p,configurable:!0}),p.displayName=u(d,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(y),t},t.awrap=function(t){return{__await:t}},x(b.prototype),u(b.prototype,a,(function(){return this})),t.AsyncIterator=b,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new b(c(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},x(y),u(y,s,"Generator"),u(y,o,(function(){return this})),u(y,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},t.values=A,E.prototype={constructor:E,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(M),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),u=n.call(o,"finallyLoc");if(s&&u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,h):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),M(n),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;M(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:A(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),h}},t}function xy(t,e,n,r,i,o,a){try{var s=t[o](a),u=s.value}catch(c){return void n(c)}s.done?e(u):Promise.resolve(u).then(r,i)}function by(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function a(t){xy(o,r,i,a,s,"next",t)}function s(t){xy(o,r,i,a,s,"throw",t)}a(void 0)}))}}function _y(t,e){return(_y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var wy="undefined"!=typeof Float32Array?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var Sy=function(){function t(t){this.canvasConfig=void 0,this.imageCache={},this.gradientCache={},this.patternCache={},this.canvasConfig=t}var e=t.prototype;return e.getImageSync=function(t,e){return this.imageCache[t]?e&&e():this.getOrCreateImage(t).then((function(){e&&e()})),this.imageCache[t]},e.getOrCreateImage=function(t){var e=this;if(this.imageCache[t])return Promise.resolve(this.imageCache[t]);var n=this.canvasConfig.createImage;return new Promise((function(r,i){var o;n?o=n(t):Rc&&(o=new window.Image),o&&(o.onload=function(){r(o)},o.onerror=function(t){i(t)},o.crossOrigin="Anonymous",o.src=t,e.imageCache[t]=o)}))},e.getOrCreatePatternSync=function(t,e,n,r,i){var o=this.generatePatternKey(t);if(o&&this.patternCache[o])return this.patternCache[o];var a,s=t.image,u=t.repetition,c=t.transform,l=!1;$s(s)?a=this.getImageSync(s,i):n?(a=n,l=!0):a=s;var h,f,p=a&&e.createPattern(a,u);p&&(h=c?Tp(Fh(c)):function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}((f=new wy(16),wy!=Float32Array&&(f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[11]=0,f[12]=0,f[13]=0,f[14]=0),f[0]=1,f[5]=1,f[10]=1,f[15]=1,f)),l&&function(t,e,n){var r=n[0],i=n[1],o=n[2];t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]}(h,h,[1/r,1/r,1]),p.setTransform({a:h[0],b:h[1],c:h[4],d:h[5],e:h[12],f:h[13]}));return o&&p&&(this.patternCache[o]=p),p},e.getOrCreateGradient=function(t,e){var n=this.generateGradientKey(t),r=t.type,i=t.steps,o=t.width,a=t.height,s=t.angle,u=t.cx,c=t.cy,l=t.size;if(this.gradientCache[n])return this.gradientCache[n];var h=null;if(r===hl.LinearGradient){var f=function(t,e,n){var r=vp(n.value),i=0+t/2,o=0+e/2,a=Math.abs(t*Math.cos(r))+Math.abs(e*Math.sin(r));return{x1:i-Math.cos(r)*a/2,y1:o-Math.sin(r)*a/2,x2:i+Math.cos(r)*a/2,y2:o+Math.sin(r)*a/2}}(o,a,s),p=f.x1,d=f.y1,m=f.x2,v=f.y2;h=e.createLinearGradient(p,d,m,v)}else if(r===hl.RadialGradient){var g=function(t,e,n,r,i){var o=n.value,a=r.value;n.unit===Fc.kPercentage&&(o=n.value/100*t),r.unit===Fc.kPercentage&&(a=r.value/100*e);var s=Math.max(ws([0,0],[o,a]),ws([0,e],[o,a]),ws([t,e],[o,a]),ws([t,0],[o,a]));return i&&(i instanceof Rl?s=i.value:i instanceof Sl&&("closest-side"===i.value?s=Math.min(o,t-o,a,e-a):"farthest-side"===i.value?s=Math.max(o,t-o,a,e-a):"closest-corner"===i.value&&(s=Math.min(ws([0,0],[o,a]),ws([0,e],[o,a]),ws([t,e],[o,a]),ws([t,0],[o,a]))))),{x:o,y:a,r:s}}(o,a,u,c,l),y=g.x,x=g.y,b=g.r;h=e.createRadialGradient(y,x,0,y,x,b)}return h&&(i.forEach((function(t){var e,n=t.offset,r=t.color;n.unit===Fc.kPercentage&&(null===(e=h)||void 0===e||e.addColorStop(n.value/100,r.toString()))})),this.gradientCache[n]=h),this.gradientCache[n]},e.generateGradientKey=function(t){var e=t.type,n=t.width,r=t.height,i=t.steps,o=t.angle,a=t.cx,s=t.cy,u=t.size;return"gradient-"+e+"-"+((null==o?void 0:o.toString())||0)+"-"+((null==a?void 0:a.toString())||0)+"-"+((null==s?void 0:s.toString())||0)+"-"+((null==u?void 0:u.toString())||0)+"-"+n+"-"+r+"-"+i.map((function(t){return""+t.offset+t.color})).join("-")},e.generatePatternKey=function(t){var e=t.image,n=t.repetition;return $s(e)?"pattern-"+e+"-"+n:e instanceof hp?"pattern-"+e.entity+"-"+n:void 0},t}(),My=function(){function t(){}return t.prototype.apply=function(e){var n=e.renderingService,r=e.renderingContext,i=e.imagePool,o=r.root.ownerDocument.defaultView,a=function(t){var e=t.target,r=e.nodeName,o=e.attributes;if(r===xc.IMAGE){var a=o.img;$s(a)&&i.getImageSync(a,(function(){e.renderable.dirty=!0,n.dirtify()}))}},s=function(t){var e=t.target,r=t.attrName,o=t.newValue;e.nodeName===xc.IMAGE&&"img"===r&&$s(o)&&i.getOrCreateImage(o).then((function(){e.renderable.dirty=!0,n.dirtify()}))};n.hooks.init.tapPromise(t.tag,by(yy().mark((function t(){return yy().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:o.addEventListener(Mf.MOUNTED,a),o.addEventListener(Mf.ATTR_MODIFIED,s);case 2:case"end":return t.stop()}}),t)})))),n.hooks.destroy.tap(t.tag,(function(){o.removeEventListener(Mf.MOUNTED,a),o.removeEventListener(Mf.ATTR_MODIFIED,s)}))},t}();My.tag="LoadImage";var Ey=function(t){var e,n;function r(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))||this).name="image-loader",e}n=t,(e=r).prototype=Object.create(n.prototype),e.prototype.constructor=e,_y(e,n);var i=r.prototype;return i.init=function(){this.context.imagePool=new Sy(this.context.config),this.addRenderingPlugin(new My)},i.destroy=function(){this.removeAllRenderingPlugins()},r}(_m);function Ay(){Ay=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(C){u=function(t,e,n){return t[e]=n}}function c(t,e,n,i){var o=e&&e.prototype instanceof f?e:f,a=Object.create(o.prototype),s=new E(i||[]);return r(a,"_invoke",{value:_(t,n,s)}),a}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(C){return{type:"throw",arg:C}}}t.wrap=c;var h={};function f(){}function p(){}function d(){}var m={};u(m,o,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(A([])));g&&g!==e&&n.call(g,o)&&(m=g);var y=d.prototype=f.prototype=Object.create(m);function x(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function i(r,o,a,s){var u=l(t[r],t,o);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){i("next",t,a,s)}),(function(t){i("throw",t,a,s)})):e.resolve(h).then((function(t){c.value=t,a(c)}),(function(t){return i("throw",t,a,s)}))}s(u.arg)}var o;r(this,"_invoke",{value:function(t,n){function r(){return new e((function(e,r){i(t,n,e,r)}))}return o=o?o.then(r,r):r()}})}function _(t,e,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return{value:void 0,done:!0}}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=w(a,n);if(s){if(s===h)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=l(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===h)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}function w(t,e){var n=e.method,r=t.iterator[n];if(void 0===r)return e.delegate=null,"throw"===n&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=l(r,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,h;var o=i.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function M(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function E(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function A(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:T}}function T(){return{value:void 0,done:!0}}return p.prototype=d,r(y,"constructor",{value:d,configurable:!0}),r(d,"constructor",{value:p,configurable:!0}),p.displayName=u(d,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(y),t},t.awrap=function(t){return{__await:t}},x(b.prototype),u(b.prototype,a,(function(){return this})),t.AsyncIterator=b,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new b(c(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},x(y),u(y,s,"Generator"),u(y,o,(function(){return this})),u(y,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},t.values=A,E.prototype={constructor:E,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(M),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),u=n.call(o,"finallyLoc");if(s&&u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,h):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),M(n),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;M(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:A(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),h}},t}function Ty(t,e,n,r,i,o,a){try{var s=t[o](a),u=s.value}catch(c){return void n(c)}s.done?e(u):Promise.resolve(u).then(r,i)}function Cy(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function a(t){Ty(o,r,i,a,s,"next",t)}function s(t){Ty(o,r,i,a,s,"throw",t)}a(void 0)}))}}function Oy(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,ky(t,e)}function ky(t,e){return(ky=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Py=function(){function t(t){this.$container=void 0,this.$canvas=void 0,this.dpr=void 0,this.context=void 0,this.canvasConfig=void 0,this.renderingContext=void 0,this.renderingContext=t.renderingContext,this.canvasConfig=t.config}var e=t.prototype;return e.init=function(){var t=Cy(Ay().mark((function t(){var e,n,r,i;return Ay().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=this.canvasConfig,n=e.container,(r=e.canvas)?(this.$canvas=r,n&&r.parentElement!==n&&n.appendChild(r),this.$container=r.parentElement,this.canvasConfig.container=this.$container):n&&(this.$container=$s(n)?document.getElementById(n):n,this.$container&&(i=document.createElement("canvas"),this.$container.appendChild(i),this.$container.style.position||(this.$container.style.position="relative"),this.$canvas=i)),this.context=this.$canvas.getContext("2d"),this.resize(this.canvasConfig.width,this.canvasConfig.height);case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),e.getContext=function(){return this.context},e.getDomElement=function(){return this.$canvas},e.getDPR=function(){return this.dpr},e.getBoundingClientRect=function(){if(this.$canvas.getBoundingClientRect)return this.$canvas.getBoundingClientRect()},e.destroy=function(){this.$container&&this.$canvas&&this.$canvas.parentNode&&this.$container.removeChild(this.$canvas)},e.resize=function(t,e){var n=this.canvasConfig.devicePixelRatio||Rc&&window.devicePixelRatio||1;n=n>=1?Math.ceil(n):1,this.dpr=n,this.$canvas&&(this.$canvas.width=this.dpr*t,this.$canvas.height=this.dpr*e,function(t,e,n){Rc&&t.style&&(t.style.width=e+"px",t.style.height=n+"px")}(this.$canvas,t,e)),this.renderingContext.renderReasons.add(Vd.CAMERA_CHANGED)},e.applyCursorStyle=function(t){this.$container&&this.$container.style&&(this.$container.style.cursor=t)},e.toDataURL=function(){var t=Cy(Ay().mark((function t(e){var n,r,i;return Ay().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===e&&(e={}),r=(n=e).type,i=n.encoderOptions,t.abrupt("return",this.context.canvas.toDataURL(r,i));case 3:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),t}(),Ly=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))||this).name="canvas-context-register",e}Oy(e,t);var n=e.prototype;return n.init=function(){this.context.ContextService=Py},n.destroy=function(){delete this.context.ContextService},e}(_m),Ry=function(t){function e(e){var n;return(n=t.call(this,e)||this).registerPlugin(new Ly),n.registerPlugin(new Ey),n.registerPlugin(new tg),n.registerPlugin(new iy),n.registerPlugin(new ly),n.registerPlugin(new Xg),n.registerPlugin(new gy),n}return Oy(e,t),e}(wm);function Iy(){Iy=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(C){u=function(t,e,n){return t[e]=n}}function c(t,e,n,i){var o=e&&e.prototype instanceof f?e:f,a=Object.create(o.prototype),s=new E(i||[]);return r(a,"_invoke",{value:_(t,n,s)}),a}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(C){return{type:"throw",arg:C}}}t.wrap=c;var h={};function f(){}function p(){}function d(){}var m={};u(m,o,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(A([])));g&&g!==e&&n.call(g,o)&&(m=g);var y=d.prototype=f.prototype=Object.create(m);function x(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function i(r,o,a,s){var u=l(t[r],t,o);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){i("next",t,a,s)}),(function(t){i("throw",t,a,s)})):e.resolve(h).then((function(t){c.value=t,a(c)}),(function(t){return i("throw",t,a,s)}))}s(u.arg)}var o;r(this,"_invoke",{value:function(t,n){function r(){return new e((function(e,r){i(t,n,e,r)}))}return o=o?o.then(r,r):r()}})}function _(t,e,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return{value:void 0,done:!0}}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=w(a,n);if(s){if(s===h)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=l(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===h)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}function w(t,e){var n=e.method,r=t.iterator[n];if(void 0===r)return e.delegate=null,"throw"===n&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=l(r,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,h;var o=i.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function M(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function E(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function A(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:T}}function T(){return{value:void 0,done:!0}}return p.prototype=d,r(y,"constructor",{value:d,configurable:!0}),r(d,"constructor",{value:p,configurable:!0}),p.displayName=u(d,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(y),t},t.awrap=function(t){return{__await:t}},x(b.prototype),u(b.prototype,a,(function(){return this})),t.AsyncIterator=b,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new b(c(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},x(y),u(y,s,"Generator"),u(y,o,(function(){return this})),u(y,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},t.values=A,E.prototype={constructor:E,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(M),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),u=n.call(o,"finallyLoc");if(s&&u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,h):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),M(n),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;M(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:A(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),h}},t}function Ny(t,e,n,r,i,o,a){try{var s=t[o](a),u=s.value}catch(c){return void n(c)}s.done?e(u):Promise.resolve(u).then(r,i)}function Dy(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function a(t){Ny(o,r,i,a,s,"next",t)}function s(t){Ny(o,r,i,a,s,"throw",t)}a(void 0)}))}}function Fy(){return Fy=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Fy.apply(this,arguments)}function jy(t,e){return(jy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var By=function(){function t(t){this.dragndropPluginOptions=void 0,this.dragndropPluginOptions=t}return t.prototype.apply=function(e){var n=this,r=e.renderingService,i=e.renderingContext.root.ownerDocument,o=i.defaultView,a=function(t){var e=t.target,r=e===i,a=r&&n.dragndropPluginOptions.isDocumentDraggable?i:e.closest&&e.closest("[draggable=true]");if(a){var s=!1,u=t.timeStamp,c=[t.clientX,t.clientY],l=null,h=[t.clientX,t.clientY],f=function(){var t=Dy(Iy().mark((function t(o){var f,p,d,m,v,g;return Iy().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s){t.next=8;break}if(f=o.timeStamp-u,p=ws([o.clientX,o.clientY],c),!(f<=n.dragndropPluginOptions.dragstartTimeThreshold||p<=n.dragndropPluginOptions.dragstartDistanceThreshold)){t.next=5;break}return t.abrupt("return");case 5:o.type="dragstart",a.dispatchEvent(o),s=!0;case 8:if(o.type="drag",o.dx=o.clientX-h[0],o.dy=o.clientY-h[1],a.dispatchEvent(o),h=[o.clientX,o.clientY],r){t.next=21;break}return d="pointer"===n.dragndropPluginOptions.overlap?[o.canvasX,o.canvasY]:e.getBounds().center,t.next=17,i.elementsFromPoint(d[0],d[1]);case 17:m=t.sent,v=m[m.indexOf(e)+1],g=(null==v?void 0:v.closest("[droppable=true]"))||(n.dragndropPluginOptions.isDocumentDroppable?i:null),l!==g&&(l&&(o.type="dragleave",o.target=l,l.dispatchEvent(o)),g&&(o.type="dragenter",o.target=g,g.dispatchEvent(o)),(l=g)&&(o.type="dragover",o.target=l,l.dispatchEvent(o)));case 21:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();o.addEventListener("pointermove",f);var p=function(t){if(s){t.detail={preventClick:!0};var e=t.clone();l&&(e.type="drop",e.target=l,l.dispatchEvent(e)),e.type="dragend",a.dispatchEvent(e),s=!1}o.removeEventListener("pointermove",f)};e.addEventListener("pointerup",p,{once:!0}),e.addEventListener("pointerupoutside",p,{once:!0})}};r.hooks.init.tapPromise(t.tag,Dy(Iy().mark((function t(){return Iy().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:o.addEventListener("pointerdown",a);case 1:case"end":return t.stop()}}),t)})))),r.hooks.destroy.tap(t.tag,(function(){o.removeEventListener("pointerdown",a)}))},t}();By.tag="Dragndrop";var zy=function(t){var e,n;function r(e){var n;return void 0===e&&(e={}),(n=t.call(this)||this).options=void 0,n.name="dragndrop",n.options=e,n}n=t,(e=r).prototype=Object.create(n.prototype),e.prototype.constructor=e,jy(e,n);var i=r.prototype;return i.init=function(){this.addRenderingPlugin(new By(Fy({overlap:"pointer",isDocumentDraggable:!1,isDocumentDroppable:!1,dragstartDistanceThreshold:0,dragstartTimeThreshold:0},this.options)))},i.destroy=function(){this.removeAllRenderingPlugins()},i.setOptions=function(t){Object.assign(this.plugins[0].dragndropPluginOptions,t)},r}(_m),Uy=function(t){return null!==t&&"function"!=typeof t&&isFinite(t.length)},Vy={}.toString,Gy=function(t,e){return Vy.call(t)==="[object "+e+"]"};const Wy=function(t){return Gy(t,"Function")};var Hy=function(t){return null==t};const Yy=function(t){return Array.isArray?Array.isArray(t):Gy(t,"Array")};var Xy=function(t){if(!function(t){return"object"==typeof t&&null!==t}(t)||!Gy(t,"Object"))return!1;if(null===Object.getPrototypeOf(t))return!0;for(var e=t;null!==Object.getPrototypeOf(e);)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e};var qy=function(t){return Gy(t,"Number")},Zy=Object.values?function(t){return Object.values(t)}:function(t){var e=[];return function(t,e){var n,r;if(t)if(Yy(t))for(var i=0,o=t.length;i<o&&!1!==e(t[i],i);i++);else if(r=typeof(n=t),null!==n&&"object"===r||"function"===r)for(var a in t)if(t.hasOwnProperty(a)&&!1===e(t[a],a))break}(t,(function(n,r){Wy(t)&&"prototype"===r||e.push(n)})),e};const $y=function(t){return Hy(t)?"":t.toString()};var Ky=function(t){var e=$y(t);return e.charAt(0).toLowerCase()+e.substring(1)},Jy=function(t){var e=$y(t);return e.charAt(0).toUpperCase()+e.substring(1)};function Qy(t,e,n,r){for(var i in n=n||0,r=r||5,e)if(e.hasOwnProperty(i)){var o=e[i];null!==o&&Xy(o)?(Xy(t[i])||(t[i]={}),n<r?Qy(t[i],o,n+1,r):t[i]=e[i]):Yy(o)?(t[i]=[],t[i]=t[i].concat(o)):void 0!==o&&(t[i]=o)}}var tx=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0;r<e.length;r+=1)Qy(t,e[r]);return t},ex=function(t,e){if(!Uy(t))return-1;var n=Array.prototype.indexOf;if(n)return n.call(t,e);for(var r=-1,i=0;i<t.length;i++)if(t[i]===e){r=i;break}return r};const nx=function(t,e,n){var r,i,o,a,s=0;n||(n={});var u=function(){s=!1===n.leading?0:Date.now(),r=null,a=t.apply(i,o),r||(i=o=null)},c=function(){var c=Date.now();s||!1!==n.leading||(s=c);var l=e-(c-s);return i=this,o=arguments,l<=0||l>e?(r&&(clearTimeout(r),r=null),s=c,a=t.apply(i,o),r||(i=o=null)):r||!1===n.trailing||(r=setTimeout(u,l)),a};return c.cancel=function(){clearTimeout(r),s=0,r=i=o=null},c},rx=function(t){return t};function ix(t){return Hy(t)?0:Uy(t)?t.length:Object.keys(t).length}var ox;!function(t,e){if(!Wy(t))throw new TypeError("Expected a function");var n=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var o=e?e.apply(this,r):r[0],a=n.cache;if(a.has(o))return a.get(o);var s=t.apply(this,r);return a.set(o,s),s};n.cache=new Map}((function(t,e){void 0===e&&(e={});var n,r=e.fontSize,i=e.fontFamily,o=e.fontWeight,a=e.fontStyle,s=e.fontVariant;return ox||(ox=document.createElement("canvas").getContext("2d")),ox.font=[a,s,o,r+"px",i].join(" "),ox.measureText((n=t,Gy(n,"String")?t:"")).width}),(function(t,e){return void 0===e&&(e={}),function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}([t],Zy(e)).join("")}));const ax=()=>[["cartesian"]];ax.props={};const sx=({startAngle:t=-Math.PI/2,endAngle:e=3*Math.PI/2,innerRadius:n=0,outerRadius:r=1})=>[["translate",0,.5],["reflect.y"],["translate",0,-.5],["polar",t,e,n,r]];sx.props={};const ux=({startAngle:t=0,endAngle:e=6*Math.PI,innerRadius:n=0,outerRadius:r=1})=>[["translate",.5,.5],["reflect.y"],["translate",-.5,-.5],["helix",t,e,n,r]];ux.props={};const cx=()=>[["transpose"],["translate",.5,.5],["reflect.x"],["translate",-.5,-.5]];cx.props={};const lx=()=>[["translate",.5,.5],["reflect"],["translate",-.5,-.5]];lx.props={};const hx=()=>[["translate",.5,.5],["reflect.x"],["translate",-.5,-.5]];hx.props={};const fx=()=>[["translate",.5,.5],["reflect.y"],["translate",-.5,-.5]];fx.props={};const px=({startAngle:t=-Math.PI/2,endAngle:e=3*Math.PI/2,innerRadius:n=0,outerRadius:r=1})=>[["transpose"],["translate",.5,.5],["reflect.x"],["translate",-.5,-.5],...sx({startAngle:t,endAngle:e,innerRadius:n,outerRadius:r})];px.props={};const dx=({startAngle:t=-Math.PI/2,endAngle:e=3*Math.PI/2,innerRadius:n=0,outerRadius:r=1})=>[["transpose"],["translate",.5,.5],["reflect"],["translate",-.5,-.5],...sx({startAngle:t,endAngle:e,innerRadius:n,outerRadius:r})];dx.props={};const mx=()=>[["parallel",0,1,0,1]];mx.props={};const vx=({focusX:t=0,focusY:e=0,distortionX:n=2,distortionY:r=2,isVisual:i=!1})=>[["fisheye",t,e,n,r,i]];vx.props={};const gx=({focusX:t=0,distortionX:e=2,isVisual:n=!1})=>[["fisheye.x",t,e,n]];gx.props={};const yx=({focusY:t=0,distortionY:e=2,isVisual:n=!1})=>[["fisheye.x",t,e,n]];yx.props={};const xx=({value:t})=>e=>e.map((()=>t));xx.props={};const bx=({value:t})=>e=>e.map(t);bx.props={};const _x=({value:t})=>e=>e.map((e=>e[t]));_x.props={};const Sx=({value:t})=>()=>t;function Mx(t,e){return t.parent===e.parent?1:2}function Ex(t,e){return t+e.x}function Ax(t,e){return Math.max(t,e.y)}function Tx(){var t=Mx,e=1,n=1,r=!1;function i(i){var o,a=0;i.eachAfter((function(e){var n=e.children;n?(e.x=function(t){return t.reduce(Ex,0)/t.length}(n),e.y=function(t){return 1+t.reduce(Ax,0)}(n)):(e.x=o?a+=t(e,o):0,e.y=0,o=e)}));var s=function(t){for(var e;e=t.children;)t=e[0];return t}(i),u=function(t){for(var e;e=t.children;)t=e[e.length-1];return t}(i),c=s.x-t(s,u)/2,l=u.x+t(u,s)/2;return i.eachAfter(r?function(t){t.x=(t.x-i.x)*e,t.y=(i.y-t.y)*n}:function(t){t.x=(t.x-c)/(l-c)*e,t.y=(1-(i.y?t.y/i.y:1))*n})}return i.separation=function(e){return arguments.length?(t=e,i):t},i.size=function(t){return arguments.length?(r=!1,e=+t[0],n=+t[1],i):r?null:[e,n]},i.nodeSize=function(t){return arguments.length?(r=!0,e=+t[0],n=+t[1],i):r?[e,n]:null},i}function Cx(t){var e=0,n=t.children,r=n&&n.length;if(r)for(;--r>=0;)e+=n[r].value;else e=1;t.value=e}function Ox(t,e){t instanceof Map?(t=[void 0,t],void 0===e&&(e=Px)):void 0===e&&(e=kx);for(var n,r,i,o,a,s=new Ix(t),u=[s];n=u.pop();)if((i=e(n.data))&&(a=(i=Array.from(i)).length))for(n.children=i,o=a-1;o>=0;--o)u.push(r=i[o]=new Ix(i[o])),r.parent=n,r.depth=n.depth+1;return s.eachBefore(Rx)}function kx(t){return t.children}function Px(t){return Array.isArray(t)?t[1]:null}function Lx(t){void 0!==t.data.value&&(t.value=t.data.value),t.data=t.data.data}function Rx(t){var e=0;do{t.height=e}while((t=t.parent)&&t.height<++e)}function Ix(t){this.data=t,this.depth=this.height=0,this.parent=null}function Nx(t){return null==t?null:Dx(t)}function Dx(t){if("function"!=typeof t)throw new Error;return t}function Fx(){return 0}function jx(t){return function(){return t}}Sx.props={},Ix.prototype=Ox.prototype={constructor:Ix,count:function(){return this.eachAfter(Cx)},each:function(t,e){let n=-1;for(const r of this)t.call(e,r,++n,this);return this},eachAfter:function(t,e){for(var n,r,i,o=this,a=[o],s=[],u=-1;o=a.pop();)if(s.push(o),n=o.children)for(r=0,i=n.length;r<i;++r)a.push(n[r]);for(;o=s.pop();)t.call(e,o,++u,this);return this},eachBefore:function(t,e){for(var n,r,i=this,o=[i],a=-1;i=o.pop();)if(t.call(e,i,++a,this),n=i.children)for(r=n.length-1;r>=0;--r)o.push(n[r]);return this},find:function(t,e){let n=-1;for(const r of this)if(t.call(e,r,++n,this))return r},sum:function(t){return this.eachAfter((function(e){for(var n=+t(e.data)||0,r=e.children,i=r&&r.length;--i>=0;)n+=r[i].value;e.value=n}))},sort:function(t){return this.eachBefore((function(e){e.children&&e.children.sort(t)}))},path:function(t){for(var e=this,n=function(t,e){if(t===e)return t;var n=t.ancestors(),r=e.ancestors(),i=null;t=n.pop(),e=r.pop();for(;t===e;)i=t,t=n.pop(),e=r.pop();return i}(e,t),r=[e];e!==n;)e=e.parent,r.push(e);for(var i=r.length;t!==n;)r.splice(i,0,t),t=t.parent;return r},ancestors:function(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e},descendants:function(){return Array.from(this)},leaves:function(){var t=[];return this.eachBefore((function(e){e.children||t.push(e)})),t},links:function(){var t=this,e=[];return t.each((function(n){n!==t&&e.push({source:n.parent,target:n})})),e},copy:function(){return Ox(this).eachBefore(Lx)},[Symbol.iterator]:function*(){var t,e,n,r,i=this,o=[i];do{for(t=o.reverse(),o=[];i=t.pop();)if(yield i,e=i.children)for(n=0,r=e.length;n<r;++n)o.push(e[n])}while(o.length)}};const Bx=4294967296;function zx(t,e){var n,r;if(Gx(e,t))return[e];for(n=0;n<t.length;++n)if(Ux(e,t[n])&&Gx(Hx(t[n],e),t))return[t[n],e];for(n=0;n<t.length-1;++n)for(r=n+1;r<t.length;++r)if(Ux(Hx(t[n],t[r]),e)&&Ux(Hx(t[n],e),t[r])&&Ux(Hx(t[r],e),t[n])&&Gx(Yx(t[n],t[r],e),t))return[t[n],t[r],e];throw new Error}function Ux(t,e){var n=t.r-e.r,r=e.x-t.x,i=e.y-t.y;return n<0||n*n<r*r+i*i}function Vx(t,e){var n=t.r-e.r+1e-9*Math.max(t.r,e.r,1),r=e.x-t.x,i=e.y-t.y;return n>0&&n*n>r*r+i*i}function Gx(t,e){for(var n=0;n<e.length;++n)if(!Vx(t,e[n]))return!1;return!0}function Wx(t){switch(t.length){case 1:return{x:(e=t[0]).x,y:e.y,r:e.r};case 2:return Hx(t[0],t[1]);case 3:return Yx(t[0],t[1],t[2])}var e}function Hx(t,e){var n=t.x,r=t.y,i=t.r,o=e.x,a=e.y,s=e.r,u=o-n,c=a-r,l=s-i,h=Math.sqrt(u*u+c*c);return{x:(n+o+u/h*l)/2,y:(r+a+c/h*l)/2,r:(h+i+s)/2}}function Yx(t,e,n){var r=t.x,i=t.y,o=t.r,a=e.x,s=e.y,u=e.r,c=n.x,l=n.y,h=n.r,f=r-a,p=r-c,d=i-s,m=i-l,v=u-o,g=h-o,y=r*r+i*i-o*o,x=y-a*a-s*s+u*u,b=y-c*c-l*l+h*h,_=p*d-f*m,w=(d*b-m*x)/(2*_)-r,S=(m*v-d*g)/_,M=(p*x-f*b)/(2*_)-i,E=(f*g-p*v)/_,A=S*S+E*E-1,T=2*(o+w*S+M*E),C=w*w+M*M-o*o,O=-(Math.abs(A)>1e-6?(T+Math.sqrt(T*T-4*A*C))/(2*A):C/T);return{x:r+w+S*O,y:i+M+E*O,r:O}}function Xx(t,e,n){var r,i,o,a,s=t.x-e.x,u=t.y-e.y,c=s*s+u*u;c?(i=e.r+n.r,i*=i,a=t.r+n.r,i>(a*=a)?(r=(c+a-i)/(2*c),o=Math.sqrt(Math.max(0,a/c-r*r)),n.x=t.x-r*s-o*u,n.y=t.y-r*u+o*s):(r=(c+i-a)/(2*c),o=Math.sqrt(Math.max(0,i/c-r*r)),n.x=e.x+r*s-o*u,n.y=e.y+r*u+o*s)):(n.x=e.x+n.r,n.y=e.y)}function qx(t,e){var n=t.r+e.r-1e-6,r=e.x-t.x,i=e.y-t.y;return n>0&&n*n>r*r+i*i}function Zx(t){var e=t._,n=t.next._,r=e.r+n.r,i=(e.x*n.r+n.x*e.r)/r,o=(e.y*n.r+n.y*e.r)/r;return i*i+o*o}function $x(t){this._=t,this.next=null,this.previous=null}function Kx(t,e){if(!(a=(n=t,t="object"==typeof n&&"length"in n?n:Array.from(n)).length))return 0;var n,r,i,o,a,s,u,c,l,h,f,p;if((r=t[0]).x=0,r.y=0,!(a>1))return r.r;if(i=t[1],r.x=-i.r,i.x=r.r,i.y=0,!(a>2))return r.r+i.r;Xx(i,r,o=t[2]),r=new $x(r),i=new $x(i),o=new $x(o),r.next=o.previous=i,i.next=r.previous=o,o.next=i.previous=r;t:for(c=3;c<a;++c){Xx(r._,i._,o=t[c]),o=new $x(o),l=i.next,h=r.previous,f=i._.r,p=r._.r;do{if(f<=p){if(qx(l._,o._)){i=l,r.next=i,i.previous=r,--c;continue t}f+=l._.r,l=l.next}else{if(qx(h._,o._)){(r=h).next=i,i.previous=r,--c;continue t}p+=h._.r,h=h.previous}}while(l!==h.next);for(o.previous=r,o.next=i,r.next=i.previous=i=o,s=Zx(r);(o=o.next)!==i;)(u=Zx(o))<s&&(r=o,s=u);i=r.next}for(r=[i._],o=i;(o=o.next)!==i;)r.push(o._);for(o=function(t,e){for(var n,r,i=0,o=(t=function(t,e){let n,r,i=t.length;for(;i;)r=e()*i--|0,n=t[i],t[i]=t[r],t[r]=n;return t}(Array.from(t),e)).length,a=[];i<o;)n=t[i],r&&Vx(r,n)?++i:(r=Wx(a=zx(a,n)),i=0);return r}(r,e),c=0;c<a;++c)(r=t[c]).x-=o.x,r.y-=o.y;return o.r}function Jx(t){return Math.sqrt(t.value)}function Qx(){var t=null,e=1,n=1,r=Fx;function i(i){const o=function(){let t=1;return()=>(t=(1664525*t+1013904223)%Bx)/Bx}();return i.x=e/2,i.y=n/2,t?i.eachBefore(tb(t)).eachAfter(eb(r,.5,o)).eachBefore(nb(1)):i.eachBefore(tb(Jx)).eachAfter(eb(Fx,1,o)).eachAfter(eb(r,i.r/Math.min(e,n),o)).eachBefore(nb(Math.min(e,n)/(2*i.r))),i}return i.radius=function(e){return arguments.length?(t=Nx(e),i):t},i.size=function(t){return arguments.length?(e=+t[0],n=+t[1],i):[e,n]},i.padding=function(t){return arguments.length?(r="function"==typeof t?t:jx(+t),i):r},i}function tb(t){return function(e){e.children||(e.r=Math.max(0,+t(e)||0))}}function eb(t,e,n){return function(r){if(i=r.children){var i,o,a,s=i.length,u=t(r)*e||0;if(u)for(o=0;o<s;++o)i[o].r+=u;if(a=Kx(i,n),u)for(o=0;o<s;++o)i[o].r-=u;r.r=a+u}}}function nb(t){return function(e){var n=e.parent;e.r*=t,n&&(e.x=n.x+t*e.x,e.y=n.y+t*e.y)}}function rb(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)}function ib(t,e,n,r,i){for(var o,a=t.children,s=-1,u=a.length,c=t.value&&(r-e)/t.value;++s<u;)(o=a[s]).y0=n,o.y1=i,o.x0=e,o.x1=e+=o.value*c}var ob={depth:-1},ab={},sb={};function ub(t){return t.id}function cb(t){return t.parentId}function lb(){var t,e=ub,n=cb;function r(r){var i,o,a,s,u,c,l,h,f=Array.from(r),p=e,d=n,m=new Map;if(null!=t){const e=f.map(((e,n)=>function(t){t=`${t}`;let e=t.length;fb(t,e-1)&&!fb(t,e-2)&&(t=t.slice(0,-1));return"/"===t[0]?t:`/${t}`}(t(e,n,r)))),n=e.map(hb),i=new Set(e).add("");for(const t of n)i.has(t)||(i.add(t),e.push(t),n.push(hb(t)),f.push(sb));p=(t,n)=>e[n],d=(t,e)=>n[e]}for(a=0,i=f.length;a<i;++a)o=f[a],c=f[a]=new Ix(o),null!=(l=p(o,a,r))&&(l+="")&&(h=c.id=l,m.set(h,m.has(h)?ab:c)),null!=(l=d(o,a,r))&&(l+="")&&(c.parent=l);for(a=0;a<i;++a)if(l=(c=f[a]).parent){if(!(u=m.get(l)))throw new Error("missing: "+l);if(u===ab)throw new Error("ambiguous: "+l);u.children?u.children.push(c):u.children=[c],c.parent=u}else{if(s)throw new Error("multiple roots");s=c}if(!s)throw new Error("no root");if(null!=t){for(;s.data===sb&&1===s.children.length;)s=s.children[0],--i;for(let t=f.length-1;t>=0&&(c=f[t]).data===sb;--t)c.data=null}if(s.parent=ob,s.eachBefore((function(t){t.depth=t.parent.depth+1,--i})).eachBefore(Rx),s.parent=null,i>0)throw new Error("cycle");return s}return r.id=function(t){return arguments.length?(e=Nx(t),r):e},r.parentId=function(t){return arguments.length?(n=Nx(t),r):n},r.path=function(e){return arguments.length?(t=Nx(e),r):t},r}function hb(t){let e=t.length;if(e<2)return"";for(;--e>1&&!fb(t,e););return t.slice(0,e)}function fb(t,e){if("/"===t[e]){let n=0;for(;e>0&&"\\"===t[--e];)++n;if(0==(1&n))return!0}return!1}function pb(t,e){return t.parent===e.parent?1:2}function db(t){var e=t.children;return e?e[0]:t.t}function mb(t){var e=t.children;return e?e[e.length-1]:t.t}function vb(t,e,n){var r=n/(e.i-t.i);e.c-=r,e.s+=n,t.c+=r,e.z+=n,e.m+=n}function gb(t,e,n){return t.a.parent===e.parent?t.a:n}function yb(t,e){this._=t,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=e}function xb(){var t=pb,e=1,n=1,r=null;function i(i){var u=function(t){for(var e,n,r,i,o,a=new yb(t,0),s=[a];e=s.pop();)if(r=e._.children)for(e.children=new Array(o=r.length),i=o-1;i>=0;--i)s.push(n=e.children[i]=new yb(r[i],i)),n.parent=e;return(a.parent=new yb(null,0)).children=[a],a}(i);if(u.eachAfter(o),u.parent.m=-u.z,u.eachBefore(a),r)i.eachBefore(s);else{var c=i,l=i,h=i;i.eachBefore((function(t){t.x<c.x&&(c=t),t.x>l.x&&(l=t),t.depth>h.depth&&(h=t)}));var f=c===l?1:t(c,l)/2,p=f-c.x,d=e/(l.x+f+p),m=n/(h.depth||1);i.eachBefore((function(t){t.x=(t.x+p)*d,t.y=t.depth*m}))}return i}function o(e){var n=e.children,r=e.parent.children,i=e.i?r[e.i-1]:null;if(n){!function(t){for(var e,n=0,r=0,i=t.children,o=i.length;--o>=0;)(e=i[o]).z+=n,e.m+=n,n+=e.s+(r+=e.c)}(e);var o=(n[0].z+n[n.length-1].z)/2;i?(e.z=i.z+t(e._,i._),e.m=e.z-o):e.z=o}else i&&(e.z=i.z+t(e._,i._));e.parent.A=function(e,n,r){if(n){for(var i,o=e,a=e,s=n,u=o.parent.children[0],c=o.m,l=a.m,h=s.m,f=u.m;s=mb(s),o=db(o),s&&o;)u=db(u),(a=mb(a)).a=e,(i=s.z+h-o.z-c+t(s._,o._))>0&&(vb(gb(s,e,r),e,i),c+=i,l+=i),h+=s.m,c+=o.m,f+=u.m,l+=a.m;s&&!mb(a)&&(a.t=s,a.m+=h-l),o&&!db(u)&&(u.t=o,u.m+=c-f,r=e)}return r}(e,i,e.parent.A||r[0])}function a(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function s(t){t.x*=e,t.y=t.depth*n}return i.separation=function(e){return arguments.length?(t=e,i):t},i.size=function(t){return arguments.length?(r=!1,e=+t[0],n=+t[1],i):r?null:[e,n]},i.nodeSize=function(t){return arguments.length?(r=!0,e=+t[0],n=+t[1],i):r?[e,n]:null},i}function bb(t,e,n,r,i){for(var o,a=t.children,s=-1,u=a.length,c=t.value&&(i-n)/t.value;++s<u;)(o=a[s]).x0=e,o.x1=r,o.y0=n,o.y1=n+=o.value*c}yb.prototype=Object.create(Ix.prototype);var _b=(1+Math.sqrt(5))/2;function wb(t,e,n,r,i,o){for(var a,s,u,c,l,h,f,p,d,m,v,g=[],y=e.children,x=0,b=0,_=y.length,w=e.value;x<_;){u=i-n,c=o-r;do{l=y[b++].value}while(!l&&b<_);for(h=f=l,v=l*l*(m=Math.max(c/u,u/c)/(w*t)),d=Math.max(f/v,v/h);b<_;++b){if(l+=s=y[b].value,s<h&&(h=s),s>f&&(f=s),v=l*l*m,(p=Math.max(f/v,v/h))>d){l-=s;break}d=p}g.push(a={value:l,dice:u<c,children:y.slice(x,b)}),a.dice?ib(a,n,r,i,w?r+=c*l/w:o):bb(a,n,r,w?n+=u*l/w:i,o),w-=l,x=b}return g}const Sb=function t(e){function n(t,n,r,i,o){wb(e,t,n,r,i,o)}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(_b);function Mb(t,e,n,r,i){var o,a,s=t.children,u=s.length,c=new Array(u+1);for(c[0]=a=o=0;o<u;++o)c[o+1]=a+=s[o].value;!function t(e,n,r,i,o,a,u){if(e>=n-1){var l=s[e];return l.x0=i,l.y0=o,l.x1=a,void(l.y1=u)}var h=c[e],f=r/2+h,p=e+1,d=n-1;for(;p<d;){var m=p+d>>>1;c[m]<f?p=m+1:d=m}f-c[p-1]<c[p]-f&&e+1<p&&--p;var v=c[p]-h,g=r-v;if(a-i>u-o){var y=r?(i*g+a*v)/r:a;t(e,p,v,i,o,y,u),t(p,n,g,y,o,a,u)}else{var x=r?(o*g+u*v)/r:u;t(e,p,v,i,o,a,x),t(p,n,g,i,x,a,u)}}(0,u,t.value,e,n,r,i)}function Eb(t,e,n,r,i){(1&t.depth?bb:ib)(t,e,n,r,i)}const Ab=function t(e){function n(t,n,r,i,o){if((a=t._squarify)&&a.ratio===e)for(var a,s,u,c,l,h=-1,f=a.length,p=t.value;++h<f;){for(u=(s=a[h]).children,c=s.value=0,l=u.length;c<l;++c)s.value+=u[c].value;s.dice?ib(s,n,r,i,p?r+=(o-r)*s.value/p:o):bb(s,n,r,p?n+=(i-n)*s.value/p:i,o),p-=s.value}else t._squarify=a=wb(e,t,n,r,i,o),a.ratio=e}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(_b);function Tb(t={}){const{shapes:e}=t;return[{name:"color"},{name:"opacity"},{name:"shape",range:e},{name:"enterType"},{name:"enterDelay",scaleKey:"enter"},{name:"enterDuration",scaleKey:"enter"},{name:"enterEasing"},{name:"key",scale:"identity"},{name:"groupKey",scale:"identity"},{name:"label",scale:"identity"}]}function Cb(t={}){return[...Tb(t),{name:"title",scale:"identity"},{name:"tooltip",scale:"identity",independent:!0}]}function Ob(t={}){return Tb(t)}function kb(t,e){return t.getBandWidth(t.invert(e))}function Pb(t,e,n={}){const{x:r,y:i,series:o}=e,{x:a,y:s,series:u}=t,{style:{bandOffset:c=(u?0:.5),bandOffsetX:l=c,bandOffsetY:h=c}={}}=n,f=!!(null==a?void 0:a.getBandWidth),p=!!(null==s?void 0:s.getBandWidth),d=!!(null==u?void 0:u.getBandWidth);return f||p?(t,e)=>{const n=f?kb(a,r[e]):0,c=p?kb(s,i[e]):0,m=d&&o?(kb(u,o[e])/2+ +o[e])*n:0,[v,g]=t;return[v+l*n+m,g+h*c]}:t=>t}function Lb(t){return parseFloat(t)/100}function Rb(t,e,n,r){const{x:i,y:o}=n,{width:a,height:s}=r.getOptions(),u=Array.from(t,(t=>{const e=i[t],n=o[t];return[["string"==typeof e?Lb(e)*a:+e,"string"==typeof n?Lb(n)*s:+n]]}));return[t,u]}function Ib(t){return"function"==typeof t?t:e=>e[t]}function Nb(t,e){return Array.from(t,Ib(e))}function Db(t,e){const{source:n=(t=>t.source),target:r=(t=>t.target),value:i=(t=>t.value)}=e,{links:o,nodes:a}=t,s=Nb(o,n),u=Nb(o,r),c=Nb(o,i);return{links:o.map(((t,e)=>({target:u[e],source:s[e],value:c[e]}))),nodes:a||Array.from(new Set([...s,...u]),(t=>({key:t})))}}function Fb(t,e){return t.getBandWidth(t.invert(e))}const jb=()=>(t,e,n,r)=>{const{x:i,y:o,y1:a,series:s,size:u}=n,c=e.x,l=e.series,[h]=r.getSize(),f=u?u.map((t=>+t/h)):null,p=u?(t,e,n)=>{const r=t+e/2,i=f[n];return[r-i/2,r+i/2]}:(t,e,n)=>[t,t+e],d=Array.from(t,(t=>{const e=Fb(c,i[t]),n=e*(l?Fb(l,null==s?void 0:s[t]):1),u=(+(null==s?void 0:s[t])||0)*e,h=+i[t]+u,[f,d]=p(h,n,t),m=+o[t],v=+a[t];return[[f,m],[d,m],[d,v],[f,v]].map((t=>r.map(t)))}));return[t,d]};jb.props={defaultShape:"rect",defaultLabelShape:"label",channels:[...Cb({shapes:["rect","hollow","funnel","pyramid"]}),{name:"x",scale:"band",required:!0},{name:"y",required:!0},{name:"series",scale:"band"},{name:"size"}],preInference:[{type:"maybeZeroY1"},{type:"maybeZeroX"}],postInference:[{type:"maybeKey"},{type:"maybeTitle",channel:"x"},{type:"maybeTooltip",channel:["y"]}],interaction:{shareTooltip:!0}};const Bb=()=>(t,e,n,r)=>{const{x:i,x1:o,y:a,y1:s}=n,u=Array.from(t,(t=>[[+i[t],+a[t]],[+o[t],+a[t]],[+o[t],+s[t]],[+i[t],+s[t]]].map((t=>r.map(t)))));return[t,u]};function zb(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Ub(t,e){return null==t||null==e?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Vb(t){let e,n,r;function i(t,r,i=0,o=t.length){if(i<o){if(0!==e(r,r))return o;do{const e=i+o>>>1;n(t[e],r)<0?i=e+1:o=e}while(i<o)}return i}return 2!==t.length?(e=zb,n=(e,n)=>zb(t(e),n),r=(e,n)=>t(e)-n):(e=t===zb||t===Ub?t:Gb,n=t,r=t),{left:i,center:function(t,e,n=0,o=t.length){const a=i(t,e,n,o-1);return a>n&&r(t[a-1],e)>-r(t[a],e)?a-1:a},right:function(t,r,i=0,o=t.length){if(i<o){if(0!==e(r,r))return o;do{const e=i+o>>>1;n(t[e],r)<=0?i=e+1:o=e}while(i<o)}return i}}}function Gb(){return 0}Bb.props={defaultShape:"rect",defaultLabelShape:"label",channels:[...Cb({shapes:["rect","hollow"]}),{name:"x",required:!0},{name:"y",required:!0}],preInference:[{type:"maybeZeroY1"}],postInference:[{type:"maybeKey"},{type:"maybeTitle",channel:"x"},{type:"maybeTooltip",channel:["y"]}],interaction:{shareTooltip:!0}};const Wb=Vb(zb).right,Hb=Vb((function(t){return null===t?NaN:+t})).center,Yb=Wb;function Xb(t,e){let n=0;if(void 0===e)for(let r of t)null!=r&&(r=+r)>=r&&++n;else{let r=-1;for(let i of t)null!=(i=e(i,++r,t))&&(i=+i)>=i&&++n}return n}function qb(t,e){const n=function(t,e){let n,r=0,i=0,o=0;if(void 0===e)for(let a of t)null!=a&&(a=+a)>=a&&(n=a-i,i+=n/++r,o+=n*(a-i));else{let a=-1;for(let s of t)null!=(s=e(s,++a,t))&&(s=+s)>=s&&(n=s-i,i+=n/++r,o+=n*(s-i))}if(r>1)return o/(r-1)}(t,e);return n?Math.sqrt(n):n}function Zb(t,e){let n,r;if(void 0===e)for(const i of t)null!=i&&(void 0===n?i>=i&&(n=r=i):(n>i&&(n=i),r<i&&(r=i)));else{let i=-1;for(let o of t)null!=(o=e(o,++i,t))&&(void 0===n?o>=o&&(n=r=o):(n>o&&(n=o),r<o&&(r=o)))}return[n,r]}class $b{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const e=this._partials;let n=0;for(let r=0;r<this._n&&r<32;r++){const i=e[r],o=t+i,a=Math.abs(t)<Math.abs(i)?t-(o-i):i-(o-t);a&&(e[n++]=a),t=o}return e[n]=t,this._n=n+1,this}valueOf(){const t=this._partials;let e,n,r,i=this._n,o=0;if(i>0){for(o=t[--i];i>0&&(e=o,n=t[--i],o=e+n,r=n-(o-e),!r););i>0&&(r<0&&t[i-1]<0||r>0&&t[i-1]>0)&&(n=2*r,e=o+n,n==e-o&&(o=e))}return o}}let Kb=class extends Map{constructor(t,e=Qb){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:e}}),null!=t)for(const[n,r]of t)this.set(n,r)}get(t){return super.get(Jb(this,t))}has(t){return super.has(Jb(this,t))}set(t,e){return super.set(function({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):(t.set(r,n),n)}(this,t),e)}delete(t){return super.delete(function({_intern:t,_key:e},n){const r=e(n);t.has(r)&&(n=t.get(r),t.delete(r));return n}(this,t))}};function Jb({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):n}function Qb(t){return null!==t&&"object"==typeof t?t.valueOf():t}function t_(t){return t}function e_(t,...e){return i_(t,t_,t_,e)}function n_(t,e,...n){return i_(t,t_,e,n)}function r_(t,e,...n){return i_(t,Array.from,e,n)}function i_(t,e,n,r){return function t(i,o){if(o>=r.length)return n(i);const a=new Kb,s=r[o++];let u=-1;for(const e of i){const t=s(e,++u,i),n=a.get(t);n?n.push(e):a.set(t,[e])}for(const[e,n]of a)a.set(e,t(n,o));return e(a)}(t,0)}function o_(t,...e){if("function"!=typeof t[Symbol.iterator])throw new TypeError("values is not iterable");t=Array.from(t);let[n]=e;if(n&&2!==n.length||e.length>1){const o=Uint32Array.from(t,((t,e)=>e));return e.length>1?(e=e.map((e=>t.map(e))),o.sort(((t,n)=>{for(const r of e){const e=s_(r[t],r[n]);if(e)return e}}))):(n=t.map(n),o.sort(((t,e)=>s_(n[t],n[e])))),r=t,i=o,Array.from(i,(t=>r[t]))}var r,i;return t.sort(a_(n))}function a_(t=zb){if(t===zb)return s_;if("function"!=typeof t)throw new TypeError("compare is not a function");return(e,n)=>{const r=t(e,n);return r||0===r?r:(0===t(n,n))-(0===t(e,e))}}function s_(t,e){return(null==t||!(t>=t))-(null==e||!(e>=e))||(t<e?-1:t>e?1:0)}var u_=Array.prototype.slice;function c_(t){return()=>t}var l_=Math.sqrt(50),h_=Math.sqrt(10),f_=Math.sqrt(2);function p_(t,e,n){var r=(e-t)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),o=r/Math.pow(10,i);return i>=0?(o>=l_?10:o>=h_?5:o>=f_?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(o>=l_?10:o>=h_?5:o>=f_?2:1)}function d_(t){return Math.ceil(Math.log(Xb(t))/Math.LN2)+1}function m_(){var t=t_,e=Zb,n=d_;function r(r){Array.isArray(r)||(r=Array.from(r));var i,o,a,s=r.length,u=new Array(s);for(i=0;i<s;++i)u[i]=t(r[i],i,r);var c=e(u),l=c[0],h=c[1],f=n(u,l,h);if(!Array.isArray(f)){const t=h,n=+f;if(e===Zb&&([l,h]=function(t,e,n){let r;for(;;){const i=p_(t,e,n);if(i===r||0===i||!isFinite(i))return[t,e];i>0?(t=Math.floor(t/i)*i,e=Math.ceil(e/i)*i):i<0&&(t=Math.ceil(t*i)/i,e=Math.floor(e*i)/i),r=i}}(l,h,n)),f=function(t,e,n){var r,i,o,a,s=-1;if(n=+n,(t=+t)==(e=+e)&&n>0)return[t];if((r=e<t)&&(i=t,t=e,e=i),0===(a=p_(t,e,n))||!isFinite(a))return[];if(a>0){let n=Math.round(t/a),r=Math.round(e/a);for(n*a<t&&++n,r*a>e&&--r,o=new Array(i=r-n+1);++s<i;)o[s]=(n+s)*a}else{a=-a;let n=Math.round(t*a),r=Math.round(e*a);for(n/a<t&&++n,r/a>e&&--r,o=new Array(i=r-n+1);++s<i;)o[s]=(n+s)/a}return r&&o.reverse(),o}(l,h,n),f[0]<=l&&(a=p_(l,h,n)),f[f.length-1]>=h)if(t>=h&&e===Zb){const t=p_(l,h,n);isFinite(t)&&(t>0?h=(Math.floor(h/t)+1)*t:t<0&&(h=(Math.ceil(h*-t)+1)/-t))}else f.pop()}for(var p=f.length,d=0,m=p;f[d]<=l;)++d;for(;f[m-1]>h;)--m;(d||m<p)&&(f=f.slice(d,m),p=m-d);var v,g=new Array(p+1);for(i=0;i<=p;++i)(v=g[i]=[]).x0=i>0?f[i-1]:l,v.x1=i<p?f[i]:h;if(isFinite(a)){if(a>0)for(i=0;i<s;++i)null!=(o=u[i])&&l<=o&&o<=h&&g[Math.min(p,Math.floor((o-l)/a))].push(r[i]);else if(a<0)for(i=0;i<s;++i)if(null!=(o=u[i])&&l<=o&&o<=h){const t=Math.floor((l-o)*a);g[Math.min(p,t+(f[t]<=o))].push(r[i])}}else for(i=0;i<s;++i)null!=(o=u[i])&&l<=o&&o<=h&&g[Yb(f,o,0,p)].push(r[i]);return g}return r.value=function(e){return arguments.length?(t="function"==typeof e?e:c_(e),r):t},r.domain=function(t){return arguments.length?(e="function"==typeof t?t:c_([t[0],t[1]]),r):e},r.thresholds=function(t){return arguments.length?(n="function"==typeof t?t:c_(Array.isArray(t)?u_.call(t):t),r):n},r}function v_(t,e){let n;if(void 0===e)for(const r of t)null!=r&&(n<r||void 0===n&&r>=r)&&(n=r);else{let r=-1;for(let i of t)null!=(i=e(i,++r,t))&&(n<i||void 0===n&&i>=i)&&(n=i)}return n}function g_(t,e){let n,r=-1,i=-1;if(void 0===e)for(const o of t)++i,null!=o&&(n<o||void 0===n&&o>=o)&&(n=o,r=i);else for(let o of t)null!=(o=e(o,++i,t))&&(n<o||void 0===n&&o>=o)&&(n=o,r=i);return r}function y_(t,e){let n;if(void 0===e)for(const r of t)null!=r&&(n>r||void 0===n&&r>=r)&&(n=r);else{let r=-1;for(let i of t)null!=(i=e(i,++r,t))&&(n>i||void 0===n&&i>=i)&&(n=i)}return n}function x_(t,e,n=0,r=1/0,i){if(e=Math.floor(e),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(t.length-1,r)),!(n<=e&&e<=r))return t;for(i=void 0===i?s_:a_(i);r>n;){if(r-n>600){const o=r-n+1,a=e-n+1,s=Math.log(o),u=.5*Math.exp(2*s/3),c=.5*Math.sqrt(s*u*(o-u)/o)*(a-o/2<0?-1:1);x_(t,e,Math.max(n,Math.floor(e-a*u/o+c)),Math.min(r,Math.floor(e+(o-a)*u/o+c)),i)}const o=t[e];let a=n,s=r;for(b_(t,n,e),i(t[r],o)>0&&b_(t,n,r);a<s;){for(b_(t,a,s),++a,--s;i(t[a],o)<0;)++a;for(;i(t[s],o)>0;)--s}0===i(t[n],o)?b_(t,n,s):(++s,b_(t,s,r)),s<=e&&(n=s+1),e<=s&&(r=s-1)}return t}function b_(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function __(t,e,n){if(t=Float64Array.from(function*(t,e){if(void 0===e)for(let n of t)null!=n&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of t)null!=(r=e(r,++n,t))&&(r=+r)>=r&&(yield r)}}(t,n)),(r=t.length)&&!isNaN(e=+e)){if(e<=0||r<2)return y_(t);if(e>=1)return v_(t);var r,i=(r-1)*e,o=Math.floor(i),a=v_(x_(t,o).subarray(0,o+1));return a+(y_(t.subarray(o+1))-a)*(i-o)}}function w_(t,e){let n=0,r=0;if(void 0===e)for(let i of t)null!=i&&(i=+i)>=i&&(++n,r+=i);else{let i=-1;for(let o of t)null!=(o=e(o,++i,t))&&(o=+o)>=o&&(++n,r+=o)}if(n)return r/n}function S_(t,e){return __(t,.5,e)}function M_(t){return Array.from(function*(t){for(const e of t)yield*e}(t))}function E_(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),o=new Array(i);++r<i;)o[r]=t+r*n;return o}function A_(t,e){let n=0;if(void 0===e)for(let r of t)(r=+r)&&(n+=r);else{let r=-1;for(let i of t)(i=+e(i,++r,t))&&(n+=i)}return n}function T_(t){const{transformations:e}=t.getOptions();return e.map((([t])=>t)).filter((t=>"transpose"===t)).length%2!=0}function C_(t){const{transformations:e}=t.getOptions();return e.some((([t])=>"polar"===t))}function O_(t){const{transformations:e}=t.getOptions();return e.some((([t])=>"reflect"===t))&&e.some((([t])=>t.startsWith("transpose")))}function k_(t){const{transformations:e}=t.getOptions();return e.some((([t])=>"helix"===t))}function P_(t){const{transformations:e}=t.getOptions();return e.some((([t])=>"parallel"===t))}function L_(t){const{transformations:e}=t.getOptions();return e.some((([t])=>"fisheye"===t))}function R_(t){return k_(t)||C_(t)}const I_=(t,e,n,r)=>{var i,o;const{series:a,x:s,y:u}=n,{x:c,y:l}=e;if(void 0===s||void 0===u)throw new Error("Missing encode for x or y channel.");const h=a?Array.from(e_(t,(t=>a[t])).values()):[t],f=h.map((t=>t[0])),p=((null===(i=null==c?void 0:c.getBandWidth)||void 0===i?void 0:i.call(c))||0)/2,d=((null===(o=null==l?void 0:l.getBandWidth)||void 0===o?void 0:o.call(l))||0)/2,m=Array.from(h,(t=>t.map((t=>r.map([+s[t]+p,+u[t]+d])))));return[f,m,h]},N_=(t,e,n,r)=>{const i=Object.entries(n).filter((([t])=>t.startsWith("position"))).map((([,t])=>t));if(0===i.length)throw new Error("Missing encode for position channel.");const o=Array.from(t,(t=>{const e=i.map((e=>+e[t])),n=r.map(e),o=[];for(let r=0;r<n.length;r+=2)o.push([n[r],n[r+1]]);return o}));return[t,o]},D_=()=>(t,e,n,r)=>(P_(r)?N_:I_)(t,e,n,r);D_.props={defaultShape:"line",defaultLabelShape:"label",channels:[...Cb({shapes:["line","smooth"]}),{name:"x"},{name:"y"},{name:"position",independent:!0},{name:"size"},{name:"series",scale:"identity"}],preInference:[{type:"maybeSeries"},{type:"maybeGradient"}],postInference:[{type:"maybeKey"},{type:"maybeTitle",channel:"x"},{type:"maybeTooltip",channel:["y"]},{type:"maybeTitle",channel:"color"},{type:"maybeTooltip",channel:["position"]}],interaction:{shareTooltip:!0,seriesTooltip:!0,crosshairs:!0}};const F_=t=>(e,n,r,i)=>{const{x:o,y:a,x1:s,y1:u,size:c,dx:l,dy:h}=r,[f,p]=i.getSize(),d=Pb(n,r,t),m=t=>{const e=+((null==l?void 0:l[t])||0),n=+((null==h?void 0:h[t])||0);return[(s?(+o[t]+ +s[t])/2:+o[t])+e,(u?(+a[t]+ +u[t])/2:+a[t])+n]},v=c?Array.from(e,(t=>{const[e,n]=m(t),r=+c[t],o=r/f,a=r/p,s=[e-o,n-a],u=[e+o,n+a];return[i.map(d(s,t)),i.map(d(u,t))]})):Array.from(e,(t=>[i.map(d(m(t),t))]));return[e,v]};F_.props={defaultShape:"hollow",defaultLabelShape:"label",channels:[...Cb({shapes:["hollow","hollowDiamond","hollowHexagon","hollowSquare","hollowTriangleDown","hollowTriangle","hollowBowtie","point","plus","diamond","square","triangle","hexagon","cross","bowtie","hyphen","line","tick","triangleDown"]}),{name:"x",required:!0},{name:"y",required:!0},{name:"series",scale:"band"},{name:"size",scale:"sqrt"},{name:"dx",scale:"identity"},{name:"dy",scale:"identity"}],preInference:[{type:"maybeZeroY"},{type:"maybeZeroX"}],postInference:[{type:"maybeKey"},{type:"maybeSize"},{type:"maybeTitle",channel:"color"},{type:"maybeTooltip",channel:["x","y"]}]};const j_=t=>{const{cartesian:e=!1}=t;return e?Rb:(n,r,i,o)=>{if(e)return Rb(n,0,i,o);const{x:a,y:s}=i,u=Pb(r,i,t),c=Array.from(n,(t=>{const e=[+a[t],+s[t]];return[o.map(u(e,t))]}));return[n,c]}};j_.props={defaultShape:"text",defaultLabelShape:"label",channels:[...Cb({shapes:["text","badge"]}),{name:"x",required:!0},{name:"y",required:!0},{name:"text",scale:"identity"},{name:"fontSize"},{name:"rotate"}],preInference:[{type:"maybeTuple"},{type:"maybeVisualPosition"}],postInference:[{type:"maybeKey"},{type:"maybeTitle",channel:"color"},{type:"maybeTooltip",channel:["x","y"]}]};const B_=()=>(t,e,n,r)=>{const{x:i,y:o}=n,a=e.x,s=e.y,u=Array.from(t,(t=>{const e=a.getBandWidth(a.invert(+i[t])),n=s.getBandWidth(s.invert(+o[t])),u=+i[t],c=+o[t];return[[u,c],[u+e,c],[u+e,c+n],[u,c+n]].map((t=>r.map(t)))}));return[t,u]};B_.props={defaultShape:"cell",defaultLabelShape:"label",channels:[...Cb({shapes:["cell","hollow"]}),{name:"x",required:!0,scale:"band"},{name:"y",required:!0,scale:"band"}],preInference:[{type:"maybeZeroX"},{type:"maybeZeroY"},{type:"maybeZeroPadding"}],postInference:[{type:"maybeKey"},{type:"maybeTitle",channel:"color"},{type:"maybeTooltip",channel:["x","y"]}]};const z_=()=>(t,e,n,r)=>{const{x:i,y:o,y1:a,series:s}=n,u=s?Array.from(e_(t,(t=>s[t])).values()):[t],c=u.map((t=>t[0])),l=Array.from(u,(t=>{const e=t.length,n=new Array(2*e);for(let s=0;s<t.length;s++){const u=t[s];n[s]=r.map([+i[u],+o[u]]),n[e+s]=r.map([+i[u],+a[u]])}return n}));return[c,l,u]};z_.props={defaultShape:"area",defaultLabelShape:"label",channels:[...Cb({shapes:["area","smooth"]}),{name:"x",required:!0},{name:"y",required:!0},{name:"size"},{name:"series",scale:"identity"}],preInference:[{type:"maybeSeries"},{type:"maybeZeroY1"},{type:"maybeZeroPadding"}],postInference:[{type:"maybeKey"},{type:"maybeTitle",channel:"x"},{type:"maybeTooltip",channel:["y"]}],interaction:{shareTooltip:!0,seriesTooltip:!0,crosshairs:!0}};const U_=t=>(e,n,r,i)=>{const{x:o,y:a,x1:s=o,y1:u=a}=r,c=Pb(n,r,t),l=e.map((t=>[i.map(c([+o[t],+a[t]],t)),i.map(c([+s[t],+u[t]],t))]));return[e,l]};U_.props={defaultShape:"link",defaultLabelShape:"label",channels:[...Cb({shapes:["link","arc","vhv","smooth"]}),{name:"x",required:!0},{name:"y",required:!0}],preInference:[{type:"maybeIdentityY"},{type:"maybeIdentityX"}],postInference:[{type:"maybeKey"},{type:"maybeTitle",channel:"color"},{type:"maybeTooltip",channel:["x","y"]}]};const V_=t=>{const{cartesian:e}=t;return e?Rb:(e,n,r,i)=>{const{x:o,y:a}=r,s=Pb(n,r,t),u=Array.from(e,(t=>{const e=[+o[t],+a[t]];return[i.map(s(e,t))]}));return[e,u]}};V_.props={defaultShape:"image",defaultLabelShape:"label",channels:[...Cb({shapes:["image"]}),{name:"x",required:!0},{name:"y",required:!0},{name:"src",scale:"identity"},{name:"size"}],preInference:[{type:"maybeTuple"},{type:"maybeVisualPosition"}],postInference:[{type:"maybeKey"},{type:"maybeTitle",channel:"color"},{type:"maybeTooltip",channel:["x","y"]}]};const G_=()=>(t,e,n,r)=>{const i=Object.entries(n).filter((([t])=>t.startsWith("x"))).map((([,t])=>t)),o=Object.entries(n).filter((([t])=>t.startsWith("y"))).map((([,t])=>t)),a=t.map((t=>{const e=[];for(let n=0;n<i.length;n++){const a=i[n][t];if(void 0===a)break;const s=o[n][t];e.push(r.map([+a,+s]))}return e}));return[t,a]};G_.props={defaultShape:"polygon",defaultLabelShape:"label",channels:[...Cb({shapes:["polygon","ribbon"]}),{name:"x",required:!0},{name:"y",required:!0}],preInference:[],postInference:[{type:"maybeKey"},{type:"maybeTitle",channel:"color"},{type:"maybeTooltip",channel:["x","y"]}]};const W_=()=>(t,e,n,r)=>{const{x:i,y:o,y1:a,y2:s,y3:u,y4:c,series:l}=n,h=e.x,f=e.series,p=Array.from(t,(t=>{const e=h.getBandWidth(h.invert(+i[t])),n=e*(f?f.getBandWidth(f.invert(+(null==l?void 0:l[t]))):1),p=(+(null==l?void 0:l[t])||0)*e,d=+i[t]+p+n/2,[m,v,g,y,x]=[+o[t],+a[t],+s[t],+u[t],+c[t]];return[[d-n/2,x],[d+n/2,x],[d,x],[d,y],[d-n/2,y],[d+n/2,y],[d+n/2,v],[d-n/2,v],[d-n/2,g],[d+n/2,g],[d,v],[d,m],[d-n/2,m],[d+n/2,m]].map((t=>r.map(t)))}));return[t,p]};W_.props={defaultShape:"box",defaultLabelShape:"label",channels:[...Cb({shapes:["box"]}),{name:"x",scale:"band",required:!0},{name:"y",required:!0},{name:"series",scale:"band"}],preInference:[{type:"maybeZeroX"}],postInference:[{type:"maybeKey"},{type:"maybeTitle",channel:"x"},{type:"maybeTooltip",channel:["y"]}],interaction:{shareTooltip:!0}};const H_=()=>(t,e,n,r)=>{const{x:i,y:o,size:a,rotate:s}=n,[u,c]=r.getSize(),l=t.map((t=>{const e=+s[t]/180*Math.PI,n=+a[t],l=n/c,h=n/u*Math.cos(e),f=-l*Math.sin(e);return[r.map([+i[t]-h/2,+o[t]-f/2]),r.map([+i[t]+h/2,+o[t]+f/2])]}));return[t,l]};H_.props={defaultShape:"vector",defaultLabelShape:"label",channels:[...Cb({shapes:["vector"]}),{name:"x",required:!0},{name:"y",required:!0},{name:"rotate",required:!0,scale:"identity"},{name:"size",required:!0}],preInference:[],postInference:[{type:"maybeKey"},{type:"maybeTitle",channel:"color"},{type:"maybeTooltip",channel:["x","y"]}]};const Y_=()=>(t,e,n,r)=>{const{y:i}=n,o=Array.from(t,(t=>[[0,i[t]],[1,i[t]]].map((t=>r.map(t)))));return[t,o]};Y_.props={defaultShape:"line",defaultLabelShape:"label",channels:[...Ob({shapes:["line"]}),{name:"y",required:!0}],preInference:[{type:"maybeTupleY"}],postInference:[{type:"maybeKey"}]};const X_=()=>(t,e,n,r)=>{const{x:i}=n,o=Array.from(t,(t=>[[i[t],1],[i[t],0]].map((t=>r.map(t)))));return[t,o]};X_.props={defaultShape:"line",defaultLabelShape:"label",channels:[...Ob({shapes:["line"]}),{name:"x",required:!0}],preInference:[{type:"maybeTupleX"}],postInference:[{type:"maybeKey"}]};const q_=(...t)=>U_(...t);function Z_(t,e,n,r){if(e)return()=>[0,1];const{[t]:i,[`${t}1`]:o}=n;return t=>{var e;const n=(null===(e=r.getBandWidth)||void 0===e?void 0:e.call(r,r.invert(+o[t])))||0;return[i[t],o[t]+n]}}function $_(t={}){const{extendX:e=!1,extendY:n=!1}=t;return(t,r,i,o)=>{const a=Z_("x",e,i,r.x),s=Z_("y",n,i,r.y),u=Array.from(t,(t=>{const[e,n]=a(t),[r,i]=s(t);return[[e,r],[n,r],[n,i],[e,i]].map((t=>o.map(t)))}));return[t,u]}}q_.props={defaultShape:"connector",defaultLabelShape:"label",channels:[...Ob({shapes:["connector"]}),{name:"x",required:!0},{name:"y",required:!0}],preInference:[],postInference:[{type:"maybeKey"}]};const K_=()=>$_();K_.props={defaultShape:"range",defaultLabelShape:"label",channels:[...Ob({shapes:["range"]}),{name:"x",required:!0},{name:"y",required:!0}],preInference:[],postInference:[{type:"maybeKey"}]};const J_=()=>$_({extendY:!0});J_.props={defaultShape:"range",defaultLabelShape:"label",channels:[...Ob({shapes:["range"]}),{name:"x",required:!0}],preInference:[],postInference:[{type:"maybeKey"}]};const Q_=()=>$_({extendX:!0});function tw(t){return t.target.depth}function ew(t,e){return t.sourceLinks.length?t.depth:e-1}function nw(t){return function(){return t}}function rw(t,e){return ow(t.source,e.source)||t.index-e.index}function iw(t,e){return ow(t.target,e.target)||t.index-e.index}function ow(t,e){return t.y0-e.y0}function aw(t){return t.value}function sw(t){return t.index}function uw(t){return t.nodes}function cw(t){return t.links}function lw(t,e){const n=t.get(e);if(!n)throw new Error("missing: "+e);return n}function hw({nodes:t}){for(const e of t){let t=e.y0,n=t;for(const r of e.sourceLinks)r.y0=t+r.width/2,t+=r.width;for(const r of e.targetLinks)r.y1=n+r.width/2,n+=r.width}}function fw(){let t,e,n,r,i=0,o=0,a=1,s=1,u=24,c=8,l=sw,h=ew,f=uw,p=cw,d=6;function m(m){const y={nodes:f(m),links:p(m)};return function({nodes:t,links:e}){t.forEach(((t,e)=>{t.index=e,t.sourceLinks=[],t.targetLinks=[]}));const n=new Map(t.map((t=>[l(t),t])));if(e.forEach(((t,e)=>{t.index=e;let{source:r,target:i}=t;"object"!=typeof r&&(r=t.source=lw(n,r)),"object"!=typeof i&&(i=t.target=lw(n,i)),r.sourceLinks.push(t),i.targetLinks.push(t)})),null!=r)for(const{sourceLinks:i,targetLinks:o}of t)i.sort(r),o.sort(r)}(y),function({nodes:t}){for(const e of t)e.value=void 0===e.fixedValue?Math.max(A_(e.sourceLinks,aw),A_(e.targetLinks,aw)):e.fixedValue}(y),function({nodes:t}){const n=t.length;let r=new Set(t),i=new Set,o=0;for(;r.size;){if(r.forEach((t=>{t.depth=o;for(const{target:e}of t.sourceLinks)i.add(e)})),++o>n)throw new Error("circular link");r=i,i=new Set}if(e){const n=Math.max(v_(t,(t=>t.depth))+1,0);let r;for(let i=0;i<t.length;i++)r=t[i],r.depth=e.call(null,r,n)}}(y),function({nodes:t}){const e=t.length;let n=new Set(t),r=new Set,i=0;for(;n.size;){if(n.forEach((t=>{t.height=i;for(const{source:e}of t.targetLinks)r.add(e)})),++i>e)throw new Error("circular link");n=r,r=new Set}}(y),function(e){const r=function({nodes:t}){const e=Math.max(v_(t,(t=>t.depth))+1,0),r=(a-i-u)/(e-1),o=new Array(e).fill(0).map((()=>[]));for(const n of t){const t=Math.max(0,Math.min(e-1,Math.floor(h.call(null,n,e))));n.layer=t,n.x0=i+t*r,n.x1=n.x0+u,o[t]?o[t].push(n):o[t]=[n]}if(n)for(const i of o)i.sort(n);return o}(e);t=Math.min(c,(s-o)/(v_(r,(t=>t.length))-1)),function(e){const n=y_(e,(e=>(s-o-(e.length-1)*t)/A_(e,aw)));for(const r of e){let e=o;for(const i of r){i.y0=e,i.y1=e+i.value*n,e=i.y1+t;for(const t of i.sourceLinks)t.width=t.value*n}e=(s-e+t)/(r.length+1);for(let t=0;t<r.length;++t){const n=r[t];n.y0+=e*(t+1),n.y1+=e*(t+1)}w(r)}}(r);for(let t=0;t<d;++t){const e=Math.pow(.99,t),n=Math.max(1-e,(t+1)/d);g(r,e,n),v(r,e,n)}}(y),hw(y),y}function v(t,e,r){for(let i=1,o=t.length;i<o;++i){const o=t[i];for(const t of o){let n=0,r=0;for(const{source:e,value:o}of t.targetLinks){const i=o*(t.layer-e.layer);n+=S(e,t)*i,r+=i}if(!(r>0))continue;const i=(n/r-t.y0)*e;t.y0+=i,t.y1+=i,_(t)}void 0===n&&o.sort(ow),o.length&&y(o,r)}}function g(t,e,r){for(let i=t.length-2;i>=0;--i){const o=t[i];for(const t of o){let n=0,r=0;for(const{target:e,value:o}of t.sourceLinks){const i=o*(e.layer-t.layer);n+=M(t,e)*i,r+=i}if(!(r>0))continue;const i=(n/r-t.y0)*e;t.y0+=i,t.y1+=i,_(t)}void 0===n&&o.sort(ow),o.length&&y(o,r)}}function y(e,n){const r=e.length>>1,i=e[r];b(e,i.y0-t,r-1,n),x(e,i.y1+t,r+1,n),b(e,s,e.length-1,n),x(e,o,0,n)}function x(e,n,r,i){for(;r<e.length;++r){const o=e[r],a=(n-o.y0)*i;a>1e-6&&(o.y0+=a,o.y1+=a),n=o.y1+t}}function b(e,n,r,i){for(;r>=0;--r){const o=e[r],a=(o.y1-n)*i;a>1e-6&&(o.y0-=a,o.y1-=a),n=o.y0-t}}function _({sourceLinks:t,targetLinks:e}){if(void 0===r){for(const{source:{sourceLinks:t}}of e)t.sort(iw);for(const{target:{targetLinks:e}}of t)e.sort(rw)}}function w(t){if(void 0===r)for(const{sourceLinks:e,targetLinks:n}of t)e.sort(iw),n.sort(rw)}function S(e,n){let r=e.y0-(e.sourceLinks.length-1)*t/2;for(const{target:i,width:o}of e.sourceLinks){if(i===n)break;r+=o+t}for(const{source:t,width:i}of n.targetLinks){if(t===e)break;r-=i}return r}function M(e,n){let r=n.y0-(n.targetLinks.length-1)*t/2;for(const{source:i,width:o}of n.targetLinks){if(i===e)break;r+=o+t}for(const{target:t,width:i}of e.sourceLinks){if(t===n)break;r-=i}return r}return m.update=function(t){return hw(t),t},m.nodeId=function(t){return arguments.length?(l="function"==typeof t?t:nw(t),m):l},m.nodeAlign=function(t){return arguments.length?(h="function"==typeof t?t:nw(t),m):h},m.nodeDepth=function(t){return arguments.length?(e=t,m):e},m.nodeSort=function(t){return arguments.length?(n=t,m):n},m.nodeWidth=function(t){return arguments.length?(u=+t,m):u},m.nodePadding=function(e){return arguments.length?(c=t=+e,m):c},m.nodes=function(t){return arguments.length?(f="function"==typeof t?t:nw(t),m):f},m.links=function(t){return arguments.length?(p="function"==typeof t?t:nw(t),m):p},m.linkSort=function(t){return arguments.length?(r=t,m):r},m.size=function(t){return arguments.length?(i=o=0,a=+t[0],s=+t[1],m):[a-i,s-o]},m.extent=function(t){return arguments.length?(i=+t[0][0],a=+t[1][0],o=+t[0][1],s=+t[1][1],m):[[i,o],[a,s]]},m.iterations=function(t){return arguments.length?(d=+t,m):d},m}Q_.props={defaultShape:"range",defaultLabelShape:"label",channels:[...Ob({shapes:["range"]}),{name:"y",required:!0}],preInference:[],postInference:[{type:"maybeKey"}]};const pw={nodeAlign:"justify",nodeWidth:.008,nodePadding:.03,nodes:t=>t.nodes,links:t=>t.links,nodeSort:void 0,linkSort:void 0,iterations:6},dw={left:function(t){return t.depth},right:function(t,e){return e-1-t.height},center:function(t){return t.targetLinks.length?t.depth:t.sourceLinks.length?y_(t.sourceLinks,tw)-1:0},justify:ew};const mw=t=>e=>{const{nodeId:n,nodeSort:r,nodeAlign:i,nodeWidth:o,nodePadding:a,nodeDepth:s,nodes:u,links:c,linkSort:l,iterations:h}=Object.assign({},pw,t),f=fw().nodeSort(r).linkSort(l).links(c).nodes(u).nodeWidth(o).nodePadding(a).nodeDepth(s).nodeAlign(function(t){const e=typeof t;return"string"===e?dw[t]||ew:"function"===e?t:ew}(i)).iterations(h).extent([[0,0],[1,1]]);"function"==typeof n&&f.nodeId(n);const p=f(e),{nodes:d,links:m}=p;return{nodes:d.map((t=>{const{x0:e,x1:n,y0:r,y1:i}=t;return Object.assign(Object.assign({},t),{x:[e,n,n,e],y:[r,r,i,i]})})),links:m.map((t=>{const{source:e,target:n}=t,r=e.x1,i=n.x0,o=t.width/2;return Object.assign(Object.assign({},t),{x:[r,r,i,i],y:[t.y0+o,t.y0-o,t.y1+o,t.y1-o]})}))}};mw.props={};var vw=globalThis&&globalThis.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(e){o(e)}}function s(t){try{u(r.throw(t))}catch(e){o(e)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))};function gw(t){return t}function yw(t){return t.reduce(((t,e)=>(n,...r)=>e(t(n,...r),...r)),gw)}function xw(t){return t.replace(/( |^)[a-z]/g,(t=>t.toUpperCase()))}function bw(t=""){throw new Error(t)}function _w(t,e){const{attributes:n}=e,r=new Set(["id","className"]);for(const[i,o]of Object.entries(n))r.has(i)||t.attr(i,o)}function ww(t){return null!=t&&!Number.isNaN(t)}function Sw(t){const e=new Map;return n=>{if(e.has(n))return e.get(n);const r=t(n);return e.set(n,r),r}}function Mw(t,e){return Ew(t,e)||{}}function Ew(t,e){const n=Object.entries(t).filter((([t])=>t.startsWith(e))).map((([t,n])=>[Ky(t.replace(e,"").trim()),n])).filter((([t])=>!!t));return 0===n.length?null:Object.fromEntries(n)}function Aw(t,e){if(void 0===t)return null;if("number"==typeof t)return t;const n=+t.replace("%","");return Number.isNaN(n)?null:n/100*e}function Tw(t){return"object"==typeof t&&!(t instanceof Date)&&null!==t}var Cw=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const Ow=t=>{const e={nodeId:t=>t.key,nodeWidth:.02,nodePadding:.02},n={type:"polygon",axis:!1,legend:!1,encode:{shape:"polygon",x:"x",y:"y"},scale:{x:{type:"identity"},y:{type:"identity"}},style:{stroke:"#000"}},r={type:"polygon",axis:!1,legend:!1,encode:{shape:"ribbon",x:"x",y:"y"},style:{fillOpacity:.5,stroke:null}},i={textAlign:t=>t.x[0]<.5?"start":"end",position:t=>t.x[0]<.5?"right":"left",fontSize:10};return()=>{const{data:o,encode:a={},scale:s,style:u={},layout:c={},nodeLabels:l=[],linkLabels:h=[],animate:f={}}=t,{links:p,nodes:d}=Db(o,a),m=Mw(a,"node"),v=Mw(a,"link"),{key:g=(t=>t.key),color:y=g}=m,{links:x,nodes:b}=mw(Object.assign(Object.assign(Object.assign({},e),{nodeId:Ib(g)}),c))({links:p,nodes:d}),_=Mw(u,"label"),{text:w=g,spacing:S=5}=_,M=Cw(_,["text","spacing"]);return[tx({},n,{data:b,encode:Object.assign(Object.assign({},m),{color:y}),scale:s,style:Mw(u,"node"),labels:[Object.assign(Object.assign(Object.assign({},i),{text:w,dx:t=>t.x[0]<.5?S:-S}),M),...l],animate:"object"==typeof f?Mw(f,"node"):f,axis:!1}),tx({},r,{data:x,encode:v,labels:h,style:Object.assign({fill:v.color?void 0:"#aaa"},Mw(u,"link")),animate:"object"==typeof f?Mw(f,"link"):f})]}};Ow.props={composite:!0};const kw=t=>(t,e,n,r)=>[t,t.map((()=>[[0,0]]))];kw.props={defaultShape:"path",defaultLabelShape:"label",channels:[...Cb({shapes:["path","hollow"]}),{name:"d",scale:"identity"}],preInference:[],postInference:[{type:"maybeKey"}]};const Pw=t=>t?parseInt(t):0;function Lw(t,e,n,r){if(!e)return{width:n,height:r};const i=function(t){const e=getComputedStyle(t),n=t.clientWidth||Pw(e.width),r=t.clientHeight||Pw(e.height);return{width:n-(Pw(e.paddingLeft)+Pw(e.paddingRight)),height:r-(Pw(e.paddingTop)+Pw(e.paddingBottom))}}(t);return{width:i.width,height:i.height}}function Rw(t){const{height:e,width:n,padding:r=0,paddingLeft:i=r,paddingRight:o=r,paddingTop:a=r,paddingBottom:s=r,margin:u=0,marginLeft:c=u,marginRight:l=u,marginTop:h=u,marginBottom:f=u,inset:p=0,insetLeft:d=p,insetRight:m=p,insetTop:v=p,insetBottom:g=p}=t;return{width:n-i-o-c-l-d-m,height:e-a-s-h-f-v-g}}var Iw=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};function Nw(t,e,n){const{value:r}=n,i=function(t,e){const n={treemapBinary:Mb,treemapDice:ib,treemapSlice:bb,treemapSliceDice:Eb,treemapSquarify:Sb,treemapResquarify:Ab},r="treemapSquarify"===t?n[t].ratio(e):n[t];if(!r)throw new TypeError("Invalid tile method!");return r}(e.tile,e.ratio),o=function(t,e){return Array.isArray(t)?"function"==typeof e?lb().path(e)(t):lb()(t):Ox(t)}(t,e.path);return r?o.sum((t=>e.ignoreParentValue&&t.children?0:t[r])).sort(e.sort):o.count(),function(){var t=Sb,e=!1,n=1,r=1,i=[0],o=Fx,a=Fx,s=Fx,u=Fx,c=Fx;function l(t){return t.x0=t.y0=0,t.x1=n,t.y1=r,t.eachBefore(h),i=[0],e&&t.eachBefore(rb),t}function h(e){var n=i[e.depth],r=e.x0+n,l=e.y0+n,h=e.x1-n,f=e.y1-n;h<r&&(r=h=(r+h)/2),f<l&&(l=f=(l+f)/2),e.x0=r,e.y0=l,e.x1=h,e.y1=f,e.children&&(n=i[e.depth+1]=o(e)/2,r+=c(e)-n,l+=a(e)-n,(h-=s(e)-n)<r&&(r=h=(r+h)/2),(f-=u(e)-n)<l&&(l=f=(l+f)/2),t(e,r,l,h,f))}return l.round=function(t){return arguments.length?(e=!!t,l):e},l.size=function(t){return arguments.length?(n=+t[0],r=+t[1],l):[n,r]},l.tile=function(e){return arguments.length?(t=Dx(e),l):t},l.padding=function(t){return arguments.length?l.paddingInner(t).paddingOuter(t):l.paddingInner()},l.paddingInner=function(t){return arguments.length?(o="function"==typeof t?t:jx(+t),l):o},l.paddingOuter=function(t){return arguments.length?l.paddingTop(t).paddingRight(t).paddingBottom(t).paddingLeft(t):l.paddingTop()},l.paddingTop=function(t){return arguments.length?(a="function"==typeof t?t:jx(+t),l):a},l.paddingRight=function(t){return arguments.length?(s="function"==typeof t?t:jx(+t),l):s},l.paddingBottom=function(t){return arguments.length?(u="function"==typeof t?t:jx(+t),l):u},l.paddingLeft=function(t){return arguments.length?(c="function"==typeof t?t:jx(+t),l):c},l}().tile(i).size(e.size).round(e.round).paddingInner(e.paddingInner).paddingOuter(e.paddingOuter).paddingTop(e.paddingTop).paddingRight(e.paddingRight).paddingBottom(e.paddingBottom).paddingLeft(e.paddingLeft)(o),o.descendants().map((t=>Object.assign(t,{x:[t.x0,t.x1],y:[t.y0,t.y1]}))).filter("function"==typeof e.layer?e.layer:t=>t.height===e.layer)}const Dw=t=>e=>{const{width:n,height:r}=Rw(e),{data:i,encode:o={},scale:a,style:s={},layout:u={},labels:c=[]}=t,l=Iw(t,["data","encode","scale","style","layout","labels"]),h={tile:"treemapSquarify",ratio:.5*(1+Math.sqrt(5)),size:[n,r],round:!1,ignoreParentValue:!0,padding:0,paddingInner:0,paddingOuter:0,paddingTop:0,paddingRight:0,paddingBottom:0,paddingLeft:0,sort:(t,e)=>e.value-t.value,layer:0},f={type:"rect",axis:!1,encode:{x:"x",y:"y",color:t=>t.data.parent.name},scale:{x:{domain:[0,n],range:[0,1]},y:{domain:[0,r],range:[0,1]}},style:{stroke:"#fff"}},p=Nw(i,tx({},h,u),o),d=Mw(s,"label");return[tx({},f,Object.assign(Object.assign({data:p,encode:o,scale:a,style:s,labels:[Object.assign(Object.assign({},{fontSize:10,text:t=>t.data.name,position:"inside",fill:"#000",textOverflow:"clip",wordWrap:!0,maxLines:1,wordWrapWidth:t=>t.x1-t.x0,lineHeight:t=>t.y1-t.y0}),d),...c]},l),{axis:!1}))]};Dw.props={composite:!0};var Fw=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const jw=t=>e=>{const{width:n,height:r}=Rw(e),{data:i,encode:o={},scale:a={},style:s={},layout:u={},labels:c=[]}=t,l=Fw(t,["data","encode","scale","style","layout","labels"]),h={size:[n,r],padding:0,sort:(t,e)=>e.value-t.value},f={type:"point",axis:!1,legend:!1,scale:{x:{domain:[0,n]},y:{domain:[0,r]},size:{type:"identity"}},encode:{x:"x",y:"y",size:"r",shape:"point"},style:{fill:o.color?void 0:t=>0===t.height?"#ddd":"#fff",stroke:o.color?void 0:t=>0===t.height?"":"#000"}},p=((t,e,n)=>{const{value:r}=n,i=Yy(t)?lb().path(e.path)(t):Ox(t);return r?i.sum((t=>t[r])).sort(e.sort):i.count(),Qx().size(e.size).padding(e.padding)(i),i.descendants()})(i,tx({},h,u),tx({},f.encode,o)),d=Mw(s,"label");return[tx({},f,Object.assign(Object.assign({data:p,encode:o,scale:a,style:s,labels:[Object.assign(Object.assign({},{text:"",position:"inside",textOverflow:"clip",wordWrap:!0,maxLines:1,wordWrapWidth:t=>2*t.r,lineHeight:t=>2*t.r}),d),...c]},l),{axis:!1}))]};jw.props={composite:!0};var Bw=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};function zw(t,e){return y_(t,(t=>e[t]))}function Uw(t,e){return v_(t,(t=>e[t]))}function Vw(t,e){const n=2.5*Gw(t,e)-1.5*Hw(t,e);return y_(t,(t=>e[t]>=n?e[t]:NaN))}function Gw(t,e){return __(t,.25,(t=>e[t]))}function Ww(t,e){return __(t,.5,(t=>e[t]))}function Hw(t,e){return __(t,.75,(t=>e[t]))}function Yw(t,e){const n=2.5*Hw(t,e)-1.5*Gw(t,e);return v_(t,(t=>e[t]<=n?e[t]:NaN))}function Xw(){return(t,e)=>{const{encode:n}=e,{y:r,x:i}=n,{value:o}=r,{value:a}=i,s=Array.from(e_(t,(t=>a[+t])).values()),u=s.flatMap((t=>{const e=Vw(t,o),n=Yw(t,o);return t.filter((t=>o[t]<e||o[t]>n))}));return[u,e]}}const qw=t=>()=>{const{data:e,encode:n,style:r={}}=t,{extend:i=!1}=r,o=Bw(r,["extend"]),{y:a}=n,s={y:a,y1:a,y2:a,y3:a,y4:a},u={y1:Gw,y2:Ww,y3:Hw};if(i)return[{type:"box",data:e,transform:[Object.assign(Object.assign({type:"groupX",y:zw},u),{y4:Uw})],encode:Object.assign(Object.assign({},n),s),style:o}];const c=Mw(o,"box"),l=Mw(o,"point");return[{type:"box",data:e,transform:[Object.assign(Object.assign({type:"groupX",y:Vw},u),{y4:Yw})],encode:Object.assign(Object.assign({},n),s),style:c},{type:"point",data:e,transform:[{type:Xw}],encode:n,style:Object.assign({},l)}]};qw.props={composite:!0};const Zw=t=>{const{cartesian:e}=t;return e?Rb:(e,n,r,i)=>{const{x:o,y:a}=r,s=Pb(n,r,t),u=Array.from(e,(t=>{const e=[+o[t],+a[t]];return[i.map(s(e,t))]}));return[e,u]}};function $w(t,e,n,r){if(isNaN(e)||isNaN(n))return t;var i,o,a,s,u,c,l,h,f,p=t._root,d={data:r},m=t._x0,v=t._y0,g=t._x1,y=t._y1;if(!p)return t._root=d,t;for(;p.length;)if((c=e>=(o=(m+g)/2))?m=o:g=o,(l=n>=(a=(v+y)/2))?v=a:y=a,i=p,!(p=p[h=l<<1|c]))return i[h]=d,t;if(s=+t._x.call(null,p.data),u=+t._y.call(null,p.data),e===s&&n===u)return d.next=p,i?i[h]=d:t._root=d,t;do{i=i?i[h]=new Array(4):t._root=new Array(4),(c=e>=(o=(m+g)/2))?m=o:g=o,(l=n>=(a=(v+y)/2))?v=a:y=a}while((h=l<<1|c)==(f=(u>=a)<<1|s>=o));return i[f]=p,i[h]=d,t}function Kw(t,e,n,r,i){this.node=t,this.x0=e,this.y0=n,this.x1=r,this.y1=i}function Jw(t){return t[0]}function Qw(t){return t[1]}function tS(t,e,n){var r=new eS(null==e?Jw:e,null==n?Qw:n,NaN,NaN,NaN,NaN);return null==t?r:r.addAll(t)}function eS(t,e,n,r,i,o){this._x=t,this._y=e,this._x0=n,this._y0=r,this._x1=i,this._y1=o,this._root=void 0}function nS(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}Zw.props={defaultShape:"shape",defaultLabelShape:"label",channels:[{name:"x",required:!0},{name:"y",required:!0}],preInference:[{type:"maybeTuple"},{type:"maybeVisualPosition"},{type:"maybeFunctionAttribute"}]};var rS=tS.prototype=eS.prototype;function iS(t){return function(){return t}}function oS(t){return 1e-6*(t()-.5)}function aS(t){return t.index}function sS(t,e){var n=t.get(e);if(!n)throw new Error("node not found: "+e);return n}rS.copy=function(){var t,e,n=new eS(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return n;if(!r.length)return n._root=nS(r),n;for(t=[{source:r,target:n._root=new Array(4)}];r=t.pop();)for(var i=0;i<4;++i)(e=r.source[i])&&(e.length?t.push({source:e,target:r.target[i]=new Array(4)}):r.target[i]=nS(e));return n},rS.add=function(t){const e=+this._x.call(null,t),n=+this._y.call(null,t);return $w(this.cover(e,n),e,n,t)},rS.addAll=function(t){var e,n,r,i,o=t.length,a=new Array(o),s=new Array(o),u=1/0,c=1/0,l=-1/0,h=-1/0;for(n=0;n<o;++n)isNaN(r=+this._x.call(null,e=t[n]))||isNaN(i=+this._y.call(null,e))||(a[n]=r,s[n]=i,r<u&&(u=r),r>l&&(l=r),i<c&&(c=i),i>h&&(h=i));if(u>l||c>h)return this;for(this.cover(u,c).cover(l,h),n=0;n<o;++n)$w(this,a[n],s[n],t[n]);return this},rS.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,r=this._y0,i=this._x1,o=this._y1;if(isNaN(n))i=(n=Math.floor(t))+1,o=(r=Math.floor(e))+1;else{for(var a,s,u=i-n||1,c=this._root;n>t||t>=i||r>e||e>=o;)switch(s=(e<r)<<1|t<n,(a=new Array(4))[s]=c,c=a,u*=2,s){case 0:i=n+u,o=r+u;break;case 1:n=i-u,o=r+u;break;case 2:i=n+u,r=o-u;break;case 3:n=i-u,r=o-u}this._root&&this._root.length&&(this._root=c)}return this._x0=n,this._y0=r,this._x1=i,this._y1=o,this},rS.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},rS.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},rS.find=function(t,e,n){var r,i,o,a,s,u,c,l=this._x0,h=this._y0,f=this._x1,p=this._y1,d=[],m=this._root;for(m&&d.push(new Kw(m,l,h,f,p)),null==n?n=1/0:(l=t-n,h=e-n,f=t+n,p=e+n,n*=n);u=d.pop();)if(!(!(m=u.node)||(i=u.x0)>f||(o=u.y0)>p||(a=u.x1)<l||(s=u.y1)<h))if(m.length){var v=(i+a)/2,g=(o+s)/2;d.push(new Kw(m[3],v,g,a,s),new Kw(m[2],i,g,v,s),new Kw(m[1],v,o,a,g),new Kw(m[0],i,o,v,g)),(c=(e>=g)<<1|t>=v)&&(u=d[d.length-1],d[d.length-1]=d[d.length-1-c],d[d.length-1-c]=u)}else{var y=t-+this._x.call(null,m.data),x=e-+this._y.call(null,m.data),b=y*y+x*x;if(b<n){var _=Math.sqrt(n=b);l=t-_,h=e-_,f=t+_,p=e+_,r=m.data}}return r},rS.remove=function(t){if(isNaN(o=+this._x.call(null,t))||isNaN(a=+this._y.call(null,t)))return this;var e,n,r,i,o,a,s,u,c,l,h,f,p=this._root,d=this._x0,m=this._y0,v=this._x1,g=this._y1;if(!p)return this;if(p.length)for(;;){if((c=o>=(s=(d+v)/2))?d=s:v=s,(l=a>=(u=(m+g)/2))?m=u:g=u,e=p,!(p=p[h=l<<1|c]))return this;if(!p.length)break;(e[h+1&3]||e[h+2&3]||e[h+3&3])&&(n=e,f=h)}for(;p.data!==t;)if(r=p,!(p=p.next))return this;return(i=p.next)&&delete p.next,r?(i?r.next=i:delete r.next,this):e?(i?e[h]=i:delete e[h],(p=e[0]||e[1]||e[2]||e[3])&&p===(e[3]||e[2]||e[1]||e[0])&&!p.length&&(n?n[f]=p:this._root=p),this):(this._root=i,this)},rS.removeAll=function(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this},rS.root=function(){return this._root},rS.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},rS.visit=function(t){var e,n,r,i,o,a,s=[],u=this._root;for(u&&s.push(new Kw(u,this._x0,this._y0,this._x1,this._y1));e=s.pop();)if(!t(u=e.node,r=e.x0,i=e.y0,o=e.x1,a=e.y1)&&u.length){var c=(r+o)/2,l=(i+a)/2;(n=u[3])&&s.push(new Kw(n,c,l,o,a)),(n=u[2])&&s.push(new Kw(n,r,l,c,a)),(n=u[1])&&s.push(new Kw(n,c,i,o,l)),(n=u[0])&&s.push(new Kw(n,r,i,c,l))}return this},rS.visitAfter=function(t){var e,n=[],r=[];for(this._root&&n.push(new Kw(this._root,this._x0,this._y0,this._x1,this._y1));e=n.pop();){var i=e.node;if(i.length){var o,a=e.x0,s=e.y0,u=e.x1,c=e.y1,l=(a+u)/2,h=(s+c)/2;(o=i[0])&&n.push(new Kw(o,a,s,l,h)),(o=i[1])&&n.push(new Kw(o,l,s,u,h)),(o=i[2])&&n.push(new Kw(o,a,h,l,c)),(o=i[3])&&n.push(new Kw(o,l,h,u,c))}r.push(e)}for(;e=r.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},rS.x=function(t){return arguments.length?(this._x=t,this):this._x},rS.y=function(t){return arguments.length?(this._y=t,this):this._y};var uS={value:()=>{}};function cS(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new lS(r)}function lS(t){this._=t}function hS(t,e){return t.trim().split(/^|\s+/).map((function(t){var n="",r=t.indexOf(".");if(r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))}function fS(t,e){for(var n,r=0,i=t.length;r<i;++r)if((n=t[r]).name===e)return n.value}function pS(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=uS,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}lS.prototype=cS.prototype={constructor:lS,on:function(t,e){var n,r=this._,i=hS(t+"",r),o=-1,a=i.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++o<a;)if(n=(t=i[o]).type)r[n]=pS(r[n],t.name,e);else if(null==e)for(n in r)r[n]=pS(r[n],t.name,null);return this}for(;++o<a;)if((n=(t=i[o]).type)&&(n=fS(r[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new lS(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),o=0;o<n;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,n=(r=this._[t]).length;o<n;++o)r[o].value.apply(e,i)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(e,n)}};var dS,mS,vS=0,gS=0,yS=0,xS=0,bS=0,_S=0,wS="object"==typeof performance&&performance.now?performance:Date,SS="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function MS(){return bS||(SS(ES),bS=wS.now()+_S)}function ES(){bS=0}function AS(){this._call=this._time=this._next=null}function TS(t,e,n){var r=new AS;return r.restart(t,e,n),r}function CS(){bS=(xS=wS.now())+_S,vS=gS=0;try{!function(){MS(),++vS;for(var t,e=dS;e;)(t=bS-e._time)>=0&&e._call.call(void 0,t),e=e._next;--vS}()}finally{vS=0,function(){var t,e,n=dS,r=1/0;for(;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:dS=e);mS=t,kS(r)}(),bS=0}}function OS(){var t=wS.now(),e=t-xS;e>1e3&&(_S-=e,xS=t)}function kS(t){vS||(gS&&(gS=clearTimeout(gS)),t-bS>24?(t<1/0&&(gS=setTimeout(CS,t-wS.now()-_S)),yS&&(yS=clearInterval(yS))):(yS||(xS=wS.now(),yS=setInterval(OS,1e3)),vS=1,SS(CS)))}AS.prototype=TS.prototype={constructor:AS,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?MS():+n)+(null==e?0:+e),this._next||mS===this||(mS?mS._next=this:dS=this,mS=this),this._call=t,this._time=n,kS()},stop:function(){this._call&&(this._call=null,this._time=1/0,kS())}};const PS=4294967296;function LS(t){return t.x}function RS(t){return t.y}var IS=Math.PI*(3-Math.sqrt(5));function NS(t){var e,n=1,r=.001,i=1-Math.pow(r,1/300),o=0,a=.6,s=new Map,u=TS(h),c=cS("tick","end"),l=function(){let t=1;return()=>(t=(1664525*t+1013904223)%PS)/PS}();function h(){f(),c.call("tick",e),n<r&&(u.stop(),c.call("end",e))}function f(r){var u,c,l=t.length;void 0===r&&(r=1);for(var h=0;h<r;++h)for(n+=(o-n)*i,s.forEach((function(t){t(n)})),u=0;u<l;++u)null==(c=t[u]).fx?c.x+=c.vx*=a:(c.x=c.fx,c.vx=0),null==c.fy?c.y+=c.vy*=a:(c.y=c.fy,c.vy=0);return e}function p(){for(var e,n=0,r=t.length;n<r;++n){if((e=t[n]).index=n,null!=e.fx&&(e.x=e.fx),null!=e.fy&&(e.y=e.fy),isNaN(e.x)||isNaN(e.y)){var i=10*Math.sqrt(.5+n),o=n*IS;e.x=i*Math.cos(o),e.y=i*Math.sin(o)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function d(e){return e.initialize&&e.initialize(t,l),e}return null==t&&(t=[]),p(),e={tick:f,restart:function(){return u.restart(h),e},stop:function(){return u.stop(),e},nodes:function(n){return arguments.length?(t=n,p(),s.forEach(d),e):t},alpha:function(t){return arguments.length?(n=+t,e):n},alphaMin:function(t){return arguments.length?(r=+t,e):r},alphaDecay:function(t){return arguments.length?(i=+t,e):+i},alphaTarget:function(t){return arguments.length?(o=+t,e):o},velocityDecay:function(t){return arguments.length?(a=1-t,e):1-a},randomSource:function(t){return arguments.length?(l=t,s.forEach(d),e):l},force:function(t,n){return arguments.length>1?(null==n?s.delete(t):s.set(t,d(n)),e):s.get(t)},find:function(e,n,r){var i,o,a,s,u,c=0,l=t.length;for(null==r?r=1/0:r*=r,c=0;c<l;++c)(a=(i=e-(s=t[c]).x)*i+(o=n-s.y)*o)<r&&(u=s,r=a);return u},on:function(t,n){return arguments.length>1?(c.on(t,n),e):c.on(t)}}}function DS(t,e,n){const{nodes:r,links:i}=t,{joint:o,nodeStrength:a,linkStrength:s}=e,{nodeKey:u=(t=>t.id),linkKey:c=(t=>t.id)}=n,l=function(){var t,e,n,r,i,o=iS(-30),a=1,s=1/0,u=.81;function c(n){var i,o=t.length,a=tS(t,LS,RS).visitAfter(h);for(r=n,i=0;i<o;++i)e=t[i],a.visit(f)}function l(){if(t){var e,n,r=t.length;for(i=new Array(r),e=0;e<r;++e)n=t[e],i[n.index]=+o(n,e,t)}}function h(t){var e,n,r,o,a,s=0,u=0;if(t.length){for(r=o=a=0;a<4;++a)(e=t[a])&&(n=Math.abs(e.value))&&(s+=e.value,u+=n,r+=n*e.x,o+=n*e.y);t.x=r/u,t.y=o/u}else{(e=t).x=e.data.x,e.y=e.data.y;do{s+=i[e.data.index]}while(e=e.next)}t.value=s}function f(t,o,c,l){if(!t.value)return!0;var h=t.x-e.x,f=t.y-e.y,p=l-o,d=h*h+f*f;if(p*p/u<d)return d<s&&(0===h&&(d+=(h=oS(n))*h),0===f&&(d+=(f=oS(n))*f),d<a&&(d=Math.sqrt(a*d)),e.vx+=h*t.value*r/d,e.vy+=f*t.value*r/d),!0;if(!(t.length||d>=s)){(t.data!==e||t.next)&&(0===h&&(d+=(h=oS(n))*h),0===f&&(d+=(f=oS(n))*f),d<a&&(d=Math.sqrt(a*d)));do{t.data!==e&&(p=i[t.data.index]*r/d,e.vx+=h*p,e.vy+=f*p)}while(t=t.next)}}return c.initialize=function(e,r){t=e,n=r,l()},c.strength=function(t){return arguments.length?(o="function"==typeof t?t:iS(+t),l(),c):o},c.distanceMin=function(t){return arguments.length?(a=t*t,c):Math.sqrt(a)},c.distanceMax=function(t){return arguments.length?(s=t*t,c):Math.sqrt(s)},c.theta=function(t){return arguments.length?(u=t*t,c):Math.sqrt(u)},c}(),h=function(t){var e,n,r,i,o,a,s=aS,u=function(t){return 1/Math.min(i[t.source.index],i[t.target.index])},c=iS(30),l=1;function h(r){for(var i=0,s=t.length;i<l;++i)for(var u,c,h,f,p,d,m,v=0;v<s;++v)c=(u=t[v]).source,f=(h=u.target).x+h.vx-c.x-c.vx||oS(a),p=h.y+h.vy-c.y-c.vy||oS(a),f*=d=((d=Math.sqrt(f*f+p*p))-n[v])/d*r*e[v],p*=d,h.vx-=f*(m=o[v]),h.vy-=p*m,c.vx+=f*(m=1-m),c.vy+=p*m}function f(){if(r){var a,u,c=r.length,l=t.length,h=new Map(r.map(((t,e)=>[s(t,e,r),t])));for(a=0,i=new Array(c);a<l;++a)(u=t[a]).index=a,"object"!=typeof u.source&&(u.source=sS(h,u.source)),"object"!=typeof u.target&&(u.target=sS(h,u.target)),i[u.source.index]=(i[u.source.index]||0)+1,i[u.target.index]=(i[u.target.index]||0)+1;for(a=0,o=new Array(l);a<l;++a)u=t[a],o[a]=i[u.source.index]/(i[u.source.index]+i[u.target.index]);e=new Array(l),p(),n=new Array(l),d()}}function p(){if(r)for(var n=0,i=t.length;n<i;++n)e[n]=+u(t[n],n,t)}function d(){if(r)for(var e=0,i=t.length;e<i;++e)n[e]=+c(t[e],e,t)}return null==t&&(t=[]),h.initialize=function(t,e){r=t,a=e,f()},h.links=function(e){return arguments.length?(t=e,f(),h):t},h.id=function(t){return arguments.length?(s=t,h):s},h.iterations=function(t){return arguments.length?(l=+t,h):l},h.strength=function(t){return arguments.length?(u="function"==typeof t?t:iS(+t),p(),h):u},h.distance=function(t){return arguments.length?(c="function"==typeof t?t:iS(+t),d(),h):c},h}(i).id(Ib(c));"function"==typeof a&&l.strength(a),"function"==typeof s&&h.strength(s);const f=NS(r).force("link",h).force("charge",l);o?f.force("center",function(t,e){var n,r=1;function i(){var i,o,a=n.length,s=0,u=0;for(i=0;i<a;++i)s+=(o=n[i]).x,u+=o.y;for(s=(s/a-t)*r,u=(u/a-e)*r,i=0;i<a;++i)(o=n[i]).x-=s,o.y-=u}return null==t&&(t=0),null==e&&(e=0),i.initialize=function(t){n=t},i.x=function(e){return arguments.length?(t=+e,i):t},i.y=function(t){return arguments.length?(e=+t,i):e},i.strength=function(t){return arguments.length?(r=+t,i):r},i}()):f.force("x",function(t){var e,n,r,i=iS(.1);function o(t){for(var i,o=0,a=e.length;o<a;++o)(i=e[o]).vx+=(r[o]-i.x)*n[o]*t}function a(){if(e){var o,a=e.length;for(n=new Array(a),r=new Array(a),o=0;o<a;++o)n[o]=isNaN(r[o]=+t(e[o],o,e))?0:+i(e[o],o,e)}}return"function"!=typeof t&&(t=iS(null==t?0:+t)),o.initialize=function(t){e=t,a()},o.strength=function(t){return arguments.length?(i="function"==typeof t?t:iS(+t),a(),o):i},o.x=function(e){return arguments.length?(t="function"==typeof e?e:iS(+e),a(),o):t},o}()).force("y",function(t){var e,n,r,i=iS(.1);function o(t){for(var i,o=0,a=e.length;o<a;++o)(i=e[o]).vy+=(r[o]-i.y)*n[o]*t}function a(){if(e){var o,a=e.length;for(n=new Array(a),r=new Array(a),o=0;o<a;++o)n[o]=isNaN(r[o]=+t(e[o],o,e))?0:+i(e[o],o,e)}}return"function"!=typeof t&&(t=iS(null==t?0:+t)),o.initialize=function(t){e=t,a()},o.strength=function(t){return arguments.length?(i="function"==typeof t?t:iS(+t),a(),o):i},o.y=function(e){return arguments.length?(t="function"==typeof e?e:iS(+e),a(),o):t},o}()),f.stop();const p=Math.ceil(Math.log(f.alphaMin())/Math.log(1-f.alphaDecay()));for(let d=0;d<p;d++)f.tick();return{nodesData:r,linksData:i}}const FS=t=>()=>{const{data:e,encode:n={},scale:r,style:i={},layout:o={},nodeLabels:a=[],linkLabels:s=[],animate:u={}}=t,c=Mw(n,"node"),l=Mw(n,"link"),{links:h,nodes:f}=Db(e,n),{nodesData:p,linksData:d}=DS({links:h,nodes:f},tx({},{joint:!0},o),n);return[tx({},{type:"link",axis:!1,legend:!1,encode:{x:[t=>t.source.x,t=>t.target.x],y:[t=>t.source.y,t=>t.target.y]},style:{stroke:"#999",strokeOpacity:.6}},{data:d,encode:l,labels:s,style:Mw(i,"link"),animate:"object"==typeof u?Mw(u,"link"):u}),tx({},{type:"point",axis:!1,legend:!1,encode:{x:"x",y:"y",size:5,color:"group",shape:"point"},scale:{color:{type:"ordinal"}},style:{stroke:"#fff"}},{data:p,encode:Object.assign({},c),scale:r,style:Mw(i,"node"),labels:[Object.assign(Object.assign({},{text:""}),Mw(i,"label")),...a],animate:"object"==typeof u?Mw(u,"node"):u})]};FS.props={composite:!0};const jS=t=>e=>n=>{const{field:r="value",nodeSize:i,separation:o,sortBy:a,as:s=["x","y"]}=e,[u,c]=s,l=Ox(n,(t=>t.children)).sum((t=>t[r])).sort(a),h=t();h.size([1,1]),i&&h.nodeSize(i),o&&h.separation(o),h(l);const f=[];l.each((t=>{t[u]=t.x,t[c]=t.y,t.name=t.data.name,f.push(t)}));const p=l.links();return p.forEach((t=>{t[u]=[t.source[u],t.target[u]],t[c]=[t.source[c],t.target[c]]})),{nodes:f,edges:p}},BS=t=>jS(Tx)(t);BS.props={};const zS=t=>jS(xb)(t);zS.props={};const US=t=>{const e={sortBy:(t,e)=>e.value-t.value},n={axis:!1,legend:!1,type:"point",encode:{x:"x",y:"y",size:2,shape:"point"}},r={type:"link",encode:{x:"x",y:"y",shape:"smooth"}},i={text:"",fontSize:10};return()=>{const{data:o,encode:a={},scale:s={},style:u={},layout:c={},nodeLabels:l=[],linkLabels:h=[],animate:f={}}=t,p=null==a?void 0:a.value,{nodes:d,edges:m}=zS(Object.assign(Object.assign(Object.assign({},e),c),{field:p}))(o);return[tx({},r,{data:m,encode:Mw(a,"link"),scale:Mw(s,"link"),labels:h,style:Object.assign({stroke:"#999"},Mw(u,"link")),animate:"object"==typeof f?Mw(f,"link"):f}),tx({},n,{data:d,scale:Mw(s,"node"),encode:Mw(a,"node"),labels:[Object.assign(Object.assign({},i),Mw(u,"label")),...l],style:Object.assign({},Mw(u,"node")),animate:"object"==typeof f?Mw(f,"node"):f})]}};US.props={composite:!0};var VS={},GS={};function WS(t){return new Function("d","return {"+t.map((function(t,e){return JSON.stringify(t)+": d["+e+'] || ""'})).join(",")+"}")}function HS(t){var e=Object.create(null),n=[];return t.forEach((function(t){for(var r in t)r in e||n.push(e[r]=r)})),n}function YS(t,e){var n=t+"",r=n.length;return r<e?new Array(e-r+1).join(0)+n:n}function XS(t){var e,n=t.getUTCHours(),r=t.getUTCMinutes(),i=t.getUTCSeconds(),o=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":((e=t.getUTCFullYear())<0?"-"+YS(-e,6):e>9999?"+"+YS(e,6):YS(e,4))+"-"+YS(t.getUTCMonth()+1,2)+"-"+YS(t.getUTCDate(),2)+(o?"T"+YS(n,2)+":"+YS(r,2)+":"+YS(i,2)+"."+YS(o,3)+"Z":i?"T"+YS(n,2)+":"+YS(r,2)+":"+YS(i,2)+"Z":r||n?"T"+YS(n,2)+":"+YS(r,2)+"Z":"")}function qS(t){var e=new RegExp('["'+t+"\n\r]"),n=t.charCodeAt(0);function r(t,e){var r,i=[],o=t.length,a=0,s=0,u=o<=0,c=!1;function l(){if(u)return GS;if(c)return c=!1,VS;var e,r,i=a;if(34===t.charCodeAt(i)){for(;a++<o&&34!==t.charCodeAt(a)||34===t.charCodeAt(++a););return(e=a)>=o?u=!0:10===(r=t.charCodeAt(a++))?c=!0:13===r&&(c=!0,10===t.charCodeAt(a)&&++a),t.slice(i+1,e-1).replace(/""/g,'"')}for(;a<o;){if(10===(r=t.charCodeAt(e=a++)))c=!0;else if(13===r)c=!0,10===t.charCodeAt(a)&&++a;else if(r!==n)continue;return t.slice(i,e)}return u=!0,t.slice(i,o)}for(10===t.charCodeAt(o-1)&&--o,13===t.charCodeAt(o-1)&&--o;(r=l())!==GS;){for(var h=[];r!==VS&&r!==GS;)h.push(r),r=l();e&&null==(h=e(h,s++))||i.push(h)}return i}function i(e,n){return e.map((function(e){return n.map((function(t){return a(e[t])})).join(t)}))}function o(e){return e.map(a).join(t)}function a(t){return null==t?"":t instanceof Date?XS(t):e.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t}return{parse:function(t,e){var n,i,o=r(t,(function(t,r){if(n)return n(t,r-1);i=t,n=e?function(t,e){var n=WS(t);return function(r,i){return e(n(r),i,t)}}(t,e):WS(t)}));return o.columns=i||[],o},parseRows:r,format:function(e,n){return null==n&&(n=HS(e)),[n.map(a).join(t)].concat(i(e,n)).join("\n")},formatBody:function(t,e){return null==e&&(e=HS(t)),i(t,e).join("\n")},formatRows:function(t){return t.map(o).join("\n")},formatRow:o,formatValue:a}}function ZS(t){for(var e in t){var n,r,i=t[e].trim();if(i)if("true"===i)i=!0;else if("false"===i)i=!1;else if("NaN"===i)i=NaN;else if(isNaN(n=+i)){if(!(r=i.match(/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/)))continue;$S&&r[4]&&!r[7]&&(i=i.replace(/-/g,"/").replace(/T/," ")),i=new Date(i)}else i=n;else i=null;t[e]=i}return t}const $S=new Date("2019-01-01T00:00").getHours()||new Date("2019-07-01T00:00").getHours();var KS=globalThis&&globalThis.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(e){o(e)}}function s(t){try{u(r.throw(t))}catch(e){o(e)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))};const JS=t=>{const{value:e,format:n=e.split(".").pop(),delimiter:r=",",autoType:i=!0}=t;return()=>KS(void 0,void 0,void 0,(function*(){const t=yield fetch(e);if("csv"===n){const e=yield t.text();return qS(r).parse(e,i?ZS:gw)}if("json"===n)return yield t.json();throw new Error(`Unknown format: ${n}.`)}))};JS.props={};const QS=t=>{const{fields:e,as:n=[]}=t;return t=>{if(!e||(r=e,0===Object.keys(r).length))return t;var r;const[i="key",o="value"]=n;return t.reduce(((t,n)=>{for(let r=0;r<e.length;r++)t.push(Object.assign(Object.assign({},n),{[i]:e[r],[o]:n[e[r]]}));return t}),[])}};function tM(t){return null!=t&&!Number.isNaN(t)}QS.props={};const eM=t=>{const{callback:e=tM}=t;return t=>t.filter(e)};eM.props={};const nM=t=>{const{callback:e}=t;return t=>Array.isArray(t)?[...t].sort(e):t};function rM(t,e,n){return Math.min(n,Math.max(e,t))}nM.props={};const iM=t=>e=>{const{fields:n=[]}=t;let{start:r=0,end:i=e.length}=t;r=rM(r,0,e.length-1),i=rM(i,1,e.length),r>i&&([r,i]=[i,r]);return e.filter(((t,e)=>e>=r&&e<i)).map((t=>n.reduce(((e,n)=>(n in t&&(e[n]=t[n]),e)),{})))};iM.props={};const oM=t=>{const{fields:e}=t;return iM({fields:e})};oM.props={};const aM=t=>e=>{if(!t||(n=t,0===Object.keys(n).length))return e;var n;return e.map((e=>Object.entries(e).reduce(((e,[n,r])=>(e[t[n]||n]=r,e)),{})))};aM.props={};const sM=t=>{const{fields:e=[]}=t,n=(r=!0,e.map((t=>{if(Array.isArray(t)){const[e,n=r]=t;return[e,n]}return[t,r]})));var r;return t=>[...t].sort(((t,e)=>n.reduce(((n,[r,i=!0])=>0!==n?n:i?t[r]<e[r]?-1:+(t[r]!==e[r]):t[r]>e[r]?-1:+(t[r]!==e[r])),0)))};sM.props={};const uM=t=>{const{value:e}=t;return()=>e};uM.props={};const cM=t=>{const{callback:e=gw}=t;return t=>e(t)};cM.props={};const lM=t=>{const{callback:e=gw}=t;return t=>Array.isArray(t)?t.map(e):t};lM.props={};const hM=Object.freeze(Object.defineProperty({__proto__:null,frequency:function(t,e){return e.frequency-t.frequency},id:function(t,e){return`${t.id}`.localeCompare(`${e.id}`)},name:function(t,e){return`${t.name}`.localeCompare(`${e.name}`)},weight:function(t,e){return e.value-t.value}},Symbol.toStringTag,{value:"Module"})),fM={y:0,thickness:.05,weight:!1,marginRatio:.1,id:t=>t.id,source:t=>t.source,target:t=>t.target,sourceWeight:t=>t.value||1,targetWeight:t=>t.value||1,sortBy:null};function pM(t){const{y:e,thickness:n,weight:r,marginRatio:i,id:o,source:a,target:s,sourceWeight:u,targetWeight:c,sortBy:l}=Object.assign(Object.assign({},fM),t);return function(t){const h=t.nodes.map((t=>Object.assign({},t))),f=t.edges.map((t=>Object.assign({},t)));return function(t,e){e.forEach((t=>{t.source=a(t),t.target=s(t),t.sourceWeight=u(t),t.targetWeight=c(t)}));const n=e_(e,(t=>t.source)),r=e_(e,(t=>t.target));t.forEach((t=>{t.id=o(t);const e=n.has(t.id)?n.get(t.id):[],i=r.has(t.id)?r.get(t.id):[];t.frequency=e.length+i.length,t.value=A_(e,(t=>t.sourceWeight))+A_(i,(t=>t.targetWeight))}))}(h,f),function(t,e){const n="function"==typeof l?l:hM[l];n&&t.sort(n)}(h),function(t,o){const a=t.length;if(!a)throw bw("Invalid nodes: it's empty!");if(!r){const n=1/a;return t.forEach(((t,r)=>{t.x=(r+.5)*n,t.y=e})),{nodes:t,edges:o}}const s=i/(2*a),u=t.reduce(((t,e)=>t+e.value),0);t.reduce(((t,r)=>{r.weight=r.value/u,r.width=r.weight*(1-i),r.height=n;const o=s+t,a=o+r.width,c=e-n/2,l=c+n;return r.x=[o,a,a,o],r.y=[c,c,l,l],t+r.width+2*s}),0)}(h,f),function(t,n){const i=new Map(t.map((t=>[t.id,t])));if(!r)return n.forEach((t=>{const e=a(t),n=s(t),r=i.get(e),o=i.get(n);r&&o&&(t.x=[r.x,o.x],t.y=[r.y,o.y])})),{nodes:t,edges:n};n.forEach((t=>{t.x=[0,0,0,0],t.y=[e,e,e,e]}));const o=e_(n,(t=>t.source)),u=e_(n,(t=>t.target));t.forEach((t=>{const{edges:e,width:n,x:r,y:i,value:a,id:s}=t,c=o.get(s)||[],l=u.get(s)||[];let h=0;c.map((e=>{const r=e.sourceWeight/a*n;e.x[0]=t.x[0]+h,e.x[1]=t.x[0]+h+r,h+=r})),l.forEach((e=>{const r=e.targetWeight/a*n;e.x[3]=t.x[0]+h,e.x[2]=t.x[0]+h+r,h+=r}))}))}(h,f),{nodes:h,edges:f}}}const dM=t=>e=>pM(t)(e);dM.props={};const mM=Math.PI/180,vM=2048;function gM(t){return t.text}function yM(){return"serif"}function xM(){return"normal"}function bM(t){return t.value}function _M(){return 90*~~(2*Math.random())}function wM(){return 1}function SM(){}function MM(t,e,n,r){if(e.sprite)return;const i=t.context,o=t.ratio;i.clearRect(0,0,2048/o,vM/o);let a=0,s=0,u=0;const c=n.length;for(--r;++r<c;){e=n[r],i.save(),i.font=e.style+" "+e.weight+" "+~~((e.size+1)/o)+"px "+e.font;let t=i.measureText(e.text+"m").width*o,c=e.size<<1;if(e.rotate){const n=Math.sin(e.rotate*mM),r=Math.cos(e.rotate*mM),i=t*r,o=t*n,a=c*r,s=c*n;t=Math.max(Math.abs(i+s),Math.abs(i-s))+31>>5<<5,c=~~Math.max(Math.abs(o+a),Math.abs(o-a))}else t=t+31>>5<<5;if(c>u&&(u=c),a+t>=2048&&(a=0,s+=u,u=0),s+c>=vM)break;i.translate((a+(t>>1))/o,(s+(c>>1))/o),e.rotate&&i.rotate(e.rotate*mM),i.fillText(e.text,0,0),e.padding&&(i.lineWidth=2*e.padding,i.strokeText(e.text,0,0)),i.restore(),e.width=t,e.height=c,e.xoff=a,e.yoff=s,e.x1=t>>1,e.y1=c>>1,e.x0=-e.x1,e.y0=-e.y1,e.hasText=!0,a+=t}const l=i.getImageData(0,0,2048/o,vM/o).data,h=[];for(;--r>=0;){if(!(e=n[r]).hasText)continue;const t=e.width,i=t>>5;let o=e.y1-e.y0;for(let e=0;e<o*i;e++)h[e]=0;if(a=e.xoff,null==a)return;s=e.yoff;let u=0,c=-1;for(let n=0;n<o;n++){for(let e=0;e<t;e++){const t=i*n+(e>>5),r=l[2048*(s+n)+(a+e)<<2]?1<<31-e%32:0;h[t]|=r,u|=r}u?c=n:(e.y0++,o--,n--,s++)}e.y1=e.y0+c,e.sprite=h.slice(0,(e.y1-e.y0)*i)}}function EM(t,e,n){n>>=5;const r=t.sprite,i=t.width>>5,o=t.x-(i<<4),a=127&o,s=32-a,u=t.y1-t.y0;let c,l=(t.y+t.y0)*n+(o>>5);for(let h=0;h<u;h++){c=0;for(let t=0;t<=i;t++)if((c<<s|(t<i?(c=r[h*i+t])>>>a:0))&e[l+t])return!0;l+=n}return!1}function AM(t,e){const n=t[0],r=t[1];e.x+e.x0<n.x&&(n.x=e.x+e.x0),e.y+e.y0<n.y&&(n.y=e.y+e.y0),e.x+e.x1>r.x&&(r.x=e.x+e.x1),e.y+e.y1>r.y&&(r.y=e.y+e.y1)}function TM(t){const e=t[0]/t[1];return function(t){return[e*(t*=.1)*Math.cos(t),t*Math.sin(t)]}}function CM(t){const e=[];let n=-1;for(;++n<t;)e[n]=0;return e}function OM(){return document.createElement("canvas")}function kM(t){return"function"==typeof t?t:function(){return t}}const PM={archimedean:TM,rectangular:function(t){const e=4*t[0]/t[1];let n=0,r=0;return function(t){const i=t<0?-1:1;switch(Math.sqrt(1+4*i*t)-i&3){case 0:n+=e;break;case 1:r+=4;break;case 2:n-=e;break;default:r-=4}return[n,r]}}};function LM(){let t=[256,256],e=gM,n=yM,r=bM,i=xM,o=_M,a=wM,s=TM,u=Math.random,c=SM,l=[],h=null,f=1/0;const p=xM,d=OM,m={};function v(e,n,r){const i=n.x,o=n.y,a=Math.sqrt(t[0]*t[0]+t[1]*t[1]),c=s(t),l=u()<.5?1:-1;let h,f,p,d=-l;for(;(h=c(d+=l))&&(f=~~h[0],p=~~h[1],!(Math.min(Math.abs(f),Math.abs(p))>=a));)if(n.x=i+f,n.y=o+p,!(n.x+n.x0<0||n.y+n.y0<0||n.x+n.x1>t[0]||n.y+n.y1>t[1]||r&&EM(n,e,t[0])||r&&(v=r,!((m=n).x+m.x1>v[0].x&&m.x+m.x0<v[1].x&&m.y+m.y1>v[0].y&&m.y+m.y0<v[1].y)))){const r=n.sprite,i=n.width>>5,o=t[0]>>5,a=n.x-(i<<4),s=127&a,u=32-s,c=n.y1-n.y0;let l,h=(n.y+n.y0)*o+(a>>5);for(let t=0;t<c;t++){l=0;for(let n=0;n<=i;n++)e[h+n]|=l<<u|(n<i?(l=r[t*i+n])>>>s:0);h+=o}return delete n.sprite,!0}var m,v;return!1}return m.start=function(){const[s,g]=t,y=function(t){t.width=t.height=1;const e=Math.sqrt(t.getContext("2d").getImageData(0,0,1,1).data.length>>2);t.width=2048/e,t.height=vM/e;const n=t.getContext("2d");return n.fillStyle=n.strokeStyle="red",n.textAlign="center",{context:n,ratio:e}}(d()),x=m.board?m.board:CM((t[0]>>5)*t[1]),b=l.length,_=[],w=l.map((function(t,s,u){return t.text=e.call(this,t,s,u),t.font=n.call(this,t,s,u),t.style=p.call(this,t,s,u),t.weight=i.call(this,t,s,u),t.rotate=o.call(this,t,s,u),t.size=~~r.call(this,t,s,u),t.padding=a.call(this,t,s,u),t})).sort((function(t,e){return e.size-t.size}));let S=-1,M=m.board?[{x:0,y:0},{x:s,y:g}]:void 0;function E(){const e=Date.now();for(;Date.now()-e<f&&++S<b;){const e=w[S];e.x=s*(u()+.5)>>1,e.y=g*(u()+.5)>>1,MM(y,e,w,S),e.hasText&&v(x,e,M)&&(c.call(null,"word",{cloud:m,word:e}),_.push(e),M?m.hasImage||AM(M,e):M=[{x:e.x+e.x0,y:e.y+e.y0},{x:e.x+e.x1,y:e.y+e.y1}],e.x-=t[0]>>1,e.y-=t[1]>>1)}m._tags=_,m._bounds=M,S>=b&&(m.stop(),c.call(null,"end",{cloud:m,words:_,bounds:M}))}return h&&clearInterval(h),h=setInterval(E,0),E(),m},m.stop=function(){return h&&(clearInterval(h),h=null),m},m.createMask=e=>{const n=document.createElement("canvas"),[r,i]=t;if(!r||!i)return;const o=r>>5,a=CM((r>>5)*i);n.width=r,n.height=i;const s=n.getContext("2d");s.drawImage(e,0,0,e.width,e.height,0,0,r,i);const u=s.getImageData(0,0,r,i).data;for(let t=0;t<i;t++)for(let e=0;e<r;e++){const n=o*t+(e>>5),i=t*r+e<<2,s=u[i]>=250&&u[i+1]>=250&&u[i+2]>=250?1<<31-e%32:0;a[n]|=s}m.board=a,m.hasImage=!0},m.timeInterval=function(t){f=null==t?1/0:t},m.words=function(t){l=t},m.size=function(e=[]){t=[+e[0],+e[1]]},m.text=function(t){e=kM(t)},m.font=function(t){n=kM(t)},m.fontWeight=function(t){i=kM(t)},m.rotate=function(t){o=kM(t)},m.spiral=function(t){s=PM[t]||t},m.fontSize=function(t){r=kM(t)},m.padding=function(t){a=kM(t)},m.random=function(t){u=kM(t)},m.on=function(t){c=kM(t)},m}var RM=globalThis&&globalThis.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(e){o(e)}}function s(t){try{u(r.throw(t))}catch(e){o(e)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))};var IM=globalThis&&globalThis.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(e){o(e)}}function s(t){try{u(r.throw(t))}catch(e){o(e)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},NM=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const DM={size:[500,500],fontSize:[14,28]};function FM(t){return new Promise(((e,n)=>{if(t instanceof HTMLImageElement)e(t);else{if("string"==typeof t){const r=new Image;return r.crossOrigin="anonymous",r.src=t,r.onload=()=>e(r),void(r.onerror=()=>{n()})}n()}}))}const jM=t=>e=>IM(void 0,void 0,void 0,(function*(){const n=Object.assign({},DM,t),r=LM();var i,o;yield(i=r,o=n,{set(t,e,n){if(void 0===o[t])return this;const r=e?e.call(null,o[t]):o[t];return n?n.call(null,r):"function"==typeof i[t]?i[t](r):i[t]=r,this},setAsync(t,e,n){return RM(this,void 0,void 0,(function*(){if(void 0===o[t])return this;const r=e?yield e.call(null,o[t]):o[t];return n?n.call(null,r):"function"==typeof i[t]?i[t](r):i[t]=r,this}))}}).set("fontSize",(t=>{const n=e.map((t=>t.value));return function(t,e){if("function"==typeof t)return t;if(Array.isArray(t)){const[n,r]=t;if(!e)return()=>(r+n)/2;const[i,o]=e;return o===i?()=>(r+n)/2:({value:t})=>(r-n)/(o-i)*(t-i)+n}return()=>t}(t,[y_(n),v_(n)])})).set("font").set("fontStyle").set("fontWeight").set("padding").set("rotate").set("size").set("spiral").set("timeInterval").set("random").set("text").set("on").setAsync("imageMask",FM,r.createMask),r.words([...e]);const a=r.start(),[s,u]=n.size,c=[{x:0,y:0},{x:s,y:u}],{_bounds:l=c,_tags:h,hasImage:f}=a,p=h.map((t=>{var{x:e,y:n}=t,r=NM(t,["x","y"]);return Object.assign(Object.assign({},r),{x:e+s/2,y:n+u/2})})),[{x:d,y:m},{x:v,y:g}]=l,y={text:"",value:0,opacity:0,fontSize:0};return p.push(Object.assign(Object.assign({},y),{x:f?0:d,y:f?0:m}),Object.assign(Object.assign({},y),{x:f?s:v,y:f?u:g})),p}));function BM(t){return"string"==typeof t?e=>e[t]:t}jM.props={};const zM=t=>{const{join:e,on:n,select:r=[],as:i=r,unknown:o=NaN}=t,[a,s]=n,u=BM(s),c=BM(a),l=n_(e,(([t])=>t),(t=>u(t)));return t=>t.map((t=>{const e=l.get(c(t));return Object.assign(Object.assign({},t),r.reduce(((t,n,r)=>(t[i[r]]=e?e[n]:o,t)),{}))}))};zM.props={};var UM=globalThis&&globalThis.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(e){o(e)}}function s(t){try{u(r.throw(t))}catch(e){o(e)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},VM=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const GM=t=>e=>UM(void 0,void 0,void 0,(function*(){const{width:n,height:r}=Rw(e),{data:i,encode:o={},scale:a,style:s={},layout:u={}}=t,c=VM(t,["data","encode","scale","style","layout"]),l={size:[n,r]},h={axis:!1,type:"text",encode:{x:"x",y:"y",text:"text",rotate:"rotate",fontSize:"size"},scale:{x:{domain:[0,n],range:[0,1]},y:{domain:[0,r],range:[0,1]},fontSize:{type:"identity"},rotate:{type:"identity"}},style:{textAlign:"center"}},f=function(t,e){const{text:n="text",value:r="value"}=e;return t.map((t=>Object.assign(Object.assign({},t),{text:t[n],value:t[r]})))}(i,o),p=yield jM(Object.assign(Object.assign({},l),u))(f);return[tx({},h,Object.assign(Object.assign({data:p,encode:o,scale:a,style:s},c),{axis:!1}))]}));GM.props={composite:!0};const WM=()=>["#5B8FF9","#5AD8A6","#5D7092","#F6BD16","#6F5EF9","#6DC8EC","#945FB9","#FF9845","#1E9493","#FF99C3"];WM.props={};const HM=()=>["#5B8FF9","#CDDDFD","#5AD8A6","#CDF3E4","#5D7092","#CED4DE","#F6BD16","#FCEBB9","#6F5EF9","#D3CEFD","#6DC8EC","#D3EEF9","#945FB9","#DECFEA","#FF9845","#FFE0C7","#1E9493","#BBDEDE","#FF99C3","#FFE0ED"];HM.props={};const YM=()=>["#95F0FF","#78D3F8","#5AB8DB","#3A9DBF","#0A82A4","#00698A","#005170","#003958","#002440"];YM.props={};const XM=()=>["#B8E1FF","#9AC5FF","#7DAAFF","#5B8FF9","#3D76DD","#085EC0","#0047A5","#00318A","#001D70"];XM.props={};const qM=()=>["#9DF5CA","#61DDAA","#42C090","#19A576","#008A5D","#006F45","#00562F","#003E19","#002800"];qM.props={};const ZM=()=>["#8CF4F2","#6FD8D6","#52BCBA","#31A09F","#008685","#006C6C","#005354","#003B3D","#002627"];ZM.props={};const $M=()=>["#D0E4FF","#B4C8ED","#99ADD1","#7E92B5","#65789B","#4C6080","#334867","#1B324F","#021D38"];$M.props={};const KM=()=>["#FFC771","#FFAB57","#F6903D","#D77622","#B85C00","#9B4300","#7D2A00","#601000","#450000"];KM.props={};const JM=()=>["#FFC2EC","#FFA6D0","#F08BB4","#D37099","#B65680","#9A3C67","#7E214F","#630038","#490022"];JM.props={};const QM=()=>["#FFBB95","#FF9E7B","#FF8362","#E8684A","#C84D32","#AA311C","#8C1104","#6F0000","#510000"];QM.props={};const tE=()=>["#FFD83B","#F6BD16","#D7A100","#B98700","#9C6E00","#7F5600","#633F00","#482900","#2F1400"];tE.props={};const eE=()=>["#FFCCFF","#EBB0FF","#CE95F5","#B27AD8","#9661BC","#7B48A1","#613086","#48186C","#2E0054"];eE.props={};const nE=()=>["#FDEDBE","#FFDF80","#FFCB33","#FFB200","#FF8C00","#FF6500","#E6450F","#B22C00","#661900"];nE.props={};const rE=()=>["#FFEBB0","#FFDF80","#FACA3E","#E6B80B","#B5AC23","#6A9A48","#20876B","#06746B","#044E48"];rE.props={};const iE=()=>["#FFEBB0","#FFDF80","#FACA3E","#E6B80B","#B5AC23","#6A9A48","#20876B","#06746B","#044E48"];iE.props={};const oE=()=>["#D2EDC8","#A9DACC","#75C6D1","#42B3D5","#3993C2","#3073AE","#27539B","#1E3388","#171E6D"];oE.props={};const aE=()=>["#003F7F","#004C99","#0059B2","#0072E5","#1A8CFF","#4DA6FF","#80BFFF","#B3D9FF","#EAE9EB","#FFD5B1","#FFC08C","#FFAB66","#FF963E","#F17F0B","#D16A0C","#A45411","#794012"];aE.props={};const sE=()=>["#661900","#B22C00","#E6450F","#FF6500","#FF8C00","#FFB200","#FFCB33","#FFDF80","#E0F2EB","#66D8FF","#1AC5FF","#007FFF","#0059FF","#0040FF","#002CB2","#FFDF80","#001F7F"];sE.props={};const uE=()=>["#014c63","#10686c","#168575","#16a37e","#0bc286","#65cf9b","#96dcb0","#c1e8c5","#F2EAEA","#FFC5AC","#FFA884","#FF895D","#FF6836","#F3470D","#D13808","#A4300C","#7A270E"];uE.props={};const cE=()=>["#661900","#B22C00","#E6450F","#FF6500","#FF8C00","#FFB200","#FFCB33","#FFDF80","#FFE2DC","#EAACFF","#DD78FF","#C53FFF","#A700FF","#8500FF","#620BE1","#3607C2","#27029A"];function lE(t,...e){return e.reduce(((t,e)=>n=>t(e(n))),t)}function hE(t,e){return e-t?n=>(n-t)/(e-t):t=>.5}function fE(t,e,n,r,i){let o=n||0,a=r||t.length;const s=i||(t=>t);for(;o<a;){const n=Math.floor((o+a)/2);s(t[n])>e?a=n:o=n+1}return o}cE.props={};const pE=Math.sqrt(50),dE=Math.sqrt(10),mE=Math.sqrt(2);function vE(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),o=r/10**i;return i>=0?(o>=pE?10:o>=dE?5:o>=mE?2:1)*10**i:-(10**-i)/(o>=pE?10:o>=dE?5:o>=mE?2:1)}function gE(t,e,n){const r=Math.abs(e-t)/Math.max(0,n);let i=10**Math.floor(Math.log(r)/Math.LN10);const o=r/i;return o>=pE?i*=10:o>=dE?i*=5:o>=mE&&(i*=2),e<t?-i:i}const yE=(t,e,n=5)=>{const r=[t,e];let i,o=0,a=r.length-1,s=r[o],u=r[a];return u<s&&([s,u]=[u,s],[o,a]=[a,o]),i=vE(s,u,n),i>0?(s=Math.floor(s/i)*i,u=Math.ceil(u/i)*i,i=vE(s,u,n)):i<0&&(s=Math.ceil(s*i)/i,u=Math.floor(u*i)/i,i=vE(s,u,n)),i>0?(r[o]=Math.floor(s/i)*i,r[a]=Math.ceil(u/i)*i):i<0&&(r[o]=Math.ceil(s*i)/i,r[a]=Math.floor(u*i)/i),r},xE=1e3,bE=6e4,_E=36e5,wE=864e5,SE=6048e5,ME=2592e6,EE=31536e6;function AE(t,e,n,r){const i=(t,i)=>{i&&((t,e)=>{let i=e;for(;i&&r(t)%e!=0;)n(t,-1),i-=1})(t,i),e(t)},o=(t,e)=>{const r=new Date(+t-1);return i(r,e),n(r,e),i(r),r};return{ceil:o,floor:(t,e)=>{const n=new Date(+t);return i(n,e),n},range:(t,e,r,a)=>{const s=[],u=Math.floor(r);for(let c=a?o(t,r):o(t);+c<+e;n(c,u),i(c))s.push(new Date(+c));return s},duration:t}}const TE=AE(1,(t=>t),((t,e=1)=>{t.setTime(+t+e)}),(t=>t.getTime())),CE=AE(xE,(t=>{t.setMilliseconds(0)}),((t,e=1)=>{t.setTime(+t+xE*e)}),(t=>t.getSeconds())),OE=AE(bE,(t=>{t.setSeconds(0,0)}),((t,e=1)=>{t.setTime(+t+bE*e)}),(t=>t.getMinutes())),kE=AE(_E,(t=>{t.setMinutes(0,0,0)}),((t,e=1)=>{t.setTime(+t+_E*e)}),(t=>t.getHours())),PE=AE(wE,(t=>{t.setHours(0,0,0,0)}),((t,e=1)=>{t.setTime(+t+wE*e)}),(t=>t.getDate()-1)),LE=AE(ME,(t=>{t.setDate(1),t.setHours(0,0,0,0)}),((t,e=1)=>{const n=t.getMonth();t.setMonth(n+e)}),(t=>t.getMonth())),RE=AE(SE,(t=>{t.setDate(t.getDate()-t.getDay()%7),t.setHours(0,0,0,0)}),((t,e=1)=>{t.setTime(+t+SE*e)}),(t=>{const e=LE.floor(t),n=new Date(+t);return Math.floor((+n-+e)/SE)})),IE=AE(EE,(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)}),((t,e=1)=>{const n=t.getFullYear();t.setFullYear(n+e)}),(t=>t.getFullYear())),NE={millisecond:TE,second:CE,minute:OE,hour:kE,day:PE,week:RE,month:LE,year:IE},DE=AE(1,(t=>t),((t,e=1)=>{t.setTime(+t+e)}),(t=>t.getTime())),FE=AE(xE,(t=>{t.setUTCMilliseconds(0)}),((t,e=1)=>{t.setTime(+t+xE*e)}),(t=>t.getUTCSeconds())),jE=AE(bE,(t=>{t.setUTCSeconds(0,0)}),((t,e=1)=>{t.setTime(+t+bE*e)}),(t=>t.getUTCMinutes())),BE=AE(_E,(t=>{t.setUTCMinutes(0,0,0)}),((t,e=1)=>{t.setTime(+t+_E*e)}),(t=>t.getUTCHours())),zE=AE(wE,(t=>{t.setUTCHours(0,0,0,0)}),((t,e=1)=>{t.setTime(+t+wE*e)}),(t=>t.getUTCDate()-1)),UE=AE(ME,(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)}),((t,e=1)=>{const n=t.getUTCMonth();t.setUTCMonth(n+e)}),(t=>t.getUTCMonth())),VE=AE(SE,(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7)%7),t.setUTCHours(0,0,0,0)}),((t,e=1)=>{t.setTime(+t+SE*e)}),(t=>{const e=UE.floor(t),n=new Date(+t);return Math.floor((+n-+e)/SE)})),GE=AE(EE,(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),((t,e=1)=>{const n=t.getUTCFullYear();t.setUTCFullYear(n+e)}),(t=>t.getUTCFullYear())),WE={millisecond:DE,second:FE,minute:jE,hour:BE,day:zE,week:VE,month:UE,year:GE};function HE(t,e,n,r,i){const o=+t,a=+e,{tickIntervals:s,year:u,millisecond:c}=function(t){const e=t?WE:NE,{year:n,month:r,week:i,day:o,hour:a,minute:s,second:u,millisecond:c}=e;return{tickIntervals:[[u,1],[u,5],[u,15],[u,30],[s,1],[s,5],[s,15],[s,30],[a,1],[a,3],[a,6],[a,12],[o,1],[o,2],[i,1],[r,1],[r,3],[n,1]],year:n,millisecond:c}}(i),l=([t,e])=>t.duration*e,h=r?(a-o)/r:n||5,f=r||(a-o)/h,p=s.length,d=fE(s,f,0,p,l);let m;if(d===p){m=[u,gE(o/u.duration,a/u.duration,h)]}else if(d){const t=f/l(s[d-1])<l(s[d])/f,[e,n]=t?s[d-1]:s[d];m=[e,r?Math.ceil(r/e.duration):n]}else{m=[c,Math.max(gE(o,a,h),1)]}return m}const YE=(t,e,n,r,i)=>{const o=t>e,a=o?e:t,s=o?t:e,[u,c]=HE(a,s,n,r,i),l=[u.floor(a,c),u.ceil(s,c)];return o?l.reverse():l};function XE(t){return!(e=t,void 0===e||function(t){return null===t}(t)||Number.isNaN(t));var e}const qE=t=>e=>-t(-e),ZE=(t,e)=>{const n=Math.log(t),r=t===Math.E?Math.log:t=>Math.log(t)/n;return e?qE(r):r},$E=(t,e)=>{const n=t===Math.E?Math.exp:e=>t**e;return e?qE(n):n},KE=(t,e,n,r)=>{const i=t<0,o=ZE(r,i),a=$E(r,i),s=t>e,u=s?e:t,c=s?t:e,l=[a(Math.floor(o(u))),a(Math.ceil(o(c)))];return s?l.reverse():l};function JE(t,e){return n=>{n.prototype.rescale=function(){this.initRange(),this.nice();const[t]=this.chooseTransforms();this.composeOutput(t,this.chooseClamp(t))},n.prototype.initRange=function(){const{interpolator:e}=this.options;this.options.range=t(e)},n.prototype.composeOutput=function(t,n){const{domain:r,interpolator:i,round:o}=this.getOptions(),a=e(r.map(t)),s=o?(t=>e=>{const n=t(e);return qy(n)?Math.round(n):n})(i):i;this.output=lE(s,a,n,t)},n.prototype.invert=void 0}}var QE={},tA={get exports(){return QE},set exports(t){QE=t}},eA={},nA={get exports(){return eA},set exports(t){eA=t}},rA=function(t){return!(!t||"string"==typeof t)&&(t instanceof Array||Array.isArray(t)||t.length>=0&&(t.splice instanceof Function||Object.getOwnPropertyDescriptor(t,t.length-1)&&"String"!==t.constructor.name))},iA=Array.prototype.concat,oA=Array.prototype.slice,aA=nA.exports=function(t){for(var e=[],n=0,r=t.length;n<r;n++){var i=t[n];rA(i)?e=iA.call(e,oA.call(i)):e.push(i)}return e};aA.wrap=function(t){return function(){return t(aA(arguments))}};var sA={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},uA=eA,cA=Object.hasOwnProperty,lA=Object.create(null);for(var hA in sA)cA.call(sA,hA)&&(lA[sA[hA]]=hA);var fA=tA.exports={to:{},get:{}};function pA(t,e,n){return Math.min(Math.max(e,t),n)}function dA(t){var e=Math.round(t).toString(16).toUpperCase();return e.length<2?"0"+e:e}function mA(t,e,n){let r=n;return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+6*(e-t)*r:r<.5?e:r<2/3?t+(e-t)*(2/3-r)*6:t}function vA(t){const e=QE.get(t);if(!e)return null;const{model:n,value:r}=e;return"rgb"===n?r:"hsl"===n?function(t){const e=t[0]/360,n=t[1]/100,r=t[2]/100,i=t[3];if(0===n)return[255*r,255*r,255*r,i];const o=r<.5?r*(1+n):r+n-r*n,a=2*r-o;return[255*mA(a,o,e+1/3),255*mA(a,o,e),255*mA(a,o,e-1/3),i]}(r):null}fA.get=function(t){var e,n;switch(t.substring(0,3).toLowerCase()){case"hsl":e=fA.get.hsl(t),n="hsl";break;case"hwb":e=fA.get.hwb(t),n="hwb";break;default:e=fA.get.rgb(t),n="rgb"}return e?{model:n,value:e}:null},fA.get.rgb=function(t){if(!t)return null;var e,n,r,i=[0,0,0,1];if(e=t.match(/^#([a-f0-9]{6})([a-f0-9]{2})?$/i)){for(r=e[2],e=e[1],n=0;n<3;n++){var o=2*n;i[n]=parseInt(e.slice(o,o+2),16)}r&&(i[3]=parseInt(r,16)/255)}else if(e=t.match(/^#([a-f0-9]{3,4})$/i)){for(r=(e=e[1])[3],n=0;n<3;n++)i[n]=parseInt(e[n]+e[n],16);r&&(i[3]=parseInt(r+r,16)/255)}else if(e=t.match(/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/)){for(n=0;n<3;n++)i[n]=parseInt(e[n+1],0);e[4]&&(e[5]?i[3]=.01*parseFloat(e[4]):i[3]=parseFloat(e[4]))}else{if(!(e=t.match(/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/)))return(e=t.match(/^(\w+)$/))?"transparent"===e[1]?[0,0,0,0]:cA.call(sA,e[1])?((i=sA[e[1]])[3]=1,i):null:null;for(n=0;n<3;n++)i[n]=Math.round(2.55*parseFloat(e[n+1]));e[4]&&(e[5]?i[3]=.01*parseFloat(e[4]):i[3]=parseFloat(e[4]))}for(n=0;n<3;n++)i[n]=pA(i[n],0,255);return i[3]=pA(i[3],0,1),i},fA.get.hsl=function(t){if(!t)return null;var e=t.match(/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/);if(e){var n=parseFloat(e[4]);return[(parseFloat(e[1])%360+360)%360,pA(parseFloat(e[2]),0,100),pA(parseFloat(e[3]),0,100),pA(isNaN(n)?1:n,0,1)]}return null},fA.get.hwb=function(t){if(!t)return null;var e=t.match(/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/);if(e){var n=parseFloat(e[4]);return[(parseFloat(e[1])%360+360)%360,pA(parseFloat(e[2]),0,100),pA(parseFloat(e[3]),0,100),pA(isNaN(n)?1:n,0,1)]}return null},fA.to.hex=function(){var t=uA(arguments);return"#"+dA(t[0])+dA(t[1])+dA(t[2])+(t[3]<1?dA(Math.round(255*t[3])):"")},fA.to.rgb=function(){var t=uA(arguments);return t.length<4||1===t[3]?"rgb("+Math.round(t[0])+", "+Math.round(t[1])+", "+Math.round(t[2])+")":"rgba("+Math.round(t[0])+", "+Math.round(t[1])+", "+Math.round(t[2])+", "+t[3]+")"},fA.to.rgb.percent=function(){var t=uA(arguments),e=Math.round(t[0]/255*100),n=Math.round(t[1]/255*100),r=Math.round(t[2]/255*100);return t.length<4||1===t[3]?"rgb("+e+"%, "+n+"%, "+r+"%)":"rgba("+e+"%, "+n+"%, "+r+"%, "+t[3]+")"},fA.to.hsl=function(){var t=uA(arguments);return t.length<4||1===t[3]?"hsl("+t[0]+", "+t[1]+"%, "+t[2]+"%)":"hsla("+t[0]+", "+t[1]+"%, "+t[2]+"%, "+t[3]+")"},fA.to.hwb=function(){var t=uA(arguments),e="";return t.length>=4&&1!==t[3]&&(e=", "+t[3]),"hwb("+t[0]+", "+t[1]+"%, "+t[2]+"%"+e+")"},fA.to.keyword=function(t){return lA[t.slice(0,3)]};const gA=(t,e)=>n=>t*(1-n)+e*n,yA=(t,e)=>"number"==typeof t&&"number"==typeof e?gA(t,e):"string"==typeof t&&"string"==typeof e?((t,e)=>{const n=vA(t),r=vA(e);return null===n||null===r?n?()=>t:()=>e:t=>{const e=new Array(4);for(let u=0;u<4;u+=1){const i=n[u],o=r[u];e[u]=i*(1-t)+o*t}const[i,o,a,s]=e;return`rgba(${Math.round(i)}, ${Math.round(o)}, ${Math.round(a)}, ${s})`}})(t,e):()=>t,xA=(t,e)=>{const n=gA(t,e);return t=>Math.round(n(t))};function bA({map:t,initKey:e},n){const r=e(n);return t.has(r)?t.get(r):n}function _A(t){return"object"==typeof t?t.valueOf():t}class wA extends Map{constructor(t){if(super(),this.map=new Map,this.initKey=_A,null!==t)for(const[e,n]of t)this.set(e,n)}get(t){return super.get(bA({map:this.map,initKey:this.initKey},t))}has(t){return super.has(bA({map:this.map,initKey:this.initKey},t))}set(t,e){return super.set(function({map:t,initKey:e},n){const r=e(n);return t.has(r)?t.get(r):(t.set(r,n),n)}({map:this.map,initKey:this.initKey},t),e)}delete(t){return super.delete(function({map:t,initKey:e},n){const r=e(n);return t.has(r)&&(n=t.get(r),t.delete(r)),n}({map:this.map,initKey:this.initKey},t))}}class SA{constructor(t){this.options=tx({},this.getDefaultOptions()),this.update(t)}getOptions(){return this.options}update(t={}){this.options=tx({},this.options,t),this.rescale(t)}rescale(t){}}const MA=Symbol("defaultUnknown");function EA(t,e,n){for(let r=0;r<e.length;r+=1)t.has(e[r])||t.set(n(e[r]),r)}function AA(t){const{value:e,from:n,to:r,mapper:i,notFoundReturn:o}=t;let a=i.get(e);if(void 0===a){if(o!==MA)return o;a=n.push(e)-1,i.set(e,a)}return r[a%r.length]}function TA(t){return t instanceof Date?t=>`${t}`:"object"==typeof t?t=>JSON.stringify(t):t=>t}let CA=class extends SA{constructor(t){super(t)}getDefaultOptions(){return{domain:[],range:[],unknown:MA}}map(t){return 0===this.domainIndexMap.size&&EA(this.domainIndexMap,this.getDomain(),this.domainKey),AA({value:this.domainKey(t),mapper:this.domainIndexMap,from:this.getDomain(),to:this.getRange(),notFoundReturn:this.options.unknown})}invert(t){return 0===this.rangeIndexMap.size&&EA(this.rangeIndexMap,this.getRange(),this.rangeKey),AA({value:this.rangeKey(t),mapper:this.rangeIndexMap,from:this.getRange(),to:this.getDomain(),notFoundReturn:this.options.unknown})}rescale(t){const[e]=this.options.domain,[n]=this.options.range;if(this.domainKey=TA(e),this.rangeKey=TA(n),!this.rangeIndexMap)return this.rangeIndexMap=new Map,void(this.domainIndexMap=new Map);t&&!t.range||this.rangeIndexMap.clear(),(!t||t.domain||t.compare)&&(this.domainIndexMap.clear(),this.sortedDomain=void 0)}clone(){return new CA(this.options)}getRange(){return this.options.range}getDomain(){if(this.sortedDomain)return this.sortedDomain;const{domain:t,compare:e}=this.options;return this.sortedDomain=e?[...t].sort(e):t,this.sortedDomain}};function OA(t){return Math.round(1e12*t)/1e12}function kA(t){const{domain:e,range:n,paddingOuter:r,paddingInner:i,flex:o,round:a,align:s}=t,u=e.length,c=function(t,e){const n=e-t.length;return n>0?[...t,...new Array(n).fill(1)]:n<0?t.slice(0,e):t}(o,u),[l,h]=n,f=h-l,p=f/(2/u*r+1-1/u*i),d=p*i/u,m=p-u*d,v=function(t){const e=Math.min(...t);return t.map((t=>t/e))}(c),g=m/v.reduce(((t,e)=>t+e)),y=new wA(e.map(((t,e)=>{const n=v[e]*g;return[t,a?Math.floor(n):n]}))),x=new wA(e.map(((t,e)=>{const n=v[e]*g+d;return[t,a?Math.floor(n):n]}))),b=Array.from(x.values()).reduce(((t,e)=>t+e)),_=l+(f-(b-b/u*i))*s;let w=a?Math.round(_):_;const S=new Array(u);for(let M=0;M<u;M+=1){S[M]=OA(w);const t=e[M];w+=x.get(t)}return{valueBandWidth:y,valueStep:x,adjustedRange:S}}let PA=class extends CA{constructor(t){super(t)}getDefaultOptions(){return{domain:[],range:[0,1],align:.5,round:!1,paddingInner:0,paddingOuter:0,padding:0,unknown:MA,flex:[]}}clone(){return new PA(this.options)}getStep(t){return void 0===this.valueStep?1:"number"==typeof this.valueStep?this.valueStep:void 0===t?Array.from(this.valueStep.values())[0]:this.valueStep.get(t)}getBandWidth(t){return void 0===this.valueBandWidth?1:"number"==typeof this.valueBandWidth?this.valueBandWidth:void 0===t?Array.from(this.valueBandWidth.values())[0]:this.valueBandWidth.get(t)}getRange(){return this.adjustedRange}getPaddingInner(){const{padding:t,paddingInner:e}=this.options;return t>0?t:e}getPaddingOuter(){const{padding:t,paddingOuter:e}=this.options;return t>0?t:e}rescale(){super.rescale();const{align:t,domain:e,range:n,round:r,flex:i}=this.options,{adjustedRange:o,valueBandWidth:a,valueStep:s}=function(t){var e;const{domain:n}=t,r=n.length;if(0===r)return{valueBandWidth:void 0,valueStep:void 0,adjustedRange:[]};if(null===(e=t.flex)||void 0===e?void 0:e.length)return kA(t);const{range:i,paddingOuter:o,paddingInner:a,round:s,align:u}=t;let c,l,h=i[0];const f=i[1]-h,p=2*o,d=r-a;c=f/Math.max(1,p+d),s&&(c=Math.floor(c)),h+=(f-c*(r-a))*u,l=c*(1-a),s&&(h=Math.round(h),l=Math.round(l));const m=new Array(r).fill(0).map(((t,e)=>h+e*c));return{valueStep:c,valueBandWidth:l,adjustedRange:m}}({align:t,range:n,round:r,flex:i,paddingInner:this.getPaddingInner(),paddingOuter:this.getPaddingOuter(),domain:e});this.valueStep=s,this.valueBandWidth=a,this.adjustedRange=o}};const LA=(t,e,n)=>{let r,i,o=t,a=e;if(o===a&&n>0)return[o];let s=vE(o,a,n);if(0===s||!Number.isFinite(s))return[];if(s>0){o=Math.ceil(o/s),a=Math.floor(a/s),i=new Array(r=Math.ceil(a-o+1));for(let t=0;t<r;t+=1)i[t]=(o+t)*s}else{s=-s,o=Math.ceil(o*s),a=Math.floor(a*s),i=new Array(r=Math.ceil(a-o+1));for(let t=0;t<r;t+=1)i[t]=(o+t)/s}return i};function RA(t){return Math.abs(t)<1e-15?t:parseFloat(t.toFixed(15))}const IA=[1,5,2,2.5,4,3],NA=100*Number.EPSILON;function DA(t,e,n,r,i,o){const a=ix(e),s=ex(e,t);let u=0;const c=function(t,e){return(t%e+e)%e}(r,o);return(c<NA||o-c<NA)&&r<=0&&i>=0&&(u=1),1-s/(a-1)-n+u}function FA(t,e,n){const r=ix(e);return 1-ex(e,t)/(r-1)-n+1}function jA(t,e,n,r,i,o){const a=(t-1)/(o-i),s=(e-1)/(Math.max(o,r)-Math.min(n,i));return 2-Math.max(a/s,s/a)}function BA(t,e){return t>=e?2-(t-1)/(e-1):1}function zA(t,e,n,r){return 1-.5*((e-r)**2+(t-n)**2)/(.1*(e-t))**2}function UA(t,e,n){const r=e-t;if(n>r){return 1-((n-r)/2)**2/(.1*r)**2}return 1}const VA=(t,e,n=5,r=!0,i=IA,o=[.25,.2,.5,.05])=>{const a=n<0?0:Math.round(n);if(Number.isNaN(t)||Number.isNaN(e)||"number"!=typeof t||"number"!=typeof e||!a)return[];if(e-t<1e-15||1===a)return[t];const s={score:-2,lmin:0,lmax:0,lstep:0};let u=1;for(;u<1/0;){for(let n=0;n<i.length;n+=1){const c=i[n],l=FA(c,i,u);if(o[0]*l+o[1]+o[2]+o[3]<s.score){u=1/0;break}let h=2;for(;h<1/0;){const n=BA(h,a);if(o[0]*l+o[1]+o[2]*n+o[3]<s.score)break;const f=(e-t)/(h+1)/u/c;let p=Math.ceil(Math.log10(f));for(;p<1/0;){const f=u*c*10**p,d=UA(t,e,f*(h-1));if(o[0]*l+o[1]*d+o[2]*n+o[3]<s.score)break;const m=Math.floor(e/f)*u-(h-1)*u,v=Math.ceil(t/f)*u;if(m<=v){const n=v-m;for(let l=0;l<=n;l+=1){const n=(m+l)*(f/u),p=n+f*(h-1),d=f,v=DA(c,i,u,n,p,d),g=zA(t,e,n,p),y=jA(h,a,t,e,n,p),x=1,b=o[0]*v+o[1]*g+o[2]*y+o[3]*x;b>s.score&&(!r||n<=t&&p>=e)&&(s.lmin=n,s.lmax=p,s.lstep=d,s.score=b)}}p+=1}h+=1}}u+=1}const c=RA(s.lmax),l=RA(s.lmin),h=RA(s.lstep),f=Math.floor(function(t){return Math.round(1e12*t)/1e12}((c-l)/h))+1,p=new Array(f);p[0]=RA(l);for(let d=1;d<f;d+=1)p[d]=RA(p[d-1]+h);return p};let GA=class extends SA{getDefaultOptions(){return{domain:[0,1],range:[0,1],tickCount:5,unknown:void 0,tickMethod:VA}}map(t){return XE(t)?t:this.options.unknown}invert(t){return this.map(t)}clone(){return new GA(this.options)}getTicks(){const{domain:t,tickCount:e,tickMethod:n}=this.options,[r,i]=t;return qy(r)&&qy(i)?n(r,i,e):[]}};const WA=(t,e,n)=>{const[r,i]=t,[o,a]=e;let s,u;return r<i?(s=hE(r,i),u=n(o,a)):(s=hE(i,r),u=n(a,o)),lE(u,s)},HA=(t,e,n)=>{const r=Math.min(t.length,e.length)-1,i=new Array(r),o=new Array(r),a=t[0]>t[r],s=a?[...t].reverse():t,u=a?[...e].reverse():e;for(let c=0;c<r;c+=1)i[c]=hE(s[c],s[c+1]),o[c]=n(u[c],u[c+1]);return e=>{const n=fE(t,e,1,r)-1,a=i[n];return lE(o[n],a)(e)}},YA=(t,e,n,r)=>(Math.min(t.length,e.length)>2?HA:WA)(t,e,r?xA:n);let XA=class extends SA{getDefaultOptions(){return{domain:[0,1],range:[0,1],nice:!1,clamp:!1,round:!1,interpolate:gA,tickCount:5}}map(t){return XE(t)?this.output(t):this.options.unknown}invert(t){return XE(t)?this.input(t):this.options.unknown}nice(){if(!this.options.nice)return;const[t,e,n,...r]=this.getTickMethodOptions();this.options.domain=this.chooseNice()(t,e,n,...r)}getTicks(){const{tickMethod:t}=this.options,[e,n,r,...i]=this.getTickMethodOptions();return t(e,n,r,...i)}getTickMethodOptions(){const{domain:t,tickCount:e}=this.options;return[t[0],t[t.length-1],e]}chooseNice(){return yE}rescale(){this.nice();const[t,e]=this.chooseTransforms();this.composeOutput(t,this.chooseClamp(t)),this.composeInput(t,e,this.chooseClamp(e))}chooseClamp(t){const{clamp:e,range:n}=this.options,r=this.options.domain.map(t),i=Math.min(r.length,n.length);return e?function(t,e){const n=e<t?e:t,r=t>e?t:e;return t=>Math.min(Math.max(n,t),r)}(r[0],r[i-1]):rx}composeOutput(t,e){const{domain:n,range:r,round:i,interpolate:o}=this.options,a=YA(n.map(t),r,o,i);this.output=lE(a,e,t)}composeInput(t,e,n){const{domain:r,range:i}=this.options,o=YA(i,r.map(t),gA);this.input=lE(e,n,o)}},qA=class extends XA{getDefaultOptions(){return{domain:[0,1],range:[0,1],unknown:void 0,nice:!1,clamp:!1,round:!1,interpolate:yA,tickMethod:LA,tickCount:5}}chooseTransforms(){return[rx,rx]}clone(){return new qA(this.options)}},ZA=class extends PA{getDefaultOptions(){return{domain:[],range:[0,1],align:.5,round:!1,padding:0,unknown:MA,paddingInner:1,paddingOuter:0}}constructor(t){super(t)}getPaddingInner(){return 1}clone(){return new ZA(this.options)}update(t){super.update(t)}getPaddingOuter(){return this.options.padding}};const $A=t=>t<0?-Math.sqrt(-t):Math.sqrt(t);let KA=class extends XA{getDefaultOptions(){return{domain:[0,1],range:[0,1],nice:!1,clamp:!1,round:!1,exponent:2,interpolate:yA,tickMethod:LA,tickCount:5}}constructor(t){super(t)}chooseTransforms(){const{exponent:t}=this.options;if(1===t)return[rx,rx];const e=.5===t?$A:(t=>e=>e<0?-((-e)**t):e**t)(t),n=(t=>e=>e<0?-((-e)**(1/t)):e**(1/t))(t);return[e,n]}clone(){return new KA(this.options)}},JA=class extends KA{getDefaultOptions(){return{domain:[0,1],range:[0,1],nice:!1,clamp:!1,round:!1,interpolate:yA,tickMethod:LA,tickCount:5,exponent:.5}}constructor(t){super(t)}update(t){super.update(t)}clone(){return new JA(this.options)}},QA=class extends SA{constructor(t){super(t)}getDefaultOptions(){return{domain:[.5],range:[0,1]}}map(t){if(!XE(t))return this.options.unknown;const e=fE(this.thresholds,t,0,this.n);return this.options.range[e]}invert(t){const{range:e}=this.options,n=e.indexOf(t),r=this.thresholds;return[r[n-1],r[n]]}clone(){return new QA(this.options)}rescale(){const{domain:t,range:e}=this.options;this.n=Math.min(t.length,e.length-1),this.thresholds=t}};const tT=(t,e,n,r=10)=>{const i=t<0,o=$E(r,i),a=ZE(r,i),s=e<t,u=s?e:t,c=s?t:e;let l=a(u),h=a(c),f=[];if(!(r%1)&&h-l<n){if(l=Math.floor(l),h=Math.ceil(h),i)for(;l<=h;l+=1){const t=o(l);for(let e=r-1;e>=1;e-=1){const n=t*e;if(n>c)break;n>=u&&f.push(n)}}else for(;l<=h;l+=1){const t=o(l);for(let e=1;e<r;e+=1){const n=t*e;if(n>c)break;n>=u&&f.push(n)}}2*f.length<n&&(f=LA(u,c,n))}else f=LA(l,h,Math.min(h-l,n)).map(o);return s?f.reverse():f};let eT=class extends XA{getDefaultOptions(){return{domain:[1,10],range:[0,1],base:10,interpolate:yA,tickMethod:tT,tickCount:5}}chooseNice(){return KE}getTickMethodOptions(){const{domain:t,tickCount:e,base:n}=this.options;return[t[0],t[t.length-1],e,n]}chooseTransforms(){const{base:t,domain:e}=this.options,n=e[0]<0;return[ZE(t,n),$E(t,n)]}clone(){return new eT(this.options)}},nT=class extends QA{getDefaultOptions(){return{domain:[0,1],range:[.5],nice:!1,tickCount:5,tickMethod:VA}}constructor(t){super(t)}nice(){const{nice:t}=this.options;if(t){const[t,e,n]=this.getTickMethodOptions();this.options.domain=yE(t,e,n)}}getTicks(){const{tickMethod:t}=this.options,[e,n,r]=this.getTickMethodOptions();return t(e,n,r)}getTickMethodOptions(){const{domain:t,tickCount:e}=this.options;return[t[0],t[t.length-1],e]}rescale(){this.nice();const{range:t,domain:e}=this.options,[n,r]=e;this.n=t.length-1,this.thresholds=new Array(this.n);for(let i=0;i<this.n;i+=1)this.thresholds[i]=((i+1)*r-(i-this.n)*n)/(this.n+1)}invert(t){const[e,n]=super.invert(t),[r,i]=this.options.domain;return void 0===e&&void 0===n?[e,n]:[e||r,n||i]}getThresholds(){return this.thresholds}clone(){return new nT(this.options)}};function rT(t,e){const n=t.length;if(!n)return;if(n<2)return t[n-1];const r=(n-1)*e,i=Math.floor(r),o=t[i];return o+(t[i+1]-o)*(r-i)}let iT=class extends QA{getDefaultOptions(){return{domain:[],range:[],tickCount:5,unknown:void 0,tickMethod:VA}}constructor(t){super(t)}rescale(){const{domain:t,range:e}=this.options;this.n=e.length-1,this.thresholds=function(t,e,n=!1){const r=t;n||r.sort(((t,e)=>t-e));const i=[];for(let o=1;o<e;o+=1)i.push(rT(r,o/e));return i}(t,this.n+1,!1)}invert(t){const[e,n]=super.invert(t),{domain:r}=this.options,i=r[0],o=r[r.length-1];return void 0===e&&void 0===n?[e,n]:[e||i,n||o]}getThresholds(){return this.thresholds}clone(){return new iT(this.options)}getTicks(){const{tickCount:t,domain:e,tickMethod:n}=this.options,r=e.length-1;return n(e[0],e[r],t)}};var oT=/d{1,4}|M{1,4}|YY(?:YY)?|S{1,3}|Do|ZZ|Z|([HhMsDm])\1?|[aA]|"[^"]*"|'[^']*'/g,aT=/\[([^]*?)\]/gm;function sT(t,e){for(var n=[],r=0,i=t.length;r<i;r++)n.push(t[r].substr(0,e));return n}function uT(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];for(var a in o)t[a]=o[a]}return t}var cT=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],lT=["January","February","March","April","May","June","July","August","September","October","November","December"],hT=sT(lT,3),fT=uT({},{dayNamesShort:sT(cT,3),dayNames:cT,monthNamesShort:hT,monthNames:lT,amPm:["am","pm"],DoFn:function(t){return t+["th","st","nd","rd"][t%10>3?0:(t-t%10!=10?1:0)*t%10]}}),pT=function(t,e){for(void 0===e&&(e=2),t=String(t);t.length<e;)t="0"+t;return t},dT={D:function(t){return String(t.getDate())},DD:function(t){return pT(t.getDate())},Do:function(t,e){return e.DoFn(t.getDate())},d:function(t){return String(t.getDay())},dd:function(t){return pT(t.getDay())},ddd:function(t,e){return e.dayNamesShort[t.getDay()]},dddd:function(t,e){return e.dayNames[t.getDay()]},M:function(t){return String(t.getMonth()+1)},MM:function(t){return pT(t.getMonth()+1)},MMM:function(t,e){return e.monthNamesShort[t.getMonth()]},MMMM:function(t,e){return e.monthNames[t.getMonth()]},YY:function(t){return pT(String(t.getFullYear()),4).substr(2)},YYYY:function(t){return pT(t.getFullYear(),4)},h:function(t){return String(t.getHours()%12||12)},hh:function(t){return pT(t.getHours()%12||12)},H:function(t){return String(t.getHours())},HH:function(t){return pT(t.getHours())},m:function(t){return String(t.getMinutes())},mm:function(t){return pT(t.getMinutes())},s:function(t){return String(t.getSeconds())},ss:function(t){return pT(t.getSeconds())},S:function(t){return String(Math.round(t.getMilliseconds()/100))},SS:function(t){return pT(Math.round(t.getMilliseconds()/10),2)},SSS:function(t){return pT(t.getMilliseconds(),3)},a:function(t,e){return t.getHours()<12?e.amPm[0]:e.amPm[1]},A:function(t,e){return t.getHours()<12?e.amPm[0].toUpperCase():e.amPm[1].toUpperCase()},ZZ:function(t){var e=t.getTimezoneOffset();return(e>0?"-":"+")+pT(100*Math.floor(Math.abs(e)/60)+Math.abs(e)%60,4)},Z:function(t){var e=t.getTimezoneOffset();return(e>0?"-":"+")+pT(Math.floor(Math.abs(e)/60),2)+":"+pT(Math.abs(e)%60,2)}},mT={default:"ddd MMM DD YYYY HH:mm:ss",shortDate:"M/D/YY",mediumDate:"MMM D, YYYY",longDate:"MMMM D, YYYY",fullDate:"dddd, MMMM D, YYYY",isoDate:"YYYY-MM-DD",isoDateTime:"YYYY-MM-DDTHH:mm:ssZ",shortTime:"HH:mm",mediumTime:"HH:mm:ss",longTime:"HH:mm:ss.SSS"};const vT=(t,e,n,r,i)=>{const o=t>e,a=o?e:t,s=o?t:e,[u,c]=HE(a,s,n,r,i),l=u.range(a,new Date(+s+1),c,!0);return o?l.reverse():l};function gT(t){const e=t.getTimezoneOffset(),n=new Date(t);return n.setMinutes(n.getMinutes()+e,n.getSeconds(),n.getMilliseconds()),n}let yT=class extends XA{getDefaultOptions(){return{domain:[new Date(2e3,0,1),new Date(2e3,0,2)],range:[0,1],nice:!1,tickCount:5,tickInterval:void 0,unknown:void 0,clamp:!1,tickMethod:vT,interpolate:gA,mask:void 0,utc:!1}}chooseTransforms(){return[t=>+t,t=>new Date(t)]}chooseNice(){return YE}getTickMethodOptions(){const{domain:t,tickCount:e,tickInterval:n,utc:r}=this.options;return[t[0],t[t.length-1],e,n,r]}getFormatter(){const{mask:t,utc:e}=this.options,n=e?WE:NE,r=e?gT:rx;return e=>function(t,e,n){if(void 0===e&&(e=mT.default),void 0===n&&(n={}),"number"==typeof t&&(t=new Date(t)),"[object Date]"!==Object.prototype.toString.call(t)||isNaN(t.getTime()))throw new Error("Invalid Date pass to format");var r=[];e=(e=mT[e]||e).replace(aT,(function(t,e){return r.push(e),"@@@"}));var i=uT(uT({},fT),n);return(e=e.replace(oT,(function(e){return dT[e](t,i)}))).replace(/@@@/g,(function(){return r.shift()}))}(r(e),t||function(t,e){const{second:n,minute:r,hour:i,day:o,week:a,month:s,year:u}=e;return n.floor(t)<t?".SSS":r.floor(t)<t?":ss":i.floor(t)<t?"hh:mm":o.floor(t)<t?"hh A":s.floor(t)<t?a.floor(t)<t?"MMM DD":"ddd DD":u.floor(t)<t?"MMMM":"YYYY"}(e,n))}clone(){return new yT(this.options)}};var xT,bT=globalThis&&globalThis.__decorate||function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a};let _T=xT=class extends qA{getDefaultOptions(){return{domain:[0,1],unknown:void 0,nice:!1,clamp:!1,round:!1,interpolator:rx,tickMethod:LA,tickCount:5}}constructor(t){super(t)}clone(){return new xT(this.options)}};_T=xT=bT([JE((function(t){return[t(0),t(1)]}),(t=>{const[e,n]=t;return lE(gA(0,1),hE(e,n))}))],_T);var wT,ST=globalThis&&globalThis.__decorate||function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a};let MT=wT=class extends qA{getDefaultOptions(){return{domain:[0,.5,1],unknown:void 0,nice:!1,clamp:!1,round:!1,interpolator:rx,tickMethod:LA,tickCount:5}}constructor(t){super(t)}clone(){return new wT(this.options)}};MT=wT=ST([JE((function(t){return[t(0),t(.5),t(1)]}),(t=>{const[e,n,r]=t,i=lE(gA(0,.5),hE(e,n)),o=lE(gA(.5,1),hE(n,r));return t=>e>r?t<n?o(t):i(t):t<n?i(t):o(t)}))],MT);const ET=t=>new PA(t);ET.props={};const AT=t=>new qA(t);AT.props={};const TT=t=>new CA(t);TT.props={};const CT=t=>new GA(t);CT.props={};const OT=t=>new ZA(t);OT.props={};const kT=t=>new yT(t);kT.props={};const PT=t=>new eT(t);PT.props={};const LT=t=>new KA(t);LT.props={};const RT=t=>new QA(t);RT.props={};const IT=t=>new iT(t);IT.props={};const NT=t=>new nT(t);NT.props={};const DT=t=>new JA(t);DT.props={};const FT=t=>new _T(t);function jT(t){return function(){return t}}FT.props={};const BT=Math.abs,zT=Math.atan2,UT=Math.cos,VT=Math.max,GT=Math.min,WT=Math.sin,HT=Math.sqrt,YT=1e-12,XT=Math.PI,qT=XT/2,ZT=2*XT;function $T(t){return t>1?0:t<-1?XT:Math.acos(t)}function KT(t){return t>=1?qT:t<=-1?-qT:Math.asin(t)}const JT=Math.PI,QT=2*JT,tC=1e-6,eC=QT-tC;function nC(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}let rC=class{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==t?nC:function(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return nC;const n=10**e;return function(t){this._+=t[0];for(let e=1,r=t.length;e<r;++e)this._+=Math.round(arguments[e]*n)/n+t[e]}}(t)}moveTo(t,e){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,e){this._append`L${this._x1=+t},${this._y1=+e}`}quadraticCurveTo(t,e,n,r){this._append`Q${+t},${+e},${this._x1=+n},${this._y1=+r}`}bezierCurveTo(t,e,n,r,i,o){this._append`C${+t},${+e},${+n},${+r},${this._x1=+i},${this._y1=+o}`}arcTo(t,e,n,r,i){if(t=+t,e=+e,n=+n,r=+r,(i=+i)<0)throw new Error(`negative radius: ${i}`);let o=this._x1,a=this._y1,s=n-t,u=r-e,c=o-t,l=a-e,h=c*c+l*l;if(null===this._x1)this._append`M${this._x1=t},${this._y1=e}`;else if(h>tC)if(Math.abs(l*s-u*c)>tC&&i){let f=n-o,p=r-a,d=s*s+u*u,m=f*f+p*p,v=Math.sqrt(d),g=Math.sqrt(h),y=i*Math.tan((JT-Math.acos((d+h-m)/(2*v*g)))/2),x=y/g,b=y/v;Math.abs(x-1)>tC&&this._append`L${t+x*c},${e+x*l}`,this._append`A${i},${i},0,0,${+(l*f>c*p)},${this._x1=t+b*s},${this._y1=e+b*u}`}else this._append`L${this._x1=t},${this._y1=e}`;else;}arc(t,e,n,r,i,o){if(t=+t,e=+e,o=!!o,(n=+n)<0)throw new Error(`negative radius: ${n}`);let a=n*Math.cos(r),s=n*Math.sin(r),u=t+a,c=e+s,l=1^o,h=o?r-i:i-r;null===this._x1?this._append`M${u},${c}`:(Math.abs(this._x1-u)>tC||Math.abs(this._y1-c)>tC)&&this._append`L${u},${c}`,n&&(h<0&&(h=h%QT+QT),h>eC?this._append`A${n},${n},0,1,${l},${t-a},${e-s}A${n},${n},0,1,${l},${this._x1=u},${this._y1=c}`:h>tC&&this._append`A${n},${n},0,${+(h>=JT)},${l},${this._x1=t+n*Math.cos(i)},${this._y1=e+n*Math.sin(i)}`)}rect(t,e,n,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}h${n=+n}v${+r}h${-n}Z`}toString(){return this._}};function iC(){return new rC}function oC(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(null==n)e=null;else{const t=Math.floor(n);if(!(t>=0))throw new RangeError(`invalid digits: ${n}`);e=t}return t},()=>new rC(e)}function aC(t){return t.innerRadius}function sC(t){return t.outerRadius}function uC(t){return t.startAngle}function cC(t){return t.endAngle}function lC(t){return t&&t.padAngle}function hC(t,e,n,r,i,o,a,s){var u=n-t,c=r-e,l=a-i,h=s-o,f=h*u-l*c;if(!(f*f<YT))return[t+(f=(l*(e-o)-h*(t-i))/f)*u,e+f*c]}function fC(t,e,n,r,i,o,a){var s=t-n,u=e-r,c=(a?o:-o)/HT(s*s+u*u),l=c*u,h=-c*s,f=t+l,p=e+h,d=n+l,m=r+h,v=(f+d)/2,g=(p+m)/2,y=d-f,x=m-p,b=y*y+x*x,_=i-o,w=f*m-d*p,S=(x<0?-1:1)*HT(VT(0,_*_*b-w*w)),M=(w*x-y*S)/b,E=(-w*y-x*S)/b,A=(w*x+y*S)/b,T=(-w*y+x*S)/b,C=M-v,O=E-g,k=A-v,P=T-g;return C*C+O*O>k*k+P*P&&(M=A,E=T),{cx:M,cy:E,x01:-l,y01:-h,x11:M*(i/_-1),y11:E*(i/_-1)}}function pC(){var t=aC,e=sC,n=jT(0),r=null,i=uC,o=cC,a=lC,s=null,u=oC(c);function c(){var c,l,h=+t.apply(this,arguments),f=+e.apply(this,arguments),p=i.apply(this,arguments)-qT,d=o.apply(this,arguments)-qT,m=BT(d-p),v=d>p;if(s||(s=c=u()),f<h&&(l=f,f=h,h=l),f>YT)if(m>ZT-YT)s.moveTo(f*UT(p),f*WT(p)),s.arc(0,0,f,p,d,!v),h>YT&&(s.moveTo(h*UT(d),h*WT(d)),s.arc(0,0,h,d,p,v));else{var g,y,x=p,b=d,_=p,w=d,S=m,M=m,E=a.apply(this,arguments)/2,A=E>YT&&(r?+r.apply(this,arguments):HT(h*h+f*f)),T=GT(BT(f-h)/2,+n.apply(this,arguments)),C=T,O=T;if(A>YT){var k=KT(A/h*WT(E)),P=KT(A/f*WT(E));(S-=2*k)>YT?(_+=k*=v?1:-1,w-=k):(S=0,_=w=(p+d)/2),(M-=2*P)>YT?(x+=P*=v?1:-1,b-=P):(M=0,x=b=(p+d)/2)}var L=f*UT(x),R=f*WT(x),I=h*UT(w),N=h*WT(w);if(T>YT){var D,F=f*UT(b),j=f*WT(b),B=h*UT(_),z=h*WT(_);if(m<XT)if(D=hC(L,R,B,z,F,j,I,N)){var U=L-D[0],V=R-D[1],G=F-D[0],W=j-D[1],H=1/WT($T((U*G+V*W)/(HT(U*U+V*V)*HT(G*G+W*W)))/2),Y=HT(D[0]*D[0]+D[1]*D[1]);C=GT(T,(h-Y)/(H-1)),O=GT(T,(f-Y)/(H+1))}else C=O=0}M>YT?O>YT?(g=fC(B,z,L,R,f,O,v),y=fC(F,j,I,N,f,O,v),s.moveTo(g.cx+g.x01,g.cy+g.y01),O<T?s.arc(g.cx,g.cy,O,zT(g.y01,g.x01),zT(y.y01,y.x01),!v):(s.arc(g.cx,g.cy,O,zT(g.y01,g.x01),zT(g.y11,g.x11),!v),s.arc(0,0,f,zT(g.cy+g.y11,g.cx+g.x11),zT(y.cy+y.y11,y.cx+y.x11),!v),s.arc(y.cx,y.cy,O,zT(y.y11,y.x11),zT(y.y01,y.x01),!v))):(s.moveTo(L,R),s.arc(0,0,f,x,b,!v)):s.moveTo(L,R),h>YT&&S>YT?C>YT?(g=fC(I,N,F,j,h,-C,v),y=fC(L,R,B,z,h,-C,v),s.lineTo(g.cx+g.x01,g.cy+g.y01),C<T?s.arc(g.cx,g.cy,C,zT(g.y01,g.x01),zT(y.y01,y.x01),!v):(s.arc(g.cx,g.cy,C,zT(g.y01,g.x01),zT(g.y11,g.x11),!v),s.arc(0,0,h,zT(g.cy+g.y11,g.cx+g.x11),zT(y.cy+y.y11,y.cx+y.x11),v),s.arc(y.cx,y.cy,C,zT(y.y11,y.x11),zT(y.y01,y.x01),!v))):s.arc(0,0,h,w,_,v):s.lineTo(I,N)}else s.moveTo(0,0);if(s.closePath(),c)return s=null,c+""||null}return c.centroid=function(){var n=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,r=(+i.apply(this,arguments)+ +o.apply(this,arguments))/2-XT/2;return[UT(r)*n,WT(r)*n]},c.innerRadius=function(e){return arguments.length?(t="function"==typeof e?e:jT(+e),c):t},c.outerRadius=function(t){return arguments.length?(e="function"==typeof t?t:jT(+t),c):e},c.cornerRadius=function(t){return arguments.length?(n="function"==typeof t?t:jT(+t),c):n},c.padRadius=function(t){return arguments.length?(r=null==t?null:"function"==typeof t?t:jT(+t),c):r},c.startAngle=function(t){return arguments.length?(i="function"==typeof t?t:jT(+t),c):i},c.endAngle=function(t){return arguments.length?(o="function"==typeof t?t:jT(+t),c):o},c.padAngle=function(t){return arguments.length?(a="function"==typeof t?t:jT(+t),c):a},c.context=function(t){return arguments.length?(s=null==t?null:t,c):s},c}function dC(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function mC(t){this._context=t}function vC(t){return new mC(t)}function gC(t){return t[0]}function yC(t){return t[1]}function xC(t,e){var n=jT(!0),r=null,i=vC,o=null,a=oC(s);function s(s){var u,c,l,h=(s=dC(s)).length,f=!1;for(null==r&&(o=i(l=a())),u=0;u<=h;++u)!(u<h&&n(c=s[u],u,s))===f&&((f=!f)?o.lineStart():o.lineEnd()),f&&o.point(+t(c,u,s),+e(c,u,s));if(l)return o=null,l+""||null}return t="function"==typeof t?t:void 0===t?gC:jT(t),e="function"==typeof e?e:void 0===e?yC:jT(e),s.x=function(e){return arguments.length?(t="function"==typeof e?e:jT(+e),s):t},s.y=function(t){return arguments.length?(e="function"==typeof t?t:jT(+t),s):e},s.defined=function(t){return arguments.length?(n="function"==typeof t?t:jT(!!t),s):n},s.curve=function(t){return arguments.length?(i=t,null!=r&&(o=i(r)),s):i},s.context=function(t){return arguments.length?(null==t?r=o=null:o=i(r=t),s):r},s}function bC(t,e,n){var r=null,i=jT(!0),o=null,a=vC,s=null,u=oC(c);function c(c){var l,h,f,p,d,m=(c=dC(c)).length,v=!1,g=new Array(m),y=new Array(m);for(null==o&&(s=a(d=u())),l=0;l<=m;++l){if(!(l<m&&i(p=c[l],l,c))===v)if(v=!v)h=l,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),f=l-1;f>=h;--f)s.point(g[f],y[f]);s.lineEnd(),s.areaEnd()}v&&(g[l]=+t(p,l,c),y[l]=+e(p,l,c),s.point(r?+r(p,l,c):g[l],n?+n(p,l,c):y[l]))}if(d)return s=null,d+""||null}function l(){return xC().defined(i).curve(a).context(o)}return t="function"==typeof t?t:void 0===t?gC:jT(+t),e="function"==typeof e?e:jT(void 0===e?0:+e),n="function"==typeof n?n:void 0===n?yC:jT(+n),c.x=function(e){return arguments.length?(t="function"==typeof e?e:jT(+e),r=null,c):t},c.x0=function(e){return arguments.length?(t="function"==typeof e?e:jT(+e),c):t},c.x1=function(t){return arguments.length?(r=null==t?null:"function"==typeof t?t:jT(+t),c):r},c.y=function(t){return arguments.length?(e="function"==typeof t?t:jT(+t),n=null,c):e},c.y0=function(t){return arguments.length?(e="function"==typeof t?t:jT(+t),c):e},c.y1=function(t){return arguments.length?(n=null==t?null:"function"==typeof t?t:jT(+t),c):n},c.lineX0=c.lineY0=function(){return l().x(t).y(e)},c.lineY1=function(){return l().x(t).y(n)},c.lineX1=function(){return l().x(r).y(e)},c.defined=function(t){return arguments.length?(i="function"==typeof t?t:jT(!!t),c):i},c.curve=function(t){return arguments.length?(a=t,null!=o&&(s=a(o)),c):a},c.context=function(t){return arguments.length?(null==t?o=s=null:s=a(o=t),c):o},c}iC.prototype=rC.prototype,mC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};var _C=SC(vC);function wC(t){this._curve=t}function SC(t){function e(e){return new wC(t(e))}return e._curve=t,e}function MC(t){var e=t.curve;return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t.curve=function(t){return arguments.length?e(SC(t)):e()._curve},t}function EC(){}function AC(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function TC(t,e){this._context=t,this._k=(1-e)/6}function CC(t,e){this._context=t,this._k=(1-e)/6}function OC(t,e,n){var r=t._x1,i=t._y1,o=t._x2,a=t._y2;if(t._l01_a>YT){var s=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,u=3*t._l01_a*(t._l01_a+t._l12_a);r=(r*s-t._x0*t._l12_2a+t._x2*t._l01_2a)/u,i=(i*s-t._y0*t._l12_2a+t._y2*t._l01_2a)/u}if(t._l23_a>YT){var c=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,l=3*t._l23_a*(t._l23_a+t._l12_a);o=(o*c+t._x1*t._l23_2a-e*t._l12_2a)/l,a=(a*c+t._y1*t._l23_2a-n*t._l12_2a)/l}t._context.bezierCurveTo(r,i,o,a,t._x2,t._y2)}function kC(t,e){this._context=t,this._alpha=e}wC.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(t,e){this._curve.point(e*Math.sin(t),e*-Math.cos(t))}},TC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:AC(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:AC(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}},function t(e){function n(t){return new TC(t,e)}return n.tension=function(e){return t(+e)},n}(0),CC.prototype={areaStart:EC,areaEnd:EC,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:AC(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}},function t(e){function n(t){return new CC(t,e)}return n.tension=function(e){return t(+e)},n}(0),kC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:OC(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const PC=function t(e){function n(t){return e?new kC(t,e):new TC(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function LC(t,e){this._context=t,this._alpha=e}LC.prototype={areaStart:EC,areaEnd:EC,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:OC(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const RC=function t(e){function n(t){return e?new LC(t,e):new CC(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function IC(t){this._context=t}function NC(t){return new IC(t)}function DC(t,e){this._context=t,this._t=e}function FC(t){return new DC(t,.5)}function jC(t){return new DC(t,0)}function BC(t){return new DC(t,1)}function zC(t){return new UC([t],null,t,t.ownerDocument)}IC.prototype={areaStart:EC,areaEnd:EC,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}},DC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}}this._x=t,this._y=e}};let UC=class{constructor(t=null,e=null,n=null,r=null,i=[null,null,null,null,null],o=[],a=[]){this._elements=Array.from(t),this._data=e,this._parent=n,this._document=r,this._enter=i[0],this._update=i[1],this._exit=i[2],this._merge=i[3],this._split=i[4],this._transitions=o,this._facetElements=a}selectAll(t){const e="string"==typeof t?this._parent.querySelectorAll(t):t;return new UC(e,null,this._elements[0],this._document)}selectFacetAll(t){const e="string"==typeof t?this._parent.querySelectorAll(t):t;return new UC(this._elements,null,this._parent,this._document,void 0,void 0,e)}select(t){const e="string"==typeof t?this._parent.querySelectorAll(t)[0]||null:t;return new UC([e],null,e,this._document)}append(t){const e="function"==typeof t?t:()=>this.createElement(t),n=[];if(null!==this._data){for(let t=0;t<this._data.length;t++){const r=this._data[t],[i,o]=Array.isArray(r)?r:[r,null],a=e(i,t);a.__data__=i,null!==o&&(a.__fromElements__=o),this._parent.appendChild(a),n.push(a)}return new UC(n,null,this._parent,this._document)}for(let r=0;r<this._elements.length;r++){const t=this._elements[r],i=e(t.__data__,r);t.appendChild(i),n.push(i)}return new UC(n,null,n[0],this._document)}maybeAppend(t,e){const n=this._elements[0],r=n.getElementById(t);if(r)return new UC([r],null,this._parent,this._document);const i="string"==typeof e?this.createElement(e):e();return i.id=t,n.appendChild(i),new UC([i],null,this._parent,this._document)}data(t,e=(t=>t),n=(()=>null)){const r=[],i=[],o=new Set(this._elements),a=[],s=new Set,u=new Map(this._elements.map(((t,n)=>[e(t.__data__,n),t]))),c=new Map(this._facetElements.map(((t,n)=>[e(t.__data__,n),t]))),l=e_(this._elements,(t=>n(t.__data__)));for(let f=0;f<t.length;f++){const h=t[f],p=e(h,f),d=n(h,f);if(u.has(p)){const t=u.get(p);t.__data__=h,t.__facet__=!1,i.push(t),o.delete(t),u.delete(p)}else if(c.has(p)){const t=c.get(p);t.__data__=h,t.__facet__=!0,i.push(t),c.delete(p)}else if(l.has(p)){const t=l.get(p);a.push([h,t]);for(const e of t)o.delete(e);l.delete(p)}else if(u.has(d)){const t=u.get(d);t.__toData__?t.__toData__.push(h):t.__toData__=[h],s.add(t),o.delete(t)}else r.push(h)}const h=[new UC([],r,this._parent,this._document),new UC(i,null,this._parent,this._document),new UC(o,null,this._parent,this._document),new UC([],a,this._parent,this._document),new UC(s,null,this._parent,this._document)];return new UC(this._elements,null,this._parent,this._document,h)}merge(t){const e=[...this._elements,...t._elements],n=[...this._transitions,...t._transitions];return new UC(e,null,this._parent,this._document,void 0,n)}createElement(t){if(this._document)return this._document.createElement(t,{});const e=UC.registry[t];return e?new e:bw(`Unknown node type: ${t}`)}join(t=(t=>t),e=(t=>t),n=(t=>t.remove()),r=(t=>t),i=(t=>t.remove())){const o=t(this._enter),a=e(this._update),s=n(this._exit),u=r(this._merge),c=i(this._split);return a.merge(o).merge(s).merge(u).merge(c)}remove(){for(let t=0;t<this._elements.length;t++){const e=this._elements[t],n=this._transitions[t];if(n){(Array.isArray(n)?n:[n]).map((t=>t.finished.then((()=>e.remove()))))}else e.remove()}return new UC([],null,this._parent,this._document,void 0,this._transitions)}each(t){for(let e=0;e<this._elements.length;e++){const n=this._elements[e],r=n.__data__;t.call(n,r,e)}return this}attr(t,e){const n="function"!=typeof e?()=>e:e;return this.each((function(r,i){void 0!==e&&(this[t]=n.call(this,r,i))}))}style(t,e){const n="function"!=typeof e?()=>e:e;return this.each((function(r,i){void 0!==e&&(this.style[t]=n.call(this,r,i))}))}transition(t){const e="function"!=typeof t?()=>t:t,{_transitions:n}=this;return this.each((function(t,r){n[r]=e.call(this,t,r)}))}on(t,e){return this.each((function(){this.addEventListener(t,e)})),this}call(t,...e){return t.call(this._parent,this,...e),this}node(){return this._elements[0]}nodes(){return this._elements}transitions(){return this._transitions}parent(){return this._parent}};function VC([t,e],[n,r]){return[t-n,e-r]}function GC([t,e],[n,r]){return Math.sqrt(Math.pow(t-n,2)+Math.pow(e-r,2))}function WC([t,e]){return Math.atan2(e,t)}function HC([t,e]){return WC([t,e])+Math.PI/2}function YC(t){let e=1/0,n=-1/0,r=1/0,i=-1/0;for(const[o,a]of t)e=Math.min(o,e),n=Math.max(o,n),r=Math.min(a,r),i=Math.max(a,i);return[e,r,n-e,i-r]}function XC([t,e],[n,r]){return[(t+n)/2,(e+r)/2]}function qC(t,e){return Object.entries(t).reduce(((n,[r,i])=>(n[r]=e(i,r,t),n)),{})}function ZC(t){return t.map(((t,e)=>e))}function $C(t){return t[0]}function KC(t){return t[t.length-1]}function JC(t,e){for(const[n,r]of Object.entries(e))t.style(n,r)}function QC(t,e,n){const{arrowSize:r}=n,i="string"==typeof r?+parseFloat(r)/100*GC(t,e):r,o=Math.PI/6,a=Math.atan2(e[1]-t[1],e[0]-t[0]),s=Math.PI/2-a-o,u=a-o;return[[e[0]-i*Math.sin(s),e[1]-i*Math.cos(s)],[e[0]-i*Math.cos(u),e[1]-i*Math.sin(u)]]}function tO(t,e,n,r,i){const o=WC(VC(r,e))+Math.PI,a=WC(VC(r,n))+Math.PI;return t.arc(r[0],r[1],i,o,a,a-o<0),t}function eO(t,e,n,r="y",i="between"){const o="y"===r||!0===r?n:e,a="y"===r||!0===r?90:0,s=ZC(o),[u,c]=Zb(s,(t=>o[t])),l=new qA({domain:[u,c],range:[0,100]}),h=t=>l.map(o[t]),f={between:e=>`${t[e]} ${h(e)}%`,start:e=>0===e?`${t[e]} ${h(e)}%`:`${t[e-1]} ${h(e)}%, ${t[e]} ${h(e)}%`,end:e=>e===t.length-1?`${t[e]} ${h(e)}%`:`${t[e]} ${h(e)}%, ${t[e+1]} ${h(e)}%`};return`linear-gradient(${a}deg, ${s.sort(((t,e)=>h(t)-h(e))).map(f[i]||f.between).join(",")})`}function nO(t){const[e,n,r,i]=t;return[i,e,n,r]}function rO(t,e,n){const[r,i,,o]=T_(t)?nO(e):e,[a,s]=n,u=t.getCenter(),c=HC(VC(r,u)),l=HC(VC(i,u)),h=l===c&&a!==s?l+2*Math.PI:l;return{startAngle:c,endAngle:h-c>=0?h:2*Math.PI+h,innerRadius:GC(o,u),outerRadius:GC(r,u)}}function iO(t,e,n,r){const{defaultColor:i}=t,o=t[e]||{};return Object.assign({},{fill:i,stroke:i},o[n]||o[r])}function oO(t){const{opacityAttribute:e="fill"}=t;return`${e}Opacity`}function aO(t,e){if(!C_(t))return"";const n=t.getCenter(),{transform:r}=e;return`translate(${n[0]}, ${n[1]}) ${r||""}`}UC.registry={g:Kf,rect:hp,circle:Vf,path:op,text:pp,ellipse:Zf,image:ep,line:rp,polygon:sp,polyline:cp,html:Qf};var sO=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const uO=t=>{const{colorAttribute:e,opacityAttribute:n="fill",first:r=!0,last:i=!0}=t,o=sO(t,["colorAttribute","opacityAttribute","first","last"]);return(n,a,s,u)=>{const{mark:c,shape:l,defaultShape:h}=a,f=iO(u,c,l,h),p=e,d=f[p],{radius:m=0}=f,v=sO(f,["symbol"==typeof p?p:p+"","radius"]),g=v.lineWidth||1,{stroke:y,radius:x=m,radiusTopLeft:b=x,radiusTopRight:_=x,radiusBottomRight:w=x,radiusBottomLeft:S=x,innerRadius:M=0,innerRadiusTopLeft:E=M,innerRadiusTopRight:A=M,innerRadiusBottomRight:T=M,innerRadiusBottomLeft:C=M,inset:O=0,insetLeft:k=O,insetRight:P=O,insetBottom:L=O,insetTop:R=O,lineWidth:I=("stroke"===e||y?g:0)}=o,N=sO(o,["stroke","radius","radiusTopLeft","radiusTopRight","radiusBottomRight","radiusBottomLeft","innerRadius","innerRadiusTopLeft","innerRadiusTopRight","innerRadiusBottomRight","innerRadiusBottomLeft","inset","insetLeft","insetRight","insetBottom","insetTop","lineWidth"]),{color:D=d,opacity:F}=a;if(!C_(s)&&!k_(s)){const o=!!T_(s),[a,,u]=o?nO(n):n,[c,l]=a,[h,f]=VC(u,a),p=(h>0?c:c+h)+k,d=(f>0?l:l+f)+R,m=Math.abs(h)-(k+P),g=Math.abs(f)-(R+L);return zC(new hp({})).call(JC,v).style("lineWidth",I).style("x",p).style("y",d).style("width",m).style("height",g).style("stroke",void 0===y?D:y).style(oO(t),F).style(e,D).style("radius",[r?b:E,r?_:A,i?w:T,i?S:C]).call(JC,N).node()}const{y:j,y1:B}=a,z=s.getCenter(),U=rO(s,n,[j,B]),V=pC().cornerRadius(x).padAngle(O*Math.PI/180);return zC(new op({})).call(JC,v).style("path",V(U)).style("transform",`translate(${z[0]}, ${z[1]})`).style("stroke",D||y).style("lineWidth",I).style(e,D).style(oO(t),F).call(JC,o).node()}};uO.props={defaultEnterAnimation:"scaleInY",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const cO=t=>uO(Object.assign({colorAttribute:"fill"},t));cO.props=Object.assign({},uO.props);const lO=t=>uO(Object.assign({colorAttribute:"stroke"},t));lO.props=Object.assign({},uO.props);var hO=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};function fO(t,e,n){const[r,i,o,a]=t;if(T_(n)){return[r,[e?e[0][0]:i[0],i[1]],[e?e[3][0]:o[0],o[1]],a]}return[r,[i[0],e?e[0][1]:i[1]],[o[0],e?e[3][1]:o[1]],a]}const pO=t=>{const{adjustPoints:e=fO}=t,n=hO(t,["adjustPoints"]);return(t,r,i,o,a,...s)=>{const{index:u}=r,c=a[u+1],l=e(t,c,i);return uO(Object.assign({colorAttribute:"fill"},n))(l,r,i,o,a,...s)}};function dO(t,e,n){const[r,i,o,a]=t;if(T_(n)){return[r,[e?e[0][0]:(i[0]+o[0])/2,i[1]],[e?e[3][0]:(i[0]+o[0])/2,o[1]],a]}return[r,[i[0],e?e[0][1]:(i[1]+o[1])/2],[o[0],e?e[3][1]:(i[1]+o[1])/2],a]}pO.props=Object.assign({},uO.props);const mO=t=>pO(Object.assign({adjustPoints:dO},t));function vO(t){const e="function"==typeof t?t:t.render;return class extends Wf{connectedCallback(){this.draw()}attributeChangedCallback(){this.draw()}draw(){e(this)}}}mO.props=Object.assign({},uO.props);var gO=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const yO=vO((t=>{const{d1:e,d2:n,style1:r,style2:i}=t.attributes;zC(t).maybeAppend("line",(()=>new op({}))).style("d",e).call(JC,r),zC(t).maybeAppend("line1",(()=>new op({}))).style("d",n).call(JC,i)}));const xO=t=>{const{curve:e,gradient:n=!1,gradientColor:r="between",defined:i=(t=>!Number.isNaN(t)&&null!=t),connectNulls:o=!1}=t,a=gO(t,["curve","gradient","gradientColor","defined","connectNulls"]);return(t,s,u,c)=>{const{mark:l,shape:h,defaultShape:f}=s,p=iO(c,l,h,f),{stroke:d,lineWidth:m}=p,v=gO(p,["stroke","lineWidth"]),{color:g=d,size:y=m,seriesColor:x,seriesX:b,seriesY:_}=s,w=n&&x?eO(x,b,_,n,r):g,S=aO(u,s),M=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},v),w&&{stroke:w}),y&&{lineWidth:y}),S&&{transform:S}),a);let E;if(C_(u)){const t=u.getCenter();E=n=>MC(xC().curve(_C)).angle(((e,r)=>HC(VC(n[r],t)))).radius(((e,r)=>GC(n[r],t))).defined((([t,e])=>i(t)&&i(e))).curve(e)(n)}else E=xC().x((t=>t[0])).y((t=>t[1])).defined((([t,e])=>i(t)&&i(e))).curve(e);const[A,T]=function(t,e){const n=[],r=[];let i=!1,o=null;for(const a of t)e(a[0])&&e(a[1])?(n.push(a),i&&(i=!1,r.push([o,a])),o=a):i=!0;return[n,r]}(t,i),C=Mw(M,"connect"),O=!!T.length;if(!O||o&&!Object.keys(C).length)return zC(new op({})).style("d",E(A)).call(JC,M).node();if(O&&!o)return zC(new op({})).style("d",E(t)).call(JC,M).node();return zC(new yO).style("style1",Object.assign(Object.assign({},M),C)).style("style2",M).style("d1",(k=T,k.map(E).join(","))).style("d2",E(t)).node();var k}};xO.props={defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const bO=t=>(e,n,r,i)=>{const o=C_(r)?NC:vC;return xO(Object.assign({curve:o},t))(e,n,r,i)};bO.props=Object.assign({},xO.props);var _O=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const wO=t=>{const{alpha:e=.5}=t,n=_O(t,["alpha"]);return(t,r,i,o)=>{const a=C_(i)?RC:PC;return xO(Object.assign({curve:a.alpha(e)},n))(t,r,i,o)}};wO.props=Object.assign({},xO.props);const SO=t=>xO(Object.assign({curve:BC},t));SO.props=Object.assign({},xO.props);const MO=t=>xO(Object.assign({curve:jC},t));MO.props=Object.assign({},xO.props);const EO=t=>xO(Object.assign({curve:FC},t));function AO(t,e,n){return[["M",t-n,e],["A",n,n,0,1,0,t+n,e],["A",n,n,0,1,0,t-n,e],["Z"]]}EO.props=Object.assign({},xO.props);const TO=Object.freeze(Object.defineProperty({__proto__:null,bowtie:function(t,e,n){const r=n-1.5;return[["M",t-n,e-r],["L",t+n,e+r],["L",t+n,e-r],["L",t-n,e+r],["Z"]]},cross:function(t,e,n){return[["M",t-n,e-n],["L",t+n,e+n],["M",t+n,e-n],["L",t-n,e+n]]},diamond:function(t,e,n){const r=.618*n;return[["M",t-r,e],["L",t,e-n],["L",t+r,e],["L",t,e+n],["Z"]]},hexagon:function(t,e,n){const r=n/2*Math.sqrt(3);return[["M",t,e-n],["L",t+r,e-n/2],["L",t+r,e+n/2],["L",t,e+n],["L",t-r,e+n/2],["L",t-r,e-n/2],["Z"]]},hyphen:function(t,e,n){return[["M",t-n,e],["L",t+n,e]]},line:function(t,e,n){return[["M",t,e+n],["L",t,e-n]]},plus:function(t,e,n){return[["M",t-n,e],["L",t+n,e],["M",t,e-n],["L",t,e+n]]},point:AO,square:function(t,e,n){return[["M",t-n,e-n],["L",t+n,e-n],["L",t+n,e+n],["L",t-n,e+n],["Z"]]},tick:function(t,e,n){return[["M",t-n/2,e-n],["L",t+n/2,e-n],["M",t,e-n],["L",t,e+n],["M",t-n/2,e+n],["L",t+n/2,e+n]]},triangle:function(t,e,n){const r=n*Math.sin(1/3*Math.PI);return[["M",t-n,e+r],["L",t,e-r],["L",t+n,e+r],["Z"]]},triangleDown:function(t,e,n){const r=n*Math.sin(1/3*Math.PI);return[["M",t-n,e-r],["L",t+n,e-r],["L",t,e+r],["Z"]]}},Symbol.toStringTag,{value:"Module"}));var CO=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const OO=t=>{const{colorAttribute:e,symbol:n,mode:r="auto"}=t,i=CO(t,["colorAttribute","symbol","mode"]),o=TO[n]||AO;return(n,a,s,u)=>{const{mark:c,shape:l,defaultShape:h}=a,f=iO(u,c,l,h),p=e,d=f[p],{lineWidth:m}=f,v=CO(f,["symbol"==typeof p?p:p+"","lineWidth"]),g=i.stroke?m||1:m,{color:y=d,transform:x,opacity:b}=a,[_,w]=function(t){if(1===t.length)return t[0];const[[e,n],[r,i]]=t;return[(e+r)/2,(n+i)/2]}(n),S=function(t,e,n,r){if(1===e.length)return;const{size:i}=n;if("fixed"===t)return i;if("normal"===t||L_(r)){const[[t,n],[r,i]]=e,o=Math.abs((r-t)/2),a=Math.abs((i-n)/2);return Math.max(0,(o+a)/2)}return i}(r,n,a,s),M=S||i.r||v.r;return zC(new op).call(JC,v).style("d",o(_,w,M)).style("lineWidth",g).style("transform",x).style("stroke",y).style(oO(t),b).style(e,y).call(JC,i).node()}};OO.props={defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const kO=t=>OO(Object.assign({colorAttribute:"fill",symbol:"bowtie"},t));kO.props=Object.assign({},OO.props);const PO=t=>OO(Object.assign({colorAttribute:"stroke",symbol:"cross"},t));PO.props=Object.assign({},OO.props);const LO=t=>OO(Object.assign({colorAttribute:"fill",symbol:"diamond"},t));LO.props=Object.assign({},OO.props);const RO=t=>OO(Object.assign({colorAttribute:"fill",symbol:"hexagon"},t));RO.props=Object.assign({},OO.props);const IO=t=>OO(Object.assign({colorAttribute:"stroke",symbol:"bowtie"},t));IO.props=Object.assign({},OO.props);const NO=t=>OO(Object.assign({colorAttribute:"stroke",symbol:"diamond"},t));NO.props=Object.assign({},OO.props);const DO=t=>OO(Object.assign({colorAttribute:"stroke",symbol:"hexagon"},t));DO.props=Object.assign({},OO.props);const FO=t=>OO(Object.assign({colorAttribute:"stroke",symbol:"point"},t));FO.props=Object.assign({},OO.props);const jO=t=>OO(Object.assign({colorAttribute:"stroke",symbol:"square"},t));jO.props=Object.assign({},OO.props);const BO=t=>OO(Object.assign({colorAttribute:"stroke",symbol:"triangle"},t));BO.props=Object.assign({},OO.props);const zO=t=>OO(Object.assign({colorAttribute:"stroke",symbol:"triangle-down"},t));zO.props=Object.assign({},OO.props);const UO=t=>OO(Object.assign({colorAttribute:"stroke",symbol:"hyphen"},t));UO.props=Object.assign({},OO.props);const VO=t=>OO(Object.assign({colorAttribute:"stroke",symbol:"line"},t));VO.props=Object.assign({},OO.props);const GO=t=>OO(Object.assign({colorAttribute:"stroke",symbol:"plus"},t));GO.props=Object.assign({},OO.props);const WO=t=>OO(Object.assign({colorAttribute:"fill",symbol:"point"},t));WO.props=Object.assign({},OO.props);const HO=t=>OO(Object.assign({colorAttribute:"fill",symbol:"square"},t));HO.props=Object.assign({},OO.props);const YO=t=>OO(Object.assign({colorAttribute:"stroke",symbol:"tick"},t));YO.props=Object.assign({},OO.props);const XO=t=>OO(Object.assign({colorAttribute:"fill",symbol:"triangle"},t));XO.props=Object.assign({},OO.props);const qO=t=>OO(Object.assign({colorAttribute:"fill",symbol:"triangle-down"},t));qO.props=Object.assign({},OO.props);var ZO=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const $O=t=>{const{arrowSize:e="40%"}=t,n=ZO(t,["arrowSize"]);return(t,r,i,o)=>{const{mark:a,shape:s,defaultShape:u,color:c,transform:l}=r,h=iO(o,a,s,u),{fill:f,stroke:p}=h,d=ZO(h,["fill","stroke"]),[m,v]=t,[g,y]=QC(m,v,{arrowSize:e}),x=iC();return x.moveTo(...m),x.lineTo(...v),x.moveTo(...v),x.lineTo(...g),x.moveTo(...v),x.lineTo(...y),zC(new op).call(JC,d).style("d",x.toString()).style("stroke",c||p).style("fill",c||f).style("transform",l).call(JC,n).node()}};function KO(t,e,n,r){this.message=t,this.expected=e,this.found=n,this.location=r,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,KO)}$O.props={defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"},function(t,e){function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n}(KO,Error),KO.buildMessage=function(t,e){var n,r={literal:function(t){return'"'+o(t.text)+'"'},class:function(t){var e,n="";for(e=0;e<t.parts.length;e++)n+=t.parts[e]instanceof Array?a(t.parts[e][0])+"-"+a(t.parts[e][1]):a(t.parts[e]);return"["+(t.inverted?"^":"")+n+"]"},any:function(t){return"any character"},end:function(t){return"end of input"},other:function(t){return t.description}};function i(t){return t.charCodeAt(0).toString(16).toUpperCase()}function o(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+i(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+i(t)}))}function a(t){return t.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+i(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+i(t)}))}return"Expected "+function(t){var e,n,i,o=new Array(t.length);for(e=0;e<t.length;e++)o[e]=(i=t[e],r[i.type](i));if(o.sort(),o.length>0){for(e=1,n=1;e<o.length;e++)o[e-1]!==o[e]&&(o[n]=o[e],n++);o.length=n}switch(o.length){case 1:return o[0];case 2:return o[0]+" or "+o[1];default:return o.slice(0,-1).join(", ")+", or "+o[o.length-1]}}(t)+" but "+(((n=e)?'"'+o(n)+'"':"end of input")+" found.")};var JO,QO=function(t,e){e=void 0!==e?e:{};var n,r={},i={svg_path:K},o=K,a=function(t,e){return function(t,e){if(!e)return[t];for(var n=[t],r=0,i=e.length;r<i;r++)n[r+1]=e[r][1];return n}(t,e)},s=/^[Mm]/,u=X(["M","m"],!1,!1),c=/^[Zz]/,l=X(["Z","z"],!1,!1),h=/^[Ll]/,f=X(["L","l"],!1,!1),p=function(t,e){return wt(t,e)},d=/^[Hh]/,m=X(["H","h"],!1,!1),v=/^[Vv]/,g=X(["V","v"],!1,!1),y=/^[Cc]/,x=X(["C","c"],!1,!1),b=/^[Ss]/,_=X(["S","s"],!1,!1),w=/^[Qq]/,S=X(["Q","q"],!1,!1),M=/^[Tt]/,E=X(["T","t"],!1,!1),A=/^[Aa]/,T=X(["A","a"],!1,!1),C=/^[01]/,O=X(["0","1"],!1,!1),k=Y(",",!1),P=function(t){return t.join("")},L=".",R=Y(".",!1),I=/^[eE]/,N=X(["e","E"],!1,!1),D=/^[+\-]/,F=X(["+","-"],!1,!1),j=/^[0-9]/,B=X([["0","9"]],!1,!1),z=/^[ \t\n\r]/,U=X([" ","\t","\n","\r"],!1,!1),V=0,G=[{line:1,column:1}],W=0,H=[];if("startRule"in e){if(!(e.startRule in i))throw new Error("Can't start parsing from rule \""+e.startRule+'".');o=i[e.startRule]}function Y(t,e){return{type:"literal",text:t,ignoreCase:e}}function X(t,e,n){return{type:"class",parts:t,inverted:e,ignoreCase:n}}function q(e){var n,r=G[e];if(r)return r;for(n=e-1;!G[n];)n--;for(r={line:(r=G[n]).line,column:r.column};n<e;)10===t.charCodeAt(n)?(r.line++,r.column=1):r.column++,n++;return G[e]=r,r}function Z(t,e){var n=q(t),r=q(e);return{start:{offset:t,line:n.line,column:n.column},end:{offset:e,line:r.line,column:r.column}}}function $(t){V<W||(V>W&&(W=V,H=[]),H.push(t))}function K(){var t,e,n,i,o;for(t=V,e=[],n=vt();n!==r;)e.push(n),n=vt();if(e!==r)if(n=function(){var t,e,n,i,o,s;if(t=V,e=J(),e!==r){for(n=[],i=V,o=[],s=vt();s!==r;)o.push(s),s=vt();for(o!==r&&(s=J())!==r?i=o=[o,s]:(V=i,i=r);i!==r;){for(n.push(i),i=V,o=[],s=vt();s!==r;)o.push(s),s=vt();o!==r&&(s=J())!==r?i=o=[o,s]:(V=i,i=r)}n!==r?t=e=a(e,n):(V=t,t=r)}else V=t,t=r;return t}(),n===r&&(n=null),n!==r){for(i=[],o=vt();o!==r;)i.push(o),o=vt();i!==r?(e=function(t){if(!t)return[];for(var e=[],n=0;n<t.length;n++)e=e.concat.apply(e,t[n]);var r=e[0];return r&&"m"==r.code&&(delete r.relative,r.code="M"),e}(n),t=e):(V=t,t=r)}else V=t,t=r;else V=t,t=r;return t}function J(){var e,n,i,o,c,l;if(e=V,n=function(){var e,n,i,o,a,c,l;e=V,s.test(t.charAt(V))?(n=t.charAt(V),V++):(n=r,$(u));if(n!==r){for(i=[],o=vt();o!==r;)i.push(o),o=vt();i!==r&&(o=at())!==r?(a=V,(c=lt())===r&&(c=null),c!==r&&(l=tt())!==r?a=c=[c,l]:(V=a,a=r),a===r&&(a=null),a!==r?(f=a,p=wt(h=n,[o]),f&&(p=p.concat(wt("M"==h?"L":"l",f[1]))),e=n=p):(V=e,e=r)):(V=e,e=r)}else V=e,e=r;var h,f,p;return e}(),n!==r){for(i=[],o=V,c=[],l=vt();l!==r;)c.push(l),l=vt();for(c!==r&&(l=Q())!==r?o=c=[c,l]:(V=o,o=r);o!==r;){for(i.push(o),o=V,c=[],l=vt();l!==r;)c.push(l),l=vt();c!==r&&(l=Q())!==r?o=c=[c,l]:(V=o,o=r)}i!==r?e=n=a(n,i):(V=e,e=r)}else V=e,e=r;return e}function Q(){var e;return(e=function(){var e,n;e=V,c.test(t.charAt(V))?(n=t.charAt(V),V++):(n=r,$(l));n!==r&&(n=wt("Z"));return e=n,e}())===r&&(e=function(){var e,n,i,o;e=V,h.test(t.charAt(V))?(n=t.charAt(V),V++):(n=r,$(f));if(n!==r){for(i=[],o=vt();o!==r;)i.push(o),o=vt();i!==r&&(o=tt())!==r?e=n=p(n,o):(V=e,e=r)}else V=e,e=r;return e}())===r&&(e=function(){var e,n,i,o;e=V,d.test(t.charAt(V))?(n=t.charAt(V),V++):(n=r,$(m));if(n!==r){for(i=[],o=vt();o!==r;)i.push(o),o=vt();i!==r&&(o=et())!==r?e=n=wt(n,o.map((function(t){return{x:t}}))):(V=e,e=r)}else V=e,e=r;return e}())===r&&(e=function(){var e,n,i,o;e=V,v.test(t.charAt(V))?(n=t.charAt(V),V++):(n=r,$(g));if(n!==r){for(i=[],o=vt();o!==r;)i.push(o),o=vt();i!==r&&(o=et())!==r?e=n=wt(n,o.map((function(t){return{y:t}}))):(V=e,e=r)}else V=e,e=r;return e}())===r&&(e=function(){var e,n,i,o;e=V,y.test(t.charAt(V))?(n=t.charAt(V),V++):(n=r,$(x));if(n!==r){for(i=[],o=vt();o!==r;)i.push(o),o=vt();i!==r?(o=function(){var t,e,n,i,o,s;if(t=V,e=nt(),e!==r){for(n=[],i=V,(o=lt())===r&&(o=null),o!==r&&(s=nt())!==r?i=o=[o,s]:(V=i,i=r);i!==r;)n.push(i),i=V,(o=lt())===r&&(o=null),o!==r&&(s=nt())!==r?i=o=[o,s]:(V=i,i=r);n!==r?t=e=a(e,n):(V=t,t=r)}else V=t,t=r;return t}(),o!==r?e=n=p(n,o):(V=e,e=r)):(V=e,e=r)}else V=e,e=r;return e}())===r&&(e=function(){var e,n,i,o;e=V,b.test(t.charAt(V))?(n=t.charAt(V),V++):(n=r,$(_));if(n!==r){for(i=[],o=vt();o!==r;)i.push(o),o=vt();i!==r?(o=function(){var t,e,n,i,o,s;if(t=V,e=rt(),e!==r){for(n=[],i=V,(o=lt())===r&&(o=null),o!==r&&(s=rt())!==r?i=o=[o,s]:(V=i,i=r);i!==r;)n.push(i),i=V,(o=lt())===r&&(o=null),o!==r&&(s=rt())!==r?i=o=[o,s]:(V=i,i=r);n!==r?t=e=a(e,n):(V=t,t=r)}else V=t,t=r;return t}(),o!==r?e=n=p(n,o):(V=e,e=r)):(V=e,e=r)}else V=e,e=r;return e}())===r&&(e=function(){var e,n,i,o;e=V,w.test(t.charAt(V))?(n=t.charAt(V),V++):(n=r,$(S));if(n!==r){for(i=[],o=vt();o!==r;)i.push(o),o=vt();i!==r?(o=function(){var t,e,n,i,o,s;if(t=V,e=it(),e!==r){for(n=[],i=V,(o=lt())===r&&(o=null),o!==r&&(s=it())!==r?i=o=[o,s]:(V=i,i=r);i!==r;)n.push(i),i=V,(o=lt())===r&&(o=null),o!==r&&(s=it())!==r?i=o=[o,s]:(V=i,i=r);n!==r?t=e=a(e,n):(V=t,t=r)}else V=t,t=r;return t}(),o!==r?e=n=p(n,o):(V=e,e=r)):(V=e,e=r)}else V=e,e=r;return e}())===r&&(e=function(){var e,n,i,o;e=V,M.test(t.charAt(V))?(n=t.charAt(V),V++):(n=r,$(E));if(n!==r){for(i=[],o=vt();o!==r;)i.push(o),o=vt();i!==r?(o=function(){var t,e,n,i,o,s;if(t=V,e=at(),e!==r){for(n=[],i=V,(o=lt())===r&&(o=null),o!==r&&(s=at())!==r?i=o=[o,s]:(V=i,i=r);i!==r;)n.push(i),i=V,(o=lt())===r&&(o=null),o!==r&&(s=at())!==r?i=o=[o,s]:(V=i,i=r);n!==r?t=e=a(e,n):(V=t,t=r)}else V=t,t=r;return t}(),o!==r?e=n=p(n,o):(V=e,e=r)):(V=e,e=r)}else V=e,e=r;return e}())===r&&(e=function(){var e,n,i,o;e=V,A.test(t.charAt(V))?(n=t.charAt(V),V++):(n=r,$(T));if(n!==r){for(i=[],o=vt();o!==r;)i.push(o),o=vt();i!==r?(o=function(){var t,e,n,i,o,s;if(t=V,e=ot(),e!==r){for(n=[],i=V,(o=lt())===r&&(o=null),o!==r&&(s=ot())!==r?i=o=[o,s]:(V=i,i=r);i!==r;)n.push(i),i=V,(o=lt())===r&&(o=null),o!==r&&(s=ot())!==r?i=o=[o,s]:(V=i,i=r);n!==r?t=e=a(e,n):(V=t,t=r)}else V=t,t=r;return t}(),o!==r?e=n=p(n,o):(V=e,e=r)):(V=e,e=r)}else V=e,e=r;return e}()),e}function tt(){var t,e,n,i,o,s;if(t=V,(e=at())!==r){for(n=[],i=V,(o=lt())===r&&(o=null),o!==r&&(s=at())!==r?i=o=[o,s]:(V=i,i=r);i!==r;)n.push(i),i=V,(o=lt())===r&&(o=null),o!==r&&(s=at())!==r?i=o=[o,s]:(V=i,i=r);n!==r?t=e=a(e,n):(V=t,t=r)}else V=t,t=r;return t}function et(){var t,e,n,i,o,s;if(t=V,(e=ut())!==r){for(n=[],i=V,(o=lt())===r&&(o=null),o!==r&&(s=ut())!==r?i=o=[o,s]:(V=i,i=r);i!==r;)n.push(i),i=V,(o=lt())===r&&(o=null),o!==r&&(s=ut())!==r?i=o=[o,s]:(V=i,i=r);n!==r?t=e=a(e,n):(V=t,t=r)}else V=t,t=r;return t}function nt(){var t,e,n,i,o,a,s,u,c;return t=V,(e=at())!==r?((n=lt())===r&&(n=null),n!==r&&(i=at())!==r?((o=lt())===r&&(o=null),o!==r&&(a=at())!==r?(u=i,c=a,t=e={x1:(s=e).x,y1:s.y,x2:u.x,y2:u.y,x:c.x,y:c.y}):(V=t,t=r)):(V=t,t=r)):(V=t,t=r),t}function rt(){var t,e,n,i,o,a;return t=V,(e=at())!==r?((n=lt())===r&&(n=null),n!==r&&(i=at())!==r?(a=i,t=e={x2:(o=e).x,y2:o.y,x:a.x,y:a.y}):(V=t,t=r)):(V=t,t=r),t}function it(){var t,e,n,i,o,a;return t=V,(e=at())!==r?((n=lt())===r&&(n=null),n!==r&&(i=at())!==r?(a=i,t=e={x1:(o=e).x,y1:o.y,x:a.x,y:a.y}):(V=t,t=r)):(V=t,t=r),t}function ot(){var t,e,n,i,o,a,s,u,c,l,h,f;return t=V,(e=st())!==r?((n=lt())===r&&(n=null),n!==r&&(i=st())!==r?((o=lt())===r&&(o=null),o!==r&&(a=ut())!==r&&lt()!==r&&(s=ct())!==r?((u=lt())===r&&(u=null),u!==r&&(c=ct())!==r?((l=lt())===r&&(l=null),l!==r&&(h=at())!==r?t=e={rx:e,ry:i,xAxisRotation:a,largeArc:s,sweep:c,x:(f=h).x,y:f.y}:(V=t,t=r)):(V=t,t=r)):(V=t,t=r)):(V=t,t=r)):(V=t,t=r),t}function at(){var t,e,n,i;return t=V,(e=ut())!==r?((n=lt())===r&&(n=null),n!==r&&(i=ut())!==r?t=e={x:e,y:i}:(V=t,t=r)):(V=t,t=r),t}function st(){var t;return V,(t=ft())===r&&(t=mt()),t!==r&&(t=1*t),t}function ut(){var t,e,n;return V,t=V,(e=dt())===r&&(e=null),e!==r&&(n=ft())!==r?t=e=[e,n]:(V=t,t=r),t===r&&(t=V,(e=dt())===r&&(e=null),e!==r&&(n=mt())!==r?t=e=[e,n]:(V=t,t=r)),t!==r&&(t=1*t.join("")),t}function ct(){var e;return V,C.test(t.charAt(V))?(e=t.charAt(V),V++):(e=r,$(O)),e!==r&&(e="1"==e),e}function lt(){var t,e,n,i,o;if(t=V,e=[],(n=vt())!==r)for(;n!==r;)e.push(n),n=vt();else e=r;if(e!==r)if((n=ht())===r&&(n=null),n!==r){for(i=[],o=vt();o!==r;)i.push(o),o=vt();i!==r?t=e=[e,n,i]:(V=t,t=r)}else V=t,t=r;else V=t,t=r;if(t===r){if(t=V,e=V,(n=ht())!==r){for(i=[],o=vt();o!==r;)i.push(o),o=vt();i!==r?e=n=[n,i]:(V=e,e=r)}else V=e,e=r;e!==r&&(e=""),t=e}return t}function ht(){var e;return 44===t.charCodeAt(V)?(e=",",V++):(e=r,$(k)),e}function ft(){var e,n,i;return V,e=V,n=function(){var e,n,i,o,a;e=V,n=V,i=mt(),i===r&&(i=null);i!==r?(46===t.charCodeAt(V)?(o=L,V++):(o=r,$(R)),o!==r&&(a=mt())!==r?n=i=[i,o,a]:(V=n,n=r)):(V=n,n=r);n===r&&(n=V,(i=mt())!==r?(46===t.charCodeAt(V)?(o=L,V++):(o=r,$(R)),o!==r?n=i=[i,o]:(V=n,n=r)):(V=n,n=r));n!==r&&(n=P(n));return e=n,e}(),n!==r?((i=pt())===r&&(i=null),i!==r?e=n=[n,i]:(V=e,e=r)):(V=e,e=r),e===r&&(e=V,(n=mt())!==r&&(i=pt())!==r?e=n=[n,i]:(V=e,e=r)),e!==r&&(e=P(e)),e}function pt(){var e,n,i,o;return V,e=V,I.test(t.charAt(V))?(n=t.charAt(V),V++):(n=r,$(N)),n!==r?((i=dt())===r&&(i=null),i!==r&&(o=mt())!==r?e=n=[n,i,o]:(V=e,e=r)):(V=e,e=r),e!==r&&(e=P(e)),e}function dt(){var e;return D.test(t.charAt(V))?(e=t.charAt(V),V++):(e=r,$(F)),e}function mt(){var e,n;if(V,e=[],j.test(t.charAt(V))?(n=t.charAt(V),V++):(n=r,$(B)),n!==r)for(;n!==r;)e.push(n),j.test(t.charAt(V))?(n=t.charAt(V),V++):(n=r,$(B));else e=r;return e!==r&&(e=e.join("")),e}function vt(){var e;return V,z.test(t.charAt(V))?(e=t.charAt(V),V++):(e=r,$(U)),e!==r&&(e=""),e}var gt,yt,xt,bt={m:"moveto",l:"lineto",h:"horizontal lineto",v:"vertical lineto",c:"curveto",s:"smooth curveto",q:"quadratic curveto",t:"smooth quadratic curveto",a:"elliptical arc",z:"closepath"};for(var _t in bt)bt[_t.toUpperCase()]=bt[_t];function wt(t,e){e||(e=[{}]);for(var n=e.length;n--;){var r={code:t,command:bt[t]};for(var i in t==t.toLowerCase()&&(r.relative=!0),e[n])r[i]=e[n][i];e[n]=r}return e}if((n=o())!==r&&V===t.length)return n;throw n!==r&&V<t.length&&$({type:"end"}),gt=H,yt=W<t.length?t.charAt(W):null,xt=W<t.length?Z(W,W+1):Z(W,W),new KO(KO.buildMessage(gt,yt),gt,yt,xt)},tk=QO;tk.parseSVG=tk,tk.makeAbsolute=function(t){var e,n={x:0,y:0},r={x:"x0",y:"y0",x1:"x0",y1:"y0",x2:"x0",y2:"y0"};return t.forEach((function(t){for(var i in"moveto"===t.command&&(e=t),t.x0=n.x,t.y0=n.y,r)i in t&&(t[i]+=t.relative?t[r[i]]:0);"x"in t||(t.x=n.x),"y"in t||(t.y=n.y),t.relative=!1,t.code=t.code.toUpperCase(),"closepath"==t.command&&(t.x=e.x,t.y=e.y),n=t})),t};var ek=hu((function(t,e){void 0===e&&(e={});var n=e.fontSize,r=e.fontFamily,i=e.fontWeight,o=e.fontStyle,a=e.fontVariant;return JO||(JO=document.createElement("canvas").getContext("2d")),JO.font=[o,a,i,"".concat(n,"px"),r].join(" "),JO.measureText($s(t)?t:"").width}),(function(t,e){return void 0===e&&(e={}),ts([t],Qa(ru(e)),!1).join("")})),nk=function(t,e,n,r){void 0===r&&(r="...");var i,o,a=ek(r,n);i=$s(t)?t:zs(o=t)?"":o.toString();var s,u,c=e,l=[];if(ek(t,n)<=e)return t;for(;s=i.substr(0,16),!((u=ek(s,n))+a>c);)if(l.push(s),c-=u,!(i=i.substr(16)))return l.join("");for(;s=i.substr(0,1),!((u=ek(s,n))+a>c);)if(l.push(s),c-=u,!(i=i.substr(1)))return l.join("");return"".concat(l.join("")).concat(r)};function rk(t,e){return"string"==typeof t?ek(t,e):t}function ik(t,e){return"capitalize"===e?t.toLowerCase().replace(/( |^)[a-z]/g,(function(t){return t.toUpperCase()})):"lowercase"===e?t.toLowerCase():"uppercase"===e?t.toUpperCase():t}function ok(t,e){var n=Math.pow(10,e);return~~(t*n)/n}function ak(t){if(Js(t))return[t,t,t,t];if(Gs(t)){var e=t.length;if(1===e)return[t[0],t[0],t[0],t[0]];if(2===e)return[t[0],t[1],t[0],t[1]];if(3===e)return[t[0],t[1],t[2],t[1]];if(4===e)return t}return[0,0,0,0]}var sk=["default","active","selected","disabled","inactive"],uk={fontSize:"16px",fontFamily:"sans-serif",fontWeight:"normal",fontVariant:"normal",fontStyle:"normal",textAlign:"start",textBaseline:"alphabetic"};function ck(t){if(t)return null==t?void 0:t.default;var e=lu(t)||{};return sk.forEach((function(t){t in e&&delete e[t]})),e}function lk(t,e,n){if(void 0===n&&(n=!1),!e){var r=ck(t);return r||{}}var i=vu(t,e);return n?pu({},ck(t),i):i}function hk(t,e,n){void 0===n&&(n=!1);return Object.keys(t).reduce((function(r,i){var o;return o=i,new RegExp("^".concat(e,"[A-Z].*")).test(o)!==n&&(n?r[i]=t[i]:r[function(t){return t.charAt(0).toLowerCase()+t.slice(1)}(i.slice(e.length))]=t[i]),r}),{})}function fk(t,e){var n=t,r=Object.keys(t).reduce((function(t,r,i){if(i>=e.length)return t;var o=e[i];return t.push(hk(n,o)),n=hk(n,o,!0),t}),[]);return r.push(n),r}function pk(t,e){return Object.keys(t).reduce((function(n,r){var i;return n["".concat(e).concat((i=r,i.charAt(0).toUpperCase()+i.slice(1)))]=t[r],n}),{})}function dk(t,e){void 0===e&&(e=["x","y","class"]);var n=["transform","transformOrigin","anchor","visibility","pointerEvents","zIndex","cursor","clipPath","clipPathTargets","offsetPath","offsetPathTargets","offsetDistance","draggable","droppable"],r={},i={};return Object.entries(t).forEach((function(t){var o=Qa(t,2),a=o[0],s=o[1];e.includes(a)||(-1!==n.indexOf(a)?i[a]=s:r[a]=s)})),[r,i]}function mk(t){var e=t.canvas,n=t.touches,r=t.offsetX,i=t.offsetY;if(e)return[e.x,e.y];if(n){var o=n[0];return[o.clientX,o.clientY]}return r&&i?[r,i]:[0,0]}var vk=function(){function t(t,n,r,i,o,a,s){void 0===t&&(t=null),void 0===n&&(n=null),void 0===r&&(r=null),void 0===i&&(i=null),void 0===o&&(o=[null,null,null,null,null]),void 0===a&&(a=[]),void 0===s&&(s=[]),e.add(this),this._elements=Array.from(t),this._data=n,this._parent=r,this._document=i,this._enter=o[0],this._update=o[1],this._exit=o[2],this._merge=o[3],this._split=o[4],this._transitions=a,this._facetElements=s}var e,n;return t.prototype.selectAll=function(e){return new t("string"==typeof e?this._parent.querySelectorAll(e):e,null,this._elements[0],this._document)},t.prototype.selectFacetAll=function(e){var n="string"==typeof e?this._parent.querySelectorAll(e):e;return new t(this._elements,null,this._parent,this._document,void 0,void 0,n)},t.prototype.select=function(e){var n="string"==typeof e?this._parent.querySelectorAll(e)[0]||null:e;return new t([n],null,n,this._document)},t.prototype.append=function(e){var n=this,r="function"==typeof e?e:function(){return n.createElement(e)},i=[];if(null!==this._data){for(var o=0;o<this._data.length;o++){var a=this._data[o],s=Qa(Array.isArray(a)?a:[a,null],2),u=s[0],c=s[1];(h=r(u,o)).__data__=u,null!==c&&(h.__fromElements__=c),this._parent.appendChild(h),i.push(h)}return new t(i,null,this._parent,this._document)}for(o=0;o<this._elements.length;o++){var l=this._elements[o],h=r(u=l.__data__,o);l.appendChild(h),i.push(h)}return new t(i,null,i[0],this._document)},t.prototype.maybeAppend=function(t,r){var i=es(this,e,"m",n).call(this,t.startsWith("#")?t:"#".concat(t),r);return i.attr("id",t),i},t.prototype.maybeAppendByClassName=function(t,r){var i=t.toString(),o=es(this,e,"m",n).call(this,i.startsWith(".")?i:".".concat(i),r);return o.attr("className",i),o},t.prototype.maybeAppendByName=function(t,r){var i=es(this,e,"m",n).call(this,'[name="'.concat(t,'"]'),r);return i.attr("name",t),i},t.prototype.data=function(e,n,r){var i,o;void 0===n&&(n=function(t){return t}),void 0===r&&(r=function(){return null});for(var a=[],s=[],u=new Set(this._elements),c=[],l=new Set,h=new Map(this._elements.map((function(t,e){return[n(t.__data__,e),t]}))),f=new Map(this._facetElements.map((function(t,e){return[n(t.__data__,e),t]}))),p=e_(this._elements,(function(t){return r(t.__data__)})),d=0;d<e.length;d++){var m=e[d],v=n(m,d),g=r(m,d);if(h.has(v))(_=h.get(v)).__data__=m,_.__facet__=!1,s.push(_),u.delete(_),h.delete(v);else if(f.has(v)){(_=f.get(v)).__data__=m,_.__facet__=!0,s.push(_),f.delete(v)}else if(p.has(v)){var y=p.get(v);c.push([m,y]);try{for(var x=(i=void 0,Ja(y)),b=x.next();!b.done;b=x.next()){var _=b.value;u.delete(_)}}catch(S){i={error:S}}finally{try{b&&!b.done&&(o=x.return)&&o.call(x)}finally{if(i)throw i.error}}p.delete(v)}else if(h.has(g)){(_=h.get(g)).__toData__?_.__toData__.push(m):_.__toData__=[m],l.add(_),u.delete(_)}else a.push(m)}var w=[new t([],a,this._parent,this._document),new t(s,null,this._parent,this._document),new t(u,null,this._parent,this._document),new t([],c,this._parent,this._document),new t(l,null,this._parent,this._document)];return new t(this._elements,null,this._parent,this._document,w)},t.prototype.merge=function(e){var n=ts(ts([],Qa(this._elements),!1),Qa(e._elements),!1),r=ts(ts([],Qa(this._transitions),!1),Qa(e._transitions),!1);return new t(n,null,this._parent,this._document,void 0,r)},t.prototype.createElement=function(e){if(this._document)return this._document.createElement(e,{});var n=t.registry[e];return n?new n:function(t){throw new Error(t)}("Unknown node type: ".concat(e))},t.prototype.join=function(t,e,n,r,i){void 0===t&&(t=function(t){return t}),void 0===e&&(e=function(t){return t}),void 0===n&&(n=function(t){return t.remove()}),void 0===r&&(r=function(t){return t}),void 0===i&&(i=function(t){return t.remove()});var o=t(this._enter),a=e(this._update),s=n(this._exit),u=r(this._merge),c=i(this._split);return a.merge(o).merge(s).merge(u).merge(c)},t.prototype.remove=function(){for(var e=function(t){var e=n._elements[t],r=n._transitions[t];r?r.then((function(){return e.remove()})):e.remove()},n=this,r=0;r<this._elements.length;r++)e(r);return new t([],null,this._parent,this._document,void 0,this._transitions)},t.prototype.each=function(t){for(var e=0;e<this._elements.length;e++){var n=this._elements[e],r=n.__data__;t.call(n,r,e)}return this},t.prototype.attr=function(t,e){var n="function"!=typeof e?function(){return e}:e;return this.each((function(r,i){void 0!==e&&(this[t]=n.call(this,r,i))}))},t.prototype.style=function(t,e){var n="function"!=typeof e?function(){return e}:e;return this.each((function(r,i){void 0!==e&&(this.style[t]=n.call(this,r,i))}))},t.prototype.styles=function(t){return this.each((function(e,n){var r=this,i=Object.entries(t).reduce((function(t,i){var o=Qa(i,2),a=o[0],s=o[1],u="function"!=typeof s?function(){return s}:s;return void 0!==s&&(t[a]=u.call(r,e,n)),t}),{});this.attr(i)}))},t.prototype.update=function(t){var e="function"!=typeof t?function(){return t}:t;return this.each((function(n,r){t&&this.update&&this.update(e.call(this,n,r))}))},t.prototype.transition=function(t){var e="function"!=typeof t?function(){return t}:t,n=this._transitions;return this.each((function(t,r){n[r]=e.call(this,t,r)}))},t.prototype.on=function(t,e){return this.each((function(){this.addEventListener(t,e)})),this},t.prototype.call=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return t.call.apply(t,ts([this._parent,this],Qa(e),!1)),this},t.prototype.node=function(){return this._elements[0]},t.prototype.nodes=function(){return this._elements},t.prototype.transitions=function(){return this._transitions},t.prototype.parent=function(){return this._parent},e=new WeakSet,n=function(e,n){var r=this._elements[0],i=r.querySelector(e);if(i)return new t([i],null,this._parent,this._document);var o="string"==typeof n?this.createElement(n):n();return r.appendChild(o),new t([o],null,this._parent,this._document)},t.registry={g:Kf,rect:hp,circle:Vf,path:op,text:pp,ellipse:Zf,image:ep,line:rp,polygon:sp,polyline:cp,html:Qf},t}();function gk(t){return new vk([t],null,t,t.ownerDocument)}function yk(t,e,n){return t.querySelector(e)?gk(t).select(e):gk(t).append(n)}function xk(t){var e=t&&t.getRenderBounds();if(!e)return{width:0,height:0};var n=e.getMax(),r=e.getMin();return{width:n[0]-r[0],height:n[1]-r[1]}}function bk(t){var e=t.getLocalBounds(),n=Qa([e.min,e.max],2),r=Qa(n[0],2),i=r[0],o=r[1],a=Qa(n[1],2),s=a[0],u=a[1];return{x:i,y:o,width:s-i,height:u-o,left:i,bottom:u,top:o,right:s}}function _k(t,e){var n=Qa(t,2),r=n[0],i=n[1],o=Qa(e,2),a=o[0]-r,s=o[1]-i;return Math.sqrt(a*a+s*s)}function wk(t,e){var n=Qa(t,2),r=n[0],i=n[1],o=Qa(e,2),a=o[0],s=o[1];return r!==a&&i===s}function Sk(t){return"string"==typeof t?(e=t,(n=document.createElement("div")).innerHTML=e,n.firstChild):t;var e,n}var Mk=function(t,e,n,r){void 0===n&&(n=0),void 0===r&&(r=5),Object.entries(e).forEach((function(i){var o=Qa(i,2),a=o[0],s=o[1],u=t;Object.prototype.hasOwnProperty.call(e,a)&&(s?Xs(s)?(Xs(t[a])||(u[a]={}),n<r?Mk(t[a],s,n+1,r):u[a]=e[a]):Gs(s)?(u[a]=[],u[a]=u[a].concat(s)):u[a]=s:u[a]=s)}))},Ek=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0;r<e.length;r+=1)Mk(t,e[r]);return t};function Ak(t,e,n,r,i,o){return(t===e||Math.min(t,e)<=i&&i<=Math.max(t,e))&&(n===r||Math.min(n,r)<=o&&o<=Math.max(n,r))}function Tk(t,e,n){var r=t;(!t.length||e<t[0]||e===t[0]&&n<t[1])&&(r[0]=e,r[1]=n)}function Ck(t,e,n,r){var i=Qa(t,2),o=i[0],a=i[1],s=Qa(e,2),u=s[0],c=s[1],l=Qa(n,2),h=l[0],f=l[1],p=Qa(r,2),d=p[0],m=p[1],v=[];if((m-f)*(u-o)==(c-a)*(d-h))(c-a)*(h-o)==(f-a)*(u-o)&&(Ak(o,u,a,c,h,f)&&Tk(v,h,f),Ak(o,u,a,c,d,m)&&Tk(v,d,m),Ak(h,d,f,m,o,a)&&Tk(v,o,a),Ak(h,d,f,m,u,c)&&Tk(v,u,c));else{var g=(h*(m-f)+a*(d-h)-f*(d-h)-o*(m-f))/((u-o)*(m-f)-(d-h)*(c-a)),y=(o*(c-a)+f*(u-o)-a*(u-o)-h*(c-a))/((d-h)*(c-a)-(u-o)*(m-f));g>=0&&g<=1&&y>=0&&y<=1&&(v[0]=o+g*(u-o),v[1]=a+g*(c-a))}return v}function Ok(t,e){var n=Qa(t,2),r=n[0],i=n[1],o=Qa(e,2),a=o[0],s=o[1];return Math.pow(Math.pow(r-a,2)+Math.pow(i-s,2),.5)}function kk(t){return void 0===t&&(t=0),function(e,n,r){var i,o=r.value;"function"==typeof o&&(r.value=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(!i){var r=this;i=window.setTimeout((function(){o.apply(r,e),i=null}),t)}})}}function Pk(t){return $s(t)||Js(t)?new pp({style:{text:String(t)}}):t}function Lk(t){return t*Math.PI/180}function Rk(t){return Number((180*t/Math.PI).toPrecision(5))}function Ik(t,e){var n,r=(t instanceof zf?t:t.node()).computedStyleMap().get("transform");if(r&&"unset"!==r.value)return null===(n=null==r?void 0:r.find((function(t){return t.t===e})))||void 0===n?void 0:n.d.map((function(t){return t.value}))}function Nk(t,e){if(e)try{var n=t instanceof zf?t:t.node(),r=e.replace(/translate\(([+-]*[\d]+[%]*),[ ]*([+-]*[\d]+[%]*)\)/g,(function(t,e,r){return"translate(".concat(function(t,e,n){var r=(t instanceof zf?t:t.node()).getBBox(),i=r.width,o=r.height,a=Qa([e,n].map((function(t,e){var n;return t.includes("%")?parseFloat((null===(n=t.match(/[+-]?([0-9]*[.])?[0-9]+/))||void 0===n?void 0:n[0])||"0")/100*(0===e?i:o):t})),2);return[a[0],a[1]]}(n,e,r),")")}));n.attr("transform",r)}catch(i){}}function Dk(t,e,n,r,i){return void 0===r&&(r=!0),!!(r&&t===e||i&&t===n)||t>e&&t<n}function Fk(t,e){return Bs(t)?t.apply(void 0,ts([],Qa(e),!1)):t}function jk(t,e,n,r,i){void 0===r&&(r=!0),void 0===i&&(i=function(t){t instanceof vk?t.node().removeChildren():t instanceof zf?t.removeChildren():t instanceof HTMLElement&&(t.innerHTML="")}),t?n(e):r&&i(e)}function Bk(t,e){return function(n){function r(r){var i=n.call(this,Ek({},{style:e},r))||this;return i.descriptor=t,i}return qa(r,n),r.prototype.connectedCallback=function(){var t,e,n,r;null===(e=(t=this.descriptor).render)||void 0===e||e.call(t,this.attributes,this),null===(r=(n=this.descriptor).bindEvents)||void 0===r||r.call(n,this.attributes,this)},r.prototype.update=function(t){var e,n;void 0===t&&(t={}),this.attr(pu({},this.attributes,t)),null===(n=(e=this.descriptor).render)||void 0===n||n.call(e,this.attributes,this)},r.prototype.attributeChangedCallback=function(){var t,e;null===(e=null===(t=this.descriptor)||void 0===t?void 0:t.render)||void 0===e||e.call(t,this.attributes,this)},r}(Wf)}!function(t){function e(){return null!==t&&t.apply(this,arguments)||this}qa(e,t)}(Wf);var zk=function(t,e){var n=function(t){return"".concat(e,"-").concat(t)},r=Object.fromEntries(Object.entries(t).map((function(t){var e=Qa(t,2),r=e[0],i=e[1],o=n(i);return[r,{name:o,class:".".concat(o),id:"#".concat(o),toString:function(){return o}}]})));return Object.assign(r,{prefix:n}),r};function Uk(t){var e=Za({},t),n=new RegExp(/^(f|[\S]+F)(ilter|iltrate)$/),r={},i={iltrate:"ilter",ilter:"iltrate"};return Object.entries(t).forEach((function(t){var e=Qa(t,2),i=e[0],o=e[1];n.test(i)&&(r[i]=o)})),Object.keys(r).forEach((function(t){delete e[t]})),Object.keys(r).forEach((function(t){var o;if(t.endsWith("iltrate")&&"function"!=typeof r[t]||t.endsWith("ilter")&&"function"==typeof r[t]){var a=t.replace(n,(function(t,e,n){return"".concat(e).concat(i[n])}));Object.assign(e,((o={})[a]=r[t],o))}})),e}function Vk(t,e,n){void 0===n&&(n="...");var r=t instanceof pp?t:t.node();if("text"===r.nodeName){var i={wordWrap:!0,wordWrapWidth:e,maxLines:1,textOverflow:n};r.attr(i)}}function Gk(t,e,n){void 0===n&&(n=!1);var r=t.getBBox(),i=r.width,o=r.height,a=e/Math.max(i,o);return n&&t.scale(a),a}function Wk(t,e,n,r,i){var o;void 0===n&&(n={}),void 0===r&&(r=!0),void 0===i&&(i=50);var a={},s={},u=["x","y","width","height","opacity","radius"];Object.entries(e).forEach((function(e){var n=Qa(e,2),r=n[0],o=n[1],c=t.attr(r);u.includes(r)&&!zs(o)&&!zs(c)&&c!==o&&Math.abs(+c-+o)>=i&&(a[r]=c,s[r]=o)}));var c=function(){return"update"in t?t.update(e):t.attr(e),Promise.resolve()};return r?Object.keys(a).length>0&&(null===(o=t.animate([a,s],Za({fill:"both"},n)))||void 0===o?void 0:o.finished.then(c))||Promise.resolve():c()}var Hk=function(t){function e(e){return t.call(this,e)||this}return qa(e,t),e.prototype.connectedCallback=function(){this.render(this.attributes,this),this.bindEvents(this.attributes,this)},e.prototype.update=function(t){var e;void 0===t&&(t={}),this.attr(Ek({},this.attributes,t)),null===(e=this.render)||void 0===e||e.call(this,this.attributes,this)},e.prototype.clear=function(){this.removeChildren()},e.prototype.destroy=function(){this.removeAllEventListeners(),this.removeChildren(),this.remove()},e.prototype.attributeChangedCallback=function(){},e.prototype.bindEvents=function(t,e){},e}(Wf);var Yk=function(t,e,n){return[["M",t-n,e],["A",n,n,0,1,0,t+n,e],["A",n,n,0,1,0,t-n,e],["Z"]]},Xk=Yk,qk=function(t,e,n){return[["M",t,e+n],["L",t,e-n]]},Zk=function(t,e,n){return[["M",t-n,e],["L",t+n,e]]},$k=Zk;function Kk(t){var e=function(t){var e="default";if(Ws(t)&&t instanceof Image)e="image";else if(Bs(t))e="symbol";else if($s(t)){var n=new RegExp("data:(image|text)");e=t.match(n)?"base64":/^(https?:\/\/(([a-zA-Z0-9]+-?)+[a-zA-Z0-9]+\.)+[a-zA-Z]+)(:\d+)?(\/.*)?(\?.*)?(#.*)?$/.test(t)?"url":"symbol"}return e}(t);return["base64","url","image"].includes(e)?"image":t&&"symbol"===e?"path":null}var Jk=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return qa(e,t),e.prototype.render=function(t,n){var r=t,i=r.x,o=r.y,a=r.symbol,s=r.size,u=void 0===s?16:s,c=$a(r,["x","y","symbol","size"]),l=Kk(a);if(!l){var h=this.querySelector(".marker");return null==h||h.remove(),void this.removeChildren()}yk(n,".".concat(l,"-marker"),l).attr("className","marker ".concat(l,"-marker")).call((function(t){if("image"===l){var n=2*u;t.styles({img:a,width:n,height:n,x:-u,y:-u})}else{n=u/2;var r=Bs(a)?a:e.getSymbol(a);t.styles(Za({path:null==r?void 0:r(i,o,n)},c))}}))},e.MARKER_SYMBOL_MAP=new Map,e.registerSymbol=function(t,n){e.MARKER_SYMBOL_MAP.set(t,n)},e.getSymbol=function(t){return e.MARKER_SYMBOL_MAP.get(t)},e}(Hk);Jk.registerSymbol("cross",(function(t,e,n){return[["M",t-n,e-n],["L",t+n,e+n],["M",t+n,e-n],["L",t-n,e+n]]})),Jk.registerSymbol("hyphen",(function(t,e,n){return[["M",t-n,e],["L",t+n,e]]})),Jk.registerSymbol("line",qk),Jk.registerSymbol("plus",(function(t,e,n){return[["M",t-n,e],["L",t+n,e],["M",t,e-n],["L",t,e+n]]})),Jk.registerSymbol("tick",(function(t,e,n){return[["M",t-n/2,e-n],["L",t+n/2,e-n],["M",t,e-n],["L",t,e+n],["M",t-n/2,e+n],["L",t+n/2,e+n]]})),Jk.registerSymbol("circle",Yk),Jk.registerSymbol("point",Xk),Jk.registerSymbol("bowtie",(function(t,e,n){var r=n-1.5;return[["M",t-n,e-r],["L",t+n,e+r],["L",t+n,e-r],["L",t-n,e+r],["Z"]]})),Jk.registerSymbol("hexagon",(function(t,e,n){var r=n/2*Math.sqrt(3);return[["M",t,e-n],["L",t+r,e-n/2],["L",t+r,e+n/2],["L",t,e+n],["L",t-r,e+n/2],["L",t-r,e-n/2],["Z"]]})),Jk.registerSymbol("square",(function(t,e,n){return[["M",t-n,e-n],["L",t+n,e-n],["L",t+n,e+n],["L",t-n,e+n],["Z"]]})),Jk.registerSymbol("diamond",(function(t,e,n){return[["M",t-n,e],["L",t,e-n],["L",t+n,e],["L",t,e+n],["Z"]]})),Jk.registerSymbol("triangle",(function(t,e,n){var r=n*Math.sin(1/3*Math.PI);return[["M",t-n,e+r],["L",t,e-r],["L",t+n,e+r],["Z"]]})),Jk.registerSymbol("triangle-down",(function(t,e,n){var r=n*Math.sin(1/3*Math.PI);return[["M",t-n,e-r],["L",t+n,e-r],["L",t,e+r],["Z"]]})),Jk.registerSymbol("line",qk),Jk.registerSymbol("dot",Zk),Jk.registerSymbol("dash",$k),Jk.registerSymbol("smooth",(function(t,e,n){return[["M",t-n,e],["A",n/2,n/2,0,1,1,t,e],["A",n/2,n/2,0,1,0,t+n,e]]})),Jk.registerSymbol("hv",(function(t,e,n){return[["M",t-n-1,e-2.5],["L",t,e-2.5],["L",t,e+2.5],["L",t+n+1,e+2.5]]})),Jk.registerSymbol("vh",(function(t,e,n){return[["M",t-n-1,e+2.5],["L",t,e+2.5],["L",t,e-2.5],["L",t+n+1,e-2.5]]})),Jk.registerSymbol("hvh",(function(t,e,n){return[["M",t-(n+1),e+2.5],["L",t-n/2,e+2.5],["L",t-n/2,e-2.5],["L",t+n/2,e-2.5],["L",t+n/2,e+2.5],["L",t+n+1,e+2.5]]})),Jk.registerSymbol("vhv",(function(t,e){return[["M",t-5,e+2.5],["L",t-5,e],["L",t,e],["L",t,e-3],["L",t,e+3],["L",t+6.5,e+3]]}));var Qk=function(t){function e(n){return t.call(this,pu({},e.defaultOptions,n))||this}return qa(e,t),e.prototype.render=function(t,e){var n=t.padding,r=void 0===n?0:n,i=t.marker,o=t.text,a=t.textStyle,s=t.radius,u=t.backgroundStyle,c=t.spacing,l=t.align,h=t.verticalAlign,f=Qa(ak(r),4),p=f[0],d=f[1],m=f[2],v=f[3],g=yk(e,".tag-content","g").attr("className","tag-content").node(),y=function(t,e){var n=t.getLocalBounds();return{x:n.halfExtents[0]?n.max[0]+(e||0):t.style.x,y:n.halfExtents[1]?(n.min[1]+n.max[1])/2:t.style.y}}(yk(g,".tag-marker",(function(){return new Jk({})})).attr("className","tag-marker").call((function(t){t.node().clear(),t.node().update(i||{symbol:"triangle",size:0,x:0})})).node(),c),x=y.x,b=y.y;gk(g).maybeAppendByClassName("tag-text","text").styles(Za(Za({fontFamily:"sans-serif",fontSize:12,text:zs(o)?"":"".concat(o),x:x,y:b},a),{textBaseline:"middle"})).call((function(t){o||t.remove()})),function(t,e,n,r,i){var o=t.getLocalBounds(),a=0,s=0;"start"===r&&(a=e),"center"===r&&(a=-o.halfExtents[0]),"end"===r&&(a=-e-2*o.halfExtents[0]),"top"===i&&(s=n+o.halfExtents[1]),"middle"===i&&(s=0),"bottom"===i&&(s=n-2*o.halfExtents[1]),t.setLocalPosition([a,s])}(g,v,p,l||"start",h||"top");var _=g.getLocalBounds();gk(e).maybeAppendByClassName("tag-background","rect").styles(Za({zIndex:(g.style.zIndex||0)-1,y:_.min[1]-p,x:_.min[0]-v,width:null!==u?v+d+2*_.halfExtents[0]:0,height:null!==u?p+m+2*_.halfExtents[1]:0,radius:null!=s?s:2,fill:"#fafafa",stroke:"#d9d9d9",lineWidth:1},u))},e.tag="tag",e.defaultOptions={style:{padding:4,spacing:4}},e}(Hk),tP={small:{textStyle:{fontSize:10},buttonStyle:{width:40,height:20},markerStyle:{size:8}},middle:{textStyle:{fontSize:12},buttonStyle:{width:60,height:30},markerStyle:{size:12}},large:{textStyle:{fontSize:16},buttonStyle:{width:80,height:40},markerStyle:{size:16}}},eP={primary:{textStyle:{default:{fill:"#fff"},active:{}},buttonStyle:{default:{fill:"#1890ff",lineWidth:0},active:{fill:"#40a9ff"}},markerStyle:{default:{fill:"#1890ff"},active:{fill:"#40a9ff"}}},dashed:{textStyle:{default:{},active:{}},buttonStyle:{default:{fill:"transparent",stroke:"#bbb",lineDash:[5,5]},active:{}},markerStyle:{}},link:{textStyle:{default:{fill:"#1890ff"},active:{}},buttonStyle:{default:{fill:"transparent",lineWidth:0},active:{}},markerStyle:{default:{fill:"#1890ff"}}},text:{textStyle:{default:{fill:"#000"},active:{}},buttonStyle:{default:{fill:"transparent",lineWidth:0},active:{}},markerStyle:{default:{stroke:"#000"}}},default:{textStyle:{default:{fill:"#000"},active:{fill:"#1890ff"}},buttonStyle:{default:{fill:"transparent",stroke:"#bbb"},active:{stroke:"#1890ff"}},markerStyle:{default:{stroke:"#bbb",lineWidth:1},active:{stroke:"#1890ff"}}}},nP={strict:{textStyle:{fill:"#b8b8b8"},buttonStyle:{},markerStyle:{}},textStyle:{},buttonStyle:{stroke:"#d9d9d9",fill:"#f5f5f5"},markerStyle:{stroke:"#d9d9d9"}};!function(t){function e(n){var r=t.call(this,Ek({},e.defaultOptions,n))||this;return r.state="default",r.clickEvents=function(){var t=r.attributes,e=t.onClick;"disabled"!==t.state&&(null==e||e.call(r,r))},r.mouseenterEvent=function(){"disabled"!==r.attributes.state&&(r.state="active",r.render(r.attributes,r))},r.mouseleaveEvent=function(){var t=r.attributes.state,e=void 0===t?"default":t;r.state=e,r.render(r.attributes,r)},r}qa(e,t),Object.defineProperty(e.prototype,"markerSize",{get:function(){var t=this.attributes.marker,e=this.getStyle("markerStyle");return t?(null==e?void 0:e.size)||2:0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){var t=this.attributes.text;if(""===t)return t;var e=this.textAvailableWidth;return nk(t,e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textAvailableWidth",{get:function(){var t=this.attributes,e=t.marker,n=t.padding,r=t.ellipsis,i=t.width,o=t.markerSpacing;if(!r)return 1/0;var a=ou(i)?this.getStyle("buttonStyle").width:i;return e?a-2*n-o-this.markerSize:a-2*n},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"buttonHeight",{get:function(){var t=this.attributes.height;return t||this.getStyle("buttonStyle").height},enumerable:!1,configurable:!0}),e.prototype.getStyle=function(t){var e=this.attributes,n=e.size,r=e.type,i=this.state,o=pu({},vu(tP,[n,t]),lk(vu(eP,[r,t]),i),lk(vu(this.attributes,t),i,!0));return"disabled"===i&&(Object.keys(o).forEach((function(e){e in nP[t]&&(o[e]=vu(nP,[t,e]))})),Object.keys(nP.strict[t]).forEach((function(e){o[e]=vu(nP,["strict",t,e])})),pu(o,lk(vu(this.attributes,t),"disabled"))),o},e.prototype.render=function(t,e){var n=t.padding,r=void 0===n?0:n,i=t.marker,o=t.markerSpacing,a=void 0===o?0:o;e.attr("cursor","disabled"===this.state?"not-allowed":"pointer");var s=Qa(ak(r),4);s[0];var u=s[1];s[2];var c=s[3],l=this.buttonHeight,h=this.getStyle("markerStyle"),f=this.markerSize,p=yk(e,".marker",(function(){return new Jk({className:"marker",style:{symbol:"circle"}})})).call((function(t){t.node().update(Za(Za({},h),{symbol:i,x:c+f/2,y:l/2,size:f}))})).node().getLocalBounds(),d=this.text,m=void 0===d?"":d,v=this.getStyle("textStyle");this.textShape=yk(e,".text","text").attr("className","text").styles(Za({x:f?p.max[0]+a:c,y:l/2,text:m,textAlign:"left",textBaseline:"middle"},v)).node();var g=this.textShape.getLocalBounds(),y=this.getStyle("buttonStyle");gk(e).maybeAppendByClassName(".background","rect").styles(Za(Za({zIndex:-1},y),{height:l,width:c+(f?f+a:0)+2*g.halfExtents[0]+u}))},e.prototype.update=function(t){void 0===t&&(t={}),this.attr(pu({},this.attributes,t));var e=this.attributes.state,n=void 0===e?"default":e;this.state=n,this.render(this.attributes,this)},e.prototype.setState=function(t){this.update({state:t})},e.prototype.hide=function(){this.style.visibility="hidden"},e.prototype.show=function(){this.style.visibility="visible"},e.prototype.bindEvents=function(){this.addEventListener("click",this.clickEvents),this.addEventListener("mouseenter",this.mouseenterEvent),this.addEventListener("mouseleave",this.mouseleaveEvent)},e.tag="button",e.defaultOptions={style:{cursor:"pointer",padding:10,size:"middle",type:"default",text:"",markerAlign:"left",markerSpacing:5,textStyle:{default:{},active:{}},buttonStyle:{default:{lineWidth:1,radius:5},active:{}},markerStyle:{default:{}}}}}(Hk),function(t){function e(n){return t.call(this,pu({},e.defaultOptions,n))||this}qa(e,t),e.prototype.render=function(t,n){var r=t.x,i=t.y,o=t.items,a=t.textStyle,s=t.padding,u=void 0===s?0:s,c=t.width,l=t.separator,h=Qa(ak(u),3),f=h[0],p=h[1],d=h[2],m=yk(n,".container","g").styles({className:"container",x:r+d,y:i+f}),v=0,g=0;m.node().removeChildren();for(var y=function(t){var n=o[t],r=new Qk({className:"breadcrumb-item",style:Za(Za({x:v,y:g,text:zs(n.text)?n.id:n.text,textStyle:a},yu(n,["marker"])),{padding:0,backgroundStyle:null})});m.append((function(){return r}));var i=r.getLocalBounds(),s=2*i.halfExtents[0],u=2*i.halfExtents[1];(v+=s,zs(c))||v>c-p&&(r.attr({x:0,y:g+u}),v=s,g+=u);x.bindInnerEvents(r,n);var h=l||{},f=h.spacing,d=void 0===f?0:f,y=h.text,b=void 0===y?"/":y,_=h.style;if(t!==o.length-1){var w=new pp({className:"".concat(e.tag,"-separator"),id:"".concat(e.tag,"-separator-").concat(t),style:Za(Za(Za(Za({},uk),{x:v+d,y:g+u/2}),_),{text:b,textAlign:"end",textBaseline:"middle"})});m.append((function(){return w}));var S=w.getLocalBounds();v+=2*S.halfExtents[0]+d}},x=this,b=0;b<o.length;b++)y(b)},e.prototype.update=function(t){this.attr(pu({},this.attributes,t)),this.render(this.attributes,this)},e.prototype.bindInnerEvents=function(t,e){var n=this.attributes,r=n.items,i=n.onClick;i&&t.addEventListener("click",(function(){i.call(t,e.id,e,r)}))},e.tag="breadcrumb",e.defaultOptions={style:{separator:{text:"/",style:{fontSize:14,fill:"rgba(0, 0, 0, 0.45)"},spacing:8},textStyle:{default:Za(Za({},uk),{fontSize:14,fill:"rgba(0, 0, 0, 0.45)"}),active:{fill:"#5468ff",cursor:"pointer"}},padding:[8,8,8,8]}}}(Hk);var rP=function(t){function e(e){var n=this,r=e.style,i=$a(e,["style"]);return(n=t.call(this,pu({},{type:"lines",style:{width:0,height:0}},Za({style:r},i)))||this).linesGroup=n.appendChild(new Kf({name:"lines"})),n.areasGroup=n.appendChild(new Kf({name:"areas"})),n.render(),n}return qa(e,t),e.prototype.render=function(){var t=this.attributes,e=t.lines,n=t.areas;e&&this.createLines(e),n&&this.createAreas(n)},e.prototype.clear=function(){this.linesGroup.removeChildren(),this.areasGroup.removeChildren()},e.prototype.update=function(t){var e=t.lines,n=t.areas;this.clear(),e&&this.setAttribute("lines",e),n&&this.setAttribute("areas",n),this.render()},e.prototype.createLines=function(t){gk(this.linesGroup).selectAll("line").data(t).join((function(t){return t.append("path").each((function(t){gk(this).styles(t)}))}),(function(t){return t.each((function(t){gk(this).styles(t)}))}),(function(t){return t.remove()}))},e.prototype.createAreas=function(t){gk(this.linesGroup).selectAll("area").data(t).join((function(t){return t.append("path").each((function(t){gk(this).styles(t)}))}),(function(t){return t.each((function(t){gk(this).styles(t)}))}),(function(t){return t.remove()}))},e}(zf),iP=function(t){function e(e){var n=this,r=e.style,i=$a(e,["style"]);return(n=t.call(this,pu({},{type:"column",style:{width:0,height:0}},Za({style:r},i)))||this).columnsGroup=new Kf({name:"columns"}),n.appendChild(n.columnsGroup),n.render(),n}return qa(e,t),e.prototype.render=function(){var t=this.attributes.columns;gk(this.columnsGroup).selectAll("column-group").data(t.flat()).join((function(t){return t.append("rect").each((function(t){gk(this).styles(t)}))}),(function(t){return t.each((function(t){gk(this).styles(t)}))}),(function(t){return t.remove()}))},e.prototype.update=function(t){this.attr(pu({},this.attributes,t)),t.columns&&(this.clear(),this.render())},e.prototype.clear=function(){this.removeChildren()},e}(zf);function oP(t){return 0===t.length?[0,0]:[Zs(tu(t,(function(t){return Zs(t)||0}))),qs(Qs(t,(function(t){return qs(t)||0})))]}function aP(t){for(var e=lu(t),n=e[0].length,r=Qa([Array(n).fill(0),Array(n).fill(0)],2),i=r[0],o=r[1],a=0;a<e.length;a+=1)for(var s=e[a],u=0;u<n;u+=1)s[u]>=0?(s[u]+=i[u],i[u]=s[u]):(s[u]+=o[u],o[u]=s[u]);return e}function sP(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=[[0,0],[1,1]]);for(var r=!!e,i=[],o=0,a=t.length;o<a;o+=2)i.push([t[o],t[o+1]]);var s,u,c,l=function(t,e,n,r){var i,o,a,s,u,c,l,h=[],f=!!r;if(f){a=r[0],s=r[1];for(var p=0,d=t.length;p<d;p+=1)a=Da([0,0],a,v=t[p]),s=Fa([0,0],s,v)}p=0;for(var m=t.length;p<m;p+=1){var v=t[p];if(0!==p||n)if(p!==m-1||n){i=t[[p?p-1:m-1,p-1][n?0:1]],o=t[n?(p+1)%m:p+1];var g=[0,0];g=ja(g=Ha(g,o,i),g,e);var y=Ba(v,i),x=Ba(v,o),b=y+x;0!==b&&(y/=b,x/=b);var _=ja([0,0],g,-y),w=ja([0,0],g,x);c=Ia([0,0],v,_),u=Da([0,0],u=Ia([0,0],v,w),Fa([0,0],o,v)),u=Fa([0,0],u,Da([0,0],o,v)),c=Da([0,0],c=Ia([0,0],v,_=ja([0,0],_=Ha([0,0],u,v),-y/x)),Fa([0,0],i,v)),c=Fa([0,0],c,Da([0,0],i,v)),u=Ia([0,0],v,w=ja([0,0],w=Ha([0,0],v,c),x/y)),f&&(c=Da([0,0],c=Fa([0,0],c,a),s),u=Da([0,0],u=Fa([0,0],u,a),s)),h.push(l),h.push(c),l=u}else c=v,h.push(l),h.push(c);else l=v}return n&&h.push(h.shift()),h}(i,.4,r,n),h=i.length,f=[];for(o=0;o<h-1;o+=1)s=l[2*o],u=l[2*o+1],c=i[o+1],f.push(["C",s[0],s[1],u[0],u[1],c[0],c[1]]);return r&&(s=l[h],u=l[h+1],c=i[0],f.push(["C",s[0],s[1],u[0],u[1],c[0],c[1]])),f}function uP(t,e){void 0===e&&(e=!1);var n=e?t.length-1:0,r=t.map((function(t,e){return ts([e===n?"M":"L"],Qa(t),!1)}));return e?r.reverse():r}function cP(t,e){if(void 0===e&&(e=!1),t.length<=2)return uP(t);for(var n=[],r=t.length,i=0;i<r;i+=1){var o=e?t[r-i-1]:t[i];mu(o,n.slice(-2))||n.push.apply(n,ts([],Qa(o),!1))}var a=sP(n,!1);return e?a.unshift(ts(["M"],Qa(t[r-1]),!1)):a.unshift(ts(["M"],Qa(t[0]),!1)),a}function lP(t,e,n){var r=lu(t);return r.push(["L",e,n],["L",0,n],["Z"]),r}var hP=function(t){function e(n){return t.call(this,pu({},e.defaultOptions,n))||this}return qa(e,t),Object.defineProperty(e.prototype,"rawData",{get:function(){var t=this.attributes.data;if(!t||0===(null==t?void 0:t.length))return[[]];var e=lu(t);return Js(e[0])?[e]:e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this.attributes.isStack?aP(this.rawData):this.rawData},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scales",{get:function(){return this.createScales(this.data)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"baseline",{get:function(){var t=this.scales.y,e=Qa(t.getOptions().domain||[0,0],2),n=e[0],r=e[1];return r<0?t.map(r):t.map(n<0?0:n)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"containerCfg",{get:function(){var t=this.attributes;return{width:t.width,height:t.height}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"linesCfg",{get:function(){var t=this;if("line"!==this.attributes.type)throw new Error("linesCfg can only be used in line type");var e=this.attributes,n=e.isStack,r=e.smooth,i=hk(this.attributes,"area"),o=hk(this.attributes,"line"),a=this.containerCfg.width,s=this.data;if(0===s[0].length)return{lines:[],areas:[]};var u=this.scales,c=function(t,e){var n,r=e.x,i=e.y,o=Qa(i.getOptions().range||[0,0],2),a=o[0],s=o[1];return s>a&&(n=Qa([a,s],2),s=n[0],a=n[1]),t.map((function(t){return t.map((function(t,e){return[r.map(e),Ks(i.map(t),s,a)]}))}))}(s,{type:"line",x:u.x,y:u.y}),l=[];if(i){var h=this.baseline;l=n?r?function(t,e,n){for(var r=[],i=t.length-1;i>=0;i-=1){var o=t[i],a=cP(o),s=void 0;if(0===i)s=lP(a,e,n);else{var u=cP(t[i-1],!0),c=o[0];u[0][0]="L",s=ts(ts(ts([],Qa(a),!1),Qa(u),!1),[ts(["M"],Qa(c),!1),["Z"]],!1)}r.push(s)}return r}(c,a,h):function(t,e,n){for(var r=[],i=t.length-1;i>=0;i-=1){var o=uP(t[i]),a=void 0;if(0===i)a=lP(o,e,n);else{var s=uP(t[i-1],!0);s[0][0]="L",a=ts(ts(ts([],Qa(o),!1),Qa(s),!1),[["Z"]],!1)}r.push(a)}return r}(c,a,h):function(t,e,n,r){return t.map((function(t){return lP(e?cP(t):uP(t),n,r)}))}(c,r,a,h)}return{lines:c.map((function(e,n){return Za({stroke:t.getColor(n),path:r?cP(e):uP(e)},o)})),areas:l.map((function(e,n){return Za({path:e,fill:t.getColor(n)},i)}))}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"columnsCfg",{get:function(){var t=this;if("column"!==this.attributes.type)throw new Error("columnsCfg can only be used in column type");var e=hk(this.attributes,"column"),n=this.attributes.isStack,r=this.containerCfg.height,i=this.rawData;if(!i)return{columns:[]};n&&(i=aP(i));var o=this.createScales(i),a=o.x,s=o.y,u=Qa(oP(i),2),c=u[0],l=u[1],h=new qA({domain:[0,l-(c>0?0:c)],range:[0,r]}),f=a.getBandWidth(),p=this.rawData;return{columns:i.map((function(r,o){return r.map((function(r,u){var c=f/i.length;return Za(Za({fill:t.getColor(o)},e),n?{x:a.map(u),y:s.map(r),width:f,height:h.map(p[o][u])}:{x:a.map(u)+c*o,y:r>=0?s.map(r):s.map(0),width:c,height:h.map(Math.abs(r))})}))}))}},enumerable:!1,configurable:!0}),e.prototype.render=function(t,e){this.containerShape=yk(e,".container","rect").attr("className","container").node();var n=t.type,r="spark".concat(n),i="line"===n?this.linesCfg:this.columnsCfg;this.sparkShape=yk(e,".".concat(r),(function(){return"line"===n?new rP({className:r,style:i}):new iP({className:r,style:i})})).styles(i).node()},e.prototype.update=function(t){this.attr(pu({},this.attributes,t)),this.render(this.attributes,this)},e.prototype.clear=function(){this.removeChild(this.sparkShape),this.sparkShape.clear(),this.sparkShape.destroy()},e.prototype.getColor=function(t){var e=this.attributes.color;return Gs(e)?e[t%e.length]:Bs(e)?e.call(null,t):e},e.prototype.createScales=function(t){var e,n,r=this.attributes,i=r.type,o=r.range,a=void 0===o?[]:o,s=this.containerCfg,u=s.width,c=s.height,l=Qa(oP(t),2),h=l[0],f=l[1],p=new qA({domain:[null!==(e=a[0])&&void 0!==e?e:h,null!==(n=a[1])&&void 0!==n?n:f],range:[c,0]});if("line"===i)return{type:i,x:new qA({domain:[0,t[0].length-1],range:[0,u]}),y:p};var d=this.attributes,m=d.isGroup,v=d.spacing;return{type:i,x:new PA({domain:t[0].map((function(t,e){return e})),range:[0,u],paddingInner:m?v:0}),y:p}},e.tag="sparkline",e.defaultOptions={style:{type:"line",width:200,height:20,isStack:!1,nice:!0,color:["#83daad","#edbf45","#d2cef9","#e290b3","#6f63f4"],smooth:!0,lineLineWidth:1,areaOpacity:0,isGroup:!1,columnLineWidth:1,columnStroke:"#fff",columnPadding:.1}},e}(Hk),fP={fill:"#fff",stroke:"#bfbfbf",lineWidth:1,size:10,radius:2,strokeOpacity:1},pP={fontSize:12,fill:"#000",fillOpacity:.45,textAlign:"center",textBaseline:"middle"},dP={orient:"horizontal",type:"start",showLabel:!0},mP=zk({labelGroup:"label-group",label:"label",icon:"icon",iconRect:"icon-rect",iconLine:"icon-line"},"handle"),vP=Bk({render:function(t,e){var n=t.size,r=void 0===n?10:n,i=t.radius,o=void 0===i?r/4:i,a=t.orient;t.class;var s=$a(t,["size","radius","orient","class"]),u=r,c=2.4*u,l=gk(e).maybeAppendByClassName(mP.iconRect,"rect").styles(Za(Za({},s),{width:u,height:c,radius:o,x:-u/2,y:-c/2})),h=1/3*u,f=2/3*u,p=1/4*c,d=3/4*c;l.maybeAppendByClassName("".concat(mP.iconLine,"-1"),"line").styles(Za({x1:h,x2:h,y1:p,y2:d},s)),l.maybeAppendByClassName("".concat(mP.iconLine,"-2"),"line").styles(Za({x1:f,x2:f,y1:p,y2:d},s)),l.node().setOrigin(u/2,c/2),"vertical"===a?e.setLocalEulerAngles(90):e.setLocalEulerAngles(0)}}),gP=function(t){function e(e){return t.call(this,Ek({},{style:dP},e))||this}return qa(e,t),e.prototype.renderLabel=function(t){var e=this,n=this.attributes.showLabel,r=Qa(dk(hk(this.attributes,"label"),[]),2),i=r[0],o=r[1];jk(!!n,gk(t).maybeAppendByClassName(mP.labelGroup,"g").styles(o),(function(t){e.label=t.maybeAppendByClassName(mP.label,"text").styles(Za(Za({},pP),i)),e.label.on("mousedown",(function(t){t.stopPropagation()})),e.label.on("touchstart",(function(t){t.stopPropagation()}))}))},e.prototype.renderIcon=function(t){var e=this.attributes,n=e.iconShape,r=void 0===n?function(){return new vP({style:o})}:n,i=e.orient,o=Za(Za({orient:i},fP),hk(this.attributes,"icon"));this.icon=gk(t).maybeAppendByClassName(mP.icon,r).update(o)},e.prototype.render=function(t,e){this.renderIcon(e),this.renderLabel(e)},e}(Hk),yP=function(t){function e(n){var r=t.call(this,pu({},e.defaultOptions,n))||this;return r.range=[0,1],r.animation={duration:100,fill:"both"},r.onDragStart=function(t){return function(e){e.stopPropagation(),r.target=t,r.prevPos=r.getOrientVal(mk(e));var n=r.availableSpace,i=n.x,o=n.y,a=r.attributes,s=a.x,u=a.y;r.selectionStartPos=r.getRatio(r.prevPos-r.getOrientVal([i,o])-r.getOrientVal([+s,+u])),r.selectionWidth=0,document.addEventListener("mousemove",r.onDragging),document.addEventListener("touchmove",r.onDragging),document.addEventListener("mouseup",r.onDragEnd),document.addEventListener("touchend",r.onDragEnd)}},r.onDragging=function(t){var e=r.attributes,n=e.slidable,i=e.brushable;t.stopPropagation();var o=r.getOrientVal(mk(t)),a=o-r.prevPos;if(a){var s=r.getRatio(a);switch(r.target){case"start":n&&r.setValuesOffset(s);break;case"end":n&&r.setValuesOffset(0,s);break;case"selection":n&&r.setValuesOffset(s,s);break;case"track":if(!i)return;r.selectionWidth+=s,r.innerSetValues([r.selectionStartPos,r.selectionStartPos+r.selectionWidth].sort(),!0)}r.prevPos=o}},r.onDragEnd=function(){document.removeEventListener("mousemove",r.onDragging),document.removeEventListener("mousemove",r.onDragging),document.removeEventListener("mouseup",r.onDragEnd),document.removeEventListener("touchend",r.onDragEnd)},r.onValueChange=function(t){var e=new xf("valuechange",{detail:{oldValue:t,value:r.getValues()}});r.dispatchEvent(e)},r.selectionStartPos=0,r.selectionWidth=0,r.prevPos=0,r.target="",r}return qa(e,t),Object.defineProperty(e.prototype,"values",{get:function(){return this.getAttribute("values")},set:function(t){this.setAttribute("values",this.clampValues(t))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sparklineShapeCfg",{get:function(){if("horizontal"!==this.attributes.orient)return null;var t=hk(this.attributes,"sparkline"),e=t.padding,n=$a(t,["padding"]),r=Qa(ak(e),4),i=r[0],o=r[1],a=r[2],s=r[3],u=this.availableSpace,c=u.width,l=u.height,h=this.attributes.trackLineWidth,f=+(void 0===h?0:h);return Za(Za({x:f/2+s,y:f/2+i},n),{zIndex:0,width:c-f-s-o,height:l-f-i-a})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shape",{get:function(){var t=this.attributes,e=t.trackLength,n=t.trackSize,r=Qa(this.getOrientVal([[e,n],[n,e]]),2);return{width:r[0],height:r[1]}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"availableSpace",{get:function(){var t=Qa(ak(this.attributes.padding),4),e=t[0],n=t[1],r=t[2],i=t[3],o=this.shape;return{x:i,y:e,width:o.width-(i+n),height:o.height-(e+r)}},enumerable:!1,configurable:!0}),e.prototype.getValues=function(){return this.values},e.prototype.setValues=function(t,e){void 0===t&&(t=[0,0]),void 0===e&&(e=!1),this.attr("values",t),Wk(this.selectionShape.node(),this.selectionCfg,this.animation,e),Wk(this.startHandle.node(),this.getHandleShapeCfg("start"),this.animation,e),Wk(this.endHandle.node(),this.getHandleShapeCfg("end"),this.animation,e)},e.prototype.innerSetValues=function(t,e){void 0===t&&(t=[0,0]),void 0===e&&(e=!1);var n=this.values,r=this.clampValues(t);this.update({values:r}),e&&this.onValueChange(n)},e.prototype.renderTrack=function(t){var e=this.attributes.brushable,n=hk(this.attributes,"track");this.trackShape=gk(t).maybeAppendByClassName("slider-track","rect").styles(Za(Za(Za({},this.shape),n),{cursor:e?"crosshair":"default"}))},e.prototype.renderSparkline=function(t){var e=this;jk("horizontal"===this.attributes.orient,gk(t).maybeAppendByClassName("slider-sparkline-group","g"),(function(t){var n=e.sparklineShapeCfg;t.maybeAppendByClassName("slider-sparkline",(function(){return new hP({style:n})})).call((function(t){t.node().update(n)}))}))},Object.defineProperty(e.prototype,"selectionCfg",{get:function(){var t=hk(this.attributes,"selection");return Za(Za({},t),this.calcMask())},enumerable:!1,configurable:!0}),e.prototype.renderSelection=function(t){var e=this;this.foregroundGroup=gk(t).maybeAppendByClassName("slider-foreground","g"),this.selectionShape=this.foregroundGroup.maybeAppendByClassName("slider-selection","rect").styles(this.selectionCfg);var n=function(t){var n="".concat(t,"-handle"),r=e.getHandleShapeCfg(t);return e.foregroundGroup.maybeAppendByClassName(n,(function(){return new gP({style:r})})).style("type",t).update(r)};this.startHandle=n("start"),this.endHandle=n("end")},e.prototype.render=function(t,e){this.renderTrack(e),this.renderSparkline(e),this.renderSelection(e)},e.prototype.clampValues=function(t,e){var n;void 0===e&&(e=4);var r=Qa(this.range,2),i=r[0],o=r[1],a=Qa(this.getValues().map((function(t){return ok(t,e)})),2),s=a[0],u=a[1],c=Qa((t||[s,u]).map((function(t){return ok(t,e)})),2),l=c[0],h=c[1];l>h&&(l=(n=Qa([h,l],2))[0],h=n[1]);var f=h-l;return f>o-i?[i,o]:l<i?s===i&&u===h?[i,h]:[i,f+i]:h>o?u===o&&s===l?[l,o]:[o-f,o]:[l,h]},e.prototype.calcMask=function(t){var e=Qa(this.clampValues(t),2),n=e[0],r=e[1],i=this.availableSpace,o=i.x,a=i.y,s=i.width,u=i.height;return this.getOrientVal([{y:a,height:u,x:n*s+o,width:(r-n)*s},{x:o,width:s,y:n*u+a,height:(r-n)*u}])},e.prototype.calcHandlePosition=function(t){var e=this.availableSpace,n=e.width,r=e.height,i=Qa(this.clampValues(),2),o=i[0],a=i[1],s=("start"===t?o:a)*this.getOrientVal([n,r]);return{x:this.getOrientVal([s,n/2]),y:this.getOrientVal([r/2,s])}},e.prototype.calcHandleText=function(t){var e=this.attributes,n=e.orient,r=e.formatter,i=hk(this.attributes,"handle"),o=hk(i,"label"),a=i.spacing,s=this.getHandleSize(),u=this.clampValues(),c=this.availableSpace,l=c.width,h=c.height,f=this.calcMask(),p=f.x,d=f.y,m=f.width,v=f.height,g=r("start"===t?u[0]:u[1]),y=this.appendChild(new pp({style:Za(Za(Za({visibility:"hidden"},uk),o),{text:g})})),x=y.getBBox(),b=x.width,_=x.height;y.destroy();var w=0,S=0;if("horizontal"===n){var M=a+s,E=M+b/2;if("start"===t)w=p-M-b>0?-E:E;else w=l-p-m-M>b?E:-E}else{E=a+s;S="start"===t?d-s>_?-E:E:h-d-v-s>_?E:-E}return{x:w,y:S,text:g}},e.prototype.getHandleLabelShapeCfg=function(t){if(!this.attributes.showLabel)return{};var e=hk(this.attributes,"handleLabel");return Za(Za({},e),this.calcHandleText(t))},e.prototype.getHandleIconShapeCfg=function(){var t=this.attributes,e=t.orient,n=t.handleIconShape,r=hk(this.attributes,"handleIcon"),i=this.getOrientVal(["ew-resize","ns-resize"]),o=this.getHandleSize();return Za(Za({},r),{shape:n,orient:e,cursor:i,size:o})},e.prototype.getHandleShapeCfg=function(t){var e=this.attributes,n=e.showHandle,r=e.showLabel,i=this.calcHandlePosition(t),o=i.x,a=i.y,s=this.calcHandleText(t);return Za(Za(Za({zIndex:3,showLabel:r,visibility:n?"visible":"hidden"},pk(this.getHandleIconShapeCfg(),"icon")),pk(Za(Za({},this.getHandleLabelShapeCfg(t)),s),"label")),{x:o,y:a})},e.prototype.getHandleSize=function(){var t=this.attributes.handleIconSize;if(t)return t;var e=this.attributes,n=e.width,r=e.height;return Math.floor((this.getOrientVal([+r,+n])+4)/2.4)},e.prototype.getOrientVal=function(t){var e=Qa(t,2),n=e[0],r=e[1];return"horizontal"===this.attributes.orient?n:r},e.prototype.setValuesOffset=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=!1);var r=Qa(this.getValues(),2),i=[r[0]+t,r[1]+e].sort();n?this.setValues(i):this.innerSetValues(i,!0)},e.prototype.getRatio=function(t){var e=this.availableSpace,n=e.width,r=e.height;return t/this.getOrientVal([n,r])},e.prototype.dispatchCustomEvent=function(t,e,n){var r=this;t.on(e,(function(t){t.stopPropagation(),r.dispatchEvent(new xf(n,{detail:t}))}))},e.prototype.bindEvents=function(){var t=this,e=this.selectionShape;this.addEventListener("wheel",this.onScroll),e.on("mousedown",this.onDragStart("selection")),e.on("touchstart",this.onDragStart("selection")),this.dispatchCustomEvent(e,"mouseenter","selectionMouseenter"),this.dispatchCustomEvent(e,"mouseleave","selectionMouseleave"),this.dispatchCustomEvent(e,"click","selectionClick"),[this.startHandle,this.endHandle].forEach((function(e){var n=e.node().attr("type");e.on("mousedown",(function(e){t.onDragStart(n)(e)})),e.on("touchstart",(function(e){t.onDragStart(n)(e)}))}));var n=this.trackShape;this.dispatchCustomEvent(n,"click","trackClick"),this.dispatchCustomEvent(n,"mouseenter","trackMouseenter"),this.dispatchCustomEvent(n,"mouseleave","trackMouseleave"),n.on("mousedown",this.onDragStart("track")),n.on("touchstart",this.onDragStart("track"))},e.prototype.onScroll=function(t){if(this.attributes.scrollable){var e=t.deltaX,n=t.deltaY||e,r=this.getRatio(n);this.setValuesOffset(r,r,!0)}},e.tag="slider",e.defaultOptions={style:Za(Za(Za({values:[0,1],trackLength:200,trackSize:20,slidable:!0,brushable:!0,scrollable:!0,orient:"horizontal",trackZIndex:-1,trackFill:"#416180",trackOpacity:.05,selectionCursor:"move",selectionZIndex:2,selectionFill:"#5B8FF9",selectionFillOpacity:.45,sparklinePadding:1,padding:0,showHandle:!0,showLabel:!0,handleSpacing:2,formatter:function(t){return t}},pk(dP,"handle")),pk(fP,"handleIcon")),pk(pP,"handleLabel"))},e}(Hk);!function(t){function e(n){var r=t.call(this,pu({},e.defaultOptions,n))||this;return r.range=[0,1],r.onValueChange=function(t){var e=r.style.value;if(t!==e){var n={detail:{oldValue:t,value:e}};r.dispatchEvent(new xf("scroll",n)),r.dispatchEvent(new xf("valuechange",n))}},r.onTrackClick=function(t){if(r.attributes.slidable){var e=Qa(r.getLocalPosition(),2),n=e[0],i=e[1],o=Qa(r.padding,4),a=o[0],s=o[3],u=r.getOrientVal([n+s,i+a]),c=(r.getOrientVal(mk(t))-u)/r.trackLength;r.setValue(c,!0)}},r.onThumbMouseenter=function(t){r.dispatchEvent(new xf("thumbMouseenter",{detail:t.detail}))},r.onTrackMouseenter=function(t){r.dispatchEvent(new xf("trackMouseenter",{detail:t.detail}))},r.onThumbMouseleave=function(t){r.dispatchEvent(new xf("thumbMouseleave",{detail:t.detail}))},r.onTrackMouseleave=function(t){r.dispatchEvent(new xf("trackMouseleave",{detail:t.detail}))},r}qa(e,t),Object.defineProperty(e.prototype,"padding",{get:function(){return ak(this.attributes.padding)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){var t=this.attributes.value,e=Qa(this.range,2),n=e[0],r=e[1];return Ks(t,n,r)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"trackLength",{get:function(){var t=this.attributes,e=t.viewportLength,n=t.trackLength;return void 0===n?e:n},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"availableSpace",{get:function(){var t=this.attributes.trackSize,e=this.trackLength,n=Qa(this.padding,4),r=n[0],i=n[1],o=n[2],a=n[3],s=Qa(this.getOrientVal([[e,t],[t,e]]),2);return{x:a,y:r,width:+s[0]-(a+i),height:+s[1]-(r+o)}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"trackRadius",{get:function(){var t=this.attributes,e=t.isRound,n=t.trackSize;return e?n/2:0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"thumbRadius",{get:function(){if(!this.attributes.isRound)return 0;var t=this.availableSpace,e=t.width,n=t.height;return this.attributes.thumbRadius||this.getOrientVal([n,e])/2},enumerable:!1,configurable:!0}),e.prototype.getValues=function(t){void 0===t&&(t=this.value);var e=this.attributes,n=e.viewportLength/e.contentLength,r=Qa(this.range,2),i=r[0],o=t*(r[1]-i-n);return[o,o+n]},e.prototype.getValue=function(){return this.value},e.prototype.renderSlider=function(t){var e=this.attributes,n=e.orient,r=e.trackSize,i=e.padding,o=e.slidable,a=Qa(fk(this.attributes,["track","thumb"]),2),s=a[0],u=a[1],c=Za(Za({orient:n,padding:i,slidable:o,trackSize:r,brushable:!1,showHandle:!1,values:this.getValues(),trackLength:this.trackLength,trackRadius:this.trackRadius,selectionRadius:this.thumbRadius},pk(s,"track")),pk(u,"selection"));this.slider=gk(t).maybeAppendByClassName("scrollbar",(function(){return new yP({style:c})})).update(c).node()},e.prototype.render=function(t,e){this.renderSlider(e)},e.prototype.setValue=function(t,e){void 0===e&&(e=!1);var n=this.style.value,r=Qa(this.range,2),i=r[0],o=r[1];this.slider.setValues(this.getValues(Ks(t,i,o)),e),this.onValueChange(n)},e.prototype.bindEvents=function(){var t=this;this.slider.addEventListener("trackClick",(function(e){e.stopPropagation(),t.onTrackClick(e.detail)})),this.onHover()},e.prototype.getOrientVal=function(t){return"horizontal"===this.attributes.orient?t[0]:t[1]},e.prototype.onHover=function(){this.slider.addEventListener("selectionMouseenter",this.onThumbMouseenter),this.slider.addEventListener("trackMouseenter",this.onTrackMouseenter),this.slider.addEventListener("selectionMouseleave",this.onThumbMouseleave),this.slider.addEventListener("trackMouseleave",this.onTrackMouseleave)},e.tag="scrollbar",e.defaultOptions={style:{value:0,trackSize:10,isRound:!0,slidable:!0,scrollable:!0,orient:"vertical",padding:[2,2,2,2]}}}(Hk);var xP={style:{data:[],dataThreshold:100,showTitle:!0,titlePosition:"lb",titleFill:"black",titleFontSize:12,titleTextAlign:"center",titleSpacing:0,titleTextBaseline:"middle",showLine:!0,lineLineWidth:1,lineStroke:"black",lineArrow:new op({style:{path:"M 10,10 L -10,0 L 10,-10 L0,0 L10,10Z",anchor:"0.5 0.5",fill:"black",transformOrigin:"center"}}),lineArrowOffset:15,lineArrowSize:10,showTick:!0,tickDirection:"positive",tickStroke:"black",tickLength:5,tickLineWidth:1,tickStrokeOpacity:.65,showLabel:!0,labelSpacing:0,labelDirection:"positive",labelAlign:"parallel",labelTransforms:[],showGrid:!0,gridType:"segment",gridConnect:"line",gridDirection:"positive",gridLength:0,gridControlAngles:[]}};pu({},xP,{style:{type:"arc"}}),pu({},xP,{style:{}});var bP=zk({mainGroup:"main-group",gridGroup:"grid-group",grid:"grid",lineGroup:"line-group",line:"line",tickGroup:"tick-group",tick:"tick",tickItem:"tick-item",labelGroup:"label-group",label:"label",labelItem:"label-item",titleGroup:"title-group",title:"title",lineFirst:"line-first",lineSecond:"line-second"},"axis");function _P(t,e,n,r){var i=n[e].data,o=n.map((function(t){return t.data})),a="function"==typeof r?r.call(null,i,e,o):r;t.attr(a||{})}function wP(t,e){return Object.fromEntries(Object.entries(t).map((function(t){var n=Qa(t,2);return[n[0],Fk(n[1],e)]})))}function SP(t,e){return e&&Bs(e)?t.filter(e):t}function MP(t){return t.reduce((function(t,e,n){return"".concat(t).concat(0===n?"M":" L").concat(e[0],",").concat(e[1])}),"")}function EP(t,e,n){return"surround"===e.type?function(t,e,n){var r=e.connect,i=void 0===r?"line":r,o=e.center;if("line"===i)return MP(t);if(!o)return"";var a=_k(t[0],o),s=n?0:1;return t.reduce((function(t,e,n){var r=Qa(e,2),i=r[0],o=r[1];return 0===n?"M".concat(i,",").concat(o):"".concat(t,"A").concat(a,",").concat(a,",0,0,").concat(s,",").concat(i,",").concat(o)}),"")}(t,e,n):MP(t)}function AP(t,e,n){var r=n.type,i=n.connect,o=n.center,a=n.closed?" Z":"",s=Qa([EP(t,n),EP(e.slice().reverse(),n,!0)],2),u=s[0],c=s[1],l=Qa([t[0],e.slice(-1)[0]],2),h=l[0],f=l[1],p=function(t,e){return"".concat(u," ").concat(t," ").concat(c," ").concat(e," ").concat(a)};if("line"===i||"surround"===r)return p("L".concat(f.join()),"L".concat(h.join()));if(!o)throw new Error("Arc grid need to specified center");var d=Qa([_k(f,o),_k(h,o)],2),m=d[0],v=d[1];return p("A".concat(m,",").concat(m,",0,0,1,").concat(f.join(" ")," L").concat(f.join()),"A".concat(v,",").concat(v,",0,0,0,").concat(h.join(" ")))}var TP=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return qa(e,t),e.prototype.render=function(t,e){t.className;var n=t.items,r=void 0===n?[]:n;t.type,t.center,t.areaFill,t.closed;var i=$a(t,["className","items","type","center","areaFill","closed"]),o=function(t,e){return e.closed?t.map((function(t){var e=t.points,n=Qa(e),r=n[0];return n.slice(1),Za(Za({},t),{points:ts(ts([],Qa(e),!1),[r],!1)})})):t}(r,t);!function(t,e,n,r){var i=e.map((function(t,e){return{id:t.id||"grid-line-".concat(e),path:EP(t.points,n)}}));gk(t).selectAll(".grid-line").data(i,(function(t){return t.id})).join((function(t){return t.append("path").styles({stroke:"#D9D9D9",lineWidth:1,lineDash:[4,4]}).each((function(t,e){var n=t.path;_P(this,e,i,Za({path:n},r))})).attr("className","grid-line")}),(function(t){return t.each((function(t,e){_P(this,e,i,t)}))}),(function(t){return t.remove()}))}(e,o,t,i),function(t,e,n){n.type,n.center;var r=n.connect,i=n.areaFill;if(n.closed,!(e.length<2)&&i&&r){for(var o,a=Array.isArray(i)?i:[i,"transparent"],s=[],u=0;u<e.length-1;u++){var c=Qa([e[u].points,e[u+1].points],2),l=AP(c[0],c[1],n);s.push({path:l,fill:(o=u,a[o%a.length])})}gk(t).selectAll(".grid-region").data(s,(function(t,e){return e})).join((function(t){return t.append("path").each((function(t,e){_P(this,e,s,t)})).attr("className","grid-region")}),(function(t){return t.each((function(t,e){_P(this,e,s,t)}))}),(function(t){return t.remove()}))}}(e,o,t)},e}(Hk),CP=hu((function(t,e){var n=Qa(e.angleRange,2),r=n[0];return(n[1]-r)*t+r}),(function(t,e){return ts([t],Qa(e.angleRange),!1).join()})),OP=hu((function(t,e){if("linear"===e.type){var n=Qa(e.startPos,2),r=n[0],i=n[1],o=Qa(e.endPos,2),a=Qa([o[0]-r,o[1]-i],2);return za([0,0],[a[0],a[1]])}var s=Lk(CP(t,e));return[-Math.sin(s),Math.cos(s)]}),(function(t,e){var n=function(t){return"linear"===t.type?ts(ts([],Qa(t.startPos),!1),Qa(t.endPos),!1):ts(ts(ts([],Qa(t.angleRange),!1),Qa(t.center),!1),[t.radius],!1)}(e);return"arc"===e.type&&n.push(t),n.join()}));function kP(t,e,n){var r,i,o=OP(t,n);return r=[],i=o,"positive"!==e?(r[0]=i[1],r[1]=-1*i[0]):(r[0]=-1*i[1],r[1]=i[0]),r}var PP=hu((function(t,e){var n=Qa(e.startPos,2),r=n[0],i=n[1],o=Qa(e.endPos,2),a=Qa([o[0]-r,o[1]-i],2);return[r+a[0]*t,i+a[1]*t]}),(function(t,e){return ts(ts([t],Qa(e.startPos),!1),Qa(e.endPos),!1).join()})),LP=hu((function(t,e){var n=e.radius,r=Qa(e.center,2),i=r[0],o=r[1],a=Lk(CP(t,e));return[i+n*Math.cos(a),o+n*Math.sin(a)]}),(function(t,e){return ts(ts(ts([t],Qa(e.angleRange),!1),[e.radius],!1),Qa(e.center),!1).join()}));function RP(t,e){return"linear"===e.type?PP(t,e):LP(t,e)}function IP(t,e,n){var r=e.startPos,i=e.endPos,o=e.truncRange,a=e.lineExtension,s=Qa([r,i],2),u=Qa(s[0],2),c=u[0],l=u[1],h=Qa(s[1],2),f=h[0],p=h[1],d=Qa(a?function(t,e,n){void 0===n&&(n=[0,0]);var r=Qa([t,e,n],3),i=Qa(r[0],2),o=i[0],a=i[1],s=Qa(r[1],2),u=s[0],c=s[1],l=Qa(r[2],2),h=l[0],f=l[1],p=Qa([u-o,c-a],2),d=p[0],m=p[1],v=Math.sqrt(Math.pow(d,2)+Math.pow(m,2)),g=Qa([-h/v,f/v],2),y=g[0],x=g[1];return[y*d,y*m,x*d,x*m]}(r,i,a):new Array(4).fill(0),4),m=d[0],v=d[1],g=d[2],y=d[3];t.node().removeChildren();var x=function(e,r){var i=Qa(r,2),o=Qa(i[0],2),a=o[0],s=o[1],u=Qa(i[1],2),c=u[0],l=u[1];t.maybeAppendByClassName(e,"line").attr("className","".concat(bP.line.name," ").concat(e)).styles(Za(Za({},n),{x1:a,y1:s,x2:c,y2:l}))};if(o){var b=Qa(o,2),_=b[0],w=b[1],S=Qa([c+(f-c)*_,l+(p-l)*_],2),M=S[0],E=S[1],A=Qa([c+(f-c)*w,l+(p-l)*w],2),T=A[0],C=A[1];x(bP.lineFirst.name,[[c+m,l+v],[M,E]]),x(bP.lineSecond.name,[[T,C],[f+g,p+y]]),function(t,e,n){e.truncRange,e.truncShape,e.lineExtension,t.select(bP.lineFirst.class).node(),t.select(bP.lineSecond.class).node()}(t,e)}else x("axis-line",[[c+m,l+v],[f+g,p+y]])}function NP(t,e,n){var r=e.type;"linear"===r?IP(t,e,n):function(t,e,n){var r=Qa(e.angleRange,2),i=r[0],o=r[1],a=Qa(e.center,2),s=a[0],u=a[1],c=e.radius,l=o-i;if(360!==l){var h=Qa([c,c],2),f=h[0],p=h[1],d=Qa([i*Math.PI/180,o*Math.PI/180],2),m=d[0],v=d[1],g=Qa([s+c*Math.cos(m),u+c*Math.sin(m)],2),y=g[0],x=g[1],b=Qa([s+c*Math.cos(v),u+c*Math.sin(v)],2),_=b[0],w=b[1],S=l>180?1:0,M=i>o?0:1,E="M".concat(y,",").concat(x,",A").concat(f,",").concat(p,",0,").concat(S,",").concat(M,",").concat(_,",").concat(w);t.maybeAppendByClassName(bP.line,"path").styles(Za({path:E},n))}else t.maybeAppendByClassName(bP.line,"circle").styles(Za({cx:s,cy:u,r:c},n))}(t,e,n),function(t,e,n,r){var i=n.lineArrow,o=n.truncRange,a=n.lineArrowOffset,s=void 0===a?0:a,u=n.lineArrowSize;if(i){var c=Pk(i);c.attr(r),Gk(c,u,!0),("arc"===e?t.select(bP.line.class):o?t.select(bP.lineSecond.class):t.select(bP.line.class)).style("markerEnd",c).style("markerEndOffset",-s)}}(t,r,e,n)}function DP(t){var e=t.type,n=t.gridCenter;return"linear"===e?n:n||t.center}function FP(t,e){var n=e.gridLength,r=void 0===n?0:n;return t.map((function(t){var n=t.value,i=Qa(RP(n,e),2),o=i[0],a=i[1],s=Qa(ja([0,0],function(t,e){return kP(t,e.gridDirection,e)}(n,e),r),2);return{points:[[o,a],[o+s[0],a+s[1]]]}}))}function jP(t,e,n,r){var i=r.type,o=r.closed,a=r.areaFill,s=r.connect,u=DP(n),c=SP(e,n.gridFilter),l="segment"===i?FP(c,n):function(t,e,n){var r=n.controlAngles,i=DP(e);if(!i)throw new Error("grid center is not provide");if(t.length<2)throw new Error("Invalid grid data");if(!r||0===r.length)throw new Error("Invalid gridControlAngles");var o=Qa(i,2),a=o[0],s=o[1];return t.map((function(t){var n=Qa(RP(t.value,e),2),i=n[0],o=n[1],u=Qa([i-a,o-s],2),c=u[0],l=u[1],h=[[i,o]];return r.forEach((function(t){var e=Lk(t),n=Qa([Math.cos(e),Math.sin(e)],2),r=n[0],i=n[1],o=c*r-l*i+a,u=c*i+l*r+s;h.push([o,u])})),{points:h}}))}(c,n,r);t.maybeAppendByClassName(bP.grid,(function(){return new TP({})})).update(Za(Za({type:i,connect:s,closed:o,center:u},r),{items:l,areaFill:Bs(a)?c.map((function(t,e){return Fk(a,[t,e,c])})):a}))}var BP=function(){function t(t){var e=t||{},n=e.left,r=e.top,i=e.right,o=e.bottom;this.x1=null!=n?n:+Number.MAX_VALUE,this.x2=null!=i?i:-Number.MAX_VALUE,this.y1=null!=r?r:+Number.MAX_VALUE,this.y2=null!=o?o:-Number.MAX_VALUE}return Object.defineProperty(t.prototype,"left",{get:function(){return this.x1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x2},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y2},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.defined("x2")&&this.defined("x1")?this.x2-this.x1:void 0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.defined("y2")&&this.defined("y1")?this.y2-this.y1:void 0},enumerable:!1,configurable:!0}),t.prototype.clear=function(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},t.prototype.empty=function(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},t.prototype.add=function(t,e){return t<this.x1&&(this.x1=t),e<this.y1&&(this.y1=e),t>this.x2&&(this.x2=t),e>this.y2&&(this.y2=e),this},t.prototype.rotate=function(t,e,n){var r=this.rotatedPoints(t,e,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},t.prototype.rotatedPoints=function(t,e,n){var r=this,i=r.x1,o=r.y1,a=r.x2,s=r.y2,u=Math.cos(t),c=Math.sin(t),l=e-e*u+n*c,h=n-e*c-n*u;return[[u*i-c*o+l,c*i+u*o+h],[u*i-c*s+l,c*i+u*s+h],[u*a-c*s+l,c*a+u*s+h],[u*a-c*o+l,c*a+u*o+h]].flat(1)},t.prototype.set=function(t,e,n,r){return n<t?(this.x2=t,this.x1=n):(this.x1=t,this.x2=n),r<e?(this.y2=e,this.y1=r):(this.y1=e,this.y2=r),this},t.prototype.intersects=function(t){return t&&!(this.x2<t.x1||this.x1>t.x2||this.y2<t.y1||this.y1>t.y2)},t.prototype.defined=function(t){return this[t]!==Number.MAX_VALUE&&this[t]!==-Number.MAX_VALUE},t}();function zP(t,e){return[[t[0],t[1],t[2],t[3]],[t[2],t[3],t[4],t[5]],[t[4],t[5],t[6],t[7]],[t[6],t[7],t[0],t[1]]].some((function(t){return function(t,e){var n=Qa(t,4),r=n[0],i=n[1],o=n[2],a=n[3],s=Qa(e,4),u=s[0],c=s[1],l=o-r,h=a-i,f=s[2]-u,p=s[3]-c,d=l*p-f*h;if(0===d)return!1;var m=d>0,v=r-u,g=i-c,y=l*g-h*v;if(y<0===m)return!1;var x=f*g-p*v;return x<0!==m&&y>d!==m&&x>d!==m}(e,t)}))}function UP(t,e,n){void 0===n&&(n=[0,0,0,0]);var r=e.getEulerAngles()||0;e.setEulerAngles(0);var i=e.getLocalBounds(),o=i.min,a=i.max,s=i.halfExtents,u=o[0],c=2*s[0],l=2*s[1],h=u,f=o[1],p=a[0],d=a[1],m=l,v=0,g=0,y=h,x=f;if("text"===e.tagName){m-=1.5;var b=e.style.textAlign,_=e.style.textBaseline;v=+e.style.dx,g=+e.style.dy,"center"===b?y=(h+p)/2:"right"!==b&&"end"!==b||(y=p),"middle"===_?x=(f+d)/2:"bottom"!==_&&"baseline"!==_||(x=d)}var w=Qa(n,4),S=w[0],M=void 0===S?0:S,E=w[1],A=void 0===E?0:E,T=w[2],C=void 0===T?M:T,O=w[3],k=void 0===O?A:O;return t.set((v+=h)-k,(g+=f)-M,v+c+A,g+m+C),e.setEulerAngles(r),t.rotatedPoints(Lk(r),y,x)}function VP(t,e){var n;return ts([],Qa(t.reduce((function(t,r,i){return i&&n&&function(t,e,n){var r=UP(new BP,t,n),i=UP(new BP,e,n);return zP(i,[r[0],r[1],r[2],r[3]])||zP(i,[r[0],r[1],r[4],r[5]])||zP(i,[r[4],r[5],r[6],r[7]])||zP(i,[r[2],r[3],r[6],r[7]])}(n,r,e)?(t.add(n),t.add(r),t):(n=r,t)}),new Set)),!1)}var GP=function(t,e){var n=e.seq,r=void 0===n?2:n;return t.filter((function(t,e){return!(e%r)||(t.style.visibility="hidden",!1)}))},WP=function(t){return t.filter((function(t){return void 0!==(e=t)&&null!=e&&!Number.isNaN(e);var e}))};var HP=new Map([["hide",function(t,e,n,r){var i=t.length,o=e.keepHeader,a=e.keepTail;if(!(i<=1||2===i&&o&&a)){var s,u,c,l=GP,h=2,f=t.slice(),p=t.slice(),d=Date.now(),m=Math.min.apply(Math,ts([1],Qa(t.map((function(t){return t.getBBox().width}))),!1));if("linear"===n.type&&(function(t){return 0===OP(0,t)[1]}(n)||function(t){return 0===OP(0,t)[0]}(n))){var v=bk(t[0]).left,g=bk(t[i-1]).right,y=Math.abs(g-v)||1;h=Math.max(Math.floor(i*m/y),h)}for(o&&(s=f.splice(0,1)[0]),a&&(u=f.splice(-1,1)[0],f.reverse());VP(WP(u?ts(ts([u],Qa(p),!1),[s],!1):ts([s],Qa(p),!1)),null==e?void 0:e.margin).length;){if(u&&!s&&h%2==0)f.splice(0,1).forEach(r.hide);else if(u&&s){f.splice(0,1).forEach(r.hide)}if(p=l(((c=f).forEach(r.show),c),{seq:h}),h++,Date.now()-d>200)return}}}],["rotate",function(t,e,n,r){var i=e.optionalAngles,o=void 0===i?[0,45,90]:i,a=e.margin,s=e.recoverWhenFailed,u=void 0===s||s,c=t.map((function(t){return+(Ik(t,"rotate")||0)})),l=function(){return VP(t,a).length<1},h=function(e){return t.forEach((function(t,n){var i=Gs(e)?e[n]:e;!zs(i)&&r.rotate(t,i)}))};if(!l()){for(var f=0;f<o.length;f++)if(h(o[f]),l())return;u&&h(c)}}],["ellipsis",function(t,e,n,r){if(!(t.length<=1)){var i,o,a,s,u,c,l=e.suffix,h=void 0===l?"...":l,f=e.minLength,p=e.maxLength,d=e.step,m=e.margin,v=void 0===m?[0,0,0,0]:m,g=(i=r.getTextShape(t[0]),o=i.style.fontFamily||"sans-serif",a=i.style.fontWeight||"normal",s=i.style.fontStyle||"normal",u=i.style.fontVariant,{fontSize:c="object"==typeof(c=i.style.fontSize)?c.value:c,fontFamily:o,fontWeight:a,fontStyle:s,fontVariant:u}),y=rk(d,g)||1,x=rk(f,g)||1,b=rk(p,g);(zs(b)||b===1/0)&&(b=Math.max.apply(null,t.map((function(t){return t.getBBox().width}))));var _=Date.now(),w=t.slice(),S=Qa(v,4);S[0],S[1],S[2],S[3];for(var M=function(e){return w.forEach((function(t){r.ellipsis(r.getTextShape(t),e,h)})),(w=VP(t,v)).length<1||Date.now()-_>300?{value:void 0}:void 0},E=b;E>x+y;E-=y){var A=M(E);if("object"==typeof A)return A.value}}}]]);function YP(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(t){return"positive"===t?-1:1};return t.reduce((function(t,e){return t*n(e)}),1)}var XP=function(t){for(var e=t;e<0;)e+=360;return e%360},qP=hu((function(t,e){var n=Qa(t,2),r=n[0],i=n[1],o=Qa(e,2),a=o[0],s=o[1],u=Qa([r*a+i*s,r*s-i*a],2),c=u[0],l=u[1];return Math.atan2(l,c)}),(function(t,e){return ts(ts([],Qa(t),!1),Qa(e),!1).join()}));function ZP(t,e){return kP(t,e.labelDirection,e)}function $P(t,e,n){var r=n.labelAlign,i=Ik(e,"rotate");if(i)return+i%180;var o=ZP(t.value,n),a=OP(t.value,n);return"horizontal"===r?0:function(t){var e=(t+360)%180;return Dk(e,-90,90)||(e+=180),e}(Rk("perpendicular"===r?qP([1,0],o):qP([a[0]<0?-1:1,0],a)))}function KP(t,e,n){e.setLocalEulerAngles(+t);var r=function(t,e,n){var r=n.type,i=n.labelAlign,o=ZP(t,n),a=XP(e),s=XP(Rk(qP([1,0],o)));if([90,270].includes(s)&&!a)return"middle";if(!(s%180)&&[90,270].includes(a))return"middle";if("linear"!==r)return"parallel"===i?"middle":Dk(a,90,270)?Dk(s,90,270)?"start":"end":Dk(s,90,270)?"end":"start";if(0===s){if(Dk(a,0,90,!1,!0))return"start";if(Dk(a,0,90)||Dk(a,270,360))return"start"}if(90===s){if(Dk(a,0,90,!1,!0))return"start";if(Dk(a,90,180)||Dk(a,270,360))return"end"}if(270===s){if(Dk(a,0,90,!1,!0))return"end";if(Dk(a,90,180)||Dk(a,270,360))return"start"}if(180===s){if(90===a)return"start";if(Dk(a,0,90)||Dk(a,270,360))return"end"}return"start"}(e.__data__.value,t,n),i=e.querySelector(".axis-label-item");"text"===(null==i?void 0:i.nodeName)&&gk(i).style("textAlign",r)}function JP(t,e,n,r,i){var o=i.labelFormatter,a=ZP(e.value,i),s=function(){return Pk(e.label||"")};return $s(o)?s=function(){return Pk(o)}:Bs(o)&&(s=function(){return Pk(Fk(o,[e,n,r,a]))}),t.append(s).attr("className",bP.labelItem.name)}function QP(t,e,n,r,i,o){var a,s=null===(a=r.getElementsByClassName(bP.labelItem.toString()))||void 0===a?void 0:a[0],u=Qa(dk(wP(o,[t,e,n])),2),c=u[0],l=u[1],h=l.transform,f=$a(l,["transform"]);"text"===(null==s?void 0:s.nodeName)&&s.attr(Za({fontSize:12,fontFamily:"sans-serif",fontWeight:"normal",textBaseline:"middle"},c)),r.attr(Za(Za({},function(t,e,n,r){var i=r.showTick,o=r.tickLength,a=r.tickDirection,s=r.labelDirection,u=Fk(r.labelSpacing,[t,e,n]),c=Qa([ZP(t.value,r),YP(s,a)],2),l=Qa(Ia([0,0],ja([0,0],c[0],u+(1===c[1]?Fk(i?o:0,[t,e,n]):0)),RP(t.value,r)),2);return{x:l[0],y:l[1]}}(t,e,n,i)),f)),Nk(r,h),KP($P(t,r,i),r,i)}function tL(t){!function(t,e,n){var r=e.labelTransforms,i=void 0===r?[]:r;i.length&&i.forEach((function(r){var i=r.type,o=HP.get(i);(function(t,e,n){return!!e.labelTransforms&&("ellipsis"!==n||t.map((function(t){return t.querySelector("text")})).length>1)})(t,e,i)&&(null==o||o(t,r,e,n))}))}(this.node().childNodes,t,{hide:function(t){t.style.visibility="hidden"},show:function(t){t.style.visibility="visible"},rotate:function(e,n){KP(+n,e,t)},ellipsis:function(t,e,n){void 0===e&&(e=1/0),t&&Vk(t,e,n)},getTextShape:function(t){return t.querySelector("text")}})}function eL(t,e){return kP(t,e.tickDirection,e)}var nL=hu((function(t,e){var n=Qa(t,2);return[[0,0],[n[0]*e,n[1]*e]]}),(function(t,e){return ts(ts([],Qa(t),!1),[e],!1).join()}));function rL(t,e,n,r,i){var o=i.tickFormatter,a=eL(e.value,i),s="line";return o instanceof zf?s=function(){return o}:Bs(o)&&(s=function(){return Fk(o,[e,n,r,a])}),t.append(s).attr("className",bP.tickItem.name)}function iL(t,e,n,r,i,o,a){var s=function(t,e,n,r,i){var o=i.tickLength,a=Qa(RP(t.value,i),2),s=a[0],u=a[1],c=Qa(nL(r,Fk(o,[t,e,n])),2),l=Qa(c[0],2),h=l[0],f=l[1],p=Qa(c[1],2);return{x:s,y:u,x1:h,x2:p[0],y1:f,y2:p[1]}}(t,e,n,eL(t.value,o),o),u=s.x1,c=s.x2,l=s.y1,h=s.y2,f=s.x,p=s.y,d=Qa(dk(wP(a,[t,e,n])),2),m=d[0],v=d[1];"line"===r.node().nodeName&&r.styles(Za({x1:u,x2:c,y1:l,y2:h},m)),i.attr(Za({x:f,y:p},v)),r.styles(m)}var oL={text:"",width:0,height:0,fill:"#4a505a",fontWeight:"bold",fontSize:12,fontFamily:"sans-serif",inset:0,spacing:0,position:"left-top"},aL=zk({text:"text"},"title");function sL(t){return/\S+-\S+/g.test(t)?t.split("-").map((function(t){return t[0]})).join(""):t.length>2?t[0]:t}function uL(t,e){var n=Object.entries(e).reduce((function(e,n){var r=Qa(n,2),i=r[0],o=r[1];return t.node().attr(i)||(e[i]=o),e}),{});t.styles(n)}var cL=function(t){function e(e){return void 0===e&&(e={}),t.call(this,Ek({},{style:oL},e))||this}return qa(e,t),e.prototype.getAvailableSpace=function(){var t,e=this.attributes,n=e.width,r=e.height,i=e.position,o=e.spacing,a=e.inset,s=this.querySelector(aL.text.class);if(!s)return{x:0,y:0,width:+n,height:+r};var u=s.getBBox().height,c=Qa(ak(o),3),l=c[0],h=c[2],f=Qa([0,+r-u],2),p=f[0],d=f[1],m=sL(i);if("i"===m)return{x:0,y:p,width:+n,height:+r};m.includes("t")&&(p=(t=Qa([u+l,+r-u-l],2))[0],d=t[1]),m.includes("b")&&(d=Qa([+r-u-h],1)[0]);var v=Qa(ak(a),4),g=v[0],y=v[1],x=v[2],b=v[3],_=Qa([b+y,g+x],2);return{x:b,y:p+g,width:+n-_[0],height:d-_[1]}},e.prototype.render=function(t,e){var n=t;n.width,n.height,n.position,n.spacing,n.class;var r=$a(n,["width","height","position","spacing","class"]),i=Qa(dk(r),1)[0],o=function(t){var e,n,r,i,o=t,a=o.width,s=o.height,u=o.position,c=Qa([+a/2,+s/2],2),l=Qa([+c[0],+c[1],"center","middle"],4),h=l[0],f=l[1],p=l[2],d=l[3],m=sL(u);return m.includes("l")&&(h=(e=Qa([0,"start"],2))[0],p=e[1]),m.includes("r")&&(h=(n=Qa([+a,"end"],2))[0],p=n[1]),m.includes("t")&&(f=(r=Qa([0,"top"],2))[0],d=r[1]),m.includes("b")&&(f=(i=Qa([+s,"bottom"],2))[0],d=i[1]),{x:h,y:f,textAlign:p,textBaseline:d}}(t),a=o.x,s=o.y,u=o.textAlign,c=o.textBaseline;r.text?gk(e).maybeAppendByClassName(aL.text,"text").styles(i).call(uL,{x:a,y:s,textAlign:u,textBaseline:c}):e.removeChildren()},e}(Hk);function lL(t,e,n){return function(t,e,n){var r=n.titlePosition,i=void 0===r?"lb":r,o=n.titleSpacing,a=void 0===o?0:o,s=sL(i),u=t.node().getBBox(),c=u.x,l=u.y,h=Qa(t.node().getBounds().halfExtents,2),f=h[0],p=h[1],d=Qa(e.node().getBounds().halfExtents,2),m=d[0],v=d[1],g=Qa([c+f,l+p],2),y=Qa([g[0],g[1]],2),x=y[0],b=y[1];return s.includes("l")&&(x-=f+m+a),s.includes("r")&&(x+=f+m+a),s.includes("t")&&(b-=p+v+a),s.includes("b")&&(b+=p+v+a),{x:x,y:b}}(t.select(bP.mainGroup.class),e,n)}function hL(t,e,n,r){if(n.title){var i=Qa(function(t,e){var n=e.title,r=t.maybeAppendByClassName(bP.title,(function(){return Pk(n)}));return[t,r]}(t,n),2),o=i[0];!function(t,e,n,r,i){var o=Qa(dk(i),2),a=o[0],s=o[1],u=s.transform,c=void 0===u?"":u,l=$a(s,["transform"]);t.styles(a);var h=lL(n,e,r),f=h.x,p=h.y;e.styles(l),e.node().setPosition(f,p),Nk(t,c)}(i[1],o,e,n,r)}}var fL,pL,dL,mL=Bk({render:function(t,e){var n=Uk(t),r=n.type,i=n.data;n.class;var o=n.dataThreshold,a=void 0===o?100:o;n.crossSize,n.animation,n.title;var s=n.showTitle;n.titleSpacing;var u=n.truncRange;n.truncShape;var c=n.showLine;n.lineExtension,n.lineArrow,n.lineArrowOffset,n.lineArrowSize;var l=n.showTick;n.tickDirection,n.tickLength,n.tickFilter,n.tickFormatter;var h=n.showLabel;n.labelAlign,n.labelDirection,n.labelSpacing,n.labelFilter,n.labelFormatter,n.labelTransforms;var f=n.showGrid;n.gridFilter,n.gridLength;var p=$a(n,["type","data","class","dataThreshold","crossSize","animation","title","showTitle","titleSpacing","truncRange","truncShape","showLine","lineExtension","lineArrow","lineArrowOffset","lineArrowSize","showTick","tickDirection","tickLength","tickFilter","tickFormatter","showLabel","labelAlign","labelDirection","labelSpacing","labelFilter","labelFormatter","labelTransforms","showGrid","gridFilter","gridLength"]),d=Qa(fk(function(){if("linear"===r){var t=p;return t.startPos,t.endPos,$a(t,["startPos","endPos"])}var e=p;return e.angleRange,e.radius,e.center,$a(e,["angleRange","radius","center"])}(),["title","line","tick","label","grid"]),5),m=d[0],v=d[1],g=d[2],y=d[3],x=d[4],b=function(t,e){if(t.length<=e)return t;for(var n=Math.floor(t.length/e),r=[],i=0;i<t.length;i+=n)r.push(t[i]);return r}(i,a).filter((function(t){var e=t.value;return!(u&&e>u[0]&&e<u[1])}));jk(f,gk(e).maybeAppendByClassName(bP.gridGroup,"g"),(function(e){return jP(e,b,t,x)}));var _=gk(e).maybeAppendByClassName(bP.mainGroup,"g");jk(c,_.maybeAppendByClassName(bP.lineGroup,"g"),(function(e){NP(e,t,v)})),jk(l,_.maybeAppendByClassName(bP.tickGroup,"g"),(function(e){!function(t,e,n,r){var i=SP(e,n.tickFilter);t.selectAll(".axis-tick").data(i).join((function(t){return t.append("g").attr("className",bP.tick.name).each((function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var o=rL.apply(void 0,ts(ts([gk(this)],Qa(t),!1),[i,n],!1));iL.apply(void 0,ts(ts([],Qa(t),!1),[i,o,this,n,r],!1))}))}),(function(t){return t.each((function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeChildren();var o=rL.apply(void 0,ts(ts([gk(this)],Qa(t),!1),[i,n],!1));iL.apply(void 0,ts(ts([],Qa(t),!1),[i,o,this,n,r],!1))}))}),(function(t){return t.remove()}))}(e,b,t,g)})),jk(h,_.maybeAppendByClassName(bP.labelGroup,"g"),(function(e){!function(t,e,n,r){var i=SP(e,n.labelFilter);t.selectAll(bP.label.class).data(i).join((function(e){return e.append("g").attr("className",bP.label.name).each((function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];JP.apply(void 0,ts(ts([gk(this)],Qa(t),!1),[i,n],!1)),QP.apply(void 0,ts(ts([],Qa(t),!1),[i,this,n,r],!1))})).call((function(){tL.call(t,n)}))}),(function(e){return e.each((function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var o=gk(this);o.node().removeChildren(),JP.apply(void 0,ts(ts([o],Qa(t),!1),[i,n],!1)),QP.apply(void 0,ts(ts([],Qa(t),!1),[i,this,n,r],!1))})).call((function(){tL.call(t,n)}))}),(function(t){return t.remove()}))}(e,b,t,y)})),jk(s,gk(e).maybeAppendByClassName(bP.titleGroup,"g"),(function(n){hL(n,gk(e),t,m)}))}},Za({},xP.style)),vL={effect:"linear",duration:200,orient:"horizontal",initPage:0,loop:!1,buttonPath:(fL=0,pL=0,dL=6,[["M",fL-dL,pL-dL],["L",fL+dL,pL],["L",fL-dL,pL+dL],["Z"]]),buttonFill:"black",buttonSize:12,buttonCursor:"pointer",formatter:function(t,e){return"".concat(t,"/").concat(e)},pageNumFontSize:12,pageNumFill:"black",pageNumTextAlign:"start",pageNumTextBaseline:"middle",controllerPadding:5,controllerSpacing:5},gL=zk({prevBtnGroup:"prev-btn-group",prevBtn:"prev-btn",nextBtnGroup:"next-btn-group",nextBtn:"next-btn",pageInfoGroup:"page-info-group",pageInfo:"page-info",playWindow:"play-window",contentGroup:"content-group",controller:"controller",clipPath:"clip-path"},"navigator"),yL=function(t){function e(e){var n=t.call(this,Ek({},{style:vL},e))||this;return n.finishedPromise=null,n.resolveFinishedPromise=null,n.playState="idle",n.contentGroup=n.appendChild(new Kf({class:gL.contentGroup.name})),n.playWindow=n.contentGroup.appendChild(new Kf({class:gL.playWindow.name})),n.innerCurrPage=n.defaultPage,n}return qa(e,t),Object.defineProperty(e.prototype,"defaultPage",{get:function(){var t=this.attributes.initPage;return Ks(void 0===t?0:t,0,Math.max(this.pageViews.length-1,0))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageViews",{get:function(){return this.playWindow.children},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageShape",{get:function(){var t=Qa(function(t){var e;return(null===(e=t[0])||void 0===e?void 0:e.map((function(e,n){return t.map((function(t){return t[n]}))})))||[]}(this.pageViews.map((function(t){var e=t.getBBox();return[e.width,e.height]}))).map((function(t){return Math.max.apply(Math,ts([],Qa(t),!1))})),2),e=t[0],n=t[1],r=this.attributes,i=r.pageWidth,o=void 0===i?e:i,a=r.pageHeight;return{pageWidth:o,pageHeight:void 0===a?n:a}},enumerable:!1,configurable:!0}),e.prototype.getContainer=function(){return this.playWindow},Object.defineProperty(e.prototype,"currPage",{get:function(){return this.innerCurrPage},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"finished",{get:function(){var t,e=this;return this.finishedPromise||(this.finishedPromise=new Promise((function(t){e.resolveFinishedPromise=function(){e.finishedPromise=null,t(e.currPage)}}))),"idle"===this.playState&&(null===(t=this.resolveFinishedPromise)||void 0===t||t.call(this)),this.finishedPromise},enumerable:!1,configurable:!0}),e.prototype.goTo=function(t){var e=this,n=this.attributes,r=n.duration,i=n.effect,o=this,a=o.currPage,s=o.playState;o.finished;var u=o.playWindow,c=o.pageViews;if("idle"!==s||t<0||c.length<=0||t>=c.length)return{finished:this.finished};c[a].setLocalPosition(0,0),this.prepareFollowingPage(t);var l={duration:r,easing:i,fill:"both"},h=Qa(this.getFollowingPageDiff(t),2),f=h[0],p=h[1];return this.playState="running",Promise.all([u.animate([{transform:"translate(0, 0)"},{transform:"translate(".concat(-f,", ").concat(-p,")")}],l)].map((function(t){return null==t?void 0:t.finished}))).then((function(){var n;e.innerCurrPage=t,e.playState="idle",e.setVisiblePages([t]),e.updatePageInfo(),null===(n=e.resolveFinishedPromise)||void 0===n||n.call(e)})),{finished:this.finished}},e.prototype.prev=function(){var t=this.attributes.loop,e=this.pageViews.length,n=this.currPage;if(!t&&n<=0)return{finished:this.finished};var r=t?(n-1+e)%e:Ks(n-1,0,e);return this.goTo(r)},e.prototype.next=function(){var t=this.attributes.loop,e=this.pageViews.length,n=this.currPage;if(!t&&n>=e-1)return{finished:this.finished};var r=t?(n+1)%e:Ks(n+1,0,e);return this.goTo(r)},e.prototype.renderClipPath=function(t){var e=this.pageShape,n=e.pageWidth,r=e.pageHeight;this.clipPath=t.maybeAppendByClassName(gL.clipPath,"rect").styles({width:n,height:r}),this.contentGroup.attr("clipPath",this.clipPath.node())},e.prototype.setVisiblePages=function(t){this.playWindow.children.forEach((function(e,n){t.includes(n)?e.attr("visibility","visible"):e.attr("visibility","hidden")}))},e.prototype.adjustControllerLayout=function(){var t=this,e=t.prevBtnGroup,n=t.nextBtnGroup,r=t.pageInfoGroup,i=this.attributes,o=i.orient,a=i.controllerPadding,s=r.getBBox(),u=s.width;s.height;var c=Qa("horizontal"===o?[-180,0]:[-90,90],2),l=c[0],h=c[1];e.setLocalEulerAngles(l),n.setLocalEulerAngles(h);var f=e.getBBox(),p=f.width,d=f.height,m=n.getBBox(),v=m.width,g=m.height,y=Math.max(p,u,v),x="horizontal"===o?{offset:[[0,0],[p/2+a,0],[p+u+2*a,0]],textAlign:"start"}:{offset:[[y/2,-d-a],[y/2,0],[y/2,g+a]],textAlign:"center"},b=Qa(x.offset,3),_=Qa(b[0],2),w=_[0],S=_[1],M=Qa(b[1],2),E=M[0],A=M[1],T=Qa(b[2],2),C=T[0],O=T[1],k=x.textAlign,P=r.querySelector("text");P&&(P.style.textAlign=k),e.setLocalPosition(w,S),r.setLocalPosition(E,A),n.setLocalPosition(C,O)},e.prototype.updatePageInfo=function(){var t,e=this,n=e.currPage,r=e.pageViews,i=e.attributes.formatter;r.length<2||(null===(t=this.pageInfoGroup.querySelector(gL.pageInfo.class))||void 0===t||t.attr("text",i(n+1,r.length)),this.adjustControllerLayout())},e.prototype.getFollowingPageDiff=function(t){var e=this.currPage;if(e===t)return[0,0];var n=this.attributes.orient,r=this.pageShape,i=r.pageWidth,o=r.pageHeight,a=t<e?-1:1;return"horizontal"===n?[a*i,0]:[0,a*o]},e.prototype.prepareFollowingPage=function(t){var e=this.currPage,n=this.pageViews;if(this.setVisiblePages([t,e]),t!==e){var r=Qa(this.getFollowingPageDiff(t),2),i=r[0],o=r[1];n[t].setLocalPosition(i,o)}},e.prototype.renderController=function(t){var e=this,n=this.attributes.controllerSpacing,r=this.pageShape,i=r.pageWidth,o=r.pageHeight,a=this.pageViews.length>=2,s=t.maybeAppendByClassName(gL.controller,"g").style("visibility",a?"visible":"hidden");if(a){var u=Qa(fk(this.attributes,["button","pageNum"]),2),c=u[0],l=u[1],h=Qa(dk(c),2),f=h[0],p=h[1],d=f.size,m=$a(f,["size"]),v=s.maybeAppendByClassName(gL.prevBtnGroup,"g").styles(p);this.prevBtnGroup=v.node();var g=v.maybeAppendByClassName(gL.prevBtn,"path"),y=s.maybeAppendByClassName(gL.nextBtnGroup,"g").styles(p);this.nextBtnGroup=y.node(),[g,y.maybeAppendByClassName(gL.nextBtn,"path")].forEach((function(t){t.styles(Za(Za({},m),{transformOrigin:"center"})),Gk(t.node(),d,!0)}));var x=s.maybeAppendByClassName(gL.pageInfoGroup,"g");this.pageInfoGroup=x.node(),x.maybeAppendByClassName(gL.pageInfo,"text").styles(Za(Za({},uk),l)),this.updatePageInfo(),s.node().setLocalPosition(i+n,o/2),v.on("click",(function(){e.prev()})),y.on("click",(function(){e.next()}))}},e.prototype.render=function(t,e){var n=gk(e);this.renderClipPath(n),this.renderController(n),this.setVisiblePages([this.defaultPage]),this.goTo(this.defaultPage)},e.prototype.bindEvents=function(){var t=this,e=function(t,e,n){var r;return function(){var i=this,o=arguments,a=function(){r=null,n||t.apply(i,o)},s=n&&!r;clearTimeout(r),r=setTimeout(a,e),s&&t.apply(i,o)}}((function(){return t.render(t.attributes,t)}),50);this.playWindow.addEventListener(Mf.INSERTED,e),this.playWindow.addEventListener(Mf.REMOVED,e)},e}(Hk);function xL(t,e,n){return void 0===t&&(t="horizontal"),"horizontal"===t?e:n}Jk.registerSymbol("hiddenHandle",(function(t,e,n){var r=1.4*n;return[["M",t-n,e-r],["L",t+n,e-r],["L",t+n,e+r],["L",t-n,e+r],["Z"]]})),Jk.registerSymbol("verticalHandle",(function(t,e,n){var r=1.4*n,i=n/2,o=n/6,a=t+.4*r;return[["M",t,e],["L",a,e+i],["L",t+r,e+i],["L",t+r,e-i],["L",a,e-i],["Z"],["M",a,e+o],["L",t+r-2,e+o],["M",a,e-o],["L",t+r-2,e-o]]})),Jk.registerSymbol("horizontalHandle",(function(t,e,n){var r=1.4*n,i=n/2,o=n/6,a=e+.4*r;return[["M",t,e],["L",t-i,a],["L",t-i,e+r],["L",t+i,e+r],["L",t+i,a],["Z"],["M",t-o,a],["L",t-o,e+r-2],["M",t+o,a],["L",t+o,e+r-2]]}));var bL=zk({layout:"flex",markerGroup:"marker-group",marker:"marker",labelGroup:"label-group",label:"label",valueGroup:"value-group",value:"value",backgroundGroup:"background-group",background:"background"},"legend-category-item"),_L={span:[1,1],marker:"path",markerD:Yk(6,6,6),markerFill:"#d3d2d3",markerSize:10,labelFill:"#646464",valueFill:"#646464",labelFontSize:12,valueFontSize:12,labelFontFamily:"sans-serif",valueFontFamily:"sans-serif",labelTextAlign:"start",valueTextAlign:"start",labelTextBaseline:"middle",valueTextBaseline:"middle"},wL=function(t){function e(e){return t.call(this,Ek({},{style:_L},e))||this}return qa(e,t),Object.defineProperty(e.prototype,"showValue",{get:function(){var t=this.attributes.value;return!!t&&($s(t)||Js(t)?""!==t:""!==t.attr("text"))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"actualSpace",{get:function(){var t=this.markerGroup,e=this.labelGroup,n=this.valueGroup,r=t.node().getBBox(),i=r.width,o=r.height,a=e.node().getBBox(),s=a.width,u=a.height,c=n.node().getBBox(),l=c.width,h=c.height;return{markerWidth:i,labelWidth:s,valueWidth:l,height:Math.max(o,u,h)}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"span",{get:function(){var t=this.attributes;if(!("span"in t))return[1,1];var e=Qa(ak(t.span),2),n=e[0],r=e[1],i=this.showValue?r:0,o=n+i;return[n/o,i/o]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shape",{get:function(){var t,e=this.attributes,n=e.markerSize,r=e.width,i=this.actualSpace,o=i.markerWidth,a=i.height,s=this.actualSpace,u=s.labelWidth,c=s.valueWidth,l=Qa(this.spacing,2),h=l[0],f=l[1];if(r){var p=r-n-h-f,d=Qa(this.span,2);u=(t=Qa([d[0]*p,d[1]*p],2))[0],c=t[1]}return{width:o+u+c+h+f,height:a,markerWidth:o,labelWidth:u,valueWidth:c}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"spacing",{get:function(){var t=this.attributes.spacing;if(!t)return[0,0];var e=Qa(ak(t),2),n=e[0],r=e[1];return this.showValue?[n,r]:[n,0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"layout",{get:function(){var t=this.shape,e=t.markerWidth,n=t.labelWidth,r=t.valueWidth,i=t.width,o=t.height,a=Qa(this.spacing,2),s=a[0];return{height:o,width:i,markerWidth:e,labelWidth:n,valueWidth:r,position:[e/2,e+s,e+n+s+a[1]]}},enumerable:!1,configurable:!0}),e.prototype.renderMarker=function(t){var e=this,n=this.attributes,r=n.marker,i=n.markerSize,o=hk(this.attributes,"marker");this.markerGroup=t.maybeAppendByClassName(bL.markerGroup,"g"),jk(!!r,this.markerGroup,(function(){e.markerGroup.maybeAppendByClassName(bL.marker,r).styles(Za({anchor:"0.5 0.5"},o)),Gk(e.markerGroup.node(),i,!0)}))},e.prototype.renderLabel=function(t){var e=this.attributes.label,n=hk(this.attributes,"label");this.labelGroup=t.maybeAppendByClassName(bL.labelGroup,"g"),this.labelGroup.maybeAppendByClassName(bL.label,(function(){return Pk(e)})).styles(n)},e.prototype.renderValue=function(t){var e=this,n=this.attributes.value,r=hk(this.attributes,"value");this.valueGroup=t.maybeAppendByClassName(bL.valueGroup,"g"),jk(this.showValue,this.valueGroup,(function(){e.valueGroup.maybeAppendByClassName(bL.value,(function(){return Pk(n)})).styles(r)}))},e.prototype.renderBackground=function(t){var e=this.shape,n=e.width,r=e.height,i=hk(this.attributes,"background");this.background=t.maybeAppendByClassName(bL.backgroundGroup,"g").style("zIndex",-1),this.background.maybeAppendByClassName(bL.background,"rect").styles(Za({width:n,height:r},i))},e.prototype.adjustLayout=function(){var t=this.layout;t.markerWidth;var e=t.labelWidth,n=t.valueWidth;t.width;var r=t.height,i=Qa(t.position,3),o=i[0],a=i[1],s=i[2],u=r/2;this.markerGroup.styles({x:o,y:u}),this.labelGroup.styles({x:a,y:u}),Vk(this.labelGroup.select(bL.label.class),e),this.showValue&&(this.valueGroup.styles({x:s,y:u}),Vk(this.valueGroup.select(bL.value.class),n))},e.prototype.render=function(t,e){var n=gk(e);this.renderMarker(n),this.renderLabel(n),this.renderValue(n),this.renderBackground(n),this.adjustLayout()},e}(Hk),SL=zk({page:"item-page",navigator:"navigator",item:"item"},"items"),ML={data:[],gridRow:1/0,gridCol:void 0,padding:0,width:1e3,height:100,rowPadding:0,colPadding:0,layout:"flex",orient:"horizontal",click:xu,mouseenter:xu,mouseleave:xu},EL=function(t,e,n){return void 0===n&&(n=!0),t?e(t):n},AL=function(t){function e(e){var n=t.call(this,Ek({},{style:ML},e))||this;return n.navigatorShape=[0,0],n}return qa(e,t),Object.defineProperty(e.prototype,"attrs",{get:function(){return Uk(this.attributes)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageViews",{get:function(){return this.navigator.getContainer()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"grid",{get:function(){var t=this.attrs,e=t.gridRow,n=t.gridCol,r=t.data;if(!e&&!n)throw new Error("gridRow and gridCol can not be set null at the same time");return e&&n?[e,n]:e?[e,r.length]:[r.length,n]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"renderData",{get:function(){var t=this.attrs,e=t.data,n=t.layout,r=hk(this.attrs,"item");return e.map((function(t,i){var o=t.id,a=void 0===o?i:o,s=t.label,u=t.value;return{id:"".concat(a),index:i,style:Za({layout:n,label:s,value:u},Object.fromEntries(Object.entries(r).map((function(n){var r=Qa(n,2);return[r[0],Fk(r[1],[t,i,e])]}))))}}))},enumerable:!1,configurable:!0}),e.prototype.getGridLayout=function(){var t=this,e=this.attrs,n=e.orient,r=e.width,i=e.rowPadding,o=e.colPadding,a=Qa(this.navigatorShape,1)[0],s=Qa(this.grid,2),u=s[0],c=s[1],l=c*u,h=0;return this.pageViews.children.map((function(e,s){var f,p,d=Math.floor(s/l),m=s%l,v=t.ifHorizontal(c,u),g=[Math.floor(m/v),m%v];"vertical"===n&&g.reverse();var y=Qa(g,2),x=y[0],b=y[1],_=(r-a-(c-1)*o)/c,w=e.getBBox().height,S=Qa([0,0],2),M=S[0],E=S[1];return"horizontal"===n?(M=(f=Qa([h,x*(w+i)],2))[0],E=f[1],h=b===c-1?0:h+_+o):(M=(p=Qa([b*(_+o),h],2))[0],E=p[1],h=x===u-1?0:h+w+i),{page:d,index:s,row:x,col:b,pageIndex:m,width:_,height:w,x:M,y:E}}))},e.prototype.getFlexLayout=function(){var t=this.attrs,e=t.width,n=t.height,r=t.rowPadding,i=t.colPadding,o=Qa(this.navigatorShape,1)[0],a=Qa(this.grid,2),s=a[0],u=a[1],c=Qa([e-o,n],2),l=c[0],h=c[1],f=Qa([0,0,0,0,0,0,0,0],8),p=f[0],d=f[1],m=f[2],v=f[3],g=f[4],y=f[5],x=f[6],b=f[7];return this.pageViews.children.map((function(t,e){var n,o,a,c,f=t.getBBox(),_=f.width,w=f.height,S=0===x?0:i,M=x+S+_;return M<=l&&EL(g,(function(t){return t<u}))?(n=Qa([x+S,b,M],3),p=n[0],d=n[1],x=n[2],{width:_,height:w,x:p,y:d,page:m,index:e,pageIndex:v++,row:y,col:g++}):(o=Qa([y+1,0,0,b+w+r],4),y=o[0],g=o[1],x=o[2],(b=o[3])+r+w<=h&&EL(y,(function(t){return t<s}))?(a=Qa([x,b,_],3),p=a[0],d=a[1],x=a[2],{width:_,height:w,x:p,y:d,page:m,index:e,pageIndex:v++,row:y,col:g++}):(c=Qa([0,0,_,0,m+1,0,0,0],8),p=c[0],d=c[1],x=c[2],b=c[3],m=c[4],v=c[5],y=c[6],g=c[7],{width:_,height:w,x:p,y:d,page:m,index:e,pageIndex:v++,row:y,col:g++}))}))},Object.defineProperty(e.prototype,"itemsLayout",{get:function(){this.navigatorShape=[0,0];var t="grid"===this.attributes.layout?this.getGridLayout:this.getFlexLayout,e=t.call(this);return e.slice(-1)[0].page>0?(this.navigatorShape=[55,0],t.call(this)):e},enumerable:!1,configurable:!0}),e.prototype.ifHorizontal=function(t,e){return xL(this.attrs.orient,t,e)},e.prototype.flattenPage=function(t){t.querySelectorAll(SL.item.class).forEach((function(e){t.appendChild(e)})),t.querySelectorAll(SL.page.class).forEach((function(e){t.removeChild(e).destroy()}))},e.prototype.renderItems=function(t){var e=this.attrs,n=e.click,r=e.mouseenter,i=e.mouseleave;this.flattenPage(t);var o=this.dispatchCustomEvent.bind(this);gk(t).selectAll(SL.item.class).data(this.renderData,(function(t){return t.id})).join((function(t){return t.append((function(t){var e=t.style;return new wL({style:e})})).attr("className",SL.item.name).on("click",(function(){null==n||n(this),o("itemClick",{item:this})})).on("mouseenter",(function(){null==r||r(this),o("itemMouseenter",{item:this})})).on("mouseleave",(function(){null==i||i(this),o("itemMouseleave",{item:this})}))}),(function(t){return t.each((function(t){var e=t.style;this.update(e)}))}),(function(t){return t.remove()}))},e.prototype.relayoutNavigator=function(){var t,e=this.attrs,n=e.layout,r=e.width,i=(null===(t=this.pageViews.children[0])||void 0===t?void 0:t.getBBox().height)||0,o=Qa(this.navigatorShape,2),a=o[0],s=o[1];this.navigator.update(Za({},"grid"===n?{pageWidth:r-a,pageHeight:i-s}:{}))},e.prototype.adjustLayout=function(){var t,e,n=this,r=Object.entries((t=this.itemsLayout,e="page",t.reduce((function(t,n){return(t[n[e]]=t[n[e]]||[]).push(n),t}),{}))).map((function(t){var e=Qa(t,2);return{page:e[0],layouts:e[1]}})),i=ts([],Qa(this.navigator.getContainer().children),!1);r.forEach((function(t){var e=t.layouts,r=n.pageViews.appendChild(new Kf({className:SL.page.name}));e.forEach((function(t){var e,n,o,a,s=t.x,u=t.y,c=t.index,l=t.width,h=t.height,f=i[c];r.appendChild(f),n=t,o=f,(a=$s(e="__layout__")?e.split("."):e).forEach((function(t,e){e<a.length-1?(Ws(o[t])||(o[t]=Js(a[e+1])?[]:{}),o=o[t]):o[t]=n})),f.update({x:s,y:u,width:l,height:h})}))})),this.relayoutNavigator()},e.prototype.renderNavigator=function(t){var e=this.attrs.orient,n=hk(this.attrs,"nav"),r=Za(Za({},n),{orient:e});return this.navigator=t.maybeAppendByClassName(SL.navigator,(function(){return new yL({})})).update(r).node(),this.navigator},e.prototype.render=function(t,e){var n=this.attributes.data;if(n&&0!==n.length){var r=this.renderNavigator(gk(e));this.renderItems(r.getContainer()),this.adjustLayout()}},e.prototype.dispatchCustomEvent=function(t,e){var n=new xf(t,{detail:e});this.dispatchEvent(n)},e}(Hk),TL={style:{padding:0,orient:"horizontal",backgroundFill:"transparent",titleText:"",showTitle:!0,titleSpacing:4,titlePosition:"left-top",titleFill:"#2C3542",titleFontWeight:"bold",titleFontFamily:"sans-serif",titleFontSize:12}},CL=pu({},TL,{style:{type:"category",items:[],maxCols:void 0,maxRows:void 0,spacing:[8,2],itemBackground:{padding:0,style:{fill:"transparent",active:{cursor:"pointer"}}},reverse:!1}}),OL=pu({},TL,{style:{type:"continuous",color:["#d0e3fa","#acc7f6","#8daaf2","#6d8eea","#4d73cd","#325bb1","#5a3e75","#8c3c79","#e23455","#e7655b"],slidable:!0,showHandle:!0,showLabel:!0,showIndicator:!0,labelSpacing:5,indicatorLabelFill:"white",indicatorLabelFontSize:12,indicatorBackgroundFill:"#262626"}}),kL=zk({title:"title",titleGroup:"title-group",items:"items",itemsGroup:"items-group",contentGroup:"content-group",ribbonGroup:"ribbon-group",ribbon:"ribbon",handlesGroup:"handles-group",startHandle:"start-handle",endHandle:"end-handle",labelGroup:"label-group",label:"label",indicator:"indicator"},"legend"),PL=function(t){function e(e){return t.call(this,Ek({},CL,e))||this}return qa(e,t),e.prototype.renderTitle=function(t,e,n){var r=this.attributes.showTitle,i=Qa(dk(hk(this.attributes,"title")),2),o=i[0],a=i[1];this.titleGroup=t.maybeAppendByClassName(kL.titleGroup,"g").styles(a),jk(!!r,this.titleGroup,(function(t){var r=Za({width:e,height:n},o);t.maybeAppendByClassName(kL.title,(function(){return new cL({style:r})})).update(r)}))},e.prototype.renderItems=function(t,e,n){var r=this,i=Qa(fk(this.attributes,["title"]),2),o=Qa(dk(i[1]),2),a=o[0],s=o[1],u=Za(Za({},a),{width:e,height:n});this.itemsGroup=t.maybeAppendByClassName(kL.itemsGroup,"g").styles(s),this.itemsGroup.maybeAppendByClassName(kL.items,(function(){return new AL({style:{data:[]}})})).update(u),Object.entries(u).forEach((function(t){var e=Qa(t,2),n=e[0],i=e[1];return r.itemsGroup.attr(n,i)}))},e.prototype.adjustLayout=function(){if(this.attributes.showTitle){var t=this.titleGroup.select(kL.title.class).node().getAvailableSpace(),e=t.x,n=t.y;this.itemsGroup.node().setLocalPosition(e,n)}},Object.defineProperty(e.prototype,"availableSpace",{get:function(){var t=this.attributes,e=t.showTitle,n=t.width,r=t.height;if(!e)return[n,r];var i=this.titleGroup.select(kL.title.class).node().getAvailableSpace();return[i.width,i.height]},enumerable:!1,configurable:!0}),e.prototype.render=function(t,e){var n=t.width,r=t.height,i=gk(e);this.renderTitle(i,n,r),this.renderItems.apply(this,ts([i],Qa(this.availableSpace),!1)),this.adjustLayout()},e}(Hk),LL={formatter:function(t){return t},padding:[2,4],position:"right",labelFill:"#fff",labelFontSize:12,labelTextBaseline:"middle",backgroundZIndex:-1,backgroundFill:"#262626",backgroundLineCap:"round",backgroundLineWidth:1,backgroundStroke:"#333"},RL=zk({background:"background",labelGroup:"label-group",label:"label"},"indicator"),IL=function(t){function e(e){void 0===e&&(e={});var n=t.call(this,Ek({},{style:Za({visibility:"hidden"},LL)},e))||this;return n.point=[0,0],n.group=n.appendChild(new Kf({})),n}return qa(e,t),e.prototype.renderBackground=function(){var t=this.style,e=t.position,n=Qa(ak(t.padding),4),r=n[0],i=n[1],o=n[2],a=n[3],s=this.label.node().getLocalBounds(),u=s.min,c=s.max,l=[[u[0]-a,u[1]-r],[c[0]+i,c[1]+o]],h=this.getPath(e,l),f=hk(this.attributes,"background");this.background=gk(this.group).maybeAppendByClassName(RL.background,"path").styles(Za(Za({},f),{path:h})),this.group.appendChild(this.label.node())},e.prototype.renderLabel=function(){var t=this.attributes,e=t.value,n=t.formatter,r=Qa(dk(hk(this.attributes,"label")),2),i=r[0],o=r[1];(this.label=gk(this.group).maybeAppendByClassName(RL.labelGroup,"g").styles(o),e)&&this.label.maybeAppendByClassName(RL.label,(function(){return Pk(n(e))})).style("text",n(e).toString()).selectAll("text").styles(Za(Za({},uk),i))},e.prototype.adjustLayout=function(){var t=Qa(this.point,2),e=t[0],n=t[1];this.group.attr("x",-e).attr("y",-n)},e.prototype.getPath=function(t,e){var n=this,r=Qa(e,2),i=Qa(r[0],2),o=i[0],a=i[1],s=Qa(r[1],2),u=s[0],c=s[1],l={top:[[o,a],[u,a]],right:[[u,a],[u,c]],bottom:[[u,c],[o,c]],left:[[o,c],[o,a]]},h={top:"bottom",right:"left",bottom:"top",left:"right"},f=Object.entries(l).map((function(e){var r=Qa(e,2),i=r[0],o=r[1];return i===h[t]?n.createCorner(o):[ts(["M"],Qa(o[0]),!1),ts(["L"],Qa(o[1]),!1)]}));return f.push([["Z"]]),f.flat().filter((function(t,e,n){return 0===e||"M"!==t[0]}))},e.prototype.createCorner=function(t,e){void 0===e&&(e=10);var n=wk.apply(void 0,ts([],Qa(t),!1)),r=Qa(t,2),i=Qa(r[0],2),o=i[0],a=i[1],s=Qa(r[1],2),u=s[0],c=s[1],l=Qa(n?[u-o,[o,u]]:[c-a,[a,c]],2),h=l[0],f=Qa(l[1],2),p=f[0],d=f[1],m=h/2,v=e*(h/Math.abs(h)),g=v/2,y=v*Math.sqrt(3)/2*.8,x=Qa([p,p+m-g,p+m,p+m+g,d],5),b=x[0],_=x[1],w=x[2],S=x[3],M=x[4];return n?(this.point=[w,a-y],[["M",b,a],["L",_,a],["L",w,a-y],["L",S,a],["L",M,a]]):(this.point=[o+y,w],[["M",o,b],["L",o,_],["L",o+y,w],["L",o,S],["L",o,M]])},e.prototype.bindEvents=function(){this.label.on(Mf.BOUNDS_CHANGED,this.renderBackground)},e.prototype.render=function(){this.renderLabel(),this.renderBackground(),this.adjustLayout()},e}(Hk),NL=zk({marker:"marker",labelGroup:"labelGroup",label:"label"},"handle"),DL=Bk({render:function(t,e){var n,r,i=t,o=i.orient,a=i.visibility,s=i.spacing,u=void 0===s?0:s,c=i.showLabel,l=i.formatter,h=i.markerSymbol,f=void 0===h?xL(o,"horizontalHandle","verticalHandle"):h,p=Qa(fk(t,["label","marker"]),2),d=p[0],m=p[1],v=d.text,g=$a(d,["text"]);if(!f||"hidden"===a)return null===(n=e.querySelector(NL.marker.class))||void 0===n||n.remove(),void(null===(r=e.querySelector(NL.label.class))||void 0===r||r.remove());var y=Za({symbol:f},m),x=gk(e).maybeAppend(NL.marker.name,(function(){return new Jk({})})).update(y);jk(c,gk(e).maybeAppendByClassName(NL.labelGroup,"g"),(function(t){var e=t.maybeAppendByClassName(NL.label,"text").styles(Za({text:l(v).toString()},g)),n=x.node().getBBox(),r=n.width,i=n.height,a=Qa(xL(o,[0,i+u,"center","top"],[r+u,0,"start","middle"]),4),s=a[0],c=a[1],h=a[2],f=a[3];e.node().setLocalPosition(s,c),e.style("textAlign",h).style("textBaseline",f)}))}},Za({},{markerSize:25,markerStroke:"#c5c5c5",markerFill:"#fff",markerLineWidth:1,labelFontSize:12,labelFill:"#c5c5c5",labelText:"",orient:"vertical",spacing:0,showLabel:!0,formatter:function(t){return t.toString()}}));function FL(t,e){var n=Qa(function(t,e){for(var n=1;n<t.length;n+=1){var r=t[n-1],i=t[n];if(e>=r&&e<=i)return[r,i]}return[e,e]}(t,e),2),r=n[0],i=n[1];return{tick:e>(r+i)/2?i:r,range:[r,i]}}var jL=zk({trackGroup:"background-group",track:"background",selectionGroup:"ribbon-group",selection:"ribbon",clipPath:"clip-path"},"ribbon");function BL(t){var e=t.orient,n=t.size,r=t.len;return xL(e,[r,n],[n,r])}function zL(t){var e=t.type,n=Qa(BL(t),2),r=n[0],i=n[1];return"size"===e?[["M",0,i],["L",0+r,0],["L",0+r,i],["Z"]]:[["M",0,i],["L",0,0],["L",0+r,0],["L",0+r,i],["Z"]]}function UL(t){return zL(t)}function VL(t){var e,n=t,r=n.orient,i=n.color,o=n.block,a=n.blocks;if(Bs(i)){e=new Array(20).fill(0).map((function(t,e,n){return i(e/(n.length-1))}))}else e=i;var s=e.length;return s?o?function(t,e,n){var r=Array.from(e),i=t+1;return new Array(i).fill(0).reduce((function(t,e,n){var o=r[n%r.length];return t+" ".concat(n/(i-1),":").concat(o).concat(n<i-1?" ".concat((n+1)/(i-1),":").concat(o):"")}),"l(".concat("horizontal"===n?"0":"270",")"))}(a,e,r):e.reduce((function(t,e,n){return t+" ".concat(n/(s-1),":").concat(e)}),"l(".concat(xL(r,"0","270"),")")):""}function GL(t){var e=t.orient,n=t.range;if(!n)return[];var r=Qa(BL(t),2),i=r[0],o=r[1],a=Qa(n,2),s=a[0],u=a[1],c=xL(e,s*i,0),l=xL(e,0,s*o),h=xL(e,u*i,i),f=xL(e,o,u*o);return[["M",c,l],["L",c,f],["L",h,f],["L",h,l],["Z"]]}var WL,HL,YL,XL,qL,ZL=Bk({render:function(t,e){var n=Qa(fk(t,["selection","track"]),2),r=n[0],i=n[1];!function(t,e,n){t.maybeAppendByClassName(jL.track,"path").styles(Za({path:zL(e)},n))}(gk(e).maybeAppendByClassName(jL.trackGroup,"g"),t,i),function(t,e,n){var r=VL(e),i=t.maybeAppendByClassName(jL.selection,"path").styles(Za({path:UL(e),fill:r},n)),o=i.maybeAppendByClassName(jL.clipPath,"path").styles({path:GL(e)}).node();i.style("clip-path",o)}(gk(e).maybeAppendByClassName(jL.selectionGroup,"g"),t,r)}},Za({},{type:"color",orient:"horizontal",size:30,range:[0,1],len:200,block:!1,blocks:0,color:["#fff","#000"],trackFill:"#e5e5e5"})),$L=hu((function(t){return{min:Math.min.apply(Math,ts([],Qa(t.map((function(t){return t.value}))),!1)),max:Math.max.apply(Math,ts([],Qa(t.map((function(t){return t.value}))),!1))}}),(function(t){return t.map((function(t){return t.id}))})),KL=function(t){function e(e){var n=t.call(this,Ek({},OL,e))||this;return n.eventToOffsetScale=new qA({}),n.innerRibbonScale=new qA({}),n.onHovering=function(t){var e=n.attributes,r=e.data,i=e.block;t.stopPropagation();var o=n.getValueByCanvasPoint(t);if(i){var a=FL(r.map((function(t){return t.value})),o).range;n.showIndicator((a[0]+a[1])/2,"".concat(a[0],"-").concat(a[1])),n.dispatchIndicated(o,a)}else{var s=n.getTickValue(o);n.showIndicator(s),n.dispatchIndicated(s)}},n.onDragStart=function(t){return function(e){e.stopPropagation(),n.attributes.slidable&&(n.target=t,n.prevValue=n.getTickValue(n.getValueByCanvasPoint(e)),document.addEventListener("mousemove",n.onDragging),document.addEventListener("touchmove",n.onDragging),document.addEventListener("mouseleave",n.onDragEnd),document.addEventListener("mouseup",n.onDragEnd),document.addEventListener("mouseup",n.onDragEnd),document.addEventListener("touchend",n.onDragEnd))}},n.onDragging=function(t){var e=n.target;n.updateMouse();var r=Qa(n.selection,2),i=r[0],o=r[1],a=n.getTickValue(n.getValueByCanvasPoint(t)),s=a-n.prevValue;"start"===e?i!==a&&n.updateSelection(a,o):"end"===e?o!==a&&n.updateSelection(i,a):"ribbon"===e&&0!==s&&(n.prevValue=a,n.updateSelection(s,s,!0))},n.onDragEnd=function(){n.style.cursor="default",document.removeEventListener("mousemove",n.onDragging),document.removeEventListener("touchmove",n.onDragging),document.removeEventListener("mouseup",n.onDragEnd),document.removeEventListener("touchend",n.onDragEnd)},n}return qa(e,t),e.prototype.render=function(t,e){var n=this,r=t;r.data;var i=r.width,o=r.height;r.orient,r.defaultValue,r.color,r.block,r.type,r.slidable,r.step;var a=r.showTitle;r.showHandle;var s=r.showLabel;r.showIndicator;var u=Qa(fk(Uk(t),["title","label","indicator","ribbon","handle"]),5),c=u[0];u[1];var l=u[2],h=u[3];u[4];var f=gk(e).maybeAppendByClassName(kL.title,(function(){return new cL({style:Za({width:i,height:o},c)})}));jk(a,gk(e),(function(t){}));var p=f.node().getAvailableSpace(),d=p.x,m=p.y;p.width,p.height;var v=gk(e).maybeAppendByClassName(kL.contentGroup,"g").styles({x:d,y:m}),g=v.maybeAppendByClassName(kL.ribbonGroup,"g");this.renderRibbon(g,h),this.handlesGroup=g.maybeAppendByClassName(kL.handlesGroup,"g"),this.renderHandles(),this.renderIndicator(v,l),jk(s,gk(e).maybeAppendByClassName(kL.labelGroup,"g").styles({x:d,y:m}),(function(t){n.renderLabel(t)}))},Object.defineProperty(e.prototype,"range",{get:function(){var t=this.attributes.data;return $L(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ribbonScale",{get:function(){var t=this.range,e=t.min,n=t.max;return this.innerRibbonScale.update({domain:[e,n],range:[0,1]}),this.innerRibbonScale},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ribbonRange",{get:function(){var t=Qa(this.selection,2),e=t[0],n=t[1],r=this.ribbonScale;return[r.map(e),r.map(n)]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selection",{get:function(){var t=this.range,e=t.min,n=t.max,r=this.attributes.defaultValue,i=Qa(void 0===r?[e,n]:r,2);return[i[0],i[1]]},enumerable:!1,configurable:!0}),e.prototype.ifHorizontal=function(t,e){return xL(this.style.orient,"function"==typeof t?t():t,"function"==typeof e?e():e)},e.prototype.renderRibbon=function(t,e){var n=this.attributes,r=n.type,i=n.orient,o=n.color,a=n.block,s=n.data;this.ribbon=t.maybeAppendByClassName(kL.ribbon,(function(){return new ZL({})})).update(Za({type:r,orient:i,color:o,block:a,blocks:s.length-1,range:this.ribbonRange},e))},e.prototype.renderHandles=function(){var t=this.attributes,e=t.showHandle,n=t.slidable,r=Qa(this.selection,2),i=r[0],o=r[1];this.startHandle=this.renderHandle("start",i),this.endHandle=this.renderHandle("end",o),e&&n?this.handlesGroup.style("visibility","visible"):this.handlesGroup.style("visibility","hidden")},e.prototype.renderHandle=function(t,e){var n=this.attributes.orient,r=hk(this.attributes,"handle");r.formatter;var i=$a(r,["formatter"]),o=this.handlesGroup.maybeAppendByClassName(kL.prefix("".concat(t,"-handle")),(function(){return new DL({})})).styles(Za({orient:n,labelText:e},i));return this.setHandlePosition(t,e),o},e.prototype.setHandlePosition=function(t,e){var n=this.attributes,r=n.ribbonSize,i=n.handleFormatter,o=this.getOffset(e),a=Qa(this.ifHorizontal([o,.7*r],[r/2,o]),2),s=a[0],u=a[1],c=this.handlesGroup.select(".".concat(kL.prefix("".concat(t,"-handle")))).node();null==c||c.attr("formatter",i);var l=Qa(c.getLocalPosition(),2),h=l[0],f=l[1];Math.abs(s+u-h-f)<100?null==c||c.setLocalPosition(s,u):null==c||c.animate([{transform:"translate(".concat(c.getLocalPosition().slice(0,2).join(","),")")},{transform:"translate(".concat(s,", ").concat(u,")")}],{duration:200,fill:"both"})},e.prototype.renderIndicator=function(t,e){this.indicator=t.maybeAppendByClassName(kL.indicator,(function(){return new IL({style:e})})).update(e)},Object.defineProperty(e.prototype,"labelData",{get:function(){var t=this,e=this.attributes,n=e.data,r=e.labelAlign;return n.reduce((function(e,n,i,o){var a,s,u=null!==(a=null==n?void 0:n.id)&&void 0!==a?a:i.toString();if("value"===r)e.push(Za(Za({},n),{id:u,label:null!==(s=null==n?void 0:n.label)&&void 0!==s?s:n.value.toString(),value:t.ribbonScale.map(n.value)}));else if(i<o.length-1){var c=o[i+1],l=Qa([n.value,c.value],2),h=l[0],f=l[1],p=(h+f)/2;e.push(Za(Za({},n),{id:u,range:[h,f],label:[h,f].join("~"),value:t.ribbonScale.map(p)}))}return e}),[])},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"labelStyle",{get:function(){var t=this.attributes,e=t.orient,n=t.labelDirection,r=void 0===n?"positive":n,i=Qa(["center","middle"],2),o=i[0],a=i[1];return"horizontal"===e?a="positive"===r?"top":"bottom":o="positive"===r?"end":"start",{labelTextAlign:o,labelTextBaseline:a}},enumerable:!1,configurable:!0}),e.prototype.renderLabel=function(t){var e=this.attributes,n=e.ribbonSize,r=e.ribbonLen,i=hk(this.attributes,"label"),o=i.spacing;i.align;var a=i.formatter,s=i.filter,u=$a(i,["spacing","align","formatter","filter"]),c=Qa(this.ifHorizontal([[0,n/2],[r,n/2]],[[n/2,0],[n/2,r]]),2),l=c[0],h=c[1],f=Za(Za({type:"linear",startPos:l,endPos:h,data:this.labelData,showLine:!1,showGrid:!1,showTick:!1,labelSpacing:o+n/2,labelTransform:"rotate(0)"},this.labelStyle),Object.fromEntries(Object.entries(u).map((function(t){var e,n=Qa(t,2),r=n[0],i=n[1];return["label".concat((e=r,e.charAt(0).toUpperCase()+e.slice(1))),i]})))),p=t.maybeAppendByClassName(kL.label,(function(){return new mL({style:f})})).styles(f).node();p.attr("labelFormatter",a),p.attr("labelFilter",s)},e.prototype.bindEvents=function(){var t,e,n=this,r=new Map;r.set("ribbon",this.ribbon),r.set("start",this.startHandle),r.set("end",this.endHandle),r.forEach((function(t,e){null==t||t.on("mousedown",n.onDragStart(e)),null==t||t.on("touchstart",n.onDragStart(e))})),null===(t=this.startHandle)||void 0===t||t.on("mouseover",(function(){return n.updateMouse()})),null===(e=this.endHandle)||void 0===e||e.on("mouseover",(function(){return n.updateMouse()})),this.ribbon.on("mousemove",this.onHovering),this.addEventListener("mouseout",this.hideIndicator)},e.prototype.showIndicator=function(t,e){var n;void 0===e&&(e="".concat(t));var r=this.attributes,i=r.orient;if(r.showIndicator&&"number"==typeof t){var o=this.range,a=o.min,s=o.max,u=Ks(t,a,s),c=[this.getOffset(u),0];"vertical"===i&&c.reverse(),this.indicator.update({visibility:"visible",position:this.ifHorizontal("top","left"),value:e}),(n=this.indicator.node()).setLocalPosition.apply(n,ts([],Qa(c),!1))}else this.hideIndicator()},e.prototype.hideIndicator=function(){var t;null===(t=this.indicator)||void 0===t||t.style("visibility","hidden")},e.prototype.updateMouse=function(){this.style.slidable&&(this.style.cursor="grabbing")},e.prototype.setSelection=function(t,e){this.updateSelection(t,e)},e.prototype.updateSelection=function(t,e,n){var r;void 0===n&&(n=!1);var i=Qa(this.selection,2),o=i[0],a=i[1],s=Qa([t,e],2),u=s[0],c=s[1];n&&(u+=o,c+=a);var l=this.range;r=Qa(function(t,e,n,r){var i;void 0===r&&(r=4);var o=Qa(t,2),a=o[0],s=o[1],u=Qa(e,2),c=u[0],l=u[1],h=Qa(n,2),f=h[0],p=h[1],d=Qa([c,l],2),m=d[0],v=d[1],g=v-m;return m>v&&(m=(i=Qa([v,m],2))[0],v=i[1]),g>s-a?[a,s]:m<a?f===a&&p===v?[a,v]:[a,g+a]:v>s?p===s&&f===m?[m,s]:[s-g,s]:[ok(m,r),ok(v,r)]}([l.min,l.max],[u,c],this.selection),2),u=r[0],c=r[1],this.update({defaultValue:[u,c]}),this.dispatchSelection()},Object.defineProperty(e.prototype,"step",{get:function(){var t=this.attributes.step,e=void 0===t?1:t,n=this.range,r=n.min,i=n.max;return ou(e)?ok(.01*(i-r),0):e},enumerable:!1,configurable:!0}),e.prototype.getTickValue=function(t){var e=this.attributes,n=e.data,r=e.block,i=this.range.min;return r?FL(n.map((function(t){return t.value})),t).tick:function(t,e,n){return n+Math.round((t-n)/e)*e}(t,this.step,i)},e.prototype.getValueByCanvasPoint=function(t,e){var n=this.range,r=n.min,i=n.max,o=Qa(this.ribbon.node().getPosition(),2),a=o[0],s=o[1],u=this.ifHorizontal(a,s),c=this.ifHorizontal.apply(this,ts([],Qa(mk(t)),!1))-u;return Ks(this.getOffset(c,!0)+r,r,i)},e.prototype.getOffset=function(t,e){void 0===e&&(e=!1);var n=this.range,r=n.min,i=n.max,o=this.attributes.ribbonLen,a=this.eventToOffsetScale;return a.update({domain:[r,i],range:[0,o]}),e?a.invert(t):a.map(t)},e.prototype.dispatchSelection=function(){var t=new xf("valuechange",{detail:{value:this.selection}});this.dispatchEvent(t)},e.prototype.dispatchIndicated=function(t,e){var n=new xf("indicate",{detail:{value:t,range:e}});this.dispatchEvent(n)},Ka([kk(100)],e.prototype,"dispatchSelection",null),Ka([kk(100)],e.prototype,"dispatchIndicated",null),e}(Hk);function JL(t){WL||(WL=document.createElement("table"),HL=document.createElement("tr"),YL=/^\s*<(\w+|!)[^>]*>/,XL={tr:document.createElement("tbody"),tbody:WL,thead:WL,tfoot:WL,td:HL,th:HL,"*":document.createElement("div")});var e=YL.test(t)&&RegExp.$1;e&&e in XL||(e="*");var n=XL[e];t="string"==typeof t?t.replace(/(^\s*)|(\s*$)/g,""):t,n.innerHTML=""+t;var r=n.childNodes[0];return r&&n.contains(r)&&n.removeChild(r),r}var QL="tooltip",tR="tooltip-title",eR="tooltip-list",nR="tooltip-list-item",rR="tooltip-list-item-name",iR="tooltip-list-item-marker",oR="tooltip-list-item-name-label",aR="tooltip-list-item-value",sR="tooltip-crosshair-x",uR="tooltip-crosshair-y",cR={overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"},lR=((qL={})[".".concat(QL)]={position:"absolute",visibility:"visible","z-index":8,transition:"visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1), left 0.4s cubic-bezier(0.23, 1, 0.32, 1), top 0.4s cubic-bezier(0.23, 1, 0.32, 1)","background-color":"rgba(255, 255, 255, 0.96)","box-shadow":"0 6px 12px 0 rgba(0, 0, 0, 0.12)","border-radius":"4px",color:"rgba(0, 0, 0, 0.65)","font-size":"12px","line-height":"20px",padding:"12px","min-width":"120px","max-width":"360px","font-family":"Roboto-Regular"},qL[".".concat(tR)]={color:"rgba(0, 0, 0, 0.45)"},qL[".".concat(eR)]={margin:"0px","list-style-type":"none",padding:"0px"},qL[".".concat(nR)]={"list-style-type":"none","margin-top":"12px",display:"flex","line-height":"1em","align-items":"center","justify-content":"space-between","white-space":"nowrap"},qL[".".concat(iR)]={width:"8px",height:"8px","border-radius":"50%",display:"inline-block","margin-right":"4px"},qL[".".concat(rR)]={display:"flex","align-items":"center","max-width":"216px"},qL[".".concat(oR)]=Za({flex:1},cR),qL[".".concat(aR)]=Za({display:"inline-block",float:"right",flex:1,"text-align":"right","min-width":"28px","margin-left":"30px",color:"rgba(0, 0, 0, 0.85)"},cR),qL[".".concat(sR)]={position:"absolute",width:"1px","background-color":"rgba(0, 0, 0, 0.25)"},qL[".".concat(uR)]={position:"absolute",height:"1px","background-color":"rgba(0, 0, 0, 0.25)"},qL),hR=function(t){function e(n){var r=t.call(this,pu({},e.defaultOptions,n))||this;return r.visibility="visible",r.initShape(),r.render(r.attributes,r),r}return qa(e,t),Object.defineProperty(e.prototype,"HTMLTooltipElement",{get:function(){return this.element},enumerable:!1,configurable:!0}),e.prototype.getContainer=function(){return this.element},Object.defineProperty(e.prototype,"position",{set:function(t){var e=Qa(t,2),n=e[0],r=e[1];this.attr({x:n,y:r}),this.updatePosition()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"elementSize",{get:function(){return{width:this.element.offsetWidth,height:this.element.offsetHeight}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"items",{get:function(){return this.attributes.items.map((function(t,e){var n=t.name,r=void 0===n?"":n,i=t.value,o=t.color,a=void 0===o?"black":o,s=t.index,u=$a(t,["name","value","color","index"]);return Za({name:r,value:i,color:a,index:null!=s?s:e},u)}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"HTMLTooltipItemsElements",{get:function(){var t=this.attributes.template,e=[];return this.items.forEach((function(n){var r,i;e.push(JL((r=t.item,i=n,r&&i?r.replace(/\\?\{([^{}]+)\}/g,(function(t,e){return"\\"===t.charAt(0)?t.slice(1):void 0===i[e]?"":i[e]})):r)))})),e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"customContent",{get:function(){var t=this.attributes.customContent;return $s(t)?Sk(t):au(t)?t:void 0},enumerable:!1,configurable:!0}),e.prototype.render=function(t,e){this.renderHTMLTooltipElement(),this.updatePosition()},e.prototype.update=function(t){this.attr(pu({},this.attributes,t)),this.render(this.attributes,this)},e.prototype.clear=function(){this.element.innerHTML=""},e.prototype.destroy=function(){var t,e;null===(t=this.element)||void 0===t||t.remove(),null===(e=this.customContent)||void 0===e||e.remove()},e.prototype.show=function(){this.visibility="visible",this.element.style.visibility="visible"},e.prototype.hide=function(){this.visibility="hidden",this.element.style.visibility="hidden"},e.prototype.initShape=function(){var t=this.attributes.template;this.element=JL(t.container),this.id&&this.element.setAttribute("id",this.id)},e.prototype.renderHTMLTooltipElement=function(){var t,e,n=this.attributes,r=n.title,i=n.enterable,o=this.element,a=this.customContent;if(this.element.style.pointerEvents=i?"auto":"none",this.clear(),a)o.appendChild(a);else{var s=this.attributes.template;r?(o.innerHTML=s.title,o.getElementsByClassName(tR)[0].innerHTML=r):null===(e=null===(t=o.getElementsByClassName(tR))||void 0===t?void 0:t[0])||void 0===e||e.remove();var u=this.HTMLTooltipItemsElements,c=document.createElement("ul");c.className=eR,u.forEach((function(t){c.appendChild(t)})),this.element.appendChild(c)}!function(t,e){Object.entries(e).forEach((function(e){var n=Qa(e,2),r=n[0],i=n[1];ts([t],Qa(t.querySelectorAll(r)),!1).filter((function(t){return t.matches(r)})).forEach((function(t){t&&(t.style.cssText+=Object.entries(i).reduce((function(t,e){return"".concat(t).concat(e.join(":"),";")}),""))}))}))}(o,this.attributes.style),this.element.style.visibility=this.visibility},e.prototype.getRelativeOffsetFromCursor=function(t){var e=this.attributes,n=e.position,r=e.offset,i=(t||n).split("-"),o={left:[-1,0],right:[1,0],top:[0,-1],bottom:[0,1]},a=this.elementSize,s=a.width,u=a.height,c=[-s/2,-u/2];return i.forEach((function(t){var e=Qa(c,2),n=e[0],i=e[1],a=Qa(o[t],2),l=a[0],h=a[1];c=[n+(s/2+r[0])*l,i+(u/2+r[1])*h]})),c},e.prototype.setOffsetPosition=function(t){var e=Qa(t,2),n=e[0],r=e[1],i=this.attributes,o=i.x,a=void 0===o?0:o,s=i.y,u=void 0===s?0:s,c=i.container,l=c.x,h=c.y;this.element.style.left="".concat(a+l+n,"px"),this.element.style.top="".concat(u+h+r,"px")},e.prototype.updatePosition=function(){this.setOffsetPosition(this.autoPosition(this.getRelativeOffsetFromCursor()))},e.prototype.autoPosition=function(t){var e=Qa(t,2),n=e[0],r=e[1],i=this.attributes,o=i.x,a=i.y,s=i.autoPosition,u=i.bounding;if(!s)return[n,r];var c=this.element,l=c.offsetWidth,h=c.offsetHeight,f=Qa([o+n,a+r],2),p=f[0],d=f[1],m=this.attributes.position,v={left:"right",right:"left",top:"bottom",bottom:"top"},g=u.x,y=u.y,x={left:p<g,right:p+l>g+u.width,top:d<y,bottom:d+h>y+u.height},b=[];m.split("-").forEach((function(t){x[t]?b.push(v[t]):b.push(t)}));var _=b.join("-");return this.getRelativeOffsetFromCursor(_)},e.tag="tooltip",e.defaultOptions={style:{x:0,y:0,visibility:"visible",title:"",position:"bottom-right",offset:[5,5],follow:!0,enterable:!1,autoPosition:!0,items:[],container:{x:0,y:0},bounding:{x:0,y:0,width:0,height:0},template:{container:'<div class="'.concat(QL,'"></div>'),title:'<div class="'.concat(tR,'"></div>'),item:'<li class="'.concat(nR,'" data-index={index}>\n        <span class="').concat(rR,'">\n          <span class="').concat(iR,'" style="background:{color}"></span>\n          <span class="').concat(oR,'" title="{name}">{name}</span>\n        </span>\n        <span class="').concat(aR,'" title="{value}">{value}</span>\n      </li>')},style:lR}},Ka([kk(100)],e.prototype,"updatePosition",null),e}(Hk),fR={default:{sizeStyle:{width:44,height:22,radius:11},tagStyle:{textStyle:{fontSize:12,lineHeight:16,fill:"#fff"},padding:0},markerStyle:{size:11}},small:{sizeStyle:{width:28,height:16,radius:8},tagStyle:{textStyle:{fontSize:10,lineHeight:14,fill:"#fff"},padding:0},markerStyle:{size:8}},mini:{sizeStyle:{width:20,height:14,radius:7},tagStyle:{textStyle:{fontSize:7,lineHeight:10,fill:"#fff"},padding:0},markerStyle:{size:7}}};function pR(t,e,n){void 0===e&&(e=0),void 0===n&&(n=!0);var r=Number(t.style.height)-2*e;return{x:n?Number(t.style.width)+Number(t.style.x)-e-r:Number(t.style.x)+e,y:Number(t.style.y)+e,width:r,height:r,radius:r/2}}!function(t){function e(n){return t.call(this,pu({},e.defaultOptions,n))||this}qa(e,t),e.prototype.render=function(t,e){var n=this,r=t.size,i=void 0===r?"default":r,o=t.spacing,a=t.disabled,s=t.checked,u=t.unCheckedChildren,c=t.checkedChildren,l=gk(e).maybeAppendByClassName("switch-content","g").node(),h=l.getLocalBounds(),f=vu(fR,i,fR.default),p=f.sizeStyle,d=f.tagStyle,m=a?"no-drop":"pointer",v=s?"#1890FF":"#00000040",g=p,y=s?c:u;(c||u)&&gk(l).maybeAppendByClassName("switch-tag",(function(){return new Qk({})})).call((function(t){var e=t.node();e.update(pu({cursor:m,backgroundStyle:null,text:!1,marker:!1},d,y));var n=null==e?void 0:e.getLocalBounds(),r=n.max,i=n.min,o=r[0]-i[0]+p.radius,a=r[1]-i[1],u=Math.max(o+p.height+2,p.width);g=Za(Za({},p),{width:u}),e.update(function(t,e,n,r){var i=e.width,o=e.height;return void 0===n&&(n=0),void 0===r&&(r=!0),{x:r?Number(t.x)+n:Number(t.width)+Number(t.x)-i,y:Number(t.y)+(Number(t.height)-o)/2}}({x:h.min[0],y:h.min[1],width:u,height:g.height},{width:o,height:a},g.radius,s))}));var x=gk(l).maybeAppendByClassName("switch-background","rect").styles(Za({zIndex:(l.style.zIndex||0)-1,x:h.min[0],y:h.min[1],fill:v,cursor:m,fillOpacity:a?.4:1},g)).node(),b=gk(l).maybeAppendByClassName("switch-background-stroke","rect").styles(Za({zIndex:(l.style.zIndex||0)-2,x:h.min[0],y:h.min[1],stroke:v,lineWidth:0},g)).node();gk(l).maybeAppendByClassName("switch-handle","rect").styles({fill:"#fff",cursor:m}).call((function(t){var e,r,i=t.node(),a=pR(x,o,s),u=pR(x,o,!s);i.attr("x")&&!mu(a,u)&&n.checked!==s?(i.attr(u),null===(e=i.getAnimations()[0])||void 0===e||e.cancel(),null===(r=b.getAnimations()[0])||void 0===r||r.cancel(),i.animate([{x:u.x},{x:a.x}],{duration:120,fill:"both"}),b.animate([{lineWidth:0,strokeOpacity:.5},{lineWidth:14,strokeOpacity:0}],{duration:400,easing:"ease-on"})):i.attr(a)})),this.checked=!!s},e.tag="switch",e.defaultOptions={style:{x:0,y:0,spacing:2,checked:!0,disabled:!1}}}(Hk);var dR={tagText:"",lineStroke:"#416180",lineStrokeOpacity:.45,lineLineWidth:1,lineLineDash:[5,5]},mR=Ek({},dR,{type:"line",tagPosition:"start",tagAlign:"center",tagVerticalAlign:"bottom"}),vR=Ek({},dR,{type:"circle",defaultRadius:0}),gR=Ek({},dR,{type:"polygon",defaultRadius:0,startAngle:0}),yR=function(t){function e(n){return t.call(this,pu({},e.defaultOptions,n))||this}return qa(e,t),Object.defineProperty(e.prototype,"localPointer",{get:function(){var t=Qa(this.getPosition(),2),e=t[0],n=t[1],r=Qa(this.pointer,2);return[r[0]-e,r[1]-n]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tagCfg",{get:function(){var t=hk(this.attributes,"tag");return t.position,$a(t,["position"])},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"crosshairCfg",{get:function(){var t=hk(this.attributes,"line");return Za(Za({},t),{path:this.crosshairPath})},enumerable:!1,configurable:!0}),e.prototype.render=function(t,e){var n=this,r=gk(e).maybeAppendByClassName(".crosshair-group","g").node();this.shapesGroup=r,this.tagShape=gk(r).maybeAppend(".crosshair-tag",(function(){return new Qk({className:"crosshair-tag",style:n.tagCfg})})).node(),this.crosshairShape=gk(r).maybeAppendByClassName(".crosshair-path","path").node().attr(this.crosshairCfg),this.adjustLayout()},e.prototype.update=function(t){void 0===t&&(t={}),this.attr(pu({},this.attributes,t)),this.render(this.attributes,this)},e.prototype.setPointer=function(t){this.pointer=t},e.tag="crosshair-base",e.defaultOptions={style:dR},e}(Hk);!function(t){function e(n){return t.call(this,Ek({},e.defaultOptions,n))||this}qa(e,t),Object.defineProperty(e.prototype,"crosshairPath",{get:function(){var t=this.attributes,e=Qa(t.startPos,2),n=e[0],r=e[1],i=Qa(t.endPos,2);return[["M",0,0],["L",i[0]-n,i[1]-r],["Z"]]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"localPointer",{get:function(){if(!this.pointer)return this.attributes.startPos;var t=Qa(this.getPosition(),2),e=t[0],n=t[1],r=Qa(this.pointer,2);return[r[0]-e,r[1]-n]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isVertical",{get:function(){var t=this.attributes,e=Qa(t.startPos,2),n=e[0],r=e[1],i=Qa(t.endPos,2),o=i[0],a=i[1];return n===o&&r!==a},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tagShapeSpace",{get:function(){var t=xk(this.tagShape);return{width:t.width,height:t.height}},enumerable:!1,configurable:!0}),e.prototype.update=function(e){t.prototype.update.call(this,e)},e.prototype.setPointer=function(e){t.prototype.setPointer.call(this,e),this.adjustPosition()},e.prototype.setText=function(t){this.tagShape.update({text:t}),this.adjustTag()},e.prototype.adjustLayout=function(){this.adjustPosition(),this.adjustTag()},e.prototype.adjustPosition=function(){var t=Qa(this.localPointer,2),e=t[0],n=t[1],r=Qa(this.attributes.startPos,2),i=r[0],o=r[1],a=this.getOrientVal([i,n],[e,o]);this.shapesGroup.setLocalPosition(a)},e.prototype.adjustTag=function(){var t=this.attributes,e=t.tagText,n=t.tagPosition,r=Qa(t.startPos,2),i=r[0],o=r[1],a=Qa(t.endPos,2),s=a[0],u=a[1];if(e&&""!==e){this.tagShape.show();var c=this.tagShapeSpace,l=c.width,h=c.height,f=Qa(this.getOrientVal({start:[-l/2,h/2],end:[s-i+l/2,h/2]},{start:[0,0],end:[0,u-o+h]})[n],2),p=f[0],d=f[1];this.tagShape.setLocalPosition(p,d)}else this.tagShape.hide()},e.prototype.getOrientVal=function(t,e){return this.isVertical?e:t},e.tag="line-crosshair",e.defaultOptions={style:mR},Ka([kk(20)],e.prototype,"setPointer",null)}(yR),function(t){function e(n){return t.call(this,Ek({},e.defaultOptions,n))||this}qa(e,t),Object.defineProperty(e.prototype,"crosshairPath",{get:function(){return this.createCirclePath()},enumerable:!1,configurable:!0}),e.prototype.update=function(e){t.prototype.update.call(this,e)},e.prototype.setPointer=function(e){var n=Qa(e,2),r=n[0],i=n[1];t.prototype.setPointer.call(this,[r,i]);var o=Qa(this.localPointer,2),a=o[0],s=o[1],u=Qa(this.attributes.center,2),c=u[0],l=u[1],h=this.createCirclePath(Math.pow(Math.pow(a-c,2)+Math.pow(s-l,2),.5));this.crosshairShape.attr({path:h})},e.prototype.adjustLayout=function(){this.tagShape.hide()},e.prototype.createCirclePath=function(t){var e=this.attributes,n=Qa(e.center,2),r=n[0],i=n[1],o=e.defaultRadius;return Yk(r,i,t||o)},e.tag="circle-crosshair",e.defaultOptions={style:vR},Ka([kk(20)],e.prototype,"setPointer",null)}(yR),function(t){function e(n){return t.call(this,Ek({},e.defaultOptions,n))||this}qa(e,t),Object.defineProperty(e.prototype,"crosshairPath",{get:function(){return this.createPolygonPath()},enumerable:!1,configurable:!0}),e.prototype.update=function(e){t.prototype.update.call(this,e)},Object.defineProperty(e.prototype,"points",{get:function(){for(var t=this.attributes,e=t.startAngle,n=t.sides,r=2*Math.PI/n,i=[1,0],o=[],a=0;a<n;a+=1)o.push(Ga([0,0],i,[0,0],e/180*Math.PI+r*a));return o},enumerable:!1,configurable:!0}),e.prototype.setPointer=function(e){var n=Qa(e,2),r=n[0],i=n[1];t.prototype.setPointer.call(this,[r,i]);var o=Qa(this.localPointer,2),a=o[0],s=o[1],u=this.attributes.center,c=Qa(this.intersection([a,s]),2),l=c[0],h=c[1];if(l&&h){var f=Ok(u,[a,s])/Ok(u,[l,h]),p=this.createPolygonPath(f);this.crosshairShape.attr({path:p})}},e.prototype.adjustLayout=function(){this.tagShape.hide()},e.prototype.createPolygonPath=function(t){var e=this.attributes,n=e.defaultRadius,r=Qa(e.center,2),i=r[0],o=r[1],a=this.points.map((function(e,r){var a=Qa(e,2),s=Qa(ja([0,0],[a[0],a[1]],t||n),2),u=s[0],c=s[1];return[0===r?"M":"L",i+u,o+c]}));return a.push(["Z"]),a},e.prototype.intersection=function(t){for(var e,n,r,i=Qa(t,2),o=i[0],a=i[1],s=this.points,u=Qa(this.attributes.center,2),c=u[0],l=u[1],h=1;h<=s.length;h+=1){var f=Qa(s[h-1],2),p=f[0],d=f[1],m=Qa(s[h%s.length],2),v=Ck([o,a],[c,l],[p+c,d+l],[m[0]+c,m[1]+l]);0!==v.length&&(n=(e=Qa(v,2))[0],r=e[1])}return[n,r]},e.tag="polygon-crosshair",e.defaultOptions={style:gR},Ka([kk(20)],e.prototype,"setPointer",null)}(yR);var xR=function(t){function e(n){var r=t.call(this,Ek({},e.defaultOptions,n))||this;return r.update({}),r}return qa(e,t),Object.defineProperty(e.prototype,"decorationType",{get:function(){var t=this.attributes.type;return t&&"none"!==t&&Gs(t)?t.map((function(t){return Gs(t)?t:[t,"solid"]})):"none"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"doubleSpacing",{get:function(){return 2*this.attributes.style.lineWidth},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hangingRate",{get:function(){return this.attributes.hangingRate},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dashedCfg",{get:function(){var t=this.attributes.style.lineWidth;return{lineDash:[2*t,t]}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dottedCfg",{get:function(){var t=this.attributes.style.lineWidth;return{lineDash:[t,t]}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"solidCfg",{get:function(){return{lineDash:[0,0]}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"decorationCfg",{get:function(){var t=this,e=this.attributes.style,n=this.decorationType;return"none"===n?[]:n.map((function(n){var r=Qa(n,2),i=r[0],o=r[1];if("wavy"===o)return Za({path:t.getWavyPath(i)},e);if("double"===o)return Za({path:t.getDoubleLinePath(i)},e);var a={solid:t.solidCfg,dashed:t.dashedCfg,dotted:t.dottedCfg};return Za(Za({path:t.getLinePath(i)},e),a[o])}))},enumerable:!1,configurable:!0}),e.prototype.update=function(t){var e=this;this.attr(Ek({},this.attributes,t)),this.clear(),this.decorationCfg.forEach((function(t){e.appendChild(new op({style:t}))}))},e.prototype.clear=function(){this.removeChildren()},e.prototype.getLinePos=function(t){var e,n,r,i=Qa(this.hangingRate,3),o=i[0],a=i[1],s=i[2],u=this.attributes,c=u.height,l=u.fontSize,h=Qa([0,0],2),f=h[0],p=h[1];return"overline"===t?(f=(e=Qa([0,c*o-l/2],2))[0],p=e[1]):"line-through"===t?(f=(n=Qa([0,c*a],2))[0],p=n[1]):(f=(r=Qa([0,c*s+l/2],2))[0],p=r[1]),[f,p]},e.prototype.getLinePath=function(t){var e=this.attributes.width,n=Qa(this.getLinePos(t),2),r=n[0],i=n[1];return[["M",r,i],["L",r+e,i]]},e.prototype.getDoubleLinePath=function(t){var e,n,r,i=this.doubleSpacing,o=this.attributes.width,a=Qa(this.getLinePos(t),2),s=a[0],u=a[1],c=Qa([0,0],2),l=c[0],h=c[1];return"line-through"===t&&(l=(e=Qa([-.5,.5],2))[0],h=e[1]),"underline"===t?(l=(n=Qa([0,1],2))[0],h=n[1]):"overline"===t&&(l=(r=Qa([1,0],2))[0],h=r[1]),[["M",s,u+i*l],["L",s+o,u+i*l],["M",s,u+i*h],["L",s+o,u+i*h]]},e.prototype.getWavyPath=function(t){return[]},e.tag="decoration",e.defaultOptions={style:{width:0,height:0,type:"none",hangingRate:[.5,.55,.5],style:{lineWidth:1,stroke:"#000"}}},e}(zf);!function(t){function e(n){var r=t.call(this,Ek({},e.defaultOptions,n))||this;return r.init(),r}qa(e,t),Object.defineProperty(e.prototype,"textWidth",{get:function(){var t=this;return qs(this.renderText.split("\n").map((function(e){return ek(e,t.font)})))||0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textHeight",{get:function(){return xk(this.textShape).height},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){var t=this.attributes.width;return"auto"===t||void 0===t||0===t?this.textWidth:t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){var t=this.attributes.height;return Js(t)&&0!==t?t:xk(this.textShape).height},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lineHeight",{get:function(){var t=this.attributes,e=t.lineHeight,n=t.fontSize;return e&&0!==e?e:n},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"capitalizeWord",{get:function(){return this.attributes.text.split("\n").map((function(t){return t.split(" ").map((function(t){return ik(t,"capitalize")})).join(" ")})).join("\n")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){var t=this.attributes,e=t.transform,n=t.text;return"capitalize"===e?this.capitalizeWord:ik(n,e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ellipsisText",{get:function(){var t=this,e=this.text,n=this.attributes,r=n.width,i=n.overflow,o="ellipsis"===i?"...":i;return e.split("\n").map((function(e){return nk(e,Js(r)?r:1/0,t.font,o)})).join("\n")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"renderText",{get:function(){var t=this.attributes.width,e=this.attributes.overflow;return e&&!["none","clip","wrap"].includes(e)&&Js(t)?this.ellipsisText:this.text},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"verticalAlign",{get:function(){return this.attributes.verticalAlign},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"font",{get:function(){return yu(this.attributes,["fontSize","fontFamily","fontWeight","fontStyle","fontVariant","letterSpacing","leading"])},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontColor",{get:function(){return this.attributes.fontColor},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"wordWrap",{get:function(){return"wrap"===this.attributes.overflow},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"wordWrapWidth",{get:function(){var t=this.width;return this.wordWrap?t:1/0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textCfg",{get:function(){var t=this,e=t.renderText,n=t.lineHeight,r=t.wordWrap,i=t.wordWrapWidth,o=t.fontColor;return Za(Za(Za({},uk),this.font),{fill:o,wordWrap:r,lineHeight:n,wordWrapWidth:i,text:e,textAlign:"start",textBaseline:"middle"})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"backgroundCfg",{get:function(){var t=this.width,e=this.height,n=this.attributes.backgroundStyle;return Za({x:0,y:0,width:t,height:e},n)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"decorationLineWidth",{get:function(){var t=this.attributes.fontSize;return Math.floor(2*Math.log10(t))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"decorationCfg",{get:function(){var t=this.attributes,e=t.decoration,n=t.fontSize,r=this.decorationLineWidth,i=this.fontColor;return this.textShape.getLineBoundingRects().map((function(t){return Ek({},{fontSize:n,style:{stroke:i,lineWidth:r}},e,t)}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clipRectCfg",{get:function(){var t=this.height;return{width:this.attributes.width,height:t}},enumerable:!1,configurable:!0}),e.prototype.init=function(){this.initShape(),this.update({})},e.prototype.update=function(t){this.attr(Ek({},this.attributes,t)),this.render()},e.prototype.render=function(){var t=this;this.clear(),this.backgroundShape.attr(this.backgroundCfg),this.textShape.attr(this.textCfg),this.layout(),this.decorationGroup.removeChildren(),this.decorationCfg.forEach((function(e){t.decorationGroup.appendChild(new xR({style:e}))}))},e.prototype.clear=function(){var t;this.backgroundShape.style.clipPath=null,null===(t=this.clipRect)||void 0===t||t.destroy()},e.prototype.initShape=function(){this.backgroundShape=new hp({name:"background",style:{width:0,height:0}}),this.decorationGroup=new Kf({name:"decoration-group"}),this.textShape=new pp({name:"text",style:this.textCfg}),this.textShape.appendChild(this.decorationGroup),this.backgroundShape.appendChild(this.textShape),this.appendChild(this.backgroundShape)},e.prototype.overflow=function(){var t=this.wordWrap,e=this.attributes,n=e.width,r=e.overflow;r&&"none"!==r&&!t&&Js(n)&&"clip"===r&&(this.clipRect=new hp({name:"clip-rect",style:this.clipRectCfg}),this.backgroundShape.style.clipPath=this.clipRect,this.backgroundShape.appendChild(this.clipRect))},e.prototype.adjustTextAlign=function(){var t=this.textWidth,e=this.attributes,n=e.width,r=e.textAlign;if(Js(n)){var i=0;i="start"===r?0:"center"===r?(this.width-t)/2:this.width-t,this.textShape.attr({x:i})}},e.prototype.adjustVerticalAlign=function(){var t=this.verticalAlign,e=this.textHeight,n=0;n="top"===t?e/2:"middle"===t?this.height/2:this.height-e/2,this.textShape.attr({y:n})},e.prototype.layout=function(){this.adjustTextAlign(),this.adjustVerticalAlign(),this.overflow()},e.tag="paragraph",e.defaultOptions={style:{text:"",fontColor:"#000",fontFamily:"sans-serif",fontSize:12,fontWeight:"normal",fontVariant:"normal",letterSpacing:0,leading:0,fontStyle:"normal",decoration:{type:"none",style:{}},overflow:"none",backgroundStyle:{},transform:"none",tooltip:!1,tooltipWait:300}}}(Hk);var bR,_R=Za(Za({},uk),{fill:"rgba(0,0,0,0.45)",fontSize:10,textAlign:"start",textBaseline:"middle",overflow:"clip"}),wR={default:{width:12,height:12,radius:2,stroke:"#dadada",lineWidth:1,fill:"#ffffff",cursor:"pointer"},selected:{width:12,height:12,radius:2,stroke:"#3471F9",lineWidth:1,fill:"#3471F9",cursor:"pointer"}},SR={path:[["M",3,6],["L","5","8.5"],["L","8.5","4"]],lineWidth:1,cursor:"pointer"};!function(t){function e(n){return t.call(this,pu({},e.defaultOptions,n))||this}qa(e,t),e.prototype.render=function(t,e){var n=t.label,r=t.boxStyle,i=t.checkedStyle,o=t.checked,a=t.spacing;this.checked=!!o;var s=yk(e,".checkbox-content","g").attr("className","checkbox-content").node(),u=uu({},this.checked?wR.selected:wR.default,r),c=uu({},SR,i);this.checkboxBoxShape=yk(s,".checkbox-box","rect").styles(Za({className:"checkbox-box",zIndex:(s.style.zIndex||0)-1},u)).node(),yk(this.checkboxBoxShape,".checkbox-checked","path").styles(Za({className:"checkbox-box-checked",stroke:"#fff"},c));var l=function(t,e){var n=t.getLocalBounds();return{x:n.halfExtents[0]?n.max[0]+(e||0):t.style.x,y:n.halfExtents[1]?(n.min[1]+n.max[1])/2:t.style.y}}(this.checkboxBoxShape,Number(a)),h=l.x,f=l.y;yk(s,".checkbox-label","text").styles(Za({className:"checkbox-label",x:h,y:f},n))},e.tag="checkbox",e.defaultOptions={style:{x:0,y:0,label:Za({text:""},_R),spacing:4,checked:!1}}}(Hk);var MR="gui-poptip",ER="gui-poptip-arrow",AR="gui-poptip-text",TR=((bR={})[".".concat(MR)]={visibility:"visible",position:"absolute","background-color":"rgba(0, 0, 0)","box-shadow":"0px 0px 10px #aeaeae","border-radius":"3px",color:"#fff",opacity:.8,"font-size":"12px",padding:"4px 6px",display:"flex","justify-content":"center","align-items":"center","z-index":8,transition:"visibility 50ms"},bR[".".concat(AR)]={"text-align":"center"},bR[".".concat(MR,"[data-position='top']")]={transform:"translate(-50%, -100%)"},bR[".".concat(MR,"[data-position='left']")]={transform:"translate(-100%, -50%)"},bR[".".concat(MR,"[data-position='right']")]={transform:"translate(0, -50%)"},bR[".".concat(MR,"[data-position='bottom']")]={transform:"translate(-50%, 0)"},bR[".".concat(MR,"[data-position='top-left']")]={transform:"translate(0,-100%)"},bR[".".concat(MR,"[data-position='top-right']")]={transform:"translate(-100%,-100%)"},bR[".".concat(MR,"[data-position='left-top']")]={transform:"translate(-100%, 0)"},bR[".".concat(MR,"[data-position='left-bottom']")]={transform:"translate(-100%, -100%)"},bR[".".concat(MR,"[data-position='right-top']")]={transform:"translate(0, 0)"},bR[".".concat(MR,"[data-position='right-bottom']")]={transform:"translate(0, -100%)"},bR[".".concat(MR,"[data-position='bottom-left']")]={transform:"translate(0, 0)"},bR[".".concat(MR,"[data-position='bottom-right']")]={transform:"translate(-100%, 0)"},bR[".".concat(ER)]={width:"4px",height:"4px",transform:"rotate(45deg)","background-color":"rgba(0, 0, 0)",position:"absolute","z-index":-1},bR[".".concat(MR,"[data-position='top']")]={transform:"translate(-50%, calc(-100% - 5px))"},bR["[data-position='top'] .".concat(ER)]={bottom:"-2px"},bR[".".concat(MR,"[data-position='left']")]={transform:"translate(calc(-100% - 5px), -50%)"},bR["[data-position='left'] .".concat(ER)]={right:"-2px"},bR[".".concat(MR,"[data-position='right']")]={transform:"translate(5px, -50%)"},bR["[data-position='right'] .".concat(ER)]={left:"-2px"},bR[".".concat(MR,"[data-position='bottom']")]={transform:"translate(-50%, 5px)"},bR["[data-position='bottom'] .".concat(ER)]={top:"-2px"},bR[".".concat(MR,"[data-position='top-left']")]={transform:"translate(0, calc(-100% - 5px))"},bR["[data-position='top-left'] .".concat(ER)]={left:"10px",bottom:"-2px"},bR[".".concat(MR,"[data-position='top-right']")]={transform:"translate(-100%, calc(-100% - 5px))"},bR["[data-position='top-right'] .".concat(ER)]={right:"10px",bottom:"-2px"},bR[".".concat(MR,"[data-position='left-top']")]={transform:"translate(calc(-100% - 5px), 0)"},bR["[data-position='left-top'] .".concat(ER)]={right:"-2px",top:"8px"},bR[".".concat(MR,"[data-position='left-bottom']")]={transform:"translate(calc(-100% - 5px), -100%)"},bR["[data-position='left-bottom'] .".concat(ER)]={right:"-2px",bottom:"8px"},bR[".".concat(MR,"[data-position='right-top']")]={transform:"translate(5px, 0)"},bR["[data-position='right-top'] .".concat(ER)]={left:"-2px",top:"8px"},bR[".".concat(MR,"[data-position='right-bottom']")]={transform:"translate(5px, -100%)"},bR["[data-position='right-bottom'] .".concat(ER)]={left:"-2px",bottom:"8px"},bR[".".concat(MR,"[data-position='bottom-left']")]={transform:"translate(0, 5px)"},bR["[data-position='bottom-left'] .".concat(ER)]={top:"-2px",left:"8px"},bR[".".concat(MR,"[data-position='bottom-right']")]={transform:"translate(-100%, 5px)"},bR["[data-position='bottom-right'] .".concat(ER)]={top:"-2px",right:"8px"},bR),CR=globalThis;function OR(t){var e=t&&document.getElementById(t);return e||((e=document.createElement("div")).setAttribute("id",t),document.body.appendChild(e)),e}function kR(t){var e,n,r=(e=OR,function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return n||(n=e.apply(CR,t)),n})(t);return r}!function(t){function e(n){var r=t.call(this,pu({style:{id:"gui-poptip"}},e.defaultOptions,n))||this;return r.visibility="visible",r.map=new Map,r.domStyles="",r.initShape(),r.render(r.attributes,r),r}qa(e,t),Object.defineProperty(e.prototype,"visible",{get:function(){return"visible"===this.visibility},enumerable:!1,configurable:!0}),e.prototype.render=function(t,e){this.visibility=this.style.visibility,this.updatePoptipElement()},e.prototype.update=function(t){this.attr(pu({},this.style,t)),this.render(this.attributes,this)},e.prototype.bind=function(t,e){var n=this;if(t){var r=this.style.text,i=function(i){var o=t,a=n.style,s=r;if(e){var u="function"==typeof e?e.call(null,i):e,c=u.html,l=u.target,h=$a(u,["html","target"]);a=uu({},n.style,h),(l||!1===l)&&(o=l),"string"==typeof c&&(s=c)}var f=a.position,p=a.arrowPointAtCenter,d=a.follow,m=a.offset;if(o){var v=i,g=Qa(function(t,e,n,r,i,o){if(void 0===i&&(i=!1),void 0===o&&(o=!1),o)return[t,e];var a=n.getBoundingClientRect(),s=a.x,u=a.y,c=a.width,l=a.height;switch(r){case"top":return i?[s+c/2,u]:[t,u];case"left":return i?[s,u+l/2]:[s,e];case"bottom":return i?[s+c/2,u+l]:[t,u+l];case"right":return i?[s+c,u+l/2]:[s+c,e];case"top-right":case"right-top":return[s+c,u];case"left-bottom":case"bottom-left":return[s,u+l];case"right-bottom":case"bottom-right":return[s+c,u+l];default:return[s,u]}}(v.clientX,v.clientY,o,f,p,d),2),y=g[0],x=g[1];n.showTip(y,x,{text:s,position:f,offset:m})}else n.hideTip()},o=function(){n.hideTip()};t.addEventListener("mousemove",i),t.addEventListener("mouseleave",o),this.map.set(t,[i,o])}},e.prototype.unbind=function(t){if(this.map.has(t)){var e=Qa(this.map.get(t)||[],2),n=e[0],r=e[1];n&&t.removeEventListener("mousemove",n),r&&t.removeEventListener("mouseleave",r),this.map.delete(t)}},e.prototype.clear=function(){this.container.innerHTML=""},e.prototype.destroy=function(){var t,e=this;ts([],Qa(this.map.keys()),!1).forEach((function(t){return e.unbind(t)})),null===(t=this.container)||void 0===t||t.remove()},e.prototype.showTip=function(t,e,n){var r=vu(n,"text");if((!r||"string"==typeof r)&&(this.applyStyles(),t&&e&&n)){var i=n.offset,o=n.position;if(o&&this.container.setAttribute("data-position",o),this.setOffsetPosition(t,e,i),"string"==typeof r){var a=this.container.querySelector(".".concat(AR));a&&(a.innerHTML=r)}this.visibility="visible",this.container.style.visibility="visible"}},e.prototype.hideTip=function(){this.visibility="hidden",this.container.style.visibility="hidden"},e.prototype.getContainer=function(){return this.container},e.prototype.getClassName=function(){var t=this.style.containerClassName;return"".concat(MR).concat(t?" ".concat(t):"")},e.prototype.initShape=function(){var t=this,e=this.style.id;this.container=kR(e),this.container.setAttribute("class",this.getClassName()),this.container.addEventListener("mousemove",(function(){return t.showTip()})),this.container.addEventListener("mouseleave",(function(){return t.hideTip()}))},e.prototype.updatePoptipElement=function(){var t=this.container;this.clear();var e=this.style,n=e.id,r=e.template,i=e.text;this.container.setAttribute("id",n),this.container.setAttribute("class",this.getClassName());var o='<span class="'.concat(ER,'"></span>');t.innerHTML=o,$s(r)?t.innerHTML+=r:r&&au(r)&&t.appendChild(r),i&&(t.getElementsByClassName(AR)[0].textContent=i),this.applyStyles(),this.container.style.visibility=this.visibility},e.prototype.applyStyles=function(){var t=Ek({},TR,this.style.domStyles),e=Object.entries(t).reduce((function(t,e){var n=Qa(e,2),r=n[0],i=n[1],o=Object.entries(i).reduce((function(t,e){var n=Qa(e,2),r=n[0],i=n[1];return"".concat(t).concat(r,": ").concat(i,";")}),"");return"".concat(t).concat(r,"{").concat(o,"}")}),"");if(this.domStyles!==e){this.domStyles=e;var n=this.container.querySelector("style");n&&this.container.removeChild(n),(n=document.createElement("style")).innerHTML=e,this.container.appendChild(n)}},e.prototype.setOffsetPosition=function(t,e,n){void 0===n&&(n=this.style.offset);var r=Qa(n,2),i=r[0],o=void 0===i?0:i,a=r[1],s=void 0===a?0:a;this.container.style.left="".concat(t+o,"px"),this.container.style.top="".concat(e+s,"px")},e.tag="poptip",e.defaultOptions={style:{x:0,y:0,width:0,height:0,target:null,visibility:"hidden",text:"",position:"top",follow:!1,offset:[0,0],domStyles:TR,template:'<div class="'.concat(AR,'"></div>')}}}(Hk);var PR=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};function LR(t,e,n,r){const[[i,o],[a,s]]=e,[u,c]=function(t){const{min:[e,n],max:[r,i]}=t.getLocalBounds();let o=0,a=0;return e>0&&(o=e),r<0&&(o=r),n>0&&(a=n),i<0&&(a=i),[o,a]}(t);if(i===a&&o===s)return xC()([[0,0],[u,c]]);const l=[[i-a,o-s]].concat(n).concat([[0,0]]),h=[r[0]-a,r[1]-s],[f,p]=l;if(((t,e,n)=>{const r=GC(t,e),i=GC(e,n),o=GC(n,t);return(Math.pow(r,2)+Math.pow(i,2)-Math.pow(o,2))/(2*r*i)})(h,f,p)>0){const e=(()=>{const{min:e,max:n}=t.getLocalBounds(),r=f[0]+(f[1]-h[1])*(f[1]-0)/(f[0]-h[0]);return n[0]<h[0]?Math.min(n[0],r):Math.max(e[0],r)})();l.splice(1,1,[e,0])}return xC()(l)}const RR=vO((t=>{const e=t.attributes,{class:n,transform:r,rotate:i,x:o,y:a,x0:s=o,y0:u=a,background:c,connector:l,startMarker:h,endMarker:f,coordCenter:p}=e,d=PR(e,["class","transform","rotate","x","y","x0","y0","background","connector","startMarker","endMarker","coordCenter"]),m=Mw(d,"background"),{padding:v}=m,g=PR(m,["padding"]),y=Mw(d,"connector"),{points:x=[]}=y,b=PR(y,["points"]),_=[[+s,+u],[+o,+a]],w=zC(t).maybeAppend("text","text").call(JC,d).node(),S=zC(t).maybeAppend("background","rect").style("zIndex",-1).call(JC,function(t,e=[]){const[n=0,r=0,i=n,o=r]=e,a=t.parentNode,s=a.getEulerAngles();a.setEulerAngles(0);const{min:u,halfExtents:c}=t.getLocalBounds(),[l,h]=u,[f,p]=c;return a.setEulerAngles(s),{x:l-o,y:h-n,width:2*f+o+r,height:2*p+n+i}}(w,v)).call(JC,c?g:{}).node(),M=LR(S,_,x,p),E=h&&new Jk({id:"startMarker",style:Object.assign({x:0,y:0},Mw(d,"startMarker"))}),A=f&&new Jk({id:"endMarker",style:Object.assign({x:0,y:0},Mw(d,"endMarker"))});zC(t).maybeAppend("connector","path").style("path",M).style("markerStart",E).style("markerEnd",A).call(JC,l?b:{})}));var IR=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const NR=t=>{const e=IR(t,[]);return(t,n,r,i)=>{const{mark:o,shape:a,defaultShape:s}=n,u=iO(i,o,a,s),{color:c,text:l="",fontSize:h,rotate:f=0,transform:p=""}=n,d={text:String(l),stroke:c,fill:c,fontSize:h},[[m,v]]=t;return zC(new RR).style("x",m).style("y",v).call(JC,u).style("transform",`${p}rotate(${+f}deg)`).style("coordCenter",r.getCenter()).call(JC,d).call(JC,e).node()}};NR.props={defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};var DR=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const FR=vO((t=>{const e=t.attributes,n=DR(e,["class","x","y"]),r=Mw(n,"marker"),{size:i=24}=r,o=()=>function(t){const e=t/Math.sqrt(2),n=t*Math.sqrt(2),[r,i]=[-e,e-n],[o,a]=[0,0],[s,u]=[e,e-n];return[["M",r,i],["A",t,t,0,1,1,s,u],["L",o,a],["Z"]]}(i/2),a=zC(t).maybeAppend("marker",(()=>new Jk({}))).call((t=>t.node().update(Object.assign({symbol:o},r)))).node(),[s,u]=function(t){const{min:e,max:n}=t.getLocalBounds();return[.5*(e[0]+n[0]),.5*(e[1]+n[1])]}(a);zC(t).maybeAppend("text","text").style("x",s).style("y",u).call(JC,n)})),jR=t=>{const e=DR(t,[]);return(t,n,r,i)=>{const{mark:o,shape:a,defaultShape:s}=n,u=iO(i,o,a,s),{color:c,text:l=""}=n,h={text:String(l),stroke:c,fill:c},[[f,p]]=t;return zC(new FR).call(JC,u).style("x",f).style("y",p).call(JC,h).call(JC,e).node()}};jR.props={defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};var BR=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const zR=vO((t=>{const{areaPath:e,connectPath:n,areaStyle:r,connectStyle:i}=t.attributes;zC(t).maybeAppend("connect-path",(()=>new op({}))).style("d",n).call(JC,i),zC(t).maybeAppend("area-path",(()=>new op({}))).style("d",e).call(JC,r)}));const UR=t=>{const{curve:e,gradient:n=!1,defined:r=(t=>!Number.isNaN(t)&&null!=t),connectNulls:i=!1}=t,o=BR(t,["curve","gradient","defined","connectNulls"]);return(t,a,s,u)=>{const{mark:c,shape:l,defaultShape:h}=a,f=iO(u,c,l,h),{fill:p}=f,d=BR(f,["fill"]),{color:m=p,seriesColor:v,seriesX:g,seriesY:y}=a,x=aO(s,a),b=n&&v?eO(v,g,y,n):m,_=Object.assign(Object.assign(Object.assign(Object.assign({},d),{stroke:b,fill:b}),x&&{transform:x}),o),[w,S]=function(t,e){const n=[],r=[],i=[];let o=!1,a=null;const s=t.length/2;for(let u=0;u<s;u++){const c=t[u],l=t[u+s];if([...c,...l].some((t=>!e(t))))o=!0;else{if(n.push(c),r.push(l),o&&a){o=!1;const[t,e]=a;i.push([t,c,e,l])}a=[c,l]}}return[n.concat(r),i]}(t,r),M=Mw(_,"connect"),E=!!S.length,A=t=>zC(new op({})).style("d",t).call(JC,_).node();if(C_(s)){const n=t=>{const n=s.getCenter(),i=t.slice(0,t.length/2),o=t.slice(t.length/2);return(a=bC().curve(_C),u=a.curve,c=a.lineX0,l=a.lineX1,h=a.lineY0,f=a.lineY1,a.angle=a.x,delete a.x,a.startAngle=a.x0,delete a.x0,a.endAngle=a.x1,delete a.x1,a.radius=a.y,delete a.y,a.innerRadius=a.y0,delete a.y0,a.outerRadius=a.y1,delete a.y1,a.lineStartAngle=function(){return MC(c())},delete a.lineX0,a.lineEndAngle=function(){return MC(l())},delete a.lineX1,a.lineInnerRadius=function(){return MC(h())},delete a.lineY0,a.lineOuterRadius=function(){return MC(f())},delete a.lineY1,a.curve=function(t){return arguments.length?u(SC(t)):u()._curve},a).angle(((t,e)=>HC(VC(i[e],n)))).outerRadius(((t,e)=>GC(i[e],n))).innerRadius(((t,e)=>GC(o[e],n))).defined(((t,e)=>[...i[e],...o[e]].every(r))).curve(e)(o);var a,u,c,l,h,f};return!E||i&&!Object.keys(M).length?A(n(w)):E&&!i?A(n(t)):zC(new zR).style("areaStyle",_).style("connectStyle",Object.assign(Object.assign({},M),o)).style("areaPath",n(t)).style("connectPath",S.map(n).join("")).node()}{const n=t=>{const n=t.slice(0,t.length/2),i=t.slice(t.length/2);return bC().x(((t,e)=>n[e][0])).y1(((t,e)=>n[e][1])).y0(((t,e)=>i[e][1])).defined(((t,e)=>[...n[e],...i[e]].every(r))).curve(e)(n)};return!E||i&&!Object.keys(M).length?A(n(w)):E&&!i?A(n(t)):zC(new zR).style("areaStyle",_).style("connectStyle",Object.assign(Object.assign({},M),o)).style("areaPath",n(t)).style("connectPath",S.map(n).join("")).node()}}};UR.props={defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const VR=t=>(e,n,r,i)=>{const o=C_(r)?NC:vC;return UR(Object.assign({curve:o},t))(e,n,r,i)};VR.props=Object.assign({},UR.props);var GR=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const WR=t=>{const{alpha:e=.5}=t,n=GR(t,["alpha"]);return(t,r,i,o)=>{const a=C_(i)?RC:PC;return UR(Object.assign({curve:a.alpha(e)},n))(t,r,i,o)}};WR.props=Object.assign({},UR.props);const HR=t=>(e,n,r,i)=>UR(Object.assign({curve:FC},t))(e,n,r,i);HR.props=Object.assign({},UR.props);var YR=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const XR=t=>{const{arrowSize:e}=t,n=YR(t,["arrowSize"]);return(t,r,i,o)=>{const{mark:a,shape:s,defaultShape:u}=r,c=iO(o,a,s,u),{stroke:l}=c,h=YR(c,["stroke"]),{color:f=l,transform:p}=r,[d,m]=t,v=iC();if(v.moveTo(...d),v.lineTo(...m),e){const[t,n]=QC(d,m,{arrowSize:e});v.moveTo(...m),v.lineTo(...t),v.moveTo(...m),v.lineTo(...n)}return zC(new op).call(JC,h).style("d",v.toString()).style("stroke",f).style("transform",p).call(JC,n).node()}};XR.props={defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};var qR=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const ZR=t=>{const e=qR(t,[]);return(t,n,r,i)=>{const{mark:o,shape:a,defaultShape:s}=n,u=iO(i,o,a,s),{stroke:c}=u,l=qR(u,["stroke"]),{color:h=c,transform:f}=n,[p,d]=t,m=iC();return m.moveTo(p[0],p[1]),m.bezierCurveTo(p[0]/2+d[0]/2,p[1],p[0]/2+d[0]/2,d[1],d[0],d[1]),zC(new op).call(JC,l).style("d",m.toString()).style("stroke",h).style("transform",f).call(JC,e).node()}};ZR.props={defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};var $R=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const KR=t=>{const{cornerRatio:e=1/3}=t,n=$R(t,["cornerRatio"]);return(t,r,i,o)=>{const{mark:a,shape:s,defaultShape:u}=r,c=iO(o,a,s,u),{stroke:l}=c,h=$R(c,["stroke"]),{color:f=l,transform:p}=r,[d,m]=t,v=function(t,e,n,r){const i=iC();if(C_(n)){const o=n.getCenter(),a=GC(t,o),s=(GC(e,o)-a)*r+a;return i.moveTo(t[0],t[1]),tO(i,t,e,o,s),i.lineTo(e[0],e[1]),i}return T_(n)?(i.moveTo(t[0],t[1]),i.lineTo(t[0]+(e[0]-t[0])*r,t[1]),i.lineTo(t[0]+(e[0]-t[0])*r,e[1]),i.lineTo(e[0],e[1]),i):(i.moveTo(t[0],t[1]),i.lineTo(t[0],t[1]+(e[1]-t[1])*r),i.lineTo(e[0],t[1]+(e[1]-t[1])*r),i.lineTo(e[0],e[1]),i)}(d,m,i,e);return zC(new op).call(JC,h).style("d",v.toString()).style("stroke",f).style("transform",p).call(JC,n).node()}};KR.props={defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};var JR=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const QR=t=>{const e=JR(t,[]);return(t,n,r,i)=>{const{mark:o,shape:a,defaultShape:s}=n,u=iO(i,o,a,s),{stroke:c}=u,l=JR(u,["stroke"]),{color:h=c,transform:f}=n,[p,d]=t,m=iC();if(m.moveTo(p[0],p[1]),C_(r)){const t=r.getCenter();m.quadraticCurveTo(t[0],t[1],d[0],d[1])}else{tO(m,p,d,XC(p,d),GC(p,d)/2)}return zC(new op).call(JC,l).style("d",m.toString()).style("stroke",h).style("transform",f).call(JC,e).node()}};QR.props={defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};var tI=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const eI=t=>{const e=tI(t,[]);return(t,n,r,i)=>{const{mark:o,shape:a,defaultShape:s}=n,u=iO(i,o,a,s),{stroke:c}=u,l=tI(u,["stroke"]),{color:h=c,src:f="",size:p=32,transform:d=""}=n,{width:m=p,height:v=p}=e,[[g,y]]=t,x=g-Number(m)/2,b=y-Number(v)/2;return zC(new ep).call(JC,l).style("x",x).style("y",b).style("width",p).style("height",p).style("img",f).style("stroke",h).style("transform",d).call(JC,e).node()}};eI.props={defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};var nI=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const rI=t=>{const e=nI(t,[]);return(t,n,r,i)=>{const{mark:o,shape:a,defaultShape:s,color:u,transform:c}=n,l=iO(i,o,a,s),{fill:h,stroke:f}=l,p=nI(l,["fill","stroke"]),d=function(t,e){const n=iC();if(C_(e)){const r=e.getCenter(),i=[...t,t[0]],o=i.map((t=>GC(t,r)));return i.forEach(((e,i)=>{if(0===i)return void n.moveTo(e[0],e[1]);const a=o[i],s=t[i-1],u=o[i-1];void 0!==u&&Math.abs(a-u)<1e-10?tO(n,s,e,r,a):n.lineTo(e[0],e[1])})),n.closePath(),n}return function(t,e){return e.forEach(((e,n)=>0===n?t.moveTo(e[0],e[1]):t.lineTo(e[0],e[1]))),t.closePath(),t}(n,t)}(t,r);return zC(new op).call(JC,p).style("d",d.toString()).style("stroke",u||f).style("fill",u||h).style("transform",c).call(JC,e).node()}};rI.props={defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};var iI=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const oI=t=>{const e=iI(t,[]);return(t,n,r,i)=>{const{mark:o,shape:a,defaultShape:s,color:u,transform:c}=n,l=iO(i,o,a,s),{fill:h,stroke:f}=l,p=iI(l,["fill","stroke"]),d=function(t,e){const[n,r,i,o]=t,a=iC();if(C_(e)){const t=e.getCenter(),s=GC(t,n);return a.moveTo(n[0],n[1]),a.quadraticCurveTo(t[0],t[1],i[0],i[1]),tO(a,i,o,t,s),a.quadraticCurveTo(t[0],t[1],r[0],r[1]),tO(a,r,n,t,s),a.closePath(),a}return a.moveTo(n[0],n[1]),a.bezierCurveTo(n[0]/2+i[0]/2,n[1],n[0]/2+i[0]/2,i[1],i[0],i[1]),a.lineTo(o[0],o[1]),a.bezierCurveTo(o[0]/2+r[0]/2,o[1],o[0]/2+r[0]/2,r[1],r[0],r[1]),a.lineTo(n[0],n[1]),a.closePath(),a}(t,r);return zC(new op).call(JC,p).style("d",d.toString()).style("fill",u||h).style("stroke",u||f).style("transform",c).call(JC,e).node()}};oI.props={defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};var aI=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const sI=t=>{const e=aI(t,[]);return(t,n,r,i)=>{const{mark:o,shape:a,defaultShape:s,color:u,transform:c}=n,l=iO(i,o,a,s),{fill:h,stroke:f}=l,p=aI(l,["fill","stroke"]),d=function(t,e){const n=iC();if(C_(e)){const r=e.getCenter(),[i,o]=r,a=WC(VC(t[0],r)),s=WC(VC(t[1],r)),u=GC(r,t[2]),c=GC(r,t[3]),l=GC(r,t[8]),h=GC(r,t[10]),f=GC(r,t[11]);n.moveTo(...t[0]),n.arc(i,o,u,a,s),n.arc(i,o,u,s,a,!0),n.moveTo(...t[2]),n.lineTo(...t[3]),n.moveTo(...t[4]),n.arc(i,o,c,a,s),n.lineTo(...t[6]),n.arc(i,o,h,s,a,!0),n.closePath(),n.moveTo(...t[8]),n.arc(i,o,l,a,s),n.arc(i,o,l,s,a,!0),n.moveTo(...t[10]),n.lineTo(...t[11]),n.moveTo(...t[12]),n.arc(i,o,f,a,s),n.arc(i,o,f,s,a,!0)}else n.moveTo(...t[0]),n.lineTo(...t[1]),n.moveTo(...t[2]),n.lineTo(...t[3]),n.moveTo(...t[4]),n.lineTo(...t[5]),n.lineTo(...t[6]),n.lineTo(...t[7]),n.closePath(),n.moveTo(...t[8]),n.lineTo(...t[9]),n.moveTo(...t[10]),n.lineTo(...t[11]),n.moveTo(...t[12]),n.lineTo(...t[13]);return n}(t,r);return zC(new op).call(JC,p).style("d",d.toString()).style("stroke",f).style("fill",u||h).style("transform",c).call(JC,e).node()}};sI.props={defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};var uI=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const cI=t=>{const e=uI(t,[]);return(t,n,r,i)=>{const{mark:o,shape:a,defaultShape:s}=n,u=iO(i,o,a,s),{stroke:c,lineWidth:l}=u,h=uI(u,["stroke","lineWidth"]),{color:f=c,size:p=l}=n,d=function(t,e){if(!C_(e))return xC().x((t=>t[0])).y((t=>t[1]))(t);const n=e.getCenter();return pC()({startAngle:0,endAngle:2*Math.PI,outerRadius:GC(t[0],n),innerRadius:GC(t[1],n)})}(t,r),m=function(t,e){if(!C_(t))return e;const[n,r]=t.getCenter();return`translate(${n}, ${r}) ${e||""}`}(r,n.transform);return zC(new op({})).call(JC,h).style("d",d).style("stroke",f).style("lineWidth",p).style("transform",m).call(JC,e).node()}};cI.props={defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};var lI=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};function hI(t,e,n){return[["M",t,e],["L",t+2*n,e-n],["L",t+2*n,e+n],["Z"]]}const fI=vO((t=>{const e=t.attributes,{points:n,class:r,endMarker:i=!0,direction:o}=e,a=lI(e,["points","class","endMarker","direction"]),s=Mw(a,"endMarker"),u=function(t){return xC().x((t=>t[0])).y((t=>t[1]))(t)}(n);zC(t).maybeAppend("connector","path").style("path",u).style("markerEnd",i?new Jk({className:"marker",style:Object.assign(Object.assign({},s),{symbol:hI})}):null).call(JC,a)}));const pI=t=>{const{offset:e=0,connectLength1:n}=t,r=lI(t,["offset","connectLength1"]);return(t,i,o,a)=>{const{mark:s,shape:u,defaultShape:c}=i,l=iO(a,s,u,c),{fill:h,stroke:f=h,connectLength1:p=n}=l,d=lI(l,["fill","stroke","connectLength1"]),{color:m,transform:v}=i,g=function(t,e,n,r=0){const[[i,o],[a,s]]=e;if(T_(t)){const t=i+n,e=t+r;return[[t,o],[e,o],[e,s],[a+n,s]]}const u=-n,c=o+u,l=c+-r;return[[i,c],[i,l],[a,l],[a,s+u]]}(o,t,e,p);return zC(new fI).call(JC,d).style("points",g).style("stroke",m||f).style("transform",v).call(JC,r).node()}};function dI(t,e,n,r){const{bounds:i}=n,[[o,a],[s,u]]=i,c=s-o,l=u-a,h=t=>{const{x:e,y:r}=t,i=Aw(n.x,c),s=Aw(n.y,l);return Object.assign(Object.assign({},t),{x:(i||e)+o,y:(s||r)+a})};return h("left"===t?{x:0,y:l/2,textAnchor:"start",textBaseline:"middle"}:"right"===t?{x:c,y:l/2,textAnchor:"end",textBaseline:"middle"}:"top"===t?{x:c/2,y:0,textAnchor:"center",textBaseline:"top"}:"bottom"===t?{x:c/2,y:l,textAnchor:"center",textBaseline:"bottom"}:"top-left"===t?{x:0,y:0,textAnchor:"start",textBaseline:"top"}:"top-right"===t?{x:c,y:0,textAnchor:"end",textBaseline:"top"}:"bottom-left"===t?{x:0,y:l,textAnchor:"start",textBaseline:"bottom"}:"bottom-right"===t?{x:c,y:l,textAnchor:"end",textBaseline:"bottom"}:{x:c/2,y:l/2,textAnchor:"center",textBaseline:"middle"})}function mI(t,e,n,r){const{y:i,y1:o,autoRotate:a,rotateToAlignArc:s}=n,u=r.getCenter(),c=rO(r,e,[i,o]),{innerRadius:l,outerRadius:h,startAngle:f,endAngle:p}=c,d="inside"===t?(f+p)/2:p,m=gI(d,a,s),v=(()=>{const[n,r]=e,i=l+.5*(h-l),[o,a]="inside"===t?vI(u,d,i):XC(n,r);return{x:o,y:a}})();return Object.assign(Object.assign({},v),{textAlign:"inside"===t?"center":"start",textBaseline:"middle",rotate:m})}function vI(t,e,n){return[t[0]+Math.sin(e)*n,t[1]-Math.cos(e)*n]}function gI(t,e,n){if(!e)return 0;const r=n?0:Math.sin(t)<0?90:-90;return t/Math.PI*180+r}function yI(t,e,n,r){const{y:i,y1:o,autoRotate:a,rotateToAlignArc:s,connector:u=!0,connectorLength2:c=0,connectorDistance:l=0,radius:h=.5,offset:f=0}=n,p=rO(r,e,[i,o]),{startAngle:d,endAngle:m}=p,v=r.getCenter(),g=(d+m)/2,[y,x]=(()=>{const e="inside"===t?h:1,{innerRadius:n,outerRadius:r}=p,i=n+(r-n)*e;return[i,i+f]})(),b=Math.sin(g)>0?1:-1,[_,w,...S]=((t,e)=>{const[n,r]=vI(v,g,t),[i,o]=vI(v,g,e),a=u?b*c:0;return[[n,r],[i+a,o],[-a,0]]})(y,x),M={connector:u,connectorPoints:S,dx:u?+l*b:0},E=(t,e="x",n="y")=>({[e]:t[0],[n]:t[1]});return Object.assign(Object.assign(Object.assign(Object.assign({},E(_,"x0","y0")),E(w)),((t,e)=>{const n=gI(g,a,s);return"inside"===t?{textAlign:"center",textBaseline:"middle",rotate:n}:{textAlign:e?"start":"end",textBaseline:"middle",rotate:n}})(t,b>0||O_(r))),M)}function xI(t,e,n,r){const{bounds:i}=n;if(1===i.length)return function(t,e,n,r){const{bounds:i}=n,[o]=i;return{x:o[0],y:o[1]}}(0,0,n);return(O_(r)?mI:R_(r)?yI:dI)(t,e,n,r)}pI.props={defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};var bI=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};var _I=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const wI=Object.freeze(Object.defineProperty({__proto__:null,area:function(t,e,n,r){const i=e.length/2,o=e.slice(0,i),a=e.slice(i);let s=g_(o,((t,e)=>Math.abs(t[1]-a[e][1])));s=Math.max(Math.min(s,i-2),1);const u=t=>[o[t][0],(o[t][1]+a[t][1])/2],c=u(s),l=u(s-1),h=WC(VC(u(s+1),l))/Math.PI*180;return{x:c[0],y:c[1],transform:`rotate(${h}deg)`,textAlign:"center",textBaseline:"middle"}},bottom:xI,bottomLeft:xI,bottomRight:xI,inside:xI,left:xI,outside:xI,right:xI,spider:function(t,e,n,r,i){if(!R_(r))return{};const{edgeDistance:o=0}=i,a=bI(yI("outside",e,n,r),[]),{x:s,width:u}=r.getOptions(),c=r.getCenter(),l=Aw(o,u),h=s+l,f=s+u-l,{x:p,x0:d,y0:m}=a,v=p<=c[0]?h-p:f-p;a.x+=v;const{x:g,y:y}=a,x=VC([d,m],c),b=VC([0,y],c),_=x[1]?x[0]*b[1]/x[1]+c[0]:g;return a.connectorPoints=[[_-g,0]],a},surround:function(t,e,n,r,i){if(!R_(r))return{};const{offset:o=12}=i,a=_I(yI("outside",e,n,r),[]),s=r.getCenter(),u=function(t){if(R_(t)){const[e,n]=t.getSize(),r=t.getOptions().transformations.find((t=>"polar"===t[0]));if(r)return Math.max(e,n)/2*r[4]}return 0}(r)+o,{x0:c,y0:l,connector:h,connectorLength2:f=0}=a,p=HC([c-s[0],l-s[1]]),d=h?f*(Math.sin(p)<0?-1:1):0,m=s[0]+Math.sin(p)*u,v=s[1]-Math.cos(p)*u;return a.x=m+d,a.y=v,a.connectorPoints=[[-d,0]],a},top:xI,topLeft:xI,topRight:xI},Symbol.toStringTag,{value:"Module"}));var SI=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};function MI(t,e,n,r,i){const{position:o}=e,a=function(t,e){return void 0!==t?t:R_(e)?"inside":T_(e)?"right":"top"}(o,n),s=r["inside"===a?"innerLabel":"label"],u=Object.assign({},s,e),c=wI[(l=a,l.replace(/-(\w)/g,(function(t,e){return e.toUpperCase()})))];var l;if(!c)throw new Error(`Unknown position: ${a}`);return Object.assign(Object.assign({},s),c(a,t,u,n,i))}const EI=t=>(e,n,r,i)=>{const{text:o,x:a,y:s}=n,u=SI(n,["text","x","y"]),c=MI(e,n,r,i,t),{rotate:l=0,transform:h=""}=c,f=SI(c,["rotate","transform"]);return zC(new RR).call(JC,f).style("text",`${o}`).style("transform",`${h}rotate(${+l}deg)`).style("coordCenter",r.getCenter()).call(JC,u).node()};EI.props={};var AI=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const TI=t=>{const{arrow:e,colorAttribute:n}=t,r=AI(t,["arrow","colorAttribute"]);return(t,e,i,o)=>{const{mark:a,shape:s,defaultShape:u}=e,c=iO(o,a,s,u),l=AI(c,["stroke"]),{d:h,color:f}=e;return zC(new op).call(JC,l).style("d",h).style(n,f).call(JC,r).node()}};TI.props={defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const CI=t=>TI(Object.assign({colorAttribute:"fill"},t));CI.props={defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const OI=t=>TI(Object.assign({fill:"none",colorAttribute:"stroke"},t));OI.props={defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};var kI=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const PI=t=>{const{render:e}=t,n=kI(t,["render"]);return(t,r,i,o)=>{const[[a,s]]=t;return e(Object.assign(Object.assign({},n),{x:a,y:s}))}};PI.props={defaultEnterAnimation:"fadeIn",defaultUpdateAnimation:"morphing",defaultExitAnimation:"fadeOut"};const LI="#000",RI="#fff",II="#416180",NI=t=>{const e="#5B8FF9",n={defaultColor:e,defaultCategory10:"category10",defaultCategory20:"category20",defaultSize:1,elementActiveStroke:LI,enter:{duration:300,fill:"both",delay:0},update:{duration:300,fill:"both",delay:0},exit:{duration:300,fill:"both",delay:0},viewFill:"transparent",plotFill:"transparent",mainFill:"transparent",contentFill:"transparent",line:{line:{fill:"",strokeOpacity:1,lineWidth:1,connectStroke:"#aaa"}},point:{point:{r:3,fillOpacity:.95,lineWidth:0},hollow:{r:3,fill:"",strokeOpacity:.95,lineWidth:1},plus:{r:3,fill:"",strokeOpacity:.95,lineWidth:3},diamond:{r:3,fill:"",strokeOpacity:.95,lineWidth:1}},interval:{rect:{fillOpacity:.95},hollow:{fill:"",strokeOpacity:1,lineWidth:2}},area:{area:{fillOpacity:.85,lineWidth:0,connectFill:LI,connectFillOpacity:.1}},polygon:{polygon:{fillOpacity:.95}},cell:{cell:{fillOpacity:.95},hollow:{fill:"",strokeOpacity:1,lineWidth:2}},rect:{rect:{fillOpacity:.95},hollow:{fill:"",strokeOpacity:1,lineWidth:2}},link:{link:{fill:"",strokeOpacity:1}},vector:{vector:{fillOpacity:1}},box:{box:{fillOpacity:.95,stroke:LI,lineWidth:1}},text:{text:{fill:"#1D2129",fontSize:12,strokeWidth:0,connectorStroke:II,connectorStrokeOpacity:.45,connectorLineWidth:1,backgroundFill:II,backgroundFillOpacity:.15,backgroundPadding:[2,4],startMarkerSymbol:"circle",startMarkerSize:4,endMarkerSymbol:"circle",endMarkerSize:4},badge:{fill:"#1D2129",fillOpacity:.65,strokeWidth:0,fontSize:10,textAlign:"center",textBaseline:"middle",markerFill:II,markerFillOpacity:.25,markerStrokeOpacity:0}},lineX:{line:{stroke:II,strokeOpacity:.45,lineWidth:1}},lineY:{line:{stroke:II,strokeOpacity:.45,lineWidth:1}},rangeX:{range:{fill:II,fillOpacity:.15,lineWidth:0}},rangeY:{range:{fill:II,fillOpacity:.15,lineWidth:0}},connector:{connector:{stroke:II,strokeOpacity:.45,lineWidth:1,connectLength1:12,endMarker:!0,endMarkerSize:6,endMarkerFill:II,endMarkerFillOpacity:.95}},interaction:{active:{line:{line:{lineWidth:3}},interval:{rect:{stroke:LI}},area:{area:{fillOpacity:.5}}},inactive:{area:{area:{fillOpacity:.3}}},selected:{},disabled:{}},axis:{titleFill:LI,titleFillOpacity:.65,titleFontSize:12,titleFontWeight:"normal",titleSpacing:12,lineStroke:LI,lineStrokeOpacity:.45,lineLineWidth:.5,lineArrow:null,tickStroke:LI,tickStrokeOpacity:.25,tickLineWidth:1,tickLength:4,labelFill:LI,labelFillOpacity:.65,labelFontSize:12,labelFontWeight:"lighter",labelSpacing:8,labelAlign:"horizontal",gridStroke:LI,gridStrokeOpacity:.05,gridLineWidth:.5,gridLineDash:[0,0],titleTransformOrigin:"center"},axisTop:{titlePosition:"top",titleSpacing:0,titleTextBaseline:"middle",labelSpacing:8,labelDirection:"negative",tickDirection:"negative",gridDirection:"positive"},axisBottom:{titleSpacing:10,titleTextBaseline:"bottom",labelSpacing:12,labelDirection:"positive",tickDirection:"positive",gridDirection:"negative"},axisLeft:{titleTextBaseline:"middle",titleSpacing:10,titlePosition:"left",titleTransformOrigin:"center",titleTransform:"translate(50%, 0) rotate(-90)",labelSpacing:4,labelDirection:"positive",labelAutoRotate:!1,tickDirection:"positive",gridDirection:"negative"},axisRight:{titleTextBaseline:"top",titleSpacing:0,titlePosition:"right",titleTransformOrigin:"center",titleTransform:"translate(-50%, 0) rotate(-90)",labelSpacing:4,labelDirection:"negative",tickDirection:"negative",gridDirection:"positive"},axisArcY:{titlePosition:"top",titleSpacing:0,titleTextBaseline:"bottom",gridDirection:"negative",gridConnect:"arc",gridControlAngles:[90,180,360],gridType:"surround",girdClosed:!0},legend:{padding:8,showTitle:!1,titleFill:LI,titleFillOpacity:.45,titleFontSize:12,titleFontWeight:"normal",titleSpacing:4,itemMarkerFill:e,itemMarkerFillOpacity:1,itemMarkerSize:8,itemSpacing:[5,8],itemLabelFill:LI,itemLabelFillOpacity:.65,itemLabelFontSize:12,itemLabelFontWeight:"normal",itemValueFill:LI,itemValueFillOpacity:.65,itemValueFontSize:12,itemValueFontWeight:"normal",itemBackgroundFill:"transparent",navButtonFill:LI,navButtonFillOpacity:.65,navPageNumFill:LI,navPageNumFillOpacity:.45,navPageNumFontSize:12,backgroundFill:"transparent"},continuousLegend:{labelFill:LI,labelFillOpacity:.45,labelFontSize:12,labelFontWeight:"normal",handleWidth:10,handleHeight:12,handleMarkerFill:LI,handleMarkerFillOpacity:.6,handleMarkerStroke:LI,handleMarkerStrokeOpacity:.25,handleMarkerLineWidth:1,handleLabelFill:LI,handleLabelFillOpacity:.45,handleLabelFontSize:12,handleLabelFontWeight:"normal"},label:{fill:LI,fillOpacity:.65,fontSize:12,fontWeight:"normal",stroke:null,offset:12,connectorStroke:LI,connectorStrokeOpacity:.45,connectorLineWidth:1,connectorLength2:8,connectorDistance:4},innerLabel:{fill:RI,fontSize:12,fillOpacity:.85,fontWeight:"normal",stroke:null,offset:0},slider:{trackSize:16,backgroundFill:II,backgroundFillOpacity:1,selectionFill:e,selectionFillOpacity:.15,handleIconSize:10,handleIconFill:"#f7f7f7",handleIconFillOpacity:1,handleIconStroke:LI,handleIconStrokeOpacity:.25,handleIconLineWidth:1,handleIconRadius:2,handleLabelFill:LI,handleLabelFillOpacity:.45,handleLabelFontSize:12,handleLabelFontWeight:"normal"},scrollbar:{},title:{fill:LI,fillOpacity:.85,fontSize:24,fontWeight:"bold",textBaseline:"top"},subtitle:{fill:LI,fillOpacity:.65,fontSize:10,fontWeight:"normal",textBaseline:"top"}};return Object.assign({},n,t)};NI.props={};const DI="#fff",FI="#000",jI="#416180",BI=t=>{const e="#5B8FF9",n={defaultColor:e,defaultCategory10:"category10",defaultCategory20:"category20",defaultSize:1,elementActiveStroke:DI,enter:{duration:300,fill:"both",delay:0},update:{duration:300,fill:"both",delay:0},exit:{duration:300,fill:"both",delay:0},viewFill:"#141414",plotFill:"transparent",mainFill:"transparent",contentFill:"transparent",line:{line:{fill:"",strokeOpacity:1,lineWidth:1,connectStroke:"#666"}},point:{point:{r:3,fillOpacity:.95,lineWidth:0},hollow:{r:3,fill:"",strokeOpacity:.95,lineWidth:1},plus:{r:3,fill:"",strokeOpacity:.95,lineWidth:3},diamond:{r:3,fill:"",strokeOpacity:.95,lineWidth:1}},interval:{rect:{fillOpacity:.95},hollow:{fill:"",strokeOpacity:1,lineWidth:2}},area:{area:{fillOpacity:.85,lineWidth:0,connectFill:DI,connectFillOpacity:.1}},polygon:{polygon:{fillOpacity:.95}},cell:{cell:{fillOpacity:.95},hollow:{fill:"",strokeOpacity:1,lineWidth:2}},rect:{rect:{fillOpacity:.95},hollow:{fill:"",strokeOpacity:1,lineWidth:2}},link:{link:{fill:"",strokeOpacity:1}},vector:{vector:{fillOpacity:1}},box:{box:{fillOpacity:.95,stroke:DI,lineWidth:1}},text:{text:{fill:DI,fillOpacity:.65,fontSize:12,strokeWidth:0,connectorStroke:jI,connectorStrokeOpacity:.45,connectorLineWidth:1,backgroundFill:jI,backgroundFillOpacity:.15,backgroundPadding:[2,4],startMarkerSymbol:"circle",startMarkerSize:4,endMarkerSymbol:"circle",endMarkerSize:4},badge:{fill:"#1D2129",fillOpacity:.65,strokeWidth:0,fontSize:10,textAlign:"center",textBaseline:"middle",markerFill:jI,markerFillOpacity:.25,markerStrokeOpacity:0}},lineX:{line:{stroke:jI,strokeOpacity:.45,lineWidth:1}},lineY:{line:{stroke:jI,strokeOpacity:.45,lineWidth:1}},rangeX:{range:{fill:jI,fillOpacity:.15,lineWidth:0}},rangeY:{range:{fill:jI,fillOpacity:.15,lineWidth:0}},connector:{connector:{stroke:jI,strokeOpacity:.45,lineWidth:1,connectLength1:12,endMarker:!0,endMarkerSize:6,endMarkerFill:jI,endMarkerFillOpacity:.95}},interaction:{active:{line:{line:{lineWidth:3}},interval:{rect:{stroke:DI}},area:{area:{fillOpacity:.5}}},inactive:{area:{area:{fillOpacity:.3}}},selected:{},disabled:{}},axis:{titleFill:DI,titleFillOpacity:.65,titleFontSize:12,titleFontWeight:"normal",titleSpacing:12,lineStroke:DI,lineStrokeOpacity:.45,lineLineWidth:.5,lineArrow:null,tickStroke:DI,tickStrokeOpacity:.25,tickLineWidth:1,tickLength:4,labelFill:DI,labelFillOpacity:.65,labelFontSize:12,labelFontWeight:"lighter",labelSpacing:8,labelAlign:"horizontal",gridStroke:DI,gridStrokeOpacity:.05,gridLineWidth:.5,gridLineDash:[0,0],titleTransformOrigin:"center"},axisTop:{titlePosition:"top",titleSpacing:0,titleTextBaseline:"middle",labelSpacing:8,labelDirection:"negative",tickDirection:"negative",gridDirection:"positive"},axisBottom:{titleSpacing:10,titleTextBaseline:"bottom",labelSpacing:12,labelDirection:"positive",tickDirection:"positive",gridDirection:"negative"},axisLeft:{titleTextBaseline:"middle",titleSpacing:10,titlePosition:"left",titleTransformOrigin:"center",titleTransform:"translate(50%, 0) rotate(-90)",labelSpacing:4,labelDirection:"positive",labelAutoRotate:!1,tickDirection:"positive",gridDirection:"negative"},axisRight:{titleTextBaseline:"top",titleSpacing:0,titlePosition:"right",titleTransformOrigin:"center",titleTransform:"translate(-50%, 0) rotate(-90)",labelSpacing:4,labelDirection:"negative",tickDirection:"negative",gridDirection:"positive"},axisArcY:{titlePosition:"top",titleSpacing:0,titleTextBaseline:"bottom",gridDirection:"negative",gridConnect:"arc",gridControlAngles:[90,180,360],gridType:"surround",girdClosed:!0},legend:{padding:8,showTitle:!1,titleFill:DI,titleFillOpacity:.45,titleFontSize:12,titleFontWeight:"normal",titleSpacing:4,itemMarkerFill:e,itemMarkerFillOpacity:1,itemMarkerSize:8,itemSpacing:[5,8],itemLabelFill:DI,itemLabelFillOpacity:.65,itemLabelFontSize:12,itemLabelFontWeight:"normal",itemValueFill:DI,itemValueFillOpacity:.65,itemValueFontSize:12,itemValueFontWeight:"normal",itemBackgroundFill:"transparent",navButtonFill:DI,navButtonFillOpacity:.45,navPageNumFill:DI,navPageNumFillOpacity:.45,navPageNumFontSize:12,backgroundFill:"transparent"},continuousLegend:{labelFill:DI,labelFillOpacity:.45,labelFontSize:12,labelFontWeight:"normal",handleWidth:10,handleHeight:12,handleMarkerFill:DI,handleMarkerFillOpacity:.6,handleMarkerStroke:DI,handleMarkerStrokeOpacity:.25,handleMarkerLineWidth:1,handleLabelFill:DI,handleLabelFillOpacity:.45,handleLabelFontSize:12,handleLabelFontWeight:"normal"},label:{fill:DI,fillOpacity:.65,fontSize:12,fontWeight:"normal",stroke:null,offset:12,connectorStroke:DI,connectorStrokeOpacity:.45,connectorLineWidth:1,connectorLength2:8,connectorDistance:4},innerLabel:{fill:FI,fontSize:12,fillOpacity:.85,fontWeight:"normal",stroke:null,offset:0},slider:{trackSize:16,backgroundFill:jI,backgroundFillOpacity:1,selectionFill:e,selectionFillOpacity:.15,handleIconSize:10,handleIconFill:"#f7f7f7",handleIconFillOpacity:1,handleIconStroke:DI,handleIconStrokeOpacity:.25,handleIconLineWidth:1,handleIconRadius:2,handleLabelFill:DI,handleLabelFillOpacity:.45,handleLabelFontSize:12,handleLabelFontWeight:"normal"},scrollbar:{},title:{fill:DI,fillOpacity:.85,fontSize:24,fontWeight:"bold",textBaseline:"top"},subtitle:{fill:DI,fillOpacity:.65,fontSize:10,fontWeight:"normal",textBaseline:"top"}};return Object.assign({},n,t)};BI.props={},BI.props={};const zI="#000",UI="#fff",VI="#888",GI=t=>{const e="#4e79a7",n={defaultColor:e,defaultCategory10:"tableau10",defaultCategory20:"tableau10",defaultSize:1,elementActiveStroke:zI,enter:{duration:300,fill:"both",delay:0},update:{duration:300,fill:"both",delay:0},exit:{duration:300,fill:"both",delay:0},viewFill:"transparent",plotFill:"transparent",mainFill:"transparent",contentFill:"transparent",line:{line:{fill:"",strokeOpacity:1,lineWidth:1,connectStroke:"#aaa"}},point:{point:{r:3,fillOpacity:.95,lineWidth:0},hollow:{r:3,fill:"",strokeOpacity:.95,lineWidth:1},plus:{r:3,fill:"",strokeOpacity:.95,lineWidth:3},diamond:{r:3,fill:"",strokeOpacity:.95,lineWidth:1}},interval:{rect:{fillOpacity:.95},hollow:{fill:"",strokeOpacity:1,lineWidth:2}},area:{area:{fillOpacity:.85,lineWidth:0,connectFill:zI,connectFillOpacity:.1}},polygon:{polygon:{fillOpacity:.95}},cell:{cell:{fillOpacity:.95},hollow:{fill:"",strokeOpacity:1,lineWidth:2}},rect:{rect:{fillOpacity:.95},hollow:{fill:"",strokeOpacity:1,lineWidth:2}},link:{link:{fill:"",strokeOpacity:1}},vector:{vector:{fillOpacity:1}},box:{box:{fillOpacity:.95,stroke:"#1D2129",lineWidth:1}},text:{text:{fill:"#1D2129",fontSize:10,strokeWidth:0,connectorStroke:VI,connectorStrokeOpacity:.45,connectorLineWidth:1,backgroundFill:VI,backgroundFillOpacity:.15,backgroundPadding:[2,4],startMarkerSymbol:"circle",startMarkerSize:4,endMarkerSymbol:"circle",endMarkerSize:4},badge:{fill:"#1D2129",fillOpacity:.65,strokeWidth:0,fontSize:10,textAlign:"center",textBaseline:"middle",markerFill:VI,markerFillOpacity:.25,markerStrokeOpacity:0}},lineX:{line:{stroke:VI,strokeOpacity:.45,lineWidth:1}},lineY:{line:{stroke:VI,strokeOpacity:.45,lineWidth:1}},rangeX:{range:{fill:VI,fillOpacity:.15,lineWidth:0}},rangeY:{range:{fill:VI,fillOpacity:.15,lineWidth:0}},connector:{connector:{stroke:VI,strokeOpacity:.45,lineWidth:1,connectLength1:12,endMarker:!0,endMarkerSize:6,endMarkerFill:VI,endMarkerFillOpacity:.95}},interaction:{active:{line:{line:{lineWidth:3}},interval:{rect:{stroke:zI}},area:{area:{fillOpacity:.5}}},inactive:{area:{area:{fillOpacity:.3}}},selected:{},disabled:{}},axis:{titleFill:zI,titleFillOpacity:1,titleFontSize:11,titleFontWeight:"bold",titleSpacing:12,line:!0,lineStroke:"#888",lineStrokeOpacity:1,lineLineWidth:1,lineArrow:null,tickStroke:VI,tickStrokeOpacity:1,tickLineWidth:1,tickLength:5,labelFill:zI,labelFillOpacity:1,labelFontSize:10,labelAutoRotate:!1,labelFontWeight:"normal",labelSpacing:4,labelAlign:"horizontal",gridStroke:"#ddd",gridStrokeOpacity:1,gridLineWidth:1,gridLineDash:[0,0],titleTransformOrigin:"center"},axisTop:{titlePosition:"top",titleSpacing:0,titleTextBaseline:"middle",labelDirection:"negative",tickDirection:"negative",gridDirection:"positive"},axisBottom:{titleSpacing:4,titleTextBaseline:"bottom",labelSpacing:8,labelDirection:"positive",tickDirection:"positive",gridDirection:"negative"},axisLeft:{titleTextBaseline:"middle",titleSpacing:4,titlePosition:"left",titleTransformOrigin:"center",titleTransform:"translate(50%, 0) rotate(-90) translate(0, -50%)",labelSpacing:4,labelDirection:"positive",tickDirection:"positive",gridDirection:"negative"},axisRight:{titleTextBaseline:"top",titleSpacing:0,titlePosition:"right",titleTransformOrigin:"center",titleTransform:"translate(-50%, 0) rotate(-90)",labelSpacing:4,labelDirection:"negative",tickDirection:"negative",gridDirection:"positive"},axisArcY:{titlePosition:"top",titleSpacing:0,titleTextBaseline:"bottom",gridDirection:"negative",gridConnect:"arc",gridControlAngles:[90,180,360],gridType:"surround",girdClosed:!0},legend:{padding:8,showTitle:!1,titleFill:zI,titleFillOpacity:1,titleFontSize:11,titleFontWeight:"bold",titleSpacing:4,itemMarkerFill:e,itemMarkerFillOpacity:1,itemMarkerSize:8,itemSpacing:[5,4],itemLabelFill:zI,itemLabelFillOpacity:1,itemLabelFontSize:10,itemLabelFontWeight:"normal",itemValueFill:zI,itemValueFillOpacity:1,itemValueFontSize:10,itemValueFontWeight:"normal",itemBackgroundFill:"transparent",navButtonFill:zI,navButtonFillOpacity:.45,navButtonSize:6,navPageNumFill:zI,navPageNumFillOpacity:.45,navPageNumFontSize:10,backgroundFill:"transparent"},continuousLegend:{showTitle:!1,labelFill:zI,labelFillOpacity:.45,labelFontSize:10,labelFontWeight:"normal",handleWidth:10,handleHeight:12,handleMarkerFill:zI,handleMarkerFillOpacity:.6,handleMarkerStroke:zI,handleMarkerStrokeOpacity:.25,handleMarkerLineWidth:1,handleLabelFill:zI,handleLabelFillOpacity:.45,handleLabelFontSize:10,handleLabelFontWeight:"normal"},label:{fill:zI,fillOpacity:.65,fontSize:10,fontWeight:"normal",stroke:null,offset:12,connectorStroke:zI,connectorStrokeOpacity:.45,connectorLineWidth:1,connectorLength2:8,connectorDistance:4},innerLabel:{fill:UI,fontSize:10,fillOpacity:.85,fontWeight:"normal",stroke:null,offset:0},slider:{trackSize:16,backgroundFill:VI,backgroundFillOpacity:.05,selectionFill:e,selectionFillOpacity:.15,handleIconSize:10,handleIconFill:"#f7f7f7",handleIconFillOpacity:1,handleIconStroke:zI,handleIconStrokeOpacity:.25,handleIconLineWidth:1,handleIconRadius:2,handleLabelFill:zI,handleLabelFillOpacity:.45,handleLabelFontSize:10,handleLabelFontWeight:"normal"},scrollbar:{},title:{fill:zI,fillOpacity:.85,fontSize:24,fontWeight:"bold",textBaseline:"top"},subtitle:{fill:zI,fillOpacity:.65,fontSize:10,fontWeight:"normal",textBaseline:"top"}};return Object.assign({},n,t)};function WI(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}GI.props={};var HI,YI=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function XI(t){if(!(e=YI.exec(t)))throw new Error("invalid format: "+t);var e;return new qI({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function qI(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function ZI(t,e){var n=WI(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}XI.prototype=qI.prototype,qI.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const $I={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>ZI(100*t,e),r:ZI,s:function(t,e){var n=WI(t,e);if(!n)return t+"";var r=n[0],i=n[1],o=i-(HI=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+WI(t,Math.max(0,e+o-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function KI(t){return t}var JI,QI,tN=Array.prototype.map,eN=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function nN(t){var e,n,r=void 0===t.grouping||void 0===t.thousands?KI:(e=tN.call(t.grouping,Number),n=t.thousands+"",function(t,r){for(var i=t.length,o=[],a=0,s=e[0],u=0;i>0&&s>0&&(u+s+1>r&&(s=Math.max(1,r-u)),o.push(t.substring(i-=s,i+s)),!((u+=s+1)>r));)s=e[a=(a+1)%e.length];return o.reverse().join(n)}),i=void 0===t.currency?"":t.currency[0]+"",o=void 0===t.currency?"":t.currency[1]+"",a=void 0===t.decimal?".":t.decimal+"",s=void 0===t.numerals?KI:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(tN.call(t.numerals,String)),u=void 0===t.percent?"%":t.percent+"",c=void 0===t.minus?"−":t.minus+"",l=void 0===t.nan?"NaN":t.nan+"";function h(t){var e=(t=XI(t)).fill,n=t.align,h=t.sign,f=t.symbol,p=t.zero,d=t.width,m=t.comma,v=t.precision,g=t.trim,y=t.type;"n"===y?(m=!0,y="g"):$I[y]||(void 0===v&&(v=12),g=!0,y="g"),(p||"0"===e&&"="===n)&&(p=!0,e="0",n="=");var x="$"===f?i:"#"===f&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",b="$"===f?o:/[%p]/.test(y)?u:"",_=$I[y],w=/[defgprs%]/.test(y);function S(t){var i,o,u,f=x,S=b;if("c"===y)S=_(t)+S,t="";else{var M=(t=+t)<0||1/t<0;if(t=isNaN(t)?l:_(Math.abs(t),v),g&&(t=function(t){t:for(var e,n=t.length,r=1,i=-1;r<n;++r)switch(t[r]){case".":i=e=r;break;case"0":0===i&&(i=r),e=r;break;default:if(!+t[r])break t;i>0&&(i=0)}return i>0?t.slice(0,i)+t.slice(e+1):t}(t)),M&&0==+t&&"+"!==h&&(M=!1),f=(M?"("===h?h:c:"-"===h||"("===h?"":h)+f,S=("s"===y?eN[8+HI/3]:"")+S+(M&&"("===h?")":""),w)for(i=-1,o=t.length;++i<o;)if(48>(u=t.charCodeAt(i))||u>57){S=(46===u?a+t.slice(i+1):t.slice(i))+S,t=t.slice(0,i);break}}m&&!p&&(t=r(t,1/0));var E=f.length+t.length+S.length,A=E<d?new Array(d-E+1).join(e):"";switch(m&&p&&(t=r(A+t,A.length?d-S.length:1/0),A=""),n){case"<":t=f+t+S+A;break;case"=":t=f+A+t+S;break;case"^":t=A.slice(0,E=A.length>>1)+f+t+S+A.slice(E);break;default:t=A+f+t+S}return s(t)}return v=void 0===v?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,v)):Math.max(0,Math.min(20,v)),S.toString=function(){return t+""},S}return{format:h,formatPrefix:function(t,e){var n=h(((t=XI(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(function(t){return(t=WI(Math.abs(t)))?t[1]:NaN}(e)/3))),i=Math.pow(10,-r),o=eN[8+r/3];return function(t){return n(i*t)+o}}}}function rN(t,e,n){return t.querySelector(e)?zC(t).select(e):zC(t).append(n)}function iN(t){return Array.isArray(t)?t.join(", "):`${t||""}`}JI=nN({thousands:",",grouping:[3],currency:["$",""]}),QI=JI.format,JI.formatPrefix;var oN=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};function aN(t){const{innerWidth:e,innerHeight:n}=t.getOptions();return[e,n]}function sN(t,e,n,r,i,o,a,s){var u;void 0===n&&void 0===o||t.update(Object.assign(Object.assign({},n&&{tickCount:n}),o&&{tickMethod:o}));const c=function(t,e,n){if(t.getTicks)return t.getTicks();if(!n)return e;const[r,i]=Zb(e,(t=>+t)),{tickCount:o}=t.getOptions();return n(r,i,o)}(t,e,o),l=i?c.filter(i):c,h=(null===(u=t.getFormatter)||void 0===u?void 0:u.call(t))||r,f=function(t,e){const n=e.getOptions(),{innerWidth:r,innerHeight:i,insetTop:o,insetBottom:a,insetLeft:s,insetRight:u}=n,[c,l,h]="left"===t||"right"===t?[o,a,i]:[s,u,r],f=new qA({domain:[0,1],range:[c/h,1-l/h]});return t=>f.map(t)}(a,s),p=function(t,e){const{width:n,height:r}=e.getOptions();return i=>{if(!L_(e))return i;const o="bottom"===t?[i,1]:[0,i],a=e.map(o);if("bottom"===t){const t=a[0];return new qA({domain:[0,n],range:[0,1]}).map(t)}if("left"===t){const t=a[1];return new qA({domain:[0,r],range:[0,1]}).map(t)}return i}}(a,s);if(C_(s)||T_(s)){const e=l.map(((e,n,r)=>{var i,o;const a=(null===(i=t.getBandWidth)||void 0===i?void 0:i.call(t,e))/2||0,u=f(t.map(e)+a);return{value:T_(s)&&(null===(o=t.getTicks)||void 0===o?void 0:o.call(t))?1-u:u,label:h(e,n,r),id:String(n)}}));return O_(s)&&"arcY"===a?function(t){return t.map((t=>{var{value:e}=t,n=oN(t,["value"]);return Object.assign({value:1-e},n)}))}(e):e}return l.map(((e,n,r)=>{var i;const o=(null===(i=t.getBandWidth)||void 0===i?void 0:i.call(t,e))/2||0;return{value:p(f(t.map(e)+o)),label:`${h((a=e,"number"!=typeof a||Math.abs(a)<1e-15?a:parseFloat(a.toFixed(15))),n,r)}`,id:String(n)};var a}))}function uN(t,e){const n=[];return t&&n.push({type:"hide"}),e&&n.push({type:"rotate",optionalAngles:[0,30,45,60,90]}),n}function cN(t,e,n){return!function(t){return C_(t)&&T_(t)}(e)&&!P_(e)&&(void 0===t?!!n.getTicks:t)}const lN=t=>{const{order:e,size:n,position:r,labelFormatter:i=(t=>`${t}`),tickFilter:o,tickCount:a,tickMethod:s,title:u,grid:c=!1}=t,l=oN(t,["order","size","position","labelFormatter","tickFilter","tickCount","tickMethod","title","grid"]);return(t,e,n,h)=>{const{domain:f,bbox:p}=e,{x:d,y:m,width:v,height:g}=p,y=[d+v/2,m+g/2],x=sN(t,f,a,i,o,s,r,n),b=Math.min(v,g)/2,[_,w]=function(t){const{transformations:e}=t.getOptions(),[,n,r]=e.find((t=>"polar"===t[0]));return[180*+n/Math.PI,180*+r/Math.PI]}(n),[S,M]=function(t){const{transformations:e}=t.getOptions(),[,,,n,r]=e.find((t=>"polar"===t[0]));return[+n,+r]}(n),E=function(t,e,n,r){const[i,o]=aN(r),a={titleFillOpacity:0,titlePosition:"inner",showLine:!1,showTick:!0,gridLength:(n-e)*(Math.min(i,o)/2)};return"arcInner"===t?(aN(r),Object.assign(Object.assign({},a),{labelAlign:"perpendicular",labelDirection:"positive",labelSpacing:4,tickDirection:"positive",gridDirection:"negative"})):Object.assign(Object.assign({},a),{labelAlign:"parallel",labelDirection:"negative",labelSpacing:8,tickDirection:"negative",gridDirection:"positive"})}(r,S,M,n),{axis:A}=h;return new mL({style:tx({},A,E,Object.assign({type:"arc",center:y,radius:b,angleRange:[_,w],data:x,title:iN(u),showGrid:c},l))})}};const hN=t=>{const{order:e,size:n,transform:r,position:i,title:o,labelFormatter:a=(t=>`${t}`),direction:s="left",tickCount:u,tickFilter:c,tickMethod:l}=t,h=oN(t,["order","size","transform","position","title","labelFormatter","direction","tickCount","tickFilter","tickMethod"]);return(t,e,n,r)=>{const{domain:f,bbox:p}=e,d=sN(t,f,u,a,c,l,i,n),m=function(t,e,n,r){const i="centerHorizontal"===n?"left":n,o=Object.assign({},e.axis,e[`axis${xw(i)}`]||e.axisTop);return"bottom"===n?Object.assign(Object.assign({},o),{titlePosition:t.getTicks?"right-bottom":"bottom",titleTransformOrigin:"center",titleTransform:t.getTicks?"translate(-100%, 0)":void 0}):"arcY"===n?Object.assign(Object.assign({},o),{labelDirection:"right"===r?"negative":"positive",labelTransform:"center"===r?"translate(50%, 0)":"",tickDirection:"right"===r?"negative":"positive",labelSpacing:"center"===r?0:4,tick:"center"!==r&&void 0}):o}(t,r,i,s),{labelAutoRotate:v=!0,labelAutoHide:g=!1,label:y=!0,tick:x=!0,line:b=!1,grid:_}=Object.assign({},m,h),w=cN(_,n,t),S=function(t,e){const[n,r]=aN(e);return"bottom"===t||"top"===t?r:n}(i,n),M=function(t,e,n){const[,r]=n.getCenter(),{x:i,y:o,width:a,height:s}=e;return"bottom"===t?{startPos:[i,o],endPos:[i+a,o]}:"left"===t||"centerHorizontal"===t?{startPos:[i+a,o],endPos:[i+a,o+s],showLine:"centerHorizontal"===t||void 0}:"right"===t?{endPos:[i,o+s],startPos:[i,o]}:"arcY"===t?{startPos:[i,o],endPos:[i+a,o+s],gridCenter:[e.x,r+e.y]}:{startPos:[i,o+s],endPos:[i+a,o+s],showLine:"centerVertical"===t||void 0}}(i,p,n),{showLine:E=b}=M,A=oN(M,["showLine"]),T=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},m),{type:"linear",data:d,title:iN(o),showLabel:y,labelTransforms:uN(g,v),showGrid:w,showTick:x,gridLength:S}),h),{showLine:!0}),E?null:{lineOpacity:0}),A);return new mL({style:T})}},fN=t=>{const{position:e,labelFormatter:n=(t=>`${t}`)}=t,r="string"==typeof n?QI(n):n,i=Object.assign(Object.assign({},t),{labelFormatter:r});return(t,n,r,o)=>"arc"===e||"arcInner"===e?lN(i)(t,n,r,o):hN(i)(t,n,r,o)};fN.props={defaultPosition:"left",defaultSize:45,defaultOrder:0};const pN=t=>fN(t);pN.props=Object.assign(Object.assign({},fN.props),{defaultPosition:"bottom"});const dN=t=>fN(t);dN.props=Object.assign(Object.assign({},fN.props),{defaultPosition:"left"});var mN=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const vN=t=>{const{order:e,size:n,position:r,labelFormatter:i=(t=>`${t}`),dx:o=0,dy:a=0,title:s,gridCol:u,gridRow:c}=t,l=mN(t,["order","size","position","labelFormatter","dx","dy","title","gridCol","gridRow"]);return(t,e,n,h)=>{const{domain:f,bbox:p}=e,{x:d,y:m,width:v,height:g}=p,y=f.map((e=>({id:e,label:i(e),value:"",color:t.map(e)}))),[x,b]=function(t,e,n){const[r,i]=[e||100,n||100];return{top:[1,i],bottom:[1,i],left:[r,1],right:[r,1],arcCenter:[r,1]}[t]||[e,n]}(r,c,u),_={data:y,x:d+o,y:m+a,orient:["right","left","arcCenter"].includes(r)?"vertical":"horizontal",width:v,height:g,gridCol:b,gridRow:x,rowPadding:0,colPadding:8,titleText:iN(s),itemMarkerFill:t=>t?t.color:"#fff"},{legend:w={}}=h;return new PL({className:"legend-category",style:Object.assign({},w,_,l)})}};vN.props={defaultPosition:"top",defaultOrder:1,defaultSize:40};var gN=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const yN=t=>{const{title:e}=t,n=gN(t,["title"]);return(t,r,i,o)=>{const{domain:a,bbox:s}=r,{x:u,y:c}=s,[l,h]=a,{continuousLegend:f={}}=o;return new KL({style:Object.assign({},f,{x:u,y:c,width:400,height:300,data:[{value:l},{value:h}],titleText:iN(e),titleFontSize:12,ribbonLen:120,ribbonSize:12,ribbonColor:a.map((e=>t.map(e))),showHandle:!1,showIndicator:!1,labelAlign:"value"},n)})}};yN.props={defaultPosition:"top",defaultOrder:1,defaultSize:40};const xN=(bN={render(t,e){const{text:n,style:r,subtitle:i,subtitleStyle:o}=t,a=rN(e,".title","text").attr("className","title").style("fontSize",14).style("textBaseline","top").style("text",n).call(JC,r||{}).node().getLocalBounds();rN(e,".sub-title","text").attr("className","sub-title").style("y",a.max[1]+((null==o?void 0:o.spacing)||0)).style("fontSize",12).style("textBaseline","top").call((t=>{if(!i)return t.node().remove();t.node().attr(Object.assign({text:i},o))}))}},class extends Wf{constructor(t){super(t),this.descriptor=bN}connectedCallback(){var t,e;null===(e=(t=this.descriptor).render)||void 0===e||e.call(t,this.attributes,this)}update(t={}){var e,n;this.attr(tx({},this.attributes,t)),null===(n=(e=this.descriptor).render)||void 0===n||n.call(e,this.attributes,this)}});var bN;const _N=t=>{const{text:e,style:n,subtitle:r,subtitleStyle:i}=t;return(t,o,a,s)=>{const{x:u,y:c}=o.bbox;return new xN({style:tx({},{style:s.title,subtitleStyle:s.subtitle},{x:u,y:c,style:n,text:e,subtitle:r,subtitleStyle:i})})}};_N.props={defaultPosition:"top",defaultOrder:2,defaultSize:30};var wN=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const SN=t=>{const{orient:e,labelFormatter:n,size:r}=t,i=wN(t,["orient","labelFormatter","size"]);return(t,r,o,a)=>{var s;const{bbox:u}=r,{x:c,y:l,width:h,height:f}=u,{slider:p={}}=a,d=(null===(s=t.getFormatter)||void 0===s?void 0:s.call(t))||(t=>t),m="string"==typeof n?QI(n):n;return new yP({className:"slider",style:Object.assign({},p,Object.assign({x:c,y:l,trackLength:"horizontal"===e?h:f,orient:e,formatter:e=>{const n=m||d,r=function(t,e){if(!t.getBandWidth)return t.invert(e);const n=t.adjustedRange,r=t=>Math.abs(t);return t.invert(function(t,e=zb){let n,r=!1;if(1===e.length){let i;for(const o of t){const t=e(o);(r?zb(t,i)<0:0===zb(t,t))&&(n=o,i=t,r=!0)}}else for(const i of t)(r?e(i,n)<0:0===e(i,i))&&(n=i,r=!0);return n}(n,((t,n)=>r(t-e)-r(n-e))))}(t,e);return n(r)}},i))})}};SN.props={defaultPosition:"bottom",defaultSize:24,defaultOrder:1};const MN=t=>SN(Object.assign(Object.assign({},t),{orient:"horizontal"}));MN.props=Object.assign(Object.assign({},SN.props),{defaultPosition:"bottom"});const EN=t=>SN(Object.assign(Object.assign({},t),{orient:"vertical"}));EN.props=Object.assign(Object.assign({},SN.props),{defaultPosition:"left"});let AN=class{constructor(t){this.$value=t}static of(t){return new AN(t)}call(t,...e){return this.$value=t(this.$value,...e),this}value(){return this.$value}};function TN(t,e,n){return AN.of({}).call(CN,t).call(CN,e).call(CN,n).value()}function CN(t,e){for(const[n,r]of Object.entries(e))void 0!==r&&(t[n]=e[n]);return t}function ON(t,e){const n={};for(const r of e){const e=t.style[r];e&&(n[r]=e)}return n}const kN=["fill","stroke","fillOpacity","strokeOpacity","opacity","lineWidth"],PN=t=>(e,n,r,i,o)=>{const[a]=e,{height:s}=a.getBoundingClientRect(),{transform:u,fillOpacity:c,strokeOpacity:l,opacity:h}=a.style,[f,p]=T_(i)?[[0,s],"scale(1, 0.0001)"]:[[0,0],"scale(0.0001, 1)"],d=[{transform:`${u} ${p}`.trimStart(),fillOpacity:0,strokeOpacity:0,opacity:0},{transform:`${u} ${p}`.trimStart(),fillOpacity:c,strokeOpacity:l,opacity:h,offset:.01},{transform:`${u} scale(1, 1)`.trimStart(),fillOpacity:c,strokeOpacity:l,opacity:h}];a.setOrigin(f);const m=a.animate(d,TN(o,r,t));return m.finished.then((()=>a.setOrigin(0,0))),m},LN=t=>(e,n,r,i,o)=>{const[a]=e,{height:s}=a.getBoundingClientRect(),{transform:u,fillOpacity:c,strokeOpacity:l,opacity:h}=a.style,[f,p]=T_(i)?[[0,s],"scale(1, 0.0001)"]:[[0,0],"scale(0.0001, 1)"],d=[{transform:`${u} scale(1, 1)`.trimStart()},{transform:`${u} ${p}`.trimStart(),fillOpacity:c,strokeOpacity:l,opacity:h,offset:.99},{transform:`${u} ${p}`.trimStart(),fillOpacity:0,strokeOpacity:0,opacity:0}];a.setOrigin(f);const m=a.animate(d,TN(o,r,t));return m.finished.then((()=>a.setOrigin(0,0))),m},RN=t=>(e,n,r,i,o)=>{const[a]=e,{height:s}=a.getBoundingClientRect(),{transform:u,fillOpacity:c,strokeOpacity:l,opacity:h}=a.style,[f,p]=T_(i)?[[0,0],"scale(0.0001, 1)"]:[[0,s],"scale(1, 0.0001)"],d=[{transform:`${u} ${p}`.trimStart(),fillOpacity:0,strokeOpacity:0,opacity:0},{transform:`${u} ${p}`.trimStart(),fillOpacity:c,strokeOpacity:l,opacity:h,offset:.01},{transform:`${u} scale(1, 1)`.trimStart(),fillOpacity:c,strokeOpacity:l,opacity:h}];a.setOrigin(f);const m=a.animate(d,TN(o,r,t));return m.finished.then((()=>a.setOrigin(0,0))),m},IN=t=>(e,n,r,i,o)=>{const[a]=e,{height:s}=a.getBoundingClientRect(),{transform:u,fillOpacity:c,strokeOpacity:l,opacity:h}=a.style,[f,p]=T_(i)?[[0,0],"scale(0.0001, 1)"]:[[0,s],"scale(1, 0.0001)"],d=[{transform:`${u} scale(1, 1)`.trimStart()},{transform:`${u} ${p}`.trimStart(),fillOpacity:c,strokeOpacity:l,opacity:h,offset:.99},{transform:`${u} ${p}`.trimStart(),fillOpacity:0,strokeOpacity:0,opacity:0}];a.setOrigin(f);const m=a.animate(d,TN(o,r,t));return m.finished.then((()=>a.setOrigin(0,0))),m},NN=t=>(e,n,r,i,o)=>{const[a]=e,{fillOpacity:s,strokeOpacity:u,opacity:c}=a.style,l=[{fillOpacity:0,strokeOpacity:0,opacity:0},{fillOpacity:s,strokeOpacity:u,opacity:c}];return a.animate(l,TN(o,r,t))};NN.props={};const DN=t=>(e,n,r,i,o)=>{const[a]=e,{fillOpacity:s,strokeOpacity:u,opacity:c}=a.style,l=[{fillOpacity:s,strokeOpacity:u,opacity:c},{fillOpacity:0,strokeOpacity:0,opacity:0}];return a.animate(l,TN(o,r,t))};function FN(t){const{min:e,max:n}=t.getLocalBounds(),[r,i]=e,[o,a]=n;return[r,i,o-r,a-i]}function jN(t){const[e,n,r,i]=t;return`\n    M ${e} ${n}\n    L ${e+r} ${n}\n    L ${e+r} ${n+i}\n    L ${e} ${n+i}\n    Z\n  `}function BN(t,e){const[n,r,i,o]=FN(t),a=o/i,s=Math.ceil(Math.sqrt(e/a)),u=[],c=o/Math.ceil(e/s);let l=0,h=e;for(;h>0;){const t=Math.min(h,s),e=i/t;for(let i=0;i<t;i++){const t=n+i*e,o=r+l*c;u.push(jN([t,o,e,c]))}h-=t,l+=1}return u}function zN(t,e){t.__data__=e.__data__,t.className=e.className,e.parentNode.replaceChild(t,e)}function UN(t,e,n,r){const{nodeName:i}=e,{nodeName:o}=n,a=Vp(e),s=Vp(n);if(i===o&&"path"!==i||(void 0===a||void 0===s))return function(t,e,n){const[r,i,o,a]=FN(t);zN(e,t);const[s,u,c,l]=FN(e),h=r-s,f=i-u,p=o/c,d=a/l,m=[Object.assign({transform:`translate(${h}, ${f}) scale(${p}, ${d})`},ON(t,kN)),Object.assign({transform:"translate(0, 0) scale(1, 1)"},ON(e,kN))];return e.animate(m,n)}(e,n,r);const u=function(t,e){const{nodeName:n}=t;if("path"===n)return t;const r=new op({style:Object.assign(Object.assign({},ON(t,kN)),{d:e})});return zN(r,t),r}(t,a),c=[Object.assign({path:a},ON(e,kN)),Object.assign({path:s},ON(n,kN))],l=u.animate(c,r);return u.style.transform="scale(1, 1)",u.style.transform="none",l}DN.props={};const VN=t=>(e,n,r,i,o)=>{const a=function(t="pack"){return"function"==typeof t?t:BN}(t.split),s=TN(o,r,t),{length:u}=e,{length:c}=n;if(1===u&&1===c||u>1&&c>1){const[t]=e,[r]=n;return UN(t,t,r,s)}if(1===u&&c>1){const[t]=e;return function(t,e,n,r){t.style.visibility="hidden";const i=r(t,e.length);return e.map(((e,r)=>UN(e,new op({style:Object.assign({path:i[r]},ON(t,kN))}),e,n)))}(t,n,s,a)}if(u>1&&1===c){const[t]=n;return function(t,e,n,r){const i=r(e,t.length),{fillOpacity:o,strokeOpacity:a,opacity:s}=e.style,u=[{fillOpacity:0,strokeOpacity:0,opacity:0},{fillOpacity:0,strokeOpacity:0,opacity:0,offset:.99},{fillOpacity:o,strokeOpacity:a,opacity:s}],c=e.animate(u,n),l=t.map(((t,r)=>UN(t,t,new op({style:{path:i[r],fill:e.style.fill}}),n)));return[...l,c]}(e,t,s,a)}return null};VN.props={};var GN=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const WN=t=>{const e=1e-4;return Yl({name:"waveInArcAngle",inherits:!1,initialValue:"",interpolable:!0,syntax:pc.NUMBER}),(n,r,i,o,a)=>{const[s]=n;if(!C_(o))return PN(t)(n,r,i,o,a);const u=o.getCenter(),{__data__:c,style:l}=s,{radius:h=0,inset:f=0,fillOpacity:p,strokeOpacity:d,opacity:m}=l;GN(l,["radius","inset","fillOpacity","strokeOpacity","opacity"]);const{points:v,y:g,y1:y}=c,x=pC().cornerRadius(h).padAngle(f*Math.PI/180),b=rO(o,v,[g,y]),{startAngle:_,endAngle:w}=b,S=new op({}),M=t=>{S.attr({d:x(t),transform:`translate(${u[0]}, ${u[1]})`});const e=Vp(S);return S.style.transform="none",e},E=[{waveInArcAngle:_+e,fillOpacity:0,strokeOpacity:0,opacity:0},{waveInArcAngle:_+e,fillOpacity:p,strokeOpacity:d,opacity:m,offset:.01},{waveInArcAngle:w,fillOpacity:p,strokeOpacity:d,opacity:m}],A=s.animate(E,TN(a,i,t));return A.onframe=function(){s.style.path=M(Object.assign(Object.assign({},b),{endAngle:Number(s.style.waveInArcAngle)}))},A.onfinish=function(){s.style.path=M(Object.assign(Object.assign({},b),{endAngle:w}))},A}};WN.props={};const HN=t=>(e,n,r,i,o)=>{const[a]=e,{transform:s,fillOpacity:u,strokeOpacity:c,opacity:l}=a.style,h=[{transform:`${s} scale(0.0001)`.trimStart(),fillOpacity:0,strokeOpacity:0,opacity:0},{transform:`${s} scale(0.0001)`.trimStart(),fillOpacity:u,strokeOpacity:c,opacity:l,offset:.01},{transform:`${s} scale(1)`.trimStart(),fillOpacity:u,strokeOpacity:c,opacity:l}],{width:f,height:p}=a.getBoundingClientRect();a.setOrigin([f/2,p/2]);const d=a.animate(h,TN(o,r,t));return d.finished.then((()=>a.setOrigin(0,0))),d},YN=t=>(e,n,r,i,o)=>{const[a]=e,{transform:s,fillOpacity:u,strokeOpacity:c,opacity:l}=a.style,h=[{transform:`${s} scale(1)`.trimStart()},{transform:`${s} scale(0.0001)`.trimStart(),fillOpacity:u,strokeOpacity:c,opacity:l,offset:.99},{transform:`${s} scale(0.0001)`.trimStart(),fillOpacity:0,strokeOpacity:0,opacity:0}],{width:f,height:p}=a.getBoundingClientRect();a.setOrigin([f/2,p/2]);const d=a.animate(h,TN(o,r,t));return d.finished.then((()=>a.setOrigin(0,0))),d},XN=t=>(e,n,r,i,o)=>{var a,s;const[u]=e,c=(null===(s=(a=u).getTotalLength)||void 0===s?void 0:s.call(a))||0,l=[{lineDash:[0,c]},{lineDash:[c,0]}];return u.animate(l,TN(o,r,t))};XN.props={};const qN=t=>(e,n,r,i,o)=>{const[a]=e,{height:s,width:u}=a.getBoundingClientRect(),c=new op({style:{path:`M0,0L${u},0L${u},${s}L0,${s}Z`}});a.appendChild(c),a.style.clipPath=c;const l=PN(t)([c],n,r,i,o);return l.finished.then((()=>{c.remove(),a.style.clipPath=null})),l};qN.props={};const ZN=t=>(e,n,r,i,o)=>{const[a]=e,{height:s,width:u}=a.getBoundingClientRect(),c=new op({style:{path:`M0,0L${u},0L${u},${s}L0,${s}Z`}});a.appendChild(c),a.style.clipPath=c;const l=RN(t)([c],n,r,i,o);return l.finished.then((()=>{c.remove(),a.style.clipPath=null})),l};ZN.props={};var $N=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};function KN(t){return zC(t).selectAll(`.${Gi}`).nodes()}function JN(t,e){return e.filter((e=>e!==t&&e.options.parentKey===t.options.key)).flatMap((({container:t})=>KN(t)))}function QN(t){return zC(t).select(`.${Hi}`).node()}function tD(t,e){const{offsetX:n,offsetY:r}=e,i=t.getBounds(),{min:[o,a],max:[s,u]}=i;return n<o||n>s||(r<a||r>u)?null:[n-o,r-a]}function eD(t,e){const{offsetX:n,offsetY:r}=e,i=t.getBounds(),{min:[o,a],max:[s,u]}=i;return[Math.min(s,Math.max(o,n))-o,Math.min(u,Math.max(a,r))-a]}function nD(t){return t&&0!==Object.keys(t).length?t:{highlightedLineWidth:1,highlightedStroke:"#000"}}function rD(t){const{x:e}=t.scale;return t=>{const{x:n}=t.__data__;return e.invert(n)}}function iD(t){const e=Array.from(t.markState.keys()),n=new Map(e.map((t=>[t.key,t.data])));return t=>{const{index:e,markKey:r}=t.__data__;return n.get(r)[e]}}function oD(t,e=((t,e)=>t),n=((t,e,n)=>t.setAttribute(e,n))){const r="__states__",i="__ordinal__",o=o=>{const{[r]:a=[],[i]:s={}}=o,u=a.reduce(((e,n)=>Object.assign(Object.assign({},e),Mw(t,n))),s);if(0!==Object.keys(u).length){for(const[t,r]of Object.entries(u)){const i=o.getAttribute(t),a=e(r,o);n(o,t,a),t in s||(s[t]=i)}o[i]=s}},a=t=>{t[r]||(t[r]=[])};return{setState:(t,...e)=>{a(t),t[r]=[...e],o(t)},removeState:(t,...e)=>{a(t);for(const n of e){const e=t[r].indexOf(n);-1!==n&&t[r].splice(e,1)}o(t)},hasState:(t,e)=>(a(t),-1!==t[r].indexOf(e))}}function aD(t,e){const n=new Map(t.map(((t,e)=>[t,e])));return(r,i)=>{if("function"!=typeof r)return r;const o=n.get(i);return r(e?e(i):i,o,e?t.map(e):t)}}function sD(t,e){var{valueof:n=((t,e)=>t)}=e,r=$N(e,["valueof"]);const i="element-link";return[(e,o)=>{if(e.length<=1)return;const a=e.map((t=>[t,t.getBBox()]));a.sort((([,t],[,e])=>{const{x:n,y:r}=t,{x:i,y:o}=e;return n-i==0?r-o:n-i}));for(let s=1;s<a.length;s++){const e=iC(),[u,c]=a[s-1],[,l]=a[s];e.moveTo(c.x+c.width,c.y),e.lineTo(l.x,l.y),e.lineTo(l.x,l.y+l.height),e.lineTo(c.x+c.width,c.y+c.height),e.closePath();const h=qC(r,(t=>n(t,u))),{fill:f=u.getAttribute("fill")}=h,p=$N(h,["fill"]),d=new op({className:`${i}${o?" "+o:""}`,style:Object.assign({d:e.toString(),fill:f},p)});t.appendChild(d)}},e=>{const n=e||i,r=t.getElementsByClassName(n)||[];for(const t of r)t.remove()}]}function uD(t,e){const n=t.getRootNode().defaultView.getContextService().getDomElement();(null==n?void 0:n.style)&&(n.style.cursor=e)}function cD(t){uD(t,"default")}var lD=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};function hD(t,e){var{elements:n,datum:r,groupKey:i=(t=>t),link:o=!1}=e,a=lD(e,["elements","datum","groupKey","link"]);const s=n(t),u=new Set(s),c=e_(s,i),l=aD(s,r),[h,f]=sD(t,Object.assign({elements:s,valueof:l},Mw(a,"link"))),{setState:p,removeState:d}=oD(a,l),m=t=>{const{target:e}=t;if(!u.has(e))return;const n=i(e),r=c.get(n),a=new Set(r);for(const i of s)a.has(i)?p(i,"highlighted"):p(i,"unhighlighted");o&&h(r)},v=t=>{const{target:e}=t;if(u.has(e)){for(const t of s)d(t,"unhighlighted","highlighted");o&&f()}};return t.addEventListener("pointerover",m),t.addEventListener("pointerout",v),()=>{t.removeEventListener("pointerover",m),t.removeEventListener("pointerout",v)}}function fD(t){return e=>{const{container:n,view:r}=e;return hD(n,Object.assign(Object.assign({},nD(t)),{elements:KN,datum:iD(r)}))}}function pD(t={selectedLineWidth:1,selectedColor:"black"}){return e=>{const{container:n,view:r}=e;return hD(n,Object.assign(Object.assign({},nD(t)),{elements:KN,datum:iD(r),groupKey:rD(r)}))}}function dD(t){return e=>{const{container:n,view:r}=e;return hD(n,Object.assign(Object.assign(Object.assign({},t),nD(t)),{elements:KN,datum:iD(r),groupKey:t=>t.__data__.color}))}}var mD=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};function vD(t,e){var{elements:n,datum:r,groupKey:i=(t=>t),link:o=!1,single:a=!1}=e,s=mD(e,["elements","datum","groupKey","link","single"]);const u=n(t),c=new Set(u),l=e_(u,i),h=aD(u,r),[f,p]=sD(t,Object.assign({elements:u,valueof:h},Mw(s,"link"))),{setState:d,removeState:m,hasState:v}=oD(s,h),g=()=>{for(const t of u)m(t,"selected","unselected");o&&p()},y=t=>{const{target:e}=t;return c.has(e)?a?(t=>{if(v(t,"selected"))g();else{const e=i(t),n=l.get(e),r=new Set(n);for(const t of u)r.has(t)?d(t,"selected"):d(t,"unselected");o&&(p(),f(n))}})(e):(t=>{const e=i(t),n=l.get(e),r=new Set(n);if(v(t,"selected")){if(!u.some((t=>!r.has(t)&&v(t,"selected"))))return g();for(const t of n)d(t,"unselected");o&&p(e)}else{const t=n.some((t=>v(t,"selected")));for(const e of u)r.has(e)?d(e,"selected"):v(e,"selected")||d(e,"unselected");!t&&o&&f(n,e)}})(e):g()};return t.addEventListener("click",y),()=>{t.removeEventListener("click",y)}}function gD(t){return e=>{const{container:n,view:r}=e;return vD(n,Object.assign(Object.assign({},nD(t)),{elements:KN,datum:iD(r)}))}}function yD(t){return e=>{const{container:n,view:r}=e;return vD(n,Object.assign(Object.assign({},nD(t)),{elements:KN,datum:iD(r),groupKey:rD(r)}))}}function xD(t){return e=>{const{container:n,view:r}=e;return vD(n,Object.assign(Object.assign({},nD(t)),{elements:KN,datum:iD(r),groupKey:t=>t.__data__.color}))}}var bD=globalThis&&globalThis.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(e){o(e)}}function s(t){try{u(r.throw(t))}catch(e){o(e)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},_D=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};function wD(t){var{wait:e=20,leading:n,trailing:r=!1,labelFormatter:i=(t=>`${t}`)}=t,o=_D(t,["wait","leading","trailing","labelFormatter"]);return t=>{const{options:a,view:s,container:u,update:c}=t,{markState:l,scale:h,coordinate:f}=s,p=function(t,e,n){const[r]=Array.from(t.entries()).filter((([t])=>t.type===e)).map((([t])=>{const{encode:e}=t;return Object.fromEntries(n.map((t=>{const n=e[t];return[t,n?n.value:void 0]})))}));return r}(l,"line",["x","y","series"]);if(!p)return;const{y:d,x:m,series:v=[]}=p,g=d.map(((t,e)=>e)),y=o_(g.map((t=>m[t]))),x=tx({},a),b=x.marks.find((t=>"line"===t.type)),_=v_(n_(g,(t=>v_(t,(t=>+d[t]))/y_(t,(t=>+d[t]))),(t=>v[t])).values());tx(b,{scale:{y:{domain:[1/_,_]}}});const w=QN(u),S=u.getElementsByClassName(Gi),M=e_(u.getElementsByClassName(Xi),(t=>t.__data__.key.split("-")[0])),E=new rp({style:Object.assign({x1:0,y1:0,x2:0,y2:w.getAttribute("height"),stroke:"black",lineWidth:1},Mw(o,"rule"))}),A=new pp({style:Object.assign({x:0,y:w.getAttribute("height"),text:"",fontSize:10},Mw(o,"label"))});E.append(A),w.appendChild(E);const T=(t,e,n)=>{const[r]=t.invert(n),i=e.invert(r);return y[Hb(y,i)]},C=(t,e)=>{E.setAttribute("x1",t[0]),E.setAttribute("x2",t[0]),A.setAttribute("text",i(e))};let O;const k=nx((t=>{const e=tD(w,t);e&&(t=>{const{scale:e,coordinate:n}=O,{x:r,y:i}=e,o=T(n,r,t);C(t,o);for(const a of S){const{seriesIndex:t,key:e}=a.__data__,r=t[Vb((t=>m[+t])).center(t,o)],s=[0,i.map(1)],u=[0,i.map(d[r]/d[t[0]])],[,c]=n.map(s),[,l]=n.map(u),h=c-l;a.setAttribute("transform",`translate(0, ${h})`);const f=M.get(e)||[];for(const n of f)n.setAttribute("dy",h)}})(e)}),e,{leading:n,trailing:r});return(t=>{bD(this,void 0,void 0,(function*(){const{x:e}=h,n=T(f,e,t);C(t,n);const r=function(t){const{transform:e=[]}=t,n=e.find((t=>"normalizeY"===t.type));if(n)return n;const r={type:"normalizeY"};return e.push(r),t.transform=e,r}(b);r.groupBy="color",r.basis=(t,e)=>e[t[Vb((t=>m[+t])).center(t,n)]];for(const t of x.marks)t.animate=!1;const i=yield c(x);O=i.view}))})([0,0]),w.addEventListener("pointerenter",k),w.addEventListener("pointermove",k),w.addEventListener("pointerleave",k),()=>{E.remove(),w.removeEventListener("pointerenter",k),w.removeEventListener("pointermove",k),w.removeEventListener("pointerleave",k)}}}function SD({wait:t=30,leading:e,trailing:n=!1}){return r=>{const{options:i,update:o,container:a}=r,s=QN(a),u=tx({},i);for(const t of u.marks)t.animate=!1;const c=nx((t=>{const e=tD(s,t);if(!e)return;const[n,r]=e,i=function(t){const{coordinates:e=[]}=t,n=e.find((t=>"fisheye"===t.type));if(n)return n;const r={type:"fisheye"};return e.push(r),t.coordinates=e,r}(u);i.focusX=n,i.focusY=r,i.isVisual=!0,o(u)}),t,{leading:e,trailing:n});return s.addEventListener("pointerenter",c),s.addEventListener("pointermove",c),s.addEventListener("pointerleave",c),()=>{s.removeEventListener("pointerenter",c),s.removeEventListener("pointermove",c),s.removeEventListener("pointerleave",c)}}}var MD=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};function ED(t,e,n){const r=t.getBounds(),{min:[i,o],max:[a,s]}=r,u=new hR({className:"tooltip",style:{x:e,y:n,container:{x:0,y:0},items:[],bounding:{x:i,y:o,width:a-i,height:s-o},title:" ",position:"bottom-right",offset:[10,10],style:{".tooltip":{},".tooltip-title":{overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"}}}});return t.getRootNode().defaultView.getConfig().container.appendChild(u.HTMLTooltipElement),u}function AD(t,e,n,r){const{tooltipElement:i=ED(t,n,r)}=t,{items:o,title:a}=e;i.show(),i.position=[n,r],i.update({items:o,title:a}),t.tooltipElement=i}function TD(t){const{tooltipElement:e}=t;e&&e.hide()}function CD(t){return Object.fromEntries(Object.entries(t).filter((([,t])=>ww(t))))}function OD(t,e){const{color:n,series:r}=t,{color:i,series:o}=e,a=t=>t&&t.invert&&!(t instanceof GA);return a(n)?n.invert(i):a(r)?r.invert(o):null}function kD(t){const e=t.getAttribute("fill"),n=t.getAttribute("stroke"),{__data__:r}=t,{color:i=e||n}=r;return i}function PD(t){return Tw(t)?t:{value:void 0===t?t:`${t}`}}function LD(t,e,n,r=t.map((t=>t.__data__))){const i=function(t){return Array.from(new Set(t))}(r.map((t=>t.title))).filter(ww),o=r.flatMap(((r,i)=>{const o=t[i],a=MD(r,["title"]),s=kD(o);return Object.entries(a).filter((([t])=>t.startsWith("tooltip"))).map((([t,i])=>{const{field:o,title:a=o}=n[t].getOptions(),u=PD(i),{field:c,color:l=s,name:h=OD(n,r)||c||a,value:f}=u,p=MD(u,["field","color","name","value"]);return Object.assign(Object.assign(Object.assign({},p),{name:h,color:l,value:f}),CD(e({channel:t,value:i})))})).filter((({value:t})=>void 0!==t))}));return Object.assign(Object.assign({},i.length>0&&{title:i.join(",")}),{items:o})}function RD(t,e){return Array.from(t.values()).some((t=>{var n;return null===(n=t.interaction)||void 0===n?void 0:n[e]}))}function ID(t,e){return void 0===t?e:t}function ND(t,e){var{elements:n,wait:r=50,leading:i=!0,trailing:o=!1,scale:a,coordinate:s,crosshairs:u,item:c,startX:l=0,startY:h=0}=e,f=MD(e,["elements","wait","leading","trailing","scale","coordinate","crosshairs","item","startX","startY"]);const p=n(t),[,d]=function(t){const e=t.getBounds(),{min:[n,r],max:[i,o]}=e;return[i-n,o-r]}(t),m=[],v=[];for(const A of p){const{__data__:t}=A,{seriesX:e}=t;e?m.push(A):v.push(A)}const g=new Map(m.map((t=>{const{__data__:e}=t,{seriesX:n}=e,r=n.map(((t,e)=>e)),i=o_(r,(t=>n[+t]));return[t,[i,n]]}))),y=v.map(((t,e)=>e)),x=v.map((t=>{const{__data__:e}=t;return e.x})),b=o_(y,(t=>x[t])),_=Mw(f,"crosshairs"),{x:w}=a,S=(null==w?void 0:w.getBandWidth)?w.getBandWidth()/2:0,M=nx((e=>{const n=tD(t,e);if(!n)return;const r=t.getBounds(),i=r.min[0],o=r.min[1],f=[n[0]-l,n[1]-h];if(!f)return;const p=((t,e,n)=>{const r=e.length;if(0===r)return[];const[i]=s.invert(t),o=i-S,a=Vb((t=>n[+t])).center,u=a(e,o);let c=u,l=u;for(;c-1>0&&n[e[c-1]]==n[e[u]];)c--;for(;l+1<r&&n[e[l+1]]===n[e[u]];)l++;return E_(c,l+1).map((t=>e[t]))})(f,b,x),y=p.map((t=>v[t])),w=m.map((t=>{const[e,n]=g.get(t),r=((t,e,n)=>{const[r]=s.invert(t);return e[(0,Vb((t=>n[+t])).center)(e,r-S)]})(f,e,n),i=((t,e)=>{const{__data__:n}=t;return Object.fromEntries(Object.entries(n).filter((([t])=>t.startsWith("series"))).map((([t,n])=>{const r=n[e];return[Ky(t.replace("series","")),r]})))})(t,r),{x:o,y:a}=i;return[i,s.map([o+S,a])]})),M=[...w.map((t=>t[0])),...y.map((t=>t.__data__))],E=LD([...m,...y],c,a,M);if(AD(t,E,n[0]+i,n[1]+o),u){const e=w.map((t=>t[1]));!function(t,e,n){var{height:r,startX:i,startY:o}=n,a=MD(n,["height","startX","startY"]);const s=w_(e.map((t=>t[0]))),u=s+i,c=s+i,l=o,h=r-o,f=t.ruleY||(()=>{const e=new rp({style:Object.assign({x1:u,x2:c,y1:l,y2:h,lineWidth:1,stroke:"#1b1e23",strokeOpacity:.5},a)});return t.appendChild(e),e})();f.style.x1=u,f.style.x2=c,f.style.y1=l,f.style.y2=h,t.ruleY=f}(t,e,Object.assign(Object.assign({},_),{height:d,startX:l,startY:h}))}}),r,{leading:i,trailing:o}),E=()=>{TD(t),u&&function(t){t.ruleY&&(t.ruleY.remove(),t.ruleY=void 0)}(t)};return t.addEventListener("pointerenter",M),t.addEventListener("pointermove",M),t.addEventListener("pointerleave",E),()=>{t.removeEventListener("pointerover",M),t.removeEventListener("pointerout",M),t.removeEventListener("pointerleave",E)}}function DD(t,{elements:e,scale:n,wait:r=50,leading:i=!0,trailing:o=!1,groupKey:a=(t=>t),item:s}){const u=e(t),c=new Set(u),l=e_(u,a),h=nx((e=>{const{target:r}=e;if(!c.has(r))return;const i=a(r),o=l.get(i),u=1===o.length?function(t,e,n){const{__data__:r}=t,{title:i}=r,o=MD(r,["title"]),a=kD(t),s=Object.entries(o).filter((([t])=>t.startsWith("tooltip"))).map((([t,r])=>{const{field:i,title:o=i}=n[t].getOptions(),s=PD(r),{field:u,color:c=a,name:l=u||o,value:h}=s,f=MD(s,["field","color","name","value"]);return Object.assign(Object.assign(Object.assign({},f),{color:c,name:l,value:h}),CD(e({channel:t,value:h})))})).filter((({value:t})=>void 0!==t));return Object.assign(Object.assign({},i&&{title:i}),{items:s})}(o[0],s,n):LD(o,s,n),{offsetX:h,offsetY:f}=e;AD(t,u,h,f)}),r,{leading:i,trailing:o}),f=e=>{const{target:n}=e;c.has(n)&&TD(t)};return t.addEventListener("pointerover",h),t.addEventListener("pointermove",h),t.addEventListener("pointerout",f),()=>{t.removeEventListener("pointerover",h),t.removeEventListener("pointermove",h),t.removeEventListener("pointerout",f)}}function FD(t){const{shared:e,crosshairs:n,series:r,name:i,item:o=(()=>({})),facet:a=!1}=t,s=MD(t,["shared","crosshairs","series","name","item","facet"]);return(t,i)=>{const{container:u,view:c}=t,{scale:l,markState:h,coordinate:f}=c,p=RD(h,"seriesTooltip"),d=RD(h,"crosshairs"),m=QN(u),v=ID(r,p);if(v&&!a)return ND(m,Object.assign(Object.assign({},s),{elements:KN,scale:l,coordinate:f,crosshairs:ID(n,d),item:o}));if(v&&a){const e=i.filter((e=>e!==t&&e.options.parentKey===t.options.key)),r=JN(t,i),a=e[0].view.scale,u=m.getBounds(),c=u.min[0],l=u.min[1];return ND(m.parentNode.parentNode,Object.assign(Object.assign({},s),{elements:()=>r,scale:a,coordinate:f,crosshairs:ID(n,d),item:o,startX:c,startY:l}))}return DD(m,Object.assign(Object.assign({},s),{elements:KN,scale:l,coordinate:f,groupKey:e?rD(c):void 0,item:o}))}}var jD=globalThis&&globalThis.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(e){o(e)}}function s(t){try{u(r.throw(t))}catch(e){o(e)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},BD=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};function zD(t){return t.getElementsByClassName("legend-category-item-marker")[0]}function UD(t){return t.getElementsByClassName("legend-category-item-label")[0]}function VD(t){return t.getElementsByClassName("items-item")}function GD(t){var{channel:e}=t,n=BD(t,["channel"]);return t=>{const{container:r,view:i,options:o,update:a}=t,s=r.getElementsByClassName("legend-category"),u=e?s.find((t=>{const{__data__:n}=t.parentNode;return n.scale.name===e})):s[0],[c,l]=u?function(t){const{data:e}=t.attributes,{__data__:n}=t.parentNode,{name:r}=n.scale;return[r,{legends:VD,marker:zD,label:UD,datum:t=>{const{__data__:n}=t,{index:r}=n;return e[r].label}}]}(u):[null,{}];return c&&(e=c),function(t,e){var{legends:n,marker:r,label:i,datum:o,filter:a,setAttribute:s}=e,u=BD(e,["legends","marker","label","datum","filter","setAttribute"]);const c=new Map,l=new Map,h=new Map,f=0===Object.keys(u).length?{labelUnselectedFill:"#aaa",markerUnselectedFill:"#aaa"}:u,p=Mw(f,"marker"),d=Mw(f,"label"),{setState:m,removeState:v}=oD(p,void 0,s),{setState:g,removeState:y}=oD(d,void 0,s),x=Array.from(n(t)),b=x.map(o),_=()=>{for(const t of x){const e=o(t),n=r(t),a=i(t);b.includes(e)?(v(n,"unselected"),y(a,"unselected")):(m(n,"unselected"),g(a,"unselected"))}};for(const w of x){const e=()=>{uD(t,"pointer")},n=()=>{cD(t)},r=()=>jD(this,void 0,void 0,(function*(){const t=o(w),e=b.indexOf(t);-1===e?b.push(t):b.splice(e,1),0===b.length&&b.push(...x.map(o)),yield a(b),_()}));w.addEventListener("click",r),w.addEventListener("pointerenter",e),w.addEventListener("pointerout",n),c.set(w,r),l.set(w,e),h.set(w,n)}return()=>{for(const t of x)t.removeEventListener("click",c.get(t)),t.removeEventListener("pointerenter",l.get(t)),t.removeEventListener("pointerout",h.get(t))}}(r,Object.assign(Object.assign(Object.assign({},l),{filter:t=>jD(this,void 0,void 0,(function*(){const{scale:n}=i,{[e]:r}=n,{marks:s}=o,u=s.map((n=>{const{transform:i=[]}=n,o=[{type:"filter",[e]:t},...i];return tx({},n,{transform:o,scale:{[e]:{domain:r.getOptions().domain}}})})),c=Object.assign(Object.assign({},o),{marks:u});return a(c)}))}),n))}}var WD=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};function HD(t,e){const[n,r,i,o]=t,[a,s,u,c]=e;return!(a>i||u<n||s>o||c<r)}function YD(t,e){var{brushed:n,brushend:r,brushRegion:i,extent:o,reverse:a=!1}=e,s=WD(e,["brushed","brushend","brushRegion","extent","reverse"]);let u=null,c=null,l=null,h=null,f=null,p=!1;const[d,m,v,g]=o;uD(t,"crosshair"),t.style.draggable=!0;const y=()=>{f=new op({style:Object.assign(Object.assign({},s),{pointerEvents:"none"})}),h=new hp({style:{draggable:!0,fill:"transparent"},className:"mask"}),t.appendChild(f),t.appendChild(h)},x=()=>{h=new hp({style:Object.assign(Object.assign({},s),{draggable:!0}),className:"mask"}),t.appendChild(h)},b=(t,e)=>{const[r,s,u,c]=function(t,e,n,r,i){const[o,a,s,u]=i;return[Math.max(o,Math.min(t,n)),Math.max(a,Math.min(e,r)),Math.min(s,Math.max(t,n)),Math.min(u,Math.max(e,r))]}(t[0],t[1],e[0],e[1],o),[l,h,f,p]=i(r,s,u,c,o);a?w(l,h,f,p):_(l,h,f,p),n(l,h,f,p)},_=(t,e,n,r)=>{h.style.x=t,h.style.y=e,h.style.width=n-t,h.style.height=r-e},w=(t,e,n,r)=>{f.style.d=`\n      M${d},${m}L${v},${m}L${v},${g}L${d},${g}Z\n      M${t},${e}L${t},${r}L${n},${r}L${n},${e}Z\n    `,h.style.x=t,h.style.y=e,h.style.width=n-t,h.style.height=r-e},S=e=>{const{target:n}=e,[r,i]=eD(t,e);n!==h?(((t,e)=>{if(h&&h.remove(),f&&f.remove(),u=[t,e],a)return y();x()})(r,i),p=!0):l=[r,i]},M=e=>{const n=eD(t,e);if(u)return l?(t=>{const e=(t,e,n,r,i)=>t+e<r?r-e:t+n>i?i-n:t,n=t[0]-l[0],r=t[1]-l[1],i=e(n,u[0],c[0],d,v),o=e(r,u[1],c[1],m,g),a=[u[0]+i,u[1]+o],s=[c[0]+i,c[1]+o];b(a,s)})(n):void b(u,n)},E=e=>{if(l){l=null;const{x:t,y:e,width:n,height:r}=h.style;return u=[t,e],void(c=[t+n,e+r])}c=eD(t,e),b(u,c),p=!1},A=t=>{const{target:e}=t;h&&e!==h&&(h&&h.remove(),f&&f.remove(),u=null,c=null,l=null,p=!1,h=null,f=null,r())},T=e=>{const{target:n}=e;uD(t,n!==h||p?"crosshair":"move")};return t.addEventListener("dragstart",S),t.addEventListener("drag",M),t.addEventListener("dragend",E),t.addEventListener("click",A),t.addEventListener("pointermove",T),()=>{h&&h.remove(),f&&f.remove(),t.removeEventListener("dragstart",S),t.removeEventListener("drag",M),t.removeEventListener("dragend",E),t.removeEventListener("click",A),t.removeEventListener("pointermove",T)}}function XD(t,e){var{elements:n,datum:r,brushRegion:i,extent:o,reverse:a,series:s=!1}=e,u=WD(e,["elements","datum","brushRegion","extent","reverse","series"]);const c=n(t),l=aD(c,r),h=Mw(u,"mask"),{setState:f,removeState:p}=oD(u,l),d=new Map,{width:m,height:v,x:g,y:y}=t.getBBox(),x=o||[0,0,m,v];return YD(t,Object.assign(Object.assign({},h),{extent:x,brushRegion:i,reverse:a,brushend:s?()=>{for(const t of c)p(t,"unhighlighted");for(const t of d.values())t.remove();d.clear()}:()=>{for(const t of c)p(t,"highlighted","unhighlighted")},brushed:s?(t,e,n,r)=>{const i=t=>{const e=t.cloneNode();return t.parentNode.appendChild(e),d.set(t,e),e};for(const o of c){const a=d.get(o)||i(o);a.style.clipPath=new hp({style:{x:t+g,y:e+y,width:n-t,height:r-e}}),f(o,"unhighlighted"),f(a,"highlighted")}}:(t,e,n,r)=>{for(const i of c){const{min:o,max:a}=i.getLocalBounds(),[s,u]=o,[c,l]=a;HD([s,u,c,l],[t,e,n,r])?f(i,"highlighted"):f(i,"unhighlighted")}}}))}function qD(t){var{facet:e}=t,n=WD(t,["facet"]);return(t,r)=>{const{container:i,view:o}=t,a=QN(i),s={maskFill:"#777",maskFillOpacity:"0.3",maskStroke:"#fff",unhighlightedOpacity:.5,reverse:!1};if(e){const e=a.getBounds(),i=e.min[0],u=e.min[1],c=e.max[0],l=e.max[1];return XD(a.parentNode.parentNode,Object.assign(Object.assign({elements:()=>JN(t,r),datum:iD(o),brushRegion:(t,e,n,r)=>[t,e,n,r],maskFill:"#777",maskFillOpacity:"0.3",maskStroke:"#fff",unhighlightedOpacity:.5,extent:[i,u,c,l]},s),n))}return XD(a,Object.assign(Object.assign({elements:KN,datum:iD(o),brushRegion:(t,e,n,r)=>[t,e,n,r],extent:void 0},s),n))}}function ZD(t){return qD(Object.assign(Object.assign({},t),{brushRegion:(t,e,n,r,i)=>{const[,o,,a]=i;return[t,o,n,a]}}))}function $D(t){return qD(Object.assign(Object.assign({},t),{brushRegion:(t,e,n,r,i)=>{const[o,,a]=i;return[o,e,a,r]}}))}var KD=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};function JD(t){return(e,...n)=>tx({},t(e,...n),e)}function QD(t){return(e,...n)=>tx({},e,t(e,...n))}function tF(t,e){if(!t)return e;if(Array.isArray(t))return t;const{value:n=e}=t,r=KD(t,["value"]);return Object.assign(Object.assign({},r),{value:n})}var eF=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const nF=()=>t=>{const{children:e}=t;if(!Array.isArray(e))return[];const{x:n=0,y:r=0,width:i,height:o,data:a}=t;return e.map((t=>{var{data:e}=t,s=eF(t,["data"]);return Object.assign(Object.assign({},s),{data:tF(e,a),x:n,y:r,width:i,height:o})}))};nF.props={};var rF=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const iF=()=>t=>{const{children:e}=t;if(!Array.isArray(e))return[];const{direction:n="row",ratio:r=e.map((()=>1)),padding:i=0,data:o}=t,[a,s,u,c]="col"===n?["y","height","width","x"]:["x","width","height","y"],l=r.reduce(((t,e)=>t+e)),h=t[s]-i*(e.length-1),f=r.map((t=>h*(t/l))),p=[];let d=t[a]||0;for(let m=0;m<f.length;m+=1){const n=e[m],{data:r}=n,l=rF(n,["data"]),h=tF(r,o);p.push(Object.assign({[a]:d,[s]:f[m],[c]:t[c]||0,[u]:t[u],data:h},l)),d+=f[m]+i}return p};iF.props={};var oF=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const aF=()=>t=>{const{children:e}=t,n=oF(t,["children"]);if(!Array.isArray(e))return[];const{data:r,scale:i={},axis:o={},legend:a={}}=n,s=oF(n,["data","scale","axis","legend"]),u=e.map((t=>{var{data:e,scale:n={},axis:s={},legend:u={}}=t,c=oF(t,["data","scale","axis","legend"]);return Object.assign({data:tF(e,r),scale:tx({},i,n),axis:!(!s||!o)&&tx({},o,s),legend:!(!u||!a)&&tx({},a,u)},c)}));return[Object.assign(Object.assign({},s),{marks:u,type:"standardView"})]};aF.props={};var sF=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const uF=()=>t=>{const{width:e,height:n,paddingLeft:r,paddingRight:i,paddingTop:o,paddingBottom:a,padding:s,inset:u,insetLeft:c,insetTop:l,insetRight:h,insetBottom:f,margin:p,marginLeft:d,marginBottom:m,marginTop:v,marginRight:g,data:y,coordinates:x,theme:b,component:_,interactions:w,x:S,y:M,key:E,frame:A,title:T,labelTransform:C,parentKey:O,clip:k}=t,P=sF(t,["width","height","paddingLeft","paddingRight","paddingTop","paddingBottom","padding","inset","insetLeft","insetTop","insetRight","insetBottom","margin","marginLeft","marginBottom","marginTop","marginRight","data","coordinates","theme","component","interactions","x","y","key","frame","title","labelTransform","parentKey","clip"]);return[{type:"standardView",x:S,y:M,key:E,width:e,height:n,padding:s,paddingLeft:r,paddingRight:i,paddingTop:o,inset:u,insetLeft:c,insetTop:l,insetRight:h,insetBottom:f,paddingBottom:a,theme:b,coordinates:x,component:_,interactions:w,frame:A,title:T,labelTransform:C,margin:p,marginLeft:d,marginBottom:m,marginTop:v,marginRight:g,parentKey:O,clip:k,marks:[Object.assign(Object.assign({},P),{key:`${E}-0`,data:y})]}]};uF.props={};var cF=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const lF=JD((t=>{const{encode:e,data:n,scale:r,shareSize:i=!1}=t,{x:o,y:a}=e,s=(t,e)=>{var o;if(void 0===t||!i)return{};const a=e_(n,(e=>e[t])),s=(null===(o=null==r?void 0:r[e])||void 0===o?void 0:o.domain)||Array.from(a.keys()),u=s.map((t=>a.has(t)?a.get(t).length:1));return{domain:s,flex:u}};return{scale:{x:Object.assign(Object.assign({paddingOuter:0,paddingInner:.1,guide:void 0===o?null:{position:"top"}},void 0===o&&{paddingInner:0}),s(o,"x")),y:Object.assign(Object.assign({range:[0,1],paddingOuter:0,paddingInner:.1,guide:void 0===a?null:{position:"right"}},void 0===a&&{paddingInner:0}),s(a,"y"))}}})),hF=JD((t=>{const{data:e,scale:n}=t,r=[t];let i,o,a;for(;r.length;){const t=r.shift(),{children:e,encode:n={},scale:s={},legend:u={}}=t,{color:c}=n,{color:l}=s,{color:h}=u;void 0!==c&&(i=c),void 0!==l&&(o=l),void 0!==h&&(a=h),Array.isArray(e)&&r.push(...e)}return{encode:{color:i},scale:{color:tx({},o,{domain:(()=>{var t;const r=null===(t=null==n?void 0:n.color)||void 0===t?void 0:t.domain;return void 0!==r?r:void 0!==i?Array.from(new Set(e.map((t=>t[i])))):void 0})(),type:"ordinal"})},legend:{color:tx({title:i},a)}}})),fF=JD((()=>({animate:{enterType:"fadeIn"}}))),pF=QD((()=>({frame:!1,encode:{shape:"hollow"},style:{lineWidth:0}}))),dF=QD((()=>({type:"cell"}))),mF=QD((t=>{const{data:e}=t,n={type:"custom",callback:()=>{const{data:e,encode:n}=t,{x:r,y:i}=n,o=r?Array.from(new Set(e.map((t=>t[r])))):[],a=i?Array.from(new Set(e.map((t=>t[i])))):[];return(()=>{if(o.length&&a.length){const t=[];for(const e of o)for(const n of a)t.push({[r]:e,[i]:n});return t}return o.length?o.map((t=>({[r]:t}))):a.length?a.map((t=>({[i]:t}))):void 0})()}};return{data:{type:"inline",value:e,transform:[n]}}})),vF=QD(((t,e=gF,n=xF,r=bF,i={})=>{const{data:o,encode:a,children:s,scale:u,x:c=0,y:l=0,shareData:h=!1,key:f}=t,{value:p}=o,{x:d,y:m}=a,{color:v}=u,{domain:g}=v;return{children:(t,o,a)=>{const{x:u,y:v}=o,{paddingLeft:y,paddingTop:x}=a,{domain:b}=u.getOptions(),{domain:_}=v.getOptions(),w=ZC(t),S=t.map(e),M=t.map((({x:t,y:e})=>[u.invert(t),v.invert(e)])),E=M.map((([t,e])=>n=>{const{[d]:r,[m]:i}=n;return(void 0===d||r===t)&&(void 0===m||i===e)})),A=E.map((t=>p.filter(t))),T=h?v_(A,(t=>t.length)):void 0,C=M.map((([t,e])=>({columnField:d,columnIndex:b.indexOf(t),columnValue:t,columnValuesLength:b.length,rowField:m,rowIndex:_.indexOf(e),rowValue:e,rowValuesLength:_.length}))),O=C.map((t=>Array.isArray(s)?s:[s(t)].flat(1)));return w.flatMap((t=>{const[e,o,a,s]=S[t],u=C[t],h=A[t];return O[t].map((v=>{var b,_,{scale:w,key:S,facet:M=!0,axis:E={},legend:A={}}=v,C=cF(v,["scale","key","facet","axis","legend"]);const O=(null===(b=null==w?void 0:w.y)||void 0===b?void 0:b.guide)||E.y,k=(null===(_=null==w?void 0:w.x)||void 0===_?void 0:_.guide)||E.x,P={x:{tickCount:d?5:void 0},y:{tickCount:m?5:void 0}},L=M?h:0===h.length?[]:p,R={color:{domain:g}},I={x:_F(k,n)(u,L),y:_F(O,r)(u,L)};return Object.assign(Object.assign({key:`${S}-${t}`,data:L,x:e+y+c,y:o+x+l,parentKey:f,width:a,height:s,paddingLeft:0,paddingRight:0,paddingTop:0,paddingBottom:0,frame:!!L.length,dataDomain:T,scale:tx(P,w,R),axis:tx({},E,I),legend:!1},C),i)}))}))}}}));function gF(t){const{points:e}=t;return YC(e)}function yF(t,e){return e.length?tx({title:!1,tick:null,label:null},t):tx({title:!1,tick:null,label:null,grid:null},t)}function xF(t){return(e,n)=>{const{rowIndex:r,rowValuesLength:i,columnIndex:o,columnValuesLength:a}=e;if(r!==i-1)return yF(t,n);const s=o===a-1&&void 0,u=n.length?void 0:null;return tx({title:s,grid:u},t)}}function bF(t){return(e,n)=>{const{rowIndex:r,columnIndex:i}=e;if(0!==i)return yF(t,n);const o=0===r&&void 0,a=n.length?void 0:null;return tx({title:o,grid:a},t)}}function _F(t,e){return"function"==typeof t?t:null===t?()=>null:e(t)}const wF=()=>t=>[AN.of(t).call(dF).call(hF).call(fF).call(lF).call(pF).call(mF).call(vF).value()];wF.props={};var SF=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const MF=JD((t=>({scale:{x:{guide:null,paddingOuter:0,paddingInner:.1},y:{guide:null,range:[0,1],paddingOuter:0,paddingInner:.1}}}))),EF=QD((t=>{const{data:e,children:n,x:r=0,y:i=0,key:o}=t;return{children:(t,a,s)=>{const{x:u,y:c}=a,{paddingLeft:l,paddingTop:h}=s,{domain:f}=u.getOptions(),{domain:p}=c.getOptions(),d=ZC(t),m=t.map((({points:t})=>YC(t))),v=t.map((({x:t,y:e})=>[u.invert(t),c.invert(e)])),g=v.map((([t,e])=>({columnField:t,columnIndex:f.indexOf(t),columnValue:t,columnValuesLength:f.length,rowField:e,rowIndex:p.indexOf(e),rowValue:e,rowValuesLength:p.length}))),y=g.map((t=>Array.isArray(n)?n:[n(t)].flat(1)));return d.flatMap((t=>{const[n,a,s,u]=m[t],[c,f]=v[t],p=g[t];return y[t].map((d=>{var m,v;const{scale:g,key:y,encode:x,axis:b}=d,_=SF(d,["scale","key","encode","axis"]),w=null===(m=null==g?void 0:g.y)||void 0===m?void 0:m.guide,S={x:TF(null===(v=null==g?void 0:g.x)||void 0===v?void 0:v.guide)(p,e),y:CF(w)(p,e)};return Object.assign({data:e,parentKey:o,key:`${y}-${t}`,x:n+l+r,y:a+h+i,width:s,height:u,paddingLeft:0,paddingRight:0,paddingTop:0,paddingBottom:0,frame:!0,scale:tx({x:{facet:!1},y:{facet:!1}},g),axis:tx({x:{tickCount:5},y:{tickCount:5}},b,S),legend:!1,encode:tx({},x,{x:c,y:f})},_)}))}))}}})),AF=QD((t=>{const{encode:e}=t,n=SF(t,["encode"]),{position:r=[],x:i=r,y:o=[...r].reverse()}=e,a=SF(e,["position","x","y"]),s=[];for(const u of[i].flat(1))for(const t of[o].flat(1))s.push({$x:u,$y:t});return Object.assign(Object.assign({},n),{data:s,encode:Object.assign(Object.assign({},a),{x:"$x",y:"$y"}),scale:Object.assign(Object.assign({},1===[i].flat(1).length&&{x:{paddingInner:0}}),1===[o].flat(1).length&&{y:{paddingInner:0}})})}));function TF(t){return"function"==typeof t?t:null===t?()=>null:(e,n)=>{const{rowIndex:r,rowValuesLength:i}=e;if(r!==i-1)return yF(t,n)}}function CF(t){return"function"==typeof t?t:null===t?()=>null:(e,n)=>{const{columnIndex:r}=e;if(0!==r)return yF(t,n)}}const OF=()=>t=>[AN.of(t).call(dF).call(hF).call(EF).call(AF).call(fF).call(pF).call(MF).value()];var kF=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const PF=JD((t=>({scale:{x:{guide:{type:"axisX"},paddingOuter:0,paddingInner:.1},y:{guide:null,range:[0,1],paddingOuter:0,paddingInner:.1}}}))),LF=JD((t=>({coordinates:[{type:"polar"}]}))),RF=t=>{const{encode:e}=t,n=kF(t,["encode"]),{position:r}=e;return Object.assign(Object.assign({},n),{encode:{x:r}})};function IF(t){return t=>null}function NF(t){const{points:e}=t,[n,r,i,o]=e,a=GC(n,o),s=VC(n,o),u=function(t,e){const n=WC(t),r=WC(e);return n<r?r-n:2*Math.PI-(n-r)}(s,VC(r,i)),c=1/Math.sin(u/2),l=a/(1+c),h=l*Math.sqrt(2),[f,p]=i,d=HC(s)+u/2,m=l*c;return[f+m*Math.sin(d)-h/2,p+m*Math.cos(d)-h/2,h,h]}const DF=()=>t=>[AN.of(t).call(dF).call(RF).call(hF).call(LF).call(mF).call(vF,NF,IF,IF,{frame:!1}).call(fF).call(pF).call(PF).value()];function FF(t,e,n){const r=[0,n],i=[1-n,1];return"normal"===t?r:"reverse"===t?i:"alternate"===t?e%2==0?r:i:"reverse-alternate"===t?e%2==0?i:r:void 0}const jF=()=>t=>{const{children:e=[],duration:n=1e3,iterationCount:r=1,direction:i="normal",easing:o="ease-in-out-sine"}=t,a=e.length;if(!Array.isArray(e)||0===a)return[];const{key:s}=e[0],u=e.map((t=>Object.assign(Object.assign({},t),{key:s}))).map((t=>function(t,e,n){const r=[t];for(;r.length;){const t=r.pop();t.animate=tx({enterDuration:e,updateDuration:e,exitDuration:e,updateEasing:n,updateType:"morphing",updateFill:"both",exitType:"fadeOut"},t.animate||{});const{children:i}=t;Array.isArray(i)&&r.push(...i)}return t}(t,n,o)));return function*(){let t,e=0;for(;"infinite"===r||e<r;){const[n,r]=FF(i,e,a);for(let e=n;e<r;e+=1){const n=Math.abs(e);t!==n&&(yield u[n]),t=n}e++}}};function BF(t,e){if(null!==t)return{type:"column",value:t,field:e}}function zF(t,e){if(null!==t)return{type:"column",value:t,field:e,visual:!0}}function UF(t,e){const n=[];for(const r of t)n[r]=e;return n}function VF(t,e){const n=t[e];if(!n)return[null,null];const{value:r,field:i=null}=n;return[r,i]}function GF(t,...e){for(const n of e){if("string"!=typeof n)return[n,null];{const[e,r]=VF(t,n);if(null!==e)return[e,r]}}return[null,null]}function WF(t){return!(t instanceof Date)&&"object"==typeof t}jF.props={};const HF=()=>(t,e)=>{const{encode:n}=e,{y1:r}=n;return void 0!==r?[t,e]:[t,tx({},e,{encode:{y1:BF(UF(t,0))}})]};function YF(t,e,n){const{encode:r}=n;if(null===t)return[e];const i=function(t){return Array.isArray(t)?t:[t]}(t).map((t=>{var e;return[t,null===(e=VF(r,t))||void 0===e?void 0:e[0]]})).filter((([,t])=>ww(t)));return Array.from(e_(e,(t=>i.map((([,e])=>e[t])).join("-"))).values())}function XF(t){return Array.isArray(t)?function(t){return(e,n,r)=>(n,r)=>t.reduce(((t,i)=>0!==t?t:zb(e[n][i],e[r][i])),0)}(t):"function"==typeof t?function(t){return(e,n,r)=>tj((n=>t(e[n])))}(t):"series"===t?$F:"value"===t?KF:"sum"===t?JF:"maxIndex"===t?QF:()=>null}function qF(t,e){for(const n of t)n.sort(e)}function ZF(t,e){return(null==e?void 0:e.domain)||Array.from(new Set(t))}function $F(t,e,n){return tj((t=>n[t]))}function KF(t,e,n){return tj((t=>e[t]))}function JF(t,e,n){const r=ZC(t),i=Array.from(e_(r,(t=>n[+t])).entries()),o=new Map(i.map((([t,n])=>[t,n.reduce(((t,n)=>t+ +e[n]))])));return tj((t=>o.get(n[t])))}function QF(t,e,n){const r=ZC(t),i=Array.from(e_(r,(t=>n[+t])).entries()),o=new Map(i.map((([t,n])=>[t,g_(n,(t=>e[t]))])));return tj((t=>o.get(n[t])))}function tj(t){return(e,n)=>zb(t(e),t(n))}HF.props={};const ej=(t={})=>{const{groupBy:e="x",orderBy:n=null,reverse:r=!1,y:i="y",y1:o="y1",series:a=!0}=t;return(t,s)=>{const{data:u,encode:c,style:l={}}=s,[h,f]=VF(c,"y"),[p,d]=VF(c,"y1"),[m]=a?GF(c,"series","color"):VF(c,"color"),v=YF(e,t,s),g=XF(n)(u,h,m);g&&qF(v,g);const y=new Array(t.length),x=new Array(t.length),b=new Array(t.length),_=[],w=[];for(const e of v){r&&e.reverse();const t=p?+p[e[0]]:0,n=[],i=[];for(const r of e){const e=b[r]=+h[r]-t;e<0?i.push(r):e>=0&&n.push(r)}const o=n.length>0?n:i,a=i.length>0?i:n;let s=n.length-1,u=0;for(;s>0&&0===h[o[s]];)s--;for(;u<a.length-1&&0===h[a[u]];)u++;_.push(o[s]),w.push(a[u]);let c=t;for(const e of i.reverse()){const t=b[e];c=y[e]=(x[e]=c)+t}let l=t;for(const e of n){const t=b[e];t>0?l=y[e]=(x[e]=l)+t:y[e]=x[e]=l}}const S=new Set(_),M=new Set(w),E="y"===o?y:x;return[t,tx({},s,{encode:{y:BF("y"===i?y:x,f),y1:BF(E,d)},style:Object.assign({first:(t,e)=>S.has(e),last:(t,e)=>M.has(e)},l)})]}};function nj(t){const{type:e}=t;return"string"==typeof e&&["stackY","dodgeX","groupX"].includes(e)}ej.props={};const rj=t=>(e,n,r)=>{const{encode:i,transform:o=[]}=n;if(o.some(nj))return[e,n];const{x:a,y:s}=i;if(void 0===a||void 0===s)return[e,n];const{series:u}=t;return ej({groupBy:u?["x","series"]:"x"})(e,n,r)};rj.props={};const ij=(t={})=>{const{channel:e="x"}=t;return(t,n)=>{const{encode:r}=n,{title:i}=r;if(void 0!==i)return[t,n];const[o,a]=VF(r,e);return[t,tx({},n,{encode:{title:BF(o,a)}})]}};ij.props={};const oj=()=>(t,e)=>{const{encode:n}=e,{x:r}=n;return void 0!==r?[t,e]:[t,tx({},e,{encode:{x:BF(UF(t,0))},scale:{x:{guide:null}}})]};oj.props={};const aj=()=>(t,e)=>{const{encode:n}=e,{y:r}=n;return void 0!==r?[t,e]:[t,tx({},e,{encode:{y:BF(UF(t,0))},scale:{y:{guide:null}}})]};aj.props={};const sj=()=>(t,e)=>{const{encode:n}=e,{size:r}=n;return void 0!==r?[t,e]:[t,tx({},e,{encode:{size:zF(UF(t,3))}})]};sj.props={};var uj=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const cj=()=>(t,e)=>{const{encode:n}=e,{key:r}=n,i=uj(n,["key"]);if(void 0!==r)return[t,e];const o=Object.values(i).map((({value:t})=>t)),a=t.map((t=>o.filter(Array.isArray).map((e=>e[t])).join("-")));return[t,tx({},e,{encode:{key:BF(a)}})]};cj.props={};const lj=()=>(t,e)=>{const{encode:n}=e,{series:r,color:i}=n;if(void 0!==r||void 0===i)return[t,e];const[o,a]=VF(n,"color");return[t,tx({},e,{encode:{series:BF(o,a)}})]};lj.props={};const hj=()=>(t,e)=>{const{data:n}=e;return!Array.isArray(n)||n.some(WF)?[t,e]:[t,tx({},e,{encode:{y:BF(n)}})]};hj.props={};const fj=()=>(t,e)=>{const{data:n}=e;return!Array.isArray(n)||n.some(WF)?[t,e]:[t,tx({},e,{encode:{x:BF(n)}})]};fj.props={};const pj=()=>(t,e)=>{const{encode:n}=e,{y1:r}=n;if(r)return[t,e];const[i]=VF(n,"y");return[t,tx({},e,{encode:{y1:BF([...i])}})]};pj.props={};const dj=()=>(t,e)=>{const{encode:n}=e,{x1:r}=n;if(r)return[t,e];const[i]=VF(n,"x");return[t,tx({},e,{encode:{x1:BF([...i])}})]};dj.props={};const mj=t=>{const{channel:e}=t;return(t,n)=>{const{encode:r}=n,{tooltip:i}=r;if(void 0!==i)return[t,n];const o=Array.isArray(e)?e:[e];let a=0;const s=o.flatMap((t=>Object.entries(r).filter((([e])=>e.startsWith(t))).flatMap((([t])=>{const[e,n]=VF(r,t),i=[[t,BF(e)]];if(e&&null!==n){const t=e.map((t=>({value:t,field:n})));i.push([`tooltip${0===a?"":a}`,BF(t,n)]),a++}return i}))));return[t,tx({},n,{encode:Object.fromEntries(s)})]}};mj.props={};const vj=()=>(t,e)=>[t,tx({scale:{x:{padding:0},y:{padding:0}}},e)];vj.props={};var gj=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const yj=()=>(t,e)=>{const{data:n,style:r={}}=e,i=gj(e,["data","style"]),{x:o,y:a}=r,s=gj(r,["x","y"]);if(null==o||null==a)return[t,e];const u=a||0;return[[0],tx({},i,{data:[0],cartesian:!0,encode:{x:BF([o||0]),y:BF([u])},scale:{x:{type:"identity",independent:!0,guide:null},y:{type:"identity",independent:!0,guide:null}},style:s})]};yj.props={};const xj=()=>(t,e)=>{const{style:n={}}=e;return[t,tx({},e,{style:Object.assign(Object.assign({},n),Object.fromEntries(Object.entries(n).filter((([,t])=>"function"==typeof t)).map((([t,e])=>[t,()=>e]))))})]};xj.props={};const bj=()=>(t,e)=>{const{data:n}=e;if(!Array.isArray(n)||n.some(WF))return[t,e];const r=Array.isArray(n[0])?n:[n],i=r.map((t=>t[0])),o=r.map((t=>t[1]));return[t,tx({},e,{encode:{x:BF(i),y:BF(o)}})]};bj.props={};const _j=()=>(t,e)=>{const{style:n={}}=e,{gradient:r}=n;return r?[t,tx({},e,{encode:{series:zF(UF(t,void 0))}})]:[t,e]};_j.props={};var wj=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const Sj=(t={})=>{const{groupBy:e="x",reverse:n=!1,orderBy:r,padding:i}=t;return wj(t,["groupBy","reverse","orderBy","padding"]),(t,o)=>{const{data:a,encode:s,scale:u}=o,{series:c}=u,[l]=VF(s,"y"),[h]=GF(s,"series","color"),f=ZF(h,c),p=YF(e,t,o),d=XF(r)(a,l,h);d&&qF(p,d);const m=new Array(t.length);for(const e of p){n&&e.reverse();for(let t=0;t<e.length;t++)m[e[t]]=f[t]}return[t,tx({},o,{scale:{series:{domain:f,paddingInner:i}},encode:{series:BF(m)}})]}};Sj.props={};const Mj=t=>{const{groupBy:e=["x"],reducer:n=((t,e)=>e[t[0]]),orderBy:r=null,reverse:i=!1,duration:o}=t;return(t,a)=>{const{encode:s}=a,u=(Array.isArray(e)?e:[e]).map((t=>[t,VF(s,t)[0]]));if(0===u.length)return[t,a];let c=[t];for(const[,e]of u){const t=[];for(const n of c){const r=Array.from(e_(n,(t=>e[t])).values());t.push(...r)}c=t}if(r){const[t]=VF(s,r);t&&c.sort(((e,r)=>n(e,t)-n(r,t))),i&&c.reverse()}const l=(o||3e3)/c.length,[h]=o?[UF(t,l)]:GF(s,"enterDuration",UF(t,l)),[f]=GF(s,"enterDelay",UF(t,0)),p=new Array(t.length);for(let e=0,n=0;e<c.length;e++){const t=c[e],r=v_(t,(t=>+h[t]));for(const e of t)p[e]=+f[e]+n;n+=r}return[t,tx({},a,{encode:{enterDuration:zF(h),enterDelay:zF(p)}})]}};Mj.props={};var Ej=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const Aj=(t={})=>{const{groupBy:e="x",basis:n="max"}=t;return(t,r)=>{const{encode:i}=r,o=Ej(i,["x"]),a=Object.entries(o).filter((([t])=>t.startsWith("y"))).map((([t])=>[t,VF(i,t)[0]])),[,s]=a.find((([t])=>"y"===t)),u=a.map((([e])=>[e,new Array(t.length)])),c=YF(e,t,r),l=function(t){if("function"==typeof t)return t;const e={min:(t,e)=>y_(t,(t=>e[+t])),max:(t,e)=>v_(t,(t=>e[+t])),first:(t,e)=>e[t[0]],last:(t,e)=>e[t[t.length-1]],mean:(t,e)=>w_(t,(t=>e[+t])),median:(t,e)=>S_(t,(t=>e[+t])),sum:(t,e)=>A_(t,(t=>e[+t])),deviation:(t,e)=>qb(t,(t=>e[+t]))};return e[t]||v_}(n);for(const e of c){const t=l(e,s);for(const n of e)for(let e=0;e<a.length;e++){const[,r]=a[e],[,i]=u[e];i[n]=+r[n]/t}}return[t,tx({},r,{encode:Object.fromEntries(u.map((([t,e])=>[t,BF(e,VF(i,t)[1])])))})]}};function Tj(t,e,n){if(null===t)return[-.5,.5];const r=ZF(t,e),i=new PA({domain:r,range:[0,1],padding:n}).getBandWidth();return[-i/2,i/2]}function Cj(t,e,n){return e*(1-t)+n*t}Aj.props={};const Oj=(t={})=>{const{padding:e=0,paddingX:n=e,paddingY:r=e,random:i=Math.random}=t;return(t,e)=>{const{encode:o,scale:a}=e,{x:s,y:u}=a,[c]=VF(o,"x"),[l]=VF(o,"y"),h=Tj(c,s,n),f=Tj(l,u,r),p=t.map((()=>Cj(i(),...f))),d=t.map((()=>Cj(i(),...h)));return[t,tx({scale:{x:{padding:.5},y:{padding:.5}}},e,{encode:{dy:BF(p),dx:BF(d)}})]}};Oj.props={};const kj=(t={})=>{const{padding:e=0,random:n=Math.random}=t;return(t,r)=>{const{encode:i,scale:o}=r,{x:a}=o,[s]=VF(i,"x"),u=Tj(s,a,e),c=t.map((()=>Cj(n(),...u)));return[t,tx({scale:{x:{padding:.5}}},r,{encode:{dx:BF(c)}})]}};kj.props={};var Pj=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const Lj=(t={})=>{const{groupBy:e="x"}=t;return(t,n)=>{const{encode:r}=n,i=Pj(r,["x"]),o=Object.entries(i).filter((([t])=>t.startsWith("y"))).map((([t])=>[t,VF(r,t)[0]])),a=o.map((([e])=>[e,new Array(t.length)])),s=YF(e,t,n),u=new Array(s.length);for(let e=0;e<s.length;e++){const t=s[e].flatMap((t=>o.map((([,e])=>+e[t])))),[n,r]=Zb(t);u[e]=(n+r)/2}const c=Math.max(...u);for(let e=0;e<s.length;e++){const t=c-u[e],n=s[e];for(const e of n)for(let n=0;n<o.length;n++){const[,r]=o[n],[,i]=a[n];i[e]=+r[e]+t}}return[t,tx({},n,{encode:Object.fromEntries(a.map((([t,e])=>[t,BF(e,VF(r,t)[1])])))})]}};Lj.props={};const Rj=(t={})=>{const{groupBy:e="x",series:n=!0}=t;return(t,r)=>{const{encode:i}=r,[o]=VF(i,"y"),[a,s]=VF(i,"y1");n?GF(i,"series","color"):VF(i,"color");const u=YF(e,t,r),c=new Array(t.length);for(const e of u){const t=e.map((t=>+o[t]));for(let n=0;n<e.length;n++){const r=e[n],i=Math.max(...t.filter(((t,e)=>e!==n)));c[r]=o[r]>i?i:o[r]}}return[t,tx({},r,{encode:{y1:BF(c,s)}})]}};Rj.props={};var Ij=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};function Nj(t,e){return[t[0]]}function Dj(t,e){return[t[t.length-1]]}function Fj(t,e){return[t[g_(t,(t=>e[t]))]]}function jj(t,e){return[t[function(t,e){let n,r=-1,i=-1;if(void 0===e)for(const o of t)++i,null!=o&&(n>o||void 0===n&&o>=o)&&(n=o,r=i);else for(let o of t)null!=(o=e(o,++i,t))&&(n>o||void 0===n&&o>=o)&&(n=o,r=i);return r}(t,(t=>e[t]))]]}const Bj=(t={})=>{const{groupBy:e="series"}=t,n=Ij(t,["groupBy"]);return(t,r)=>{const{encode:i}=r,o=YF(e,t,r),[a,s]=Object.entries(n)[0],[u]=VF(i,a),c=function(t){return"function"==typeof t?t:{first:Nj,last:Dj,max:Fj,min:jj}[t]||Nj}(s);return[o.flatMap((t=>c(t,u))),r]}};Bj.props={};var zj=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const Uj=(t={})=>{const{selector:e}=t,n=zj(t,["selector"]);return Bj(Object.assign({x:e},n))};Uj.props={};var Vj=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const Gj=(t={})=>{const{selector:e}=t,n=Vj(t,["selector"]);return Bj(Object.assign({y:e},n))};Gj.props={};var Wj=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};function Hj(t){return e=>null===e?t:`${t} of ${e}`}function Yj(){return[(t,e)=>w_(t,(t=>+e[t])),Hj("mean")]}function Xj(){return[(t,e)=>S_(t,(t=>+e[t])),Hj("median")]}function qj(){return[(t,e)=>v_(t,(t=>+e[t])),Hj("max")]}function Zj(){return[(t,e)=>y_(t,(t=>+e[t])),Hj("min")]}function $j(){return[(t,e)=>t.length,Hj("count")]}function Kj(){return[(t,e)=>A_(t,(t=>+e[t])),Hj("sum")]}function Jj(){return[(t,e)=>e[t[0]],Hj("first")]}function Qj(){return[(t,e)=>e[t[t.length-1]],Hj("last")]}const tB=(t={})=>{const{groupBy:e}=t,n=Wj(t,["groupBy"]);return(t,r)=>{const{data:i,encode:o}=r,a=e(t,r);if(!a)return[t,r];const s=Object.entries(n).map((([t,e])=>{const[n,r]=function(t){if("function"==typeof t)return[t,null];const e={mean:Yj,max:qj,count:$j,first:Jj,last:Qj,sum:Kj,min:Zj,median:Xj}[t];if(!e)throw new Error(`Unknown reducer: ${t}.`);return e()}(e),[s,u]=VF(o,t);return[t,BF(a.map((t=>n(t,null!=s?s:i))),(null==r?void 0:r(u))||u)]})),u=Object.keys(o).map((t=>{const[e,n]=VF(o,t);return[t,BF(a.map((t=>e[t[0]])),n)]})),c=a.map((t=>i[t[0]]));return[ZC(a),tx({},r,{data:c,encode:Object.fromEntries([...u,...s])})]}};tB.props={};var eB=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const nB=(t={})=>{const{channels:e=["x","y"]}=t,n=eB(t,["channels"]);return tB(Object.assign(Object.assign({},n),{groupBy:(t,n)=>YF(e,t,n)}))};nB.props={};const rB=(t={})=>nB(Object.assign(Object.assign({},t),{channels:["x","color","series"]}));rB.props={};const iB=(t={})=>nB(Object.assign(Object.assign({},t),{channels:["y","color","series"]}));iB.props={};const oB=(t={})=>nB(Object.assign(Object.assign({},t),{channels:["color"]}));oB.props={};var aB=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};function sB(t,e,n){const{reverse:r,slice:i,channel:o}=n,a=aB(n,["reverse","slice","channel"]),{encode:s}=e,[u]=VF(s,o),c=function(t,e,n){const{by:r=t,reducer:i="max"}=e,[o]=VF(n,r);if("function"==typeof i)return t=>i(t,o);if("max"===i)return t=>v_(t,(t=>+o[t]));if("min"===i)return t=>y_(t,(t=>+o[t]));if("sum"===i)return t=>A_(t,(t=>+o[t]));if("median"===i)return t=>S_(t,(t=>+o[t]));if("mean"===i)return t=>w_(t,(t=>+o[t]));if("first"===i)return t=>o[t[0]];if("last"===i)return t=>o[t[t.length-1]];throw new Error(`Unknown reducer: ${i}`)}(o,a,s),l=(h=t,p=t=>u[t],(2!==(f=c).length?o_(n_(h,f,p),(([t,e],[n,r])=>zb(e,r)||zb(t,n))):o_(e_(h,p),(([t,e],[n,r])=>f(e,r)||zb(t,n)))).map((([t])=>t)));var h,f,p;r&&l.reverse();const d="number"==typeof i?[0,i]:i,m=i?l.slice(...d):l;return[t,tx(e,{scale:{[o]:{domain:m}}})]}const uB=(t={})=>{const{reverse:e=!1,slice:n,channel:r,ordinal:i=!0}=t,o=aB(t,["reverse","slice","channel","ordinal"]);return(t,a)=>i?sB(t,a,Object.assign({reverse:e,slice:n,channel:r},o)):function(t,e,n){const{reverse:r,slice:i,channel:o}=n,{encode:a}=e,[s]=VF(a,o),u=o_(t,(t=>s[t]));return r&&u.reverse(),[u,e]}(t,a,Object.assign({reverse:e,slice:n,channel:r},o))};uB.props={};const cB=(t={})=>uB(Object.assign(Object.assign({},t),{channel:"x"}));cB.props={};const lB=(t={})=>uB(Object.assign(Object.assign({},t),{channel:"color"}));lB.props={};const hB=(t={})=>uB(Object.assign(Object.assign({},t),{channel:"y"}));hB.props={};const fB=(t={})=>{const{field:e,channel:n="y",reducer:r="sum"}=t;return(t,i)=>{const{data:o,encode:a}=i,[s]=VF(a,"x"),u=e?function(t,e){return"string"==typeof e?t.map((t=>t[e])):t.map(e)}(o,e):VF(a,n)[0],c=function(t,e){if("function"==typeof t)return n=>t(n,e);if("sum"===t)return t=>A_(t,(t=>+e[t]));throw new Error(`Unknown reducer: ${t}`)}(r,u),l=r_(t,c,(t=>s[t])).map((t=>t[1]));return[t,tx({},i,{scale:{x:{flex:l}}})]}};function pB(t,e,n){const r=t.length;if(0===r)return[];const{innerWidth:i,innerHeight:o}=n,a=o/i;let s=Math.ceil(Math.sqrt(e/a)),u=i/s,c=Math.ceil(e/s),l=c*u;for(;l>o;)s+=1,u=i/s,c=Math.ceil(e/s),l=c*u;const h=o-c*u,f=c<=1?0:h/(c-1),[p,d]=c<=1?[(i-r*u)/(r-1),(o-u)/2]:[0,0];return t.map(((t,e)=>{const[n,r,i,o]=YC(t),a=e%s,l=Math.floor(e/s);return`translate(${a*u-n+p*a}, ${(c-l-1)*u+h-r-f*l-d}) scale(${u/i}, ${u/o})`}))}fB.props={};const dB=()=>(t,e)=>[t,tx({},e,{modifier:pB,axis:!1})];dB.props={};var mB=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const vB="thresholds";function gB(t){const[e,n]=Zb(t);return Math.min(200,function(t,e,n){return Math.ceil((n-e)*Math.cbrt(Xb(t))/(3.49*qb(t)))}(t,e,n))}const yB=(t={})=>{const{groupChannels:e=["color"],binChannels:n=["x","y"]}=t,r=mB(t,["groupChannels","binChannels"]),i={};return tB(Object.assign(Object.assign(Object.assign({},Object.fromEntries(Object.entries(r).filter((([t])=>!t.startsWith(vB))))),Object.fromEntries(n.flatMap((t=>[[t,([e])=>+i[t].get(e).split(",")[0]],[`${t}1`,([e])=>+i[t].get(e).split(",")[1]]])))),{groupBy:(t,o)=>{const{encode:a}=o,s=n.map((t=>{const[e]=VF(a,t);return e})),u=Mw(r,vB),c=t.filter((t=>s.every((e=>ww(e[t]))))),l=[...e.map((t=>{const[e]=VF(a,t);return e})).filter(ww).map((t=>e=>t[e])),...n.map(((t,e)=>{const n=s[e],r=u[t]||gB(n),o=m_().thresholds(r).value((t=>+n[t]))(c),a=new Map(o.flatMap((t=>{const{x0:e,x1:n}=t,r=`${e},${n}`;return t.map((t=>[t,r]))})));return i[t]=a,t=>a.get(t)}))];return Array.from(e_(c,(t=>l.map((e=>e(t))).join("-"))).values())}}))};yB.props={};const xB=(t={})=>{const{thresholds:e}=t;return yB(Object.assign(Object.assign({},t),{thresholdsX:e,groupChannels:["color"],binChannels:["x"]}))};xB.props={};var bB=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const _B=(t={})=>{const{groupBy:e,thresholds:n=2e3}=t,r=bB(t,["groupBy","thresholds"]);return tB(Object.assign(Object.assign({},r),{groupBy:(t,r)=>{const i=YF(e,t,r);return i.every((t=>t.length<=n))?null:i.flatMap((t=>{const e=function(t,e){const n=t.length,r=[];let i=0;for(;i<n;)r.push(t.slice(i,i+=e));return r}(t,Math.max(1,Math.floor(t.length/n)));return e}))}}))};_B.props={};const wB=(t={})=>(e,n)=>{const{encode:r}=n,i=Object.entries(t).map((([t,e])=>{const[n]=VF(r,t);if(!n)return null;if("function"==typeof e)return t=>e(n[t]);const i=Array.isArray(e)?e:[e];return 0===i.length?null:t=>i.includes(n[t])})).filter(ww);if(0===i.length)return[e,n];const o=e.filter((t=>i.every((e=>e(t))))),a=o.map(((t,e)=>e)),s=Object.entries(r).map((([t,e])=>[t,Object.assign(Object.assign({},e),{value:a.map((t=>e.value[o[t]]))})]));return[e,tx({},n,{encode:Object.fromEntries(s)})]};function SB(t){const{min:e,max:n}=t;return[[e[0],e[1]],[n[0],n[1]]]}function MB(t,e){const[n,r]=t,[i,o]=e;return n>=i[0]&&n<=o[0]&&r>=i[1]&&r<=o[1]}wB.props={};const EB=t=>{const{priority:e}=t;return(t,n)=>{const r=[];return e&&t.sort(e),t.forEach((t=>{t.attr("visibility","visible");const e=t.getLocalBounds(),n=r.some((t=>function(t,e){const[n,r]=t,[i,o]=e;return n[0]<o[0]&&r[0]>i[0]&&n[1]<o[1]&&r[1]>i[1]}(SB(e),SB(t.getLocalBounds()))));n?t.attr("visibility","hidden"):r.push(t)})),t}};function AB([t,e],[n,r]){return r>t&&e>n}function TB(){const t=new Map;return[e=>t.get(e),(e,n)=>t.set(e,n)]}function CB(t){const e=t.cloneNode(!0),n=e.getElementById("connector");n&&e.removeChild(n);const{min:r,max:i}=e.getRenderBounds();return e.destroy(),{min:r,max:i}}const OB=t=>{const{maxIterations:e=10,maxError:n=.1,padding:r=1}=t;return t=>{const i=t.length;if(i<=1)return t;const[o,a]=TB(),[s,u]=TB(),[c,l]=TB(),[h,f]=TB();for(const e of t){const{min:t,max:n}=CB(e),[r,i]=t,[o,s]=n;a(e,i),u(e,i),l(e,s-i),f(e,[r,o])}for(let p=0;p<e;p++){t.sort(((t,e)=>zb(s(t),s(e))));let e=0;for(let n=0;n<i-1;n++){const i=t[n];let o,a=n+1;for(;(o=t[a])&&!AB(h(i),h(o));)a+=1;if(o){const t=s(i),n=c(i),a=s(o),l=a-(t+n);if(l<r){const n=(r-l)/2;e=Math.max(e,n),u(i,t-n),u(o,a+n)}}}if(e<n)break}for(const e of t)e.style.y+=s(e)-o(e);return t}};function kB(t){let e=t/255;return e=e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4),e}function PB(t,e,n){return.2126*kB(t)+.7152*kB(e)+.0722*kB(n)}function LB(t,e){const{r:n,g:r,b:i}=t,{r:o,g:a,b:s}=e,u=PB(n,r,i),c=PB(o,a,s);return(Math.max(u,c)+.05)/(Math.min(u,c)+.05)}function RB(t,e){return e[g_(e,(e=>LB(t,function(t){return"object"==typeof t?t:hh(t)}(e))))]}const IB=t=>{const{threshold:e=4.5,palette:n=["#000","#fff"]}=t;return(t,r)=>(t.forEach((t=>{const r=t.attr("dependentElement").parsedStyle.fill;LB(t.parsedStyle.fill,r)<e&&t.attr("fill",RB(r,n))})),t)},NB=t=>(t,e)=>(t.forEach((t=>{t.attr("visibility","visible");const e=t.attr("bounds");(function(t,e){const[n,r]=t;return!(MB(n,e)&&MB(r,e))})(SB(t.getLocalBounds()),e)&&t.attr("visibility","hidden")})),t);var DB=1e-6,FB=Math.PI,jB=FB/2,BB=FB/4,zB=2*FB,UB=180/FB,VB=FB/180,GB=Math.abs,WB=Math.atan,HB=Math.atan2,YB=Math.cos,XB=Math.ceil,qB=Math.exp,ZB=Math.log,$B=Math.pow,KB=Math.sin,JB=Math.sign||function(t){return t>0?1:t<0?-1:0},QB=Math.sqrt,tz=Math.tan;function ez(t){return t>1?0:t<-1?FB:Math.acos(t)}function nz(t){return t>1?jB:t<-1?-jB:Math.asin(t)}function rz(){}function iz(t,e){t&&az.hasOwnProperty(t.type)&&az[t.type](t,e)}var oz={Feature:function(t,e){iz(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,i=n.length;++r<i;)iz(n[r].geometry,e)}},az={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){sz(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)sz(n[r],e,0)},Polygon:function(t,e){uz(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)uz(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,i=n.length;++r<i;)iz(n[r],e)}};function sz(t,e,n){var r,i=-1,o=t.length-n;for(e.lineStart();++i<o;)r=t[i],e.point(r[0],r[1],r[2]);e.lineEnd()}function uz(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)sz(t[n],e,1);e.polygonEnd()}function cz(t,e){t&&oz.hasOwnProperty(t.type)?oz[t.type](t,e):iz(t,e)}function lz(t){return[HB(t[1],t[0]),nz(t[2])]}function hz(t){var e=t[0],n=t[1],r=YB(n);return[r*YB(e),r*KB(e),KB(n)]}function fz(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function pz(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function dz(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function mz(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function vz(t){var e=QB(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function gz(t,e){function n(n,r){return n=t(n,r),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,r){return(n=e.invert(n,r))&&t.invert(n[0],n[1])}),n}function yz(t,e){return GB(t)>FB&&(t-=Math.round(t/zB)*zB),[t,e]}function xz(t,e,n){return(t%=zB)?e||n?gz(_z(t),wz(e,n)):_z(t):e||n?wz(e,n):yz}function bz(t){return function(e,n){return GB(e+=t)>FB&&(e-=Math.round(e/zB)*zB),[e,n]}}function _z(t){var e=bz(t);return e.invert=bz(-t),e}function wz(t,e){var n=YB(t),r=KB(t),i=YB(e),o=KB(e);function a(t,e){var a=YB(e),s=YB(t)*a,u=KB(t)*a,c=KB(e),l=c*n+s*r;return[HB(u*i-l*o,s*n-c*r),nz(l*i+u*o)]}return a.invert=function(t,e){var a=YB(e),s=YB(t)*a,u=KB(t)*a,c=KB(e),l=c*i-u*o;return[HB(u*i+c*o,s*n+l*r),nz(l*n-s*r)]},a}function Sz(t,e){(e=hz(e))[0]-=t,vz(e);var n=ez(-e[1]);return((-e[2]<0?-n:n)+zB-DB)%zB}function Mz(){var t,e=[];return{point:function(e,n,r){t.push([e,n,r])},lineStart:function(){e.push(t=[])},lineEnd:rz,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function Ez(t,e){return GB(t[0]-e[0])<DB&&GB(t[1]-e[1])<DB}function Az(t,e,n,r){this.x=t,this.z=e,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function Tz(t,e,n,r,i){var o,a,s=[],u=[];if(t.forEach((function(t){if(!((e=t.length-1)<=0)){var e,n,r=t[0],a=t[e];if(Ez(r,a)){if(!r[2]&&!a[2]){for(i.lineStart(),o=0;o<e;++o)i.point((r=t[o])[0],r[1]);return void i.lineEnd()}a[0]+=2e-6}s.push(n=new Az(r,t,null,!0)),u.push(n.o=new Az(r,null,n,!1)),s.push(n=new Az(a,t,null,!1)),u.push(n.o=new Az(a,null,n,!0))}})),s.length){for(u.sort(e),Cz(s),Cz(u),o=0,a=u.length;o<a;++o)u[o].e=n=!n;for(var c,l,h=s[0];;){for(var f=h,p=!0;f.v;)if((f=f.n)===h)return;c=f.z,i.lineStart();do{if(f.v=f.o.v=!0,f.e){if(p)for(o=0,a=c.length;o<a;++o)i.point((l=c[o])[0],l[1]);else r(f.x,f.n.x,1,i);f=f.n}else{if(p)for(c=f.p.z,o=c.length-1;o>=0;--o)i.point((l=c[o])[0],l[1]);else r(f.x,f.p.x,-1,i);f=f.p}c=(f=f.o).z,p=!p}while(!f.v);i.lineEnd()}}}function Cz(t){if(e=t.length){for(var e,n,r=0,i=t[0];++r<e;)i.n=n=t[r],n.p=i,i=n;i.n=n=t[0],n.p=i}}function Oz(t){return GB(t[0])<=FB?t[0]:JB(t[0])*((GB(t[0])+FB)%zB-FB)}function kz(t,e,n,r){return function(i){var o,a,s,u=e(i),c=Mz(),l=e(c),h=!1,f={point:p,lineStart:m,lineEnd:v,polygonStart:function(){f.point=g,f.lineStart=y,f.lineEnd=x,a=[],o=[]},polygonEnd:function(){f.point=p,f.lineStart=m,f.lineEnd=v,a=M_(a);var t=function(t,e){var n=Oz(e),r=e[1],i=KB(r),o=[KB(n),-YB(n),0],a=0,s=0,u=new $b;1===i?r=jB+DB:-1===i&&(r=-jB-DB);for(var c=0,l=t.length;c<l;++c)if(f=(h=t[c]).length)for(var h,f,p=h[f-1],d=Oz(p),m=p[1]/2+BB,v=KB(m),g=YB(m),y=0;y<f;++y,d=b,v=w,g=S,p=x){var x=h[y],b=Oz(x),_=x[1]/2+BB,w=KB(_),S=YB(_),M=b-d,E=M>=0?1:-1,A=E*M,T=A>FB,C=v*w;if(u.add(HB(C*E*KB(A),g*S+C*YB(A))),a+=T?M+E*zB:M,T^d>=n^b>=n){var O=pz(hz(p),hz(x));vz(O);var k=pz(o,O);vz(k);var P=(T^M>=0?-1:1)*nz(k[2]);(r>P||r===P&&(O[0]||O[1]))&&(s+=T^M>=0?1:-1)}}return(a<-1e-6||a<DB&&u<-1e-12)^1&s}(o,r);a.length?(h||(i.polygonStart(),h=!0),Tz(a,Lz,t,n,i)):t&&(h||(i.polygonStart(),h=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),h&&(i.polygonEnd(),h=!1),a=o=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function p(e,n){t(e,n)&&i.point(e,n)}function d(t,e){u.point(t,e)}function m(){f.point=d,u.lineStart()}function v(){f.point=p,u.lineEnd()}function g(t,e){s.push([t,e]),l.point(t,e)}function y(){l.lineStart(),s=[]}function x(){g(s[0][0],s[0][1]),l.lineEnd();var t,e,n,r,u=l.clean(),f=c.result(),p=f.length;if(s.pop(),o.push(s),s=null,p)if(1&u){if((e=(n=f[0]).length-1)>0){for(h||(i.polygonStart(),h=!0),i.lineStart(),t=0;t<e;++t)i.point((r=n[t])[0],r[1]);i.lineEnd()}}else p>1&&2&u&&f.push(f.pop().concat(f.shift())),a.push(f.filter(Pz))}return f}}function Pz(t){return t.length>1}function Lz(t,e){return((t=t.x)[0]<0?t[1]-jB-DB:jB-t[1])-((e=e.x)[0]<0?e[1]-jB-DB:jB-e[1])}yz.invert=yz;const Rz=kz((function(){return!0}),(function(t){var e,n=NaN,r=NaN,i=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(o,a){var s=o>0?FB:-FB,u=GB(o-n);GB(u-FB)<DB?(t.point(n,r=(r+a)/2>0?jB:-jB),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(s,r),t.point(o,r),e=0):i!==s&&u>=FB&&(GB(n-i)<DB&&(n-=i*DB),GB(o-s)<DB&&(o-=s*DB),r=function(t,e,n,r){var i,o,a=KB(t-n);return GB(a)>DB?WB((KB(e)*(o=YB(r))*KB(n)-KB(r)*(i=YB(e))*KB(t))/(i*o*a)):(e+r)/2}(n,r,o,a),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(s,r),e=0),t.point(n=o,r=a),i=s},lineEnd:function(){t.lineEnd(),n=r=NaN},clean:function(){return 2-e}}}),(function(t,e,n,r){var i;if(null==t)i=n*jB,r.point(-FB,i),r.point(0,i),r.point(FB,i),r.point(FB,0),r.point(FB,-i),r.point(0,-i),r.point(-FB,-i),r.point(-FB,0),r.point(-FB,i);else if(GB(t[0]-e[0])>DB){var o=t[0]<e[0]?FB:-FB;i=n*o/2,r.point(-o,i),r.point(0,i),r.point(o,i)}else r.point(e[0],e[1])}),[-FB,-jB]);function Iz(t){var e=YB(t),n=6*VB,r=e>0,i=GB(e)>DB;function o(t,n){return YB(t)*YB(n)>e}function a(t,n,r){var i=[1,0,0],o=pz(hz(t),hz(n)),a=fz(o,o),s=o[0],u=a-s*s;if(!u)return!r&&t;var c=e*a/u,l=-e*s/u,h=pz(i,o),f=mz(i,c);dz(f,mz(o,l));var p=h,d=fz(f,p),m=fz(p,p),v=d*d-m*(fz(f,f)-1);if(!(v<0)){var g=QB(v),y=mz(p,(-d-g)/m);if(dz(y,f),y=lz(y),!r)return y;var x,b=t[0],_=n[0],w=t[1],S=n[1];_<b&&(x=b,b=_,_=x);var M=_-b,E=GB(M-FB)<DB;if(!E&&S<w&&(x=w,w=S,S=x),E||M<DB?E?w+S>0^y[1]<(GB(y[0]-b)<DB?w:S):w<=y[1]&&y[1]<=S:M>FB^(b<=y[0]&&y[0]<=_)){var A=mz(p,(-d+g)/m);return dz(A,f),[y,lz(A)]}}}function s(e,n){var i=r?t:FB-t,o=0;return e<-i?o|=1:e>i&&(o|=2),n<-i?o|=4:n>i&&(o|=8),o}return kz(o,(function(t){var e,n,u,c,l;return{lineStart:function(){c=u=!1,l=1},point:function(h,f){var p,d=[h,f],m=o(h,f),v=r?m?0:s(h,f):m?s(h+(h<0?FB:-FB),f):0;if(!e&&(c=u=m)&&t.lineStart(),m!==u&&(!(p=a(e,d))||Ez(e,p)||Ez(d,p))&&(d[2]=1),m!==u)l=0,m?(t.lineStart(),p=a(d,e),t.point(p[0],p[1])):(p=a(e,d),t.point(p[0],p[1],2),t.lineEnd()),e=p;else if(i&&e&&r^m){var g;v&n||!(g=a(d,e,!0))||(l=0,r?(t.lineStart(),t.point(g[0][0],g[0][1]),t.point(g[1][0],g[1][1]),t.lineEnd()):(t.point(g[1][0],g[1][1]),t.lineEnd(),t.lineStart(),t.point(g[0][0],g[0][1],3)))}!m||e&&Ez(e,d)||t.point(d[0],d[1]),e=d,u=m,n=v},lineEnd:function(){u&&t.lineEnd(),e=null},clean:function(){return l|(c&&u)<<1}}}),(function(e,r,i,o){!function(t,e,n,r,i,o){if(n){var a=YB(e),s=KB(e),u=r*n;null==i?(i=e+r*zB,o=e-u/2):(i=Sz(a,i),o=Sz(a,o),(r>0?i<o:i>o)&&(i+=r*zB));for(var c,l=i;r>0?l>o:l<o;l-=u)c=lz([a,-s*YB(l),-s*KB(l)]),t.point(c[0],c[1])}}(o,t,n,i,e,r)}),r?[0,-t]:[-FB,t-FB])}var Nz=1e9,Dz=-Nz;function Fz(t,e,n,r){function i(i,o){return t<=i&&i<=n&&e<=o&&o<=r}function o(i,o,s,c){var l=0,h=0;if(null==i||(l=a(i,s))!==(h=a(o,s))||u(i,o)<0^s>0)do{c.point(0===l||3===l?t:n,l>1?r:e)}while((l=(l+s+4)%4)!==h);else c.point(o[0],o[1])}function a(r,i){return GB(r[0]-t)<DB?i>0?0:3:GB(r[0]-n)<DB?i>0?2:1:GB(r[1]-e)<DB?i>0?1:0:i>0?3:2}function s(t,e){return u(t.x,e.x)}function u(t,e){var n=a(t,1),r=a(e,1);return n!==r?n-r:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(a){var u,c,l,h,f,p,d,m,v,g,y,x=a,b=Mz(),_={point:w,lineStart:function(){_.point=S,c&&c.push(l=[]);g=!0,v=!1,d=m=NaN},lineEnd:function(){u&&(S(h,f),p&&v&&b.rejoin(),u.push(b.result()));_.point=w,v&&x.lineEnd()},polygonStart:function(){x=b,u=[],c=[],y=!0},polygonEnd:function(){var e=function(){for(var e=0,n=0,i=c.length;n<i;++n)for(var o,a,s=c[n],u=1,l=s.length,h=s[0],f=h[0],p=h[1];u<l;++u)o=f,a=p,f=(h=s[u])[0],p=h[1],a<=r?p>r&&(f-o)*(r-a)>(p-a)*(t-o)&&++e:p<=r&&(f-o)*(r-a)<(p-a)*(t-o)&&--e;return e}(),n=y&&e,i=(u=M_(u)).length;(n||i)&&(a.polygonStart(),n&&(a.lineStart(),o(null,null,1,a),a.lineEnd()),i&&Tz(u,s,e,o,a),a.polygonEnd());x=a,u=c=l=null}};function w(t,e){i(t,e)&&x.point(t,e)}function S(o,a){var s=i(o,a);if(c&&l.push([o,a]),g)h=o,f=a,p=s,g=!1,s&&(x.lineStart(),x.point(o,a));else if(s&&v)x.point(o,a);else{var u=[d=Math.max(Dz,Math.min(Nz,d)),m=Math.max(Dz,Math.min(Nz,m))],b=[o=Math.max(Dz,Math.min(Nz,o)),a=Math.max(Dz,Math.min(Nz,a))];!function(t,e,n,r,i,o){var a,s=t[0],u=t[1],c=0,l=1,h=e[0]-s,f=e[1]-u;if(a=n-s,h||!(a>0)){if(a/=h,h<0){if(a<c)return;a<l&&(l=a)}else if(h>0){if(a>l)return;a>c&&(c=a)}if(a=i-s,h||!(a<0)){if(a/=h,h<0){if(a>l)return;a>c&&(c=a)}else if(h>0){if(a<c)return;a<l&&(l=a)}if(a=r-u,f||!(a>0)){if(a/=f,f<0){if(a<c)return;a<l&&(l=a)}else if(f>0){if(a>l)return;a>c&&(c=a)}if(a=o-u,f||!(a<0)){if(a/=f,f<0){if(a>l)return;a>c&&(c=a)}else if(f>0){if(a<c)return;a<l&&(l=a)}return c>0&&(t[0]=s+c*h,t[1]=u+c*f),l<1&&(e[0]=s+l*h,e[1]=u+l*f),!0}}}}}(u,b,t,e,n,r)?s&&(x.lineStart(),x.point(o,a),y=!1):(v||(x.lineStart(),x.point(u[0],u[1])),x.point(b[0],b[1]),s||x.lineEnd(),y=!1)}d=o,m=a,v=s}return _}}function jz(t,e,n){var r=E_(t,e-DB,n).concat(e);return function(t){return r.map((function(e){return[t,e]}))}}function Bz(t,e,n){var r=E_(t,e-DB,n).concat(e);return function(t){return r.map((function(e){return[e,t]}))}}function zz(){return function(){var t,e,n,r,i,o,a,s,u,c,l,h,f=10,p=f,d=90,m=360,v=2.5;function g(){return{type:"MultiLineString",coordinates:y()}}function y(){return E_(XB(r/d)*d,n,d).map(l).concat(E_(XB(s/m)*m,a,m).map(h)).concat(E_(XB(e/f)*f,t,f).filter((function(t){return GB(t%d)>DB})).map(u)).concat(E_(XB(o/p)*p,i,p).filter((function(t){return GB(t%m)>DB})).map(c))}return g.lines=function(){return y().map((function(t){return{type:"LineString",coordinates:t}}))},g.outline=function(){return{type:"Polygon",coordinates:[l(r).concat(h(a).slice(1),l(n).reverse().slice(1),h(s).reverse().slice(1))]}},g.extent=function(t){return arguments.length?g.extentMajor(t).extentMinor(t):g.extentMinor()},g.extentMajor=function(t){return arguments.length?(r=+t[0][0],n=+t[1][0],s=+t[0][1],a=+t[1][1],r>n&&(t=r,r=n,n=t),s>a&&(t=s,s=a,a=t),g.precision(v)):[[r,s],[n,a]]},g.extentMinor=function(n){return arguments.length?(e=+n[0][0],t=+n[1][0],o=+n[0][1],i=+n[1][1],e>t&&(n=e,e=t,t=n),o>i&&(n=o,o=i,i=n),g.precision(v)):[[e,o],[t,i]]},g.step=function(t){return arguments.length?g.stepMajor(t).stepMinor(t):g.stepMinor()},g.stepMajor=function(t){return arguments.length?(d=+t[0],m=+t[1],g):[d,m]},g.stepMinor=function(t){return arguments.length?(f=+t[0],p=+t[1],g):[f,p]},g.precision=function(f){return arguments.length?(v=+f,u=jz(o,i,90),c=Bz(e,t,v),l=jz(s,a,90),h=Bz(r,n,v),g):v},g.extentMajor([[-180,-89.999999],[180,89.999999]]).extentMinor([[-180,-80.000001],[180,80.000001]])}()()}const Uz=t=>t;var Vz,Gz,Wz,Hz,Yz=new $b,Xz=new $b,qz={point:rz,lineStart:rz,lineEnd:rz,polygonStart:function(){qz.lineStart=Zz,qz.lineEnd=Jz},polygonEnd:function(){qz.lineStart=qz.lineEnd=qz.point=rz,Yz.add(GB(Xz)),Xz=new $b},result:function(){var t=Yz/2;return Yz=new $b,t}};function Zz(){qz.point=$z}function $z(t,e){qz.point=Kz,Vz=Wz=t,Gz=Hz=e}function Kz(t,e){Xz.add(Hz*t-Wz*e),Wz=t,Hz=e}function Jz(){Kz(Vz,Gz)}const Qz=qz;var tU=1/0,eU=tU,nU=-tU,rU=nU,iU={point:function(t,e){t<tU&&(tU=t);t>nU&&(nU=t);e<eU&&(eU=e);e>rU&&(rU=e)},lineStart:rz,lineEnd:rz,polygonStart:rz,polygonEnd:rz,result:function(){var t=[[tU,eU],[nU,rU]];return nU=rU=-(eU=tU=1/0),t}};const oU=iU;var aU,sU,uU,cU,lU=0,hU=0,fU=0,pU=0,dU=0,mU=0,vU=0,gU=0,yU=0,xU={point:bU,lineStart:_U,lineEnd:MU,polygonStart:function(){xU.lineStart=EU,xU.lineEnd=AU},polygonEnd:function(){xU.point=bU,xU.lineStart=_U,xU.lineEnd=MU},result:function(){var t=yU?[vU/yU,gU/yU]:mU?[pU/mU,dU/mU]:fU?[lU/fU,hU/fU]:[NaN,NaN];return lU=hU=fU=pU=dU=mU=vU=gU=yU=0,t}};function bU(t,e){lU+=t,hU+=e,++fU}function _U(){xU.point=wU}function wU(t,e){xU.point=SU,bU(uU=t,cU=e)}function SU(t,e){var n=t-uU,r=e-cU,i=QB(n*n+r*r);pU+=i*(uU+t)/2,dU+=i*(cU+e)/2,mU+=i,bU(uU=t,cU=e)}function MU(){xU.point=bU}function EU(){xU.point=TU}function AU(){CU(aU,sU)}function TU(t,e){xU.point=CU,bU(aU=uU=t,sU=cU=e)}function CU(t,e){var n=t-uU,r=e-cU,i=QB(n*n+r*r);pU+=i*(uU+t)/2,dU+=i*(cU+e)/2,mU+=i,vU+=(i=cU*t-uU*e)*(uU+t),gU+=i*(cU+e),yU+=3*i,bU(uU=t,cU=e)}const OU=xU;function kU(t){this._context=t}kU.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._context.moveTo(t,e),this._point=1;break;case 1:this._context.lineTo(t,e);break;default:this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,zB)}},result:rz};var PU,LU,RU,IU,NU,DU=new $b,FU={point:rz,lineStart:function(){FU.point=jU},lineEnd:function(){PU&&BU(LU,RU),FU.point=rz},polygonStart:function(){PU=!0},polygonEnd:function(){PU=null},result:function(){var t=+DU;return DU=new $b,t}};function jU(t,e){FU.point=BU,LU=IU=t,RU=NU=e}function BU(t,e){IU-=t,NU-=e,DU.add(QB(IU*IU+NU*NU)),IU=t,NU=e}const zU=FU;let UU,VU,GU,WU;class HU{constructor(t){this._append=null==t?YU:function(t){const e=Math.floor(t);if(!(e>=0))throw new RangeError(`invalid digits: ${t}`);if(e>15)return YU;if(e!==UU){const t=10**e;UU=e,VU=function(e){let n=1;this._+=e[0];for(const r=e.length;n<r;++n)this._+=Math.round(arguments[n]*t)/t+e[n]}}return VU}(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){0===this._line&&(this._+="Z"),this._point=NaN}point(t,e){switch(this._point){case 0:this._append`M${t},${e}`,this._point=1;break;case 1:this._append`L${t},${e}`;break;default:if(this._append`M${t},${e}`,this._radius!==GU||this._append!==VU){const t=this._radius,e=this._;this._="",this._append`m0,${t}a${t},${t} 0 1,1 0,${-2*t}a${t},${t} 0 1,1 0,${2*t}z`,GU=t,VU=this._append,WU=this._,this._=e}this._+=WU}}result(){const t=this._;return this._="",t.length?t:null}}function YU(t){let e=1;this._+=t[0];for(const n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function XU(t,e){let n,r,i=3,o=4.5;function a(t){return t&&("function"==typeof o&&r.pointRadius(+o.apply(this,arguments)),cz(t,n(r))),r.result()}return a.area=function(t){return cz(t,n(Qz)),Qz.result()},a.measure=function(t){return cz(t,n(zU)),zU.result()},a.bounds=function(t){return cz(t,n(oU)),oU.result()},a.centroid=function(t){return cz(t,n(OU)),OU.result()},a.projection=function(e){return arguments.length?(n=null==e?(t=null,Uz):(t=e).stream,a):t},a.context=function(t){return arguments.length?(r=null==t?(e=null,new HU(i)):new kU(e=t),"function"!=typeof o&&r.pointRadius(o),a):e},a.pointRadius=function(t){return arguments.length?(o="function"==typeof t?t:(r.pointRadius(+t),+t),a):o},a.digits=function(t){if(!arguments.length)return i;if(null==t)i=null;else{const e=Math.floor(t);if(!(e>=0))throw new RangeError(`invalid digits: ${t}`);i=e}return null===e&&(r=new HU(i)),a},a.projection(t).digits(i).context(e)}function qU(t){return function(e){var n=new ZU;for(var r in t)n[r]=t[r];return n.stream=e,n}}function ZU(){}function $U(t,e,n){var r=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),null!=r&&t.clipExtent(null),cz(n,t.stream(oU)),e(oU.result()),null!=r&&t.clipExtent(r),t}function KU(t,e,n){return $U(t,(function(n){var r=e[1][0]-e[0][0],i=e[1][1]-e[0][1],o=Math.min(r/(n[1][0]-n[0][0]),i/(n[1][1]-n[0][1])),a=+e[0][0]+(r-o*(n[1][0]+n[0][0]))/2,s=+e[0][1]+(i-o*(n[1][1]+n[0][1]))/2;t.scale(150*o).translate([a,s])}),n)}function JU(t,e,n){return KU(t,[[0,0],e],n)}function QU(t,e,n){return $U(t,(function(n){var r=+e,i=r/(n[1][0]-n[0][0]),o=(r-i*(n[1][0]+n[0][0]))/2,a=-i*n[0][1];t.scale(150*i).translate([o,a])}),n)}function tV(t,e,n){return $U(t,(function(n){var r=+e,i=r/(n[1][1]-n[0][1]),o=-i*n[0][0],a=(r-i*(n[1][1]+n[0][1]))/2;t.scale(150*i).translate([o,a])}),n)}ZU.prototype={constructor:ZU,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var eV=YB(30*VB);function nV(t,e){return+e?function(t,e){function n(r,i,o,a,s,u,c,l,h,f,p,d,m,v){var g=c-r,y=l-i,x=g*g+y*y;if(x>4*e&&m--){var b=a+f,_=s+p,w=u+d,S=QB(b*b+_*_+w*w),M=nz(w/=S),E=GB(GB(w)-1)<DB||GB(o-h)<DB?(o+h)/2:HB(_,b),A=t(E,M),T=A[0],C=A[1],O=T-r,k=C-i,P=y*O-g*k;(P*P/x>e||GB((g*O+y*k)/x-.5)>.3||a*f+s*p+u*d<eV)&&(n(r,i,o,a,s,u,T,C,E,b/=S,_/=S,w,m,v),v.point(T,C),n(T,C,E,b,_,w,c,l,h,f,p,d,m,v))}}return function(e){var r,i,o,a,s,u,c,l,h,f,p,d,m={point:v,lineStart:g,lineEnd:x,polygonStart:function(){e.polygonStart(),m.lineStart=b},polygonEnd:function(){e.polygonEnd(),m.lineStart=g}};function v(n,r){n=t(n,r),e.point(n[0],n[1])}function g(){l=NaN,m.point=y,e.lineStart()}function y(r,i){var o=hz([r,i]),a=t(r,i);n(l,h,c,f,p,d,l=a[0],h=a[1],c=r,f=o[0],p=o[1],d=o[2],16,e),e.point(l,h)}function x(){m.point=v,e.lineEnd()}function b(){g(),m.point=_,m.lineEnd=w}function _(t,e){y(r=t,e),i=l,o=h,a=f,s=p,u=d,m.point=y}function w(){n(l,h,c,f,p,d,i,o,r,a,s,u,16,e),m.lineEnd=x,x()}return m}}(t,e):function(t){return qU({point:function(e,n){e=t(e,n),this.stream.point(e[0],e[1])}})}(t)}var rV=qU({point:function(t,e){this.stream.point(t*VB,e*VB)}});function iV(t,e,n,r,i,o){if(!o)return function(t,e,n,r,i){function o(o,a){return[e+t*(o*=r),n-t*(a*=i)]}return o.invert=function(o,a){return[(o-e)/t*r,(n-a)/t*i]},o}(t,e,n,r,i);var a=YB(o),s=KB(o),u=a*t,c=s*t,l=a/t,h=s/t,f=(s*n-a*e)/t,p=(s*e+a*n)/t;function d(t,o){return[u*(t*=r)-c*(o*=i)+e,n-c*t-u*o]}return d.invert=function(t,e){return[r*(l*t-h*e+f),i*(p-h*t-l*e)]},d}function oV(t){return aV((function(){return t}))()}function aV(t){var e,n,r,i,o,a,s,u,c,l,h=150,f=480,p=250,d=0,m=0,v=0,g=0,y=0,x=0,b=1,_=1,w=null,S=Rz,M=null,E=Uz,A=.5;function T(t){return u(t[0]*VB,t[1]*VB)}function C(t){return(t=u.invert(t[0],t[1]))&&[t[0]*UB,t[1]*UB]}function O(){var t=iV(h,0,0,b,_,x).apply(null,e(d,m)),r=iV(h,f-t[0],p-t[1],b,_,x);return n=xz(v,g,y),s=gz(e,r),u=gz(n,s),a=nV(s,A),k()}function k(){return c=l=null,T}return T.stream=function(t){return c&&l===t?c:c=rV(function(t){return qU({point:function(e,n){var r=t(e,n);return this.stream.point(r[0],r[1])}})}(n)(S(a(E(l=t)))))},T.preclip=function(t){return arguments.length?(S=t,w=void 0,k()):S},T.postclip=function(t){return arguments.length?(E=t,M=r=i=o=null,k()):E},T.clipAngle=function(t){return arguments.length?(S=+t?Iz(w=t*VB):(w=null,Rz),k()):w*UB},T.clipExtent=function(t){return arguments.length?(E=null==t?(M=r=i=o=null,Uz):Fz(M=+t[0][0],r=+t[0][1],i=+t[1][0],o=+t[1][1]),k()):null==M?null:[[M,r],[i,o]]},T.scale=function(t){return arguments.length?(h=+t,O()):h},T.translate=function(t){return arguments.length?(f=+t[0],p=+t[1],O()):[f,p]},T.center=function(t){return arguments.length?(d=t[0]%360*VB,m=t[1]%360*VB,O()):[d*UB,m*UB]},T.rotate=function(t){return arguments.length?(v=t[0]%360*VB,g=t[1]%360*VB,y=t.length>2?t[2]%360*VB:0,O()):[v*UB,g*UB,y*UB]},T.angle=function(t){return arguments.length?(x=t%360*VB,O()):x*UB},T.reflectX=function(t){return arguments.length?(b=t?-1:1,O()):b<0},T.reflectY=function(t){return arguments.length?(_=t?-1:1,O()):_<0},T.precision=function(t){return arguments.length?(a=nV(s,A=t*t),k()):QB(A)},T.fitExtent=function(t,e){return KU(T,t,e)},T.fitSize=function(t,e){return JU(T,t,e)},T.fitWidth=function(t,e){return QU(T,t,e)},T.fitHeight=function(t,e){return tV(T,t,e)},function(){return e=t.apply(this,arguments),T.invert=e.invert&&C,O()}}function sV(t){var e=0,n=FB/3,r=aV(t),i=r(e,n);return i.parallels=function(t){return arguments.length?r(e=t[0]*VB,n=t[1]*VB):[e*UB,n*UB]},i}function uV(t,e){var n=KB(t),r=(n+KB(e))/2;if(GB(r)<DB)return function(t){var e=YB(t);function n(t,n){return[t*e,KB(n)/e]}return n.invert=function(t,n){return[t/e,nz(n*e)]},n}(t);var i=1+n*(2*r-n),o=QB(i)/r;function a(t,e){var n=QB(i-2*r*KB(e))/r;return[n*KB(t*=r),o-n*YB(t)]}return a.invert=function(t,e){var n=o-e,a=HB(t,GB(n))*JB(n);return n*r<0&&(a-=FB*JB(t)*JB(n)),[a/r,nz((i-(t*t+n*n)*r*r)/(2*r))]},a}function cV(){return sV(uV).scale(155.424).center([0,33.6442])}function lV(){return cV().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function hV(t){return function(e,n){var r=YB(e),i=YB(n),o=t(r*i);return o===1/0?[2,0]:[o*i*KB(e),o*KB(n)]}}function fV(t){return function(e,n){var r=QB(e*e+n*n),i=t(r),o=KB(i),a=YB(i);return[HB(e*o,r*a),nz(r&&n*o/r)]}}var pV=hV((function(t){return QB(2/(1+t))}));pV.invert=fV((function(t){return 2*nz(t/2)}));var dV=hV((function(t){return(t=ez(t))&&t/KB(t)}));function mV(t,e){return[t,ZB(tz((jB+e)/2))]}function vV(t){var e,n,r,i=oV(t),o=i.center,a=i.scale,s=i.translate,u=i.clipExtent,c=null;function l(){var o=FB*a(),s=i(function(t){function e(e){return(e=t(e[0]*VB,e[1]*VB))[0]*=UB,e[1]*=UB,e}return t=xz(t[0]*VB,t[1]*VB,t.length>2?t[2]*VB:0),e.invert=function(e){return(e=t.invert(e[0]*VB,e[1]*VB))[0]*=UB,e[1]*=UB,e},e}(i.rotate()).invert([0,0]));return u(null==c?[[s[0]-o,s[1]-o],[s[0]+o,s[1]+o]]:t===mV?[[Math.max(s[0]-o,c),e],[Math.min(s[0]+o,n),r]]:[[c,Math.max(s[1]-o,e)],[n,Math.min(s[1]+o,r)]])}return i.scale=function(t){return arguments.length?(a(t),l()):a()},i.translate=function(t){return arguments.length?(s(t),l()):s()},i.center=function(t){return arguments.length?(o(t),l()):o()},i.clipExtent=function(t){return arguments.length?(null==t?c=e=n=r=null:(c=+t[0][0],e=+t[0][1],n=+t[1][0],r=+t[1][1]),l()):null==c?null:[[c,e],[n,r]]},l()}function gV(t){return tz((jB+t)/2)}function yV(t,e){var n=YB(t),r=t===e?KB(t):ZB(n/YB(e))/ZB(gV(e)/gV(t)),i=n*$B(gV(t),r)/r;if(!r)return mV;function o(t,e){i>0?e<-jB+DB&&(e=-jB+DB):e>jB-DB&&(e=jB-DB);var n=i/$B(gV(e),r);return[n*KB(r*t),i-n*YB(r*t)]}return o.invert=function(t,e){var n=i-e,o=JB(r)*QB(t*t+n*n),a=HB(t,GB(n))*JB(n);return n*r<0&&(a-=FB*JB(t)*JB(n)),[a/r,2*WB($B(i/o,1/r))-jB]},o}function xV(t,e){return[t,e]}function bV(t,e){var n=YB(t),r=t===e?KB(t):(n-YB(e))/(e-t),i=n/r+t;if(GB(r)<DB)return xV;function o(t,e){var n=i-e,o=r*t;return[n*KB(o),i-n*YB(o)]}return o.invert=function(t,e){var n=i-e,o=HB(t,GB(n))*JB(n);return n*r<0&&(o-=FB*JB(t)*JB(n)),[o/r,i-JB(r)*QB(t*t+n*n)]},o}dV.invert=fV((function(t){return t})),mV.invert=function(t,e){return[t,2*WB(qB(e))-jB]},xV.invert=xV;var _V=1.340264,wV=-.081106,SV=893e-6,MV=.003796,EV=QB(3)/2;function AV(t,e){var n=nz(EV*KB(e)),r=n*n,i=r*r*r;return[t*YB(n)/(EV*(_V+3*wV*r+i*(7*SV+9*MV*r))),n*(_V+wV*r+i*(SV+MV*r))]}function TV(t,e){var n=YB(e),r=YB(t)*n;return[n*KB(t)/r,KB(e)/r]}function CV(t,e){var n=e*e,r=n*n;return[t*(.8707-.131979*n+r*(r*(.003971*n-.001529*r)-.013791)),e*(1.007226+n*(.015085+r*(.028874*n-.044475-.005916*r)))]}function OV(t,e){return[YB(e)*KB(t),KB(e)]}function kV(t,e){var n=YB(e),r=1+YB(t)*n;return[n*KB(t)/r,KB(e)/r]}function PV(t,e){return[ZB(tz((jB+e)/2)),-t]}AV.invert=function(t,e){for(var n,r=e,i=r*r,o=i*i*i,a=0;a<12&&(o=(i=(r-=n=(r*(_V+wV*i+o*(SV+MV*i))-e)/(_V+3*wV*i+o*(7*SV+9*MV*i)))*r)*i*i,!(GB(n)<1e-12));++a);return[EV*t*(_V+3*wV*i+o*(7*SV+9*MV*i))/YB(r),nz(KB(r)/EV)]},TV.invert=fV(WB),CV.invert=function(t,e){var n,r=e,i=25;do{var o=r*r,a=o*o;r-=n=(r*(1.007226+o*(.015085+a*(.028874*o-.044475-.005916*a)))-e)/(1.007226+o*(.045255+a*(.259866*o-.311325-.005916*11*a)))}while(GB(n)>DB&&--i>0);return[t/(.8707+(o=r*r)*(o*(o*o*o*(.003971-.001529*o)-.013791)-.131979)),r]},OV.invert=fV(nz),kV.invert=fV((function(t){return 2*WB(t)})),PV.invert=function(t,e){return[-e,2*WB(qB(t))-jB]};const LV=Object.freeze(Object.defineProperty({__proto__:null,geoAlbers:lV,geoAlbersUsa:function(){var t,e,n,r,i,o,a=lV(),s=cV().rotate([154,0]).center([-2,58.5]).parallels([55,65]),u=cV().rotate([157,0]).center([-3,19.9]).parallels([8,18]),c={point:function(t,e){o=[t,e]}};function l(t){var e=t[0],a=t[1];return o=null,n.point(e,a),o||(r.point(e,a),o)||(i.point(e,a),o)}function h(){return t=e=null,l}return l.invert=function(t){var e=a.scale(),n=a.translate(),r=(t[0]-n[0])/e,i=(t[1]-n[1])/e;return(i>=.12&&i<.234&&r>=-.425&&r<-.214?s:i>=.166&&i<.234&&r>=-.214&&r<-.115?u:a).invert(t)},l.stream=function(n){return t&&e===n?t:(r=[a.stream(e=n),s.stream(n),u.stream(n)],i=r.length,t={point:function(t,e){for(var n=-1;++n<i;)r[n].point(t,e)},sphere:function(){for(var t=-1;++t<i;)r[t].sphere()},lineStart:function(){for(var t=-1;++t<i;)r[t].lineStart()},lineEnd:function(){for(var t=-1;++t<i;)r[t].lineEnd()},polygonStart:function(){for(var t=-1;++t<i;)r[t].polygonStart()},polygonEnd:function(){for(var t=-1;++t<i;)r[t].polygonEnd()}});var r,i},l.precision=function(t){return arguments.length?(a.precision(t),s.precision(t),u.precision(t),h()):a.precision()},l.scale=function(t){return arguments.length?(a.scale(t),s.scale(.35*t),u.scale(t),l.translate(a.translate())):a.scale()},l.translate=function(t){if(!arguments.length)return a.translate();var e=a.scale(),o=+t[0],l=+t[1];return n=a.translate(t).clipExtent([[o-.455*e,l-.238*e],[o+.455*e,l+.238*e]]).stream(c),r=s.translate([o-.307*e,l+.201*e]).clipExtent([[o-.425*e+DB,l+.12*e+DB],[o-.214*e-DB,l+.234*e-DB]]).stream(c),i=u.translate([o-.205*e,l+.212*e]).clipExtent([[o-.214*e+DB,l+.166*e+DB],[o-.115*e-DB,l+.234*e-DB]]).stream(c),h()},l.fitExtent=function(t,e){return KU(l,t,e)},l.fitSize=function(t,e){return JU(l,t,e)},l.fitWidth=function(t,e){return QU(l,t,e)},l.fitHeight=function(t,e){return tV(l,t,e)},l.scale(1070)},geoAzimuthalEqualArea:function(){return oV(pV).scale(124.75).clipAngle(179.999)},geoAzimuthalEqualAreaRaw:pV,geoAzimuthalEquidistant:function(){return oV(dV).scale(79.4188).clipAngle(179.999)},geoAzimuthalEquidistantRaw:dV,geoConicConformal:function(){return sV(yV).scale(109.5).parallels([30,30])},geoConicConformalRaw:yV,geoConicEqualArea:cV,geoConicEqualAreaRaw:uV,geoConicEquidistant:function(){return sV(bV).scale(131.154).center([0,13.9389])},geoConicEquidistantRaw:bV,geoEqualEarth:function(){return oV(AV).scale(177.158)},geoEqualEarthRaw:AV,geoEquirectangular:function(){return oV(xV).scale(152.63)},geoEquirectangularRaw:xV,geoGnomonic:function(){return oV(TV).scale(144.049).clipAngle(60)},geoGnomonicRaw:TV,geoIdentity:function(){var t,e,n,r,i,o,a,s=1,u=0,c=0,l=1,h=1,f=0,p=null,d=1,m=1,v=qU({point:function(t,e){var n=x([t,e]);this.stream.point(n[0],n[1])}}),g=Uz;function y(){return d=s*l,m=s*h,o=a=null,x}function x(n){var r=n[0]*d,i=n[1]*m;if(f){var o=i*t-r*e;r=r*t+i*e,i=o}return[r+u,i+c]}return x.invert=function(n){var r=n[0]-u,i=n[1]-c;if(f){var o=i*t+r*e;r=r*t-i*e,i=o}return[r/d,i/m]},x.stream=function(t){return o&&a===t?o:o=v(g(a=t))},x.postclip=function(t){return arguments.length?(g=t,p=n=r=i=null,y()):g},x.clipExtent=function(t){return arguments.length?(g=null==t?(p=n=r=i=null,Uz):Fz(p=+t[0][0],n=+t[0][1],r=+t[1][0],i=+t[1][1]),y()):null==p?null:[[p,n],[r,i]]},x.scale=function(t){return arguments.length?(s=+t,y()):s},x.translate=function(t){return arguments.length?(u=+t[0],c=+t[1],y()):[u,c]},x.angle=function(n){return arguments.length?(e=KB(f=n%360*VB),t=YB(f),y()):f*UB},x.reflectX=function(t){return arguments.length?(l=t?-1:1,y()):l<0},x.reflectY=function(t){return arguments.length?(h=t?-1:1,y()):h<0},x.fitExtent=function(t,e){return KU(x,t,e)},x.fitSize=function(t,e){return JU(x,t,e)},x.fitWidth=function(t,e){return QU(x,t,e)},x.fitHeight=function(t,e){return tV(x,t,e)},x},geoMercator:function(){return vV(mV).scale(961/zB)},geoMercatorRaw:mV,geoNaturalEarth1:function(){return oV(CV).scale(175.295)},geoNaturalEarth1Raw:CV,geoOrthographic:function(){return oV(OV).scale(249.5).clipAngle(90.000001)},geoOrthographicRaw:OV,geoProjection:oV,geoProjectionMutator:aV,geoStereographic:function(){return oV(kV).scale(250).clipAngle(142)},geoStereographicRaw:kV,geoTransverseMercator:function(){var t=vV(PV),e=t.center,n=t.rotate;return t.center=function(t){return arguments.length?e([-t[1],t[0]]):[(t=e())[1],-t[0]]},t.rotate=function(t){return arguments.length?n([t[0],t[1],t.length>2?t[2]+90:90]):[(t=n())[0],t[1],t[2]-90]},n([0,0,90]).scale(159.155)},geoTransverseMercatorRaw:PV},Symbol.toStringTag,{value:"Module"}));var RV=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};function IV(t,e,n,r){const i=()=>{const t=e.filter(DV);return t.find((t=>t.sphere))?{type:"Sphere"}:{type:"FeatureCollection",features:t.filter((t=>!t.sphere)).flatMap((t=>t.data.value)).flatMap((t=>function(t){const e={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featureCollection"};if(!t||!t.type)return null;const n=e[t.type];return n?"geometry"===n?{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:t}]}:"feature"===n?{type:"FeatureCollection",features:[t]}:"featureCollection"===n?t:void 0:null}(t).features))}},{outline:o=i()}=r,{size:a="fitExtent"}=r;return"fitExtent"===a?function(t,e,n){const{x:r,y:i,width:o,height:a}=n;t.fitExtent([[r,i],[o,a]],e)}(t,o,n):"fitWidth"===a?function(t,e,n){const{width:r,height:i}=n,[[o,a],[s,u]]=XU(t.fitWidth(r,e)).bounds(e),c=Math.ceil(u-a),l=Math.min(Math.ceil(s-o),c),h=t.scale()*(l-1)/l,[f,p]=t.translate(),d=p+(i-c)/2;t.scale(h).translate([f,d]).precision(.2)}(t,o,n):void 0}function NV(t){const{data:e}=t;if(Array.isArray(e))return Object.assign(Object.assign({},t),{data:{value:e}});const{type:n}=e;return"graticule10"===n?Object.assign(Object.assign({},t),{data:{value:[zz()]}}):"sphere"===n?Object.assign(Object.assign({},t),{sphere:!0,data:{value:[{type:"Sphere"}]}}):t}function DV(t){return"geoPath"===t.type}const FV=()=>t=>{const{children:e,projection:n={}}=t;if(!Array.isArray(e))return[];const{type:r="equalEarth"}=n,i=RV(n,["type"]),o=function(t){if("function"==typeof t)return t;const e=`geo${Jy(t)}`,n=LV[e];if(!n)throw new Error(`Unknown projection: ${t}`);return n}(r),a=e.map(NV);let s;return[Object.assign(Object.assign({},t),{type:"view",scale:{x:{type:"identity"},y:{type:"identity"}},axis:!1,coordinates:[{type:function(){return[["custom",(t,e,n,r)=>{const u=o();IV(u,a,{x:t,y:e,width:n,height:r},i),function(t,e){var n;for(const[r,i]of Object.entries(e))null===(n=t[r])||void 0===n||n.call(t,i)}(u,i),s=XU(u);const c=new qA({domain:[t,t+n]}),l=new qA({domain:[e,e+r]});return{transform:t=>(t=>{const e=u(t);if(!e)return null;const[n,r]=e;return[c.map(n),l.map(r)]})(t),untransform:t=>(t=>{if(!t)return null;const[e,n]=t,r=[c.invert(e),l.invert(n)];return u.invert(r)})(t)}}]]}}],children:a.flatMap((t=>DV(t)?function(t){const{style:e}=t;return Object.assign(Object.assign({},t),{type:"path",style:Object.assign(Object.assign({},e),{d:t=>s(t)})})}(t):t))})]};FV.props={};var jV=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const BV=()=>t=>{const{type:e,data:n,scale:r,encode:i,style:o,animate:a,key:s}=t,u=jV(t,["type","data","scale","encode","style","animate","key"]);return[Object.assign(Object.assign({type:"geoView"},u),{children:[{type:"geoPath",key:`${s}-0`,data:{value:n},scale:r,encode:i,style:o,animate:a}]})]};BV.props={};const zV={"composition.geoView":FV,"composition.geoPath":BV};function UV(){return Object.assign({"data.fetch":JS,"data.inline":uM,"data.sortBy":sM,"data.sort":nM,"data.filter":eM,"data.pick":oM,"data.rename":aM,"data.subset":iM,"data.fold":QS,"data.custom":cM,"data.map":lM,"data.cluster":BS,"data.tree":zS,"data.sankey":mw,"data.arc":dM,"data.wordCloud":jM,"data.join":zM,"transform.maybeZeroY1":HF,"transform.maybeZeroX":oj,"transform.maybeStackY":rj,"transform.maybeTitle":ij,"transform.maybeSeries":lj,"transform.maybeZeroPadding":vj,"transform.stackY":ej,"transform.binX":xB,"transform.bin":yB,"transform.dodgeX":Sj,"transform.jitter":Oj,"transform.jitterX":kj,"transform.symmetryY":Lj,"transform.diffY":Rj,"transform.stackEnter":Mj,"transform.normalizeY":Aj,"transform.select":Bj,"transform.selectX":Uj,"transform.selectY":Gj,"transform.groupX":rB,"transform.groupY":iB,"transform.groupColor":oB,"transform.group":nB,"transform.maybeSize":sj,"transform.maybeZeroY":aj,"transform.maybeKey":cj,"transform.sortX":cB,"transform.sortY":hB,"transform.sortColor":lB,"transform.flexX":fB,"transform.maybeTupleY":hj,"transform.maybeTupleX":fj,"transform.maybeIdentityY":pj,"transform.maybeIdentityX":dj,"transform.maybeTuple":bj,"transform.maybeVisualPosition":yj,"transform.maybeFunctionAttribute":xj,"transform.maybeGradient":_j,"transform.maybeTooltip":mj,"transform.pack":dB,"transform.sample":_B,"transform.filter":wB,"coordinate.cartesian":ax,"coordinate.polar":sx,"coordinate.helix":ux,"coordinate.transpose":cx,"coordinate.theta":px,"coordinate.reflect":lx,"coordinate.reflectX":hx,"coordinate.reflectY":fx,"coordinate.parallel":mx,"coordinate.fisheye":vx,"coordinate.fisheyeX":gx,"coordinate.fisheyeY":yx,"coordinate.radial":dx,"encode.constant":xx,"encode.field":_x,"encode.transform":bx,"encode.column":Sx,"mark.interval":jb,"mark.rect":Bb,"mark.line":D_,"mark.point":F_,"mark.text":j_,"mark.cell":B_,"mark.area":z_,"mark.link":U_,"mark.image":V_,"mark.polygon":G_,"mark.box":W_,"mark.vector":H_,"mark.lineX":X_,"mark.lineY":Y_,"mark.connector":q_,"mark.range":K_,"mark.rangeX":J_,"mark.rangeY":Q_,"mark.sankey":Ow,"mark.path":kw,"mark.treemap":Dw,"mark.pack":jw,"mark.boxplot":qw,"mark.shape":Zw,"mark.forceGraph":FS,"mark.tree":US,"mark.wordCloud":GM,"palette.category10":WM,"palette.category20":HM,"palette.sequentialBlue":YM,"palette.sequentialDarkBlue":XM,"palette.sequentialGreen":qM,"palette.sequentialDarkGreen":ZM,"palette.sequentialGrey":$M,"palette.sequentialOrange":KM,"palette.sequentialPink":JM,"palette.sequentialRed":QM,"palette.sequentialYellow":tE,"palette.sequentialPurple":eE,"palette.sequentialYellowOrange":nE,"palette.sequentialYellowGreen":rE,"palette.sequentialPinkPurple":iE,"palette.sequentialGreenBlue":oE,"palette.divergingGreenYellow":aE,"palette.divergingRedBlue":sE,"palette.divergingGreenRed":uE,"palette.divergingRedPurple":cE,"scale.linear":AT,"scale.ordinal":TT,"scale.band":ET,"scale.identity":CT,"scale.point":OT,"scale.time":kT,"scale.log":PT,"scale.pow":LT,"scale.sqrt":DT,"scale.threshold":RT,"scale.quantile":IT,"scale.quantize":NT,"scale.sequential":FT,"shape.interval.rect":cO,"shape.interval.hollow":lO,"shape.interval.funnel":pO,"shape.interval.pyramid":mO,"shape.rect.rect":cO,"shape.rect.hollow":lO,"shape.cell.cell":cO,"shape.cell.hollow":lO,"shape.line.line":bO,"shape.line.hv":SO,"shape.line.vh":MO,"shape.line.hvh":EO,"shape.line.smooth":wO,"shape.point.bowtie":kO,"shape.point.cross":PO,"shape.point.diamond":LO,"shape.point.hexagon":RO,"shape.point.hollowBowtie":IO,"shape.point.hollowDiamond":NO,"shape.point.hollowHexagon":DO,"shape.point.hollow":FO,"shape.point.hollowSquare":jO,"shape.point.hollowTriangle":BO,"shape.point.hollowTriangleDown":zO,"shape.point.hyphen":UO,"shape.point.line":VO,"shape.point.plus":GO,"shape.point.point":WO,"shape.point.square":HO,"shape.point.tick":YO,"shape.point.triangle":XO,"shape.point.triangleDown":qO,"shape.text.text":NR,"shape.area.area":VR,"shape.area.smooth":WR,"shape.area.step":HR,"shape.link.smooth":ZR,"shape.link.vhv":KR,"shape.link.arc":QR,"shape.link.link":XR,"shape.image.image":eI,"shape.polygon.polygon":rI,"shape.polygon.ribbon":oI,"shape.box.box":sI,"shape.vector.vector":$O,"shape.label.label":EI,"shape.text.badge":jR,"shape.lineX.line":cI,"shape.lineY.line":cI,"shape.shape.shape":PI,"shape.connector.connector":pI,"shape.range.range":cO,"shape.rangeX.range":cO,"shape.rangeY.range":cO,"shape.path.path":CI,"shape.path.hollow":OI,"theme.light":NI,"theme.dark":BI,"theme.academy":GI,"component.axisX":pN,"component.axisY":dN,"component.legendCategory":vN,"component.legendContinuous":yN,"component.title":_N,"component.sliderX":MN,"component.sliderY":EN,"animation.scaleInX":PN,"animation.scaleOutX":LN,"animation.scaleInY":RN,"animation.scaleOutY":IN,"animation.waveIn":WN,"animation.fadeIn":NN,"animation.fadeOut":DN,"animation.zoomIn":HN,"animation.zoomOut":YN,"animation.pathIn":XN,"animation.morphing":VN,"animation.growInX":qN,"animation.growInY":ZN,"interaction.elementHighlight":fD,"interaction.elementHighlightByX":pD,"interaction.elementHighlightByColor":dD,"interaction.elementSelect":gD,"interaction.elementSelectByX":yD,"interaction.elementSelectByColor":xD,"interaction.fisheye":SD,"interaction.chartIndex":wD,"interaction.tooltip":FD,"interaction.legendFilter":GD,"interaction.brushHighlight":qD,"interaction.brushXHighlight":ZD,"interaction.brushYHighlight":$D,"composition.spaceLayer":nF,"composition.spaceFlex":iF,"composition.mark":uF,"composition.view":aF,"composition.facetRect":wF,"composition.repeatMatrix":OF,"composition.facetCircle":DF,"composition.timingKeyframe":jF,"labelTransform.overlapHide":EB,"labelTransform.overlapDodgeY":OB,"labelTransform.overflowHide":NB,"labelTransform.contrastReverse":IB},zV)}var VV,GV;function WV(t,e,...n){if(!t)return;(t[e]||[]).forEach((t=>{t.apply(this,n)}))}(GV=VV||(VV={})).BEFORE_RENDER="beforerender",GV.AFTER_RENDER="afterrender",GV.BEFORE_PAINT="beforepaint",GV.AFTER_PAINT="afterpaint",GV.BEFORE_CHANGE_DATA="beforechangedata",GV.AFTER_CHANGE_DATA="afterchangedata",GV.BEFORE_CLEAR="beforeclear",GV.AFTER_CLEAR="afterclear",GV.BEFORE_DESTROY="beforedestroy",GV.AFTER_DESTROY="afterdestroy",GV.BEFORE_CHANGE_SIZE="beforechangesize",GV.AFTER_CHANGE_SIZE="afterchangesize";var HV=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};function YV(t,e){const n=n=>{if("string"!=typeof n)return n;const r=`${t}.${n}`;return e[r]||bw(`Unknown Component: ${r}`)};return[t=>{const{type:e}=t,r=HV(t,["type"]);return n(e)(Object.assign({},r))},n]}function XV(t){for(var e=t.length/6|0,n=new Array(e),r=0;r<e;)n[r]="#"+t.slice(6*r,6*++r);return n}const qV=XV("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),ZV=XV("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),$V=XV("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),KV=XV("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),JV=XV("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),QV=XV("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),tG=XV("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),eG=XV("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),nG=XV("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"),rG=XV("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab");function iG(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function oG(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function aG(){}var sG=.7,uG=1/sG,cG="\\s*([+-]?\\d+)\\s*",lG="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",hG="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",fG=/^#([0-9a-f]{3,8})$/,pG=new RegExp(`^rgb\\(${cG},${cG},${cG}\\)$`),dG=new RegExp(`^rgb\\(${hG},${hG},${hG}\\)$`),mG=new RegExp(`^rgba\\(${cG},${cG},${cG},${lG}\\)$`),vG=new RegExp(`^rgba\\(${hG},${hG},${hG},${lG}\\)$`),gG=new RegExp(`^hsl\\(${lG},${hG},${hG}\\)$`),yG=new RegExp(`^hsla\\(${lG},${hG},${hG},${lG}\\)$`),xG={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function bG(){return this.rgb().formatHex()}function _G(){return this.rgb().formatRgb()}function wG(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=fG.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?SG(e):3===n?new TG(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?MG(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?MG(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=pG.exec(t))?new TG(e[1],e[2],e[3],1):(e=dG.exec(t))?new TG(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=mG.exec(t))?MG(e[1],e[2],e[3],e[4]):(e=vG.exec(t))?MG(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=gG.exec(t))?RG(e[1],e[2]/100,e[3]/100,1):(e=yG.exec(t))?RG(e[1],e[2]/100,e[3]/100,e[4]):xG.hasOwnProperty(t)?SG(xG[t]):"transparent"===t?new TG(NaN,NaN,NaN,0):null}function SG(t){return new TG(t>>16&255,t>>8&255,255&t,1)}function MG(t,e,n,r){return r<=0&&(t=e=n=NaN),new TG(t,e,n,r)}function EG(t){return t instanceof aG||(t=wG(t)),t?new TG((t=t.rgb()).r,t.g,t.b,t.opacity):new TG}function AG(t,e,n,r){return 1===arguments.length?EG(t):new TG(t,e,n,null==r?1:r)}function TG(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function CG(){return`#${LG(this.r)}${LG(this.g)}${LG(this.b)}`}function OG(){const t=kG(this.opacity);return`${1===t?"rgb(":"rgba("}${PG(this.r)}, ${PG(this.g)}, ${PG(this.b)}${1===t?")":`, ${t})`}`}function kG(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function PG(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function LG(t){return((t=PG(t))<16?"0":"")+t.toString(16)}function RG(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new NG(t,e,n,r)}function IG(t){if(t instanceof NG)return new NG(t.h,t.s,t.l,t.opacity);if(t instanceof aG||(t=wG(t)),!t)return new NG;if(t instanceof NG)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),o=Math.max(e,n,r),a=NaN,s=o-i,u=(o+i)/2;return s?(a=e===o?(n-r)/s+6*(n<r):n===o?(r-e)/s+2:(e-n)/s+4,s/=u<.5?o+i:2-o-i,a*=60):s=u>0&&u<1?0:a,new NG(a,s,u,t.opacity)}function NG(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function DG(t){return(t=(t||0)%360)<0?t+360:t}function FG(t){return Math.max(0,Math.min(1,t||0))}function jG(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}iG(aG,wG,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:bG,formatHex:bG,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return IG(this).formatHsl()},formatRgb:_G,toString:_G}),iG(TG,AG,oG(aG,{brighter(t){return t=null==t?uG:Math.pow(uG,t),new TG(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?sG:Math.pow(sG,t),new TG(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new TG(PG(this.r),PG(this.g),PG(this.b),kG(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:CG,formatHex:CG,formatHex8:function(){return`#${LG(this.r)}${LG(this.g)}${LG(this.b)}${LG(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:OG,toString:OG})),iG(NG,(function(t,e,n,r){return 1===arguments.length?IG(t):new NG(t,e,n,null==r?1:r)}),oG(aG,{brighter(t){return t=null==t?uG:Math.pow(uG,t),new NG(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?sG:Math.pow(sG,t),new NG(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new TG(jG(t>=240?t-240:t+120,i,r),jG(t,i,r),jG(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new NG(DG(this.h),FG(this.s),FG(this.l),kG(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=kG(this.opacity);return`${1===t?"hsl(":"hsla("}${DG(this.h)}, ${100*FG(this.s)}%, ${100*FG(this.l)}%${1===t?")":`, ${t})`}`}}));const BG=Math.PI/180,zG=180/Math.PI;var UG=-.14861,VG=1.78277,GG=-.29227,WG=-.90649,HG=1.97294,YG=HG*WG,XG=HG*VG,qG=VG*GG-WG*UG;function ZG(t){if(t instanceof KG)return new KG(t.h,t.s,t.l,t.opacity);t instanceof TG||(t=EG(t));var e=t.r/255,n=t.g/255,r=t.b/255,i=(qG*r+YG*e-XG*n)/(qG+YG-XG),o=r-i,a=(HG*(n-i)-GG*o)/WG,s=Math.sqrt(a*a+o*o)/(HG*i*(1-i)),u=s?Math.atan2(a,o)*zG-120:NaN;return new KG(u<0?u+360:u,s,i,t.opacity)}function $G(t,e,n,r){return 1===arguments.length?ZG(t):new KG(t,e,n,null==r?1:r)}function KG(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}iG(KG,$G,oG(aG,{brighter(t){return t=null==t?uG:Math.pow(uG,t),new KG(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?sG:Math.pow(sG,t),new KG(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=isNaN(this.h)?0:(this.h+120)*BG,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),r=Math.cos(t),i=Math.sin(t);return new TG(255*(e+n*(UG*r+VG*i)),255*(e+n*(GG*r+WG*i)),255*(e+n*(HG*r)),this.opacity)}}));const JG=t=>()=>t;function QG(t,e){return function(n){return t+n*e}}function tW(t){return 1==(t=+t)?eW:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):JG(isNaN(e)?n:e)}}function eW(t,e){var n=e-t;return n?QG(t,n):JG(isNaN(t)?e:t)}!function t(e){var n=tW(e);function r(t,e){var r=n((t=AG(t)).r,(e=AG(e)).r),i=n(t.g,e.g),o=n(t.b,e.b),a=eW(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=o(e),t.opacity=a(e),t+""}}return r.gamma=t,r}(1);var nW,rW=(nW=function(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],o=t[r+1],a=r>0?t[r-1]:2*i-o,s=r<e-1?t[r+2]:2*o-i;return function(t,e,n,r,i){var o=t*t,a=o*t;return((1-3*t+3*o-a)*e+(4-6*o+3*a)*n+(1+3*t+3*o-3*a)*r+a*i)/6}((n-r/e)*e,a,i,o,s)}},function(t){var e,n,r=t.length,i=new Array(r),o=new Array(r),a=new Array(r);for(e=0;e<r;++e)n=AG(t[e]),i[e]=n.r||0,o[e]=n.g||0,a[e]=n.b||0;return i=nW(i),o=nW(o),a=nW(a),n.opacity=1,function(t){return n.r=i(t),n.g=o(t),n.b=a(t),n+""}});function iW(t){return function e(n){function r(e,r){var i=t((e=$G(e)).h,(r=$G(r)).h),o=eW(e.s,r.s),a=eW(e.l,r.l),s=eW(e.opacity,r.opacity);return function(t){return e.h=i(t),e.s=o(t),e.l=a(Math.pow(t,n)),e.opacity=s(t),e+""}}return n=+n,r.gamma=e,r}(1)}iW((function(t,e){var n=e-t;return n?QG(t,n>180||n<-180?n-360*Math.round(n/360):n):JG(isNaN(t)?e:t)}));var oW=iW(eW);const aW=t=>rW(t[t.length-1]);var sW=new Array(3).concat("d8b365f5f5f55ab4ac","a6611adfc27d80cdc1018571","a6611adfc27df5f5f580cdc1018571","8c510ad8b365f6e8c3c7eae55ab4ac01665e","8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e","8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e","8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e","5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30","5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30").map(XV);const uW=aW(sW);var cW=new Array(3).concat("af8dc3f7f7f77fbf7b","7b3294c2a5cfa6dba0008837","7b3294c2a5cff7f7f7a6dba0008837","762a83af8dc3e7d4e8d9f0d37fbf7b1b7837","762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837","762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837","762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837","40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b","40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b").map(XV);const lW=aW(cW);var hW=new Array(3).concat("e9a3c9f7f7f7a1d76a","d01c8bf1b6dab8e1864dac26","d01c8bf1b6daf7f7f7b8e1864dac26","c51b7de9a3c9fde0efe6f5d0a1d76a4d9221","c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221","c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221","c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221","8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419","8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419").map(XV);const fW=aW(hW);var pW=new Array(3).concat("998ec3f7f7f7f1a340","5e3c99b2abd2fdb863e66101","5e3c99b2abd2f7f7f7fdb863e66101","542788998ec3d8daebfee0b6f1a340b35806","542788998ec3d8daebf7f7f7fee0b6f1a340b35806","5427888073acb2abd2d8daebfee0b6fdb863e08214b35806","5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806","2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08","2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08").map(XV);const dW=aW(pW);var mW=new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(XV);const vW=aW(mW);var gW=new Array(3).concat("ef8a62ffffff999999","ca0020f4a582bababa404040","ca0020f4a582ffffffbababa404040","b2182bef8a62fddbc7e0e0e09999994d4d4d","b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d","b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d","b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d","67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a","67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a").map(XV);const yW=aW(gW);var xW=new Array(3).concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(XV);const bW=aW(xW);var _W=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(XV);const wW=aW(_W);var SW=new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(XV);const MW=aW(SW);var EW=new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(XV);const AW=aW(EW);var TW=new Array(3).concat("e0ecf49ebcda8856a7","edf8fbb3cde38c96c688419d","edf8fbb3cde38c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b").map(XV);const CW=aW(TW);var OW=new Array(3).concat("e0f3dba8ddb543a2ca","f0f9e8bae4bc7bccc42b8cbe","f0f9e8bae4bc7bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081").map(XV);const kW=aW(OW);var PW=new Array(3).concat("fee8c8fdbb84e34a33","fef0d9fdcc8afc8d59d7301f","fef0d9fdcc8afc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000").map(XV);const LW=aW(PW);var RW=new Array(3).concat("ece2f0a6bddb1c9099","f6eff7bdc9e167a9cf02818a","f6eff7bdc9e167a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636").map(XV);const IW=aW(RW);var NW=new Array(3).concat("ece7f2a6bddb2b8cbe","f1eef6bdc9e174a9cf0570b0","f1eef6bdc9e174a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858").map(XV);const DW=aW(NW);var FW=new Array(3).concat("e7e1efc994c7dd1c77","f1eef6d7b5d8df65b0ce1256","f1eef6d7b5d8df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f").map(XV);const jW=aW(FW);var BW=new Array(3).concat("fde0ddfa9fb5c51b8a","feebe2fbb4b9f768a1ae017e","feebe2fbb4b9f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a").map(XV);const zW=aW(BW);var UW=new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(XV);const VW=aW(UW);var GW=new Array(3).concat("f7fcb9addd8e31a354","ffffccc2e69978c679238443","ffffccc2e69978c67931a354006837","ffffccd9f0a3addd8e78c67931a354006837","ffffccd9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529").map(XV);const WW=aW(GW);var HW=new Array(3).concat("fff7bcfec44fd95f0e","ffffd4fed98efe9929cc4c02","ffffd4fed98efe9929d95f0e993404","ffffd4fee391fec44ffe9929d95f0e993404","ffffd4fee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506").map(XV);const YW=aW(HW);var XW=new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(XV);const qW=aW(XW);var ZW=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(XV);const $W=aW(ZW);var KW=new Array(3).concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(XV);const JW=aW(KW);var QW=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(XV);const tH=aW(QW);var eH=new Array(3).concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(XV);const nH=aW(eH);var rH=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(XV);const iH=aW(rH);var oH=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(XV);const aH=aW(oH);const sH=oW($G(300,.5,0),$G(-240,.5,1));var uH=oW($G(-100,.75,.35),$G(80,1.5,.8)),cH=oW($G(260,.75,.35),$G(80,1.5,.8)),lH=$G();var hH=AG(),fH=Math.PI/3,pH=2*Math.PI/3;function dH(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}const mH=dH(XV("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725"));var vH=dH(XV("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),gH=dH(XV("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),yH=dH(XV("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));const xH=Object.freeze(Object.defineProperty({__proto__:null,interpolateBlues:$W,interpolateBrBG:uW,interpolateBuGn:AW,interpolateBuPu:CW,interpolateCividis:function(t){return t=Math.max(0,Math.min(1,t)),"rgb("+Math.max(0,Math.min(255,Math.round(-4.54-t*(35.34-t*(2381.73-t*(6402.7-t*(7024.72-2710.57*t)))))))+", "+Math.max(0,Math.min(255,Math.round(32.49+t*(170.73+t*(52.82-t*(131.46-t*(176.58-67.37*t)))))))+", "+Math.max(0,Math.min(255,Math.round(81.24+t*(442.36-t*(2482.43-t*(6167.24-t*(6614.94-2475.67*t)))))))+")"},interpolateCool:cH,interpolateCubehelixDefault:sH,interpolateGnBu:kW,interpolateGreens:JW,interpolateGreys:tH,interpolateInferno:gH,interpolateMagma:vH,interpolateOrRd:LW,interpolateOranges:aH,interpolatePRGn:lW,interpolatePiYG:fW,interpolatePlasma:yH,interpolatePuBu:DW,interpolatePuBuGn:IW,interpolatePuOr:dW,interpolatePuRd:jW,interpolatePurples:nH,interpolateRainbow:function(t){(t<0||t>1)&&(t-=Math.floor(t));var e=Math.abs(t-.5);return lH.h=360*t-100,lH.s=1.5-1.5*e,lH.l=.8-.9*e,lH+""},interpolateRdBu:vW,interpolateRdGy:yW,interpolateRdPu:zW,interpolateRdYlBu:bW,interpolateRdYlGn:wW,interpolateReds:iH,interpolateSinebow:function(t){var e;return t=(.5-t)*Math.PI,hH.r=255*(e=Math.sin(t))*e,hH.g=255*(e=Math.sin(t+fH))*e,hH.b=255*(e=Math.sin(t+pH))*e,hH+""},interpolateSpectral:MW,interpolateTurbo:function(t){return t=Math.max(0,Math.min(1,t)),"rgb("+Math.max(0,Math.min(255,Math.round(34.61+t*(1172.33-t*(10793.56-t*(33300.12-t*(38394.49-14825.05*t)))))))+", "+Math.max(0,Math.min(255,Math.round(23.31+t*(557.33+t*(1225.33-t*(3574.96-t*(1073.77+707.56*t)))))))+", "+Math.max(0,Math.min(255,Math.round(27.2+t*(3211.1-t*(15327.97-t*(27814-t*(22569.18-6838.66*t)))))))+")"},interpolateViridis:mH,interpolateWarm:uH,interpolateYlGn:WW,interpolateYlGnBu:VW,interpolateYlOrBr:YW,interpolateYlOrRd:qW,schemeAccent:ZV,schemeBlues:ZW,schemeBrBG:sW,schemeBuGn:EW,schemeBuPu:TW,schemeCategory10:qV,schemeDark2:$V,schemeGnBu:OW,schemeGreens:KW,schemeGreys:QW,schemeOrRd:PW,schemeOranges:oH,schemePRGn:cW,schemePaired:KV,schemePastel1:JV,schemePastel2:QV,schemePiYG:hW,schemePuBu:NW,schemePuBuGn:RW,schemePuOr:pW,schemePuRd:FW,schemePurples:eH,schemeRdBu:mW,schemeRdGy:gW,schemeRdPu:BW,schemeRdYlBu:xW,schemeRdYlGn:_W,schemeReds:rH,schemeSet1:tG,schemeSet2:eG,schemeSet3:nG,schemeSpectral:SW,schemeTableau10:rG,schemeYlGn:GW,schemeYlGnBu:UW,schemeYlOrBr:HW,schemeYlOrRd:XW},Symbol.toStringTag,{value:"Module"}));function bH(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return t?e.reduce((function(t,e){return function(n){return e(t(n))}}),t):rx}function _H(t){return t instanceof Float32Array||t instanceof Array}function wH(t,e,n){for(;t<e;)t+=2*Math.PI;for(;t>n;)t-=2*Math.PI;return t}var SH=function(t,e,n,r,i){var o,a,s=t,u=s[0],c=s[1],l=to();return a=[u,c],(o=l)[0]=1,o[1]=0,o[2]=0,o[3]=0,o[4]=1,o[5]=0,o[6]=a[0],o[7]=a[1],o[8]=1,o},MH=function(t,e,n,r,i){var o=new qA({range:[e,e+r]}),a=new qA({range:[n,n+i]});return{transform:function(t){var e=t[0],n=t[1];return[o.map(e),a.map(n)]},untransform:function(t){var e=t[0],n=t[1];return[o.invert(e),a.invert(n)]}}},EH=function(t,e,n,r,i){return(0,t[0])(e,n,r,i)},AH=function(t,e,n,r,i){return t[0]},TH=function(t,e,n,r,i){var o=t,a=o[0],s=o[1],u=o[2],c=o[3],l=new qA({range:[u,c]}),h=new qA({range:[a,s]}),f=i/r,p=f>1?1:f,d=f>1?1/f:1;return{transform:function(t){var e=t[0],n=t[1],r=h.map(e),i=l.map(n);return[.5*(i*Math.cos(r)*p)+.5,.5*(i*Math.sin(r)*d)+.5]},untransform:function(t){var e=t[0],n=t[1],r=2*(e-.5)/p,i=2*(n-.5)/d,o=Math.sqrt(Math.pow(r,2)+Math.pow(i,2)),u=wH(Math.atan2(i,r),a,s);return[h.invert(u),l.invert(o)]}}},CH=function(t,e,n,r,i){return{transform:function(t){var e=t[0];return[t[1],e]},untransform:function(t){var e=t[0];return[t[1],e]}}},OH=function(t,e,n,r,i){var o,a,s=t,u=s[0],c=s[1],l=to();return a=[u,c],(o=l)[0]=a[0],o[1]=0,o[2]=0,o[3]=0,o[4]=a[1],o[5]=0,o[6]=0,o[7]=0,o[8]=1,o},kH=globalThis&&globalThis.__spreadArray||function(t,e,n){if(n||2===arguments.length)for(var r,i=0,o=e.length;i<o;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))},PH=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return OH.apply(void 0,kH([[-1,-1]],e,!1))},LH=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return OH.apply(void 0,kH([[-1,1]],e,!1))},RH=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return OH.apply(void 0,kH([[1,-1]],e,!1))},IH=function(t,e,n,r,i){var o,a,s,u,c=t[0],l=to();return o=l,a=c,s=Math.sin(a),u=Math.cos(a),o[0]=u,o[1]=s,o[2]=0,o[3]=-s,o[4]=u,o[5]=0,o[6]=0,o[7]=0,o[8]=1,o},NH=function(t,e,n,r,i){var o=t,a=o[0],s=o[1],u=o[2],c=(o[3]-u)/((s-0)/(2*Math.PI)+1),l=c/(2*Math.PI),h=new qA({range:[u,u+.99*c]}),f=new qA({range:[a,s]}),p=i/r,d=p>1?1:p,m=p>1?1/p:1;return{transform:function(t){var e=t[0],n=t[1],r=f.map(e),i=h.map(n);return[.5*(Math.cos(r)*(l*r+i)*d)+.5,.5*(Math.sin(r)*(l*r+i)*m)+.5]},untransform:function(t){var e=t[0],n=t[1],r=2*(e-.5)/d,i=2*(n-.5)/m,o=Math.sqrt(Math.pow(r,2)+Math.pow(i,2)),u=wH(Math.atan2(i,r)+Math.floor(o/c)*Math.PI*2,a,s),p=o-l*u;return[f.invert(u),h.invert(p)]}}},DH=function(t,e,n,r,i){var o=t,a=o[0],s=o[1],u=o[2],c=o[3],l=new qA({range:[u,c]});return{transform:function(t){for(var e=[],n=t.length,r=new ZA({domain:new Array(n).fill(0).map((function(t,e){return e})),range:[a,s]}),i=0;i<n;i++){var o=t[i],u=r.map(i),c=l.map(o);e.push(u,c)}return e},untransform:function(t){for(var e=[],n=0;n<t.length;n+=2){var r=t[n+1];e.push(l.invert(r))}return e}}};function FH(t){return 1/Math.tan(t)}var jH=function(t,e,n,r,i){var o=FH(t[0]);return{transform:function(t){var e=t[0],n=t[1];return[e+n*o,n]},untransform:function(t){var e=t[0],n=t[1];return[e-n*o,n]}}},BH=function(t,e,n,r,i){var o=FH(t[0]);return{transform:function(t){var e=t[0];return[e,t[1]+e*o]},untransform:function(t){var e=t[0];return[e,t[1]-e*o]}}};function zH(t,e,n,r,i){var o=t<e,a=(o?e-r:i-e)||i-r,s=o?-1:1;return s*a*(n+1)/(n+a/((t-e)*s))+e}function UH(t,e,n,r,i){var o=t<e,a=(o?e-r:i-e)||i-r;return a/(a*(n+1)/(t-e)-n*(o?-1:1))+e}function VH(t,e,n){return n?new qA({range:[0,1],domain:[0,e]}).map(t):t}var GH=function(t,e,n,r,i){var o=t,a=o[0],s=o[1],u=o[2],c=VH(a,r,void 0!==u&&u);return{transform:function(t){var e=t[0],n=t[1];return[zH(e,c,s,0,1),n]},untransform:function(t){var e=t[0],n=t[1];return[UH(e,c,s,0,1),n]}}},WH=function(t,e,n,r,i){var o=t,a=o[0],s=o[1],u=o[2],c=VH(a,i,void 0!==u&&u);return{transform:function(t){return[t[0],zH(t[1],c,s,0,1)]},untransform:function(t){return[t[0],UH(t[1],c,s,0,1)]}}},HH=function(t,e,n,r,i){var o=t,a=o[0],s=o[1],u=o[2],c=o[3],l=o[4],h=void 0!==l&&l,f=VH(a,r,h),p=VH(s,i,h);return{transform:function(t){var e=t[0],n=t[1];return[zH(e,f,u,0,1),zH(n,p,c,0,1)]},untransform:function(t){var e=t[0],n=t[1];return[UH(e,f,u,0,1),UH(n,p,c,0,1)]}}},YH=function(t,e,n,r,i){var o=t,a=o[0],s=o[1],u=o[2],c=o[3],l=o[4],h=void 0!==l&&l,f=new qA({range:[0,r]}),p=new qA({range:[0,i]}),d=h?a:f.map(a),m=h?s:p.map(s);return{transform:function(t){var e=t[0],n=t[1],r=f.map(e)-d,i=p.map(n)-m,o=Math.sqrt(r*r+i*i);if(o>u)return[e,n];var a=zH(o,0,c,0,u),s=Math.atan2(i,r),l=d+a*Math.cos(s),h=m+a*Math.sin(s);return[f.invert(l),p.invert(h)]},untransform:function(t){var e=t[0],n=t[1],r=f.map(e)-d,i=p.map(n)-m,o=Math.sqrt(r*r+i*i);if(o>u)return[e,n];var a=UH(o,0,c,0,u),s=Math.atan2(i,r),l=d+a*Math.cos(s),h=m+a*Math.sin(s);return[f.invert(l),p.invert(h)]}}},XH=globalThis&&globalThis.__spreadArray||function(t,e,n){if(n||2===arguments.length)for(var r,i=0,o=e.length;i<o;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))},qH=function(){function t(t){this.options={x:0,y:0,width:300,height:150,transformations:[]},this.transformers={cartesian:MH,translate:SH,custom:EH,matrix:AH,polar:TH,transpose:CH,scale:OH,"shear.x":jH,"shear.y":BH,reflect:PH,"reflect.x":LH,"reflect.y":RH,rotate:IH,helix:NH,parallel:DH,fisheye:HH,"fisheye.x":GH,"fisheye.y":WH,"fisheye.circular":YH},this.update(t)}return t.prototype.update=function(t){this.options=tx({},this.options,t),this.recoordinate()},t.prototype.clone=function(){return new t(this.options)},t.prototype.getOptions=function(){return this.options},t.prototype.clear=function(){this.update({transformations:[]})},t.prototype.getSize=function(){var t=this.options;return[t.width,t.height]},t.prototype.getCenter=function(){var t=this.options,e=t.x,n=t.y;return[(2*e+t.width)/2,(2*n+t.height)/2]},t.prototype.transform=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this.options.transformations;return this.update({transformations:XH(XH([],n,!0),[XH([],t,!0)],!1)}),this},t.prototype.map=function(t){return this.output(t)},t.prototype.invert=function(t){return this.input(t)},t.prototype.recoordinate=function(){this.output=this.compose(),this.input=this.compose(!0)},t.prototype.compose=function(t){void 0===t&&(t=!1);for(var e=t?XH([],this.options.transformations,!0).reverse():this.options.transformations,n=t?function(t){return t.untransform}:function(t){return t.transform},r=[],i=[],o=function(t,e){return void 0===e&&(e=!0),i.push(e?function(t){return function(e){for(var n=[],r=0;r<e.length-1;r+=2){var i=[e[r],e[r+1]],o=t(i);n.push.apply(n,o)}return n}}(t):t)},a=0,s=e;a<s.length;a++){var u=s[a],c=u[0],l=u.slice(1),h=this.transformers[c];if(h){var f=this.options,p=f.x,d=f.y,m=f.width,v=f.height,g=h(XH([],l,!0),p,d,m,v);if(_H(g))r.push(g);else{if(r.length)o(this.createMatrixTransform(r,t)),r.splice(0,r.length);o(n(g)||rx,"parallel"!==c)}}}r.length&&o(this.createMatrixTransform(r,t));return bH.apply(void 0,i)},t.prototype.createMatrixTransform=function(t,e){var n,r,i=to();return e&&t.reverse(),t.forEach((function(t){return eo(i,i,t)})),e&&function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],l=e[8],h=l*a-s*c,f=-l*o+s*u,p=c*o-a*u,d=n*h+r*f+i*p;d&&(d=1/d,t[0]=h*d,t[1]=(-l*r+i*c)*d,t[2]=(s*r-i*a)*d,t[3]=f*d,t[4]=(l*n-i*u)*d,t[5]=(-s*n+i*o)*d,t[6]=p*d,t[7]=(-c*n+r*u)*d,t[8]=(a*n-r*o)*d)}(i,(n=i,(r=new Ji(9))[0]=n[0],r[1]=n[1],r[2]=n[2],r[3]=n[3],r[4]=n[4],r[5]=n[5],r[6]=n[6],r[7]=n[7],r[8]=n[8],r)),function(t){var e=[t[0],t[1],1];return ia(e,e,i),[e[0],e[1]]}},t}();function ZH(t){return void 0!==t.find((t=>"polar"===t.type))}function $H(t){return void 0!==t.find((t=>"helix"===t.type))}function KH(t){return t.filter((({type:t})=>"transpose"===t)).length%2==1}function JH(t){return void 0!==t.find((t=>"theta"===t.type))}function QH(t){return void 0!==t.find((t=>"radial"===t.type))}function tY(t,e,n,r,i,o){const{guide:a={}}=n,s=function(t,e,n){const{type:r,domain:i,range:o}=n;if(void 0!==r)return r;if(function(t){return dY(t,Tw)}(e))return"identity";if("string"==typeof o)return"linear";if((i||o||[]).length>2)return cY(t);if(void 0!==i)return fY([i])?cY(t):pY(e)?"time":lY(t,o);return fY(e)?cY(t):pY(e)?"time":lY(t,o)}(t,e,n);if("string"!=typeof s)return n;const u=function(t,e,n,r){const{domain:i}=r;if(void 0!==i)return i;const{domainMax:o,domainMin:a}=r;switch(t){case"linear":case"time":case"log":case"pow":case"sqrt":case"quantize":case"threshold":{const[t,e]=function(t,e){const{zero:n=!1}=e;let r=1/0,i=-1/0;for(const o of t)for(const t of o)ww(t)&&(r=Math.min(r,+t),i=Math.max(i,+t));return r===1/0?[]:n?[Math.min(0,r),i]:[r,i]}(n,r);return[a||t,o||e]}case"band":case"ordinal":case"point":return hY(n);case"quantile":return function(t){return hY(t).sort()}(n);case"sequential":{const[t,e]=function(t){let e=1/0,n=-1/0;for(const r of t)for(const t of r)ww(t)&&(e=Math.min(e,+t),n=Math.max(n,+t));return e===1/0?[]:[e<0?-n:e,n]}(n);return[a||t,o||e]}default:return[]}}(s,0,e,n);return Object.assign(Object.assign(Object.assign({},n),function(t,e,n,r,i){switch(t){case"linear":case"time":case"log":case"pow":case"sqrt":return function(t,e){const{interpolate:n=yA,nice:r=!1,tickCount:i=10}=e;return Object.assign(Object.assign({},e),{interpolate:n,nice:r,tickCount:i})}(0,r);case"band":case"point":return function(t,e,n,r){if(void 0!==r.padding||void 0!==r.paddingInner||void 0!==r.paddingOuter)return Object.assign(Object.assign({},r),{unknown:NaN});const i=function(t,e,n){if("enterDelay"===e||"enterDuration"===e)return 0;if("band"===t)return JH(n)?0:.1;return"point"===t?.5:0}(t,e,n),{paddingInner:o=i,paddingOuter:a=i}=r;return Object.assign(Object.assign({},r),{paddingInner:o,paddingOuter:a,padding:i,unknown:NaN})}(t,e,i,r);case"sequential":return function(t){const{palette:e="ylGnBu",offset:n}=t,r=Jy(e),i=xH[`interpolate${r}`];if(!i)throw new Error(`Unknown palette: ${r}`);return{interpolator:n?t=>i(n(t)):i}}(r);default:return r}}(s,t,0,n,r)),{domain:u,range:sY(s,t,e,n,u,i,o),guide:a,name:t,type:s})}function eY(t,e){const n={};for(const r of t){const{values:t,name:i}=r,o=e[i];for(const e of t){const{name:t,value:r}=e;n[t]=r.map((t=>o.map(t)))}}return n}function nY(t){if(!t||!Array.isArray(t))return[gw,gw];let e,n;return[r=>{var i;e=r.map.bind(r),n=null===(i=r.invert)||void 0===i?void 0:i.bind(r);const o=t.filter((([t])=>"function"==typeof t)),a=t.filter((([t])=>"function"!=typeof t)),s=new Map(a);if(r.map=t=>{for(const[e,n]of o)if(e(t))return n;return s.has(t)?s.get(t):e(t)},!n)return r;const u=new Map(a.map((([t,e])=>[e,t]))),c=new Map(o.map((([t,e])=>[e,t])));return r.invert=t=>c.has(t)?t:u.has(t)?u.get(t):n(t),r},t=>(null!==e&&(t.map=e),null!==n&&(t.invert=n),t)]}function rY(t){const e=t.flatMap((t=>Array.from(t.values()))).flatMap((t=>t.channels.map((t=>t.scale))));iY(e,"x"),iY(e,"y")}function iY(t,e){const n=t.filter((({name:t,facet:n=!0})=>n&&t===e)),r=n.flatMap((t=>t.domain)),i=n.every(oY)?Zb(r):n.every(aY)?Array.from(new Set(r)):null;if(null!==i)for(const o of n)o.domain=i}function oY(t){const{type:e}=t;if("string"!=typeof e)return!1;return["linear","log","pow","time"].includes(e)}function aY(t){const{type:e}=t;if("string"!=typeof e)return!1;return["band","point","ordinal"].includes(e)}function sY(t,e,n,r,i,o,a){const{range:s}=r;if("string"==typeof s)return function(t){return t.split("-")}(s);if(void 0!==s)return s;const{rangeMin:u,rangeMax:c}=r;switch(t){case"linear":case"time":case"log":case"sqrt":{const t=uY(n,r,i,o,a),[s,l]=function(t,e){return"enterDelay"===t?[0,1e3]:"enterDuration"==t?[300,1e3]:t.startsWith("y")||t.startsWith("position")?[1,0]:"color"===t?[$C(e),KC(e)]:"opacity"===t?[0,1]:"size"===t?[1,10]:[0,1]}(e,t);return[u||s,c||l]}case"band":case"point":return[u||0,c||1];case"ordinal":return uY(n,r,i,o,a);case"sequential":return;default:return[]}}function uY(t,e,n,r,i){const[o]=YV("palette",i),{defaultCategory10:a,defaultCategory20:s}=r,u=(c=t.flat(),Array.from(new Set(c))).length<=a.length?a:s;var c;const{palette:l=u,offset:h}=e;try{return o({type:l})}catch(f){const t=function(t,e,n=(t=>t)){if(!t)return null;const r=Jy(t),i=xH[`scheme${r}`],o=xH[`interpolate${r}`];if(!i&&!o)return null;if(i){if(!i.some(Array.isArray))return i;const t=i[e.length];if(t)return t}return e.map(((t,r)=>o(n(r/e.length))))}(l,n,h);if(t)return t;throw new Error(`Unknown Component: ${l} `)}}function cY(t){return function(t){return t.startsWith("x")||t.startsWith("y")||t.startsWith("position")||t.startsWith("size")}(t)?"point":"ordinal"}function lY(t,e){return"color"!==t||e?"linear":"sequential"}function hY(t){return Array.from(new Set(t.flat()))}function fY(t){return dY(t,(t=>{const e=typeof t;return"string"===e||"boolean"===e}))}function pY(t){return dY(t,(t=>t instanceof Date))}function dY(t,e){for(const n of t)if(n.some(e))return!0;return!1}var mY=globalThis&&globalThis.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(e){o(e)}}function s(t){try{u(r.throw(t))}catch(e){o(e)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},vY=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};function gY(t,e,n){const{encode:r={},scale:i={},transform:o=[]}=e,a=vY(e,["encode","scale","transform"]);return[t,Object.assign(Object.assign({},a),{encode:r,scale:i,transform:o})]}function yY(t,e,n){return mY(this,void 0,void 0,(function*(){const{library:t}=n,{data:r}=e,[i]=YV("data",t),o=function(t){if(!t)return{type:"inline",value:null};if(Array.isArray(t))return{type:"inline",value:t};const{type:e="inline"}=t,n=vY(t,["type"]);return Object.assign(Object.assign({},n),{type:e})}(r),{transform:a=[]}=o,s=[vY(o,["transform"]),...a].map(i),u=yield function(t){return t.reduce(((t,e)=>n=>vw(this,void 0,void 0,(function*(){const r=yield t(n);return e(r)}))),gw)}(s)(r);return[Array.isArray(u)?ZC(u):[],Object.assign(Object.assign({},e),{data:u})]}))}function xY(t,e,n){const{encode:r}=e;if(!r)return[t,e];const i={};for(const[o,a]of Object.entries(r))if(Array.isArray(a))for(let t=0;t<a.length;t++){i[`${o}${0===t?"":t}`]=a[t]}else i[o]=a;return[t,Object.assign(Object.assign({},e),{encode:i})]}function bY(t,e,n){const{encode:r,data:i}=e;if(!r)return[t,e];const o=qC(r,(t=>{if(function(t){if("object"!=typeof t||t instanceof Date||null===t)return!1;const{type:e}=t;return ww(e)}(t))return t;const e=function(t,e){return"function"==typeof e?"transform":"string"==typeof e&&function(t,e){return!!Array.isArray(t)&&t.some((t=>void 0!==t[e]))}(t,e)?"field":"constant"}(i,t);return{type:e,value:t}}));return[t,Object.assign(Object.assign({},e),{encode:o})]}function _Y(t,e,n){const{encode:r}=e;if(!r)return[t,e];const i=qC(r,((t,e)=>{const{type:n}=t;return"constant"!==n||function(t){return t.startsWith("x")||t.startsWith("y")||t.startsWith("position")||"enterDelay"===t||"enterDuration"===t||"updateDelay"===t||"updateDuration"===t||"exitDelay"===t||"exitDuration"===t}(e)?t:Object.assign(Object.assign({},t),{visual:!0})}));return[t,Object.assign(Object.assign({},e),{encode:i})]}function wY(t,e,n){const{encode:r,data:i}=e;if(!r)return[t,e];const{library:o}=n,a=function(t){const[e]=YV("encode",t);return(t,n)=>void 0===n||void 0===t?null:Object.assign(Object.assign({},n),{type:"column",value:e(n)(t),field:OY(n)})}(o),s=qC(r,(t=>a(i,t)));return[t,Object.assign(Object.assign({},e),{encode:s})]}function SY(t,e,n){const{encode:r}=e,i=vY(e,["encode"]);if(!r)return[t,e];const o=Object.entries(r),a=o.filter((([,t])=>{const{value:e}=t;return Array.isArray(e[0])})).flatMap((([e,n])=>{const r=[[e,new Array(t.length).fill(void 0)]],{value:i}=n,o=vY(n,["value"]);for(let a=0;a<i.length;a++){const n=i[a];if(Array.isArray(n))for(let i=0;i<n.length;i++){const o=r[i]||[`${e}${i}`,new Array(t).fill(void 0)];o[1][a]=n[i],r[i]=o}}return r.map((([t,e])=>[t,Object.assign({type:"column",value:e},o)]))})),s=Object.fromEntries([...o,...a]);return[t,Object.assign(Object.assign({},i),{encode:s})]}function MY(t,e,n){const{axis:r={},legend:i={}}=e,o=(t,e)=>{if("boolean"==typeof t)return t?{}:null;const n=t[e];return void 0===n||n?n:null},a="object"==typeof r?Array.from(new Set(["x","y",...Object.keys(r)])):["x","y"];return tx(e,{scale:Object.assign(Object.assign({},Object.fromEntries(a.map((t=>[t,{guide:o(r,t)}])))),{color:{guide:o(i,"color")},size:{guide:o(i,"size")}})}),[t,e]}function EY(t,e,n){const{animate:r}=e;return r||void 0===r||tx(e,{animate:{enterType:null,exitType:null,updateType:null}}),[t,e]}var AY=globalThis&&globalThis.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(e){o(e)}}function s(t){try{u(r.throw(t))}catch(e){o(e)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},TY=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};function CY(t,e,n){return AY(this,void 0,void 0,(function*(){const r={library:n},[i,o]=yield function(t,e,n){return AY(this,void 0,void 0,(function*(){const{library:r}=n,[i]=YV("transform",r),{preInference:o=[],postInference:a=[]}=e,{transform:s=[]}=t,u=[gY,yY,xY,bY,_Y,wY,SY,EY,MY,...o.map(i),...s.map(i),...a.map(i)];let c=[],l=t;for(const t of u)[c,l]=yield t(c,l,n);return[c,l]}))}(t,e,r),{encode:a,scale:s,data:u}=o;if(!1===Array.isArray(u))return null;const{channels:c}=e,l=r_(Object.entries(a).filter((([,t])=>ww(t))),(t=>t.map((([t,e])=>Object.assign({name:t},e)))),(([t])=>{var e;const n=null===(e=/([^\d]+)\d*$/.exec(t))||void 0===e?void 0:e[1],r=c.find((t=>t.name===n));return(null==r?void 0:r.independent)?t:n})),h=c.filter((t=>{const{name:e,required:n}=t;if(l.find((([t])=>t===e)))return!0;if(n)throw new Error(`Missing encoding for channel: ${e}.`);return!1})).flatMap((t=>{const{name:e,scale:n,scaleKey:r,range:i}=t;return l.filter((([t])=>t.startsWith(e))).map((([t,e],o)=>{const a=e.some((t=>t.visual)),u=s[t]||{},{independent:c=!1,key:l=r||t,type:h=(a?"identity":n)}=u,f=TY(u,["independent","key","type"]);return{name:t,values:e,scaleKey:c?Symbol("independent"):l,scale:Object.assign({type:h,range:i},f)}}))}));return[o,Object.assign(Object.assign({},e),{index:i,channels:h})]}))}function OY(t){const{type:e,value:n}=t;return"field"===e&&"string"==typeof n?n:null}var kY=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};function PY(t,e,n){const{component:r=[],coordinates:i=[],title:o,theme:a}=e,[,s]=YV("component",n),u=t.filter((({guide:t,name:e})=>null!==t)),c=function(t,e,n){const[,r]=YV("component",n),{marks:i,coordinates:o}=t,a=new Map(e.map((t=>[t.name,t])));return i.filter((t=>t.slider)).flatMap((t=>{const{slider:e}=t;return Object.entries(e).map((([t,e])=>{const n=a.get(t),i=function(t,e=[]){return"x"===t?KH(e)?"sliderY":"sliderX":"y"===t?KH(e)?"sliderX":"sliderY":null}(t,o);if(!n||!i)return;const{props:s}=r(i),{defaultPosition:u,defaultSize:c,defaultOrder:l}=s;return Object.assign(Object.assign({position:u,size:c,order:l,type:i},e),{scale:n})}))})).filter((t=>!!t))}(e,t,n),l=[...r,...c];if(o){const{props:t}=s("title"),{defaultPosition:e,defaultOrder:n,defaultSize:r}=t,i="string"==typeof o?{text:o}:o,u=function(t){var e,n;const{size:r,text:i,subtitle:o,style:a,subtitleStyle:s}=t;if(r)return r;const u=null!==(e=null==a?void 0:a.fontSize)&&void 0!==e?e:14,c=null!==(n=null==s?void 0:s.fontSize)&&void 0!==n?n:12,l=(null==s?void 0:s.spacing)||0;return(i?u+4:0)+(o?c+l:0)}(tx({size:r},a,i));l.push(Object.assign({type:"title",position:e,order:n,size:u},i))}for(const h of u){const t=RY(h,i);if(null!==t){const{props:e}=s(t),{defaultPosition:n,defaultSize:r,defaultOrder:o}=e,{guide:a,name:u,field:c}=h,f=Array.isArray(a)?a:[a];for(const s of f){const e=IY(u,t,n,s,i),{size:a=r,order:f=o}=s;l.push(Object.assign(Object.assign({title:c},s),{position:e,order:f,size:a,type:t,scale:h}))}}}return l}function LY(t,e,n,r){const[i]=YV("scale",r),[o]=YV("component",r),{scale:a,bbox:s}=t,u=kY(t,["scale","bbox"]),c=a?i(a):null,{field:l,domain:h}=a||{},f={field:l,domain:h,bbox:s};return o(u)(c,f,e,n)}function RY(t,e){const{name:n,guide:r,type:i}=t,{type:o}=r;if(void 0!==o)return o;if("color"===n)switch(i){case"ordinal":return"legendCategory";case"linear":return"legendContinuous";default:return null}return KH(e)&&ZH(e)||$H(e)||JH(e)?null:n.startsWith("x")?KH(e)?"axisY":"axisX":n.startsWith("y")?KH(e)?"axisX":"axisY":n.startsWith("position")&&!ZH(e)?"axisY":null}function IY(t,e,n,r,i){const o=["left","right","top","bottom","centerHorizontal","center"].includes(r.position)?r.position:n;if("axisY"===e&&function(t){return void 0!==t.find((t=>"parallel"===t.type))}(i)){const e=/position(\d*)/g.exec(t);if(null===e)return o;const n=+e[1];return KH(i)?0===n?"top":"centerVertical":0===n?o:"centerHorizontal"}return"axisX"===e&&ZH(i)&&!KH(i)||"axisY"===e&&ZH(i)&&KH(i)||"axisY"===e&&JH(i)||"axisY"===e&&$H(i)||"axisY"===e&&QH(i)?"bottom"===r.position?"arcInner":"arc":!ZH(i)||"axisX"!==e&&"axisY"!==e?QH(i)&&"axisX"===e?"arcY":"axisX"===e&&function(t){return void 0!==t.find((t=>"reflect"===t.type))}(i)||"axisX"===e&&function(t){return void 0!==t.find((t=>"reflectY"===t.type))}(i)?"top":"string"==typeof e&&e.startsWith("legend")&&ZH(i)&&"center"===r.position?"arcCenter":o:"arcY"}function NY(t,e){const n=function(t,e){const n=["left","right","top","bottom"],r=e_(t,(t=>t.position)),{padding:i,paddingLeft:o=i,paddingRight:a=i,paddingBottom:s=i,paddingTop:u=i}=e,c={paddingBottom:s,paddingLeft:o,paddingTop:u,paddingRight:a};for(const l of n){const t=`padding${xw(l)}`;if(void 0===c[t])if(r.has(l)){const e=r.get(l).reduce(((t,{size:e})=>t+e),0);c[t]=e}else c[t]=30}return c}(t,e),{paddingLeft:r,paddingRight:i,paddingTop:o,paddingBottom:a}=n,{width:s,height:u,x:c=0,y:l=0,inset:h=0,insetLeft:f=h,insetTop:p=h,insetBottom:d=h,insetRight:m=h,margin:v=0,marginLeft:g=v,marginBottom:y=v,marginTop:x=v,marginRight:b=v}=e;return Object.assign(Object.assign({},n),{width:s,height:u,insetLeft:f,insetTop:p,insetBottom:d,insetRight:m,innerWidth:s-r-i-g-b,innerHeight:u-o-a-x-y,marginLeft:g,marginBottom:y,marginTop:x,marginRight:b,x:c,y:l})}function DY(t,e,n){const[r,i,,o]=n,a=new Array(t.length+1).fill(0),s=e.map(a).filter(((t,e)=>e%2==0)).map((t=>t+r));for(let u=0;u<t.length;u++){const e=t[u],n=s[u],r=s[u+1]-n;e.bbox={x:n,y:i,width:r,height:o}}}function FY(t,e,n){const[r,i,o]=n,a=new Array(t.length+1).fill(0),s=e.map(a).filter(((t,e)=>e%2==1)).map((t=>t+i));for(let u=0;u<t.length;u++){const e=t[u],n=s[u],i=s[u+1]-n;e.bbox={x:r,y:n,width:o,height:i}}}function jY(t,e,n){const[r,i,o,a,s,u,c]=n,[l,h,f,p,d,m,v,g]=0===s?["y",i,"x",r,"height",a,"width",o]:["x",r,"y",i,"width",o,"height",a];t.sort(((t,e)=>c(t.order,e.order)));for(let y=0,x=u?h+m:h;y<t.length;y++){const e=t[y],{size:n}=e;e.bbox={[l]:u?x-n:x,[f]:p,[d]:n,[v]:g},x+=n*(u?-1:1)}}function BY(t,e,n){const[r,i,o,a]=n;for(let s=0;s<t.length;s++){t[s].bbox={x:r,y:i,width:o,height:a}}}function zY(t,e,n){const[r,i,,o]=n,[a,s]=e.getCenter(),[u,c]=GY(e),l=o/2,h=s-c*l,f=(c-u)*l;for(let p=0;p<t.length;p++){t[p].bbox={x:a+r,y:h+i,width:0,height:f}}}function UY(t,e,n){const[r,i,o,a]=n,[s]=GY(e),u=a/2*s/Math.sqrt(2),c=r+o/2,l=i+a/2;for(let h=0;h<t.length;h++){t[h].bbox={x:c-u,y:l-u,width:2*u,height:2*u}}}function VY(t,e,n){const[r,i,,o]=n,[a,s]=e.getCenter(),[u]=GY(e),c=u*(o/2),l=a-c,h=s-c;for(let f=0;f<t.length;f++){t[f].bbox={x:r+l,y:i+h,width:2*c,height:2*c}}}function GY(t){const{transformations:e}=t.getOptions(),[,,,n,r]=e.find((t=>"polar"===t[0]));return[n,r]}var WY=globalThis&&globalThis.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(e){o(e)}}function s(t){try{u(r.throw(t))}catch(e){o(e)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},HY=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};function YY(t,e,n,r){return WY(this,void 0,void 0,(function*(){const[i]=YV("composition",n),[o]=YV("interaction",n),a=new Set(Object.keys(n).map((t=>{var e;return null===(e=/mark\.(.*)/.exec(t))||void 0===e?void 0:e[1]})).filter(ww)),s=t=>{const{type:e}=t;return"string"==typeof e&&a.has(e)?"mark":e},u=t=>"mark"===s(t),c=t=>"standardView"===s(t),l=t=>{if(c(t))return[t];const e=s(t);return i({type:e})(t)},h=[],f=new Map,p=new Map,d=[t],m=[];for(;d.length;){const t=d.shift();if(c(t)){const e=p.get(t),[r,i]=e?KY(e,t,n):yield ZY(t,n);f.set(r,t),h.push(r);const o=i.flatMap(l);if(d.push(...o),o.every(c)){const t=yield Promise.all(o.map((t=>$Y(t,n))));rY(t);for(let e=0;e<o.length;e++){const n=o[e],r=t[e];p.set(n,r)}}}else{const e=l(u(t)?t:yield hX(t,n));Array.isArray(e)?d.push(...e):"function"==typeof e&&m.push(e())}}const{on:v}=t;WV(v,VV.BEFORE_PAINT);const g=new Map,y=[];e.selectAll(mX(Wi)).data(h,(t=>t.key)).join((t=>t.append("g").attr("className",Wi).attr("id",(t=>t.key)).call(XY).each((function(t){JY(t,zC(this),y,n),g.set(t,this)}))),(t=>t.call(XY).each((function(t){JY(t,zC(this),y,n)}))),(t=>t.remove()));const x=Array.from(g.entries()).map((([t,e])=>({view:t,container:e,options:f.get(t),update:qY(zC(e),n,r)})));for(const t of x){const{options:e}=t;for(const n of lX(e)){o(n)(t,x)}}const{width:b,height:_}=t,w=[];for(const t of m){const i=new Promise((i=>WY(this,void 0,void 0,(function*(){for(const i of t){const t=Object.assign({width:b,height:_},i);yield YY(t,e,n,r)}i()}))));w.push(i)}r.animations=y,WV(v,VV.AFTER_PAINT);const S=y.filter(ww).map(aX).map((t=>t.finished));return Promise.all([...S,...w])}))}function XY(t){t.style("transform",(t=>`translate(${t.layout.x}, ${t.layout.y})`))}function qY(t,e,n){return r=>WY(this,void 0,void 0,(function*(){const[i,o]=yield ZY(r,e);JY(i,t,[],e);for(const r of o)YY(r,t,e,n);return{options:r,view:i}}))}function ZY(t,e){return WY(this,void 0,void 0,(function*(){return KY(yield $Y(t,e),t,e)}))}function $Y(t,e){return WY(this,void 0,void 0,(function*(){const[n]=YV("theme",e),[r,i]=YV("mark",e),{theme:o,marks:a,coordinates:s=[]}=t,u=n(cX(o)),c=new Map,l=[];for(const t of a){const n=yield hX(t,e);l.push(n)}const h=yield Promise.all(l.map((e=>WY(this,void 0,void 0,(function*(){const{type:n=bw("G2Mark type is required."),key:o}=e,{props:a}=i(n),{composite:s=!1}=a;if(!s)return e;return(yield r(e)(t)).map(((t,e)=>Object.assign({key:`${o}-${e}`},t)))}))))).then((t=>t.flat()));for(const t of h){const{type:n}=t,{props:r}=i(n),o=yield CY(t,r,e);if(o){const[t,e]=o;c.set(t,e)}}const f=e_(Array.from(c.values()).flatMap((t=>t.channels)),(({scaleKey:t})=>t));for(const t of f.values()){const n=t.reduce(((t,{scale:e})=>tx(t,e)),{}),{values:r}=t[0],i=Array.from(new Set(r.map((t=>t.field)).filter(ww))),o=tx({guide:{title:0===i.length?void 0:i},field:i[0]},n),{name:a}=t[0],c=tY(a,t.flatMap((({values:t})=>t.map((t=>t.value)))),o,s,u,e);t.forEach((t=>t.scale=c))}return c}))}function KY(t,e,n){const[r]=YV("mark",n),[i]=YV("scale",n),[o]=YV("theme",n),{key:a,frame:s=!1,theme:u,clip:c,style:l={}}=e,h=o(cX(u)),f=Array.from(t.values()),p=Array.from(new Set(f.flatMap((t=>t.channels.map((t=>t.scale)))))),d=PY(Array.from(p),e,n),m=NY(d,e),v=function(t,e,n){const[r]=YV("coordinate",n),{innerHeight:i,innerWidth:o,insetLeft:a,insetTop:s,insetRight:u,insetBottom:c,marginLeft:l,marginTop:h}=t,{coordinates:f=[]}=e,p=(d=f).find((t=>"cartesian"===t.type))?d:[...d,{type:"cartesian"}];var d;return new qH(Object.assign(Object.assign({},t),{x:a+l,y:s+h,width:o-a-u,height:i-c-s,transformations:p.map(r).flat()}))}(m,e,n),g=s?tx({mainLineWidth:1,mainStroke:"#000"},l):l;!function(t,e,n){const r=e_(t,(t=>t.position)),{paddingLeft:i,paddingRight:o,paddingTop:a,paddingBottom:s,marginLeft:u,marginTop:c,marginBottom:l,marginRight:h,innerHeight:f,innerWidth:p,height:d,width:m}=n,v=i+u,g=a+c,y=o+h,x=s+l,b={top:[v,0,p,g,0,!0,zb],right:[m-y,g,y,f,1,!1,zb],bottom:[v,d-x,p,x,0,!1,zb],left:[0,g,v,f,1,!0,zb],centerHorizontal:[v,g,p,f,-1,null,null],centerVertical:[v,g,p,f,-1,null,null],arc:[v,g,p,f,-1,null,null],arcY:[v,g,p,f,-1,null,null],arcInner:[v,g,p,f,-1,null,null],center:[v,g,p,f,-1,null,null],arcCenter:[v,g,p,f,-1,null,null]};for(const[_,w]of r.entries()){const t=b[_];"centerHorizontal"===_?DY(w,e,t):"centerVertical"===_?FY(w,e,t):"arc"===_?BY(w,0,t):"arcY"===_?zY(w,e,t):"arcInner"===_?VY(w,e,t):"arcCenter"===_?UY(w,e,t):jY(w,0,t)}}(d,v,m);const y={},x=[];for(const[b,_]of t.entries()){const{children:t,dataDomain:e,modifier:n,key:o}=b,{index:a,channels:s}=_,u=Object.fromEntries(s.map((({name:t,scale:e})=>[t,e]))),c=qC(u,(t=>{const{relations:e}=t,[n]=nY(e);return n(i(t))}));Object.assign(y,c);const l=eY(s,c),h=r(b),[f,p,d]=QY(h(a,c,l,v)),g=e||f.length,w=n?n(p,g,m):[],S=f.map(((t,e)=>{const n={points:p[e],transform:w[e],index:t,markKey:o};for(const[r,i]of Object.entries(l))n[r]=i[t],d&&(n[`series${Jy(r)}`]=d[e].map((t=>i[t])));return d&&(n.seriesIndex=d[e]),n}));_.data=S,_.index=f;const M=null==t?void 0:t(S,c,m);x.push(...M||[])}return[{layout:m,theme:h,coordinate:v,components:d,markState:t,key:a,clip:c,scale:y,style:g},x]}function JY(t,e,n,r){return WY(this,void 0,void 0,(function*(){const{components:i,theme:o,layout:a,markState:s,coordinate:u,key:c,style:l,clip:h}=t,{x:f,y:p,width:d,height:m}=a,v=HY(a,["x","y","width","height"]),g=["view","plot","main","content"],y=g.map(((t,e)=>e)),x=g.map((t=>Ew(Object.assign({},o,l),t))),b=["a","margin","padding","inset"].map((t=>Mw(v,t))),_=t=>t.style("x",(t=>A[t].x)).style("y",(t=>A[t].y)).style("width",(t=>A[t].width)).style("height",(t=>A[t].height)).each((function(t){!function(t,e){for(const[n,r]of Object.entries(e))t.style(n,r)}(zC(this),x[t])}));let w=0,S=0,M=d,E=m;const A=y.map((t=>{const e=b[t],{left:n=0,top:r=0,bottom:i=0,right:o=0}=e;return w+=n,S+=r,M-=n+o,E-=r+i,{x:w,y:S,width:M,height:E}}));e.selectAll(mX(qi)).data(y.filter((t=>ww(x[t]))),(t=>g[t])).join((t=>t.append("rect").attr("className",qi).style("zIndex",-2).call(_)),(t=>t.call(_)),(t=>t.remove())),e.selectAll(mX(Yi)).data(i,((t,e)=>`${t.type}-${e}`)).join((t=>t.append("g").style("zIndex",(({zIndex:t})=>t||-1)).attr("className",Yi).append((t=>LY(t,u,o,r)))),(t=>t.each((function(t){const e=LY(t,u,o,r),{attributes:n}=e,[i]=this.childNodes;i.update(Object.assign({},n))}))));const T=function(t){let e=-1/0,n=1/0;for(const[r,i]of t){const{animate:t={}}=r,{data:o}=i,{updateType:a,updateDuration:s=300,updateDelay:u=0,enterType:c,enterDuration:l=300,enterDelay:h=0,exitType:f,exitDuration:p=300,exitDelay:d=0}=t;for(const r of o){const{updateType:t=a,updateDuration:i=s,updateDelay:o=u,enterType:m=c,enterDuration:v=l,enterDelay:g=h,exitDuration:y=p,exitDelay:x=d,exitType:b=f}=r;(void 0===t||t)&&(e=Math.max(e,i+o),n=Math.min(n,o)),(void 0===b||b)&&(e=Math.max(e,y+x),n=Math.min(n,x)),(void 0===m||m)&&(e=Math.max(e,v+g),n=Math.min(n,g))}}return e===-1/0?null:[n,e-n]}(s),C=e.selectAll(mX(Hi)).data([a],(()=>c)).join((t=>t.append("rect").style("fill","transparent").attr("className",Hi).call(fX).call(dX,Array.from(s.keys())).call(vX,h)),(t=>t.call(dX,Array.from(s.keys())).call((t=>T?function(t,e){const[n,r]=e;t.transition((function(t){const{x:e,y:i,width:o,height:a}=this.style,{paddingLeft:s,paddingTop:u,innerWidth:c,innerHeight:l}=t,h=[{x:e,y:i,width:o,height:a},{x:s,y:u,width:c,height:l}];return this.animate(h,{delay:n,duration:r,fill:"both"})}))}(t,T):fX(t))).call(vX,h))).transitions();n.push(...C.flat());for(const[O,k]of s.entries()){const{data:i}=k,{key:o,class:a}=O,s=rX(O,k,t,r),u=oX(O,k,t,r),c=sX(O,k,t,r),l=uX(O,k,t,r),h=eX(e,a,"element"),f=e.select(`#${o}`).selectAll(mX(Gi)).selectFacetAll(h).data(i,(t=>t.key),(t=>t.groupKey)).join((t=>t.append(s).attr("className",Gi).transition((function(t){return u(t,[this])}))),(t=>t.call((e=>{const n=e.parent(),r=Sw((t=>{const[e,n]=t.getBounds().min;return[e,n]}));t.transition((function(t,e){nX(this,n,r);const i=s(t,e),o=c(t,[this],[i]);return null===o&&_w(this,i),o}))}))),(t=>t.each((function(){this.__removed__=!0})).transition((function(t){return l(t,[this])})).remove()),(t=>t.append(s).attr("className",Gi).transition((function(t){const{__fromElements__:e}=this,n=c(t,e,[this]);return new UC(e,null,this.parentNode).transition(n).remove(),n}))),(t=>t.transition((function(t){const e=new UC([],this.__toData__,this.parentNode).append(s).attr("className",Gi).nodes();return c(t,[this],e)})).remove())).transitions();n.push(...f.flat())}!function(t,e,n,r){const[i]=YV("labelTransform",r),{markState:o,labelTransform:a}=t,s=e.select(mX(Vi)).node(),u=new Map,c=new Map,l=Array.from(o.entries()).flatMap((([n,i])=>{const{labels:o=[],key:a}=n,s=function(t,e,n,r){const[i]=YV("shape",r),{data:o}=t,{data:a,defaultLabelShape:s}=e,u=a.map((t=>t.points)),{theme:c,coordinate:l}=n;return t=>{const{index:e,points:n}=t,r=o[e],{formatter:a=(t=>`${t}`)}=t,h=qC(HY(t,["formatter"]),(t=>tX(t,r,e,o))),{shape:f=s,text:p}=h,d=HY(h,["shape","text"]),m="string"==typeof a?QI(a):a,v=Object.assign(Object.assign({},d),{text:m(p)});return i(Object.assign({type:`label.${f}`},d))(n,v,l,c,u)}}(n,i,t,r),l=e.select(`#${a}`).selectAll(mX(Gi)).nodes().filter((t=>!t.__removed__));return o.flatMap(((t,e)=>{const n=HY(t,["transform"]);return l.flatMap((r=>{const i=function(t,e,n){const{seriesIndex:r,seriesKey:i,points:o,key:a,index:s}=n.__data__,u=function(t){const e=t.cloneNode(),n=t.getAnimations();e.style.visibility="hidden",n.forEach((t=>{const n=t.effect.getKeyframes();e.attr(n[n.length-1])})),t.parentNode.appendChild(e);const r=e.getLocalBounds();e.destroy();const{min:i,max:o}=r;return[i,o]}(n);if(!r)return[Object.assign(Object.assign({},t),{key:`${a}-${e}`,bounds:u,index:s,points:o,dependentElement:n})];const c=function(t){const{selector:e}=t;if(!e)return null;if("function"==typeof e)return e;if("first"===e)return t=>[t[0]];if("last"===e)return t=>[t[t.length-1]];throw new Error(`Unknown selector: ${e}`)}(t),l=r.map(((r,a)=>Object.assign(Object.assign({},t),{key:`${i[a]}-${e}`,bounds:[o[a]],index:r,points:o,dependentElement:n})));return c?c(l):l}(n,e,r);return i.forEach((e=>{u.set(e,s),c.set(e,t)})),i}))}))})),h=zC(s).selectAll(mX(Xi)).data(l,(t=>t.key)).join((t=>t.append((t=>u.get(t)(t))).attr("className",Xi)),(t=>t.each((function(t){_w(this,u.get(t)(t))}))),(t=>t.remove())).nodes(),f=e_(h,(t=>c.get(t.__data__))),{coordinate:p}=t;for(const[d,m]of f){const{transform:t=[]}=d;yw(t.map(i))(m,p)}a&&a(h,p)}(t,e,0,r)}))}function QY([t,e,n]){if(n)return[t,e,n];const r=[],i=[];for(let o=0;o<t.length;o++){const n=t[o],a=e[o];a.every((([t,e])=>ww(t)&&ww(e)))&&(r.push(n),i.push(a))}return[r,i]}function tX(t,e,n,r){return"function"==typeof t?t(e,n,r):"string"!=typeof t?t:void 0!==e[t]?e[t]:t}function eX(t,e,n){return t.node().parentElement.findAll((t=>t.style.facet===e)).flatMap((t=>t.getElementsByClassName(n)))}function nX(t,e,n){if(!t.__facet__)return;const r=t.parentNode.parentNode,i=e.parentNode,[o,a]=n(r),[s,u]=n(i);!function(t,e){const{transform:n}=t.style,r="none"===n?"":n;t.style.transform=`${r} ${e}`.trimStart()}(t,`translate(${o-s}, ${a-u})`),e.append(t)}function rX(t,e,n,r){const[i]=YV("shape",r),{data:o}=t,{defaultShape:a,data:s}=e,u=s.map((t=>t.points)),{theme:c,coordinate:l}=n,{type:h,style:f={}}=t;return(e,n)=>{const{shape:r=a}=f,{shape:s=r,points:p,seriesIndex:d,index:m}=e,v=HY(e,["shape","points","seriesIndex","index"]),g=Object.assign(Object.assign({},v),{shape:s,mark:h,defaultShape:a,index:n}),y=d?d.map((t=>o[t])):o[m],x=d||m,b=qC(f,(t=>tX(t,y,x,o)));return i(Object.assign(Object.assign({},b),{type:pX(t,s)}))(p,g,l,c,u)}}function iX(t,e,n,r,i){const[,o]=YV("shape",i),[a]=YV("animation",i),{defaultShape:s}=n,{theme:u,coordinate:c}=r,l=`default${Jy(t)}Animation`,{[l]:h}=o(pX(e,s)).props,{[t]:f={}}=u,p=Mw(e.animate||{},t);return(e,n,r)=>{const{[`${t}Type`]:i,[`${t}Delay`]:o,[`${t}Duration`]:s,[`${t}Easing`]:u}=e,l=Object.assign({type:i||h},p);if(!l.type)return null;const d=a(l)(n,r,{delay:o,duration:s,easing:u},c,f);return Array.isArray(d)?d:[d]}}function oX(t,e,n,r){return iX("enter",t,e,n,r)}function aX(t){return t.finished.then((()=>{t.cancel()})),t}function sX(t,e,n,r){return iX("update",t,e,n,r)}function uX(t,e,n,r){return iX("exit",t,e,n,r)}function cX(t={type:"light"}){const{type:e="light"}=t;return Object.assign(Object.assign({},t),{type:e})}function lX(t){const{interactions:e=[]}=t;return e}function hX(t,e){return WY(this,void 0,void 0,(function*(){const n={library:e},{data:r}=t,i=HY(t,["data"]);if(null==r)return t;const[,{data:o}]=yield yY(0,{data:r},n);return Object.assign({data:o},i)}))}function fX(t){t.style("x",(t=>t.paddingLeft)).style("y",(t=>t.paddingTop)).style("width",(t=>t.innerWidth)).style("height",(t=>t.innerHeight))}function pX(t,e){const{type:n}=t;return`${n}.${e}`}function dX(t,e){const n=t=>void 0!==t.class?`${t.class}`:"";t.selectAll(mX(Ui)).data(e,(t=>t.key)).join((t=>t.append("g").attr("className",Ui).attr("id",(t=>t.key)).style("facet",n).style("fill","transparent")),(t=>t.style("facet",n)),(t=>t.remove()));t.select(mX(Vi)).node()||t.append("g").attr("className",Vi)}function mX(...t){return t.map((t=>`.${t}`)).join("")}function vX(t,e){t.node()&&t.style("clipPath",(t=>{if(!e)return;const{paddingTop:n,paddingLeft:r,innerWidth:i,innerHeight:o}=t;return new hp({style:{x:r,y:n,width:i,height:o}})}))}function gX(t,e){const n=new Ry;return n.registerPlugin(new zy),new Nm({width:t,height:e,container:document.createElement("div"),renderer:n})}function yX(t,e={},n){const{width:r=640,height:i=480,autoFit:o=!1,on:a}=t,s=function(t){const e=tx({},t),n=new Map([[e,null]]),r=new Map([[null,-1]]),i=[e];for(;i.length;){const t=i.shift();if(void 0===t.key){const e=n.get(t),i=r.get(t),o=null===e?"0":`${e.key}-${i}`;t.key=o}const{children:e=[]}=t;if(Array.isArray(e))for(let o=0;o<e.length;o++){const a=e[o];n.set(a,t),r.set(a,o),i.push(a)}}return e}(t),{canvas:u=gX(r,i),library:c=UV()}=e;e.canvas=u,e.library=c,o&&!e.bindAutoFit&&(!function(t,e={}){const{autoFit:n}=t;n&&window.addEventListener("resize",bX(t,e))}(t,e),e.bindAutoFit=!0),u.resize(r,i),WV(a,VV.BEFORE_RENDER);const l=zC(u.document.documentElement);return u.ready.then((()=>YY(Object.assign(Object.assign({},s),{width:r,height:i}),l,c,e))).then(n).then((()=>WV(a,VV.AFTER_RENDER))),"string"==typeof(h=u.getConfig().container)?document.getElementById(h):h;var h}function xX(t,e={}){const{on:n}=t,{canvas:r}=e;var i,o;r&&r.destroy(),function(t,e={}){const{autoFit:n}=t;n&&window.removeEventListener("resize",bX(t,e))}(t,e),(i=n)&&(o?delete i[o]:i={})}const bX=(t,e={})=>function(t,e,n){var r;return function(){var i=this,o=arguments,a=function(){r=null,n||t.apply(i,o)},s=n&&!r;clearTimeout(r),r=setTimeout(a,e),s&&t.apply(i,o)}}((()=>{const{width:n,height:r,autoFit:i}=t,{canvas:o}=e,a=o.getConfig().container,{width:s,height:u}=Lw(a,i,n,r),c=Object.assign(Object.assign({},t),{width:s,height:u});c.width&&c.height&&yX(c,e)}),300);function _X(t,e){const n=[t];for(;n.length;){const t=n.pop();e&&e(t);const r=t.children||[];for(const e of r)n.push(e)}}let wX=class{constructor(t={},e){this.parentNode=null,this.children=[],this.index=0,this.type=e,this.value=t}map(t=(t=>t)){const e=t(this.value);return this.value=e,this}attr(t,e){return 1===arguments.length?this.value[t]:this.map((n=>(n[t]=e,n)))}append(t){const e=new t({});return e.children=[],e.parentNode=this,e.index=this.children.length,this.children.push(e),e}remove(){const t=this.parentNode;if(t){const{children:e}=t,n=e.findIndex((t=>t===this));e.splice(n,1)}return this}getNodeByKey(t){let e=null;return _X(this,(n=>{t===n.attr("key")&&(e=n)})),e}getNodesByType(t){const e=[];return _X(this,(n=>{t===n.type&&e.push(n)})),e}changeData(t){let e=this;for(;e&&e.parentNode;)e=e.parentNode;this.attr("data",t),e.render()}call(t,...e){return t(this.map(),...e),this}};function SX(t,{name:e,key:n=e}){t.prototype[e]=function(t){return 0===arguments.length?this.attr(n):this.attr(n,t)}}function MX(t,{name:e,key:n=e}){t.prototype[e]=function(t){if(0===arguments.length)return this.attr(n);if(Array.isArray(t))return this.attr(n,t);const e=[...this.attr(n)||[],t];return this.attr(n,e)}}function EX(t,{name:e,key:n=e}){t.prototype[e]=function(t,e){if(0===arguments.length)return this.attr(n);if(1===arguments.length)return this.attr(n,t);const r=this.attr(n)||{};return r[t]=e,this.attr(n,r)}}function AX(t,{name:e,ctor:n}){t.prototype[e]=function(){return this.append(n)}}function TX(t,{name:e,ctor:n}){t.prototype[e]=function(){return this.type=null,this.append(n)}}function CX(t,{name:e,key:n=e}){t.prototype[e]=function(t,e){const r=this.attr(n)||{};if(0===arguments.length)return r;if(1===arguments.length)return r[t];const i=r[t];return i?Yy(e)?i.concat(e):i.push(e):r[t]=Yy(e)?e:[e],this.attr(n,r)}}function OX(t){return e=>{for(const n of t){const{type:t}=n;"value"===t?SX(e,n):"array"===t?MX(e,n):"object"===t?EX(e,n):"node"===t?AX(e,n):"container"===t?TX(e,n):"event"===t&&CX(e,n)}return e}}function kX(t){return Object.entries(t).map((([t,e])=>({type:"node",name:t,ctor:e})))}var PX=globalThis&&globalThis.__decorate||function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a};const LX=[{name:"encode",type:"object"},{name:"scale",type:"object"},{name:"data",type:"value"},{name:"transform",type:"array"},{name:"style",type:"object"},{name:"animate",type:"object"},{name:"label",type:"array",key:"labels"},{name:"axis",type:"object"},{name:"legend",type:"object"},{name:"slider",type:"object"}];let RX=class extends wX{constructor(){super({},"interval")}};RX=PX([OX(LX)],RX);let IX=class extends wX{constructor(){super({},"rect")}};IX=PX([OX(LX)],IX);let NX=class extends wX{constructor(){super({},"point")}};NX=PX([OX(LX)],NX);let DX=class extends wX{constructor(){super({},"area")}};DX=PX([OX(LX)],DX);let FX=class extends wX{constructor(){super({},"line")}};FX=PX([OX(LX)],FX);let jX=class extends wX{constructor(){super({},"cell")}};jX=PX([OX(LX)],jX);let BX=class extends wX{constructor(){super({},"vector")}};BX=PX([OX(LX)],BX);let zX=class extends wX{constructor(){super({},"link")}};zX=PX([OX(LX)],zX);let UX=class extends wX{constructor(){super({},"polygon")}};UX=PX([OX(LX)],UX);let VX=class extends wX{constructor(){super({},"image")}};VX=PX([OX(LX)],VX);let GX=class extends wX{constructor(){super({},"text")}};GX=PX([OX(LX)],GX);let WX=class extends wX{constructor(){super({},"box")}};WX=PX([OX(LX)],WX);let HX=class extends wX{constructor(){super({},"lineX")}};HX=PX([OX(LX)],HX);let YX=class extends wX{constructor(){super({},"lineY")}};YX=PX([OX(LX)],YX);let XX=class extends wX{constructor(){super({},"range")}};XX=PX([OX(LX)],XX);let qX=class extends wX{constructor(){super({},"rangeX")}};qX=PX([OX(LX)],qX);let ZX=class extends wX{constructor(){super({},"rangeY")}};ZX=PX([OX(LX)],ZX);let $X=class extends wX{constructor(){super({},"connector")}};$X=PX([OX(LX)],$X);let KX=class extends wX{constructor(){super({},"shape")}};KX=PX([OX(LX)],KX);let JX=class extends wX{constructor(){super({},"sankey")}};JX=PX([OX([...LX,{name:"layout",type:"value"}])],JX);let QX=class extends wX{constructor(){super({},"treemap")}};QX=PX([OX([...LX,{name:"layout",type:"value"}])],QX);let tq=class extends wX{constructor(){super({},"boxplot")}};tq=PX([OX(LX)],tq);let eq=class extends wX{constructor(){super({},"pack")}};eq=PX([OX([...LX,{name:"layout",type:"value"}])],eq);let nq=class extends wX{constructor(){super({},"forceGraph")}};nq=PX([OX([...LX,{name:"layout",type:"value"}])],nq);let rq=class extends wX{constructor(){super({},"tree")}};rq=PX([OX([...LX,{name:"layout",type:"value"}])],rq);let iq=class extends wX{constructor(){super({},"wordCloud")}};iq=PX([OX([...LX,{name:"layout",type:"object"}])],iq);const oq={interval:RX,rect:IX,point:NX,area:DX,line:FX,cell:jX,vector:BX,link:zX,polygon:UX,image:VX,text:GX,box:WX,lineX:HX,lineY:YX,range:XX,rangeX:qX,rangeY:ZX,connector:$X,sankey:JX,treemap:QX,boxplot:tq,shape:KX,pack:eq,forceGraph:nq,tree:rq,wordCloud:iq};var aq=globalThis&&globalThis.__decorate||function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a};let sq=class extends wX{constructor(){super({},"view")}};sq=aq([OX([{type:"value",name:"data"},{type:"array",name:"coordinate",key:"coordinates"},{type:"array",name:"interaction",key:"interactions"},{type:"object",name:"theme"},{type:"object",name:"style"},{type:"object",name:"scale"},{type:"object",name:"axis"},{type:"object",name:"legend"},...kX(oq)])],sq);var uq=globalThis&&globalThis.__decorate||function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a};let cq=class extends wX{constructor(){super({},"spaceLayer")}};cq=uq([OX([{type:"value",name:"data"},...kX(oq)])],cq);var lq=globalThis&&globalThis.__decorate||function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a};let hq=class extends wX{constructor(){super({},"spaceFlex")}};hq=lq([OX([{type:"value",name:"data"},...kX(oq)])],hq);var fq=globalThis&&globalThis.__decorate||function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a};let pq=class extends wX{constructor(){super({},"facetRect")}};pq=fq([OX([{type:"value",name:"data"},{type:"array",name:"transform"},{type:"object",name:"scale"},{type:"object",name:"encode"},{type:"object",name:"legend"},{type:"object",name:"axis"},...kX(oq)])],pq);var dq=globalThis&&globalThis.__decorate||function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a};let mq=class extends wX{constructor(){super({},"facetCircle")}};mq=dq([OX([{type:"value",name:"data"},{type:"array",name:"transform"},{type:"object",name:"scale"},{type:"object",name:"encode"},{type:"object",name:"legend"},{type:"object",name:"axis"},...kX(oq)])],mq);var vq=globalThis&&globalThis.__decorate||function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a};let gq=class extends wX{constructor(){super({},"repeatMatrix")}};gq=vq([OX([{type:"value",name:"data"},{type:"array",name:"transform"},{type:"object",name:"scale"},{type:"object",name:"encode"},{type:"object",name:"encode"},{type:"object",name:"legend"},...kX(oq)])],gq);var yq=globalThis&&globalThis.__decorate||function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a};let xq=class extends wX{constructor(){super({},"timingKeyframe")}};xq=yq([OX([...kX(oq)])],xq);var bq=globalThis&&globalThis.__decorate||function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a};let _q=class extends wX{constructor(){super({},"geoView")}};_q=bq([OX([{type:"value",name:"data"},{type:"value",name:"projection"},{type:"array",name:"coordinate",key:"coordinates"},{type:"array",name:"interaction",key:"interactions"},{type:"object",name:"theme"},{type:"object",name:"style"},{type:"object",name:"scale"},{type:"object",name:"legend"},...kX(oq)])],_q);var wq=globalThis&&globalThis.__decorate||function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a};let Sq=class extends wX{constructor(){super({},"geoPath")}};Sq=wq([OX([{type:"value",name:"data"},{type:"value",name:"projection"},{type:"array",name:"coordinate",key:"coordinates"},{type:"array",name:"interaction",key:"interactions"},{type:"object",name:"theme"},{type:"object",name:"style"},{type:"object",name:"scale"},{type:"object",name:"encode"},{type:"object",name:"legend"},...kX(oq)])],Sq);const Mq={view:sq,spaceLayer:cq,spaceFlex:hq,facetRect:pq,facetCircle:mq,repeatMatrix:gq,timingKeyframe:xq,geoView:_q,geoPath:Sq};for(const my of Object.values(Mq))OX(kX(Mq))(my);const Eq=UV();var Aq=globalThis&&globalThis.__decorate||function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},Tq=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};function Cq(t){return Object.assign(Object.assign({},t.value),{type:t.type})}const Oq=[{name:"data",type:"value"},{name:"width",type:"value"},{name:"height",type:"value"},{name:"coordinate",type:"array",key:"coordinates"},{name:"interaction",type:"array",key:"interactions"},{name:"theme",type:"object"},{name:"title",type:"object"},{name:"key",type:"value"},{name:"transform",type:"array"},{name:"theme",type:"object"},{name:"on",type:"event"},{name:"scale",type:"object"},{name:"axis",type:"object"},{name:"legend",type:"object"},{name:"style",type:"object"},...kX(oq),...(kq=Mq,Object.entries(kq).map((([t,e])=>({type:"container",name:t,ctor:e}))))];var kq;let Pq=class extends wX{constructor(t={}){const{container:e}=t;super(Tq(t,["container"]),"view"),this._container=function(t){if(void 0===t)return document.createElement("div");if("string"==typeof t)return document.getElementById(t);return t}(e),this._context={library:Eq}}render(){if(!this._context.canvas){const{width:t=640,height:e=480,renderer:n,plugins:r,autoFit:i}=this.options(),{width:o,height:a}=Lw(this._container,i,t,e);this.width(o),this.height(a),this._context.canvas=function(t,e,n,r=new Ry,i=[]){return i.push(new zy),i.forEach((t=>r.registerPlugin(t))),new Nm({container:t,width:e,height:n,renderer:r})}(this._container,t,e,n,r)}return yX(this.options(),this._context),this}options(){return function(t){const e=function(t){if(null!==t.type)return t;const e=t.children[t.children.length-1];return e.attr("width",t.attr("width")),e.attr("height",t.attr("height")),e.attr("paddingLeft",t.attr("paddingLeft")),e.attr("paddingTop",t.attr("paddingTop")),e.attr("paddingBottom",t.attr("paddingBottom")),e.attr("paddingRight",t.attr("paddingRight")),e.attr("insetLeft",t.attr("insetLeft")),e.attr("insetRight",t.attr("insetRight")),e.attr("insetBottom",t.attr("insetBottom")),e.attr("insetTop",t.attr("insetTop")),e.attr("marginLeft",t.attr("marginLeft")),e.attr("marginBottom",t.attr("marginBottom")),e.attr("marginTop",t.attr("marginTop")),e.attr("marginRight",t.attr("marginRight")),e.attr("autoFit",t.attr("autoFit")),e.attr("padding",t.attr("padding")),e.attr("margin",t.attr("margin")),e.attr("inset",t.attr("inset")),e}(t),n=[e],r=new Map;for(r.set(e,Cq(e));n.length;){const t=n.pop(),e=r.get(t);for(const i of t.children){const t=Cq(i),{children:o=[]}=e;o.push(t),n.push(i),r.set(i,t),e.children=o}}return r.get(e)}(this)}node(){return this._container}context(){return this._context}destroy(){const t=this.options(),{on:e}=t;WV(e,VV.BEFORE_DESTROY),xX(t,this._context),function(t){const e=t.parentNode;e&&e.removeChild(t)}(this._container),WV(e,VV.AFTER_DESTROY)}clear(){const t=this.options(),{on:e}=t;WV(e,VV.BEFORE_CLEAR),xX(t,this._context),WV(e,VV.AFTER_CLEAR)}forceFit(){const{width:t,height:e}=this.options(),{width:n,height:r}=Lw(this._container,!0,t,e);this.changeSize(n,r)}changeSize(t,e){const{width:n,height:r,on:i}=this.options();if(n===t&&r===e)return this;WV(i,VV.BEFORE_CHANGE_SIZE),this.width(t),this.height(e),this.render(),WV(i,VV.AFTER_CHANGE_SIZE)}};Pq=Aq([OX(Oq)],Pq);var Lq={},Rq={},Iq=function(t){return Rq[t]},Nq=function(t,e){Rq[t]=e},Dq=function(t,e){Lq[t]=e},Fq={},jq={};function Bq(t){return new Function("d","return {"+t.map((function(t,e){return JSON.stringify(t)+": d["+e+'] || ""'})).join(",")+"}")}function zq(t){var e=Object.create(null),n=[];return t.forEach((function(t){for(var r in t)r in e||n.push(e[r]=r)})),n}function Uq(t,e){var n=t+"",r=n.length;return r<e?new Array(e-r+1).join(0)+n:n}function Vq(t){var e,n=t.getUTCHours(),r=t.getUTCMinutes(),i=t.getUTCSeconds(),o=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":((e=t.getUTCFullYear())<0?"-"+Uq(-e,6):e>9999?"+"+Uq(e,6):Uq(e,4))+"-"+Uq(t.getUTCMonth()+1,2)+"-"+Uq(t.getUTCDate(),2)+(o?"T"+Uq(n,2)+":"+Uq(r,2)+":"+Uq(i,2)+"."+Uq(o,3)+"Z":i?"T"+Uq(n,2)+":"+Uq(r,2)+":"+Uq(i,2)+"Z":r||n?"T"+Uq(n,2)+":"+Uq(r,2)+"Z":"")}var Gq=function(t){var e=new RegExp('["'+t+"\n\r]"),n=t.charCodeAt(0);function r(t,e){var r,i=[],o=t.length,a=0,s=0,u=o<=0,c=!1;function l(){if(u)return jq;if(c)return c=!1,Fq;var e,r,i=a;if(34===t.charCodeAt(i)){for(;a++<o&&34!==t.charCodeAt(a)||34===t.charCodeAt(++a););return(e=a)>=o?u=!0:10===(r=t.charCodeAt(a++))?c=!0:13===r&&(c=!0,10===t.charCodeAt(a)&&++a),t.slice(i+1,e-1).replace(/""/g,'"')}for(;a<o;){if(10===(r=t.charCodeAt(e=a++)))c=!0;else if(13===r)c=!0,10===t.charCodeAt(a)&&++a;else if(r!==n)continue;return t.slice(i,e)}return u=!0,t.slice(i,o)}for(10===t.charCodeAt(o-1)&&--o,13===t.charCodeAt(o-1)&&--o;(r=l())!==jq;){for(var h=[];r!==Fq&&r!==jq;)h.push(r),r=l();e&&null==(h=e(h,s++))||i.push(h)}return i}function i(e,n){return e.map((function(e){return n.map((function(t){return a(e[t])})).join(t)}))}function o(e){return e.map(a).join(t)}function a(t){return null==t?"":t instanceof Date?Vq(t):e.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t}return{parse:function(t,e){var n,i,o=r(t,(function(t,r){if(n)return n(t,r-1);i=t,n=e?function(t,e){var n=Bq(t);return function(r,i){return e(n(r),i,t)}}(t,e):Bq(t)}));return o.columns=i||[],o},parseRows:r,format:function(e,n){return null==n&&(n=zq(e)),[n.map(a).join(t)].concat(i(e,n)).join("\n")},formatBody:function(t,e){return null==e&&(e=zq(t)),i(t,e).join("\n")},formatRows:function(t){return t.map(o).join("\n")},formatRow:o,formatValue:a}}(","),Wq=Gq.parse;function Hq(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Yq(t,e){if(t){if("string"==typeof t)return Hq(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Hq(t,e):void 0}}function Xq(t){return function(t){if(Array.isArray(t))return Hq(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Yq(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function qq(t){return(qq="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zq(t){var e=function(t,e){if("object"!==qq(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==qq(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===qq(e)?e:String(e)}function $q(t,e,n){return(e=Zq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kq(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Jq(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Kq(Object(n),!0).forEach((function(e){$q(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Kq(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Qq=function t(e,n){var r,i=e&&e.type;if("FeatureCollection"===i)for(r=0;r<e.features.length;r++)t(e.features[r],n);else if("GeometryCollection"===i)for(r=0;r<e.geometries.length;r++)t(e.geometries[r],n);else if("Feature"===i)t(e.geometry,n);else if("Polygon"===i)tZ(e.coordinates,n);else if("MultiPolygon"===i)for(r=0;r<e.coordinates.length;r++)tZ(e.coordinates[r],n);return e};function tZ(t,e){if(0!==t.length){eZ(t[0],e);for(var n=1;n<t.length;n++)eZ(t[n],!e)}}function eZ(t,e){for(var n=0,r=0,i=0,o=t.length,a=o-1;i<o;a=i++){var s=(t[i][0]-t[a][0])*(t[a][1]+t[i][1]),u=n+s;r+=Math.abs(n)>=Math.abs(s)?n-u+s:s-u+n,n=u}n+r>=0!=!!e&&t.reverse()}function nZ(t,e,n){void 0===n&&(n={});var r={type:"Feature"};return(0===n.id||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=e||{},r.geometry=t,r}function rZ(t,e,n){void 0===n&&(n={});for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var a=0;a<o[o.length-1].length;a++)if(o[o.length-1][a]!==o[0][a])throw new Error("First and last Position are not equivalent.")}return nZ({type:"Polygon",coordinates:t},e,n)}function iZ(t,e,n){if(void 0===n&&(n={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");return nZ({type:"LineString",coordinates:t},e,n)}function oZ(t){if(Array.isArray(t))return t;if("Feature"===t.type){if(null!==t.geometry)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function aZ(t){return"Feature"===t.type?t.geometry:t}function sZ(t,e,n){if(null!==t)for(var r,i,o,a,s,u,c,l,h=0,f=0,p=t.type,d="FeatureCollection"===p,m="Feature"===p,v=d?t.features.length:1,g=0;g<v;g++){s=(l=!!(c=d?t.features[g].geometry:m?t.geometry:t)&&"GeometryCollection"===c.type)?c.geometries.length:1;for(var y=0;y<s;y++){var x=0,b=0;if(null!==(a=l?c.geometries[y]:c)){u=a.coordinates;var _=a.type;switch(h=!n||"Polygon"!==_&&"MultiPolygon"!==_?0:1,_){case null:break;case"Point":if(!1===e(u,f,g,x,b))return!1;f++,x++;break;case"LineString":case"MultiPoint":for(r=0;r<u.length;r++){if(!1===e(u[r],f,g,x,b))return!1;f++,"MultiPoint"===_&&x++}"LineString"===_&&x++;break;case"Polygon":case"MultiLineString":for(r=0;r<u.length;r++){for(i=0;i<u[r].length-h;i++){if(!1===e(u[r][i],f,g,x,b))return!1;f++}"MultiLineString"===_&&x++,"Polygon"===_&&b++}"Polygon"===_&&x++;break;case"MultiPolygon":for(r=0;r<u.length;r++){for(b=0,i=0;i<u[r].length;i++){for(o=0;o<u[r][i].length-h;o++){if(!1===e(u[r][i][o],f,g,x,b))return!1;f++}b++}x++}break;case"GeometryCollection":for(r=0;r<a.geometries.length;r++)if(!1===sZ(a.geometries[r],e,n))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function uZ(t,e){!function(t,e){var n,r,i,o,a,s,u,c,l,h,f=0,p="FeatureCollection"===t.type,d="Feature"===t.type,m=p?t.features.length:1;for(n=0;n<m;n++){for(s=p?t.features[n].geometry:d?t.geometry:t,c=p?t.features[n].properties:d?t.properties:{},l=p?t.features[n].bbox:d?t.bbox:void 0,h=p?t.features[n].id:d?t.id:void 0,a=(u=!!s&&"GeometryCollection"===s.type)?s.geometries.length:1,i=0;i<a;i++)if(null!==(o=u?s.geometries[i]:s))switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(o,f,c,l,h))return!1;break;case"GeometryCollection":for(r=0;r<o.geometries.length;r++)if(!1===e(o.geometries[r],f,c,l,h))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,f,c,l,h))return!1;f++}}(t,(function(t,n,r,i,o){var a,s=null===t?null:t.type;switch(s){case null:case"Point":case"LineString":case"Polygon":return!1!==e(nZ(t,r,{bbox:i,id:o}),n,0)&&void 0}switch(s){case"MultiPoint":a="Point";break;case"MultiLineString":a="LineString";break;case"MultiPolygon":a="Polygon"}for(var u=0;u<t.coordinates.length;u++){var c=t.coordinates[u];if(!1===e(nZ({type:a,coordinates:c},r),n,u))return!1}}))}function cZ(t,e){var n=e.x,r=e.y,i=e.x1,o=e.y1,a=e.coordinates,s=e.geometry,u=[];if(!Array.isArray(t))return{dataArray:[]};if(s)return t.filter((function(t){return t[s]&&t[s].type&&t[s].coordinates&&t[s].coordinates.length>0})).forEach((function(t,e){uZ(Qq(Jq({},t[s]),!0),(function(n){var r=oZ(n),i=Jq(Jq({},t),{},{_id:e,coordinates:r});u.push(i)}))})),{dataArray:u};for(var c=0;c<t.length;c++){var l=t[c],h=[];if(a){var f="Polygon";Array.isArray(a[0])||(f="Point"),Array.isArray(a[0])&&!Array.isArray(a[0][0])&&(f="LineString"),h=Qq({type:f,coordinates:Xq(l[a])},!0).coordinates}else if(n&&r&&i&&o){h=[[parseFloat(l[n]),parseFloat(l[r])],[parseFloat(l[i]),parseFloat(l[o])]]}else n&&r&&(h=[parseFloat(l[n]),parseFloat(l[r])]);var p=Jq(Jq({},l),{},{_id:c,coordinates:h});u.push(p)}return{dataArray:u}}function lZ(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,a,s=[],u=!0,c=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(s.push(r.value),s.length!==e);u=!0);}catch(l){c=!0,i=l}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw i}}return s}}(t,e)||Yq(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var hZ={};
/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */
!function(t,e){(function(){var n,r="Expected a function",i="__lodash_hash_undefined__",o="__lodash_placeholder__",a=16,s=32,u=64,c=128,l=256,h=1/0,f=9007199254740991,p=NaN,d=4294967295,m=[["ary",c],["bind",1],["bindKey",2],["curry",8],["curryRight",a],["flip",512],["partial",s],["partialRight",u],["rearg",l]],v="[object Arguments]",g="[object Array]",y="[object Boolean]",x="[object Date]",b="[object Error]",_="[object Function]",w="[object GeneratorFunction]",S="[object Map]",M="[object Number]",E="[object Object]",A="[object Promise]",T="[object RegExp]",C="[object Set]",O="[object String]",k="[object Symbol]",P="[object WeakMap]",L="[object ArrayBuffer]",R="[object DataView]",I="[object Float32Array]",N="[object Float64Array]",D="[object Int8Array]",F="[object Int16Array]",j="[object Int32Array]",B="[object Uint8Array]",z="[object Uint8ClampedArray]",U="[object Uint16Array]",V="[object Uint32Array]",W=/\b__p \+= '';/g,H=/\b(__p \+=) '' \+/g,Y=/(__e\(.*?\)|\b__t\)) \+\n'';/g,X=/&(?:amp|lt|gt|quot|#39);/g,q=/[&<>"']/g,Z=RegExp(X.source),$=RegExp(q.source),K=/<%-([\s\S]+?)%>/g,J=/<%([\s\S]+?)%>/g,Q=/<%=([\s\S]+?)%>/g,tt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,et=/^\w*$/,nt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,rt=/[\\^$.*+?()[\]{}|]/g,it=RegExp(rt.source),ot=/^\s+/,at=/\s/,st=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ut=/\{\n\/\* \[wrapped with (.+)\] \*/,ct=/,? & /,lt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ht=/[()=,{}\[\]\/\s]/,ft=/\\(\\)?/g,pt=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,dt=/\w*$/,mt=/^[-+]0x[0-9a-f]+$/i,vt=/^0b[01]+$/i,gt=/^\[object .+?Constructor\]$/,yt=/^0o[0-7]+$/i,xt=/^(?:0|[1-9]\d*)$/,bt=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,_t=/($^)/,wt=/['\n\r\u2028\u2029\\]/g,St="\\ud800-\\udfff",Mt="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Et="\\u2700-\\u27bf",At="a-z\\xdf-\\xf6\\xf8-\\xff",Tt="A-Z\\xc0-\\xd6\\xd8-\\xde",Ct="\\ufe0e\\ufe0f",Ot="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",kt="['’]",Pt="["+St+"]",Lt="["+Ot+"]",Rt="["+Mt+"]",It="\\d+",Nt="["+Et+"]",Dt="["+At+"]",Ft="[^"+St+Ot+It+Et+At+Tt+"]",jt="\\ud83c[\\udffb-\\udfff]",Bt="[^"+St+"]",zt="(?:\\ud83c[\\udde6-\\uddff]){2}",Ut="[\\ud800-\\udbff][\\udc00-\\udfff]",Vt="["+Tt+"]",Gt="\\u200d",Wt="(?:"+Dt+"|"+Ft+")",Ht="(?:"+Vt+"|"+Ft+")",Yt="(?:['’](?:d|ll|m|re|s|t|ve))?",Xt="(?:['’](?:D|LL|M|RE|S|T|VE))?",qt="(?:"+Rt+"|"+jt+")"+"?",Zt="["+Ct+"]?",$t=Zt+qt+("(?:"+Gt+"(?:"+[Bt,zt,Ut].join("|")+")"+Zt+qt+")*"),Kt="(?:"+[Nt,zt,Ut].join("|")+")"+$t,Jt="(?:"+[Bt+Rt+"?",Rt,zt,Ut,Pt].join("|")+")",Qt=RegExp(kt,"g"),te=RegExp(Rt,"g"),ee=RegExp(jt+"(?="+jt+")|"+Jt+$t,"g"),ne=RegExp([Vt+"?"+Dt+"+"+Yt+"(?="+[Lt,Vt,"$"].join("|")+")",Ht+"+"+Xt+"(?="+[Lt,Vt+Wt,"$"].join("|")+")",Vt+"?"+Wt+"+"+Yt,Vt+"+"+Xt,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",It,Kt].join("|"),"g"),re=RegExp("["+Gt+St+Mt+Ct+"]"),ie=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,oe=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],ae=-1,se={};se[I]=se[N]=se[D]=se[F]=se[j]=se[B]=se[z]=se[U]=se[V]=!0,se[v]=se[g]=se[L]=se[y]=se[R]=se[x]=se[b]=se[_]=se[S]=se[M]=se[E]=se[T]=se[C]=se[O]=se[P]=!1;var ue={};ue[v]=ue[g]=ue[L]=ue[R]=ue[y]=ue[x]=ue[I]=ue[N]=ue[D]=ue[F]=ue[j]=ue[S]=ue[M]=ue[E]=ue[T]=ue[C]=ue[O]=ue[k]=ue[B]=ue[z]=ue[U]=ue[V]=!0,ue[b]=ue[_]=ue[P]=!1;var ce={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},le=parseFloat,he=parseInt,fe="object"==typeof G&&G&&G.Object===Object&&G,pe="object"==typeof self&&self&&self.Object===Object&&self,de=fe||pe||Function("return this")(),me=e&&!e.nodeType&&e,ve=me&&t&&!t.nodeType&&t,ge=ve&&ve.exports===me,ye=ge&&fe.process,xe=function(){try{var t=ve&&ve.require&&ve.require("util").types;return t||ye&&ye.binding&&ye.binding("util")}catch(e){}}(),be=xe&&xe.isArrayBuffer,_e=xe&&xe.isDate,we=xe&&xe.isMap,Se=xe&&xe.isRegExp,Me=xe&&xe.isSet,Ee=xe&&xe.isTypedArray;function Ae(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function Te(t,e,n,r){for(var i=-1,o=null==t?0:t.length;++i<o;){var a=t[i];e(r,a,n(a),t)}return r}function Ce(t,e){for(var n=-1,r=null==t?0:t.length;++n<r&&!1!==e(t[n],n,t););return t}function Oe(t,e){for(var n=null==t?0:t.length;n--&&!1!==e(t[n],n,t););return t}function ke(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(!e(t[n],n,t))return!1;return!0}function Pe(t,e){for(var n=-1,r=null==t?0:t.length,i=0,o=[];++n<r;){var a=t[n];e(a,n,t)&&(o[i++]=a)}return o}function Le(t,e){return!!(null==t?0:t.length)&&Ve(t,e,0)>-1}function Re(t,e,n){for(var r=-1,i=null==t?0:t.length;++r<i;)if(n(e,t[r]))return!0;return!1}function Ie(t,e){for(var n=-1,r=null==t?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}function Ne(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}function De(t,e,n,r){var i=-1,o=null==t?0:t.length;for(r&&o&&(n=t[++i]);++i<o;)n=e(n,t[i],i,t);return n}function Fe(t,e,n,r){var i=null==t?0:t.length;for(r&&i&&(n=t[--i]);i--;)n=e(n,t[i],i,t);return n}function je(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}var Be=Ye("length");function ze(t,e,n){var r;return n(t,(function(t,n,i){if(e(t,n,i))return r=n,!1})),r}function Ue(t,e,n,r){for(var i=t.length,o=n+(r?1:-1);r?o--:++o<i;)if(e(t[o],o,t))return o;return-1}function Ve(t,e,n){return e==e?function(t,e,n){var r=n-1,i=t.length;for(;++r<i;)if(t[r]===e)return r;return-1}(t,e,n):Ue(t,We,n)}function Ge(t,e,n,r){for(var i=n-1,o=t.length;++i<o;)if(r(t[i],e))return i;return-1}function We(t){return t!=t}function He(t,e){var n=null==t?0:t.length;return n?Ze(t,e)/n:p}function Ye(t){return function(e){return null==e?n:e[t]}}function Xe(t){return function(e){return null==t?n:t[e]}}function qe(t,e,n,r,i){return i(t,(function(t,i,o){n=r?(r=!1,t):e(n,t,i,o)})),n}function Ze(t,e){for(var r,i=-1,o=t.length;++i<o;){var a=e(t[i]);a!==n&&(r=r===n?a:r+a)}return r}function $e(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}function Ke(t){return t?t.slice(0,mn(t)+1).replace(ot,""):t}function Je(t){return function(e){return t(e)}}function Qe(t,e){return Ie(e,(function(e){return t[e]}))}function tn(t,e){return t.has(e)}function en(t,e){for(var n=-1,r=t.length;++n<r&&Ve(e,t[n],0)>-1;);return n}function nn(t,e){for(var n=t.length;n--&&Ve(e,t[n],0)>-1;);return n}function rn(t,e){for(var n=t.length,r=0;n--;)t[n]===e&&++r;return r}var on=Xe({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),an=Xe({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function sn(t){return"\\"+ce[t]}function un(t){return re.test(t)}function cn(t){var e=-1,n=Array(t.size);return t.forEach((function(t,r){n[++e]=[r,t]})),n}function ln(t,e){return function(n){return t(e(n))}}function hn(t,e){for(var n=-1,r=t.length,i=0,a=[];++n<r;){var s=t[n];s!==e&&s!==o||(t[n]=o,a[i++]=n)}return a}function fn(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n}function pn(t){return un(t)?function(t){var e=ee.lastIndex=0;for(;ee.test(t);)++e;return e}(t):Be(t)}function dn(t){return un(t)?function(t){return t.match(ee)||[]}(t):function(t){return t.split("")}(t)}function mn(t){for(var e=t.length;e--&&at.test(t.charAt(e)););return e}var vn=Xe({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});var gn=function t(e){var G=(e=null==e?de:gn.defaults(de.Object(),e,gn.pick(de,oe))).Array,at=e.Date,St=e.Error,Mt=e.Function,Et=e.Math,At=e.Object,Tt=e.RegExp,Ct=e.String,Ot=e.TypeError,kt=G.prototype,Pt=Mt.prototype,Lt=At.prototype,Rt=e["__core-js_shared__"],It=Pt.toString,Nt=Lt.hasOwnProperty,Dt=0,Ft=function(){var t=/[^.]+$/.exec(Rt&&Rt.keys&&Rt.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),jt=Lt.toString,Bt=It.call(At),zt=de._,Ut=Tt("^"+It.call(Nt).replace(rt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Vt=ge?e.Buffer:n,Gt=e.Symbol,Wt=e.Uint8Array,Ht=Vt?Vt.allocUnsafe:n,Yt=ln(At.getPrototypeOf,At),Xt=At.create,qt=Lt.propertyIsEnumerable,Zt=kt.splice,$t=Gt?Gt.isConcatSpreadable:n,Kt=Gt?Gt.iterator:n,Jt=Gt?Gt.toStringTag:n,ee=function(){try{var t=ho(At,"defineProperty");return t({},"",{}),t}catch(e){}}(),re=e.clearTimeout!==de.clearTimeout&&e.clearTimeout,ce=at&&at.now!==de.Date.now&&at.now,fe=e.setTimeout!==de.setTimeout&&e.setTimeout,pe=Et.ceil,me=Et.floor,ve=At.getOwnPropertySymbols,ye=Vt?Vt.isBuffer:n,xe=e.isFinite,Be=kt.join,Xe=ln(At.keys,At),yn=Et.max,xn=Et.min,bn=at.now,_n=e.parseInt,wn=Et.random,Sn=kt.reverse,Mn=ho(e,"DataView"),En=ho(e,"Map"),An=ho(e,"Promise"),Tn=ho(e,"Set"),Cn=ho(e,"WeakMap"),On=ho(At,"create"),kn=Cn&&new Cn,Pn={},Ln=Bo(Mn),Rn=Bo(En),In=Bo(An),Nn=Bo(Tn),Dn=Bo(Cn),Fn=Gt?Gt.prototype:n,jn=Fn?Fn.valueOf:n,Bn=Fn?Fn.toString:n;function zn(t){if(ns(t)&&!Ha(t)&&!(t instanceof Wn)){if(t instanceof Gn)return t;if(Nt.call(t,"__wrapped__"))return zo(t)}return new Gn(t)}var Un=function(){function t(){}return function(e){if(!es(e))return{};if(Xt)return Xt(e);t.prototype=e;var r=new t;return t.prototype=n,r}}();function Vn(){}function Gn(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=n}function Wn(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=d,this.__views__=[]}function Hn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Yn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Xn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function qn(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new Xn;++e<n;)this.add(t[e])}function Zn(t){var e=this.__data__=new Yn(t);this.size=e.size}function $n(t,e){var n=Ha(t),r=!n&&Wa(t),i=!n&&!r&&Za(t),o=!n&&!r&&!i&&ls(t),a=n||r||i||o,s=a?$e(t.length,Ct):[],u=s.length;for(var c in t)!e&&!Nt.call(t,c)||a&&("length"==c||i&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||xo(c,u))||s.push(c);return s}function Kn(t){var e=t.length;return e?t[qr(0,e-1)]:n}function Jn(t,e){return Do(Oi(t),sr(e,0,t.length))}function Qn(t){return Do(Oi(t))}function tr(t,e,r){(r!==n&&!Ua(t[e],r)||r===n&&!(e in t))&&or(t,e,r)}function er(t,e,r){var i=t[e];Nt.call(t,e)&&Ua(i,r)&&(r!==n||e in t)||or(t,e,r)}function nr(t,e){for(var n=t.length;n--;)if(Ua(t[n][0],e))return n;return-1}function rr(t,e,n,r){return fr(t,(function(t,i,o){e(r,t,n(t),o)})),r}function ir(t,e){return t&&ki(e,Ls(e),t)}function or(t,e,n){"__proto__"==e&&ee?ee(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function ar(t,e){for(var r=-1,i=e.length,o=G(i),a=null==t;++r<i;)o[r]=a?n:Ts(t,e[r]);return o}function sr(t,e,r){return t==t&&(r!==n&&(t=t<=r?t:r),e!==n&&(t=t>=e?t:e)),t}function ur(t,e,r,i,o,a){var s,u=1&e,c=2&e,l=4&e;if(r&&(s=o?r(t,i,o,a):r(t)),s!==n)return s;if(!es(t))return t;var h=Ha(t);if(h){if(s=function(t){var e=t.length,n=new t.constructor(e);e&&"string"==typeof t[0]&&Nt.call(t,"index")&&(n.index=t.index,n.input=t.input);return n}(t),!u)return Oi(t,s)}else{var f=mo(t),p=f==_||f==w;if(Za(t))return Si(t,u);if(f==E||f==v||p&&!o){if(s=c||p?{}:go(t),!u)return c?function(t,e){return ki(t,po(t),e)}(t,function(t,e){return t&&ki(e,Rs(e),t)}(s,t)):function(t,e){return ki(t,fo(t),e)}(t,ir(s,t))}else{if(!ue[f])return o?t:{};s=function(t,e,n){var r=t.constructor;switch(e){case L:return Mi(t);case y:case x:return new r(+t);case R:return function(t,e){var n=e?Mi(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}(t,n);case I:case N:case D:case F:case j:case B:case z:case U:case V:return Ei(t,n);case S:return new r;case M:case O:return new r(t);case T:return function(t){var e=new t.constructor(t.source,dt.exec(t));return e.lastIndex=t.lastIndex,e}(t);case C:return new r;case k:return i=t,jn?At(jn.call(i)):{}}var i}(t,f,u)}}a||(a=new Zn);var d=a.get(t);if(d)return d;a.set(t,s),ss(t)?t.forEach((function(n){s.add(ur(n,e,r,n,t,a))})):rs(t)&&t.forEach((function(n,i){s.set(i,ur(n,e,r,i,t,a))}));var m=h?n:(l?c?io:ro:c?Rs:Ls)(t);return Ce(m||t,(function(n,i){m&&(n=t[i=n]),er(s,i,ur(n,e,r,i,t,a))})),s}function cr(t,e,r){var i=r.length;if(null==t)return!i;for(t=At(t);i--;){var o=r[i],a=e[o],s=t[o];if(s===n&&!(o in t)||!a(s))return!1}return!0}function lr(t,e,i){if("function"!=typeof t)throw new Ot(r);return Lo((function(){t.apply(n,i)}),e)}function hr(t,e,n,r){var i=-1,o=Le,a=!0,s=t.length,u=[],c=e.length;if(!s)return u;n&&(e=Ie(e,Je(n))),r?(o=Re,a=!1):e.length>=200&&(o=tn,a=!1,e=new qn(e));t:for(;++i<s;){var l=t[i],h=null==n?l:n(l);if(l=r||0!==l?l:0,a&&h==h){for(var f=c;f--;)if(e[f]===h)continue t;u.push(l)}else o(e,h,r)||u.push(l)}return u}zn.templateSettings={escape:K,evaluate:J,interpolate:Q,variable:"",imports:{_:zn}},zn.prototype=Vn.prototype,zn.prototype.constructor=zn,Gn.prototype=Un(Vn.prototype),Gn.prototype.constructor=Gn,Wn.prototype=Un(Vn.prototype),Wn.prototype.constructor=Wn,Hn.prototype.clear=function(){this.__data__=On?On(null):{},this.size=0},Hn.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},Hn.prototype.get=function(t){var e=this.__data__;if(On){var r=e[t];return r===i?n:r}return Nt.call(e,t)?e[t]:n},Hn.prototype.has=function(t){var e=this.__data__;return On?e[t]!==n:Nt.call(e,t)},Hn.prototype.set=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=On&&e===n?i:e,this},Yn.prototype.clear=function(){this.__data__=[],this.size=0},Yn.prototype.delete=function(t){var e=this.__data__,n=nr(e,t);return!(n<0)&&(n==e.length-1?e.pop():Zt.call(e,n,1),--this.size,!0)},Yn.prototype.get=function(t){var e=this.__data__,r=nr(e,t);return r<0?n:e[r][1]},Yn.prototype.has=function(t){return nr(this.__data__,t)>-1},Yn.prototype.set=function(t,e){var n=this.__data__,r=nr(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this},Xn.prototype.clear=function(){this.size=0,this.__data__={hash:new Hn,map:new(En||Yn),string:new Hn}},Xn.prototype.delete=function(t){var e=co(this,t).delete(t);return this.size-=e?1:0,e},Xn.prototype.get=function(t){return co(this,t).get(t)},Xn.prototype.has=function(t){return co(this,t).has(t)},Xn.prototype.set=function(t,e){var n=co(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this},qn.prototype.add=qn.prototype.push=function(t){return this.__data__.set(t,i),this},qn.prototype.has=function(t){return this.__data__.has(t)},Zn.prototype.clear=function(){this.__data__=new Yn,this.size=0},Zn.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},Zn.prototype.get=function(t){return this.__data__.get(t)},Zn.prototype.has=function(t){return this.__data__.has(t)},Zn.prototype.set=function(t,e){var n=this.__data__;if(n instanceof Yn){var r=n.__data__;if(!En||r.length<199)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new Xn(r)}return n.set(t,e),this.size=n.size,this};var fr=Ri(br),pr=Ri(_r,!0);function dr(t,e){var n=!0;return fr(t,(function(t,r,i){return n=!!e(t,r,i)})),n}function mr(t,e,r){for(var i=-1,o=t.length;++i<o;){var a=t[i],s=e(a);if(null!=s&&(u===n?s==s&&!cs(s):r(s,u)))var u=s,c=a}return c}function vr(t,e){var n=[];return fr(t,(function(t,r,i){e(t,r,i)&&n.push(t)})),n}function gr(t,e,n,r,i){var o=-1,a=t.length;for(n||(n=yo),i||(i=[]);++o<a;){var s=t[o];e>0&&n(s)?e>1?gr(s,e-1,n,r,i):Ne(i,s):r||(i[i.length]=s)}return i}var yr=Ii(),xr=Ii(!0);function br(t,e){return t&&yr(t,e,Ls)}function _r(t,e){return t&&xr(t,e,Ls)}function wr(t,e){return Pe(e,(function(e){return Ja(t[e])}))}function Sr(t,e){for(var r=0,i=(e=xi(e,t)).length;null!=t&&r<i;)t=t[jo(e[r++])];return r&&r==i?t:n}function Mr(t,e,n){var r=e(t);return Ha(t)?r:Ne(r,n(t))}function Er(t){return null==t?t===n?"[object Undefined]":"[object Null]":Jt&&Jt in At(t)?function(t){var e=Nt.call(t,Jt),r=t[Jt];try{t[Jt]=n;var i=!0}catch(a){}var o=jt.call(t);i&&(e?t[Jt]=r:delete t[Jt]);return o}(t):function(t){return jt.call(t)}(t)}function Ar(t,e){return t>e}function Tr(t,e){return null!=t&&Nt.call(t,e)}function Cr(t,e){return null!=t&&e in At(t)}function Or(t,e,r){for(var i=r?Re:Le,o=t[0].length,a=t.length,s=a,u=G(a),c=1/0,l=[];s--;){var h=t[s];s&&e&&(h=Ie(h,Je(e))),c=xn(h.length,c),u[s]=!r&&(e||o>=120&&h.length>=120)?new qn(s&&h):n}h=t[0];var f=-1,p=u[0];t:for(;++f<o&&l.length<c;){var d=h[f],m=e?e(d):d;if(d=r||0!==d?d:0,!(p?tn(p,m):i(l,m,r))){for(s=a;--s;){var v=u[s];if(!(v?tn(v,m):i(t[s],m,r)))continue t}p&&p.push(m),l.push(d)}}return l}function kr(t,e,r){var i=null==(t=Co(t,e=xi(e,t)))?t:t[jo(Ko(e))];return null==i?n:Ae(i,t,r)}function Pr(t){return ns(t)&&Er(t)==v}function Lr(t,e,r,i,o){return t===e||(null==t||null==e||!ns(t)&&!ns(e)?t!=t&&e!=e:function(t,e,r,i,o,a){var s=Ha(t),u=Ha(e),c=s?g:mo(t),l=u?g:mo(e),h=(c=c==v?E:c)==E,f=(l=l==v?E:l)==E,p=c==l;if(p&&Za(t)){if(!Za(e))return!1;s=!0,h=!1}if(p&&!h)return a||(a=new Zn),s||ls(t)?eo(t,e,r,i,o,a):function(t,e,n,r,i,o,a){switch(n){case R:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case L:return!(t.byteLength!=e.byteLength||!o(new Wt(t),new Wt(e)));case y:case x:case M:return Ua(+t,+e);case b:return t.name==e.name&&t.message==e.message;case T:case O:return t==e+"";case S:var s=cn;case C:var u=1&r;if(s||(s=fn),t.size!=e.size&&!u)return!1;var c=a.get(t);if(c)return c==e;r|=2,a.set(t,e);var l=eo(s(t),s(e),r,i,o,a);return a.delete(t),l;case k:if(jn)return jn.call(t)==jn.call(e)}return!1}(t,e,c,r,i,o,a);if(!(1&r)){var d=h&&Nt.call(t,"__wrapped__"),m=f&&Nt.call(e,"__wrapped__");if(d||m){var _=d?t.value():t,w=m?e.value():e;return a||(a=new Zn),o(_,w,r,i,a)}}if(!p)return!1;return a||(a=new Zn),function(t,e,r,i,o,a){var s=1&r,u=ro(t),c=u.length,l=ro(e),h=l.length;if(c!=h&&!s)return!1;var f=c;for(;f--;){var p=u[f];if(!(s?p in e:Nt.call(e,p)))return!1}var d=a.get(t),m=a.get(e);if(d&&m)return d==e&&m==t;var v=!0;a.set(t,e),a.set(e,t);var g=s;for(;++f<c;){var y=t[p=u[f]],x=e[p];if(i)var b=s?i(x,y,p,e,t,a):i(y,x,p,t,e,a);if(!(b===n?y===x||o(y,x,r,i,a):b)){v=!1;break}g||(g="constructor"==p)}if(v&&!g){var _=t.constructor,w=e.constructor;_==w||!("constructor"in t)||!("constructor"in e)||"function"==typeof _&&_ instanceof _&&"function"==typeof w&&w instanceof w||(v=!1)}return a.delete(t),a.delete(e),v}(t,e,r,i,o,a)}(t,e,r,i,Lr,o))}function Rr(t,e,r,i){var o=r.length,a=o,s=!i;if(null==t)return!a;for(t=At(t);o--;){var u=r[o];if(s&&u[2]?u[1]!==t[u[0]]:!(u[0]in t))return!1}for(;++o<a;){var c=(u=r[o])[0],l=t[c],h=u[1];if(s&&u[2]){if(l===n&&!(c in t))return!1}else{var f=new Zn;if(i)var p=i(l,h,c,t,e,f);if(!(p===n?Lr(h,l,3,i,f):p))return!1}}return!0}function Ir(t){return!(!es(t)||function(t){return!!Ft&&Ft in t}(t))&&(Ja(t)?Ut:gt).test(Bo(t))}function Nr(t){return"function"==typeof t?t:null==t?iu:"object"==typeof t?Ha(t)?Ur(t[0],t[1]):zr(t):pu(t)}function Dr(t){if(!Mo(t))return Xe(t);var e=[];for(var n in At(t))Nt.call(t,n)&&"constructor"!=n&&e.push(n);return e}function Fr(t){if(!es(t))return function(t){var e=[];if(null!=t)for(var n in At(t))e.push(n);return e}(t);var e=Mo(t),n=[];for(var r in t)("constructor"!=r||!e&&Nt.call(t,r))&&n.push(r);return n}function jr(t,e){return t<e}function Br(t,e){var n=-1,r=Xa(t)?G(t.length):[];return fr(t,(function(t,i,o){r[++n]=e(t,i,o)})),r}function zr(t){var e=lo(t);return 1==e.length&&e[0][2]?Ao(e[0][0],e[0][1]):function(n){return n===t||Rr(n,t,e)}}function Ur(t,e){return _o(t)&&Eo(e)?Ao(jo(t),e):function(r){var i=Ts(r,t);return i===n&&i===e?Cs(r,t):Lr(e,i,3)}}function Vr(t,e,r,i,o){t!==e&&yr(e,(function(a,s){if(o||(o=new Zn),es(a))!function(t,e,r,i,o,a,s){var u=ko(t,r),c=ko(e,r),l=s.get(c);if(l)return void tr(t,r,l);var h=a?a(u,c,r+"",t,e,s):n,f=h===n;if(f){var p=Ha(c),d=!p&&Za(c),m=!p&&!d&&ls(c);h=c,p||d||m?Ha(u)?h=u:qa(u)?h=Oi(u):d?(f=!1,h=Si(c,!0)):m?(f=!1,h=Ei(c,!0)):h=[]:os(c)||Wa(c)?(h=u,Wa(u)?h=ys(u):es(u)&&!Ja(u)||(h=go(c))):f=!1}f&&(s.set(c,h),o(h,c,i,a,s),s.delete(c));tr(t,r,h)}(t,e,s,r,Vr,i,o);else{var u=i?i(ko(t,s),a,s+"",t,e,o):n;u===n&&(u=a),tr(t,s,u)}}),Rs)}function Gr(t,e){var r=t.length;if(r)return xo(e+=e<0?r:0,r)?t[e]:n}function Wr(t,e,n){e=e.length?Ie(e,(function(t){return Ha(t)?function(e){return Sr(e,1===t.length?t[0]:t)}:t})):[iu];var r=-1;return e=Ie(e,Je(uo())),function(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}(Br(t,(function(t,n,i){return{criteria:Ie(e,(function(e){return e(t)})),index:++r,value:t}})),(function(t,e){return function(t,e,n){var r=-1,i=t.criteria,o=e.criteria,a=i.length,s=n.length;for(;++r<a;){var u=Ai(i[r],o[r]);if(u)return r>=s?u:u*("desc"==n[r]?-1:1)}return t.index-e.index}(t,e,n)}))}function Hr(t,e,n){for(var r=-1,i=e.length,o={};++r<i;){var a=e[r],s=Sr(t,a);n(s,a)&&Qr(o,xi(a,t),s)}return o}function Yr(t,e,n,r){var i=r?Ge:Ve,o=-1,a=e.length,s=t;for(t===e&&(e=Oi(e)),n&&(s=Ie(t,Je(n)));++o<a;)for(var u=0,c=e[o],l=n?n(c):c;(u=i(s,l,u,r))>-1;)s!==t&&Zt.call(s,u,1),Zt.call(t,u,1);return t}function Xr(t,e){for(var n=t?e.length:0,r=n-1;n--;){var i=e[n];if(n==r||i!==o){var o=i;xo(i)?Zt.call(t,i,1):hi(t,i)}}return t}function qr(t,e){return t+me(wn()*(e-t+1))}function Zr(t,e){var n="";if(!t||e<1||e>f)return n;do{e%2&&(n+=t),(e=me(e/2))&&(t+=t)}while(e);return n}function $r(t,e){return Ro(To(t,e,iu),t+"")}function Kr(t){return Kn(Us(t))}function Jr(t,e){var n=Us(t);return Do(n,sr(e,0,n.length))}function Qr(t,e,r,i){if(!es(t))return t;for(var o=-1,a=(e=xi(e,t)).length,s=a-1,u=t;null!=u&&++o<a;){var c=jo(e[o]),l=r;if("__proto__"===c||"constructor"===c||"prototype"===c)return t;if(o!=s){var h=u[c];(l=i?i(h,c,u):n)===n&&(l=es(h)?h:xo(e[o+1])?[]:{})}er(u,c,l),u=u[c]}return t}var ti=kn?function(t,e){return kn.set(t,e),t}:iu,ei=ee?function(t,e){return ee(t,"toString",{configurable:!0,enumerable:!1,value:eu(e),writable:!0})}:iu;function ni(t){return Do(Us(t))}function ri(t,e,n){var r=-1,i=t.length;e<0&&(e=-e>i?0:i+e),(n=n>i?i:n)<0&&(n+=i),i=e>n?0:n-e>>>0,e>>>=0;for(var o=G(i);++r<i;)o[r]=t[r+e];return o}function ii(t,e){var n;return fr(t,(function(t,r,i){return!(n=e(t,r,i))})),!!n}function oi(t,e,n){var r=0,i=null==t?r:t.length;if("number"==typeof e&&e==e&&i<=2147483647){for(;r<i;){var o=r+i>>>1,a=t[o];null!==a&&!cs(a)&&(n?a<=e:a<e)?r=o+1:i=o}return i}return ai(t,e,iu,n)}function ai(t,e,r,i){var o=0,a=null==t?0:t.length;if(0===a)return 0;for(var s=(e=r(e))!=e,u=null===e,c=cs(e),l=e===n;o<a;){var h=me((o+a)/2),f=r(t[h]),p=f!==n,d=null===f,m=f==f,v=cs(f);if(s)var g=i||m;else g=l?m&&(i||p):u?m&&p&&(i||!d):c?m&&p&&!d&&(i||!v):!d&&!v&&(i?f<=e:f<e);g?o=h+1:a=h}return xn(a,4294967294)}function si(t,e){for(var n=-1,r=t.length,i=0,o=[];++n<r;){var a=t[n],s=e?e(a):a;if(!n||!Ua(s,u)){var u=s;o[i++]=0===a?0:a}}return o}function ui(t){return"number"==typeof t?t:cs(t)?p:+t}function ci(t){if("string"==typeof t)return t;if(Ha(t))return Ie(t,ci)+"";if(cs(t))return Bn?Bn.call(t):"";var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function li(t,e,n){var r=-1,i=Le,o=t.length,a=!0,s=[],u=s;if(n)a=!1,i=Re;else if(o>=200){var c=e?null:Zi(t);if(c)return fn(c);a=!1,i=tn,u=new qn}else u=e?[]:s;t:for(;++r<o;){var l=t[r],h=e?e(l):l;if(l=n||0!==l?l:0,a&&h==h){for(var f=u.length;f--;)if(u[f]===h)continue t;e&&u.push(h),s.push(l)}else i(u,h,n)||(u!==s&&u.push(h),s.push(l))}return s}function hi(t,e){return null==(t=Co(t,e=xi(e,t)))||delete t[jo(Ko(e))]}function fi(t,e,n,r){return Qr(t,e,n(Sr(t,e)),r)}function pi(t,e,n,r){for(var i=t.length,o=r?i:-1;(r?o--:++o<i)&&e(t[o],o,t););return n?ri(t,r?0:o,r?o+1:i):ri(t,r?o+1:0,r?i:o)}function di(t,e){var n=t;return n instanceof Wn&&(n=n.value()),De(e,(function(t,e){return e.func.apply(e.thisArg,Ne([t],e.args))}),n)}function mi(t,e,n){var r=t.length;if(r<2)return r?li(t[0]):[];for(var i=-1,o=G(r);++i<r;)for(var a=t[i],s=-1;++s<r;)s!=i&&(o[i]=hr(o[i]||a,t[s],e,n));return li(gr(o,1),e,n)}function vi(t,e,r){for(var i=-1,o=t.length,a=e.length,s={};++i<o;){var u=i<a?e[i]:n;r(s,t[i],u)}return s}function gi(t){return qa(t)?t:[]}function yi(t){return"function"==typeof t?t:iu}function xi(t,e){return Ha(t)?t:_o(t,e)?[t]:Fo(xs(t))}var bi=$r;function _i(t,e,r){var i=t.length;return r=r===n?i:r,!e&&r>=i?t:ri(t,e,r)}var wi=re||function(t){return de.clearTimeout(t)};function Si(t,e){if(e)return t.slice();var n=t.length,r=Ht?Ht(n):new t.constructor(n);return t.copy(r),r}function Mi(t){var e=new t.constructor(t.byteLength);return new Wt(e).set(new Wt(t)),e}function Ei(t,e){var n=e?Mi(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}function Ai(t,e){if(t!==e){var r=t!==n,i=null===t,o=t==t,a=cs(t),s=e!==n,u=null===e,c=e==e,l=cs(e);if(!u&&!l&&!a&&t>e||a&&s&&c&&!u&&!l||i&&s&&c||!r&&c||!o)return 1;if(!i&&!a&&!l&&t<e||l&&r&&o&&!i&&!a||u&&r&&o||!s&&o||!c)return-1}return 0}function Ti(t,e,n,r){for(var i=-1,o=t.length,a=n.length,s=-1,u=e.length,c=yn(o-a,0),l=G(u+c),h=!r;++s<u;)l[s]=e[s];for(;++i<a;)(h||i<o)&&(l[n[i]]=t[i]);for(;c--;)l[s++]=t[i++];return l}function Ci(t,e,n,r){for(var i=-1,o=t.length,a=-1,s=n.length,u=-1,c=e.length,l=yn(o-s,0),h=G(l+c),f=!r;++i<l;)h[i]=t[i];for(var p=i;++u<c;)h[p+u]=e[u];for(;++a<s;)(f||i<o)&&(h[p+n[a]]=t[i++]);return h}function Oi(t,e){var n=-1,r=t.length;for(e||(e=G(r));++n<r;)e[n]=t[n];return e}function ki(t,e,r,i){var o=!r;r||(r={});for(var a=-1,s=e.length;++a<s;){var u=e[a],c=i?i(r[u],t[u],u,r,t):n;c===n&&(c=t[u]),o?or(r,u,c):er(r,u,c)}return r}function Pi(t,e){return function(n,r){var i=Ha(n)?Te:rr,o=e?e():{};return i(n,t,uo(r,2),o)}}function Li(t){return $r((function(e,r){var i=-1,o=r.length,a=o>1?r[o-1]:n,s=o>2?r[2]:n;for(a=t.length>3&&"function"==typeof a?(o--,a):n,s&&bo(r[0],r[1],s)&&(a=o<3?n:a,o=1),e=At(e);++i<o;){var u=r[i];u&&t(e,u,i,a)}return e}))}function Ri(t,e){return function(n,r){if(null==n)return n;if(!Xa(n))return t(n,r);for(var i=n.length,o=e?i:-1,a=At(n);(e?o--:++o<i)&&!1!==r(a[o],o,a););return n}}function Ii(t){return function(e,n,r){for(var i=-1,o=At(e),a=r(e),s=a.length;s--;){var u=a[t?s:++i];if(!1===n(o[u],u,o))break}return e}}function Ni(t){return function(e){var r=un(e=xs(e))?dn(e):n,i=r?r[0]:e.charAt(0),o=r?_i(r,1).join(""):e.slice(1);return i[t]()+o}}function Di(t){return function(e){return De(Js(Ws(e).replace(Qt,"")),t,"")}}function Fi(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var n=Un(t.prototype),r=t.apply(n,e);return es(r)?r:n}}function ji(t){return function(e,r,i){var o=At(e);if(!Xa(e)){var a=uo(r,3);e=Ls(e),r=function(t){return a(o[t],t,o)}}var s=t(e,r,i);return s>-1?o[a?e[s]:s]:n}}function Bi(t){return no((function(e){var i=e.length,o=i,a=Gn.prototype.thru;for(t&&e.reverse();o--;){var s=e[o];if("function"!=typeof s)throw new Ot(r);if(a&&!u&&"wrapper"==ao(s))var u=new Gn([],!0)}for(o=u?o:i;++o<i;){var c=ao(s=e[o]),l="wrapper"==c?oo(s):n;u=l&&wo(l[0])&&424==l[1]&&!l[4].length&&1==l[9]?u[ao(l[0])].apply(u,l[3]):1==s.length&&wo(s)?u[c]():u.thru(s)}return function(){var t=arguments,n=t[0];if(u&&1==t.length&&Ha(n))return u.plant(n).value();for(var r=0,o=i?e[r].apply(this,t):n;++r<i;)o=e[r].call(this,o);return o}}))}function zi(t,e,r,i,o,a,s,u,l,h){var f=e&c,p=1&e,d=2&e,m=24&e,v=512&e,g=d?n:Fi(t);return function n(){for(var c=arguments.length,y=G(c),x=c;x--;)y[x]=arguments[x];if(m)var b=so(n),_=rn(y,b);if(i&&(y=Ti(y,i,o,m)),a&&(y=Ci(y,a,s,m)),c-=_,m&&c<h){var w=hn(y,b);return Xi(t,e,zi,n.placeholder,r,y,w,u,l,h-c)}var S=p?r:this,M=d?S[t]:t;return c=y.length,u?y=Oo(y,u):v&&c>1&&y.reverse(),f&&l<c&&(y.length=l),this&&this!==de&&this instanceof n&&(M=g||Fi(M)),M.apply(S,y)}}function Ui(t,e){return function(n,r){return function(t,e,n,r){return br(t,(function(t,i,o){e(r,n(t),i,o)})),r}(n,t,e(r),{})}}function Vi(t,e){return function(r,i){var o;if(r===n&&i===n)return e;if(r!==n&&(o=r),i!==n){if(o===n)return i;"string"==typeof r||"string"==typeof i?(r=ci(r),i=ci(i)):(r=ui(r),i=ui(i)),o=t(r,i)}return o}}function Gi(t){return no((function(e){return e=Ie(e,Je(uo())),$r((function(n){var r=this;return t(e,(function(t){return Ae(t,r,n)}))}))}))}function Wi(t,e){var r=(e=e===n?" ":ci(e)).length;if(r<2)return r?Zr(e,t):e;var i=Zr(e,pe(t/pn(e)));return un(e)?_i(dn(i),0,t).join(""):i.slice(0,t)}function Hi(t){return function(e,r,i){return i&&"number"!=typeof i&&bo(e,r,i)&&(r=i=n),e=ds(e),r===n?(r=e,e=0):r=ds(r),function(t,e,n,r){for(var i=-1,o=yn(pe((e-t)/(n||1)),0),a=G(o);o--;)a[r?o:++i]=t,t+=n;return a}(e,r,i=i===n?e<r?1:-1:ds(i),t)}}function Yi(t){return function(e,n){return"string"==typeof e&&"string"==typeof n||(e=gs(e),n=gs(n)),t(e,n)}}function Xi(t,e,r,i,o,a,c,l,h,f){var p=8&e;e|=p?s:u,4&(e&=~(p?u:s))||(e&=-4);var d=[t,e,o,p?a:n,p?c:n,p?n:a,p?n:c,l,h,f],m=r.apply(n,d);return wo(t)&&Po(m,d),m.placeholder=i,Io(m,t,e)}function qi(t){var e=Et[t];return function(t,n){if(t=gs(t),(n=null==n?0:xn(ms(n),292))&&xe(t)){var r=(xs(t)+"e").split("e");return+((r=(xs(e(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return e(t)}}var Zi=Tn&&1/fn(new Tn([,-0]))[1]==h?function(t){return new Tn(t)}:cu;function $i(t){return function(e){var n=mo(e);return n==S?cn(e):n==C?function(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=[t,t]})),n}(e):function(t,e){return Ie(e,(function(e){return[e,t[e]]}))}(e,t(e))}}function Ki(t,e,i,h,f,p,d,m){var v=2&e;if(!v&&"function"!=typeof t)throw new Ot(r);var g=h?h.length:0;if(g||(e&=-97,h=f=n),d=d===n?d:yn(ms(d),0),m=m===n?m:ms(m),g-=f?f.length:0,e&u){var y=h,x=f;h=f=n}var b=v?n:oo(t),_=[t,e,i,h,f,y,x,p,d,m];if(b&&function(t,e){var n=t[1],r=e[1],i=n|r,a=i<131,s=r==c&&8==n||r==c&&n==l&&t[7].length<=e[8]||384==r&&e[7].length<=e[8]&&8==n;if(!a&&!s)return t;1&r&&(t[2]=e[2],i|=1&n?0:4);var u=e[3];if(u){var h=t[3];t[3]=h?Ti(h,u,e[4]):u,t[4]=h?hn(t[3],o):e[4]}(u=e[5])&&(h=t[5],t[5]=h?Ci(h,u,e[6]):u,t[6]=h?hn(t[5],o):e[6]);(u=e[7])&&(t[7]=u);r&c&&(t[8]=null==t[8]?e[8]:xn(t[8],e[8]));null==t[9]&&(t[9]=e[9]);t[0]=e[0],t[1]=i}(_,b),t=_[0],e=_[1],i=_[2],h=_[3],f=_[4],!(m=_[9]=_[9]===n?v?0:t.length:yn(_[9]-g,0))&&24&e&&(e&=-25),e&&1!=e)w=8==e||e==a?function(t,e,r){var i=Fi(t);return function o(){for(var a=arguments.length,s=G(a),u=a,c=so(o);u--;)s[u]=arguments[u];var l=a<3&&s[0]!==c&&s[a-1]!==c?[]:hn(s,c);return(a-=l.length)<r?Xi(t,e,zi,o.placeholder,n,s,l,n,n,r-a):Ae(this&&this!==de&&this instanceof o?i:t,this,s)}}(t,e,m):e!=s&&33!=e||f.length?zi.apply(n,_):function(t,e,n,r){var i=1&e,o=Fi(t);return function e(){for(var a=-1,s=arguments.length,u=-1,c=r.length,l=G(c+s),h=this&&this!==de&&this instanceof e?o:t;++u<c;)l[u]=r[u];for(;s--;)l[u++]=arguments[++a];return Ae(h,i?n:this,l)}}(t,e,i,h);else var w=function(t,e,n){var r=1&e,i=Fi(t);return function e(){return(this&&this!==de&&this instanceof e?i:t).apply(r?n:this,arguments)}}(t,e,i);return Io((b?ti:Po)(w,_),t,e)}function Ji(t,e,r,i){return t===n||Ua(t,Lt[r])&&!Nt.call(i,r)?e:t}function Qi(t,e,r,i,o,a){return es(t)&&es(e)&&(a.set(e,t),Vr(t,e,n,Qi,a),a.delete(e)),t}function to(t){return os(t)?n:t}function eo(t,e,r,i,o,a){var s=1&r,u=t.length,c=e.length;if(u!=c&&!(s&&c>u))return!1;var l=a.get(t),h=a.get(e);if(l&&h)return l==e&&h==t;var f=-1,p=!0,d=2&r?new qn:n;for(a.set(t,e),a.set(e,t);++f<u;){var m=t[f],v=e[f];if(i)var g=s?i(v,m,f,e,t,a):i(m,v,f,t,e,a);if(g!==n){if(g)continue;p=!1;break}if(d){if(!je(e,(function(t,e){if(!tn(d,e)&&(m===t||o(m,t,r,i,a)))return d.push(e)}))){p=!1;break}}else if(m!==v&&!o(m,v,r,i,a)){p=!1;break}}return a.delete(t),a.delete(e),p}function no(t){return Ro(To(t,n,Yo),t+"")}function ro(t){return Mr(t,Ls,fo)}function io(t){return Mr(t,Rs,po)}var oo=kn?function(t){return kn.get(t)}:cu;function ao(t){for(var e=t.name+"",n=Pn[e],r=Nt.call(Pn,e)?n.length:0;r--;){var i=n[r],o=i.func;if(null==o||o==t)return i.name}return e}function so(t){return(Nt.call(zn,"placeholder")?zn:t).placeholder}function uo(){var t=zn.iteratee||ou;return t=t===ou?Nr:t,arguments.length?t(arguments[0],arguments[1]):t}function co(t,e){var n,r,i=t.__data__;return("string"==(r=typeof(n=e))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof e?"string":"hash"]:i.map}function lo(t){for(var e=Ls(t),n=e.length;n--;){var r=e[n],i=t[r];e[n]=[r,i,Eo(i)]}return e}function ho(t,e){var r=function(t,e){return null==t?n:t[e]}(t,e);return Ir(r)?r:n}var fo=ve?function(t){return null==t?[]:(t=At(t),Pe(ve(t),(function(e){return qt.call(t,e)})))}:vu,po=ve?function(t){for(var e=[];t;)Ne(e,fo(t)),t=Yt(t);return e}:vu,mo=Er;function vo(t,e,n){for(var r=-1,i=(e=xi(e,t)).length,o=!1;++r<i;){var a=jo(e[r]);if(!(o=null!=t&&n(t,a)))break;t=t[a]}return o||++r!=i?o:!!(i=null==t?0:t.length)&&ts(i)&&xo(a,i)&&(Ha(t)||Wa(t))}function go(t){return"function"!=typeof t.constructor||Mo(t)?{}:Un(Yt(t))}function yo(t){return Ha(t)||Wa(t)||!!($t&&t&&t[$t])}function xo(t,e){var n=typeof t;return!!(e=null==e?f:e)&&("number"==n||"symbol"!=n&&xt.test(t))&&t>-1&&t%1==0&&t<e}function bo(t,e,n){if(!es(n))return!1;var r=typeof e;return!!("number"==r?Xa(n)&&xo(e,n.length):"string"==r&&e in n)&&Ua(n[e],t)}function _o(t,e){if(Ha(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!cs(t))||(et.test(t)||!tt.test(t)||null!=e&&t in At(e))}function wo(t){var e=ao(t),n=zn[e];if("function"!=typeof n||!(e in Wn.prototype))return!1;if(t===n)return!0;var r=oo(n);return!!r&&t===r[0]}(Mn&&mo(new Mn(new ArrayBuffer(1)))!=R||En&&mo(new En)!=S||An&&mo(An.resolve())!=A||Tn&&mo(new Tn)!=C||Cn&&mo(new Cn)!=P)&&(mo=function(t){var e=Er(t),r=e==E?t.constructor:n,i=r?Bo(r):"";if(i)switch(i){case Ln:return R;case Rn:return S;case In:return A;case Nn:return C;case Dn:return P}return e});var So=Rt?Ja:gu;function Mo(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||Lt)}function Eo(t){return t==t&&!es(t)}function Ao(t,e){return function(r){return null!=r&&(r[t]===e&&(e!==n||t in At(r)))}}function To(t,e,r){return e=yn(e===n?t.length-1:e,0),function(){for(var n=arguments,i=-1,o=yn(n.length-e,0),a=G(o);++i<o;)a[i]=n[e+i];i=-1;for(var s=G(e+1);++i<e;)s[i]=n[i];return s[e]=r(a),Ae(t,this,s)}}function Co(t,e){return e.length<2?t:Sr(t,ri(e,0,-1))}function Oo(t,e){for(var r=t.length,i=xn(e.length,r),o=Oi(t);i--;){var a=e[i];t[i]=xo(a,r)?o[a]:n}return t}function ko(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}var Po=No(ti),Lo=fe||function(t,e){return de.setTimeout(t,e)},Ro=No(ei);function Io(t,e,n){var r=e+"";return Ro(t,function(t,e){var n=e.length;if(!n)return t;var r=n-1;return e[r]=(n>1?"& ":"")+e[r],e=e.join(n>2?", ":" "),t.replace(st,"{\n/* [wrapped with "+e+"] */\n")}(r,function(t,e){return Ce(m,(function(n){var r="_."+n[0];e&n[1]&&!Le(t,r)&&t.push(r)})),t.sort()}(function(t){var e=t.match(ut);return e?e[1].split(ct):[]}(r),n)))}function No(t){var e=0,r=0;return function(){var i=bn(),o=16-(i-r);if(r=i,o>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(n,arguments)}}function Do(t,e){var r=-1,i=t.length,o=i-1;for(e=e===n?i:e;++r<e;){var a=qr(r,o),s=t[a];t[a]=t[r],t[r]=s}return t.length=e,t}var Fo=function(t){var e=Na(t,(function(t){return 500===n.size&&n.clear(),t})),n=e.cache;return e}((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(nt,(function(t,n,r,i){e.push(r?i.replace(ft,"$1"):n||t)})),e}));function jo(t){if("string"==typeof t||cs(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function Bo(t){if(null!=t){try{return It.call(t)}catch(e){}try{return t+""}catch(e){}}return""}function zo(t){if(t instanceof Wn)return t.clone();var e=new Gn(t.__wrapped__,t.__chain__);return e.__actions__=Oi(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}var Uo=$r((function(t,e){return qa(t)?hr(t,gr(e,1,qa,!0)):[]})),Vo=$r((function(t,e){var r=Ko(e);return qa(r)&&(r=n),qa(t)?hr(t,gr(e,1,qa,!0),uo(r,2)):[]})),Go=$r((function(t,e){var r=Ko(e);return qa(r)&&(r=n),qa(t)?hr(t,gr(e,1,qa,!0),n,r):[]}));function Wo(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=null==n?0:ms(n);return i<0&&(i=yn(r+i,0)),Ue(t,uo(e,3),i)}function Ho(t,e,r){var i=null==t?0:t.length;if(!i)return-1;var o=i-1;return r!==n&&(o=ms(r),o=r<0?yn(i+o,0):xn(o,i-1)),Ue(t,uo(e,3),o,!0)}function Yo(t){return(null==t?0:t.length)?gr(t,1):[]}function Xo(t){return t&&t.length?t[0]:n}var qo=$r((function(t){var e=Ie(t,gi);return e.length&&e[0]===t[0]?Or(e):[]})),Zo=$r((function(t){var e=Ko(t),r=Ie(t,gi);return e===Ko(r)?e=n:r.pop(),r.length&&r[0]===t[0]?Or(r,uo(e,2)):[]})),$o=$r((function(t){var e=Ko(t),r=Ie(t,gi);return(e="function"==typeof e?e:n)&&r.pop(),r.length&&r[0]===t[0]?Or(r,n,e):[]}));function Ko(t){var e=null==t?0:t.length;return e?t[e-1]:n}var Jo=$r(Qo);function Qo(t,e){return t&&t.length&&e&&e.length?Yr(t,e):t}var ta=no((function(t,e){var n=null==t?0:t.length,r=ar(t,e);return Xr(t,Ie(e,(function(t){return xo(t,n)?+t:t})).sort(Ai)),r}));function ea(t){return null==t?t:Sn.call(t)}var na=$r((function(t){return li(gr(t,1,qa,!0))})),ra=$r((function(t){var e=Ko(t);return qa(e)&&(e=n),li(gr(t,1,qa,!0),uo(e,2))})),ia=$r((function(t){var e=Ko(t);return e="function"==typeof e?e:n,li(gr(t,1,qa,!0),n,e)}));function oa(t){if(!t||!t.length)return[];var e=0;return t=Pe(t,(function(t){if(qa(t))return e=yn(t.length,e),!0})),$e(e,(function(e){return Ie(t,Ye(e))}))}function aa(t,e){if(!t||!t.length)return[];var r=oa(t);return null==e?r:Ie(r,(function(t){return Ae(e,n,t)}))}var sa=$r((function(t,e){return qa(t)?hr(t,e):[]})),ua=$r((function(t){return mi(Pe(t,qa))})),ca=$r((function(t){var e=Ko(t);return qa(e)&&(e=n),mi(Pe(t,qa),uo(e,2))})),la=$r((function(t){var e=Ko(t);return e="function"==typeof e?e:n,mi(Pe(t,qa),n,e)})),ha=$r(oa);var fa=$r((function(t){var e=t.length,r=e>1?t[e-1]:n;return r="function"==typeof r?(t.pop(),r):n,aa(t,r)}));function pa(t){var e=zn(t);return e.__chain__=!0,e}function da(t,e){return e(t)}var ma=no((function(t){var e=t.length,r=e?t[0]:0,i=this.__wrapped__,o=function(e){return ar(e,t)};return!(e>1||this.__actions__.length)&&i instanceof Wn&&xo(r)?((i=i.slice(r,+r+(e?1:0))).__actions__.push({func:da,args:[o],thisArg:n}),new Gn(i,this.__chain__).thru((function(t){return e&&!t.length&&t.push(n),t}))):this.thru(o)}));var va=Pi((function(t,e,n){Nt.call(t,n)?++t[n]:or(t,n,1)}));var ga=ji(Wo),ya=ji(Ho);function xa(t,e){return(Ha(t)?Ce:fr)(t,uo(e,3))}function ba(t,e){return(Ha(t)?Oe:pr)(t,uo(e,3))}var _a=Pi((function(t,e,n){Nt.call(t,n)?t[n].push(e):or(t,n,[e])}));var wa=$r((function(t,e,n){var r=-1,i="function"==typeof e,o=Xa(t)?G(t.length):[];return fr(t,(function(t){o[++r]=i?Ae(e,t,n):kr(t,e,n)})),o})),Sa=Pi((function(t,e,n){or(t,n,e)}));function Ma(t,e){return(Ha(t)?Ie:Br)(t,uo(e,3))}var Ea=Pi((function(t,e,n){t[n?0:1].push(e)}),(function(){return[[],[]]}));var Aa=$r((function(t,e){if(null==t)return[];var n=e.length;return n>1&&bo(t,e[0],e[1])?e=[]:n>2&&bo(e[0],e[1],e[2])&&(e=[e[0]]),Wr(t,gr(e,1),[])})),Ta=ce||function(){return de.Date.now()};function Ca(t,e,r){return e=r?n:e,e=t&&null==e?t.length:e,Ki(t,c,n,n,n,n,e)}function Oa(t,e){var i;if("function"!=typeof e)throw new Ot(r);return t=ms(t),function(){return--t>0&&(i=e.apply(this,arguments)),t<=1&&(e=n),i}}var ka=$r((function(t,e,n){var r=1;if(n.length){var i=hn(n,so(ka));r|=s}return Ki(t,r,e,n,i)})),Pa=$r((function(t,e,n){var r=3;if(n.length){var i=hn(n,so(Pa));r|=s}return Ki(e,r,t,n,i)}));function La(t,e,i){var o,a,s,u,c,l,h=0,f=!1,p=!1,d=!0;if("function"!=typeof t)throw new Ot(r);function m(e){var r=o,i=a;return o=a=n,h=e,u=t.apply(i,r)}function v(t){return h=t,c=Lo(y,e),f?m(t):u}function g(t){var r=t-l;return l===n||r>=e||r<0||p&&t-h>=s}function y(){var t=Ta();if(g(t))return x(t);c=Lo(y,function(t){var n=e-(t-l);return p?xn(n,s-(t-h)):n}(t))}function x(t){return c=n,d&&o?m(t):(o=a=n,u)}function b(){var t=Ta(),r=g(t);if(o=arguments,a=this,l=t,r){if(c===n)return v(l);if(p)return wi(c),c=Lo(y,e),m(l)}return c===n&&(c=Lo(y,e)),u}return e=gs(e)||0,es(i)&&(f=!!i.leading,s=(p="maxWait"in i)?yn(gs(i.maxWait)||0,e):s,d="trailing"in i?!!i.trailing:d),b.cancel=function(){c!==n&&wi(c),h=0,o=l=a=c=n},b.flush=function(){return c===n?u:x(Ta())},b}var Ra=$r((function(t,e){return lr(t,1,e)})),Ia=$r((function(t,e,n){return lr(t,gs(e)||0,n)}));function Na(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new Ot(r);var n=function(){var r=arguments,i=e?e.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var a=t.apply(this,r);return n.cache=o.set(i,a)||o,a};return n.cache=new(Na.Cache||Xn),n}function Da(t){if("function"!=typeof t)throw new Ot(r);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}Na.Cache=Xn;var Fa=bi((function(t,e){var n=(e=1==e.length&&Ha(e[0])?Ie(e[0],Je(uo())):Ie(gr(e,1),Je(uo()))).length;return $r((function(r){for(var i=-1,o=xn(r.length,n);++i<o;)r[i]=e[i].call(this,r[i]);return Ae(t,this,r)}))})),ja=$r((function(t,e){var r=hn(e,so(ja));return Ki(t,s,n,e,r)})),Ba=$r((function(t,e){var r=hn(e,so(Ba));return Ki(t,u,n,e,r)})),za=no((function(t,e){return Ki(t,l,n,n,n,e)}));function Ua(t,e){return t===e||t!=t&&e!=e}var Va=Yi(Ar),Ga=Yi((function(t,e){return t>=e})),Wa=Pr(function(){return arguments}())?Pr:function(t){return ns(t)&&Nt.call(t,"callee")&&!qt.call(t,"callee")},Ha=G.isArray,Ya=be?Je(be):function(t){return ns(t)&&Er(t)==L};function Xa(t){return null!=t&&ts(t.length)&&!Ja(t)}function qa(t){return ns(t)&&Xa(t)}var Za=ye||gu,$a=_e?Je(_e):function(t){return ns(t)&&Er(t)==x};function Ka(t){if(!ns(t))return!1;var e=Er(t);return e==b||"[object DOMException]"==e||"string"==typeof t.message&&"string"==typeof t.name&&!os(t)}function Ja(t){if(!es(t))return!1;var e=Er(t);return e==_||e==w||"[object AsyncFunction]"==e||"[object Proxy]"==e}function Qa(t){return"number"==typeof t&&t==ms(t)}function ts(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=f}function es(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function ns(t){return null!=t&&"object"==typeof t}var rs=we?Je(we):function(t){return ns(t)&&mo(t)==S};function is(t){return"number"==typeof t||ns(t)&&Er(t)==M}function os(t){if(!ns(t)||Er(t)!=E)return!1;var e=Yt(t);if(null===e)return!0;var n=Nt.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&It.call(n)==Bt}var as=Se?Je(Se):function(t){return ns(t)&&Er(t)==T};var ss=Me?Je(Me):function(t){return ns(t)&&mo(t)==C};function us(t){return"string"==typeof t||!Ha(t)&&ns(t)&&Er(t)==O}function cs(t){return"symbol"==typeof t||ns(t)&&Er(t)==k}var ls=Ee?Je(Ee):function(t){return ns(t)&&ts(t.length)&&!!se[Er(t)]};var hs=Yi(jr),fs=Yi((function(t,e){return t<=e}));function ps(t){if(!t)return[];if(Xa(t))return us(t)?dn(t):Oi(t);if(Kt&&t[Kt])return function(t){for(var e,n=[];!(e=t.next()).done;)n.push(e.value);return n}(t[Kt]());var e=mo(t);return(e==S?cn:e==C?fn:Us)(t)}function ds(t){return t?(t=gs(t))===h||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0}function ms(t){var e=ds(t),n=e%1;return e==e?n?e-n:e:0}function vs(t){return t?sr(ms(t),0,d):0}function gs(t){if("number"==typeof t)return t;if(cs(t))return p;if(es(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=es(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=Ke(t);var n=vt.test(t);return n||yt.test(t)?he(t.slice(2),n?2:8):mt.test(t)?p:+t}function ys(t){return ki(t,Rs(t))}function xs(t){return null==t?"":ci(t)}var bs=Li((function(t,e){if(Mo(e)||Xa(e))ki(e,Ls(e),t);else for(var n in e)Nt.call(e,n)&&er(t,n,e[n])})),_s=Li((function(t,e){ki(e,Rs(e),t)})),ws=Li((function(t,e,n,r){ki(e,Rs(e),t,r)})),Ss=Li((function(t,e,n,r){ki(e,Ls(e),t,r)})),Ms=no(ar);var Es=$r((function(t,e){t=At(t);var r=-1,i=e.length,o=i>2?e[2]:n;for(o&&bo(e[0],e[1],o)&&(i=1);++r<i;)for(var a=e[r],s=Rs(a),u=-1,c=s.length;++u<c;){var l=s[u],h=t[l];(h===n||Ua(h,Lt[l])&&!Nt.call(t,l))&&(t[l]=a[l])}return t})),As=$r((function(t){return t.push(n,Qi),Ae(Ns,n,t)}));function Ts(t,e,r){var i=null==t?n:Sr(t,e);return i===n?r:i}function Cs(t,e){return null!=t&&vo(t,e,Cr)}var Os=Ui((function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=jt.call(e)),t[e]=n}),eu(iu)),ks=Ui((function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=jt.call(e)),Nt.call(t,e)?t[e].push(n):t[e]=[n]}),uo),Ps=$r(kr);function Ls(t){return Xa(t)?$n(t):Dr(t)}function Rs(t){return Xa(t)?$n(t,!0):Fr(t)}var Is=Li((function(t,e,n){Vr(t,e,n)})),Ns=Li((function(t,e,n,r){Vr(t,e,n,r)})),Ds=no((function(t,e){var n={};if(null==t)return n;var r=!1;e=Ie(e,(function(e){return e=xi(e,t),r||(r=e.length>1),e})),ki(t,io(t),n),r&&(n=ur(n,7,to));for(var i=e.length;i--;)hi(n,e[i]);return n}));var Fs=no((function(t,e){return null==t?{}:function(t,e){return Hr(t,e,(function(e,n){return Cs(t,n)}))}(t,e)}));function js(t,e){if(null==t)return{};var n=Ie(io(t),(function(t){return[t]}));return e=uo(e),Hr(t,n,(function(t,n){return e(t,n[0])}))}var Bs=$i(Ls),zs=$i(Rs);function Us(t){return null==t?[]:Qe(t,Ls(t))}var Vs=Di((function(t,e,n){return e=e.toLowerCase(),t+(n?Gs(e):e)}));function Gs(t){return Ks(xs(t).toLowerCase())}function Ws(t){return(t=xs(t))&&t.replace(bt,on).replace(te,"")}var Hs=Di((function(t,e,n){return t+(n?"-":"")+e.toLowerCase()})),Ys=Di((function(t,e,n){return t+(n?" ":"")+e.toLowerCase()})),Xs=Ni("toLowerCase");var qs=Di((function(t,e,n){return t+(n?"_":"")+e.toLowerCase()}));var Zs=Di((function(t,e,n){return t+(n?" ":"")+Ks(e)}));var $s=Di((function(t,e,n){return t+(n?" ":"")+e.toUpperCase()})),Ks=Ni("toUpperCase");function Js(t,e,r){return t=xs(t),(e=r?n:e)===n?function(t){return ie.test(t)}(t)?function(t){return t.match(ne)||[]}(t):function(t){return t.match(lt)||[]}(t):t.match(e)||[]}var Qs=$r((function(t,e){try{return Ae(t,n,e)}catch(r){return Ka(r)?r:new St(r)}})),tu=no((function(t,e){return Ce(e,(function(e){e=jo(e),or(t,e,ka(t[e],t))})),t}));function eu(t){return function(){return t}}var nu=Bi(),ru=Bi(!0);function iu(t){return t}function ou(t){return Nr("function"==typeof t?t:ur(t,1))}var au=$r((function(t,e){return function(n){return kr(n,t,e)}})),su=$r((function(t,e){return function(n){return kr(t,n,e)}}));function uu(t,e,n){var r=Ls(e),i=wr(e,r);null!=n||es(e)&&(i.length||!r.length)||(n=e,e=t,t=this,i=wr(e,Ls(e)));var o=!(es(n)&&"chain"in n&&!n.chain),a=Ja(t);return Ce(i,(function(n){var r=e[n];t[n]=r,a&&(t.prototype[n]=function(){var e=this.__chain__;if(o||e){var n=t(this.__wrapped__),i=n.__actions__=Oi(this.__actions__);return i.push({func:r,args:arguments,thisArg:t}),n.__chain__=e,n}return r.apply(t,Ne([this.value()],arguments))})})),t}function cu(){}var lu=Gi(Ie),hu=Gi(ke),fu=Gi(je);function pu(t){return _o(t)?Ye(jo(t)):function(t){return function(e){return Sr(e,t)}}(t)}var du=Hi(),mu=Hi(!0);function vu(){return[]}function gu(){return!1}var yu=Vi((function(t,e){return t+e}),0),xu=qi("ceil"),bu=Vi((function(t,e){return t/e}),1),_u=qi("floor");var wu,Su=Vi((function(t,e){return t*e}),1),Mu=qi("round"),Eu=Vi((function(t,e){return t-e}),0);return zn.after=function(t,e){if("function"!=typeof e)throw new Ot(r);return t=ms(t),function(){if(--t<1)return e.apply(this,arguments)}},zn.ary=Ca,zn.assign=bs,zn.assignIn=_s,zn.assignInWith=ws,zn.assignWith=Ss,zn.at=Ms,zn.before=Oa,zn.bind=ka,zn.bindAll=tu,zn.bindKey=Pa,zn.castArray=function(){if(!arguments.length)return[];var t=arguments[0];return Ha(t)?t:[t]},zn.chain=pa,zn.chunk=function(t,e,r){e=(r?bo(t,e,r):e===n)?1:yn(ms(e),0);var i=null==t?0:t.length;if(!i||e<1)return[];for(var o=0,a=0,s=G(pe(i/e));o<i;)s[a++]=ri(t,o,o+=e);return s},zn.compact=function(t){for(var e=-1,n=null==t?0:t.length,r=0,i=[];++e<n;){var o=t[e];o&&(i[r++]=o)}return i},zn.concat=function(){var t=arguments.length;if(!t)return[];for(var e=G(t-1),n=arguments[0],r=t;r--;)e[r-1]=arguments[r];return Ne(Ha(n)?Oi(n):[n],gr(e,1))},zn.cond=function(t){var e=null==t?0:t.length,n=uo();return t=e?Ie(t,(function(t){if("function"!=typeof t[1])throw new Ot(r);return[n(t[0]),t[1]]})):[],$r((function(n){for(var r=-1;++r<e;){var i=t[r];if(Ae(i[0],this,n))return Ae(i[1],this,n)}}))},zn.conforms=function(t){return function(t){var e=Ls(t);return function(n){return cr(n,t,e)}}(ur(t,1))},zn.constant=eu,zn.countBy=va,zn.create=function(t,e){var n=Un(t);return null==e?n:ir(n,e)},zn.curry=function t(e,r,i){var o=Ki(e,8,n,n,n,n,n,r=i?n:r);return o.placeholder=t.placeholder,o},zn.curryRight=function t(e,r,i){var o=Ki(e,a,n,n,n,n,n,r=i?n:r);return o.placeholder=t.placeholder,o},zn.debounce=La,zn.defaults=Es,zn.defaultsDeep=As,zn.defer=Ra,zn.delay=Ia,zn.difference=Uo,zn.differenceBy=Vo,zn.differenceWith=Go,zn.drop=function(t,e,r){var i=null==t?0:t.length;return i?ri(t,(e=r||e===n?1:ms(e))<0?0:e,i):[]},zn.dropRight=function(t,e,r){var i=null==t?0:t.length;return i?ri(t,0,(e=i-(e=r||e===n?1:ms(e)))<0?0:e):[]},zn.dropRightWhile=function(t,e){return t&&t.length?pi(t,uo(e,3),!0,!0):[]},zn.dropWhile=function(t,e){return t&&t.length?pi(t,uo(e,3),!0):[]},zn.fill=function(t,e,r,i){var o=null==t?0:t.length;return o?(r&&"number"!=typeof r&&bo(t,e,r)&&(r=0,i=o),function(t,e,r,i){var o=t.length;for((r=ms(r))<0&&(r=-r>o?0:o+r),(i=i===n||i>o?o:ms(i))<0&&(i+=o),i=r>i?0:vs(i);r<i;)t[r++]=e;return t}(t,e,r,i)):[]},zn.filter=function(t,e){return(Ha(t)?Pe:vr)(t,uo(e,3))},zn.flatMap=function(t,e){return gr(Ma(t,e),1)},zn.flatMapDeep=function(t,e){return gr(Ma(t,e),h)},zn.flatMapDepth=function(t,e,r){return r=r===n?1:ms(r),gr(Ma(t,e),r)},zn.flatten=Yo,zn.flattenDeep=function(t){return(null==t?0:t.length)?gr(t,h):[]},zn.flattenDepth=function(t,e){return(null==t?0:t.length)?gr(t,e=e===n?1:ms(e)):[]},zn.flip=function(t){return Ki(t,512)},zn.flow=nu,zn.flowRight=ru,zn.fromPairs=function(t){for(var e=-1,n=null==t?0:t.length,r={};++e<n;){var i=t[e];r[i[0]]=i[1]}return r},zn.functions=function(t){return null==t?[]:wr(t,Ls(t))},zn.functionsIn=function(t){return null==t?[]:wr(t,Rs(t))},zn.groupBy=_a,zn.initial=function(t){return(null==t?0:t.length)?ri(t,0,-1):[]},zn.intersection=qo,zn.intersectionBy=Zo,zn.intersectionWith=$o,zn.invert=Os,zn.invertBy=ks,zn.invokeMap=wa,zn.iteratee=ou,zn.keyBy=Sa,zn.keys=Ls,zn.keysIn=Rs,zn.map=Ma,zn.mapKeys=function(t,e){var n={};return e=uo(e,3),br(t,(function(t,r,i){or(n,e(t,r,i),t)})),n},zn.mapValues=function(t,e){var n={};return e=uo(e,3),br(t,(function(t,r,i){or(n,r,e(t,r,i))})),n},zn.matches=function(t){return zr(ur(t,1))},zn.matchesProperty=function(t,e){return Ur(t,ur(e,1))},zn.memoize=Na,zn.merge=Is,zn.mergeWith=Ns,zn.method=au,zn.methodOf=su,zn.mixin=uu,zn.negate=Da,zn.nthArg=function(t){return t=ms(t),$r((function(e){return Gr(e,t)}))},zn.omit=Ds,zn.omitBy=function(t,e){return js(t,Da(uo(e)))},zn.once=function(t){return Oa(2,t)},zn.orderBy=function(t,e,r,i){return null==t?[]:(Ha(e)||(e=null==e?[]:[e]),Ha(r=i?n:r)||(r=null==r?[]:[r]),Wr(t,e,r))},zn.over=lu,zn.overArgs=Fa,zn.overEvery=hu,zn.overSome=fu,zn.partial=ja,zn.partialRight=Ba,zn.partition=Ea,zn.pick=Fs,zn.pickBy=js,zn.property=pu,zn.propertyOf=function(t){return function(e){return null==t?n:Sr(t,e)}},zn.pull=Jo,zn.pullAll=Qo,zn.pullAllBy=function(t,e,n){return t&&t.length&&e&&e.length?Yr(t,e,uo(n,2)):t},zn.pullAllWith=function(t,e,r){return t&&t.length&&e&&e.length?Yr(t,e,n,r):t},zn.pullAt=ta,zn.range=du,zn.rangeRight=mu,zn.rearg=za,zn.reject=function(t,e){return(Ha(t)?Pe:vr)(t,Da(uo(e,3)))},zn.remove=function(t,e){var n=[];if(!t||!t.length)return n;var r=-1,i=[],o=t.length;for(e=uo(e,3);++r<o;){var a=t[r];e(a,r,t)&&(n.push(a),i.push(r))}return Xr(t,i),n},zn.rest=function(t,e){if("function"!=typeof t)throw new Ot(r);return $r(t,e=e===n?e:ms(e))},zn.reverse=ea,zn.sampleSize=function(t,e,r){return e=(r?bo(t,e,r):e===n)?1:ms(e),(Ha(t)?Jn:Jr)(t,e)},zn.set=function(t,e,n){return null==t?t:Qr(t,e,n)},zn.setWith=function(t,e,r,i){return i="function"==typeof i?i:n,null==t?t:Qr(t,e,r,i)},zn.shuffle=function(t){return(Ha(t)?Qn:ni)(t)},zn.slice=function(t,e,r){var i=null==t?0:t.length;return i?(r&&"number"!=typeof r&&bo(t,e,r)?(e=0,r=i):(e=null==e?0:ms(e),r=r===n?i:ms(r)),ri(t,e,r)):[]},zn.sortBy=Aa,zn.sortedUniq=function(t){return t&&t.length?si(t):[]},zn.sortedUniqBy=function(t,e){return t&&t.length?si(t,uo(e,2)):[]},zn.split=function(t,e,r){return r&&"number"!=typeof r&&bo(t,e,r)&&(e=r=n),(r=r===n?d:r>>>0)?(t=xs(t))&&("string"==typeof e||null!=e&&!as(e))&&!(e=ci(e))&&un(t)?_i(dn(t),0,r):t.split(e,r):[]},zn.spread=function(t,e){if("function"!=typeof t)throw new Ot(r);return e=null==e?0:yn(ms(e),0),$r((function(n){var r=n[e],i=_i(n,0,e);return r&&Ne(i,r),Ae(t,this,i)}))},zn.tail=function(t){var e=null==t?0:t.length;return e?ri(t,1,e):[]},zn.take=function(t,e,r){return t&&t.length?ri(t,0,(e=r||e===n?1:ms(e))<0?0:e):[]},zn.takeRight=function(t,e,r){var i=null==t?0:t.length;return i?ri(t,(e=i-(e=r||e===n?1:ms(e)))<0?0:e,i):[]},zn.takeRightWhile=function(t,e){return t&&t.length?pi(t,uo(e,3),!1,!0):[]},zn.takeWhile=function(t,e){return t&&t.length?pi(t,uo(e,3)):[]},zn.tap=function(t,e){return e(t),t},zn.throttle=function(t,e,n){var i=!0,o=!0;if("function"!=typeof t)throw new Ot(r);return es(n)&&(i="leading"in n?!!n.leading:i,o="trailing"in n?!!n.trailing:o),La(t,e,{leading:i,maxWait:e,trailing:o})},zn.thru=da,zn.toArray=ps,zn.toPairs=Bs,zn.toPairsIn=zs,zn.toPath=function(t){return Ha(t)?Ie(t,jo):cs(t)?[t]:Oi(Fo(xs(t)))},zn.toPlainObject=ys,zn.transform=function(t,e,n){var r=Ha(t),i=r||Za(t)||ls(t);if(e=uo(e,4),null==n){var o=t&&t.constructor;n=i?r?new o:[]:es(t)&&Ja(o)?Un(Yt(t)):{}}return(i?Ce:br)(t,(function(t,r,i){return e(n,t,r,i)})),n},zn.unary=function(t){return Ca(t,1)},zn.union=na,zn.unionBy=ra,zn.unionWith=ia,zn.uniq=function(t){return t&&t.length?li(t):[]},zn.uniqBy=function(t,e){return t&&t.length?li(t,uo(e,2)):[]},zn.uniqWith=function(t,e){return e="function"==typeof e?e:n,t&&t.length?li(t,n,e):[]},zn.unset=function(t,e){return null==t||hi(t,e)},zn.unzip=oa,zn.unzipWith=aa,zn.update=function(t,e,n){return null==t?t:fi(t,e,yi(n))},zn.updateWith=function(t,e,r,i){return i="function"==typeof i?i:n,null==t?t:fi(t,e,yi(r),i)},zn.values=Us,zn.valuesIn=function(t){return null==t?[]:Qe(t,Rs(t))},zn.without=sa,zn.words=Js,zn.wrap=function(t,e){return ja(yi(e),t)},zn.xor=ua,zn.xorBy=ca,zn.xorWith=la,zn.zip=ha,zn.zipObject=function(t,e){return vi(t||[],e||[],er)},zn.zipObjectDeep=function(t,e){return vi(t||[],e||[],Qr)},zn.zipWith=fa,zn.entries=Bs,zn.entriesIn=zs,zn.extend=_s,zn.extendWith=ws,uu(zn,zn),zn.add=yu,zn.attempt=Qs,zn.camelCase=Vs,zn.capitalize=Gs,zn.ceil=xu,zn.clamp=function(t,e,r){return r===n&&(r=e,e=n),r!==n&&(r=(r=gs(r))==r?r:0),e!==n&&(e=(e=gs(e))==e?e:0),sr(gs(t),e,r)},zn.clone=function(t){return ur(t,4)},zn.cloneDeep=function(t){return ur(t,5)},zn.cloneDeepWith=function(t,e){return ur(t,5,e="function"==typeof e?e:n)},zn.cloneWith=function(t,e){return ur(t,4,e="function"==typeof e?e:n)},zn.conformsTo=function(t,e){return null==e||cr(t,e,Ls(e))},zn.deburr=Ws,zn.defaultTo=function(t,e){return null==t||t!=t?e:t},zn.divide=bu,zn.endsWith=function(t,e,r){t=xs(t),e=ci(e);var i=t.length,o=r=r===n?i:sr(ms(r),0,i);return(r-=e.length)>=0&&t.slice(r,o)==e},zn.eq=Ua,zn.escape=function(t){return(t=xs(t))&&$.test(t)?t.replace(q,an):t},zn.escapeRegExp=function(t){return(t=xs(t))&&it.test(t)?t.replace(rt,"\\$&"):t},zn.every=function(t,e,r){var i=Ha(t)?ke:dr;return r&&bo(t,e,r)&&(e=n),i(t,uo(e,3))},zn.find=ga,zn.findIndex=Wo,zn.findKey=function(t,e){return ze(t,uo(e,3),br)},zn.findLast=ya,zn.findLastIndex=Ho,zn.findLastKey=function(t,e){return ze(t,uo(e,3),_r)},zn.floor=_u,zn.forEach=xa,zn.forEachRight=ba,zn.forIn=function(t,e){return null==t?t:yr(t,uo(e,3),Rs)},zn.forInRight=function(t,e){return null==t?t:xr(t,uo(e,3),Rs)},zn.forOwn=function(t,e){return t&&br(t,uo(e,3))},zn.forOwnRight=function(t,e){return t&&_r(t,uo(e,3))},zn.get=Ts,zn.gt=Va,zn.gte=Ga,zn.has=function(t,e){return null!=t&&vo(t,e,Tr)},zn.hasIn=Cs,zn.head=Xo,zn.identity=iu,zn.includes=function(t,e,n,r){t=Xa(t)?t:Us(t),n=n&&!r?ms(n):0;var i=t.length;return n<0&&(n=yn(i+n,0)),us(t)?n<=i&&t.indexOf(e,n)>-1:!!i&&Ve(t,e,n)>-1},zn.indexOf=function(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=null==n?0:ms(n);return i<0&&(i=yn(r+i,0)),Ve(t,e,i)},zn.inRange=function(t,e,r){return e=ds(e),r===n?(r=e,e=0):r=ds(r),function(t,e,n){return t>=xn(e,n)&&t<yn(e,n)}(t=gs(t),e,r)},zn.invoke=Ps,zn.isArguments=Wa,zn.isArray=Ha,zn.isArrayBuffer=Ya,zn.isArrayLike=Xa,zn.isArrayLikeObject=qa,zn.isBoolean=function(t){return!0===t||!1===t||ns(t)&&Er(t)==y},zn.isBuffer=Za,zn.isDate=$a,zn.isElement=function(t){return ns(t)&&1===t.nodeType&&!os(t)},zn.isEmpty=function(t){if(null==t)return!0;if(Xa(t)&&(Ha(t)||"string"==typeof t||"function"==typeof t.splice||Za(t)||ls(t)||Wa(t)))return!t.length;var e=mo(t);if(e==S||e==C)return!t.size;if(Mo(t))return!Dr(t).length;for(var n in t)if(Nt.call(t,n))return!1;return!0},zn.isEqual=function(t,e){return Lr(t,e)},zn.isEqualWith=function(t,e,r){var i=(r="function"==typeof r?r:n)?r(t,e):n;return i===n?Lr(t,e,n,r):!!i},zn.isError=Ka,zn.isFinite=function(t){return"number"==typeof t&&xe(t)},zn.isFunction=Ja,zn.isInteger=Qa,zn.isLength=ts,zn.isMap=rs,zn.isMatch=function(t,e){return t===e||Rr(t,e,lo(e))},zn.isMatchWith=function(t,e,r){return r="function"==typeof r?r:n,Rr(t,e,lo(e),r)},zn.isNaN=function(t){return is(t)&&t!=+t},zn.isNative=function(t){if(So(t))throw new St("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Ir(t)},zn.isNil=function(t){return null==t},zn.isNull=function(t){return null===t},zn.isNumber=is,zn.isObject=es,zn.isObjectLike=ns,zn.isPlainObject=os,zn.isRegExp=as,zn.isSafeInteger=function(t){return Qa(t)&&t>=-9007199254740991&&t<=f},zn.isSet=ss,zn.isString=us,zn.isSymbol=cs,zn.isTypedArray=ls,zn.isUndefined=function(t){return t===n},zn.isWeakMap=function(t){return ns(t)&&mo(t)==P},zn.isWeakSet=function(t){return ns(t)&&"[object WeakSet]"==Er(t)},zn.join=function(t,e){return null==t?"":Be.call(t,e)},zn.kebabCase=Hs,zn.last=Ko,zn.lastIndexOf=function(t,e,r){var i=null==t?0:t.length;if(!i)return-1;var o=i;return r!==n&&(o=(o=ms(r))<0?yn(i+o,0):xn(o,i-1)),e==e?function(t,e,n){for(var r=n+1;r--;)if(t[r]===e)return r;return r}(t,e,o):Ue(t,We,o,!0)},zn.lowerCase=Ys,zn.lowerFirst=Xs,zn.lt=hs,zn.lte=fs,zn.max=function(t){return t&&t.length?mr(t,iu,Ar):n},zn.maxBy=function(t,e){return t&&t.length?mr(t,uo(e,2),Ar):n},zn.mean=function(t){return He(t,iu)},zn.meanBy=function(t,e){return He(t,uo(e,2))},zn.min=function(t){return t&&t.length?mr(t,iu,jr):n},zn.minBy=function(t,e){return t&&t.length?mr(t,uo(e,2),jr):n},zn.stubArray=vu,zn.stubFalse=gu,zn.stubObject=function(){return{}},zn.stubString=function(){return""},zn.stubTrue=function(){return!0},zn.multiply=Su,zn.nth=function(t,e){return t&&t.length?Gr(t,ms(e)):n},zn.noConflict=function(){return de._===this&&(de._=zt),this},zn.noop=cu,zn.now=Ta,zn.pad=function(t,e,n){t=xs(t);var r=(e=ms(e))?pn(t):0;if(!e||r>=e)return t;var i=(e-r)/2;return Wi(me(i),n)+t+Wi(pe(i),n)},zn.padEnd=function(t,e,n){t=xs(t);var r=(e=ms(e))?pn(t):0;return e&&r<e?t+Wi(e-r,n):t},zn.padStart=function(t,e,n){t=xs(t);var r=(e=ms(e))?pn(t):0;return e&&r<e?Wi(e-r,n)+t:t},zn.parseInt=function(t,e,n){return n||null==e?e=0:e&&(e=+e),_n(xs(t).replace(ot,""),e||0)},zn.random=function(t,e,r){if(r&&"boolean"!=typeof r&&bo(t,e,r)&&(e=r=n),r===n&&("boolean"==typeof e?(r=e,e=n):"boolean"==typeof t&&(r=t,t=n)),t===n&&e===n?(t=0,e=1):(t=ds(t),e===n?(e=t,t=0):e=ds(e)),t>e){var i=t;t=e,e=i}if(r||t%1||e%1){var o=wn();return xn(t+o*(e-t+le("1e-"+((o+"").length-1))),e)}return qr(t,e)},zn.reduce=function(t,e,n){var r=Ha(t)?De:qe,i=arguments.length<3;return r(t,uo(e,4),n,i,fr)},zn.reduceRight=function(t,e,n){var r=Ha(t)?Fe:qe,i=arguments.length<3;return r(t,uo(e,4),n,i,pr)},zn.repeat=function(t,e,r){return e=(r?bo(t,e,r):e===n)?1:ms(e),Zr(xs(t),e)},zn.replace=function(){var t=arguments,e=xs(t[0]);return t.length<3?e:e.replace(t[1],t[2])},zn.result=function(t,e,r){var i=-1,o=(e=xi(e,t)).length;for(o||(o=1,t=n);++i<o;){var a=null==t?n:t[jo(e[i])];a===n&&(i=o,a=r),t=Ja(a)?a.call(t):a}return t},zn.round=Mu,zn.runInContext=t,zn.sample=function(t){return(Ha(t)?Kn:Kr)(t)},zn.size=function(t){if(null==t)return 0;if(Xa(t))return us(t)?pn(t):t.length;var e=mo(t);return e==S||e==C?t.size:Dr(t).length},zn.snakeCase=qs,zn.some=function(t,e,r){var i=Ha(t)?je:ii;return r&&bo(t,e,r)&&(e=n),i(t,uo(e,3))},zn.sortedIndex=function(t,e){return oi(t,e)},zn.sortedIndexBy=function(t,e,n){return ai(t,e,uo(n,2))},zn.sortedIndexOf=function(t,e){var n=null==t?0:t.length;if(n){var r=oi(t,e);if(r<n&&Ua(t[r],e))return r}return-1},zn.sortedLastIndex=function(t,e){return oi(t,e,!0)},zn.sortedLastIndexBy=function(t,e,n){return ai(t,e,uo(n,2),!0)},zn.sortedLastIndexOf=function(t,e){if(null==t?0:t.length){var n=oi(t,e,!0)-1;if(Ua(t[n],e))return n}return-1},zn.startCase=Zs,zn.startsWith=function(t,e,n){return t=xs(t),n=null==n?0:sr(ms(n),0,t.length),e=ci(e),t.slice(n,n+e.length)==e},zn.subtract=Eu,zn.sum=function(t){return t&&t.length?Ze(t,iu):0},zn.sumBy=function(t,e){return t&&t.length?Ze(t,uo(e,2)):0},zn.template=function(t,e,r){var i=zn.templateSettings;r&&bo(t,e,r)&&(e=n),t=xs(t),e=ws({},e,i,Ji);var o,a,s=ws({},e.imports,i.imports,Ji),u=Ls(s),c=Qe(s,u),l=0,h=e.interpolate||_t,f="__p += '",p=Tt((e.escape||_t).source+"|"+h.source+"|"+(h===Q?pt:_t).source+"|"+(e.evaluate||_t).source+"|$","g"),d="//# sourceURL="+(Nt.call(e,"sourceURL")?(e.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++ae+"]")+"\n";t.replace(p,(function(e,n,r,i,s,u){return r||(r=i),f+=t.slice(l,u).replace(wt,sn),n&&(o=!0,f+="' +\n__e("+n+") +\n'"),s&&(a=!0,f+="';\n"+s+";\n__p += '"),r&&(f+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),l=u+e.length,e})),f+="';\n";var m=Nt.call(e,"variable")&&e.variable;if(m){if(ht.test(m))throw new St("Invalid `variable` option passed into `_.template`")}else f="with (obj) {\n"+f+"\n}\n";f=(a?f.replace(W,""):f).replace(H,"$1").replace(Y,"$1;"),f="function("+(m||"obj")+") {\n"+(m?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(a?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+f+"return __p\n}";var v=Qs((function(){return Mt(u,d+"return "+f).apply(n,c)}));if(v.source=f,Ka(v))throw v;return v},zn.times=function(t,e){if((t=ms(t))<1||t>f)return[];var n=d,r=xn(t,d);e=uo(e),t-=d;for(var i=$e(r,e);++n<t;)e(n);return i},zn.toFinite=ds,zn.toInteger=ms,zn.toLength=vs,zn.toLower=function(t){return xs(t).toLowerCase()},zn.toNumber=gs,zn.toSafeInteger=function(t){return t?sr(ms(t),-9007199254740991,f):0===t?t:0},zn.toString=xs,zn.toUpper=function(t){return xs(t).toUpperCase()},zn.trim=function(t,e,r){if((t=xs(t))&&(r||e===n))return Ke(t);if(!t||!(e=ci(e)))return t;var i=dn(t),o=dn(e);return _i(i,en(i,o),nn(i,o)+1).join("")},zn.trimEnd=function(t,e,r){if((t=xs(t))&&(r||e===n))return t.slice(0,mn(t)+1);if(!t||!(e=ci(e)))return t;var i=dn(t);return _i(i,0,nn(i,dn(e))+1).join("")},zn.trimStart=function(t,e,r){if((t=xs(t))&&(r||e===n))return t.replace(ot,"");if(!t||!(e=ci(e)))return t;var i=dn(t);return _i(i,en(i,dn(e))).join("")},zn.truncate=function(t,e){var r=30,i="...";if(es(e)){var o="separator"in e?e.separator:o;r="length"in e?ms(e.length):r,i="omission"in e?ci(e.omission):i}var a=(t=xs(t)).length;if(un(t)){var s=dn(t);a=s.length}if(r>=a)return t;var u=r-pn(i);if(u<1)return i;var c=s?_i(s,0,u).join(""):t.slice(0,u);if(o===n)return c+i;if(s&&(u+=c.length-u),as(o)){if(t.slice(u).search(o)){var l,h=c;for(o.global||(o=Tt(o.source,xs(dt.exec(o))+"g")),o.lastIndex=0;l=o.exec(h);)var f=l.index;c=c.slice(0,f===n?u:f)}}else if(t.indexOf(ci(o),u)!=u){var p=c.lastIndexOf(o);p>-1&&(c=c.slice(0,p))}return c+i},zn.unescape=function(t){return(t=xs(t))&&Z.test(t)?t.replace(X,vn):t},zn.uniqueId=function(t){var e=++Dt;return xs(t)+e},zn.upperCase=$s,zn.upperFirst=Ks,zn.each=xa,zn.eachRight=ba,zn.first=Xo,uu(zn,(wu={},br(zn,(function(t,e){Nt.call(zn.prototype,e)||(wu[e]=t)})),wu),{chain:!1}),zn.VERSION="4.17.21",Ce(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(t){zn[t].placeholder=zn})),Ce(["drop","take"],(function(t,e){Wn.prototype[t]=function(r){r=r===n?1:yn(ms(r),0);var i=this.__filtered__&&!e?new Wn(this):this.clone();return i.__filtered__?i.__takeCount__=xn(r,i.__takeCount__):i.__views__.push({size:xn(r,d),type:t+(i.__dir__<0?"Right":"")}),i},Wn.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}})),Ce(["filter","map","takeWhile"],(function(t,e){var n=e+1,r=1==n||3==n;Wn.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:uo(t,3),type:n}),e.__filtered__=e.__filtered__||r,e}})),Ce(["head","last"],(function(t,e){var n="take"+(e?"Right":"");Wn.prototype[t]=function(){return this[n](1).value()[0]}})),Ce(["initial","tail"],(function(t,e){var n="drop"+(e?"":"Right");Wn.prototype[t]=function(){return this.__filtered__?new Wn(this):this[n](1)}})),Wn.prototype.compact=function(){return this.filter(iu)},Wn.prototype.find=function(t){return this.filter(t).head()},Wn.prototype.findLast=function(t){return this.reverse().find(t)},Wn.prototype.invokeMap=$r((function(t,e){return"function"==typeof t?new Wn(this):this.map((function(n){return kr(n,t,e)}))})),Wn.prototype.reject=function(t){return this.filter(Da(uo(t)))},Wn.prototype.slice=function(t,e){t=ms(t);var r=this;return r.__filtered__&&(t>0||e<0)?new Wn(r):(t<0?r=r.takeRight(-t):t&&(r=r.drop(t)),e!==n&&(r=(e=ms(e))<0?r.dropRight(-e):r.take(e-t)),r)},Wn.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},Wn.prototype.toArray=function(){return this.take(d)},br(Wn.prototype,(function(t,e){var r=/^(?:filter|find|map|reject)|While$/.test(e),i=/^(?:head|last)$/.test(e),o=zn[i?"take"+("last"==e?"Right":""):e],a=i||/^find/.test(e);o&&(zn.prototype[e]=function(){var e=this.__wrapped__,s=i?[1]:arguments,u=e instanceof Wn,c=s[0],l=u||Ha(e),h=function(t){var e=o.apply(zn,Ne([t],s));return i&&f?e[0]:e};l&&r&&"function"==typeof c&&1!=c.length&&(u=l=!1);var f=this.__chain__,p=!!this.__actions__.length,d=a&&!f,m=u&&!p;if(!a&&l){e=m?e:new Wn(this);var v=t.apply(e,s);return v.__actions__.push({func:da,args:[h],thisArg:n}),new Gn(v,f)}return d&&m?t.apply(this,s):(v=this.thru(h),d?i?v.value()[0]:v.value():v)})})),Ce(["pop","push","shift","sort","splice","unshift"],(function(t){var e=kt[t],n=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",r=/^(?:pop|shift)$/.test(t);zn.prototype[t]=function(){var t=arguments;if(r&&!this.__chain__){var i=this.value();return e.apply(Ha(i)?i:[],t)}return this[n]((function(n){return e.apply(Ha(n)?n:[],t)}))}})),br(Wn.prototype,(function(t,e){var n=zn[e];if(n){var r=n.name+"";Nt.call(Pn,r)||(Pn[r]=[]),Pn[r].push({name:e,func:n})}})),Pn[zi(n,2).name]=[{name:"wrapper",func:n}],Wn.prototype.clone=function(){var t=new Wn(this.__wrapped__);return t.__actions__=Oi(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=Oi(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=Oi(this.__views__),t},Wn.prototype.reverse=function(){if(this.__filtered__){var t=new Wn(this);t.__dir__=-1,t.__filtered__=!0}else(t=this.clone()).__dir__*=-1;return t},Wn.prototype.value=function(){var t=this.__wrapped__.value(),e=this.__dir__,n=Ha(t),r=e<0,i=n?t.length:0,o=function(t,e,n){var r=-1,i=n.length;for(;++r<i;){var o=n[r],a=o.size;switch(o.type){case"drop":t+=a;break;case"dropRight":e-=a;break;case"take":e=xn(e,t+a);break;case"takeRight":t=yn(t,e-a)}}return{start:t,end:e}}(0,i,this.__views__),a=o.start,s=o.end,u=s-a,c=r?s:a-1,l=this.__iteratees__,h=l.length,f=0,p=xn(u,this.__takeCount__);if(!n||!r&&i==u&&p==u)return di(t,this.__actions__);var d=[];t:for(;u--&&f<p;){for(var m=-1,v=t[c+=e];++m<h;){var g=l[m],y=g.iteratee,x=g.type,b=y(v);if(2==x)v=b;else if(!b){if(1==x)continue t;break t}}d[f++]=v}return d},zn.prototype.at=ma,zn.prototype.chain=function(){return pa(this)},zn.prototype.commit=function(){return new Gn(this.value(),this.__chain__)},zn.prototype.next=function(){this.__values__===n&&(this.__values__=ps(this.value()));var t=this.__index__>=this.__values__.length;return{done:t,value:t?n:this.__values__[this.__index__++]}},zn.prototype.plant=function(t){for(var e,r=this;r instanceof Vn;){var i=zo(r);i.__index__=0,i.__values__=n,e?o.__wrapped__=i:e=i;var o=i;r=r.__wrapped__}return o.__wrapped__=t,e},zn.prototype.reverse=function(){var t=this.__wrapped__;if(t instanceof Wn){var e=t;return this.__actions__.length&&(e=new Wn(this)),(e=e.reverse()).__actions__.push({func:da,args:[ea],thisArg:n}),new Gn(e,this.__chain__)}return this.thru(ea)},zn.prototype.toJSON=zn.prototype.valueOf=zn.prototype.value=function(){return di(this.__wrapped__,this.__actions__)},zn.prototype.first=zn.prototype.head,Kt&&(zn.prototype[Kt]=function(){return this}),zn}();ve?((ve.exports=gn)._=gn,me._=gn):de._=gn}).call(G)}({get exports(){return hZ},set exports(t){hZ=t}},hZ);var fZ="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function pZ(t){this.message=t}function dZ(t){for(var e,n,r,i,o="",a=0,s=(t=String(t)).length%3;a<t.length;){if((n=t.charCodeAt(a++))>255||(r=t.charCodeAt(a++))>255||(i=t.charCodeAt(a++))>255)throw new TypeError("Failed to execute 'btoa' on 'Window': The string to be encoded contains characters outside of the Latin1 range.");o+=fZ.charAt((e=n<<16|r<<8|i)>>18&63)+fZ.charAt(e>>12&63)+fZ.charAt(e>>6&63)+fZ.charAt(63&e)}return s?o.slice(0,s-3)+"===".substring(s):o}function mZ(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function vZ(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Zq(r.key),r)}}function gZ(t,e,n){return e&&vZ(t.prototype,e),n&&vZ(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}pZ.prototype=new Error,pZ.prototype.name="InvalidCharacterError";var yZ,xZ=function(){function t(e,n){mZ(this,t),this.buffers=e,this.type=n}return gZ(t,[{key:"arraybuffer",value:function(){return Promise.resolve(this.buffers[0])}},{key:"stream",value:function(){throw new Error("not implemented")}},{key:"text",value:function(){throw new Error("not implemented")}},{key:"slice",value:function(t,e,n){throw new Error("not implemented")}}]),t}();yZ="undefined"==typeof window?{devicePixelRatio:1,navigator:{userAgent:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.69 Safari/537.36",browserLanguage:"zh-CN",language:"zh-CN",platform:""},location:"",document:{documentElement:{style:{}},createEvent:function(){return!0},getElementById:function(t){return!0},createElement:function(){return{className:"",classList:{add:function(){return""}}}},createElementNS:function(){return!0},addEventListener:function(){return!0},removeEventListener:function(){return!0},querySelector:function(){return!1}},performance:{mark:function(t){return null},clearMeasures:function(t){return null},clearMarks:function(t){return null},measure:function(t,e,n){return{duration:0}},now:function(){return(new Date).getTime()}},Blob:"",dispatchEvent:function(t){return!0},Event:function(t,e){return!0},createElement:function(){return!0},createElementNS:function(){return!0},XMLHttpRequest:function(){return!0},addEventListener:function(){return!0},removeEventListener:function(){return!0},requestAnimationFrame:function(){return!0},cancelAnimationFrame:function(){return!0},clearTimeout:function(){return!0}}:window;const bZ="undefined"!=typeof my&&!!my&&"function"==typeof my.showToast&&!0!==my.isFRM?my.getSystemInfoSync().pixelRatio:yZ.devicePixelRatio;function _Z(t,e){return(_Z=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function wZ(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_Z(t,e)}function SZ(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function MZ(t,e){if(e&&("object"===qq(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return SZ(t)}function EZ(t){return(EZ=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var AZ=gZ((function t(e,n){mZ(this,t),this.cancelBubble=!1,this.cancelable=!1,this.target=null,this.currentTarget=null,this.preventDefault=function(){},this.stopPropagation=function(){},this.type=e,this.timeStamp=Date.now()}));function TZ(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return CZ(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return CZ(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function CZ(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var OZ=new WeakMap,kZ=function(){function t(){mZ(this,t),OZ.set(this,{})}return gZ(t,[{key:"addEventListener",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=OZ.get(this);r||(r={}),r[t]||(r[t]=[]),r[t].push(e),OZ.set(this,r),n.capture,n.once,n.passive}},{key:"removeEventListener",value:function(t,e){var n=OZ.get(this);if(n){var r=n[t];if(r&&r.length>0)for(var i=r.length;i--;i>0)if(r[i]===e){r.splice(i,1);break}}}},{key:"dispatchEvent",value:function(t){var e=OZ.get(this)[t.type];if(e){var n,r=TZ(e);try{for(r.s();!(n=r.n()).done;){(0,n.value)(t)}}catch(i){r.e(i)}finally{r.f()}}}}]),t}();function PZ(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var LZ=function(t){wZ(n,kZ);var e=PZ(n);function n(){var t;return mZ(this,n),(t=e.call(this)).childNodes=[],t}return gZ(n,[{key:"appendChild",value:function(t){this.childNodes.push(t)}},{key:"cloneNode",value:function(){var t=Object.create(this);return Object.assign(t,this),t}},{key:"removeChild",value:function(t){var e=this.childNodes.findIndex((function(e){return e===t}));return e>-1?this.childNodes.splice(e,1):null}}]),n}();function RZ(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var IZ,NZ,DZ,FZ,jZ=function(t){wZ(n,LZ);var e=RZ(n);function n(){var t;return mZ(this,n),(t=e.call(this)).className="",t.children=[],t}return gZ(n,[{key:"setAttribute",value:function(t,e){this[t]=e}},{key:"getAttribute",value:function(t){return this[t]}},{key:"setAttributeNS",value:function(t,e){this[t]=e}},{key:"getAttributeNS",value:function(t){return this[t]}}]),n}();if("undefined"!=typeof my&&!!my&&"function"==typeof my.showToast&&!0!==my.isFRM){var BZ=my.getSystemInfoSync();IZ=BZ.screenWidth,NZ=BZ.screenHeight,DZ=BZ.windowWidth,FZ=BZ.windowHeight}else{var zZ=yZ.innerWidth,UZ=yZ.innerHeight;IZ=zZ,NZ=UZ,DZ=zZ,FZ=UZ}var VZ={width:IZ,height:NZ,availWidth:DZ,availHeight:FZ,availLeft:0,availTop:0},GZ=VZ.availWidth,WZ=VZ.availHeight,HZ={style:[]};function YZ(t,e){var n,r;"parentNode"in t||(n=0===e?function(){return null}:1===e?function(){return HZ}:function(){return null},Object.defineProperty(t,"parentNode",{enumerable:!0,get:n}));"parentElement"in t||(r=0===e?function(){return null}:1===e?function(){return HZ}:function(){return null},Object.defineProperty(t,"parentElement",{enumerable:!0,get:r}))}function XZ(t){t.style=t.style||{},Object.assign(t.style,{top:"0px",left:"0px",width:GZ+"px",height:WZ+"px",margin:"0px",padding:"0px"})}function qZ(t){"clientLeft"in t||(t.clientLeft=0,t.clientTop=0),"clientWidth"in t||(t.clientWidth=GZ,t.clientHeight=WZ),"getBoundingClientRect"in t||(t.getBoundingClientRect=function(){return{x:0,y:0,top:0,left:0,width:this.clientWidth,height:this.clientHeight,right:this.clientWidth,bottom:this.clientHeight}})}function ZZ(t){"offsetLeft"in t||(t.offsetLeft=0,t.offsetTop=0),"offsetWidth"in t||(t.offsetWidth=GZ,t.offsetHeight=WZ)}function $Z(t){"scrollLeft"in t||(t.scrollLeft=0,t.scrollTop=0),"scrollWidth"in t||(t.scrollWidth=GZ,t.scrollHeight=WZ)}function KZ(t){var e=function(){return!0};t.classList=[],t.classList.add=e,t.classList.remove=e,t.classList.contains=e,t.classList.toggle=e}function JZ(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}function QZ(){}var t$=function(t){wZ(n,jZ);var e=JZ(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",i=arguments.length>1?arguments[1]:void 0;return mZ(this,n),(t=e.call(this)).className="",t.children=[],t.focus=QZ,t.blur=QZ,t.insertBefore=QZ,t.appendChild=QZ,t.removeChild=QZ,t.remove=QZ,t.innerHTML="",t.tagName=r.toUpperCase(),YZ(SZ(t),i),XZ(SZ(t)),KZ(SZ(t)),qZ(SZ(t)),ZZ(SZ(t)),$Z(SZ(t)),t}return gZ(n)}();function e$(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var n$=function(t){wZ(n,t$);var e=e$(n);function n(t){return mZ(this,n),e.call(this,t)}return gZ(n,[{key:"addTextTrack",value:function(){}},{key:"captureStream",value:function(){}},{key:"fastSeek",value:function(){}},{key:"load",value:function(){}},{key:"pause",value:function(){}},{key:"play",value:function(){}}]),n}();function r$(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var i$=function(t){wZ(n,n$);var e=r$(n);function n(){return mZ(this,n),e.call(this,"video")}return gZ(n)}(),o$={};function a$(){return o$}var s$=gZ((function t(){mZ(this,t);var e=a$(),n=e.createImage&&e.createImage()||{};return"tagName"in n||(n.tagName="IMG",n.__proto__=t.prototype),YZ(n),KZ(n),Object.assign(n,{addEventListener:function(t,e){n["on".concat(t)]=e.bind(n)},removeEventListener:function(t){n["on".concat(t)]=null}}),n})),u$={href:"",protocol:"",host:""};function c$(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var l$=function(t){wZ(n,t$);var e=c$(n);function n(){return mZ(this,n),e.call(this,"body",0)}return gZ(n,[{key:"addEventListener",value:function(t,e){}},{key:"removeEventListener",value:function(t,e,n){}},{key:"dispatchEvent",value:function(t){}}]),n}(),h$=function(t){wZ(n,t$);var e=c$(n);function n(){return mZ(this,n),e.call(this,"html",0)}return gZ(n,[{key:"addEventListener",value:function(t,e){}},{key:"removeEventListener",value:function(t,e){}},{key:"dispatchEvent",value:function(t){}}]),n}(),f$={},p$={readyState:"complete",visibilityState:"visible",hidden:!1,fullscreen:!0,scripts:[],style:{},location:u$,ontouchstart:null,ontouchmove:null,ontouchend:null,onvisibilitychange:null,parentNode:null,parentElement:null,head:null,body:null,documentElement:{style:[]},createElement:function(t){return"canvas"===(t=t.toLowerCase())?my.createOffscreenCanvas(1024,128,"2d"):"img"===t?new s$:"video"===t?new i$:new t$(t)},createElementNS:function(t,e){return this.createElement(e)},createTextNode:function(t){return t},getElementById:function(t){return null},getElementsByTagName:function(t){return t=t.toLowerCase(),[]},getElementsByTagNameNS:function(t,e){return this.getElementsByTagName(e)},getElementsByName:function(t){return[]},querySelector:function(t){return null},querySelectorAll:function(t){return[]},addEventListener:function(t,e,n){f$[t]||(f$[t]=[]),f$[t].push(e)},removeEventListener:function(t,e){var n=f$[t];if(n&&n.length>0)for(var r=n.length;r--;r>0)if(n[r]===e){n.splice(r,1);break}},dispatchEvent:function(t){var e=t.type,n=f$[e];if(n)for(var r=0;r<n.length;r++)n[r](t);t.target&&"function"==typeof t.target["on"+e]&&t.target["on"+e](t)},createEvent:function(t){return new AZ(t)}};p$.documentElement=new h$,p$.head=new t$("head"),p$.body=new l$;var d$,m$,v$,g$,y$=Object,x$=function(){function t(){mZ(this,t);var e=arguments.length;if(2===e){if("number"==typeof arguments[0]&&"number"==typeof arguments[1])return this._w=arguments[0],this._h=arguments[1],void(this._data=new Uint8ClampedArray(this._w*this._h*4))}else 3===e&&"object"===qq(arguments[0])&&"number"==typeof arguments[1]&&"number"==typeof arguments[2]&&(this._data=arguments[0],this._w=arguments[1],this._h=arguments[2]);throw new Error("ImageData: params error")}return gZ(t,[{key:"width",get:function(){return this._w}},{key:"height",get:function(){return this._h}},{key:"data",get:function(){return this._data}}]),t}();if("undefined"!=typeof my&&!!my&&"function"==typeof my.showToast&&!0!==my.isFRM){var b$=my.getSystemInfoSync();d$=b$.system,m$=b$.platform,v$=b$.language}else{var _$={versions:(g$=yZ.navigator.userAgent,{trident:g$.indexOf("Trident")>-1,presto:g$.indexOf("Presto")>-1,webKit:g$.indexOf("AppleWebKit")>-1,gecko:g$.indexOf("Gecko")>-1&&-1===g$.indexOf("KHTML"),mobile:!!g$.match(/AppleWebKit.*Mobile.*/),ios:!!g$.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:g$.indexOf("Android")>-1||g$.indexOf("Linux")>-1,iPhone:g$.indexOf("iPhone")>-1,iPad:g$.indexOf("iPad")>-1,webApp:-1===g$.indexOf("Safari"),weixin:g$.indexOf("MicroMessenger")>-1,qq:" qq"===g$.match(/\sQQ/i)}),language:(yZ.navigator.browserLanguage||yZ.navigator.language).toLowerCase()};_$.versions.android?m$="android":_$.versions.trident?m$="IE":_$.versions.presto?m$="Opera":_$.versions.webKit?m$="webKit":_$.versions.gecko?m$="Firefox":_$.versions.mobile?m$="mobile":_$.versions.ios?m$="ios":_$.versions.iPhone?m$="iPhone":_$.versions.iPad?m$="ipad":_$.versions.webApp?m$="webApp":_$.versions.weixin?m$="weixin":_$.versions.qq&&(m$="qq"),d$=yZ.navigator.userAgent,v$=_$.language}var w$=-1!==d$.toLowerCase().indexOf("android")?"Android; CPU Android 6.0":"iPhone; CPU iPhone OS 10_3_1 like Mac OS X",S$="Mozilla/5.0 (".concat(w$,") AppleWebKit/603.1.30 (KHTML, like Gecko) Mobile/14E8301 MicroMessenger/6.6.0 MiniGame NetType/WIFI Language/").concat(v$),M$={platform:m$,language:v$,appVersion:"5.0 (".concat(w$,") AppleWebKit/601.1.46 (KHTML, like Gecko) Version/9.0 Mobile/13B143 Safari/601.1"),userAgent:S$},E$=0;var A$=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";mZ(this,t),0!=e.indexOf("http://")&&0!=e.indexOf("https://")?this.href=n+e:this.href=e}return gZ(t,null,[{key:"createObjectURL",value:function(t){var e=t.buffers[0],n=t.type,r=function(t){for(var e="",n=new Uint8Array(t),r=n.byteLength,i=0;i<r;i++)e+=String.fromCharCode(n[i]);return dZ(e)}(e);return"data:".concat(n,";base64, ")+r}}]),t}();function T$(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var C$=new Map,O$=new Map,k$=new Map,P$=function(t){wZ(n,kZ);var e=T$(n);function n(){var t;return mZ(this,n),(t=e.call(this)).onabort=null,t.onerror=null,t.onload=null,t.onloadstart=null,t.onprogress=null,t.ontimeout=null,t.onloadend=null,t.onreadystatechange=null,t.readyState=0,t.response=null,t.responseText=null,t._responseType="text",t.responseXML=null,t.status=0,t.statusText="",t.upload={},t.withCredentials=!1,C$.set("requestHeader",{"content-type":"application/x-www-form-urlencoded"}),t}return gZ(n,[{key:"responseType",set:function(t){this._responseType=t}},{key:"abort",value:function(){var t=k$.get("requestTask");t&&t.abort()}},{key:"getAllResponseHeaders",value:function(){var t=O$.get("responseHeader");return Object.keys(t).map((function(e){return"".concat(e,": ").concat(t[e])})).join("\n")}},{key:"getResponseHeader",value:function(t){return O$.get("responseHeader")[t]}},{key:"open",value:function(t,e,n){this._method=t,this._url=e}},{key:"overrideMimeType",value:function(){}},{key:"send",value:function(){}},{key:"setRequestHeader",value:function(t,e){var n=C$.get("requestHeader");n[t]=e,C$.set("requestHeader",n)}},{key:"addEventListener",value:function(t,e){var n=this;"function"==typeof e&&(this["on"+t]=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.target=t.target||n,e.call(n,t)})}},{key:"removeEventListener",value:function(t,e){this["on"+t]===e&&(this["on"+t]=null)}}]),n}();P$.UNSEND=0,P$.OPENED=1,P$.HEADERS_RECEIVED=2,P$.LOADING=3,P$.DONE=4;var L$=!1;var R$="undefined"!=typeof my&&!!my&&"function"==typeof my.showToast&&!0!==my.isFRM,I$="undefined"!=typeof wx&&null!==wx&&(void 0!==wx.request||void 0!==wx.miniProgram),N$=(R$||I$)&&L$,D$={atob:function(t){var e=String(t).replace(/=+$/,"");if(e.length%4==1)throw new pZ("'atob' failed: The string to be decoded is not correctly encoded.");for(var n,r,i="",o=0,a=0;r=e.charAt(a++);~r&&(n=o%4?64*n+r:r,o++%4)?i+=String.fromCharCode(255&n>>(-2*o&6)):0)r=fZ.indexOf(r);return i},btoa:dZ,devicePixelRatio:bZ,Blob:xZ,document:p$,Element:jZ,Event:AZ,EventTarget:kZ,HTMLCanvasElement:y$,HTMLElement:t$,HTMLMediaElement:n$,HTMLVideoElement:i$,Image:s$,ImageData:x$,navigator:M$,Node:LZ,requestAnimationFrame:function(t){var e=a$();return e.requestAnimationFrame?e.requestAnimationFrame(t):function(t){var e=Date.now(),n=Math.max(E$+23,e);return setTimeout((function(){t(E$=n)}),n-e)}(t)},cancelAnimationFrame:function(t){var e=a$();return e.cancelAnimationFrame?e.cancelAnimationFrame(t):clearTimeout(t)},screen:VZ,XMLHttpRequest:P$,performance:{mark:function(t){return null},clearMeasures:function(t){return null},clearMarks:function(t){return null},measure:function(t,e,n){return{duration:0}},now:function(){}},URL:A$,WebGLRenderingContext:{GCCSO_SHADER_BINARY_FJ:37472,_3DC_XY_AMD:34810,_3DC_X_AMD:34809,ACTIVE_ATTRIBUTES:35721,ACTIVE_ATTRIBUTE_MAX_LENGTH:35722,ACTIVE_PROGRAM_EXT:33369,ACTIVE_TEXTURE:34016,ACTIVE_UNIFORMS:35718,ACTIVE_UNIFORM_MAX_LENGTH:35719,ALIASED_LINE_WIDTH_RANGE:33902,ALIASED_POINT_SIZE_RANGE:33901,ALL_COMPLETED_NV:34034,ALL_SHADER_BITS_EXT:4294967295,ALPHA:6406,ALPHA16F_EXT:34844,ALPHA32F_EXT:34838,ALPHA8_EXT:32828,ALPHA8_OES:32828,ALPHA_BITS:3413,ALPHA_TEST_FUNC_QCOM:3009,ALPHA_TEST_QCOM:3008,ALPHA_TEST_REF_QCOM:3010,ALREADY_SIGNALED_APPLE:37146,ALWAYS:519,AMD_compressed_3DC_texture:1,AMD_compressed_ATC_texture:1,AMD_performance_monitor:1,AMD_program_binary_Z400:1,ANGLE_depth_texture:1,ANGLE_framebuffer_blit:1,ANGLE_framebuffer_multisample:1,ANGLE_instanced_arrays:1,ANGLE_pack_reverse_row_order:1,ANGLE_program_binary:1,ANGLE_texture_compression_dxt3:1,ANGLE_texture_compression_dxt5:1,ANGLE_texture_usage:1,ANGLE_translated_shader_source:1,ANY_SAMPLES_PASSED_CONSERVATIVE_EXT:36202,ANY_SAMPLES_PASSED_EXT:35887,APPLE_copy_texture_levels:1,APPLE_framebuffer_multisample:1,APPLE_rgb_422:1,APPLE_sync:1,APPLE_texture_format_BGRA8888:1,APPLE_texture_max_level:1,ARM_mali_program_binary:1,ARM_mali_shader_binary:1,ARM_rgba8:1,ARRAY_BUFFER:34962,ARRAY_BUFFER_BINDING:34964,ATC_RGBA_EXPLICIT_ALPHA_AMD:35987,ATC_RGBA_INTERPOLATED_ALPHA_AMD:34798,ATC_RGB_AMD:35986,ATTACHED_SHADERS:35717,BACK:1029,BGRA8_EXT:37793,BGRA_EXT:32993,BGRA_IMG:32993,BINNING_CONTROL_HINT_QCOM:36784,BLEND:3042,BLEND_COLOR:32773,BLEND_DST_ALPHA:32970,BLEND_DST_RGB:32968,BLEND_EQUATION:32777,BLEND_EQUATION_ALPHA:34877,BLEND_EQUATION_RGB:32777,BLEND_SRC_ALPHA:32971,BLEND_SRC_RGB:32969,BLUE_BITS:3412,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,BUFFER:33504,BUFFER_ACCESS_OES:35003,BUFFER_MAPPED_OES:35004,BUFFER_MAP_POINTER_OES:35005,BUFFER_OBJECT_EXT:37201,BUFFER_SIZE:34660,BUFFER_USAGE:34661,BYTE:5120,CCW:2305,CLAMP_TO_BORDER_NV:33069,CLAMP_TO_EDGE:33071,COLOR_ATTACHMENT0:36064,COLOR_ATTACHMENT0_NV:36064,COLOR_ATTACHMENT10_NV:36074,COLOR_ATTACHMENT11_NV:36075,COLOR_ATTACHMENT12_NV:36076,COLOR_ATTACHMENT13_NV:36077,COLOR_ATTACHMENT14_NV:36078,COLOR_ATTACHMENT15_NV:36079,COLOR_ATTACHMENT1_NV:36065,COLOR_ATTACHMENT2_NV:36066,COLOR_ATTACHMENT3_NV:36067,COLOR_ATTACHMENT4_NV:36068,COLOR_ATTACHMENT5_NV:36069,COLOR_ATTACHMENT6_NV:36070,COLOR_ATTACHMENT7_NV:36071,COLOR_ATTACHMENT8_NV:36072,COLOR_ATTACHMENT9_NV:36073,COLOR_ATTACHMENT_EXT:37104,COLOR_BUFFER_BIT:16384,COLOR_BUFFER_BIT0_QCOM:1,COLOR_BUFFER_BIT1_QCOM:2,COLOR_BUFFER_BIT2_QCOM:4,COLOR_BUFFER_BIT3_QCOM:8,COLOR_BUFFER_BIT4_QCOM:16,COLOR_BUFFER_BIT5_QCOM:32,COLOR_BUFFER_BIT6_QCOM:64,COLOR_BUFFER_BIT7_QCOM:128,COLOR_CLEAR_VALUE:3106,COLOR_EXT:6144,COLOR_WRITEMASK:3107,COMPARE_REF_TO_TEXTURE_EXT:34894,COMPILE_STATUS:35713,COMPRESSED_RGBA_ASTC_10x10_KHR:37819,COMPRESSED_RGBA_ASTC_10x5_KHR:37816,COMPRESSED_RGBA_ASTC_10x6_KHR:37817,COMPRESSED_RGBA_ASTC_10x8_KHR:37818,COMPRESSED_RGBA_ASTC_12x10_KHR:37820,COMPRESSED_RGBA_ASTC_12x12_KHR:37821,COMPRESSED_RGBA_ASTC_4x4_KHR:37808,COMPRESSED_RGBA_ASTC_5x4_KHR:37809,COMPRESSED_RGBA_ASTC_5x5_KHR:37810,COMPRESSED_RGBA_ASTC_6x5_KHR:37811,COMPRESSED_RGBA_ASTC_6x6_KHR:37812,COMPRESSED_RGBA_ASTC_8x5_KHR:37813,COMPRESSED_RGBA_ASTC_8x6_KHR:37814,COMPRESSED_RGBA_ASTC_8x8_KHR:37815,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGBA_PVRTC_2BPPV2_IMG:37175,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGBA_PVRTC_4BPPV2_IMG:37176,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_ANGLE:33778,COMPRESSED_RGBA_S3TC_DXT5_ANGLE:33779,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:37851,COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:37848,COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:37849,COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:37850,COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:37852,COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:37853,COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:37840,COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:37841,COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:37842,COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:37843,COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:37844,COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:37845,COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:37846,COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:37847,COMPRESSED_SRGB_ALPHA_S3TC_DXT1_NV:35917,COMPRESSED_SRGB_ALPHA_S3TC_DXT3_NV:35918,COMPRESSED_SRGB_ALPHA_S3TC_DXT5_NV:35919,COMPRESSED_SRGB_S3TC_DXT1_NV:35916,COMPRESSED_TEXTURE_FORMATS:34467,CONDITION_SATISFIED_APPLE:37148,CONSTANT_ALPHA:32771,CONSTANT_COLOR:32769,CONTEXT_FLAG_DEBUG_BIT:2,CONTEXT_ROBUST_ACCESS_EXT:37107,COUNTER_RANGE_AMD:35777,COUNTER_TYPE_AMD:35776,COVERAGE_ALL_FRAGMENTS_NV:36565,COVERAGE_ATTACHMENT_NV:36562,COVERAGE_AUTOMATIC_NV:36567,COVERAGE_BUFFERS_NV:36563,COVERAGE_BUFFER_BIT_NV:32768,COVERAGE_COMPONENT4_NV:36561,COVERAGE_COMPONENT_NV:36560,COVERAGE_EDGE_FRAGMENTS_NV:36566,COVERAGE_SAMPLES_NV:36564,CPU_OPTIMIZED_QCOM:36785,CULL_FACE:2884,CULL_FACE_MODE:2885,CURRENT_PROGRAM:35725,CURRENT_QUERY_EXT:34917,CURRENT_VERTEX_ATTRIB:34342,CW:2304,DEBUG_CALLBACK_FUNCTION:33348,DEBUG_CALLBACK_USER_PARAM:33349,DEBUG_GROUP_STACK_DEPTH:33389,DEBUG_LOGGED_MESSAGES:37189,DEBUG_NEXT_LOGGED_MESSAGE_LENGTH:33347,DEBUG_OUTPUT:37600,DEBUG_OUTPUT_SYNCHRONOUS:33346,DEBUG_SEVERITY_HIGH:37190,DEBUG_SEVERITY_LOW:37192,DEBUG_SEVERITY_MEDIUM:37191,DEBUG_SEVERITY_NOTIFICATION:33387,DEBUG_SOURCE_API:33350,DEBUG_SOURCE_APPLICATION:33354,DEBUG_SOURCE_OTHER:33355,DEBUG_SOURCE_SHADER_COMPILER:33352,DEBUG_SOURCE_THIRD_PARTY:33353,DEBUG_SOURCE_WINDOW_SYSTEM:33351,DEBUG_TYPE_DEPRECATED_BEHAVIOR:33357,DEBUG_TYPE_ERROR:33356,DEBUG_TYPE_MARKER:33384,DEBUG_TYPE_OTHER:33361,DEBUG_TYPE_PERFORMANCE:33360,DEBUG_TYPE_POP_GROUP:33386,DEBUG_TYPE_PORTABILITY:33359,DEBUG_TYPE_PUSH_GROUP:33385,DEBUG_TYPE_UNDEFINED_BEHAVIOR:33358,DECR:7683,DECR_WRAP:34056,DELETE_STATUS:35712,DEPTH24_STENCIL8_OES:35056,DEPTH_ATTACHMENT:36096,DEPTH_STENCIL_ATTACHMENT:33306,DEPTH_BITS:3414,DEPTH_BUFFER_BIT:256,DEPTH_BUFFER_BIT0_QCOM:256,DEPTH_BUFFER_BIT1_QCOM:512,DEPTH_BUFFER_BIT2_QCOM:1024,DEPTH_BUFFER_BIT3_QCOM:2048,DEPTH_BUFFER_BIT4_QCOM:4096,DEPTH_BUFFER_BIT5_QCOM:8192,DEPTH_BUFFER_BIT6_QCOM:16384,DEPTH_BUFFER_BIT7_QCOM:32768,DEPTH_CLEAR_VALUE:2931,DEPTH_COMPONENT:6402,DEPTH_COMPONENT16:33189,DEPTH_COMPONENT16_NONLINEAR_NV:36396,DEPTH_COMPONENT16_OES:33189,DEPTH_COMPONENT24_OES:33190,DEPTH_COMPONENT32_OES:33191,DEPTH_EXT:6145,DEPTH_FUNC:2932,DEPTH_RANGE:2928,DEPTH_STENCIL:34041,DEPTH_STENCIL_OES:34041,DEPTH_TEST:2929,DEPTH_WRITEMASK:2930,DITHER:3024,DMP_shader_binary:1,DONT_CARE:4352,DRAW_BUFFER0_NV:34853,DRAW_BUFFER10_NV:34863,DRAW_BUFFER11_NV:34864,DRAW_BUFFER12_NV:34865,DRAW_BUFFER13_NV:34866,DRAW_BUFFER14_NV:34867,DRAW_BUFFER15_NV:34868,DRAW_BUFFER1_NV:34854,DRAW_BUFFER2_NV:34855,DRAW_BUFFER3_NV:34856,DRAW_BUFFER4_NV:34857,DRAW_BUFFER5_NV:34858,DRAW_BUFFER6_NV:34859,DRAW_BUFFER7_NV:34860,DRAW_BUFFER8_NV:34861,DRAW_BUFFER9_NV:34862,DRAW_BUFFER_EXT:3073,DRAW_FRAMEBUFFER_ANGLE:36009,DRAW_FRAMEBUFFER_APPLE:36009,DRAW_FRAMEBUFFER_BINDING_ANGLE:36006,DRAW_FRAMEBUFFER_BINDING_APPLE:36006,DRAW_FRAMEBUFFER_BINDING_NV:36006,DRAW_FRAMEBUFFER_NV:36009,DST_ALPHA:772,DST_COLOR:774,DYNAMIC_DRAW:35048,ELEMENT_ARRAY_BUFFER:34963,ELEMENT_ARRAY_BUFFER_BINDING:34965,EQUAL:514,ES_VERSION_2_0:1,ETC1_RGB8_OES:36196,ETC1_SRGB8_NV:35054,EXTENSIONS:7939,EXT_blend_minmax:1,EXT_color_buffer_half_float:1,EXT_debug_label:1,EXT_debug_marker:1,EXT_discard_framebuffer:1,EXT_map_buffer_range:1,EXT_multi_draw_arrays:1,EXT_multisampled_render_to_texture:1,EXT_multiview_draw_buffers:1,EXT_occlusion_query_boolean:1,EXT_read_format_bgra:1,EXT_robustness:1,EXT_sRGB:1,EXT_separate_shader_objects:1,EXT_shader_framebuffer_fetch:1,EXT_shader_texture_lod:1,EXT_shadow_samplers:1,EXT_texture_compression_dxt1:1,EXT_texture_filter_anisotropic:1,EXT_texture_format_BGRA8888:1,EXT_texture_rg:1,EXT_texture_storage:1,EXT_texture_type_2_10_10_10_REV:1,EXT_unpack_subimage:1,FALSE:0,FASTEST:4353,FENCE_CONDITION_NV:34036,FENCE_STATUS_NV:34035,FIXED:5132,FJ_shader_binary_GCCSO:1,FLOAT:5126,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,FRAGMENT_SHADER:35632,FRAGMENT_SHADER_BIT_EXT:2,FRAGMENT_SHADER_DERIVATIVE_HINT_OES:35723,FRAGMENT_SHADER_DISCARDS_SAMPLES_EXT:35410,FRAMEBUFFER:36160,FRAMEBUFFER_ATTACHMENT_ANGLE:37795,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING_EXT:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT:33297,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_TEXTURE_3D_ZOFFSET_OES:36052,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_SAMPLES_EXT:36204,FRAMEBUFFER_BINDING:36006,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE_ANGLE:36182,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE_APPLE:36182,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE_EXT:36182,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE_IMG:37172,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE_NV:36182,FRAMEBUFFER_UNDEFINED_OES:33305,FRAMEBUFFER_UNSUPPORTED:36061,FRONT:1028,FRONT_AND_BACK:1032,FRONT_FACE:2886,FUNC_ADD:32774,FUNC_REVERSE_SUBTRACT:32779,FUNC_SUBTRACT:32778,GENERATE_MIPMAP_HINT:33170,GEQUAL:518,GPU_OPTIMIZED_QCOM:36786,GREATER:516,GREEN_BITS:3411,GUILTY_CONTEXT_RESET_EXT:33363,HALF_FLOAT_OES:36193,HIGH_FLOAT:36338,HIGH_INT:36341,IMG_multisampled_render_to_texture:1,IMG_program_binary:1,IMG_read_format:1,IMG_shader_binary:1,IMG_texture_compression_pvrtc:1,IMG_texture_compression_pvrtc2:1,IMPLEMENTATION_COLOR_READ_FORMAT:35739,IMPLEMENTATION_COLOR_READ_TYPE:35738,INCR:7682,INCR_WRAP:34055,INFO_LOG_LENGTH:35716,INNOCENT_CONTEXT_RESET_EXT:33364,INT:5124,INT_10_10_10_2_OES:36343,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,INVALID_ENUM:1280,INVALID_FRAMEBUFFER_OPERATION:1286,INVALID_OPERATION:1282,INVALID_VALUE:1281,INVERT:5386,KEEP:7680,KHR_debug:1,KHR_texture_compression_astc_ldr:1,LEFT:1030,LEQUAL:515,LESS:513,LINEAR:9729,LINEAR_MIPMAP_LINEAR:9987,LINEAR_MIPMAP_NEAREST:9985,LINES:1,LINE_LOOP:2,LINE_STRIP:3,LINE_WIDTH:2849,LINK_STATUS:35714,LOSE_CONTEXT_ON_RESET_EXT:33362,LOW_FLOAT:36336,LOW_INT:36339,LUMINANCE:6409,LUMINANCE16F_EXT:34846,LUMINANCE32F_EXT:34840,LUMINANCE4_ALPHA4_OES:32835,LUMINANCE8_ALPHA8_EXT:32837,LUMINANCE8_ALPHA8_OES:32837,LUMINANCE8_EXT:32832,LUMINANCE8_OES:32832,LUMINANCE_ALPHA:6410,LUMINANCE_ALPHA16F_EXT:34847,LUMINANCE_ALPHA32F_EXT:34841,MALI_PROGRAM_BINARY_ARM:36705,MALI_SHADER_BINARY_ARM:36704,MAP_FLUSH_EXPLICIT_BIT_EXT:16,MAP_INVALIDATE_BUFFER_BIT_EXT:8,MAP_INVALIDATE_RANGE_BIT_EXT:4,MAP_READ_BIT_EXT:1,MAP_UNSYNCHRONIZED_BIT_EXT:32,MAP_WRITE_BIT_EXT:2,MAX_3D_TEXTURE_SIZE_OES:32883,MAX_COLOR_ATTACHMENTS_NV:36063,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_CUBE_MAP_TEXTURE_SIZE:34076,MAX_DEBUG_GROUP_STACK_DEPTH:33388,MAX_DEBUG_LOGGED_MESSAGES:37188,MAX_DEBUG_MESSAGE_LENGTH:37187,MAX_DRAW_BUFFERS_NV:34852,MAX_EXT:32776,MAX_FRAGMENT_UNIFORM_VECTORS:36349,MAX_LABEL_LENGTH:33512,MAX_MULTIVIEW_BUFFERS_EXT:37106,MAX_RENDERBUFFER_SIZE:34024,MAX_SAMPLES_ANGLE:36183,MAX_SAMPLES_APPLE:36183,MAX_SAMPLES_EXT:36183,MAX_SAMPLES_IMG:37173,MAX_SAMPLES_NV:36183,MAX_SERVER_WAIT_TIMEOUT_APPLE:37137,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_TEXTURE_MAX_ANISOTROPY_EXT:34047,MAX_TEXTURE_SIZE:3379,MAX_VARYING_VECTORS:36348,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VIEWPORT_DIMS:3386,MEDIUM_FLOAT:36337,MEDIUM_INT:36340,MIN_EXT:32775,MIRRORED_REPEAT:33648,MULTISAMPLE_BUFFER_BIT0_QCOM:16777216,MULTISAMPLE_BUFFER_BIT1_QCOM:33554432,MULTISAMPLE_BUFFER_BIT2_QCOM:67108864,MULTISAMPLE_BUFFER_BIT3_QCOM:134217728,MULTISAMPLE_BUFFER_BIT4_QCOM:268435456,MULTISAMPLE_BUFFER_BIT5_QCOM:536870912,MULTISAMPLE_BUFFER_BIT6_QCOM:1073741824,MULTISAMPLE_BUFFER_BIT7_QCOM:2147483648,MULTIVIEW_EXT:37105,NEAREST:9728,NEAREST_MIPMAP_LINEAR:9986,NEAREST_MIPMAP_NEAREST:9984,NEVER:512,NICEST:4354,NONE:0,NOTEQUAL:517,NO_ERROR:0,NO_RESET_NOTIFICATION_EXT:33377,NUM_COMPRESSED_TEXTURE_FORMATS:34466,NUM_PROGRAM_BINARY_FORMATS_OES:34814,NUM_SHADER_BINARY_FORMATS:36345,NV_coverage_sample:1,NV_depth_nonlinear:1,NV_draw_buffers:1,NV_draw_instanced:1,NV_fbo_color_attachments:1,NV_fence:1,NV_framebuffer_blit:1,NV_framebuffer_multisample:1,NV_generate_mipmap_sRGB:1,NV_instanced_arrays:1,NV_read_buffer:1,NV_read_buffer_front:1,NV_read_depth:1,NV_read_depth_stencil:1,NV_read_stencil:1,NV_sRGB_formats:1,NV_shadow_samplers_array:1,NV_shadow_samplers_cube:1,NV_texture_border_clamp:1,NV_texture_compression_s3tc_update:1,NV_texture_npot_2D_mipmap:1,OBJECT_TYPE_APPLE:37138,OES_EGL_image:1,OES_EGL_image_external:1,OES_compressed_ETC1_RGB8_texture:1,OES_compressed_paletted_texture:1,OES_depth24:1,OES_depth32:1,OES_depth_texture:1,OES_element_index_uint:1,OES_fbo_render_mipmap:1,OES_fragment_precision_high:1,OES_get_program_binary:1,OES_mapbuffer:1,OES_packed_depth_stencil:1,OES_required_internalformat:1,OES_rgb8_rgba8:1,OES_standard_derivatives:1,OES_stencil1:1,OES_stencil4:1,OES_surfaceless_context:1,OES_texture_3D:1,OES_texture_float:1,OES_texture_float_linear:1,OES_texture_half_float:1,OES_texture_half_float_linear:1,OES_texture_npot:1,OES_vertex_array_object:1,OES_vertex_half_float:1,OES_vertex_type_10_10_10_2:1,ONE:1,ONE_MINUS_CONSTANT_ALPHA:32772,ONE_MINUS_CONSTANT_COLOR:32770,ONE_MINUS_DST_ALPHA:773,ONE_MINUS_DST_COLOR:775,ONE_MINUS_SRC_ALPHA:771,ONE_MINUS_SRC_COLOR:769,OUT_OF_MEMORY:1285,PACK_ALIGNMENT:3333,PACK_REVERSE_ROW_ORDER_ANGLE:37796,PALETTE4_R5_G6_B5_OES:35730,PALETTE4_RGB5_A1_OES:35732,PALETTE4_RGB8_OES:35728,PALETTE4_RGBA4_OES:35731,PALETTE4_RGBA8_OES:35729,PALETTE8_R5_G6_B5_OES:35735,PALETTE8_RGB5_A1_OES:35737,PALETTE8_RGB8_OES:35733,PALETTE8_RGBA4_OES:35736,PALETTE8_RGBA8_OES:35734,PERCENTAGE_AMD:35779,PERFMON_GLOBAL_MODE_QCOM:36768,PERFMON_RESULT_AMD:35782,PERFMON_RESULT_AVAILABLE_AMD:35780,PERFMON_RESULT_SIZE_AMD:35781,POINTS:0,POLYGON_OFFSET_FACTOR:32824,POLYGON_OFFSET_FILL:32823,POLYGON_OFFSET_UNITS:10752,PROGRAM:33506,PROGRAM_BINARY_ANGLE:37798,PROGRAM_BINARY_FORMATS_OES:34815,PROGRAM_BINARY_LENGTH_OES:34625,PROGRAM_OBJECT_EXT:35648,PROGRAM_PIPELINE_BINDING_EXT:33370,PROGRAM_PIPELINE_OBJECT_EXT:35407,PROGRAM_SEPARABLE_EXT:33368,QCOM_alpha_test:1,QCOM_binning_control:1,QCOM_driver_control:1,QCOM_extended_get:1,QCOM_extended_get2:1,QCOM_perfmon_global_mode:1,QCOM_tiled_rendering:1,QCOM_writeonly_rendering:1,QUERY:33507,QUERY_OBJECT_EXT:37203,QUERY_RESULT_AVAILABLE_EXT:34919,QUERY_RESULT_EXT:34918,R16F_EXT:33325,R32F_EXT:33326,R8_EXT:33321,READ_BUFFER_EXT:3074,READ_BUFFER_NV:3074,READ_FRAMEBUFFER_ANGLE:36008,READ_FRAMEBUFFER_APPLE:36008,READ_FRAMEBUFFER_BINDING_ANGLE:36010,READ_FRAMEBUFFER_BINDING_APPLE:36010,READ_FRAMEBUFFER_BINDING_NV:36010,READ_FRAMEBUFFER_NV:36008,RED_BITS:3410,RED_EXT:6403,RENDERBUFFER:36161,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_BINDING:36007,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_SAMPLES_ANGLE:36011,RENDERBUFFER_SAMPLES_APPLE:36011,RENDERBUFFER_SAMPLES_EXT:36011,RENDERBUFFER_SAMPLES_IMG:37171,RENDERBUFFER_SAMPLES_NV:36011,RENDERBUFFER_STENCIL_SIZE:36181,RENDERBUFFER_WIDTH:36162,RENDERER:7937,RENDER_DIRECT_TO_FRAMEBUFFER_QCOM:36787,REPEAT:10497,REPLACE:7681,REQUIRED_TEXTURE_IMAGE_UNITS_OES:36200,RESET_NOTIFICATION_STRATEGY_EXT:33366,RG16F_EXT:33327,RG32F_EXT:33328,RG8_EXT:33323,RGB:6407,RGB10_A2_EXT:32857,RGB10_EXT:32850,RGB16F_EXT:34843,RGB32F_EXT:34837,RGB565:36194,RGB565_OES:36194,RGB5_A1:32855,RGB5_A1_OES:32855,RGB8_OES:32849,RGBA:6408,RGBA16F_EXT:34842,RGBA32F_EXT:34836,RGBA4:32854,RGBA4_OES:32854,RGBA8_OES:32856,RGB_422_APPLE:35359,RG_EXT:33319,RIGHT:1031,SAMPLER:33510,SAMPLER_2D:35678,SAMPLER_2D_ARRAY_SHADOW_NV:36292,SAMPLER_2D_SHADOW_EXT:35682,SAMPLER_3D_OES:35679,SAMPLER_CUBE:35680,SAMPLER_CUBE_SHADOW_NV:36293,SAMPLER_EXTERNAL_OES:36198,SAMPLES:32937,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_BUFFERS:32936,SAMPLE_COVERAGE:32928,SAMPLE_COVERAGE_INVERT:32939,SAMPLE_COVERAGE_VALUE:32938,SCISSOR_BOX:3088,SCISSOR_TEST:3089,SGX_BINARY_IMG:35850,SGX_PROGRAM_BINARY_IMG:37168,SHADER:33505,SHADER_BINARY_DMP:37456,SHADER_BINARY_FORMATS:36344,SHADER_BINARY_VIV:36804,SHADER_COMPILER:36346,SHADER_OBJECT_EXT:35656,SHADER_SOURCE_LENGTH:35720,SHADER_TYPE:35663,SHADING_LANGUAGE_VERSION:35724,SHORT:5122,SIGNALED_APPLE:37145,SLUMINANCE8_ALPHA8_NV:35909,SLUMINANCE8_NV:35911,SLUMINANCE_ALPHA_NV:35908,SLUMINANCE_NV:35910,SRC_ALPHA:770,SRC_ALPHA_SATURATE:776,SRC_COLOR:768,SRGB8_ALPHA8_EXT:35907,SRGB8_NV:35905,SRGB_ALPHA_EXT:35906,SRGB_EXT:35904,STACK_OVERFLOW:1283,STACK_UNDERFLOW:1284,STATE_RESTORE:35804,STATIC_DRAW:35044,STENCIL_ATTACHMENT:36128,STENCIL_BACK_FAIL:34817,STENCIL_BACK_FUNC:34816,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,STENCIL_BITS:3415,STENCIL_BUFFER_BIT:1024,STENCIL_BUFFER_BIT0_QCOM:65536,STENCIL_BUFFER_BIT1_QCOM:131072,STENCIL_BUFFER_BIT2_QCOM:262144,STENCIL_BUFFER_BIT3_QCOM:524288,STENCIL_BUFFER_BIT4_QCOM:1048576,STENCIL_BUFFER_BIT5_QCOM:2097152,STENCIL_BUFFER_BIT6_QCOM:4194304,STENCIL_BUFFER_BIT7_QCOM:8388608,STENCIL_CLEAR_VALUE:2961,STENCIL_EXT:6146,STENCIL_FAIL:2964,STENCIL_FUNC:2962,STENCIL_INDEX1_OES:36166,STENCIL_INDEX4_OES:36167,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_TEST:2960,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STREAM_DRAW:35040,SUBPIXEL_BITS:3408,SYNC_CONDITION_APPLE:37139,SYNC_FENCE_APPLE:37142,SYNC_FLAGS_APPLE:37141,SYNC_FLUSH_COMMANDS_BIT_APPLE:1,SYNC_GPU_COMMANDS_COMPLETE_APPLE:37143,SYNC_OBJECT_APPLE:35411,SYNC_STATUS_APPLE:37140,TEXTURE:5890,TEXTURE0:33984,TEXTURE1:33985,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE2:33986,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE3:33987,TEXTURE30:34014,TEXTURE31:34015,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE_2D:3553,TEXTURE_3D_OES:32879,TEXTURE_BINDING_2D:32873,TEXTURE_BINDING_3D_OES:32874,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_BINDING_EXTERNAL_OES:36199,TEXTURE_BORDER_COLOR_NV:4100,TEXTURE_COMPARE_FUNC_EXT:34893,TEXTURE_COMPARE_MODE_EXT:34892,TEXTURE_CUBE_MAP:34067,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_DEPTH_QCOM:35796,TEXTURE_EXTERNAL_OES:36197,TEXTURE_FORMAT_QCOM:35798,TEXTURE_HEIGHT_QCOM:35795,TEXTURE_IMAGE_VALID_QCOM:35800,TEXTURE_IMMUTABLE_FORMAT_EXT:37167,TEXTURE_INTERNAL_FORMAT_QCOM:35797,TEXTURE_MAG_FILTER:10240,TEXTURE_MAX_ANISOTROPY_EXT:34046,TEXTURE_MAX_LEVEL_APPLE:33085,TEXTURE_MIN_FILTER:10241,TEXTURE_NUM_LEVELS_QCOM:35801,TEXTURE_OBJECT_VALID_QCOM:35803,TEXTURE_SAMPLES_IMG:37174,TEXTURE_TARGET_QCOM:35802,TEXTURE_TYPE_QCOM:35799,TEXTURE_USAGE_ANGLE:37794,TEXTURE_WIDTH_QCOM:35794,TEXTURE_WRAP_R_OES:32882,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TIMEOUT_EXPIRED_APPLE:37147,TIMEOUT_IGNORED_APPLE:0x10000000000000000,TRANSLATED_SHADER_SOURCE_LENGTH_ANGLE:37792,TRIANGLES:4,TRIANGLE_FAN:6,TRIANGLE_STRIP:5,TRUE:1,UNKNOWN_CONTEXT_RESET_EXT:33365,UNPACK_ALIGNMENT:3317,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_PIXELS:3316,UNPACK_SKIP_ROWS:3315,UNSIGNALED_APPLE:37144,UNSIGNED_BYTE:5121,UNSIGNED_INT:5125,UNSIGNED_INT64_AMD:35778,UNSIGNED_INT_10_10_10_2_OES:36342,UNSIGNED_INT_24_8_OES:34042,UNSIGNED_INT_2_10_10_10_REV_EXT:33640,UNSIGNED_NORMALIZED_EXT:35863,UNSIGNED_SHORT:5123,UNSIGNED_SHORT_1_5_5_5_REV_EXT:33638,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_4_4_4_4_REV_EXT:33637,UNSIGNED_SHORT_4_4_4_4_REV_IMG:33637,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,UNSIGNED_SHORT_8_8_APPLE:34234,UNSIGNED_SHORT_8_8_REV_APPLE:34235,VALIDATE_STATUS:35715,VENDOR:7936,VERSION:7938,VERTEX_ARRAY_BINDING_OES:34229,VERTEX_ARRAY_OBJECT_EXT:37204,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE:35070,VERTEX_ATTRIB_ARRAY_DIVISOR_NV:35070,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_SHADER:35633,VERTEX_SHADER_BIT_EXT:1,VIEWPORT:2978,VIV_shader_binary:1,WAIT_FAILED_APPLE:37149,WRITEONLY_RENDERING_QCOM:34851,WRITE_ONLY_OES:35001,Z400_BINARY_AMD:34624,ZERO:0,RASTERIZER_DISCARD:35977,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,CONTEXT_LOST_WEBGL:37442,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,BROWSER_DEFAULT_WEBGL:37444},WebGL2RenderingContext:{},addEventListener:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};p$.addEventListener(t,e,n)},removeEventListener:function(t,e,n){p$.removeEventListener(t,e)},dispatchEvent:function(t){p$.dispatchEvent(t)},innerWidth:VZ.availWidth,innerHeight:VZ.availHeight,setTimeout:setTimeout,clearTimeout:clearTimeout,setInterval:setInterval,clearInterval:clearInterval},F$=N$?D$:yZ,j$=N$?P$:yZ.XMLHttpRequest;function B$(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function z$(t,e,n){var r=F$.document.createElement(t);return e&&(r.className=e||""),n&&n.appendChild(r),r}function U$(t){var e=t.parentNode;e&&e.removeChild(t)}function V$(t,e){if(void 0!==t.classList)for(var n=B$(e).split(/\s+/),r=0,i=n.length;r<i;r++)t.classList.add(n[r]);else if(!function(t,e){if(void 0!==t.classList)return t.classList.contains(e);var n=H$(t);return n.length>0&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(n)}(t,e)){var o=H$(t);W$(t,(o?o+" ":"")+e)}}function G$(t,e){void 0!==t.classList?t.classList.remove(e):W$(t,B$((" "+H$(t)+" ").replace(" "+e+" "," ")))}function W$(t,e){t instanceof HTMLElement?t.className=e:t.className.baseVal=e}function H$(t){return t instanceof SVGElement&&(t=t.correspondingElement),void 0===t.className.baseVal?t.className:t.className.baseVal}N$||yZ.location,function(t){var e,n,r=null==F$||null===(e=F$.document)||void 0===e||null===(n=e.documentElement)||void 0===n?void 0:n.style;if(!r)return t[0];for(var i in t)if(t[i]&&t[i]in r)return t[i];t[0]}(["transform","WebkitTransform"]);var Y$=function(){var t,e=F$.document.querySelector('meta[name="viewport"]');if(!e)return 1;var n=(null===(t=e.content)||void 0===t?void 0:t.split(",")).find((function(t){return"initial-scale"===lZ(t.split("="),1)[0]}));return n?1*n.split("=")[1]:1}()<1?1:F$.devicePixelRatio;function X$(t){t.innerHTML=""}function q$(t){if(0===t.length)return 0;for(var e=1*t[0],n=1;n<t.length;n++)e+=1*t[n];return e}var Z$={min:function(t){if(0===t.length)throw new Error("min requires at least one data point");for(var e=t[0],n=1;n<t.length;n++)t[n]<e&&(e=t[n]);return 1*e},max:function(t){if(0===t.length)throw new Error("max requires at least one data point");for(var e=t[0],n=1;n<t.length;n++)t[n]>e&&(e=t[n]);return 1*e},mean:function(t){if(0===t.length)throw new Error("mean requires at least one data point");return q$(t)/t.length},sum:q$,mode:function(t){if(0===t.length)throw new Error("mean requires at least one data point");if(t.length<3)return t[0];t.sort();for(var e=t[0],n=NaN,r=0,i=1,o=1;o<t.length+1;o++)t[o]!==e?(i>r&&(r=i,n=e),i=1,e=t[o]):i++;return 1*n}};function $$(t,e){return t.map((function(t){return t[e]}))}function K$(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function J$(t,e,n){return(J$=K$()?Reflect.construct.bind():function(t,e,n){var r=[null];r.push.apply(r,e);var i=new(Function.bind.apply(t,r));return n&&_Z(i,n.prototype),i}).apply(null,arguments)}function Q$(t){var e="function"==typeof Map?new Map:void 0;return Q$=function(t){if(null===t||(n=t,-1===Function.toString.call(n).indexOf("[native code]")))return t;var n;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return J$(t,arguments,EZ(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),_Z(r,t)},Q$(t)}function tK(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var eK=function(t){wZ(n,Q$(Error));var e=tK(n);function n(t,r,i,o){var a;return mZ(this,n),(a=e.call(this,"AJAXError: ".concat(r," (").concat(t,"): ").concat(i))).status=t,a.statusText=r,a.url=i,a.body=o,a}return gZ(n)}();function nK(t,e){var n=new j$,r=Array.isArray(t.url)?t.url[0]:t.url;for(var i in n.open(t.method||"GET",r,!0),"arrayBuffer"===t.type&&(n.responseType="arraybuffer"),t.headers)t.headers.hasOwnProperty(i)&&n.setRequestHeader(i,t.headers[i]);return"json"===t.type&&(n.responseType="text",n.setRequestHeader("Accept","application/json")),n.withCredentials="include"===t.credentials,n.onerror=function(){e(new Error(n.statusText))},n.onload=function(){if((n.status>=200&&n.status<300||0===n.status)&&null!==n.response){var i=n.response;if("json"===t.type)try{i=JSON.parse(n.response)}catch(a){return e(a)}e(null,i,n.getResponseHeader("Cache-Control"),n.getResponseHeader("Expires"),n)}else{var o=new Blob([n.response],{type:n.getResponseHeader("Content-Type")});e(new eK(n.status,n.statusText,r.toString(),o))}},n.send(t.body),n}function rK(t){return new Promise((function(e,n){nK(t,(function(t,r,i,o,a){t?n({err:t,data:null,xhr:a}):e({err:null,data:r,cacheControl:i,expires:o,xhr:a})}))}))}function iK(t,e){return nK(t,e)}var oK=function(t,e){return iK(Jq(Jq({},t),{},{type:"arrayBuffer"}),e)},aK="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";var sK=function(t,e,n){var r=function(t,r){if(t)e(t);else if(r){var i="function"==typeof createImageBitmap,o=n?n(r):r;i?function(t,e){var n=new Blob([new Uint8Array(t)],{type:"image/png"});createImageBitmap(n).then((function(t){e(null,t)})).catch((function(t){e(new Error("Could not load image because of ".concat(t.message,". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")))}))}(o,e):function(t,e){var n=new F$.Image,r=F$.URL||F$.webkitURL;n.crossOrigin="anonymous",n.onload=function(){e(null,n),r.revokeObjectURL(n.src),n.onload=null,window.requestAnimationFrame((function(){n.src=aK}))},n.onerror=function(){return e(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var i=new Blob([new Uint8Array(t)],{type:"image/png"});n.src=t.byteLength?r.createObjectURL(i):aK}(o,e)}};return"json"===t.type?function(t,e){return iK(Jq(Jq({},t),{},{type:"json"}),e)}(t,r):oK(t,r)};function uK(t){return"number"==typeof t}function cK(t){var e=[1/0,1/0,-1/0,-1/0];return sZ(t,(function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])})),e}cK.default=cK;var lK=2*Math.PI*6378137/2;function hK(t){var e=[1/0,1/0,-1/0,-1/0];return t.forEach((function(t){var n=t.coordinates;fK(e,n)})),e}function fK(t,e){return Array.isArray(e[0])?e.forEach((function(e){fK(t,e)})):(t[0]>e[0]&&(t[0]=e[0]),t[1]>e[1]&&(t[1]=e[1]),t[2]<e[0]&&(t[2]=e[0]),t[3]<e[1]&&(t[3]=e[1])),t}function pK(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{enable:!0,decimal:1},r=(t=dK(t,e))[0],i=t[1],o=r*lK/180,a=Math.log(Math.tan((90+i)*Math.PI/360))/(Math.PI/180);return a=a*lK/180,n.enable&&(o=Number(o.toFixed(n.decimal)),a=Number(a.toFixed(n.decimal))),3===t.length?[o,a,t[2]]:[o,a]}function dK(t,e){if(!1===e)return t;var n=function(t){if(null==t)throw new Error("lng is required");return(t>180||t<-180)&&((t%=360)>180&&(t=-360+t),t<-180&&(t=360+t),0===t&&(t=0)),t}(t[0]),r=function(t){if(null==t)throw new Error("lat is required");return(t>90||t<-90)&&((t%=180)>90&&(t=-180+t),t<-90&&(t=180+t),0===t&&(t=0)),t}(t[1]);return r>85&&(r=85),r<-85&&(r=-85),3===t.length?[n,r,t[2]]:[n,r]}function mK(t){var e=85.0511287798,n=Math.max(Math.min(e,t[1]),-e),r=256<<20,i=Math.PI/180,o=t[0]*i,a=n*i;a=Math.log(Math.tan(Math.PI/4+a/2));return o=r*(.5/Math.PI*o+.5),a=r*(-.5/Math.PI*a+(i=.5)),[Math.floor(o),Math.floor(a)]}function vK(t,e){var n=85.0511287798,r=Math.PI/180,i=6378137;return e=Math.max(Math.min(n,e),-n),e*=r,[(t*=r)*i,(e=Math.log(Math.tan(Math.PI/4+e/2)))*i]}function gK(t,e){var n=Math.abs(t[1][1]-t[0][1])*e,r=Math.abs(t[1][0]-t[0][0])*e;return[[t[0][0]-r,t[0][1]-n],[t[1][0]+r,t[1][1]+n]]}function yK(t,e){return t[0][0]<=e[0][0]&&t[0][1]<=e[0][1]&&t[1][0]>=e[1][0]&&t[1][1]>=e[1][1]}function xK(t){return[[t[0],t[1]],[t[2],t[3]]]}function bK(t){var e,n,r=(e=t,n=[0,0],Math.sqrt(Math.pow(e[0]-n[0],2)+Math.pow(e[1]-n[1],2)));return[t[0]/r,t[1]/r]}function _K(t){if(uK(t[0]))return t;if(uK(t[0][0]))throw new Error("当前数据不支持标注");if(uK(t[0][0][0])){var e=0,n=0,r=0;return t.forEach((function(t){t.forEach((function(t){e+=t[0],n+=t[1],r++}))})),[e/r,n/r,0]}throw new Error("当前数据不支持标注")}var wK,SK,MK=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,n=arguments.length>1?arguments[1]:void 0;mZ(this,t),this.limit=e,this.destroy=n||this.defaultDestroy,this.order=[],this.clear()}return gZ(t,[{key:"clear",value:function(){var t=this;this.order.forEach((function(e){t.delete(e)})),this.cache={},this.order=[]}},{key:"get",value:function(t){var e=this.cache[t];return e&&(this.deleteOrder(t),this.appendOrder(t)),e}},{key:"set",value:function(t,e){this.cache[t]?(this.delete(t),this.cache[t]=e,this.appendOrder(t)):(Object.keys(this.cache).length===this.limit&&this.delete(this.order[0]),this.cache[t]=e,this.appendOrder(t))}},{key:"delete",value:function(t){var e=this.cache[t];e&&(this.deleteCache(t),this.deleteOrder(t),this.destroy(e,t))}},{key:"deleteCache",value:function(t){delete this.cache[t]}},{key:"deleteOrder",value:function(t){var e=this.order.findIndex((function(e){return e===t}));e>=0&&this.order.splice(e,1)}},{key:"appendOrder",value:function(t){this.order.push(t)}},{key:"defaultDestroy",value:function(t,e){return null}}]),t}();function EK(t){var e=ju(t),n=[0,0,0,0];return null!=e&&(n[0]=e.r/255,n[1]=e.g/255,n[2]=e.b/255,n[3]=e.opacity),n}function AK(t){return(t&&t[0])+256*(t&&t[1])+65536*(t&&t[2])-1}function TK(t){return[t+1&255,t+1>>8&255,t+1>>8>>8&255]}function CK(t){var e=F$.document.createElement("canvas"),n=e.getContext("2d");e.width=256,e.height=1;for(var r=null,i=n.createLinearGradient(0,0,256,1),o=t.positions[0],a=t.positions[t.positions.length-1],s=0;s<t.colors.length;++s){var u=(t.positions[s]-o)/(a-o);i.addColorStop(u,t.colors[s])}if(n.fillStyle=i,n.fillRect(0,0,256,1),N$)return r=new Uint8ClampedArray(n.getImageData(0,0,256,1).data),e=null,n=null,{data:r,width:256,height:1};r=n.getImageData(0,0,256,1).data;for(var c=n.createImageData(256,1),l=0;l<c.data.length;l+=4)c.data[l+0]=r[l+0],c.data[l+1]=r[l+1],c.data[l+2]=r[l+2],c.data[l+3]=r[l+3];return e=null,n=null,c}function OK(t,e){for(var n=t.createImageData(256,1),r=0;r<n.data.length;r+=4)n.data[r+0]=e[r+0],n.data[r+1]=e[r+1],n.data[r+2]=e[r+2],n.data[r+3]=e[r+3];return n}function kK(t){if("cat"===t.type)return[0,255]}function PK(t,e){return{enable:t,mask:255,func:{cmp:514,ref:e?1:0,mask:255}}}function LK(t,e,n,r,i,o,a){try{var s=t[o](a),u=s.value}catch(c){return void n(c)}s.done?e(u):Promise.resolve(u).then(r,i)}function RK(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function a(t){LK(o,r,i,a,s,"next",t)}function s(t){LK(o,r,i,a,s,"throw",t)}a(void 0)}))}}(SK=wK||(wK={})).CENTER="center",SK.TOP="top",SK["TOP-LEFT"]="top-left",SK["TOP-RIGHT"]="top-right",SK.BOTTOM="bottom",SK["BOTTOM-LEFT"]="bottom-left",SK["BOTTOM-RIGHT"]="bottom-right",SK.LEFT="left",SK.RIGHT="right";var IK={},NK={get exports(){return IK},set exports(t){IK=t}},DK={};!function(t){function e(n){return t.exports=e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,e(n)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}({get exports(){return DK},set exports(t){DK=t}}),function(t){var e=DK.default;function n(){t.exports=n=function(){return r},t.exports.__esModule=!0,t.exports.default=t.exports;var r={},i=Object.prototype,o=i.hasOwnProperty,a=Object.defineProperty||function(t,e,n){t[e]=n.value},s="function"==typeof Symbol?Symbol:{},u=s.iterator||"@@iterator",c=s.asyncIterator||"@@asyncIterator",l=s.toStringTag||"@@toStringTag";function h(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{h({},"")}catch(P){h=function(t,e,n){return t[e]=n}}function f(t,e,n,r){var i=e&&e.prototype instanceof m?e:m,o=Object.create(i.prototype),s=new C(r||[]);return a(o,"_invoke",{value:M(t,n,s)}),o}function p(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(P){return{type:"throw",arg:P}}}r.wrap=f;var d={};function m(){}function v(){}function g(){}var y={};h(y,u,(function(){return this}));var x=Object.getPrototypeOf,b=x&&x(x(O([])));b&&b!==i&&o.call(b,u)&&(y=b);var _=g.prototype=m.prototype=Object.create(y);function w(t){["next","throw","return"].forEach((function(e){h(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,n){function r(i,a,s,u){var c=p(t[i],t,a);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==e(h)&&o.call(h,"__await")?n.resolve(h.__await).then((function(t){r("next",t,s,u)}),(function(t){r("throw",t,s,u)})):n.resolve(h).then((function(t){l.value=t,s(l)}),(function(t){return r("throw",t,s,u)}))}u(c.arg)}var i;a(this,"_invoke",{value:function(t,e){function o(){return new n((function(n,i){r(t,e,n,i)}))}return i=i?i.then(o,o):o()}})}function M(t,e,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return{value:void 0,done:!0}}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=E(a,n);if(s){if(s===d)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=p(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===d)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}function E(t,e){var n=e.method,r=t.iterator[n];if(void 0===r)return e.delegate=null,"throw"===n&&t.iterator.return&&(e.method="return",e.arg=void 0,E(t,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=p(r,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,d;var o=i.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,d):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function O(t){if(t){var e=t[u];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,r=function e(){for(;++n<t.length;)if(o.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return r.next=r}}return{next:k}}function k(){return{value:void 0,done:!0}}return v.prototype=g,a(_,"constructor",{value:g,configurable:!0}),a(g,"constructor",{value:v,configurable:!0}),v.displayName=h(g,l,"GeneratorFunction"),r.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,h(t,l,"GeneratorFunction")),t.prototype=Object.create(_),t},r.awrap=function(t){return{__await:t}},w(S.prototype),h(S.prototype,c,(function(){return this})),r.AsyncIterator=S,r.async=function(t,e,n,i,o){void 0===o&&(o=Promise);var a=new S(f(t,e,n,i),o);return r.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(_),h(_,l,"Generator"),h(_,u,(function(){return this})),h(_,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},r.values=O,C.prototype={constructor:C,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!t)for(var e in this)"t"===e.charAt(0)&&o.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var s=o.call(i,"catchLoc"),u=o.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&o.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:O(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},r}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports}(NK);var FK=IK(),jK=FK;try{regeneratorRuntime=FK}catch(Jkt){"object"==typeof globalThis?globalThis.regeneratorRuntime=FK:Function("r","regeneratorRuntime = r")(FK)}function BK(t,e){if(!t)throw new Error(e||"web worker helper assertion failed.")}var zK="undefined"!=typeof window&&void 0!==window.orientation,UK=function(){function t(t,e){var n=this;this.name=t,this.workerThread=e,this.isRunning=!0,this.resolve=function(){},this.reject=function(){},this.result=new Promise((function(t,e){n.resolve=t,n.reject=e}))}return t.prototype.postMessage=function(t,e){this.workerThread.postMessage({source:"Main thread",type:t,payload:e})},t.prototype.done=function(t){BK(this.isRunning,"WorkerJob isRunning false."),this.isRunning=!1,this.resolve(t)},t.prototype.error=function(t){BK(this.isRunning,"WorkerJob isRunning false."),this.isRunning=!1,this.reject(t)},t}(),VK=new Map;function GK(t){BK(t.source&&!t.url||!t.source&&t.url);var e=VK.get(t.source||t.url);return e||(t.url&&(e=function(t){if(!t.startsWith("http"))return t;return WK((e=t,"try {\n  importScripts('"+e+"');\n} catch (error) {\n  console.error(error);\n  throw error;\n}"));var e}(t.url),VK.set(t.url,e)),t.source&&(e=WK(t.source),VK.set(t.source,e))),BK(e),e}function WK(t){var e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function HK(t,e,n){void 0===e&&(e=!0);var r=n||new Set;if(t){if(YK(t))r.add(t);else if(YK(t.buffer))r.add(t.buffer);else if(ArrayBuffer.isView(t));else if(e&&"object"==typeof t)for(var i in t)HK(t[i],e,r)}else;return void 0===n?Array.from(r):[]}function YK(t){return!!t&&(t instanceof ArrayBuffer||("undefined"!=typeof MessagePort&&t instanceof MessagePort||("undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap||"undefined"!=typeof OffscreenCanvas&&t instanceof OffscreenCanvas)))}var XK=function(){},qK=function(){function t(t){this.terminated=!1,this.loadableURL="";var e=t.name,n=t.source,r=t.url;BK(n||r),this.name=e,this.source=n,this.url=r,this.onMessage=XK,this.onError=function(t){},this.worker=this.createBrowserWorker()}return t.isSupported=function(){return"undefined"!=typeof Worker},t.prototype.destroy=function(){this.onMessage=XK,this.onError=XK,this.worker.terminate(),this.terminated=!0},Object.defineProperty(t.prototype,"isRunning",{get:function(){return Boolean(this.onMessage)},enumerable:!1,configurable:!0}),t.prototype.postMessage=function(t,e){e=e||HK(t),this.worker.postMessage(t,e)},t.prototype.getErrorFromErrorEvent=function(t){var e="Failed to load ";return e+="worker "+this.name+" from "+this.url+". ",t.message&&(e+=t.message+" in "),t.lineno&&(e+=":"+t.lineno+":"+t.colno),new Error(e)},t.prototype.createBrowserWorker=function(){var t=this;this.loadableURL=GK({source:this.source,url:this.url});var e=new Worker(this.loadableURL,{name:this.name});return e.onmessage=function(e){e.data?t.onMessage(e.data):t.onError(new Error("No data received"))},e.onerror=function(e){t.onError(t.getErrorFromErrorEvent(e)),t.terminated=!0},e.onmessageerror=function(t){},e},t}(),ZK=globalThis&&globalThis.__assign||function(){return ZK=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},ZK.apply(this,arguments)},$K=globalThis&&globalThis.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(e){o(e)}}function s(t){try{u(r.throw(t))}catch(e){o(e)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},KK=globalThis&&globalThis.__generator||function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},JK=function(){function t(t){this.name="unnamed",this.maxConcurrency=1,this.maxMobileConcurrency=1,this.onDebug=function(){},this.reuseWorkers=!0,this.props={},this.jobQueue=[],this.idleQueue=[],this.count=0,this.isDestroyed=!1,this.source=t.source,this.url=t.url,this.setProps(t)}return t.prototype.destroy=function(){this.idleQueue.forEach((function(t){return t.destroy()})),this.isDestroyed=!0},t.prototype.setProps=function(t){this.props=ZK(ZK({},this.props),t),void 0!==t.name&&(this.name=t.name),void 0!==t.maxConcurrency&&(this.maxConcurrency=t.maxConcurrency),void 0!==t.maxMobileConcurrency&&(this.maxMobileConcurrency=t.maxMobileConcurrency),void 0!==t.reuseWorkers&&(this.reuseWorkers=t.reuseWorkers),void 0!==t.onDebug&&(this.onDebug=t.onDebug)},t.prototype.startJob=function(t,e,n){return void 0===e&&(e=function(t,e,n){return t.done(n)}),void 0===n&&(n=function(t,e){return t.error(e)}),$K(this,void 0,void 0,(function(){var r,i=this;return KK(this,(function(o){switch(o.label){case 0:return r=new Promise((function(r){return i.jobQueue.push({name:t,onMessage:e,onError:n,onStart:r}),i})),this.startQueuedJob(),[4,r];case 1:return[2,o.sent()]}}))}))},t.prototype.startQueuedJob=function(){return $K(this,void 0,void 0,(function(){var t,e,n;return KK(this,(function(r){switch(r.label){case 0:if(!this.jobQueue.length)return[2];if(!(t=this.getAvailableWorker()))return[2];if(!(e=this.jobQueue.shift()))return[3,4];this.onDebug({message:"Starting job",name:e.name,backlog:this.jobQueue.length,workerThread:t}),n=new UK(e.name,t),t.onMessage=function(t){return e.onMessage(n,t.type,t.payload)},t.onError=function(t){return e.onError(n,t)},e.onStart(n),r.label=1;case 1:return r.trys.push([1,,3,4]),[4,n.result];case 2:return r.sent(),[3,4];case 3:return this.returnWorkerToQueue(t),[7];case 4:return[2]}}))}))},t.prototype.returnWorkerToQueue=function(t){this.isDestroyed||!this.reuseWorkers||this.count>this.getMaxConcurrency()?(t.destroy(),this.count--):this.idleQueue.push(t),this.isDestroyed||this.startQueuedJob()},t.prototype.getAvailableWorker=function(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this.getMaxConcurrency()){this.count++;var t=this.name.toLowerCase()+" (#"+this.count+" of "+this.maxConcurrency+")";return new qK({name:t,source:this.source,url:this.url})}return null},t.prototype.getMaxConcurrency=function(){return zK?this.maxMobileConcurrency:this.maxConcurrency},t}(),QK=globalThis&&globalThis.__assign||function(){return QK=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},QK.apply(this,arguments)},tJ=globalThis&&globalThis.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},eJ={maxConcurrency:3,maxMobileConcurrency:1,onDebug:function(){},reuseWorkers:!0},nJ=function(){function t(t){this.workerPools=new Map,this.props=QK({},eJ),this.setProps(t),this.workerPools=new Map}return t.isSupported=function(){return qK.isSupported()},t.getWorkerFarm=function(e){return void 0===e&&(e={}),t.workerFarm=t.workerFarm||new t({}),t.workerFarm.setProps(e),t.workerFarm},t.prototype.destroy=function(){var t,e;try{for(var n=tJ(this.workerPools.values()),r=n.next();!r.done;r=n.next()){r.value.destroy()}}catch(i){t={error:i}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},t.prototype.setProps=function(t){var e,n;this.props=QK(QK({},this.props),t);try{for(var r=tJ(this.workerPools.values()),i=r.next();!i.done;i=r.next()){i.value.setProps(this.getWorkerPoolProps())}}catch(o){e={error:o}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},t.prototype.getWorkerPool=function(t){var e=t.name,n=t.source,r=t.url,i=this.workerPools.get(e);return i||((i=new JK({name:e,source:n,url:r})).setProps(this.getWorkerPoolProps()),this.workerPools.set(e,i)),i},t.prototype.getWorkerPoolProps=function(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}},t}(),rJ=new Map,iJ=function(){function t(){}return Object.defineProperty(t,"onmessage",{set:function(t){self.onmessage=function(e){if(oJ(e)){var n=e.data,r=n.type,i=n.payload;t(r,i)}}},enumerable:!1,configurable:!0}),t.addEventListener=function(t){var e=rJ.get(t);e||(e=function(e){if(oJ(e)){var n=e.data,r=n.type,i=n.payload;t(r,i)}}),self.addEventListener("message",e)},t.removeEventListener=function(t){var e=rJ.get(t);rJ.delete(t),self.removeEventListener("message",e)},t.postMessage=function(t,e){if(self){var n={source:"Worker thread",type:t,payload:e},r=HK(e);self.postMessage(n,r)}},t}();function oJ(t){var e=t.type,n=t.data;return"message"===e&&n&&"string"==typeof n.source&&"Main thread"===n.source}globalThis&&globalThis.__awaiter,globalThis&&globalThis.__generator;var aJ,sJ,uJ=function(){function t(){this._values=[],this._settlers=[],this._closed=!1}return t.prototype[Symbol.asyncIterator]=function(){return this},t.prototype.push=function(t){return this.enqueue(t)},t.prototype.enqueue=function(t){if(this._closed)throw new Error("Closed");if(this._settlers.length>0){if(this._values.length>0)throw new Error("Illegal internal state");var e=this._settlers.shift();t instanceof Error?e.reject(t):e.resolve({value:t})}else this._values.push(t)},t.prototype.close=function(){for(;this._settlers.length>0;){this._settlers.shift().resolve({done:!0})}this._closed=!0},t.prototype.next=function(){var t=this;if(this._values.length>0){var e=this._values.shift();return e instanceof Error?Promise.reject(e):Promise.resolve({done:!1,value:e})}if(this._closed){if(this._settlers.length>0)throw new Error("Illegal internal state");return Promise.resolve({done:!0,value:void 0})}return new Promise((function(e,n){t._settlers.push({resolve:e,reject:n})}))},t}(),cJ=globalThis&&globalThis.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(e){o(e)}}function s(t){try{u(r.throw(t))}catch(e){o(e)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},lJ=globalThis&&globalThis.__generator||function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},hJ=globalThis&&globalThis.__asyncValues||function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t="function"==typeof __values?__values(t):t[Symbol.iterator](),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(n){e[n]=t[n]&&function(e){return new Promise((function(r,i){(function(t,e,n,r){Promise.resolve(r).then((function(e){t({value:e,done:n})}),e)})(r,i,(e=t[n](e)).done,e.value)}))}}},fJ=0;function pJ(t,e){return void 0===e&&(e={}),new Promise((function(n,r){var i=fJ++,o=function(t,e){if(e.id===i)switch(t){case"done":iJ.removeEventListener(o),n(e.result);break;case"error":iJ.removeEventListener(o),r(e.error)}};iJ.addEventListener(o);var a={id:i,input:t,options:e};iJ.postMessage("process",a)}))}function dJ(t){var e=t.color;return e&&e.length?e:[1,1,1,1]}function mJ(t,e,n){return 2===n.length?[n[0],n[1],0]:[n[0],n[1],n[2]]}function vJ(t){return t.filter?[1]:[0]}function gJ(t,e){return[e]}globalThis&&globalThis.__awaiter,globalThis&&globalThis.__generator;var yJ={};function xJ(t,e,n){n=n||2;var r,i,o,a,s,u,c,l=e&&e.length,h=l?e[0]*n:t.length,f=bJ(t,0,h,n,!0),p=[];if(!f||f.next===f.prev)return p;if(l&&(f=function(t,e,n,r){var i,o,a,s=[];for(i=0,o=e.length;i<o;i++)(a=bJ(t,e[i]*r,i<o-1?e[i+1]*r:t.length,r,!1))===a.next&&(a.steiner=!0),s.push(PJ(a));for(s.sort(TJ),i=0;i<s.length;i++)n=CJ(s[i],n);return n}(t,e,f,n)),t.length>80*n){r=o=t[0],i=a=t[1];for(var d=n;d<h;d+=n)(s=t[d])<r&&(r=s),(u=t[d+1])<i&&(i=u),s>o&&(o=s),u>a&&(a=u);c=0!==(c=Math.max(o-r,a-i))?32767/c:0}return wJ(f,p,n,r,i,c,0),p}function bJ(t,e,n,r,i){var o,a;if(i===WJ(t,e,n,r)>0)for(o=e;o<n;o+=r)a=UJ(o,t[o],t[o+1],a);else for(o=n-r;o>=e;o-=r)a=UJ(o,t[o],t[o+1],a);return a&&NJ(a,a.next)&&(VJ(a),a=a.next),a}function _J(t,e){if(!t)return t;e||(e=t);var n,r=t;do{if(n=!1,r.steiner||!NJ(r,r.next)&&0!==IJ(r.prev,r,r.next))r=r.next;else{if(VJ(r),(r=e=r.prev)===r.next)break;n=!0}}while(n||r!==e);return e}function wJ(t,e,n,r,i,o,a){if(t){!a&&o&&function(t,e,n,r){var i=t;do{0===i.z&&(i.z=kJ(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,n,r,i,o,a,s,u,c=1;do{for(n=t,t=null,o=null,a=0;n;){for(a++,r=n,s=0,e=0;e<c&&(s++,r=r.nextZ);e++);for(u=c;s>0||u>0&&r;)0!==s&&(0===u||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,u--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;n=r}o.nextZ=null,c*=2}while(a>1)}(i)}(t,r,i,o);for(var s,u,c=t;t.prev!==t.next;)if(s=t.prev,u=t.next,o?MJ(t,r,i,o):SJ(t))e.push(s.i/n|0),e.push(t.i/n|0),e.push(u.i/n|0),VJ(t),t=u.next,c=u.next;else if((t=u)===c){a?1===a?wJ(t=EJ(_J(t),e,n),e,n,r,i,o,2):2===a&&AJ(t,e,n,r,i,o):wJ(_J(t),e,n,r,i,o,1);break}}}function SJ(t){var e=t.prev,n=t,r=t.next;if(IJ(e,n,r)>=0)return!1;for(var i=e.x,o=n.x,a=r.x,s=e.y,u=n.y,c=r.y,l=i<o?i<a?i:a:o<a?o:a,h=s<u?s<c?s:c:u<c?u:c,f=i>o?i>a?i:a:o>a?o:a,p=s>u?s>c?s:c:u>c?u:c,d=r.next;d!==e;){if(d.x>=l&&d.x<=f&&d.y>=h&&d.y<=p&&LJ(i,s,o,u,a,c,d.x,d.y)&&IJ(d.prev,d,d.next)>=0)return!1;d=d.next}return!0}function MJ(t,e,n,r){var i=t.prev,o=t,a=t.next;if(IJ(i,o,a)>=0)return!1;for(var s=i.x,u=o.x,c=a.x,l=i.y,h=o.y,f=a.y,p=s<u?s<c?s:c:u<c?u:c,d=l<h?l<f?l:f:h<f?h:f,m=s>u?s>c?s:c:u>c?u:c,v=l>h?l>f?l:f:h>f?h:f,g=kJ(p,d,e,n,r),y=kJ(m,v,e,n,r),x=t.prevZ,b=t.nextZ;x&&x.z>=g&&b&&b.z<=y;){if(x.x>=p&&x.x<=m&&x.y>=d&&x.y<=v&&x!==i&&x!==a&&LJ(s,l,u,h,c,f,x.x,x.y)&&IJ(x.prev,x,x.next)>=0)return!1;if(x=x.prevZ,b.x>=p&&b.x<=m&&b.y>=d&&b.y<=v&&b!==i&&b!==a&&LJ(s,l,u,h,c,f,b.x,b.y)&&IJ(b.prev,b,b.next)>=0)return!1;b=b.nextZ}for(;x&&x.z>=g;){if(x.x>=p&&x.x<=m&&x.y>=d&&x.y<=v&&x!==i&&x!==a&&LJ(s,l,u,h,c,f,x.x,x.y)&&IJ(x.prev,x,x.next)>=0)return!1;x=x.prevZ}for(;b&&b.z<=y;){if(b.x>=p&&b.x<=m&&b.y>=d&&b.y<=v&&b!==i&&b!==a&&LJ(s,l,u,h,c,f,b.x,b.y)&&IJ(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function EJ(t,e,n){var r=t;do{var i=r.prev,o=r.next.next;!NJ(i,o)&&DJ(i,r,r.next,o)&&BJ(i,o)&&BJ(o,i)&&(e.push(i.i/n|0),e.push(r.i/n|0),e.push(o.i/n|0),VJ(r),VJ(r.next),r=t=o),r=r.next}while(r!==t);return _J(r)}function AJ(t,e,n,r,i,o){var a=t;do{for(var s=a.next.next;s!==a.prev;){if(a.i!==s.i&&RJ(a,s)){var u=zJ(a,s);return a=_J(a,a.next),u=_J(u,u.next),wJ(a,e,n,r,i,o,0),void wJ(u,e,n,r,i,o,0)}s=s.next}a=a.next}while(a!==t)}function TJ(t,e){return t.x-e.x}function CJ(t,e){var n=function(t,e){var n,r=e,i=t.x,o=t.y,a=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var s=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&s>a&&(a=s,n=r.x<r.next.x?r:r.next,s===i))return n}r=r.next}while(r!==e);if(!n)return null;var u,c=n,l=n.x,h=n.y,f=1/0;r=n;do{i>=r.x&&r.x>=l&&i!==r.x&&LJ(o<h?i:a,o,l,h,o<h?a:i,o,r.x,r.y)&&(u=Math.abs(o-r.y)/(i-r.x),BJ(r,t)&&(u<f||u===f&&(r.x>n.x||r.x===n.x&&OJ(n,r)))&&(n=r,f=u)),r=r.next}while(r!==c);return n}(t,e);if(!n)return e;var r=zJ(n,t);return _J(r,r.next),_J(n,n.next)}function OJ(t,e){return IJ(t.prev,t,e.prev)<0&&IJ(e.next,t,t.next)<0}function kJ(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*i|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*i|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function PJ(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function LJ(t,e,n,r,i,o,a,s){return(i-a)*(e-s)>=(t-a)*(o-s)&&(t-a)*(r-s)>=(n-a)*(e-s)&&(n-a)*(o-s)>=(i-a)*(r-s)}function RJ(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&DJ(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(BJ(t,e)&&BJ(e,t)&&function(t,e){var n=t,r=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)&&(IJ(t.prev,t,e.prev)||IJ(t,e.prev,e))||NJ(t,e)&&IJ(t.prev,t,t.next)>0&&IJ(e.prev,e,e.next)>0)}function IJ(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function NJ(t,e){return t.x===e.x&&t.y===e.y}function DJ(t,e,n,r){var i=jJ(IJ(t,e,n)),o=jJ(IJ(t,e,r)),a=jJ(IJ(n,r,t)),s=jJ(IJ(n,r,e));return i!==o&&a!==s||(!(0!==i||!FJ(t,n,e))||(!(0!==o||!FJ(t,r,e))||(!(0!==a||!FJ(n,t,r))||!(0!==s||!FJ(n,e,r)))))}function FJ(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function jJ(t){return t>0?1:t<0?-1:0}function BJ(t,e){return IJ(t.prev,t,t.next)<0?IJ(t,e,t.next)>=0&&IJ(t,t.prev,e)>=0:IJ(t,e,t.prev)<0||IJ(t,t.next,e)<0}function zJ(t,e){var n=new GJ(t.i,t.x,t.y),r=new GJ(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function UJ(t,e,n,r){var i=new GJ(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function VJ(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function GJ(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function WJ(t,e,n,r){for(var i=0,o=e,a=n-r;o<n;o+=r)i+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return i}({get exports(){return yJ},set exports(t){yJ=t}}).exports=xJ,yJ.default=xJ,xJ.deviation=function(t,e,n,r){var i=e&&e.length,o=i?e[0]*n:t.length,a=Math.abs(WJ(t,0,o,n));if(i)for(var s=0,u=e.length;s<u;s++){var c=e[s]*n,l=s<u-1?e[s+1]*n:t.length;a-=Math.abs(WJ(t,c,l,n))}var h=0;for(s=0;s<r.length;s+=3){var f=r[s]*n,p=r[s+1]*n,d=r[s+2]*n;h+=Math.abs((t[f]-t[d])*(t[p+1]-t[f+1])-(t[f]-t[p])*(t[d+1]-t[f+1]))}return 0===a&&0===h?0:Math.abs((h-a)/a)},xJ.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var o=0;o<t[i].length;o++)for(var a=0;a<e;a++)n.vertices.push(t[i][o][a]);i>0&&(r+=t[i-1].length,n.holes.push(r))}return n};var HJ=ka();ka();var YJ=ka(),XJ=ka(),qJ=ka();function ZJ(t,e,n,r,i){return Ia(t,n,r),za(t,t),[i/Ua(e=Pa(-t[1],t[0]),Pa(-n[1],n[0])),e]}function $J(t,e){return Ra(t,-e[1],e[0])}function KJ(t,e,n){return Ha(t,e,n),za(t,t),t}function JJ(t,e){return t[0]===e[0]&&t[1]===e[1]}var QJ=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};mZ(this,t),$q(this,"lastFlip",-1),$q(this,"miter",Pa(0,0)),$q(this,"started",!1),$q(this,"dash",!1),$q(this,"totalDistance",0),$q(this,"currentIndex",0),this.join=e.join||"miter",this.cap=e.cap||"butt",this.miterLimit=e.miterLimit||10,this.thickness=e.thickness||1,this.dash=e.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0,indexes:[]}}return gZ(t,[{key:"extrude_gaode2",value:function(t,e){var n=this.complex;if(t.length<=1)return n;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var r=t.length,i=n.startIndex,o=1;o<r;o++){var a,s,u,c=t[o-1];c.push(null!==(a=e[o-1][2])&&void 0!==a?a:0);var l=e[o-1],h=t[o];h.push(null!==(s=e[o][2])&&void 0!==s?s:0);var f=e[o],p=o<t.length-1?[].concat(Xq(t[o+1]),[null!==(u=e[o+1][2])&&void 0!==u?u:0]):null,d=o<e.length-1?e[o+1]:null;i+=this.segment_gaode2(n,i,c,h,p,l,f,d)}if(this.dash)for(var m=0;m<n.positions.length/6;m++)n.positions[6*m+5]=this.totalDistance;return n.startIndex=n.positions.length/6,n}},{key:"simpleExtrude_gaode2",value:function(t,e){var n=this.complex;if(t.length<=1)return n;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var r=t.length,i=n.startIndex,o=1;o<r;o++){var a,s,u,c=t[o-1];c.push(null!==(a=e[o-1][2])&&void 0!==a?a:0);var l=e[o-1],h=t[o];h.push(null!==(s=e[o][2])&&void 0!==s?s:0);var f=e[o],p=o<t.length-1?[].concat(Xq(t[o+1]),[null!==(u=e[o+1][2])&&void 0!==u?u:0]):null,d=o<e.length-1?e[o+1]:null;i+=this.simpleSegment(n,i,c,h,p,l,f,d)}if(this.dash)for(var m=0;m<n.positions.length/6;m++)n.positions[6*m+5]=this.totalDistance;return n.startIndex=n.positions.length/6,n}},{key:"extrude",value:function(t){var e=this.complex;if(t.length<=1)return e;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var n=t.length,r=e.startIndex,i=1;i<n;i++){var o=t[i-1],a=t[i],s=i<t.length-1?t[i+1]:null;r+=this.segment(e,r,o,a,s)}if(this.dash)for(var u=0;u<e.positions.length/6;u++)e.positions[6*u+5]=this.totalDistance;return e.startIndex=e.positions.length/6,e}},{key:"simpleExtrude",value:function(t){var e=this.complex;if(t.length<=1)return e;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var n=t.length,r=e.startIndex,i=1;i<n;i++){var o=t[i-1],a=t[i],s=i<t.length-1?t[i+1]:null;r+=this.simpleSegment(e,r,o,a,s)}if(this.dash)for(var u=0;u<e.positions.length/6;u++)e.positions[6*u+5]=this.totalDistance;return e.startIndex=e.positions.length/6,e}},{key:"segment_gaode2",value:function(t,e,n,r,i,o,a,s){var u=0,c=t.indices,l=t.positions,h=t.normals,f="square"===this.cap,p="bevel"===this.join,d=mK([a[0],a[1]]),m=mK([o[0],o[1]]);KJ(YJ,r,n);var v=0;if(this.dash&&(v=this.lineSegmentDistance(d,m),this.totalDistance+=v),this.normal||(this.normal=ka(),$J(this.normal,YJ)),!this.started)if(this.started=!0,f){var g=ka(),y=ka();Ia(g,this.normal,YJ),Ia(y,this.normal,YJ),h.push(y[0],y[1],0),h.push(g[0],g[1],0),l.push(n[0],n[1],0|n[2],this.totalDistance-v,-this.thickness,0|n[2]),this.complex.indexes.push(this.currentIndex),l.push(n[0],n[1],0|n[2],this.totalDistance-v,this.thickness,0|n[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(l,h,n,this.normal,this.thickness,this.totalDistance-v);if(c.push(e+0,e+1,e+2),i){JJ(r,i)&&Ia(i,r,za(i,Na(i,r,n))),KJ(XJ,i,r);var x=lZ(ZJ(qJ,ka(),YJ,XJ,this.thickness),2),b=x[0],_=x[1],w=Ua(qJ,this.normal)<0?-1:1,S=p;if(!S&&"miter"===this.join)b>this.miterLimit&&(S=!0);S?(h.push(this.normal[0],this.normal[1],0),h.push(_[0],_[1],0),l.push(r[0],r[1],0|r[2],this.totalDistance,-this.thickness*w,0|r[2]),this.complex.indexes.push(this.currentIndex),l.push(r[0],r[1],0|r[2],this.totalDistance,this.thickness*w,0|r[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++,c.push.apply(c,Xq(this.lastFlip!==-w?[e,e+2,e+3]:[e+2,e+1,e+3])),c.push(e+2,e+3,e+4),$J(HJ,XJ),La(this.normal,HJ),h.push(this.normal[0],this.normal[1],0),l.push(r[0],r[1],0|r[2],this.totalDistance,-this.thickness*w,0|r[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++,u+=3):(this.extrusions(l,h,r,_,b,this.totalDistance),c.push.apply(c,Xq(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),w=-1,La(this.normal,_),u+=2),this.lastFlip=w}else{if($J(this.normal,YJ),f){var M=ka(),E=ka();Ha(E,YJ,this.normal),Ia(M,YJ,this.normal),h.push(E[0],E[1],0),h.push(M[0],M[1],0),l.push(r[0],r[1],0|r[2],this.totalDistance,this.thickness,0|r[2]),this.complex.indexes.push(this.currentIndex),l.push(r[0],r[1],0|r[2],this.totalDistance,this.thickness,0|r[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(l,h,r,this.normal,this.thickness,this.totalDistance);c.push.apply(c,Xq(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),u+=2}return u}},{key:"simpleSegment",value:function(t,e,n,r,i){var o=0,a=t.indices,s=t.positions,u=t.normals,c=mK([r[0],r[1]]),l=mK([n[0],n[1]]);KJ(YJ,c,l);var h=0;if(this.dash&&(h=this.lineSegmentDistance(c,l),this.totalDistance+=h),this.normal||(this.normal=ka(),$J(this.normal,YJ)),this.started||(this.started=!0,this.extrusions(s,u,n,this.normal,this.thickness,this.totalDistance-h)),a.push(e+0,e+1,e+2),i){var f=mK([i[0],i[1]]);JJ(c,f)&&Ia(f,c,za(f,Na(f,c,l))),KJ(XJ,f,c);var p=lZ(ZJ(qJ,ka(),YJ,XJ,this.thickness),2),d=p[0],m=p[1];Ua(qJ,this.normal);this.extrusions(s,u,r,m,d,this.totalDistance),a.push.apply(a,Xq(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),-1,La(this.normal,m),o+=2,this.lastFlip=-1}else $J(this.normal,YJ),this.extrusions(s,u,r,this.normal,this.thickness,this.totalDistance),a.push.apply(a,Xq(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),o+=2;return o}},{key:"segment",value:function(t,e,n,r,i){var o=0,a=t.indices,s=t.positions,u=t.normals,c="square"===this.cap,l="bevel"===this.join,h=mK([r[0],r[1]]),f=mK([n[0],n[1]]);KJ(YJ,h,f);var p=0;if(this.dash&&(p=this.lineSegmentDistance(h,f),this.totalDistance+=p),this.normal||(this.normal=ka(),$J(this.normal,YJ)),!this.started)if(this.started=!0,c){var d=ka(),m=ka();Ia(d,this.normal,YJ),Ia(m,this.normal,YJ),u.push(m[0],m[1],0),u.push(d[0],d[1],0),s.push(n[0],n[1],0|n[2],this.totalDistance-p,-this.thickness,0|n[2]),this.complex.indexes.push(this.currentIndex),s.push(n[0],n[1],0|n[2],this.totalDistance-p,this.thickness,0|n[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(s,u,n,this.normal,this.thickness,this.totalDistance-p);if(a.push(e+0,e+1,e+2),i){var v=mK([i[0],i[1]]);JJ(h,v)&&Ia(v,h,za(v,Na(v,h,f))),KJ(XJ,v,h);var g=lZ(ZJ(qJ,ka(),YJ,XJ,this.thickness),2),y=g[0],x=g[1],b=Ua(qJ,this.normal)<0?-1:1,_=l;if(!_&&"miter"===this.join)y>this.miterLimit&&(_=!0);_?(u.push(this.normal[0],this.normal[1],0),u.push(x[0],x[1],0),s.push(r[0],r[1],0|r[2],this.totalDistance,-this.thickness*b,0|r[2]),this.complex.indexes.push(this.currentIndex),s.push(r[0],r[1],0|r[2],this.totalDistance,this.thickness*b,0|r[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++,a.push.apply(a,Xq(this.lastFlip!==-b?[e,e+2,e+3]:[e+2,e+1,e+3])),a.push(e+2,e+3,e+4),$J(HJ,XJ),La(this.normal,HJ),u.push(this.normal[0],this.normal[1],0),s.push(r[0],r[1],0|r[2],this.totalDistance,-this.thickness*b,0|r[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++,o+=3):(this.extrusions(s,u,r,x,y,this.totalDistance),a.push.apply(a,Xq(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),b=-1,La(this.normal,x),o+=2),this.lastFlip=b}else{if($J(this.normal,YJ),c){var w=ka(),S=ka();Ha(S,YJ,this.normal),Ia(w,YJ,this.normal),u.push(S[0],S[1],0),u.push(w[0],w[1],0),s.push(r[0],r[1],0|r[2],this.totalDistance,this.thickness,0|r[2]),this.complex.indexes.push(this.currentIndex),s.push(r[0],r[1],0|r[2],this.totalDistance,this.thickness,0|r[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(s,u,r,this.normal,this.thickness,this.totalDistance);a.push.apply(a,Xq(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),o+=2}return o}},{key:"extrusions",value:function(t,e,n,r,i,o){e.push(r[0],r[1],0),e.push(r[0],r[1],0),t.push(n[0],n[1],0|n[2],o,-i,0|n[2]),this.complex.indexes.push(this.currentIndex),t.push(n[0],n[1],0|n[2],o,i,0|n[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++}},{key:"lineSegmentDistance",value:function(t,e){var n=e[0]-t[0],r=e[1]-t[1];return Math.sqrt(n*n+r*r)}}]),t}();function tQ(t){var e=t.coordinates,n=t.originCoordinates,r=t.version,i=new QJ({dash:!0,join:"bevel"});if("GAODE2.x"===r){var o=e;Array.isArray(o[0][0])||(o=[e]);var a=n;Array.isArray(a[0][0])||(a=[n]);for(var s=0;s<o.length;s++){var u=o[s],c=a[s];i.extrude_gaode2(u,c)}}else{var l=e;l[0]&&!Array.isArray(l[0][0])&&(l=[e]),l.forEach((function(t){i.extrude(t)}))}var h=i.complex;return{vertices:h.positions,indices:h.indices,normals:h.normals,indexes:h.indexes,size:6}}function eQ(t){var e=_K(t.coordinates);return{vertices:[].concat(Xq(e),Xq(e),Xq(e),Xq(e)),indices:[0,1,2,2,3,0],size:e.length}}function nQ(t){var e=t.coordinates,n=yJ.flatten(e),r=n.vertices,i=n.dimensions,o=n.holes;return{indices:yJ(r,o,i),vertices:r,size:i}}var rQ=function(){var t=RK(jK.mark((function t(e){var n,r,i,o,a,s,u,c,l;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.descriptors,r=e.features,i=e.enablePicking,o=e.iconMap,a={a_Color:dJ,a_Position:mJ,filter:vJ,a_vertexId:gJ,a_PickingColor:function(t){var e=t.id;return i?TK(e):[0,0,0]},a_DistanceAndIndex:function(t,e,n,r,i,o){return void 0===o?[n[3],10]:[n[3],o]},a_Total_Distance:function(t,e,n){return[n[5]]},a_Size:function(t){var e=t.size,n=void 0===e?1:e;return Array.isArray(n)?[n[0],n[1]]:[n,0]},a_Normal:function(t,e,n,r,i){return i},a_Miter:function(t,e,n){return[n[4]]},a_iconMapUV:function(t){var e=t.texture,n=o[e]||{x:0,y:0};return[n.x,n.y]}},s={sizePerElement:0,elements:[]},u=0,c=[],l=3,r.forEach((function(t,e){var r=tQ(t),i=r.indices,o=r.vertices,h=r.normals,f=r.size,p=r.indexes;i.forEach((function(t){c.push(t+u)})),l=f;var d=o.length/f;s.sizePerElement=l,s.elements.push({featureIdx:e,vertices:o,normals:h,offset:u}),u+=d;for(var m=function(r){var i=(null==h?void 0:h.slice(3*r,3*r+3))||[],s=o.slice(r*f,r*f+f),u=0;p&&void 0!==p[r]&&(u=p[r]),n.forEach((function(n){var o;n&&a[n.name]&&(o=n.buffer.data).push.apply(o,Xq(a[n.name](t,e,s,r,i,u)))}))},v=0;v<d;v++)m(v)})),t.abrupt("return",{descriptors:n,featureLayout:s,indices:c});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),iQ=function(){var t=RK(jK.mark((function t(e){var n,r,i,o,a,s,u,c,l;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.descriptors,r=e.features,i=e.enablePicking,o=e.shape2d,a={a_Color:dJ,a_Position:mJ,filter:vJ,a_vertexId:gJ,a_PickingColor:function(t){var e=t.id;return i?TK(e):[0,0,0]},a_Shape:function(t){var e=t.shape,n=void 0===e?2:e;return[o.indexOf(n)]},a_Extrude:function(t,e,n,r){var i=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],o=r%4*3;return[i[o],i[o+1],i[o+2]]},a_Size:function(t){var e=t.size,n=void 0===e?5:e;return Array.isArray(n)?[n[0]]:[n]}},s={sizePerElement:0,elements:[]},u=0,c=[],l=3,r.forEach((function(t,e){var r=eQ(t),i=r.indices,o=r.vertices,h=r.normals,f=r.size,p=r.indexes;i.forEach((function(t){c.push(t+u)})),l=f;var d=o.length/f;s.sizePerElement=l,s.elements.push({featureIdx:e,vertices:o,normals:h,offset:u}),u+=d;for(var m=function(r){var i=(null==h?void 0:h.slice(3*r,3*r+3))||[],s=o.slice(r*f,r*f+f),u=0;p&&void 0!==p[r]&&(u=p[r]),n.forEach((function(n){var o;n&&a[n.name]&&(o=n.buffer.data).push.apply(o,Xq(a[n.name](t,e,s,r,i,u)))}))},v=0;v<d;v++)m(v)})),t.abrupt("return",{descriptors:n,featureLayout:s,indices:c});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),oQ=function(){var t=RK(jK.mark((function t(e){var n,r,i,o,a,s,u,c;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.descriptors,r=e.features,i=e.enablePicking,o={a_Color:dJ,a_Position:mJ,filter:vJ,a_vertexId:gJ,a_PickingColor:function(t){var e=t.id;return i?TK(e):[0,0,0]}},a={sizePerElement:0,elements:[]},s=0,u=[],c=3,r.forEach((function(t,e){var r=nQ(t),i=r.indices,l=r.vertices,h=r.normals,f=r.size,p=r.indexes;i.forEach((function(t){u.push(t+s)})),c=f;var d=l.length/f;a.sizePerElement=c,a.elements.push({featureIdx:e,vertices:l,normals:h,offset:s}),s+=d;for(var m=function(r){var i=(null==h?void 0:h.slice(3*r,3*r+3))||[],a=l.slice(r*f,r*f+f),s=0;p&&void 0!==p[r]&&(s=p[r]),n.forEach((function(n){var u;n&&o[n.name]&&(u=n.buffer.data).push.apply(u,Xq(o[n.name](t,e,a,r,i,s)))}))},v=0;v<d;v++)m(v)})),t.abrupt("return",{descriptors:n,featureLayout:a,indices:u});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),aQ={pointFill:iQ,line:rQ,polygonFill:oQ},sQ=Jq({},aQ);function uQ(){return uQ=RK(jK.mark((function t(e){var n,r;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.workerType,r=e.data,!sQ[n]){t.next=3;break}return t.abrupt("return",sQ[n](r));case 3:return t.abrupt("return",Promise.reject(new Error('Worker with type "'.concat(n,'" non-existent.'))));case 4:case"end":return t.stop()}}),t)}))),uQ.apply(this,arguments)}!function(t,e){var n=this;if("undefined"!=typeof self){var r={process:pJ};iJ.onmessage=function(i,o){return cJ(n,void 0,void 0,(function(){var n,a,s,u,c,l,h,f,p,d;return lJ(this,(function(m){switch(m.label){case 0:switch(m.trys.push([0,19,,20]),i){case"process":return[3,1];case"process-in-batches":return[3,3];case"input-batch":return[3,16];case"input-done":return[3,17]}return[3,18];case 1:if(!t)throw new Error("Worker does not support atomic processing");return[4,t(o.input,o.options||{},r)];case 2:return n=m.sent(),iJ.postMessage("done",{result:n}),[3,18];case 3:if(!e)throw new Error("Worker does not support batched processing");aJ=new uJ,sJ=o.options||{},a=e(aJ,sJ,r),m.label=4;case 4:m.trys.push([4,9,10,15]),s=hJ(a),m.label=5;case 5:return[4,s.next()];case 6:if((u=m.sent()).done)return[3,8];c=u.value,iJ.postMessage("output-batch",{result:c}),m.label=7;case 7:return[3,5];case 8:return[3,15];case 9:return l=m.sent(),p={error:l},[3,15];case 10:return m.trys.push([10,,13,14]),u&&!u.done&&(d=s.return)?[4,d.call(s)]:[3,12];case 11:m.sent(),m.label=12;case 12:return[3,14];case 13:if(p)throw p.error;return[7];case 14:return[7];case 15:return iJ.postMessage("done",{}),[3,18];case 16:return aJ.push(o.input),[3,18];case 17:return aJ.close(),[3,18];case 18:return[3,20];case 19:return h=m.sent(),f=h instanceof Error?h.message:"",iJ.postMessage("error",{error:f}),[3,20];case 20:return[2]}}))}))}}}((function(t){return uQ.apply(this,arguments)}));var cQ=new Map;var lQ="l7-worker";function hQ(){var t,e=(t=lQ,cQ.get(t));if(!e)throw new Error("get worker failed by workerName: ".concat(lQ,"."));return e}function fQ(){return fQ=RK(jK.mark((function t(e,n){var r,i,o,a,s;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=hQ(),i=nJ.getWorkerFarm({maxConcurrency:3,reuseWorkers:true}),o=i.getWorkerPool({name:lQ,source:r}),t.next=5,o.startJob(lQ,(function(t,e,n){return t.done(n)}));case 5:return(a=t.sent).postMessage("process",{input:{workerType:e,data:n}}),t.next=9,a.result;case 9:return s=t.sent,t.abrupt("return",s.result);case 11:case"end":return t.stop()}}),t)}))),fQ.apply(this,arguments)}(function(t,e){cQ.set(t,e)})(lQ,'var L7=function(t){"use strict";function e(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function r(){r=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function c(t,e,r,n){var o=e&&e.prototype instanceof h?e:h,i=Object.create(o.prototype),a=new O(n||[]);return i._invoke=function(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return T()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var u=w(a,r);if(u){if(u===l)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var s=f(t,e,r);if("normal"===s.type){if(n=r.done?"completed":"suspendedYield",s.arg===l)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(n="completed",r.method="throw",r.arg=s.arg)}}}(t,r,a),i}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var l={};function h(){}function p(){}function v(){}var d={};s(d,i,(function(){return this}));var y=Object.getPrototypeOf,g=y&&y(y(S([])));g&&g!==e&&n.call(g,i)&&(d=g);var m=v.prototype=h.prototype=Object.create(d);function x(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){var r;this._invoke=function(o,i){function a(){return new e((function(r,a){!function r(o,i,a,u){var s=f(t[o],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==typeof l&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}(o,i,r,a)}))}return r=r?r.then(a,a):a()}}function w(t,e){var r=t.iterator[e.method];if(void 0===r){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method))return l;e.method="throw",e.arg=new TypeError("The iterator does not provide a \'throw\' method")}return l}var n=f(r,t.iterator,e.arg);if("throw"===n.type)return e.method="throw",e.arg=n.arg,e.delegate=null,l;var o=n.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,l):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function A(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function S(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:T}}function T(){return{value:void 0,done:!0}}return p.prototype=v,s(m,"constructor",v),s(v,"constructor",p),p.displayName=s(v,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,s(t,u,"GeneratorFunction")),t.prototype=Object.create(m),t},t.awrap=function(t){return{__await:t}},x(b.prototype),s(b.prototype,a,(function(){return this})),t.AsyncIterator=b,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},x(m),s(m,u,"Generator"),s(m,i,(function(){return this})),s(m,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var r in t)e.push(r);return e.reverse(),function r(){for(;e.length;){var n=e.pop();if(n in t)return r.value=n,r.done=!1,r}return r.done=!0,r}},t.values=S,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(A),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var u=n.call(i,"catchLoc"),s=n.call(i,"finallyLoc");if(u&&s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,l):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),l},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),A(r),l}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;A(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:S(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),l}},t}function n(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function o(t){return function(){var e=this,r=arguments;return new Promise((function(o,i){var a=t.apply(e,r);function u(t){n(a,o,i,u,s,"next",t)}function s(t){n(a,o,i,u,s,"throw",t)}u(void 0)}))}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(t,e,r){return e&&a(t.prototype,e),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function s(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function c(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e)}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function h(t){if(void 0===t)throw new ReferenceError("this hasn\'t been initialised - super() hasn\'t been called");return t}function p(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return h(t)}function v(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=f(t);if(e){var o=f(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return p(this,r)}}function d(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==r)return;var n,o,i=[],a=!0,u=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(i.push(n.value),!e||i.length!==e);a=!0);}catch(t){u=!0,o=t}finally{try{a||null==r.return||r.return()}finally{if(u)throw o}}return i}(t,e)||g(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(t){return function(t){if(Array.isArray(t))return m(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||g(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(t,e){if(t){if("string"==typeof t)return m(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?m(t,e):void 0}}function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var x="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function b(t,e){return t(e={exports:{}},e.exports),e.exports}var w,E,A=function(t){return t&&t.Math==Math&&t},O=A("object"==typeof globalThis&&globalThis)||A("object"==typeof window&&window)||A("object"==typeof self&&self)||A("object"==typeof x&&x)||function(){return this}()||Function("return this")(),S=Object.defineProperty,T=function(t,e){try{S(O,t,{value:e,configurable:!0,writable:!0})}catch(r){O[t]=e}return e},k=O["__core-js_shared__"]||T("__core-js_shared__",{}),I=b((function(t){(t.exports=function(t,e){return k[t]||(k[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.25.5",mode:"global",copyright:"© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.25.5/LICENSE",source:"https://github.com/zloirock/core-js"})})),j=function(t){try{return!!t()}catch(t){return!0}},P=!j((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")})),_=Function.prototype,M=_.call,L=P&&_.bind.bind(M,M),R=function(t){return P?L(t):function(){return M.apply(t,arguments)}},C=R({}.toString),N=R("".slice),D=function(t){return N(C(t),8,-1)},F=function(t){if("Function"===D(t))return R(t)},W=function(t){return null==t},z=TypeError,B=function(t){if(W(t))throw z("Can\'t call method on "+t);return t},U=Object,G=function(t){return U(B(t))},H=F({}.hasOwnProperty),V=Object.hasOwn||function(t,e){return H(G(t),e)},q=0,Z=Math.random(),Y=F(1..toString),$=function(t){return"Symbol("+(void 0===t?"":t)+")_"+Y(++q+Z,36)},K="object"==typeof document&&document.all,Q={all:K,IS_HTMLDDA:void 0===K&&void 0!==K},X=Q.all,J=Q.IS_HTMLDDA?function(t){return"function"==typeof t||t===X}:function(t){return"function"==typeof t},tt=function(t){return J(t)?t:void 0},et=function(t,e){return arguments.length<2?tt(O[t]):O[t]&&O[t][e]},rt=et("navigator","userAgent")||"",nt=O.process,ot=O.Deno,it=nt&&nt.versions||ot&&ot.version,at=it&&it.v8;at&&(E=(w=at.split("."))[0]>0&&w[0]<4?1:+(w[0]+w[1])),!E&&rt&&(!(w=rt.match(/Edge\\/(\\d+)/))||w[1]>=74)&&(w=rt.match(/Chrome\\/(\\d+)/))&&(E=+w[1]);var ut=E,st=!!Object.getOwnPropertySymbols&&!j((function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&ut&&ut<41})),ct=st&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,ft=I("wks"),lt=O.Symbol,ht=lt&&lt.for,pt=ct?lt:lt&&lt.withoutSetter||$,vt=function(t){if(!V(ft,t)||!st&&"string"!=typeof ft[t]){var e="Symbol."+t;st&&V(lt,t)?ft[t]=lt[t]:ft[t]=ct&&ht?ht(e):pt(e)}return ft[t]},dt={};dt[vt("toStringTag")]="z";var yt="[object z]"===String(dt),gt=!j((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),mt=Q.all,xt=Q.IS_HTMLDDA?function(t){return"object"==typeof t?null!==t:J(t)||t===mt}:function(t){return"object"==typeof t?null!==t:J(t)},bt=O.document,wt=xt(bt)&&xt(bt.createElement),Et=function(t){return wt?bt.createElement(t):{}},At=!gt&&!j((function(){return 7!=Object.defineProperty(Et("div"),"a",{get:function(){return 7}}).a})),Ot=gt&&j((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),St=String,Tt=TypeError,kt=function(t){if(xt(t))return t;throw Tt(St(t)+" is not an object")},It=Function.prototype.call,jt=P?It.bind(It):function(){return It.apply(It,arguments)},Pt=F({}.isPrototypeOf),_t=Object,Mt=ct?function(t){return"symbol"==typeof t}:function(t){var e=et("Symbol");return J(e)&&Pt(e.prototype,_t(t))},Lt=String,Rt=function(t){try{return Lt(t)}catch(t){return"Object"}},Ct=TypeError,Nt=function(t){if(J(t))return t;throw Ct(Rt(t)+" is not a function")},Dt=function(t,e){var r=t[e];return W(r)?void 0:Nt(r)},Ft=TypeError,Wt=TypeError,zt=vt("toPrimitive"),Bt=function(t,e){if(!xt(t)||Mt(t))return t;var r,n=Dt(t,zt);if(n){if(void 0===e&&(e="default"),r=jt(n,t,e),!xt(r)||Mt(r))return r;throw Wt("Can\'t convert object to primitive value")}return void 0===e&&(e="number"),function(t,e){var r,n;if("string"===e&&J(r=t.toString)&&!xt(n=jt(r,t)))return n;if(J(r=t.valueOf)&&!xt(n=jt(r,t)))return n;if("string"!==e&&J(r=t.toString)&&!xt(n=jt(r,t)))return n;throw Ft("Can\'t convert object to primitive value")}(t,e)},Ut=function(t){var e=Bt(t,"string");return Mt(e)?e:e+""},Gt=TypeError,Ht=Object.defineProperty,Vt=Object.getOwnPropertyDescriptor,qt={f:gt?Ot?function(t,e,r){if(kt(t),e=Ut(e),kt(r),"function"==typeof t&&"prototype"===e&&"value"in r&&"writable"in r&&!r.writable){var n=Vt(t,e);n&&n.writable&&(t[e]=r.value,r={configurable:"configurable"in r?r.configurable:n.configurable,enumerable:"enumerable"in r?r.enumerable:n.enumerable,writable:!1})}return Ht(t,e,r)}:Ht:function(t,e,r){if(kt(t),e=Ut(e),kt(r),At)try{return Ht(t,e,r)}catch(t){}if("get"in r||"set"in r)throw Gt("Accessors not supported");return"value"in r&&(t[e]=r.value),t}},Zt=Function.prototype,Yt=gt&&Object.getOwnPropertyDescriptor,$t=V(Zt,"name"),Kt={EXISTS:$t,PROPER:$t&&"something"===function(){}.name,CONFIGURABLE:$t&&(!gt||gt&&Yt(Zt,"name").configurable)},Qt=F(Function.toString);J(k.inspectSource)||(k.inspectSource=function(t){return Qt(t)});var Xt,Jt,te,ee=k.inspectSource,re=O.WeakMap,ne=J(re)&&/native code/.test(String(re)),oe=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},ie=gt?function(t,e,r){return qt.f(t,e,oe(1,r))}:function(t,e,r){return t[e]=r,t},ae=I("keys"),ue=function(t){return ae[t]||(ae[t]=$(t))},se={},ce=O.TypeError,fe=O.WeakMap;if(ne||k.state){var le=k.state||(k.state=new fe);le.get=le.get,le.has=le.has,le.set=le.set,Xt=function(t,e){if(le.has(t))throw ce("Object already initialized");return e.facade=t,le.set(t,e),e},Jt=function(t){return le.get(t)||{}},te=function(t){return le.has(t)}}else{var he=ue("state");se[he]=!0,Xt=function(t,e){if(V(t,he))throw ce("Object already initialized");return e.facade=t,ie(t,he,e),e},Jt=function(t){return V(t,he)?t[he]:{}},te=function(t){return V(t,he)}}var pe={set:Xt,get:Jt,has:te,enforce:function(t){return te(t)?Jt(t):Xt(t,{})},getterFor:function(t){return function(e){var r;if(!xt(e)||(r=Jt(e)).type!==t)throw ce("Incompatible receiver, "+t+" required");return r}}},ve=b((function(t){var e=Kt.CONFIGURABLE,r=pe.enforce,n=pe.get,o=Object.defineProperty,i=gt&&!j((function(){return 8!==o((function(){}),"length",{value:8}).length})),a=String(String).split("String"),u=t.exports=function(t,n,u){"Symbol("===String(n).slice(0,7)&&(n="["+String(n).replace(/^Symbol\\(([^)]*)\\)/,"$1")+"]"),u&&u.getter&&(n="get "+n),u&&u.setter&&(n="set "+n),(!V(t,"name")||e&&t.name!==n)&&(gt?o(t,"name",{value:n,configurable:!0}):t.name=n),i&&u&&V(u,"arity")&&t.length!==u.arity&&o(t,"length",{value:u.arity});try{u&&V(u,"constructor")&&u.constructor?gt&&o(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}var s=r(t);return V(s,"source")||(s.source=a.join("string"==typeof n?n:"")),t};Function.prototype.toString=u((function(){return J(this)&&n(this).source||ee(this)}),"toString")})),de=function(t,e,r,n){n||(n={});var o=n.enumerable,i=void 0!==n.name?n.name:e;if(J(r)&&ve(r,i,n),n.global)o?t[e]=r:T(e,r);else{try{n.unsafe?t[e]&&(o=!0):delete t[e]}catch(t){}o?t[e]=r:qt.f(t,e,{value:r,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return t},ye=vt("toStringTag"),ge=Object,me="Arguments"==D(function(){return arguments}()),xe=yt?D:function(t){var e,r,n;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=function(t,e){try{return t[e]}catch(t){}}(e=ge(t),ye))?r:me?D(e):"Object"==(n=D(e))&&J(e.callee)?"Arguments":n},be=yt?{}.toString:function(){return"[object "+xe(this)+"]"};yt||de(Object.prototype,"toString",be,{unsafe:!0});var we={}.propertyIsEnumerable,Ee=Object.getOwnPropertyDescriptor,Ae={f:Ee&&!we.call({1:2},1)?function(t){var e=Ee(this,t);return!!e&&e.enumerable}:we},Oe=Object,Se=F("".split),Te=j((function(){return!Oe("z").propertyIsEnumerable(0)}))?function(t){return"String"==D(t)?Se(t,""):Oe(t)}:Oe,ke=function(t){return Te(B(t))},Ie=Object.getOwnPropertyDescriptor,je={f:gt?Ie:function(t,e){if(t=ke(t),e=Ut(e),At)try{return Ie(t,e)}catch(t){}if(V(t,e))return oe(!jt(Ae.f,t,e),t[e])}},Pe=Math.ceil,_e=Math.floor,Me=Math.trunc||function(t){var e=+t;return(e>0?_e:Pe)(e)},Le=function(t){var e=+t;return e!=e||0===e?0:Me(e)},Re=Math.max,Ce=Math.min,Ne=function(t,e){var r=Le(t);return r<0?Re(r+e,0):Ce(r,e)},De=Math.min,Fe=function(t){return t>0?De(Le(t),9007199254740991):0},We=function(t){return Fe(t.length)},ze=function(t){return function(e,r,n){var o,i=ke(e),a=We(i),u=Ne(n,a);if(t&&r!=r){for(;a>u;)if((o=i[u++])!=o)return!0}else for(;a>u;u++)if((t||u in i)&&i[u]===r)return t||u||0;return!t&&-1}},Be={includes:ze(!0),indexOf:ze(!1)},Ue=Be.indexOf,Ge=F([].push),He=function(t,e){var r,n=ke(t),o=0,i=[];for(r in n)!V(se,r)&&V(n,r)&&Ge(i,r);for(;e.length>o;)V(n,r=e[o++])&&(~Ue(i,r)||Ge(i,r));return i},Ve=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],qe=Ve.concat("length","prototype"),Ze={f:Object.getOwnPropertyNames||function(t){return He(t,qe)}},Ye={f:Object.getOwnPropertySymbols},$e=F([].concat),Ke=et("Reflect","ownKeys")||function(t){var e=Ze.f(kt(t)),r=Ye.f;return r?$e(e,r(t)):e},Qe=function(t,e,r){for(var n=Ke(e),o=qt.f,i=je.f,a=0;a<n.length;a++){var u=n[a];V(t,u)||r&&V(r,u)||o(t,u,i(e,u))}},Xe=/#|\\.prototype\\./,Je=function(t,e){var r=er[tr(t)];return r==nr||r!=rr&&(J(e)?j(e):!!e)},tr=Je.normalize=function(t){return String(t).replace(Xe,".").toLowerCase()},er=Je.data={},rr=Je.NATIVE="N",nr=Je.POLYFILL="P",or=Je,ir=je.f,ar=function(t,e){var r,n,o,i,a,u=t.target,s=t.global,c=t.stat;if(r=s?O:c?O[u]||T(u,{}):(O[u]||{}).prototype)for(n in e){if(i=e[n],o=t.dontCallGetSet?(a=ir(r,n))&&a.value:r[n],!or(s?n:u+(c?".":"#")+n,t.forced)&&void 0!==o){if(typeof i==typeof o)continue;Qe(i,o)}(t.sham||o&&o.sham)&&ie(i,"sham",!0),de(r,n,i,t)}},ur="process"==D(O.process),sr=String,cr=TypeError,fr=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,r={};try{(t=F(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(r,[]),e=r instanceof Array}catch(t){}return function(r,n){return kt(r),function(t){if("object"==typeof t||J(t))return t;throw cr("Can\'t set "+sr(t)+" as a prototype")}(n),e?t(r,n):r.__proto__=n,r}}():void 0),lr=qt.f,hr=vt("toStringTag"),pr=function(t,e,r){t&&!r&&(t=t.prototype),t&&!V(t,hr)&&lr(t,hr,{configurable:!0,value:e})},vr=vt("species"),dr=function(t){var e=et(t),r=qt.f;gt&&e&&!e[vr]&&r(e,vr,{configurable:!0,get:function(){return this}})},yr=TypeError,gr=function(t,e){if(Pt(e,t))return t;throw yr("Incorrect invocation")},mr=function(){},xr=[],br=et("Reflect","construct"),wr=/^\\s*(?:class|function)\\b/,Er=F(wr.exec),Ar=!wr.exec(mr),Or=function(t){if(!J(t))return!1;try{return br(mr,xr,t),!0}catch(t){return!1}},Sr=function(t){if(!J(t))return!1;switch(xe(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return Ar||!!Er(wr,ee(t))}catch(t){return!0}};Sr.sham=!0;var Tr,kr,Ir,jr,Pr=!br||j((function(){var t;return Or(Or.call)||!Or(Object)||!Or((function(){t=!0}))||t}))?Sr:Or,_r=TypeError,Mr=function(t){if(Pr(t))return t;throw _r(Rt(t)+" is not a constructor")},Lr=vt("species"),Rr=function(t,e){var r,n=kt(t).constructor;return void 0===n||W(r=kt(n)[Lr])?e:Mr(r)},Cr=Function.prototype,Nr=Cr.apply,Dr=Cr.call,Fr="object"==typeof Reflect&&Reflect.apply||(P?Dr.bind(Nr):function(){return Dr.apply(Nr,arguments)}),Wr=F(F.bind),zr=function(t,e){return Nt(t),void 0===e?t:P?Wr(t,e):function(){return t.apply(e,arguments)}},Br=et("document","documentElement"),Ur=F([].slice),Gr=TypeError,Hr=function(t,e){if(t<e)throw Gr("Not enough arguments");return t},Vr=/(?:ipad|iphone|ipod).*applewebkit/i.test(rt),qr=O.setImmediate,Zr=O.clearImmediate,Yr=O.process,$r=O.Dispatch,Kr=O.Function,Qr=O.MessageChannel,Xr=O.String,Jr=0,tn={};try{Tr=O.location}catch(t){}var en=function(t){if(V(tn,t)){var e=tn[t];delete tn[t],e()}},rn=function(t){return function(){en(t)}},nn=function(t){en(t.data)},on=function(t){O.postMessage(Xr(t),Tr.protocol+"//"+Tr.host)};qr&&Zr||(qr=function(t){Hr(arguments.length,1);var e=J(t)?t:Kr(t),r=Ur(arguments,1);return tn[++Jr]=function(){Fr(e,void 0,r)},kr(Jr),Jr},Zr=function(t){delete tn[t]},ur?kr=function(t){Yr.nextTick(rn(t))}:$r&&$r.now?kr=function(t){$r.now(rn(t))}:Qr&&!Vr?(jr=(Ir=new Qr).port2,Ir.port1.onmessage=nn,kr=zr(jr.postMessage,jr)):O.addEventListener&&J(O.postMessage)&&!O.importScripts&&Tr&&"file:"!==Tr.protocol&&!j(on)?(kr=on,O.addEventListener("message",nn,!1)):kr="onreadystatechange"in Et("script")?function(t){Br.appendChild(Et("script")).onreadystatechange=function(){Br.removeChild(this),en(t)}}:function(t){setTimeout(rn(t),0)});var an,un,sn,cn,fn,ln,hn,pn,vn={set:qr,clear:Zr},dn=/ipad|iphone|ipod/i.test(rt)&&void 0!==O.Pebble,yn=/web0s(?!.*chrome)/i.test(rt),gn=je.f,mn=vn.set,xn=O.MutationObserver||O.WebKitMutationObserver,bn=O.document,wn=O.process,En=O.Promise,An=gn(O,"queueMicrotask"),On=An&&An.value;On||(an=function(){var t,e;for(ur&&(t=wn.domain)&&t.exit();un;){e=un.fn,un=un.next;try{e()}catch(t){throw un?cn():sn=void 0,t}}sn=void 0,t&&t.enter()},Vr||ur||yn||!xn||!bn?!dn&&En&&En.resolve?((hn=En.resolve(void 0)).constructor=En,pn=zr(hn.then,hn),cn=function(){pn(an)}):ur?cn=function(){wn.nextTick(an)}:(mn=zr(mn,O),cn=function(){mn(an)}):(fn=!0,ln=bn.createTextNode(""),new xn(an).observe(ln,{characterData:!0}),cn=function(){ln.data=fn=!fn}));var Sn=On||function(t){var e={fn:t,next:void 0};sn&&(sn.next=e),un||(un=e,cn()),sn=e},Tn=function(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}},kn=function(){this.head=null,this.tail=null};kn.prototype={add:function(t){var e={item:t,next:null};this.head?this.tail.next=e:this.head=e,this.tail=e},get:function(){var t=this.head;if(t)return this.head=t.next,this.tail===t&&(this.tail=null),t.item}};var In,jn,Pn,_n=kn,Mn=O.Promise,Ln="object"==typeof Deno&&Deno&&"object"==typeof Deno.version,Rn=!Ln&&!ur&&"object"==typeof window&&"object"==typeof document,Cn=(Mn&&Mn.prototype,vt("species")),Nn=!1,Dn=J(O.PromiseRejectionEvent),Fn={CONSTRUCTOR:or("Promise",(function(){var t=ee(Mn),e=t!==String(Mn);if(!e&&66===ut)return!0;if(!ut||ut<51||!/native code/.test(t)){var r=new Mn((function(t){t(1)})),n=function(t){t((function(){}),(function(){}))};if((r.constructor={})[Cn]=n,!(Nn=r.then((function(){}))instanceof n))return!0}return!e&&(Rn||Ln)&&!Dn})),REJECTION_EVENT:Dn,SUBCLASSING:Nn},Wn=TypeError,zn=function(t){var e,r;this.promise=new t((function(t,n){if(void 0!==e||void 0!==r)throw Wn("Bad Promise constructor");e=t,r=n})),this.resolve=Nt(e),this.reject=Nt(r)},Bn={f:function(t){return new zn(t)}},Un=vn.set,Gn=Fn.CONSTRUCTOR,Hn=Fn.REJECTION_EVENT,Vn=Fn.SUBCLASSING,qn=pe.getterFor("Promise"),Zn=pe.set,Yn=Mn&&Mn.prototype,$n=Mn,Kn=Yn,Qn=O.TypeError,Xn=O.document,Jn=O.process,to=Bn.f,eo=to,ro=!!(Xn&&Xn.createEvent&&O.dispatchEvent),no=function(t){var e;return!(!xt(t)||!J(e=t.then))&&e},oo=function(t,e){var r,n,o,i=e.value,a=1==e.state,u=a?t.ok:t.fail,s=t.resolve,c=t.reject,f=t.domain;try{u?(a||(2===e.rejection&&co(e),e.rejection=1),!0===u?r=i:(f&&f.enter(),r=u(i),f&&(f.exit(),o=!0)),r===t.promise?c(Qn("Promise-chain cycle")):(n=no(r))?jt(n,r,s,c):s(r)):c(i)}catch(t){f&&!o&&f.exit(),c(t)}},io=function(t,e){t.notified||(t.notified=!0,Sn((function(){for(var r,n=t.reactions;r=n.get();)oo(r,t);t.notified=!1,e&&!t.rejection&&uo(t)})))},ao=function(t,e,r){var n,o;ro?((n=Xn.createEvent("Event")).promise=e,n.reason=r,n.initEvent(t,!1,!0),O.dispatchEvent(n)):n={promise:e,reason:r},!Hn&&(o=O["on"+t])?o(n):"unhandledrejection"===t&&function(t,e){var r=O.console;r&&r.error&&(1==arguments.length?r.error(t):r.error(t,e))}("Unhandled promise rejection",r)},uo=function(t){jt(Un,O,(function(){var e,r=t.facade,n=t.value;if(so(t)&&(e=Tn((function(){ur?Jn.emit("unhandledRejection",n,r):ao("unhandledrejection",r,n)})),t.rejection=ur||so(t)?2:1,e.error))throw e.value}))},so=function(t){return 1!==t.rejection&&!t.parent},co=function(t){jt(Un,O,(function(){var e=t.facade;ur?Jn.emit("rejectionHandled",e):ao("rejectionhandled",e,t.value)}))},fo=function(t,e,r){return function(n){t(e,n,r)}},lo=function(t,e,r){t.done||(t.done=!0,r&&(t=r),t.value=e,t.state=2,io(t,!0))},ho=function(t,e,r){if(!t.done){t.done=!0,r&&(t=r);try{if(t.facade===e)throw Qn("Promise can\'t be resolved itself");var n=no(e);n?Sn((function(){var r={done:!1};try{jt(n,e,fo(ho,r,t),fo(lo,r,t))}catch(e){lo(r,e,t)}})):(t.value=e,t.state=1,io(t,!1))}catch(e){lo({done:!1},e,t)}}};if(Gn&&(Kn=($n=function(t){gr(this,Kn),Nt(t),jt(In,this);var e=qn(this);try{t(fo(ho,e),fo(lo,e))}catch(t){lo(e,t)}}).prototype,(In=function(t){Zn(this,{type:"Promise",done:!1,notified:!1,parent:!1,reactions:new _n,rejection:!1,state:0,value:void 0})}).prototype=de(Kn,"then",(function(t,e){var r=qn(this),n=to(Rr(this,$n));return r.parent=!0,n.ok=!J(t)||t,n.fail=J(e)&&e,n.domain=ur?Jn.domain:void 0,0==r.state?r.reactions.add(n):Sn((function(){oo(n,r)})),n.promise})),jn=function(){var t=new In,e=qn(t);this.promise=t,this.resolve=fo(ho,e),this.reject=fo(lo,e)},Bn.f=to=function(t){return t===$n||void 0===t?new jn(t):eo(t)},J(Mn)&&Yn!==Object.prototype)){Pn=Yn.then,Vn||de(Yn,"then",(function(t,e){var r=this;return new $n((function(t,e){jt(Pn,r,t,e)})).then(t,e)}),{unsafe:!0});try{delete Yn.constructor}catch(t){}fr&&fr(Yn,Kn)}ar({global:!0,constructor:!0,wrap:!0,forced:Gn},{Promise:$n}),pr($n,"Promise",!1),dr("Promise");var po={},vo=vt("iterator"),yo=Array.prototype,go=function(t){return void 0!==t&&(po.Array===t||yo[vo]===t)},mo=vt("iterator"),xo=function(t){if(!W(t))return Dt(t,mo)||Dt(t,"@@iterator")||po[xe(t)]},bo=TypeError,wo=function(t,e){var r=arguments.length<2?xo(t):e;if(Nt(r))return kt(jt(r,t));throw bo(Rt(t)+" is not iterable")},Eo=function(t,e,r){var n,o;kt(t);try{if(!(n=Dt(t,"return"))){if("throw"===e)throw r;return r}n=jt(n,t)}catch(t){o=!0,n=t}if("throw"===e)throw r;if(o)throw n;return kt(n),r},Ao=TypeError,Oo=function(t,e){this.stopped=t,this.result=e},So=Oo.prototype,To=function(t,e,r){var n,o,i,a,u,s,c,f=r&&r.that,l=!(!r||!r.AS_ENTRIES),h=!(!r||!r.IS_RECORD),p=!(!r||!r.IS_ITERATOR),v=!(!r||!r.INTERRUPTED),d=zr(e,f),y=function(t){return n&&Eo(n,"normal",t),new Oo(!0,t)},g=function(t){return l?(kt(t),v?d(t[0],t[1],y):d(t[0],t[1])):v?d(t,y):d(t)};if(h)n=t.iterator;else if(p)n=t;else{if(!(o=xo(t)))throw Ao(Rt(t)+" is not iterable");if(go(o)){for(i=0,a=We(t);a>i;i++)if((u=g(t[i]))&&Pt(So,u))return u;return new Oo(!1)}n=wo(t,o)}for(s=h?t.next:n.next;!(c=jt(s,n)).done;){try{u=g(c.value)}catch(t){Eo(n,"throw",t)}if("object"==typeof u&&u&&Pt(So,u))return u}return new Oo(!1)},ko=vt("iterator"),Io=!1;try{var jo=0,Po={next:function(){return{done:!!jo++}},return:function(){Io=!0}};Po[ko]=function(){return this},Array.from(Po,(function(){throw 2}))}catch(t){}var _o=function(t,e){if(!e&&!Io)return!1;var r=!1;try{var n={};n[ko]=function(){return{next:function(){return{done:r=!0}}}},t(n)}catch(t){}return r},Mo=Fn.CONSTRUCTOR||!_o((function(t){Mn.all(t).then(void 0,(function(){}))}));ar({target:"Promise",stat:!0,forced:Mo},{all:function(t){var e=this,r=Bn.f(e),n=r.resolve,o=r.reject,i=Tn((function(){var r=Nt(e.resolve),i=[],a=0,u=1;To(t,(function(t){var s=a++,c=!1;u++,jt(r,e,t).then((function(t){c||(c=!0,i[s]=t,--u||n(i))}),o)})),--u||n(i)}));return i.error&&o(i.value),r.promise}});var Lo=Fn.CONSTRUCTOR,Ro=Mn&&Mn.prototype;if(ar({target:"Promise",proto:!0,forced:Lo,real:!0},{catch:function(t){return this.then(void 0,t)}}),J(Mn)){var Co=et("Promise").prototype.catch;Ro.catch!==Co&&de(Ro,"catch",Co,{unsafe:!0})}ar({target:"Promise",stat:!0,forced:Mo},{race:function(t){var e=this,r=Bn.f(e),n=r.reject,o=Tn((function(){var o=Nt(e.resolve);To(t,(function(t){jt(o,e,t).then(r.resolve,n)}))}));return o.error&&n(o.value),r.promise}}),ar({target:"Promise",stat:!0,forced:Fn.CONSTRUCTOR},{reject:function(t){var e=Bn.f(this);return jt(e.reject,void 0,t),e.promise}});var No=Fn.CONSTRUCTOR;et("Promise");function Do(t,e){if(!t)throw new Error(e||"web worker helper assertion failed.")}ar({target:"Promise",stat:!0,forced:No},{resolve:function(t){return function(t,e){if(kt(t),xt(e)&&e.constructor===t)return e;var r=Bn.f(t);return(0,r.resolve)(e),r.promise}(this,t)}});var Fo="undefined"!=typeof window&&void 0!==window.orientation,Wo=function(){function t(t,e){var r=this;this.name=t,this.workerThread=e,this.isRunning=!0,this.resolve=function(){},this.reject=function(){},this.result=new Promise((function(t,e){r.resolve=t,r.reject=e}))}return t.prototype.postMessage=function(t,e){this.workerThread.postMessage({source:"Main thread",type:t,payload:e})},t.prototype.done=function(t){Do(this.isRunning,"WorkerJob isRunning false."),this.isRunning=!1,this.resolve(t)},t.prototype.error=function(t){Do(this.isRunning,"WorkerJob isRunning false."),this.isRunning=!1,this.reject(t)},t}(),zo=new Map;function Bo(t){Do(t.source&&!t.url||!t.source&&t.url);var e=zo.get(t.source||t.url);return e||(t.url&&(e=function(t){if(!t.startsWith("http"))return t;return Uo((e=t,"try {\\n  importScripts(\'"+e+"\');\\n} catch (error) {\\n  console.error(error);\\n  throw error;\\n}"));var e}(t.url),zo.set(t.url,e)),t.source&&(e=Uo(t.source),zo.set(t.source,e))),Do(e),e}function Uo(t){var e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function Go(t,e,r){void 0===e&&(e=!0);var n=r||new Set;if(t){if(Ho(t))n.add(t);else if(Ho(t.buffer))n.add(t.buffer);else if(ArrayBuffer.isView(t));else if(e&&"object"==typeof t)for(var o in t)Go(t[o],e,n)}else;return void 0===r?Array.from(n):[]}function Ho(t){return!!t&&(t instanceof ArrayBuffer||("undefined"!=typeof MessagePort&&t instanceof MessagePort||("undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap||"undefined"!=typeof OffscreenCanvas&&t instanceof OffscreenCanvas)))}var Vo=function(){},qo=function(){function t(t){this.terminated=!1,this.loadableURL="";var e=t.name,r=t.source,n=t.url;Do(r||n),this.name=e,this.source=r,this.url=n,this.onMessage=Vo,this.onError=function(t){return console.log(t)},this.worker=this.createBrowserWorker()}return t.isSupported=function(){return"undefined"!=typeof Worker},t.prototype.destroy=function(){this.onMessage=Vo,this.onError=Vo,this.worker.terminate(),this.terminated=!0},Object.defineProperty(t.prototype,"isRunning",{get:function(){return Boolean(this.onMessage)},enumerable:!1,configurable:!0}),t.prototype.postMessage=function(t,e){e=e||Go(t),this.worker.postMessage(t,e)},t.prototype.getErrorFromErrorEvent=function(t){var e="Failed to load ";return e+="worker "+this.name+" from "+this.url+". ",t.message&&(e+=t.message+" in "),t.lineno&&(e+=":"+t.lineno+":"+t.colno),new Error(e)},t.prototype.createBrowserWorker=function(){var t=this;this.loadableURL=Bo({source:this.source,url:this.url});var e=new Worker(this.loadableURL,{name:this.name});return e.onmessage=function(e){e.data?t.onMessage(e.data):t.onError(new Error("No data received"))},e.onerror=function(e){t.onError(t.getErrorFromErrorEvent(e)),t.terminated=!0},e.onmessageerror=function(e){return console.error("worker "+t.name+", message error: "+e)},e},t}(),Zo=self&&self.__assign||function(){return(Zo=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Yo=self&&self.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{s(n.next(t))}catch(t){i(t)}}function u(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,u)}s((n=n.apply(t,e||[])).next())}))},$o=self&&self.__generator||function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Ko=function(){function t(t){this.name="unnamed",this.maxConcurrency=1,this.maxMobileConcurrency=1,this.onDebug=function(){},this.reuseWorkers=!0,this.props={},this.jobQueue=[],this.idleQueue=[],this.count=0,this.isDestroyed=!1,this.source=t.source,this.url=t.url,this.setProps(t)}return t.prototype.destroy=function(){this.idleQueue.forEach((function(t){return t.destroy()})),this.isDestroyed=!0},t.prototype.setProps=function(t){this.props=Zo(Zo({},this.props),t),void 0!==t.name&&(this.name=t.name),void 0!==t.maxConcurrency&&(this.maxConcurrency=t.maxConcurrency),void 0!==t.maxMobileConcurrency&&(this.maxMobileConcurrency=t.maxMobileConcurrency),void 0!==t.reuseWorkers&&(this.reuseWorkers=t.reuseWorkers),void 0!==t.onDebug&&(this.onDebug=t.onDebug)},t.prototype.startJob=function(t,e,r){return void 0===e&&(e=function(t,e,r){return t.done(r)}),void 0===r&&(r=function(t,e){return t.error(e)}),Yo(this,void 0,void 0,(function(){var n,o=this;return $o(this,(function(i){switch(i.label){case 0:return n=new Promise((function(n){return o.jobQueue.push({name:t,onMessage:e,onError:r,onStart:n}),o})),this.startQueuedJob(),[4,n];case 1:return[2,i.sent()]}}))}))},t.prototype.startQueuedJob=function(){return Yo(this,void 0,void 0,(function(){var t,e,r;return $o(this,(function(n){switch(n.label){case 0:if(!this.jobQueue.length)return[2];if(!(t=this.getAvailableWorker()))return[2];if(!(e=this.jobQueue.shift()))return[3,4];this.onDebug({message:"Starting job",name:e.name,backlog:this.jobQueue.length,workerThread:t}),r=new Wo(e.name,t),t.onMessage=function(t){return e.onMessage(r,t.type,t.payload)},t.onError=function(t){return e.onError(r,t)},e.onStart(r),n.label=1;case 1:return n.trys.push([1,,3,4]),[4,r.result];case 2:return n.sent(),[3,4];case 3:return this.returnWorkerToQueue(t),[7];case 4:return[2]}}))}))},t.prototype.returnWorkerToQueue=function(t){this.isDestroyed||!this.reuseWorkers||this.count>this.getMaxConcurrency()?(t.destroy(),this.count--):this.idleQueue.push(t),this.isDestroyed||this.startQueuedJob()},t.prototype.getAvailableWorker=function(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this.getMaxConcurrency()){this.count++;var t=this.name.toLowerCase()+" (#"+this.count+" of "+this.maxConcurrency+")";return new qo({name:t,source:this.source,url:this.url})}return null},t.prototype.getMaxConcurrency=function(){return Fo?this.maxMobileConcurrency:this.maxConcurrency},t}(),Qo=self&&self.__assign||function(){return(Qo=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Xo=self&&self.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Jo={maxConcurrency:3,maxMobileConcurrency:1,onDebug:function(){},reuseWorkers:!0},ti=(function(){function t(t){this.workerPools=new Map,this.props=Qo({},Jo),this.setProps(t),this.workerPools=new Map}t.isSupported=function(){return qo.isSupported()},t.getWorkerFarm=function(e){return void 0===e&&(e={}),t.workerFarm=t.workerFarm||new t({}),t.workerFarm.setProps(e),t.workerFarm},t.prototype.destroy=function(){var t,e;try{for(var r=Xo(this.workerPools.values()),n=r.next();!n.done;n=r.next()){n.value.destroy()}}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},t.prototype.setProps=function(t){var e,r;this.props=Qo(Qo({},this.props),t);try{for(var n=Xo(this.workerPools.values()),o=n.next();!o.done;o=n.next()){o.value.setProps(this.getWorkerPoolProps())}}catch(t){e={error:t}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}},t.prototype.getWorkerPool=function(t){var e=t.name,r=t.source,n=t.url,o=this.workerPools.get(e);return o||((o=new Ko({name:e,source:r,url:n})).setProps(this.getWorkerPoolProps()),this.workerPools.set(e,o)),o},t.prototype.getWorkerPoolProps=function(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}(),new Map),ei=function(){function t(){}return Object.defineProperty(t,"onmessage",{set:function(t){self.onmessage=function(e){if(ri(e)){var r=e.data,n=r.type,o=r.payload;t(n,o)}}},enumerable:!1,configurable:!0}),t.addEventListener=function(t){var e=ti.get(t);e||(e=function(e){if(ri(e)){var r=e.data,n=r.type,o=r.payload;t(n,o)}}),self.addEventListener("message",e)},t.removeEventListener=function(t){var e=ti.get(t);ti.delete(t),self.removeEventListener("message",e)},t.postMessage=function(t,e){if(self){var r={source:"Worker thread",type:t,payload:e},n=Go(e);self.postMessage(r,n)}},t}();function ri(t){var e=t.type,r=t.data;return"message"===e&&r&&"string"==typeof r.source&&"Main thread"===r.source}self&&self.__awaiter,self&&self.__generator;var ni,oi,ii=function(){function t(){this._values=[],this._settlers=[],this._closed=!1}return t.prototype[Symbol.asyncIterator]=function(){return this},t.prototype.push=function(t){return this.enqueue(t)},t.prototype.enqueue=function(t){if(this._closed)throw new Error("Closed");if(this._settlers.length>0){if(this._values.length>0)throw new Error("Illegal internal state");var e=this._settlers.shift();t instanceof Error?e.reject(t):e.resolve({value:t})}else this._values.push(t)},t.prototype.close=function(){for(;this._settlers.length>0;){this._settlers.shift().resolve({done:!0})}this._closed=!0},t.prototype.next=function(){var t=this;if(this._values.length>0){var e=this._values.shift();return e instanceof Error?Promise.reject(e):Promise.resolve({done:!1,value:e})}if(this._closed){if(this._settlers.length>0)throw new Error("Illegal internal state");return Promise.resolve({done:!0,value:void 0})}return new Promise((function(e,r){t._settlers.push({resolve:e,reject:r})}))},t}(),ai=self&&self.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{s(n.next(t))}catch(t){i(t)}}function u(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,u)}s((n=n.apply(t,e||[])).next())}))},ui=self&&self.__generator||function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},si=self&&self.__asyncValues||function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,r=t[Symbol.asyncIterator];return r?r.call(t):(t="function"==typeof __values?__values(t):t[Symbol.iterator](),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(r){e[r]=t[r]&&function(e){return new Promise((function(n,o){(function(t,e,r,n){Promise.resolve(n).then((function(e){t({value:e,done:r})}),e)})(n,o,(e=t[r](e)).done,e.value)}))}}},ci=0;function fi(t,e){var r=this;if("undefined"!=typeof self){var n={process:li};ei.onmessage=function(o,i){return ai(r,void 0,void 0,(function(){var r,a,u,s,c,f,l,h,p,v;return ui(this,(function(d){switch(d.label){case 0:switch(d.trys.push([0,19,,20]),o){case"process":return[3,1];case"process-in-batches":return[3,3];case"input-batch":return[3,16];case"input-done":return[3,17]}return[3,18];case 1:if(!t)throw new Error("Worker does not support atomic processing");return[4,t(i.input,i.options||{},n)];case 2:return r=d.sent(),ei.postMessage("done",{result:r}),[3,18];case 3:if(!e)throw new Error("Worker does not support batched processing");ni=new ii,oi=i.options||{},a=e(ni,oi,n),d.label=4;case 4:d.trys.push([4,9,10,15]),u=si(a),d.label=5;case 5:return[4,u.next()];case 6:if((s=d.sent()).done)return[3,8];c=s.value,ei.postMessage("output-batch",{result:c}),d.label=7;case 7:return[3,5];case 8:return[3,15];case 9:return f=d.sent(),p={error:f},[3,15];case 10:return d.trys.push([10,,13,14]),s&&!s.done&&(v=u.return)?[4,v.call(u)]:[3,12];case 11:d.sent(),d.label=12;case 12:return[3,14];case 13:if(p)throw p.error;return[7];case 14:return[7];case 15:return ei.postMessage("done",{}),[3,18];case 16:return ni.push(i.input),[3,18];case 17:return ni.close(),[3,18];case 18:return[3,20];case 19:return l=d.sent(),h=l instanceof Error?l.message:"",ei.postMessage("error",{error:h}),[3,20];case 20:return[2]}}))}))}}}function li(t,e){return void 0===e&&(e={}),new Promise((function(r,n){var o=ci++,i=function(t,e){if(e.id===o)switch(t){case"done":ei.removeEventListener(i),r(e.result);break;case"error":ei.removeEventListener(i),n(e.error)}};ei.addEventListener(i);var a={id:o,input:t,options:e};ei.postMessage("process",a)}))}self&&self.__awaiter,self&&self.__generator;var hi={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},pi=Et("span").classList,vi=pi&&pi.constructor&&pi.constructor.prototype,di=vi===Object.prototype?void 0:vi,yi=Array.isArray||function(t){return"Array"==D(t)},gi=vt("species"),mi=Array,xi=function(t,e){return new(function(t){var e;return yi(t)&&(e=t.constructor,(Pr(e)&&(e===mi||yi(e.prototype))||xt(e)&&null===(e=e[gi]))&&(e=void 0)),void 0===e?mi:e}(t))(0===e?0:e)},bi=F([].push),wi=function(t){var e=1==t,r=2==t,n=3==t,o=4==t,i=6==t,a=7==t,u=5==t||i;return function(s,c,f,l){for(var h,p,v=G(s),d=Te(v),y=zr(c,f),g=We(d),m=0,x=l||xi,b=e?x(s,g):r||a?x(s,0):void 0;g>m;m++)if((u||m in d)&&(p=y(h=d[m],m,v),t))if(e)b[m]=p;else if(p)switch(t){case 3:return!0;case 5:return h;case 6:return m;case 2:bi(b,h)}else switch(t){case 4:return!1;case 7:bi(b,h)}return i?-1:n||o?o:b}},Ei={forEach:wi(0),map:wi(1),filter:wi(2),some:wi(3),every:wi(4),find:wi(5),findIndex:wi(6),filterReject:wi(7)},Ai=function(t,e){var r=[][t];return!!r&&j((function(){r.call(null,e||function(){return 1},1)}))},Oi=Ei.forEach,Si=Ai("forEach")?[].forEach:function(t){return Oi(this,t,arguments.length>1?arguments[1]:void 0)},Ti=function(t){if(t&&t.forEach!==Si)try{ie(t,"forEach",Si)}catch(e){t.forEach=Si}};for(var ki in hi)hi[ki]&&Ti(O[ki]&&O[ki].prototype);Ti(di);var Ii=function(t,e,r){var n=Ut(e);n in t?qt.f(t,n,oe(0,r)):t[n]=r},ji=vt("species"),Pi=function(t){return ut>=51||!j((function(){var e=[];return(e.constructor={})[ji]=function(){return{foo:1}},1!==e[t](Boolean).foo}))},_i=Pi("slice"),Mi=vt("species"),Li=Array,Ri=Math.max;ar({target:"Array",proto:!0,forced:!_i},{slice:function(t,e){var r,n,o,i=ke(this),a=We(i),u=Ne(t,a),s=Ne(void 0===e?a:e,a);if(yi(i)&&(r=i.constructor,(Pr(r)&&(r===Li||yi(r.prototype))||xt(r)&&null===(r=r[Mi]))&&(r=void 0),r===Li||void 0===r))return Ur(i,u,s);for(n=new(void 0===r?Li:r)(Ri(s-u,0)),o=0;u<s;u++,o++)u in i&&Ii(n,o,i[u]);return n.length=o,n}});var Ci=Kt.EXISTS,Ni=qt.f,Di=Function.prototype,Fi=F(Di.toString),Wi=/function\\b(?:\\s|\\/\\*[\\S\\s]*?\\*\\/|\\/\\/[^\\n\\r]*[\\n\\r]+)*([^\\s(/]*)/,zi=F(Wi.exec);gt&&!Ci&&Ni(Di,"name",{configurable:!0,get:function(){try{return zi(Wi,Fi(this))[1]}catch(t){return""}}});var Bi=Ei.map,Ui=Pi("map");ar({target:"Array",proto:!0,forced:!Ui},{map:function(t){return Bi(this,t,arguments.length>1?arguments[1]:void 0)}});var Gi,Hi=Object.keys||function(t){return He(t,Ve)},Vi={f:gt&&!Ot?Object.defineProperties:function(t,e){kt(t);for(var r,n=ke(e),o=Hi(e),i=o.length,a=0;i>a;)qt.f(t,r=o[a++],n[r]);return t}},qi=ue("IE_PROTO"),Zi=function(){},Yi=function(t){return"<script>"+t+"<\\/script>"},$i=function(t){t.write(Yi("")),t.close();var e=t.parentWindow.Object;return t=null,e},Ki=function(){try{Gi=new ActiveXObject("htmlfile")}catch(t){}var t,e;Ki="undefined"!=typeof document?document.domain&&Gi?$i(Gi):((e=Et("iframe")).style.display="none",Br.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write(Yi("document.F=Object")),t.close(),t.F):$i(Gi);for(var r=Ve.length;r--;)delete Ki.prototype[Ve[r]];return Ki()};se[qi]=!0;var Qi=Object.create||function(t,e){var r;return null!==t?(Zi.prototype=kt(t),r=new Zi,Zi.prototype=null,r[qi]=t):r=Ki(),void 0===e?r:Vi.f(r,e)},Xi=qt.f,Ji=vt("unscopables"),ta=Array.prototype;null==ta[Ji]&&Xi(ta,Ji,{configurable:!0,value:Qi(null)});var ea,ra,na,oa=function(t){ta[Ji][t]=!0},ia=!j((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype})),aa=ue("IE_PROTO"),ua=Object,sa=ua.prototype,ca=ia?ua.getPrototypeOf:function(t){var e=G(t);if(V(e,aa))return e[aa];var r=e.constructor;return J(r)&&e instanceof r?r.prototype:e instanceof ua?sa:null},fa=vt("iterator"),la=!1;[].keys&&("next"in(na=[].keys())?(ra=ca(ca(na)))!==Object.prototype&&(ea=ra):la=!0),(!xt(ea)||j((function(){var t={};return ea[fa].call(t)!==t})))&&(ea={}),J(ea[fa])||de(ea,fa,(function(){return this}));var ha={IteratorPrototype:ea,BUGGY_SAFARI_ITERATORS:la},pa=ha.IteratorPrototype,va=function(){return this},da=Kt.PROPER,ya=Kt.CONFIGURABLE,ga=ha.IteratorPrototype,ma=ha.BUGGY_SAFARI_ITERATORS,xa=vt("iterator"),ba=function(){return this},wa=function(t,e,r,n,o,i,a){!function(t,e,r,n){var o=e+" Iterator";t.prototype=Qi(pa,{next:oe(+!n,r)}),pr(t,o,!1),po[o]=va}(r,e,n);var u,s,c,f=function(t){if(t===o&&d)return d;if(!ma&&t in p)return p[t];switch(t){case"keys":case"values":case"entries":return function(){return new r(this,t)}}return function(){return new r(this)}},l=e+" Iterator",h=!1,p=t.prototype,v=p[xa]||p["@@iterator"]||o&&p[o],d=!ma&&v||f(o),y="Array"==e&&p.entries||v;if(y&&(u=ca(y.call(new t)))!==Object.prototype&&u.next&&(ca(u)!==ga&&(fr?fr(u,ga):J(u[xa])||de(u,xa,ba)),pr(u,l,!0)),da&&"values"==o&&v&&"values"!==v.name&&(ya?ie(p,"name","values"):(h=!0,d=function(){return jt(v,this)})),o)if(s={values:f("values"),keys:i?d:f("keys"),entries:f("entries")},a)for(c in s)(ma||h||!(c in p))&&de(p,c,s[c]);else ar({target:e,proto:!0,forced:ma||h},s);return p[xa]!==d&&de(p,xa,d,{name:o}),po[e]=d,s},Ea=function(t,e){return{value:t,done:e}},Aa=qt.f,Oa=pe.set,Sa=pe.getterFor("Array Iterator"),Ta=wa(Array,"Array",(function(t,e){Oa(this,{type:"Array Iterator",target:ke(t),index:0,kind:e})}),(function(){var t=Sa(this),e=t.target,r=t.kind,n=t.index++;return!e||n>=e.length?(t.target=void 0,Ea(void 0,!0)):Ea("keys"==r?n:"values"==r?e[n]:[n,e[n]],!1)}),"values"),ka=po.Arguments=po.Array;if(oa("keys"),oa("values"),oa("entries"),gt&&"values"!==ka.name)try{Aa(ka,"name",{value:"values"})}catch(t){}var Ia,ja,Pa,_a="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView,Ma=qt.f,La=pe.enforce,Ra=pe.get,Ca=O.Int8Array,Na=Ca&&Ca.prototype,Da=O.Uint8ClampedArray,Fa=Da&&Da.prototype,Wa=Ca&&ca(Ca),za=Na&&ca(Na),Ba=Object.prototype,Ua=O.TypeError,Ga=vt("toStringTag"),Ha=$("TYPED_ARRAY_TAG"),Va=_a&&!!fr&&"Opera"!==xe(O.opera),qa=!1,Za={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},Ya={BigInt64Array:8,BigUint64Array:8},$a=function(t){var e=ca(t);if(xt(e)){var r=Ra(e);return r&&V(r,"TypedArrayConstructor")?r.TypedArrayConstructor:$a(e)}},Ka=function(t){if(!xt(t))return!1;var e=xe(t);return V(Za,e)||V(Ya,e)};for(Ia in Za)(Pa=(ja=O[Ia])&&ja.prototype)?La(Pa).TypedArrayConstructor=ja:Va=!1;for(Ia in Ya)(Pa=(ja=O[Ia])&&ja.prototype)&&(La(Pa).TypedArrayConstructor=ja);if((!Va||!J(Wa)||Wa===Function.prototype)&&(Wa=function(){throw Ua("Incorrect invocation")},Va))for(Ia in Za)O[Ia]&&fr(O[Ia],Wa);if((!Va||!za||za===Ba)&&(za=Wa.prototype,Va))for(Ia in Za)O[Ia]&&fr(O[Ia].prototype,za);if(Va&&ca(Fa)!==za&&fr(Fa,za),gt&&!V(za,Ga))for(Ia in qa=!0,Ma(za,Ga,{get:function(){return xt(this)?this[Ha]:void 0}}),Za)O[Ia]&&ie(O[Ia],Ha,Ia);var Qa={NATIVE_ARRAY_BUFFER_VIEWS:Va,TYPED_ARRAY_TAG:qa&&Ha,aTypedArray:function(t){if(Ka(t))return t;throw Ua("Target is not a typed array")},aTypedArrayConstructor:function(t){if(J(t)&&(!fr||Pt(Wa,t)))return t;throw Ua(Rt(t)+" is not a typed array constructor")},exportTypedArrayMethod:function(t,e,r,n){if(gt){if(r)for(var o in Za){var i=O[o];if(i&&V(i.prototype,t))try{delete i.prototype[t]}catch(r){try{i.prototype[t]=e}catch(t){}}}za[t]&&!r||de(za,t,r?e:Va&&Na[t]||e,n)}},exportTypedArrayStaticMethod:function(t,e,r){var n,o;if(gt){if(fr){if(r)for(n in Za)if((o=O[n])&&V(o,t))try{delete o[t]}catch(t){}if(Wa[t]&&!r)return;try{return de(Wa,t,r?e:Va&&Wa[t]||e)}catch(t){}}for(n in Za)!(o=O[n])||o[t]&&!r||de(o,t,e)}},getTypedArrayConstructor:$a,isView:function(t){if(!xt(t))return!1;var e=xe(t);return"DataView"===e||V(Za,e)||V(Ya,e)},isTypedArray:Ka,TypedArray:Wa,TypedArrayPrototype:za},Xa=Qa.NATIVE_ARRAY_BUFFER_VIEWS,Ja=O.ArrayBuffer,tu=O.Int8Array,eu=!Xa||!j((function(){tu(1)}))||!j((function(){new tu(-1)}))||!_o((function(t){new tu,new tu(null),new tu(1.5),new tu(t)}),!0)||j((function(){return 1!==new tu(new Ja(2),1,void 0).length})),ru=function(t,e,r){for(var n in e)de(t,n,e[n],r);return t},nu=RangeError,ou=function(t){if(void 0===t)return 0;var e=Le(t),r=Fe(e);if(e!==r)throw nu("Wrong length or index");return r},iu=Array,au=Math.abs,uu=Math.pow,su=Math.floor,cu=Math.log,fu=Math.LN2,lu=function(t,e,r){var n,o,i,a=iu(r),u=8*r-e-1,s=(1<<u)-1,c=s>>1,f=23===e?uu(2,-24)-uu(2,-77):0,l=t<0||0===t&&1/t<0?1:0,h=0;for((t=au(t))!=t||t===1/0?(o=t!=t?1:0,n=s):(n=su(cu(t)/fu),t*(i=uu(2,-n))<1&&(n--,i*=2),(t+=n+c>=1?f/i:f*uu(2,1-c))*i>=2&&(n++,i/=2),n+c>=s?(o=0,n=s):n+c>=1?(o=(t*i-1)*uu(2,e),n+=c):(o=t*uu(2,c-1)*uu(2,e),n=0));e>=8;)a[h++]=255&o,o/=256,e-=8;for(n=n<<e|o,u+=e;u>0;)a[h++]=255&n,n/=256,u-=8;return a[--h]|=128*l,a},hu=function(t,e){var r,n=t.length,o=8*n-e-1,i=(1<<o)-1,a=i>>1,u=o-7,s=n-1,c=t[s--],f=127&c;for(c>>=7;u>0;)f=256*f+t[s--],u-=8;for(r=f&(1<<-u)-1,f>>=-u,u+=e;u>0;)r=256*r+t[s--],u-=8;if(0===f)f=1-a;else{if(f===i)return r?NaN:c?-1/0:1/0;r+=uu(2,e),f-=a}return(c?-1:1)*r*uu(2,f-e)},pu=function(t){for(var e=G(this),r=We(e),n=arguments.length,o=Ne(n>1?arguments[1]:void 0,r),i=n>2?arguments[2]:void 0,a=void 0===i?r:Ne(i,r);a>o;)e[o++]=t;return e},vu=Array,du=Math.max,yu=function(t,e,r){for(var n=We(t),o=Ne(e,n),i=Ne(void 0===r?n:r,n),a=vu(du(i-o,0)),u=0;o<i;o++,u++)Ii(a,u,t[o]);return a.length=u,a},gu=Ze.f,mu=qt.f,xu=Kt.PROPER,bu=Kt.CONFIGURABLE,wu=pe.get,Eu=pe.set,Au=O.ArrayBuffer,Ou=Au,Su=Ou&&Ou.prototype,Tu=O.DataView,ku=Tu&&Tu.prototype,Iu=Object.prototype,ju=O.Array,Pu=O.RangeError,_u=F(pu),Mu=F([].reverse),Lu=lu,Ru=hu,Cu=function(t){return[255&t]},Nu=function(t){return[255&t,t>>8&255]},Du=function(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]},Fu=function(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]},Wu=function(t){return Lu(t,23,4)},zu=function(t){return Lu(t,52,8)},Bu=function(t,e){mu(t.prototype,e,{get:function(){return wu(this)[e]}})},Uu=function(t,e,r,n){var o=ou(r),i=wu(t);if(o+e>i.byteLength)throw Pu("Wrong index");var a=wu(i.buffer).bytes,u=o+i.byteOffset,s=yu(a,u,u+e);return n?s:Mu(s)},Gu=function(t,e,r,n,o,i){var a=ou(r),u=wu(t);if(a+e>u.byteLength)throw Pu("Wrong index");for(var s=wu(u.buffer).bytes,c=a+u.byteOffset,f=n(+o),l=0;l<e;l++)s[c+l]=f[i?l:e-l-1]};if(_a){var Hu=xu&&"ArrayBuffer"!==Au.name;if(j((function(){Au(1)}))&&j((function(){new Au(-1)}))&&!j((function(){return new Au,new Au(1.5),new Au(NaN),1!=Au.length||Hu&&!bu})))Hu&&bu&&ie(Au,"name","ArrayBuffer");else{(Ou=function(t){return gr(this,Su),new Au(ou(t))}).prototype=Su;for(var Vu,qu=gu(Au),Zu=0;qu.length>Zu;)(Vu=qu[Zu++])in Ou||ie(Ou,Vu,Au[Vu]);Su.constructor=Ou}fr&&ca(ku)!==Iu&&fr(ku,Iu);var Yu=new Tu(new Ou(2)),$u=F(ku.setInt8);Yu.setInt8(0,2147483648),Yu.setInt8(1,2147483649),!Yu.getInt8(0)&&Yu.getInt8(1)||ru(ku,{setInt8:function(t,e){$u(this,t,e<<24>>24)},setUint8:function(t,e){$u(this,t,e<<24>>24)}},{unsafe:!0})}else Su=(Ou=function(t){gr(this,Su);var e=ou(t);Eu(this,{bytes:_u(ju(e),0),byteLength:e}),gt||(this.byteLength=e)}).prototype,ku=(Tu=function(t,e,r){gr(this,ku),gr(t,Su);var n=wu(t).byteLength,o=Le(e);if(o<0||o>n)throw Pu("Wrong offset");if(o+(r=void 0===r?n-o:Fe(r))>n)throw Pu("Wrong length");Eu(this,{buffer:t,byteLength:r,byteOffset:o}),gt||(this.buffer=t,this.byteLength=r,this.byteOffset=o)}).prototype,gt&&(Bu(Ou,"byteLength"),Bu(Tu,"buffer"),Bu(Tu,"byteLength"),Bu(Tu,"byteOffset")),ru(ku,{getInt8:function(t){return Uu(this,1,t)[0]<<24>>24},getUint8:function(t){return Uu(this,1,t)[0]},getInt16:function(t){var e=Uu(this,2,t,arguments.length>1?arguments[1]:void 0);return(e[1]<<8|e[0])<<16>>16},getUint16:function(t){var e=Uu(this,2,t,arguments.length>1?arguments[1]:void 0);return e[1]<<8|e[0]},getInt32:function(t){return Fu(Uu(this,4,t,arguments.length>1?arguments[1]:void 0))},getUint32:function(t){return Fu(Uu(this,4,t,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(t){return Ru(Uu(this,4,t,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(t){return Ru(Uu(this,8,t,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(t,e){Gu(this,1,t,Cu,e)},setUint8:function(t,e){Gu(this,1,t,Cu,e)},setInt16:function(t,e){Gu(this,2,t,Nu,e,arguments.length>2?arguments[2]:void 0)},setUint16:function(t,e){Gu(this,2,t,Nu,e,arguments.length>2?arguments[2]:void 0)},setInt32:function(t,e){Gu(this,4,t,Du,e,arguments.length>2?arguments[2]:void 0)},setUint32:function(t,e){Gu(this,4,t,Du,e,arguments.length>2?arguments[2]:void 0)},setFloat32:function(t,e){Gu(this,4,t,Wu,e,arguments.length>2?arguments[2]:void 0)},setFloat64:function(t,e){Gu(this,8,t,zu,e,arguments.length>2?arguments[2]:void 0)}});pr(Ou,"ArrayBuffer"),pr(Tu,"DataView");var Ku={ArrayBuffer:Ou,DataView:Tu},Qu=Math.floor,Xu=Number.isInteger||function(t){return!xt(t)&&isFinite(t)&&Qu(t)===t},Ju=RangeError,ts=RangeError,es=function(t,e){var r=function(t){var e=Le(t);if(e<0)throw Ju("The argument can\'t be less than 0");return e}(t);if(r%e)throw ts("Wrong offset");return r},rs=F("".slice),ns=function(t){return"Big"===rs(xe(t),0,3)},os=TypeError,is=function(t){var e=Bt(t,"number");if("number"==typeof e)throw os("Can\'t convert number to bigint");return BigInt(e)},as=Qa.aTypedArrayConstructor,us=function(t){var e,r,n,o,i,a,u,s,c=Mr(this),f=G(t),l=arguments.length,h=l>1?arguments[1]:void 0,p=void 0!==h,v=xo(f);if(v&&!go(v))for(s=(u=wo(f,v)).next,f=[];!(a=jt(s,u)).done;)f.push(a.value);for(p&&l>2&&(h=zr(h,arguments[2])),r=We(f),n=new(as(c))(r),o=ns(n),e=0;r>e;e++)i=p?h(f[e],e):f[e],n[e]=o?is(i):+i;return n},ss=function(t,e,r){var n,o;return fr&&J(n=e.constructor)&&n!==r&&xt(o=n.prototype)&&o!==r.prototype&&fr(t,o),t},cs=b((function(t){var e=Ze.f,r=Ei.forEach,n=pe.get,o=pe.set,i=pe.enforce,a=qt.f,u=je.f,s=Math.round,c=O.RangeError,f=Ku.ArrayBuffer,l=f.prototype,h=Ku.DataView,p=Qa.NATIVE_ARRAY_BUFFER_VIEWS,v=Qa.TYPED_ARRAY_TAG,d=Qa.TypedArray,y=Qa.TypedArrayPrototype,g=Qa.aTypedArrayConstructor,m=Qa.isTypedArray,x=function(t,e){g(t);for(var r=0,n=e.length,o=new t(n);n>r;)o[r]=e[r++];return o},b=function(t,e){a(t,e,{get:function(){return n(this)[e]}})},w=function(t){var e;return Pt(l,t)||"ArrayBuffer"==(e=xe(t))||"SharedArrayBuffer"==e},E=function(t,e){return m(t)&&!Mt(e)&&e in t&&Xu(+e)&&e>=0},A=function(t,e){return e=Ut(e),E(t,e)?oe(2,t[e]):u(t,e)},S=function(t,e,r){return e=Ut(e),!(E(t,e)&&xt(r)&&V(r,"value"))||V(r,"get")||V(r,"set")||r.configurable||V(r,"writable")&&!r.writable||V(r,"enumerable")&&!r.enumerable?a(t,e,r):(t[e]=r.value,t)};gt?(p||(je.f=A,qt.f=S,b(y,"buffer"),b(y,"byteOffset"),b(y,"byteLength"),b(y,"length")),ar({target:"Object",stat:!0,forced:!p},{getOwnPropertyDescriptor:A,defineProperty:S}),t.exports=function(t,u,l){var g=t.match(/\\d+$/)[0]/8,b=t+(l?"Clamped":"")+"Array",E="get"+t,A="set"+t,S=O[b],T=S,k=T&&T.prototype,I={},j=function(t,e){a(t,e,{get:function(){return function(t,e){var r=n(t);return r.view[E](e*g+r.byteOffset,!0)}(this,e)},set:function(t){return function(t,e,r){var o=n(t);l&&(r=(r=s(r))<0?0:r>255?255:255&r),o.view[A](e*g+o.byteOffset,r,!0)}(this,e,t)},enumerable:!0})};p?eu&&(T=u((function(t,e,r,n){return gr(t,k),ss(xt(e)?w(e)?void 0!==n?new S(e,es(r,g),n):void 0!==r?new S(e,es(r,g)):new S(e):m(e)?x(T,e):jt(us,T,e):new S(ou(e)),t,T)})),fr&&fr(T,d),r(e(S),(function(t){t in T||ie(T,t,S[t])})),T.prototype=k):(T=u((function(t,e,r,n){gr(t,k);var i,a,u,s=0,l=0;if(xt(e)){if(!w(e))return m(e)?x(T,e):jt(us,T,e);i=e,l=es(r,g);var p=e.byteLength;if(void 0===n){if(p%g)throw c("Wrong length");if((a=p-l)<0)throw c("Wrong length")}else if((a=Fe(n)*g)+l>p)throw c("Wrong length");u=a/g}else u=ou(e),i=new f(a=u*g);for(o(t,{buffer:i,byteOffset:l,byteLength:a,length:u,view:new h(i)});s<u;)j(t,s++)})),fr&&fr(T,d),k=T.prototype=Qi(y)),k.constructor!==T&&ie(k,"constructor",T),i(k).TypedArrayConstructor=T,v&&ie(k,v,b);var P=T!=S;I[b]=T,ar({global:!0,constructor:!0,forced:P,sham:!p},I),"BYTES_PER_ELEMENT"in T||ie(T,"BYTES_PER_ELEMENT",g),"BYTES_PER_ELEMENT"in k||ie(k,"BYTES_PER_ELEMENT",g),dr(b)}):t.exports=function(){}}));cs("Uint8",(function(t){return function(e,r,n){return t(this,e,r,n)}}),!0);var fs=TypeError,ls=function(t,e){if(!delete t[e])throw fs("Cannot delete property "+Rt(e)+" of "+Rt(t))},hs=Math.min,ps=F([].copyWithin||function(t,e){var r=G(this),n=We(r),o=Ne(t,n),i=Ne(e,n),a=arguments.length>2?arguments[2]:void 0,u=hs((void 0===a?n:Ne(a,n))-i,n-o),s=1;for(i<o&&o<i+u&&(s=-1,i+=u-1,o+=u-1);u-- >0;)i in r?r[o]=r[i]:ls(r,o),o+=s,i+=s;return r}),vs=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("copyWithin",(function(t,e){return ps(vs(this),t,e,arguments.length>2?arguments[2]:void 0)}));var ds=Ei.every,ys=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("every",(function(t){return ds(ys(this),t,arguments.length>1?arguments[1]:void 0)}));var gs=Qa.aTypedArray,ms=Qa.exportTypedArrayMethod,xs=F("".slice);ms("fill",(function(t){var e=arguments.length;gs(this);var r="Big"===xs(xe(this),0,3)?is(t):+t;return jt(pu,this,r,e>1?arguments[1]:void 0,e>2?arguments[2]:void 0)}),j((function(){var t=0;return new Int8Array(2).fill({valueOf:function(){return t++}}),1!==t})));var bs=Qa.aTypedArrayConstructor,ws=Qa.getTypedArrayConstructor,Es=function(t){return bs(Rr(t,ws(t)))},As=function(t,e){return function(t,e){for(var r=0,n=We(e),o=new t(n);n>r;)o[r]=e[r++];return o}(Es(t),e)},Os=Ei.filter,Ss=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("filter",(function(t){var e=Os(Ss(this),t,arguments.length>1?arguments[1]:void 0);return As(this,e)}));var Ts=Ei.find,ks=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("find",(function(t){return Ts(ks(this),t,arguments.length>1?arguments[1]:void 0)}));var Is=Ei.findIndex,js=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("findIndex",(function(t){return Is(js(this),t,arguments.length>1?arguments[1]:void 0)}));var Ps=Ei.forEach,_s=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("forEach",(function(t){Ps(_s(this),t,arguments.length>1?arguments[1]:void 0)}));var Ms=Be.includes,Ls=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("includes",(function(t){return Ms(Ls(this),t,arguments.length>1?arguments[1]:void 0)}));var Rs=Be.indexOf,Cs=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("indexOf",(function(t){return Rs(Cs(this),t,arguments.length>1?arguments[1]:void 0)}));var Ns=vt("iterator"),Ds=O.Uint8Array,Fs=F(Ta.values),Ws=F(Ta.keys),zs=F(Ta.entries),Bs=Qa.aTypedArray,Us=Qa.exportTypedArrayMethod,Gs=Ds&&Ds.prototype,Hs=!j((function(){Gs[Ns].call([1])})),Vs=!!Gs&&Gs.values&&Gs[Ns]===Gs.values&&"values"===Gs.values.name,qs=function(){return Fs(Bs(this))};Us("entries",(function(){return zs(Bs(this))}),Hs),Us("keys",(function(){return Ws(Bs(this))}),Hs),Us("values",qs,Hs||!Vs,{name:"values"}),Us(Ns,qs,Hs||!Vs,{name:"values"});var Zs=Qa.aTypedArray,Ys=Qa.exportTypedArrayMethod,$s=F([].join);Ys("join",(function(t){return $s(Zs(this),t)}));var Ks=Math.min,Qs=[].lastIndexOf,Xs=!!Qs&&1/[1].lastIndexOf(1,-0)<0,Js=Ai("lastIndexOf"),tc=Xs||!Js?function(t){if(Xs)return Fr(Qs,this,arguments)||0;var e=ke(this),r=We(e),n=r-1;for(arguments.length>1&&(n=Ks(n,Le(arguments[1]))),n<0&&(n=r+n);n>=0;n--)if(n in e&&e[n]===t)return n||0;return-1}:Qs,ec=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("lastIndexOf",(function(t){var e=arguments.length;return Fr(tc,ec(this),e>1?[t,arguments[1]]:[t])}));var rc=Ei.map,nc=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("map",(function(t){return rc(nc(this),t,arguments.length>1?arguments[1]:void 0,(function(t,e){return new(Es(t))(e)}))}));var oc=TypeError,ic=function(t){return function(e,r,n,o){Nt(r);var i=G(e),a=Te(i),u=We(i),s=t?u-1:0,c=t?-1:1;if(n<2)for(;;){if(s in a){o=a[s],s+=c;break}if(s+=c,t?s<0:u<=s)throw oc("Reduce of empty array with no initial value")}for(;t?s>=0:u>s;s+=c)s in a&&(o=r(o,a[s],s,i));return o}},ac={left:ic(!1),right:ic(!0)},uc=ac.left,sc=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("reduce",(function(t){var e=arguments.length;return uc(sc(this),t,e,e>1?arguments[1]:void 0)}));var cc=ac.right,fc=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("reduceRight",(function(t){var e=arguments.length;return cc(fc(this),t,e,e>1?arguments[1]:void 0)}));var lc=Qa.aTypedArray,hc=Qa.exportTypedArrayMethod,pc=Math.floor;hc("reverse",(function(){for(var t,e=lc(this).length,r=pc(e/2),n=0;n<r;)t=this[n],this[n++]=this[--e],this[e]=t;return this}));var vc=O.RangeError,dc=O.Int8Array,yc=dc&&dc.prototype,gc=yc&&yc.set,mc=Qa.aTypedArray,xc=Qa.exportTypedArrayMethod,bc=!j((function(){var t=new Uint8ClampedArray(2);return jt(gc,t,{length:1,0:3},1),3!==t[1]})),wc=bc&&Qa.NATIVE_ARRAY_BUFFER_VIEWS&&j((function(){var t=new dc(2);return t.set(1),t.set("2",1),0!==t[0]||2!==t[1]}));xc("set",(function(t){mc(this);var e=es(arguments.length>1?arguments[1]:void 0,1),r=G(t);if(bc)return jt(gc,this,r,e);var n=this.length,o=We(r),i=0;if(o+e>n)throw vc("Wrong length");for(;i<o;)this[e+i]=r[i++]}),!bc||wc);var Ec=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("slice",(function(t,e){for(var r=Ur(Ec(this),t,e),n=Es(this),o=0,i=r.length,a=new n(i);i>o;)a[o]=r[o++];return a}),j((function(){new Int8Array(1).slice()})));var Ac=Ei.some,Oc=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("some",(function(t){return Ac(Oc(this),t,arguments.length>1?arguments[1]:void 0)}));var Sc=Math.floor,Tc=function(t,e){var r=t.length,n=Sc(r/2);return r<8?kc(t,e):Ic(t,Tc(yu(t,0,n),e),Tc(yu(t,n),e),e)},kc=function(t,e){for(var r,n,o=t.length,i=1;i<o;){for(n=i,r=t[i];n&&e(t[n-1],r)>0;)t[n]=t[--n];n!==i++&&(t[n]=r)}return t},Ic=function(t,e,r,n){for(var o=e.length,i=r.length,a=0,u=0;a<o||u<i;)t[a+u]=a<o&&u<i?n(e[a],r[u])<=0?e[a++]:r[u++]:a<o?e[a++]:r[u++];return t},jc=Tc,Pc=rt.match(/firefox\\/(\\d+)/i),_c=!!Pc&&+Pc[1],Mc=/MSIE|Trident/.test(rt),Lc=rt.match(/AppleWebKit\\/(\\d+)\\./),Rc=!!Lc&&+Lc[1],Cc=Qa.aTypedArray,Nc=Qa.exportTypedArrayMethod,Dc=O.Uint16Array,Fc=Dc&&F(Dc.prototype.sort),Wc=!(!Fc||j((function(){Fc(new Dc(2),null)}))&&j((function(){Fc(new Dc(2),{})}))),zc=!!Fc&&!j((function(){if(ut)return ut<74;if(_c)return _c<67;if(Mc)return!0;if(Rc)return Rc<602;var t,e,r=new Dc(516),n=Array(516);for(t=0;t<516;t++)e=t%4,r[t]=515-t,n[t]=t-2*e+3;for(Fc(r,(function(t,e){return(t/4|0)-(e/4|0)})),t=0;t<516;t++)if(r[t]!==n[t])return!0}));Nc("sort",(function(t){return void 0!==t&&Nt(t),zc?Fc(this,t):jc(Cc(this),function(t){return function(e,r){return void 0!==t?+t(e,r)||0:r!=r?-1:e!=e?1:0===e&&0===r?1/e>0&&1/r<0?1:-1:e>r}}(t))}),!zc||Wc);var Bc=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("subarray",(function(t,e){var r=Bc(this),n=r.length,o=Ne(t,n);return new(Es(r))(r.buffer,r.byteOffset+o*r.BYTES_PER_ELEMENT,Fe((void 0===e?n:Ne(e,n))-o))}));var Uc=O.Int8Array,Gc=Qa.aTypedArray,Hc=Qa.exportTypedArrayMethod,Vc=[].toLocaleString,qc=!!Uc&&j((function(){Vc.call(new Uc(1))}));Hc("toLocaleString",(function(){return Fr(Vc,qc?Ur(Gc(this)):Gc(this),Ur(arguments))}),j((function(){return[1,2].toLocaleString()!=new Uc([1,2]).toLocaleString()}))||!j((function(){Uc.prototype.toLocaleString.call([1,2])})));var Zc=Qa.exportTypedArrayMethod,Yc=O.Uint8Array,$c=Yc&&Yc.prototype||{},Kc=[].toString,Qc=F([].join);j((function(){Kc.call({})}))&&(Kc=function(){return Qc(this)});var Xc=$c.toString!=Kc;Zc("toString",Kc,Xc);var Jc,tf,ef=String,rf=function(t){if("Symbol"===xe(t))throw TypeError("Cannot convert a Symbol value to a string");return ef(t)},nf=function(){var t=kt(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e},of=O.RegExp,af=j((function(){var t=of("a","y");return t.lastIndex=2,null!=t.exec("abcd")})),uf=af||j((function(){return!of("a","y").sticky})),sf={BROKEN_CARET:af||j((function(){var t=of("^r","gy");return t.lastIndex=2,null!=t.exec("str")})),MISSED_STICKY:uf,UNSUPPORTED_Y:af},cf=O.RegExp,ff=j((function(){var t=cf(".","s");return!(t.dotAll&&t.exec("\\n")&&"s"===t.flags)})),lf=O.RegExp,hf=j((function(){var t=lf("(?<a>b)","g");return"b"!==t.exec("b").groups.a||"bc"!=="b".replace(t,"$<a>c")})),pf=pe.get,vf=I("native-string-replace",String.prototype.replace),df=RegExp.prototype.exec,yf=df,gf=F("".charAt),mf=F("".indexOf),xf=F("".replace),bf=F("".slice),wf=(tf=/b*/g,jt(df,Jc=/a/,"a"),jt(df,tf,"a"),0!==Jc.lastIndex||0!==tf.lastIndex),Ef=sf.BROKEN_CARET,Af=void 0!==/()??/.exec("")[1];(wf||Af||Ef||ff||hf)&&(yf=function(t){var e,r,n,o,i,a,u,s=this,c=pf(s),f=rf(t),l=c.raw;if(l)return l.lastIndex=s.lastIndex,e=jt(yf,l,f),s.lastIndex=l.lastIndex,e;var h=c.groups,p=Ef&&s.sticky,v=jt(nf,s),d=s.source,y=0,g=f;if(p&&(v=xf(v,"y",""),-1===mf(v,"g")&&(v+="g"),g=bf(f,s.lastIndex),s.lastIndex>0&&(!s.multiline||s.multiline&&"\\n"!==gf(f,s.lastIndex-1))&&(d="(?: "+d+")",g=" "+g,y++),r=new RegExp("^(?:"+d+")",v)),Af&&(r=new RegExp("^"+d+"$(?!\\\\s)",v)),wf&&(n=s.lastIndex),o=jt(df,p?r:s,g),p?o?(o.input=bf(o.input,y),o[0]=bf(o[0],y),o.index=s.lastIndex,s.lastIndex+=o[0].length):s.lastIndex=0:wf&&o&&(s.lastIndex=s.global?o.index+o[0].length:n),Af&&o&&o.length>1&&jt(vf,o[0],r,(function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(o[i]=void 0)})),o&&h)for(o.groups=a=Qi(null),i=0;i<h.length;i++)a[(u=h[i])[0]]=o[u[1]];return o});var Of=yf;ar({target:"RegExp",proto:!0,forced:/./.exec!==Of},{exec:Of});var Sf,Tf=vt("species"),kf=RegExp.prototype,If=function(t,e,r,n){var o=vt(t),i=!j((function(){var e={};return e[o]=function(){return 7},7!=""[t](e)})),a=i&&!j((function(){var e=!1,r=/a/;return"split"===t&&((r={}).constructor={},r.constructor[Tf]=function(){return r},r.flags="",r[o]=/./[o]),r.exec=function(){return e=!0,null},r[o](""),!e}));if(!i||!a||r){var u=F(/./[o]),s=e(o,""[t],(function(t,e,r,n,o){var a=F(t),s=e.exec;return s===Of||s===kf.exec?i&&!o?{done:!0,value:u(e,r,n)}:{done:!0,value:a(r,e,n)}:{done:!1}}));de(String.prototype,t,s[0]),de(kf,o,s[1])}n&&ie(kf[o],"sham",!0)},jf=F("".charAt),Pf=F("".charCodeAt),_f=F("".slice),Mf=function(t){return function(e,r){var n,o,i=rf(B(e)),a=Le(r),u=i.length;return a<0||a>=u?t?"":void 0:(n=Pf(i,a))<55296||n>56319||a+1===u||(o=Pf(i,a+1))<56320||o>57343?t?jf(i,a):n:t?_f(i,a,a+2):o-56320+(n-55296<<10)+65536}},Lf={codeAt:Mf(!1),charAt:Mf(!0)},Rf=Lf.charAt,Cf=function(t,e,r){return e+(r?Rf(t,e).length:1)},Nf=Math.floor,Df=F("".charAt),Ff=F("".replace),Wf=F("".slice),zf=/\\$([$&\'`]|\\d{1,2}|<[^>]*>)/g,Bf=/\\$([$&\'`]|\\d{1,2})/g,Uf=function(t,e,r,n,o,i){var a=r+t.length,u=n.length,s=Bf;return void 0!==o&&(o=G(o),s=zf),Ff(i,s,(function(i,s){var c;switch(Df(s,0)){case"$":return"$";case"&":return t;case"`":return Wf(e,0,r);case"\'":return Wf(e,a);case"<":c=o[Wf(s,1,-1)];break;default:var f=+s;if(0===f)return i;if(f>u){var l=Nf(f/10);return 0===l?i:l<=u?void 0===n[l-1]?Df(s,1):n[l-1]+Df(s,1):i}c=n[f-1]}return void 0===c?"":c}))},Gf=TypeError,Hf=function(t,e){var r=t.exec;if(J(r)){var n=jt(r,t,e);return null!==n&&kt(n),n}if("RegExp"===D(t))return jt(Of,t,e);throw Gf("RegExp#exec called on incompatible receiver")},Vf=vt("replace"),qf=Math.max,Zf=Math.min,Yf=F([].concat),$f=F([].push),Kf=F("".indexOf),Qf=F("".slice),Xf="$0"==="a".replace(/./,"$0"),Jf=!!/./[Vf]&&""===/./[Vf]("a","$0");function tl(t){this.message=t}If("replace",(function(t,e,r){var n=Jf?"$":"$0";return[function(t,r){var n=B(this),o=W(t)?void 0:Dt(t,Vf);return o?jt(o,t,n,r):jt(e,rf(n),t,r)},function(t,o){var i=kt(this),a=rf(t);if("string"==typeof o&&-1===Kf(o,n)&&-1===Kf(o,"$<")){var u=r(e,i,a,o);if(u.done)return u.value}var s=J(o);s||(o=rf(o));var c=i.global;if(c){var f=i.unicode;i.lastIndex=0}for(var l=[];;){var h=Hf(i,a);if(null===h)break;if($f(l,h),!c)break;""===rf(h[0])&&(i.lastIndex=Cf(a,Fe(i.lastIndex),f))}for(var p,v="",d=0,y=0;y<l.length;y++){for(var g=rf((h=l[y])[0]),m=qf(Zf(Le(h.index),a.length),0),x=[],b=1;b<h.length;b++)$f(x,void 0===(p=h[b])?p:String(p));var w=h.groups;if(s){var E=Yf([g],x,m,a);void 0!==w&&$f(E,w);var A=rf(Fr(o,void 0,E))}else A=Uf(g,a,m,x,w,o);m>=d&&(v+=Qf(a,d,m)+A,d=m+g.length)}return v+Qf(a,d)}]}),!!j((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")}))||!Xf||Jf),tl.prototype=new Error,tl.prototype.name="InvalidCharacterError",ar({global:!0,forced:O.globalThis!==O},{globalThis:O}),Sf="undefined"==typeof window?{devicePixelRatio:1,navigator:{userAgent:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.69 Safari/537.36",browserLanguage:"zh-CN",language:"zh-CN",platform:""},location:"",document:{documentElement:{style:{}},createEvent:function(){return!0},getElementById:function(t){return!0},createElement:function(){return{className:"",classList:{add:function(){return""}}}},createElementNS:function(){return!0},addEventListener:function(){return!0},removeEventListener:function(){return!0},querySelector:function(){return!1}},performance:{mark:function(t){return null},clearMeasures:function(t){return null},clearMarks:function(t){return null},measure:function(t,e,r){return{duration:0}},now:function(){return(new Date).getTime()}},Blob:"",dispatchEvent:function(t){return!0},Event:function(t,e){return!0},createElement:function(){return!0},createElementNS:function(){return!0},XMLHttpRequest:function(){return!0},addEventListener:function(){return!0},removeEventListener:function(){return!0},requestAnimationFrame:function(){return!0},cancelAnimationFrame:function(){return!0},clearTimeout:function(){return!0}}:window,"undefined"!=typeof my&&!!my&&"function"==typeof my.showToast&&!0!==my.isFRM?my.getSystemInfoSync().pixelRatio:Sf.devicePixelRatio;var el=TypeError,rl=Object.getOwnPropertyDescriptor,nl=gt&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}()?function(t,e){if(yi(t)&&!rl(t,"length").writable)throw el("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e},ol=TypeError,il=function(t){if(t>9007199254740991)throw ol("Maximum allowed index exceeded");return t},al=Pi("splice"),ul=Math.max,sl=Math.min;ar({target:"Array",proto:!0,forced:!al},{splice:function(t,e){var r,n,o,i,a,u,s=G(this),c=We(s),f=Ne(t,c),l=arguments.length;for(0===l?r=n=0:1===l?(r=0,n=c-f):(r=l-2,n=sl(ul(Le(e),0),c-f)),il(c+r-n),o=xi(s,n),i=0;i<n;i++)(a=f+i)in s&&Ii(o,i,s[a]);if(o.length=n,r<n){for(i=f;i<c-n;i++)u=i+r,(a=i+n)in s?s[u]=s[a]:ls(s,u);for(i=c;i>c-n+r;i--)ls(s,i-1)}else if(r>n)for(i=c-n;i>f;i--)u=i+r-1,(a=i+n-1)in s?s[u]=s[a]:ls(s,u);for(i=0;i<r;i++)s[i+f]=arguments[i+2];return nl(s,c-n+r),o}});var cl=u((function t(e,r){i(this,t),s(this,"cancelBubble",void 0),s(this,"cancelable",void 0),s(this,"target",void 0),s(this,"currentTarget",void 0),s(this,"preventDefault",void 0),s(this,"stopPropagation",void 0),s(this,"type",void 0),s(this,"timeStamp",void 0),this.cancelBubble=!1,this.cancelable=!1,this.target=null,this.currentTarget=null,this.preventDefault=function(){},this.stopPropagation=function(){},this.type=e,this.timeStamp=Date.now()})),fl=Object.assign,ll=Object.defineProperty,hl=F([].concat),pl=!fl||j((function(){if(gt&&1!==fl({b:1},fl(ll({},"a",{enumerable:!0,get:function(){ll(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var t={},e={},r=Symbol();return t[r]=7,"abcdefghijklmnopqrst".split("").forEach((function(t){e[t]=t})),7!=fl({},t)[r]||"abcdefghijklmnopqrst"!=Hi(fl({},e)).join("")}))?function(t,e){for(var r=G(t),n=arguments.length,o=1,i=Ye.f,a=Ae.f;n>o;)for(var u,s=Te(arguments[o++]),c=i?hl(Hi(s),i(s)):Hi(s),f=c.length,l=0;f>l;)u=c[l++],gt&&!jt(a,s,u)||(r[u]=s[u]);return r}:fl;ar({target:"Object",stat:!0,arity:2,forced:Object.assign!==pl},{assign:pl});var vl=Ei.findIndex,dl=!0;"findIndex"in[]&&Array(1).findIndex((function(){dl=!1})),ar({target:"Array",proto:!0,forced:dl},{findIndex:function(t){return vl(this,t,arguments.length>1?arguments[1]:void 0)}}),oa("findIndex");var yl=Lf.charAt,gl=pe.set,ml=pe.getterFor("String Iterator");wa(String,"String",(function(t){gl(this,{type:"String Iterator",string:rf(t),index:0})}),(function(){var t,e=ml(this),r=e.string,n=e.index;return n>=r.length?Ea(void 0,!0):(t=yl(r,n),e.index+=t.length,Ea(t,!1))}));var xl=Ze.f,bl="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],wl={f:function(t){return bl&&"Window"==D(t)?function(t){try{return xl(t)}catch(t){return yu(bl)}}(t):xl(ke(t))}},El=j((function(){if("function"==typeof ArrayBuffer){var t=new ArrayBuffer(8);Object.isExtensible(t)&&Object.defineProperty(t,"a",{value:8})}})),Al=Object.isExtensible,Ol=j((function(){Al(1)}))||El?function(t){return!!xt(t)&&((!El||"ArrayBuffer"!=D(t))&&(!Al||Al(t)))}:Al,Sl=!j((function(){return Object.isExtensible(Object.preventExtensions({}))})),Tl=b((function(t){var e=qt.f,r=!1,n=$("meta"),o=0,i=function(t){e(t,n,{value:{objectID:"O"+o++,weakData:{}}})},a=t.exports={enable:function(){a.enable=function(){},r=!0;var t=Ze.f,e=F([].splice),o={};o[n]=1,t(o).length&&(Ze.f=function(r){for(var o=t(r),i=0,a=o.length;i<a;i++)if(o[i]===n){e(o,i,1);break}return o},ar({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:wl.f}))},fastKey:function(t,e){if(!xt(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!V(t,n)){if(!Ol(t))return"F";if(!e)return"E";i(t)}return t[n].objectID},getWeakData:function(t,e){if(!V(t,n)){if(!Ol(t))return!0;if(!e)return!1;i(t)}return t[n].weakData},onFreeze:function(t){return Sl&&r&&Ol(t)&&!V(t,n)&&i(t),t}};se[n]=!0})),kl=(Tl.enable,Tl.fastKey,Tl.getWeakData,Tl.onFreeze,function(t,e,r){var n=-1!==t.indexOf("Map"),o=-1!==t.indexOf("Weak"),i=n?"set":"add",a=O[t],u=a&&a.prototype,s=a,c={},f=function(t){var e=F(u[t]);de(u,t,"add"==t?function(t){return e(this,0===t?0:t),this}:"delete"==t?function(t){return!(o&&!xt(t))&&e(this,0===t?0:t)}:"get"==t?function(t){return o&&!xt(t)?void 0:e(this,0===t?0:t)}:"has"==t?function(t){return!(o&&!xt(t))&&e(this,0===t?0:t)}:function(t,r){return e(this,0===t?0:t,r),this})};if(or(t,!J(a)||!(o||u.forEach&&!j((function(){(new a).entries().next()})))))s=r.getConstructor(e,t,n,i),Tl.enable();else if(or(t,!0)){var l=new s,h=l[i](o?{}:-0,1)!=l,p=j((function(){l.has(1)})),v=_o((function(t){new a(t)})),d=!o&&j((function(){for(var t=new a,e=5;e--;)t[i](e,e);return!t.has(-0)}));v||((s=e((function(t,e){gr(t,u);var r=ss(new a,t,s);return W(e)||To(e,r[i],{that:r,AS_ENTRIES:n}),r}))).prototype=u,u.constructor=s),(p||d)&&(f("delete"),f("has"),n&&f("get")),(d||h)&&f(i),o&&u.clear&&delete u.clear}return c[t]=s,ar({global:!0,constructor:!0,forced:s!=a},c),pr(s,t),o||r.setStrong(s,t,n),s}),Il=Tl.getWeakData,jl=pe.set,Pl=pe.getterFor,_l=Ei.find,Ml=Ei.findIndex,Ll=F([].splice),Rl=0,Cl=function(t){return t.frozen||(t.frozen=new Nl)},Nl=function(){this.entries=[]},Dl=function(t,e){return _l(t.entries,(function(t){return t[0]===e}))};Nl.prototype={get:function(t){var e=Dl(this,t);if(e)return e[1]},has:function(t){return!!Dl(this,t)},set:function(t,e){var r=Dl(this,t);r?r[1]=e:this.entries.push([t,e])},delete:function(t){var e=Ml(this.entries,(function(e){return e[0]===t}));return~e&&Ll(this.entries,e,1),!!~e}};var Fl,Wl={getConstructor:function(t,e,r,n){var o=t((function(t,o){gr(t,i),jl(t,{type:e,id:Rl++,frozen:void 0}),W(o)||To(o,t[n],{that:t,AS_ENTRIES:r})})),i=o.prototype,a=Pl(e),u=function(t,e,r){var n=a(t),o=Il(kt(e),!0);return!0===o?Cl(n).set(e,r):o[n.id]=r,t};return ru(i,{delete:function(t){var e=a(this);if(!xt(t))return!1;var r=Il(t);return!0===r?Cl(e).delete(t):r&&V(r,e.id)&&delete r[e.id]},has:function(t){var e=a(this);if(!xt(t))return!1;var r=Il(t);return!0===r?Cl(e).has(t):r&&V(r,e.id)}}),ru(i,r?{get:function(t){var e=a(this);if(xt(t)){var r=Il(t);return!0===r?Cl(e).get(t):r?r[e.id]:void 0}},set:function(t,e){return u(this,t,e)}}:{add:function(t){return u(this,t,!0)}}),o}},zl=pe.enforce,Bl=!O.ActiveXObject&&"ActiveXObject"in O,Ul=function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},Gl=kl("WeakMap",Ul,Wl);if(ne&&Bl){Fl=Wl.getConstructor(Ul,"WeakMap",!0),Tl.enable();var Hl=Gl.prototype,Vl=F(Hl.delete),ql=F(Hl.has),Zl=F(Hl.get),Yl=F(Hl.set);ru(Hl,{delete:function(t){if(xt(t)&&!Ol(t)){var e=zl(this);return e.frozen||(e.frozen=new Fl),Vl(this,t)||e.frozen.delete(t)}return Vl(this,t)},has:function(t){if(xt(t)&&!Ol(t)){var e=zl(this);return e.frozen||(e.frozen=new Fl),ql(this,t)||e.frozen.has(t)}return ql(this,t)},get:function(t){if(xt(t)&&!Ol(t)){var e=zl(this);return e.frozen||(e.frozen=new Fl),ql(this,t)?Zl(this,t):e.frozen.get(t)}return Zl(this,t)},set:function(t,e){if(xt(t)&&!Ol(t)){var r=zl(this);r.frozen||(r.frozen=new Fl),ql(this,t)?Yl(this,t,e):r.frozen.set(t,e)}else Yl(this,t,e);return this}})}var $l=vt("iterator"),Kl=vt("toStringTag"),Ql=Ta.values,Xl=function(t,e){if(t){if(t[$l]!==Ql)try{ie(t,$l,Ql)}catch(e){t[$l]=Ql}if(t[Kl]||ie(t,Kl,e),hi[e])for(var r in Ta)if(t[r]!==Ta[r])try{ie(t,r,Ta[r])}catch(e){t[r]=Ta[r]}}};for(var Jl in hi)Xl(O[Jl]&&O[Jl].prototype,Jl);Xl(di,"DOMTokenList");var th,eh,rh,nh,oh=new WeakMap,ih=function(){function t(){i(this,t),oh.set(this,{})}return u(t,[{key:"addEventListener",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=oh.get(this);n||(n={}),n[t]||(n[t]=[]),n[t].push(e),oh.set(this,n),r.capture,r.once,r.passive}},{key:"removeEventListener",value:function(t,e){var r=oh.get(this);if(r){var n=r[t];if(n&&n.length>0)for(var o=n.length;o--;o>0)if(n[o]===e){n.splice(o,1);break}}}},{key:"dispatchEvent",value:function(t){var e=oh.get(this)[t.type];if(e){var r,n=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=g(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}(e);try{for(n.s();!(r=n.n()).done;){(0,r.value)(t)}}catch(t){n.e(t)}finally{n.f()}}}}]),t}(),ah=function(t){c(r,t);var e=v(r);function r(){var t;return i(this,r),s(h(t=e.call(this)),"className",void 0),s(h(t),"children",void 0),t.className="",t.children=[],t}return u(r,[{key:"setAttribute",value:function(t,e){this[t]=e}},{key:"getAttribute",value:function(t){return this[t]}},{key:"setAttributeNS",value:function(t,e){this[t]=e}},{key:"getAttributeNS",value:function(t){return this[t]}}]),r}(function(t){c(r,t);var e=v(r);function r(){var t;return i(this,r),s(h(t=e.call(this)),"childNodes",void 0),t.childNodes=[],t}return u(r,[{key:"appendChild",value:function(t){this.childNodes.push(t)}},{key:"cloneNode",value:function(){var t=Object.create(this);return Object.assign(t,this),t}},{key:"removeChild",value:function(t){var e=this.childNodes.findIndex((function(e){return e===t}));return e>-1?this.childNodes.splice(e,1):null}}]),r}(ih));if("undefined"!=typeof my&&!!my&&"function"==typeof my.showToast&&!0!==my.isFRM){var uh=my.getSystemInfoSync();th=uh.screenWidth,eh=uh.screenHeight,rh=uh.windowWidth,nh=uh.windowHeight}else{var sh=Sf.innerWidth,ch=Sf.innerHeight;th=sh,eh=ch,rh=sh,nh=ch}var fh={width:th,height:eh,availWidth:rh,availHeight:nh,availLeft:0,availTop:0},lh=fh.availWidth,hh=fh.availHeight,ph={style:[]};function vh(t,e){var r,n;"parentNode"in t||(r=0===e?function(){return null}:1===e?function(){return ph}:function(){return null},Object.defineProperty(t,"parentNode",{enumerable:!0,get:r}));"parentElement"in t||(n=0===e?function(){return null}:1===e?function(){return ph}:function(){return null},Object.defineProperty(t,"parentElement",{enumerable:!0,get:n}))}function dh(t){t.style=t.style||{},Object.assign(t.style,{top:"0px",left:"0px",width:lh+"px",height:hh+"px",margin:"0px",padding:"0px"})}function yh(t){"clientLeft"in t||(t.clientLeft=0,t.clientTop=0),"clientWidth"in t||(t.clientWidth=lh,t.clientHeight=hh),"getBoundingClientRect"in t||(t.getBoundingClientRect=function(){return{x:0,y:0,top:0,left:0,width:this.clientWidth,height:this.clientHeight,right:this.clientWidth,bottom:this.clientHeight}})}function gh(t){"offsetLeft"in t||(t.offsetLeft=0,t.offsetTop=0),"offsetWidth"in t||(t.offsetWidth=lh,t.offsetHeight=hh)}function mh(t){"scrollLeft"in t||(t.scrollLeft=0,t.scrollTop=0),"scrollWidth"in t||(t.scrollWidth=lh,t.scrollHeight=hh)}function xh(t){var e=function(){return!0};t.classList=[],t.classList.add=e,t.classList.remove=e,t.classList.contains=e,t.classList.toggle=e}function bh(){}var wh=function(t){c(r,t);var e=v(r);function r(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",o=arguments.length>1?arguments[1]:void 0;return i(this,r),s(h(t=e.call(this)),"className",void 0),s(h(t),"children",void 0),s(h(t),"focus",void 0),s(h(t),"blur",void 0),s(h(t),"insertBefore",void 0),s(h(t),"appendChild",void 0),s(h(t),"removeChild",void 0),s(h(t),"remove",void 0),s(h(t),"innerHTML",void 0),s(h(t),"tagName",void 0),t.className="",t.children=[],t.focus=bh,t.blur=bh,t.insertBefore=bh,t.appendChild=bh,t.removeChild=bh,t.remove=bh,t.innerHTML="",t.tagName=n.toUpperCase(),vh(h(t),o),dh(h(t)),xh(h(t)),yh(h(t)),gh(h(t)),mh(h(t)),t}return u(r)}(ah),Eh=function(t){c(r,t);var e=v(r);function r(){return i(this,r),e.call(this,"video")}return u(r)}(function(t){c(r,t);var e=v(r);function r(t){return i(this,r),e.call(this,t)}return u(r,[{key:"addTextTrack",value:function(){}},{key:"captureStream",value:function(){}},{key:"fastSeek",value:function(){}},{key:"load",value:function(){}},{key:"pause",value:function(){}},{key:"play",value:function(){}}]),r}(wh)),Ah={};function Oh(){return Ah}var Sh=u((function t(){i(this,t);var e=Oh(),r=e.createImage&&e.createImage()||{};return"tagName"in r||(r.tagName="IMG",r.__proto__=t.prototype),vh(r),xh(r),Object.assign(r,{addEventListener:function(t,e){r["on".concat(t)]=e.bind(r)},removeEventListener:function(t){r["on".concat(t)]=null}}),r})),Th={href:"",protocol:"",host:""},kh=function(t){c(r,t);var e=v(r);function r(){return i(this,r),e.call(this,"body",0)}return u(r,[{key:"addEventListener",value:function(t,e){}},{key:"removeEventListener",value:function(t,e,r){}},{key:"dispatchEvent",value:function(t){}}]),r}(wh),Ih=function(t){c(r,t);var e=v(r);function r(){return i(this,r),e.call(this,"html",0)}return u(r,[{key:"addEventListener",value:function(t,e){}},{key:"removeEventListener",value:function(t,e){}},{key:"dispatchEvent",value:function(t){}}]),r}(wh),jh={},Ph={readyState:"complete",visibilityState:"visible",hidden:!1,fullscreen:!0,scripts:[],style:{},location:Th,ontouchstart:null,ontouchmove:null,ontouchend:null,onvisibilitychange:null,parentNode:null,parentElement:null,head:null,body:null,documentElement:{style:[]},createElement:function(t){return"canvas"===(t=t.toLowerCase())?my.createOffscreenCanvas(1024,128,"2d"):"img"===t?new Sh:"video"===t?new Eh:new wh(t)},createElementNS:function(t,e){return this.createElement(e)},createTextNode:function(t){return t},getElementById:function(t){return null},getElementsByTagName:function(t){return t=t.toLowerCase(),[]},getElementsByTagNameNS:function(t,e){return this.getElementsByTagName(e)},getElementsByName:function(t){return[]},querySelector:function(t){return null},querySelectorAll:function(t){return[]},addEventListener:function(t,e,r){jh[t]||(jh[t]=[]),jh[t].push(e)},removeEventListener:function(t,e){var r=jh[t];if(r&&r.length>0)for(var n=r.length;n--;n>0)if(r[n]===e){r.splice(n,1);break}},dispatchEvent:function(t){var e=t.type,r=jh[e];if(r)for(var n=0;n<r.length;n++)r[n](t);t.target&&"function"==typeof t.target["on"+e]&&t.target["on"+e](t)},createEvent:function(t){return new cl(t)}};Ph.documentElement=new Ih,Ph.head=new wh("head"),Ph.body=new kh,If("match",(function(t,e,r){return[function(e){var r=B(this),n=W(e)?void 0:Dt(e,t);return n?jt(n,e,r):new RegExp(e)[t](rf(r))},function(t){var n=kt(this),o=rf(t),i=r(e,n,o);if(i.done)return i.value;if(!n.global)return Hf(n,o);var a=n.unicode;n.lastIndex=0;for(var u,s=[],c=0;null!==(u=Hf(n,o));){var f=rf(u[0]);s[c]=f,""===f&&(n.lastIndex=Cf(o,Fe(n.lastIndex),a)),c++}return 0===c?null:s}]}));var _h,Mh,Lh=vt("isConcatSpreadable"),Rh=ut>=51||!j((function(){var t=[];return t[Lh]=!1,t.concat()[0]!==t})),Ch=Pi("concat"),Nh=function(t){if(!xt(t))return!1;var e=t[Lh];return void 0!==e?!!e:yi(t)};if(ar({target:"Array",proto:!0,arity:1,forced:!Rh||!Ch},{concat:function(t){var e,r,n,o,i,a=G(this),u=xi(a,0),s=0;for(e=-1,n=arguments.length;e<n;e++)if(Nh(i=-1===e?a:arguments[e]))for(o=We(i),il(s+o),r=0;r<o;r++,s++)r in i&&Ii(u,s,i[r]);else il(s+1),Ii(u,s++,i);return u.length=s,u}}),"undefined"!=typeof my&&!!my&&"function"==typeof my.showToast&&!0!==my.isFRM){var Dh=my.getSystemInfoSync();_h=Dh.system,Dh.platform,Dh.language}else{var Fh={versions:(Mh=Sf.navigator.userAgent,{trident:Mh.indexOf("Trident")>-1,presto:Mh.indexOf("Presto")>-1,webKit:Mh.indexOf("AppleWebKit")>-1,gecko:Mh.indexOf("Gecko")>-1&&-1===Mh.indexOf("KHTML"),mobile:!!Mh.match(/AppleWebKit.*Mobile.*/),ios:!!Mh.match(/\\(i[^;]+;( U;)? CPU.+Mac OS X/),android:Mh.indexOf("Android")>-1||Mh.indexOf("Linux")>-1,iPhone:Mh.indexOf("iPhone")>-1,iPad:Mh.indexOf("iPad")>-1,webApp:-1===Mh.indexOf("Safari"),weixin:Mh.indexOf("MicroMessenger")>-1,qq:" qq"===Mh.match(/\\sQQ/i)}),language:(Sf.navigator.browserLanguage||Sf.navigator.language).toLowerCase()};Fh.versions.android?"android":Fh.versions.trident?"IE":Fh.versions.presto?"Opera":Fh.versions.webKit?"webKit":Fh.versions.gecko?"Firefox":Fh.versions.mobile?"mobile":Fh.versions.ios?"ios":Fh.versions.iPhone?"iPhone":Fh.versions.iPad?"ipad":Fh.versions.webApp?"webApp":Fh.versions.weixin?"weixin":Fh.versions.qq&&"qq",_h=Sf.navigator.userAgent,Fh.language}_h.toLowerCase().indexOf("android");cs("Uint8",(function(t){return function(e,r,n){return t(this,e,r,n)}}));var Wh=qt.f,zh=Tl.fastKey,Bh=pe.set,Uh=pe.getterFor;kl("Map",(function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}}),{getConstructor:function(t,e,r,n){var o=t((function(t,o){gr(t,i),Bh(t,{type:e,index:Qi(null),first:void 0,last:void 0,size:0}),gt||(t.size=0),W(o)||To(o,t[n],{that:t,AS_ENTRIES:r})})),i=o.prototype,a=Uh(e),u=function(t,e,r){var n,o,i=a(t),u=s(t,e);return u?u.value=r:(i.last=u={index:o=zh(e,!0),key:e,value:r,previous:n=i.last,next:void 0,removed:!1},i.first||(i.first=u),n&&(n.next=u),gt?i.size++:t.size++,"F"!==o&&(i.index[o]=u)),t},s=function(t,e){var r,n=a(t),o=zh(e);if("F"!==o)return n.index[o];for(r=n.first;r;r=r.next)if(r.key==e)return r};return ru(i,{clear:function(){for(var t=a(this),e=t.index,r=t.first;r;)r.removed=!0,r.previous&&(r.previous=r.previous.next=void 0),delete e[r.index],r=r.next;t.first=t.last=void 0,gt?t.size=0:this.size=0},delete:function(t){var e=a(this),r=s(this,t);if(r){var n=r.next,o=r.previous;delete e.index[r.index],r.removed=!0,o&&(o.next=n),n&&(n.previous=o),e.first==r&&(e.first=n),e.last==r&&(e.last=o),gt?e.size--:this.size--}return!!r},forEach:function(t){for(var e,r=a(this),n=zr(t,arguments.length>1?arguments[1]:void 0);e=e?e.next:r.first;)for(n(e.value,e.key,this);e&&e.removed;)e=e.previous},has:function(t){return!!s(this,t)}}),ru(i,r?{get:function(t){var e=s(this,t);return e&&e.value},set:function(t,e){return u(this,0===t?0:t,e)}}:{add:function(t){return u(this,t=0===t?0:t,t)}}),gt&&Wh(i,"size",{get:function(){return a(this).size}}),o},setStrong:function(t,e,r){var n=e+" Iterator",o=Uh(e),i=Uh(n);wa(t,e,(function(t,e){Bh(this,{type:n,target:t,state:o(t),kind:e,last:void 0})}),(function(){for(var t=i(this),e=t.kind,r=t.last;r&&r.removed;)r=r.previous;return t.target&&(t.last=r=r?r.next:t.state.first)?Ea("keys"==e?r.key:"values"==e?r.value:[r.key,r.value],!1):(t.target=void 0,Ea(void 0,!0))}),r?"entries":"values",!r,!0),dr(e)}});var Gh=F([].join),Hh=Te!=Object,Vh=Ai("join",",");ar({target:"Array",proto:!0,forced:Hh||!Vh},{join:function(t){return Gh(ke(this),void 0===t?",":t)}});var qh=j((function(){Hi(1)}));ar({target:"Object",stat:!0,forced:qh},{keys:function(t){return Hi(G(t))}});var Zh=new Map,Yh=new Map,$h=new Map,Kh=function(t){c(r,t);var e=v(r);function r(){var t;return i(this,r),s(h(t=e.call(this)),"onabort",void 0),s(h(t),"onerror",void 0),s(h(t),"onload",void 0),s(h(t),"onloadstart",void 0),s(h(t),"onprogress",void 0),s(h(t),"ontimeout",void 0),s(h(t),"onloadend",void 0),s(h(t),"onreadystatechange",void 0),s(h(t),"readyState",void 0),s(h(t),"response",void 0),s(h(t),"responseText",void 0),s(h(t),"_responseType",void 0),s(h(t),"responseXML",void 0),s(h(t),"status",void 0),s(h(t),"statusText",void 0),s(h(t),"upload",void 0),s(h(t),"withCredentials",void 0),s(h(t),"timeout",void 0),s(h(t),"_url",void 0),s(h(t),"_method",void 0),t.onabort=null,t.onerror=null,t.onload=null,t.onloadstart=null,t.onprogress=null,t.ontimeout=null,t.onloadend=null,t.onreadystatechange=null,t.readyState=0,t.response=null,t.responseText=null,t._responseType="text",t.responseXML=null,t.status=0,t.statusText="",t.upload={},t.withCredentials=!1,Zh.set("requestHeader",{"content-type":"application/x-www-form-urlencoded"}),t}return u(r,[{key:"responseType",set:function(t){this._responseType=t}},{key:"abort",value:function(){var t=$h.get("requestTask");t&&t.abort()}},{key:"getAllResponseHeaders",value:function(){var t=Yh.get("responseHeader");return Object.keys(t).map((function(e){return"".concat(e,": ").concat(t[e])})).join("\\n")}},{key:"getResponseHeader",value:function(t){return Yh.get("responseHeader")[t]}},{key:"open",value:function(t,e,r){this._method=t,this._url=e}},{key:"overrideMimeType",value:function(){}},{key:"send",value:function(){}},{key:"setRequestHeader",value:function(t,e){var r=Zh.get("requestHeader");r[t]=e,Zh.set("requestHeader",r)}},{key:"addEventListener",value:function(t,e){var r=this;"function"==typeof e&&(this["on"+t]=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.target=t.target||r,e.call(r,t)})}},{key:"removeEventListener",value:function(t,e){this["on"+t]===e&&(this["on"+t]=null)}}]),r}(ih);s(Kh,"UNSEND",void 0),s(Kh,"OPENED",void 0),s(Kh,"HEADERS_RECEIVED",void 0),s(Kh,"LOADING",void 0),s(Kh,"DONE",void 0),Kh.UNSEND=0,Kh.OPENED=1,Kh.HEADERS_RECEIVED=2,Kh.LOADING=3,Kh.DONE=4;var Qh="undefined"!=typeof my&&!!my&&"function"==typeof my.showToast&&!0!==my.isFRM,Xh="undefined"!=typeof wx&&null!==wx&&(void 0!==wx.request||void 0!==wx.miniProgram),Jh=Qh||Xh;Jh||Sf.XMLHttpRequest,Jh||Sf.location;function tp(t){return[t+1&255,t+1>>8&255,t+1>>8>>8&255]}var ep=Ei.filter,rp=Pi("filter");function np(t){var e=t.color;return e&&e.length?e:[1,1,1,1]}function op(t,e,r){return 2===r.length?[r[0],r[1],0]:[r[0],r[1],r[2]]}function ip(t){return t.filter?[1]:[0]}function ap(t,e){return[e]}ar({target:"Array",proto:!0,forced:!rp},{filter:function(t){return ep(this,t,arguments.length>1?arguments[1]:void 0)}});var up=cp,sp=cp;function cp(t,e,r){r=r||2;var n,o,i,a,u,s,c,f=e&&e.length,l=f?e[0]*r:t.length,h=fp(t,0,l,r,!0),p=[];if(!h||h.next===h.prev)return p;if(f&&(h=function(t,e,r,n){var o,i,a,u,s,c=[];for(o=0,i=e.length;o<i;o++)a=e[o]*n,u=o<i-1?e[o+1]*n:t.length,(s=fp(t,a,u,n,!1))===s.next&&(s.steiner=!0),c.push(wp(s));for(c.sort(gp),o=0;o<c.length;o++)r=mp(c[o],r);return r}(t,e,h,r)),t.length>80*r){n=i=t[0],o=a=t[1];for(var v=r;v<l;v+=r)(u=t[v])<n&&(n=u),(s=t[v+1])<o&&(o=s),u>i&&(i=u),s>a&&(a=s);c=0!==(c=Math.max(i-n,a-o))?32767/c:0}return hp(h,p,r,n,o,c,0),p}function fp(t,e,r,n,o){var i,a;if(o===Rp(t,e,r,n)>0)for(i=e;i<r;i+=n)a=_p(i,t[i],t[i+1],a);else for(i=r-n;i>=e;i-=n)a=_p(i,t[i],t[i+1],a);return a&&Sp(a,a.next)&&(Mp(a),a=a.next),a}function lp(t,e){if(!t)return t;e||(e=t);var r,n=t;do{if(r=!1,n.steiner||!Sp(n,n.next)&&0!==Op(n.prev,n,n.next))n=n.next;else{if(Mp(n),(n=e=n.prev)===n.next)break;r=!0}}while(r||n!==e);return e}function hp(t,e,r,n,o,i,a){if(t){!a&&i&&function(t,e,r,n){var o=t;do{0===o.z&&(o.z=bp(o.x,o.y,e,r,n)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next}while(o!==t);o.prevZ.nextZ=null,o.prevZ=null,function(t){var e,r,n,o,i,a,u,s,c=1;do{for(r=t,t=null,i=null,a=0;r;){for(a++,n=r,u=0,e=0;e<c&&(u++,n=n.nextZ);e++);for(s=c;u>0||s>0&&n;)0!==u&&(0===s||!n||r.z<=n.z)?(o=r,r=r.nextZ,u--):(o=n,n=n.nextZ,s--),i?i.nextZ=o:t=o,o.prevZ=i,i=o;r=n}i.nextZ=null,c*=2}while(a>1)}(o)}(t,n,o,i);for(var u,s,c=t;t.prev!==t.next;)if(u=t.prev,s=t.next,i?vp(t,n,o,i):pp(t))e.push(u.i/r|0),e.push(t.i/r|0),e.push(s.i/r|0),Mp(t),t=s.next,c=s.next;else if((t=s)===c){a?1===a?hp(t=dp(lp(t),e,r),e,r,n,o,i,2):2===a&&yp(t,e,r,n,o,i):hp(lp(t),e,r,n,o,i,1);break}}}function pp(t){var e=t.prev,r=t,n=t.next;if(Op(e,r,n)>=0)return!1;for(var o=e.x,i=r.x,a=n.x,u=e.y,s=r.y,c=n.y,f=o<i?o<a?o:a:i<a?i:a,l=u<s?u<c?u:c:s<c?s:c,h=o>i?o>a?o:a:i>a?i:a,p=u>s?u>c?u:c:s>c?s:c,v=n.next;v!==e;){if(v.x>=f&&v.x<=h&&v.y>=l&&v.y<=p&&Ep(o,u,i,s,a,c,v.x,v.y)&&Op(v.prev,v,v.next)>=0)return!1;v=v.next}return!0}function vp(t,e,r,n){var o=t.prev,i=t,a=t.next;if(Op(o,i,a)>=0)return!1;for(var u=o.x,s=i.x,c=a.x,f=o.y,l=i.y,h=a.y,p=u<s?u<c?u:c:s<c?s:c,v=f<l?f<h?f:h:l<h?l:h,d=u>s?u>c?u:c:s>c?s:c,y=f>l?f>h?f:h:l>h?l:h,g=bp(p,v,e,r,n),m=bp(d,y,e,r,n),x=t.prevZ,b=t.nextZ;x&&x.z>=g&&b&&b.z<=m;){if(x.x>=p&&x.x<=d&&x.y>=v&&x.y<=y&&x!==o&&x!==a&&Ep(u,f,s,l,c,h,x.x,x.y)&&Op(x.prev,x,x.next)>=0)return!1;if(x=x.prevZ,b.x>=p&&b.x<=d&&b.y>=v&&b.y<=y&&b!==o&&b!==a&&Ep(u,f,s,l,c,h,b.x,b.y)&&Op(b.prev,b,b.next)>=0)return!1;b=b.nextZ}for(;x&&x.z>=g;){if(x.x>=p&&x.x<=d&&x.y>=v&&x.y<=y&&x!==o&&x!==a&&Ep(u,f,s,l,c,h,x.x,x.y)&&Op(x.prev,x,x.next)>=0)return!1;x=x.prevZ}for(;b&&b.z<=m;){if(b.x>=p&&b.x<=d&&b.y>=v&&b.y<=y&&b!==o&&b!==a&&Ep(u,f,s,l,c,h,b.x,b.y)&&Op(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function dp(t,e,r){var n=t;do{var o=n.prev,i=n.next.next;!Sp(o,i)&&Tp(o,n,n.next,i)&&jp(o,i)&&jp(i,o)&&(e.push(o.i/r|0),e.push(n.i/r|0),e.push(i.i/r|0),Mp(n),Mp(n.next),n=t=i),n=n.next}while(n!==t);return lp(n)}function yp(t,e,r,n,o,i){var a=t;do{for(var u=a.next.next;u!==a.prev;){if(a.i!==u.i&&Ap(a,u)){var s=Pp(a,u);return a=lp(a,a.next),s=lp(s,s.next),hp(a,e,r,n,o,i,0),void hp(s,e,r,n,o,i,0)}u=u.next}a=a.next}while(a!==t)}function gp(t,e){return t.x-e.x}function mp(t,e){var r=function(t,e){var r,n=e,o=t.x,i=t.y,a=-1/0;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){var u=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(u<=o&&u>a&&(a=u,r=n.x<n.next.x?n:n.next,u===o))return r}n=n.next}while(n!==e);if(!r)return null;var s,c=r,f=r.x,l=r.y,h=1/0;n=r;do{o>=n.x&&n.x>=f&&o!==n.x&&Ep(i<l?o:a,i,f,l,i<l?a:o,i,n.x,n.y)&&(s=Math.abs(i-n.y)/(o-n.x),jp(n,t)&&(s<h||s===h&&(n.x>r.x||n.x===r.x&&xp(r,n)))&&(r=n,h=s)),n=n.next}while(n!==c);return r}(t,e);if(!r)return e;var n=Pp(r,t);return lp(n,n.next),lp(r,r.next)}function xp(t,e){return Op(t.prev,t,e.prev)<0&&Op(e.next,t,t.next)<0}function bp(t,e,r,n,o){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-r)*o|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*o|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function wp(t){var e=t,r=t;do{(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next}while(e!==t);return r}function Ep(t,e,r,n,o,i,a,u){return(o-a)*(e-u)>=(t-a)*(i-u)&&(t-a)*(n-u)>=(r-a)*(e-u)&&(r-a)*(i-u)>=(o-a)*(n-u)}function Ap(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&Tp(r,r.next,t,e))return!0;r=r.next}while(r!==t);return!1}(t,e)&&(jp(t,e)&&jp(e,t)&&function(t,e){var r=t,n=!1,o=(t.x+e.x)/2,i=(t.y+e.y)/2;do{r.y>i!=r.next.y>i&&r.next.y!==r.y&&o<(r.next.x-r.x)*(i-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==t);return n}(t,e)&&(Op(t.prev,t,e.prev)||Op(t,e.prev,e))||Sp(t,e)&&Op(t.prev,t,t.next)>0&&Op(e.prev,e,e.next)>0)}function Op(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function Sp(t,e){return t.x===e.x&&t.y===e.y}function Tp(t,e,r,n){var o=Ip(Op(t,e,r)),i=Ip(Op(t,e,n)),a=Ip(Op(r,n,t)),u=Ip(Op(r,n,e));return o!==i&&a!==u||(!(0!==o||!kp(t,r,e))||(!(0!==i||!kp(t,n,e))||(!(0!==a||!kp(r,t,n))||!(0!==u||!kp(r,e,n)))))}function kp(t,e,r){return e.x<=Math.max(t.x,r.x)&&e.x>=Math.min(t.x,r.x)&&e.y<=Math.max(t.y,r.y)&&e.y>=Math.min(t.y,r.y)}function Ip(t){return t>0?1:t<0?-1:0}function jp(t,e){return Op(t.prev,t,t.next)<0?Op(t,e,t.next)>=0&&Op(t,t.prev,e)>=0:Op(t,e,t.prev)<0||Op(t,t.next,e)<0}function Pp(t,e){var r=new Lp(t.i,t.x,t.y),n=new Lp(e.i,e.x,e.y),o=t.next,i=e.prev;return t.next=e,e.prev=t,r.next=o,o.prev=r,n.next=r,r.prev=n,i.next=n,n.prev=i,n}function _p(t,e,r,n){var o=new Lp(t,e,r);return n?(o.next=n.next,o.prev=n,n.next.prev=o,n.next=o):(o.prev=o,o.next=o),o}function Mp(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Lp(t,e,r){this.i=t,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Rp(t,e,r,n){for(var o=0,i=e,a=r-n;i<r;i+=n)o+=(t[a]-t[i])*(t[i+1]+t[a+1]),a=i;return o}cp.deviation=function(t,e,r,n){var o=e&&e.length,i=o?e[0]*r:t.length,a=Math.abs(Rp(t,0,i,r));if(o)for(var u=0,s=e.length;u<s;u++){var c=e[u]*r,f=u<s-1?e[u+1]*r:t.length;a-=Math.abs(Rp(t,c,f,r))}var l=0;for(u=0;u<n.length;u+=3){var h=n[u]*r,p=n[u+1]*r,v=n[u+2]*r;l+=Math.abs((t[h]-t[v])*(t[p+1]-t[h+1])-(t[h]-t[p])*(t[v+1]-t[h+1]))}return 0===a&&0===l?0:Math.abs((l-a)/a)},cp.flatten=function(t){for(var e=t[0][0].length,r={vertices:[],holes:[],dimensions:e},n=0,o=0;o<t.length;o++){for(var i=0;i<t[o].length;i++)for(var a=0;a<e;a++)r.vertices.push(t[o][i][a]);o>0&&(n+=t[o-1].length,r.holes.push(n))}return r},up.default=sp;var Cp=F(1..valueOf),Np=F("".replace),Dp="[\\t\\n\\v\\f\\r                　\\u2028\\u2029\\ufeff]",Fp=RegExp("^"+Dp+Dp+"*"),Wp=RegExp(Dp+Dp+"*$"),zp=function(t){return function(e){var r=rf(B(e));return 1&t&&(r=Np(r,Fp,"")),2&t&&(r=Np(r,Wp,"")),r}},Bp={start:zp(1),end:zp(2),trim:zp(3)},Up=Ze.f,Gp=je.f,Hp=qt.f,Vp=Bp.trim,qp=O.Number,Zp=qp.prototype,Yp=O.TypeError,$p=F("".slice),Kp=F("".charCodeAt),Qp=function(t){var e=Bt(t,"number");return"bigint"==typeof e?e:Xp(e)},Xp=function(t){var e,r,n,o,i,a,u,s,c=Bt(t,"number");if(Mt(c))throw Yp("Cannot convert a Symbol value to a number");if("string"==typeof c&&c.length>2)if(c=Vp(c),43===(e=Kp(c,0))||45===e){if(88===(r=Kp(c,2))||120===r)return NaN}else if(48===e){switch(Kp(c,1)){case 66:case 98:n=2,o=49;break;case 79:case 111:n=8,o=55;break;default:return+c}for(a=(i=$p(c,2)).length,u=0;u<a;u++)if((s=Kp(i,u))<48||s>o)return NaN;return parseInt(i,n)}return+c};if(or("Number",!qp(" 0o1")||!qp("0b1")||qp("+0x1"))){for(var Jp,tv=function(t){var e=arguments.length<1?0:qp(Qp(t)),r=this;return Pt(Zp,r)&&j((function(){Cp(r)}))?ss(Object(e),r,tv):e},ev=gt?Up(qp):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),rv=0;ev.length>rv;rv++)V(qp,Jp=ev[rv])&&!V(tv,Jp)&&Hp(tv,Jp,Gp(qp,Jp));tv.prototype=Zp,Zp.constructor=tv,de(O,"Number",tv,{constructor:!0})}var nv=RangeError,ov=RangeError,iv=String,av=Math.floor,uv=F((function(t){var e=rf(B(this)),r="",n=Le(t);if(n<0||n==1/0)throw nv("Wrong number of repetitions");for(;n>0;(n>>>=1)&&(e+=e))1&n&&(r+=e);return r})),sv=F("".slice),cv=F(1..toFixed),fv=function(t,e,r){return 0===e?r:e%2==1?fv(t,e-1,r*t):fv(t*t,e/2,r)},lv=function(t,e,r){for(var n=-1,o=r;++n<6;)o+=e*t[n],t[n]=o%1e7,o=av(o/1e7)},hv=function(t,e){for(var r=6,n=0;--r>=0;)n+=t[r],t[r]=av(n/e),n=n%e*1e7},pv=function(t){for(var e=6,r="";--e>=0;)if(""!==r||0===e||0!==t[e]){var n=iv(t[e]);r=""===r?n:r+uv("0",7-n.length)+n}return r},vv=j((function(){return"0.000"!==cv(8e-5,3)||"1"!==cv(.9,0)||"1.25"!==cv(1.255,2)||"1000000000000000128"!==cv(0xde0b6b3a7640080,0)}))||!j((function(){cv({})}));function dv(t){return"number"==typeof t}function yv(t){var e=Math.max(Math.min(85.0511287798,t[1]),-85.0511287798),r=Math.PI/180,n=t[0]*r,o=e*r;o=Math.log(Math.tan(Math.PI/4+o/2));return n=(256<<20)*(.5/Math.PI*n+.5),o=(256<<20)*(-.5/Math.PI*o+(r=.5)),[Math.floor(n),Math.floor(o)]}ar({target:"Number",proto:!0,forced:vv},{toFixed:function(t){var e,r,n,o,i=Cp(this),a=Le(t),u=[0,0,0,0,0,0],s="",c="0";if(a<0||a>20)throw ov("Incorrect fraction digits");if(i!=i)return"NaN";if(i<=-1e21||i>=1e21)return iv(i);if(i<0&&(s="-",i=-i),i>1e-21)if(r=(e=function(t){for(var e=0,r=t;r>=4096;)e+=12,r/=4096;for(;r>=2;)e+=1,r/=2;return e}(i*fv(2,69,1))-69)<0?i*fv(2,-e,1):i/fv(2,e,1),r*=4503599627370496,(e=52-e)>0){for(lv(u,0,r),n=a;n>=7;)lv(u,1e7,0),n-=7;for(lv(u,fv(10,n,1),0),n=e-1;n>=23;)hv(u,1<<23),n-=23;hv(u,1<<n),lv(u,1,1),hv(u,2),c=pv(u)}else lv(u,0,r),lv(u,1<<-e,0),c=pv(u)+uv("0",a);return c=a>0?s+((o=c.length)<=a?"0."+uv("0",a-o)+c:sv(c,0,o-a)+"."+sv(c,o-a)):s+c}});var gv,mv=/"/g,xv=F("".replace);ar({target:"String",proto:!0,forced:(gv="sub",j((function(){var t=""[gv](\'"\');return t!==t.toLowerCase()||t.split(\'"\').length>3})))},{sub:function(){return t="sub",e="",r="",n=rf(B(this)),o="<"+t,""!==e&&(o+=" "+e+\'="\'+xv(rf(r),mv,"&quot;")+\'"\'),o+">"+n+"</"+t+">";var t,e,r,n,o}});var bv=RegExp.prototype,wv=Kt.PROPER,Ev=RegExp.prototype.toString,Av=j((function(){return"/a/b"!=Ev.call({source:"a",flags:"b"})})),Ov=wv&&"toString"!=Ev.name;(Av||Ov)&&de(RegExp.prototype,"toString",(function(){var t=kt(this);return"/"+rf(t.source)+"/"+rf(function(t){var e=t.flags;return void 0!==e||"flags"in bv||V(t,"flags")||!Pt(bv,t)?e:jt(nf,t)}(t))}),{unsafe:!0});var Sv="undefined"!=typeof Float32Array?Float32Array:Array;function Tv(){var t=new Sv(2);return Sv!=Float32Array&&(t[0]=0,t[1]=0),t}function kv(t,e){var r=new Sv(2);return r[0]=t,r[1]=e,r}function Iv(t,e){return t[0]=e[0],t[1]=e[1],t}function jv(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t}function Pv(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t}function _v(t,e){var r=e[0],n=e[1],o=r*r+n*n;return o>0&&(o=1/Math.sqrt(o)),t[0]=e[0]*o,t[1]=e[1]*o,t}function Mv(t,e){return t[0]*e[0]+t[1]*e[1]}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var Lv,Rv=Pv,Cv=(Lv=Tv(),Tv()),Nv=(Tv(),Tv()),Dv=Tv(),Fv=Tv();function Wv(t,e,r,n,o){return jv(t,r,n),_v(t,t),[o/Mv(e=kv(-t[1],t[0]),kv(-r[1],r[0])),e]}function zv(t,e){return function(t,e,r){return t[0]=e,t[1]=r,t}(t,-e[1],e[0])}function Bv(t,e,r){return Rv(t,e,r),_v(t,t),t}function Uv(t,e){return t[0]===e[0]&&t[1]===e[1]}var Gv=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t),s(this,"complex",void 0),s(this,"join",void 0),s(this,"cap",void 0),s(this,"miterLimit",void 0),s(this,"thickness",void 0),s(this,"normal",void 0),s(this,"lastFlip",-1),s(this,"miter",kv(0,0)),s(this,"started",!1),s(this,"dash",!1),s(this,"totalDistance",0),s(this,"currentIndex",0),this.join=e.join||"miter",this.cap=e.cap||"butt",this.miterLimit=e.miterLimit||10,this.thickness=e.thickness||1,this.dash=e.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0,indexes:[]}}return u(t,[{key:"extrude_gaode2",value:function(t,e){var r=this.complex;if(t.length<=1)return r;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var n=t.length,o=r.startIndex,i=1;i<n;i++){var a,u,s,c=t[i-1];c.push(null!==(a=e[i-1][2])&&void 0!==a?a:0);var f=e[i-1],l=t[i];l.push(null!==(u=e[i][2])&&void 0!==u?u:0);var h=e[i],p=i<t.length-1?[].concat(y(t[i+1]),[null!==(s=e[i+1][2])&&void 0!==s?s:0]):null,v=i<e.length-1?e[i+1]:null;o+=this.segment_gaode2(r,o,c,l,p,f,h,v)}if(this.dash)for(var d=0;d<r.positions.length/6;d++)r.positions[6*d+5]=this.totalDistance;return r.startIndex=r.positions.length/6,r}},{key:"simpleExtrude_gaode2",value:function(t,e){var r=this.complex;if(t.length<=1)return r;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var n=t.length,o=r.startIndex,i=1;i<n;i++){var a,u,s,c=t[i-1];c.push(null!==(a=e[i-1][2])&&void 0!==a?a:0);var f=e[i-1],l=t[i];l.push(null!==(u=e[i][2])&&void 0!==u?u:0);var h=e[i],p=i<t.length-1?[].concat(y(t[i+1]),[null!==(s=e[i+1][2])&&void 0!==s?s:0]):null,v=i<e.length-1?e[i+1]:null;o+=this.simpleSegment(r,o,c,l,p,f,h,v)}if(this.dash)for(var d=0;d<r.positions.length/6;d++)r.positions[6*d+5]=this.totalDistance;return r.startIndex=r.positions.length/6,r}},{key:"extrude",value:function(t){var e=this.complex;if(t.length<=1)return e;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var r=t.length,n=e.startIndex,o=1;o<r;o++){var i=t[o-1],a=t[o],u=o<t.length-1?t[o+1]:null;n+=this.segment(e,n,i,a,u)}if(this.dash)for(var s=0;s<e.positions.length/6;s++)e.positions[6*s+5]=this.totalDistance;return e.startIndex=e.positions.length/6,e}},{key:"simpleExtrude",value:function(t){var e=this.complex;if(t.length<=1)return e;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var r=t.length,n=e.startIndex,o=1;o<r;o++){var i=t[o-1],a=t[o],u=o<t.length-1?t[o+1]:null;n+=this.simpleSegment(e,n,i,a,u)}if(this.dash)for(var s=0;s<e.positions.length/6;s++)e.positions[6*s+5]=this.totalDistance;return e.startIndex=e.positions.length/6,e}},{key:"segment_gaode2",value:function(t,e,r,n,o,i,a,u){var s=0,c=t.indices,f=t.positions,l=t.normals,h="square"===this.cap,p="bevel"===this.join,v=yv([a[0],a[1]]),g=yv([i[0],i[1]]);Bv(Nv,n,r);var m=0;if(this.dash&&(m=this.lineSegmentDistance(v,g),this.totalDistance+=m),this.normal||(this.normal=Tv(),zv(this.normal,Nv)),!this.started)if(this.started=!0,h){var x=Tv(),b=Tv();jv(x,this.normal,Nv),jv(b,this.normal,Nv),l.push(b[0],b[1],0),l.push(x[0],x[1],0),f.push(r[0],r[1],0|r[2],this.totalDistance-m,-this.thickness,0|r[2]),this.complex.indexes.push(this.currentIndex),f.push(r[0],r[1],0|r[2],this.totalDistance-m,this.thickness,0|r[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(f,l,r,this.normal,this.thickness,this.totalDistance-m);if(c.push(e+0,e+1,e+2),o){Uv(n,o)&&jv(o,n,_v(o,Pv(o,n,r))),Bv(Dv,o,n);var w=d(Wv(Fv,Tv(),Nv,Dv,this.thickness),2),E=w[0],A=w[1],O=Mv(Fv,this.normal)<0?-1:1,S=p;if(!S&&"miter"===this.join)E>this.miterLimit&&(S=!0);S?(l.push(this.normal[0],this.normal[1],0),l.push(A[0],A[1],0),f.push(n[0],n[1],0|n[2],this.totalDistance,-this.thickness*O,0|n[2]),this.complex.indexes.push(this.currentIndex),f.push(n[0],n[1],0|n[2],this.totalDistance,this.thickness*O,0|n[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++,c.push.apply(c,y(this.lastFlip!==-O?[e,e+2,e+3]:[e+2,e+1,e+3])),c.push(e+2,e+3,e+4),zv(Cv,Dv),Iv(this.normal,Cv),l.push(this.normal[0],this.normal[1],0),f.push(n[0],n[1],0|n[2],this.totalDistance,-this.thickness*O,0|n[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++,s+=3):(this.extrusions(f,l,n,A,E,this.totalDistance),c.push.apply(c,y(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),O=-1,Iv(this.normal,A),s+=2),this.lastFlip=O}else{if(zv(this.normal,Nv),h){var T=Tv(),k=Tv();Rv(k,Nv,this.normal),jv(T,Nv,this.normal),l.push(k[0],k[1],0),l.push(T[0],T[1],0),f.push(n[0],n[1],0|n[2],this.totalDistance,this.thickness,0|n[2]),this.complex.indexes.push(this.currentIndex),f.push(n[0],n[1],0|n[2],this.totalDistance,this.thickness,0|n[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(f,l,n,this.normal,this.thickness,this.totalDistance);c.push.apply(c,y(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),s+=2}return s}},{key:"simpleSegment",value:function(t,e,r,n,o){var i=0,a=t.indices,u=t.positions,s=t.normals,c=yv([n[0],n[1]]),f=yv([r[0],r[1]]);Bv(Nv,c,f);var l=0;if(this.dash&&(l=this.lineSegmentDistance(c,f),this.totalDistance+=l),this.normal||(this.normal=Tv(),zv(this.normal,Nv)),this.started||(this.started=!0,this.extrusions(u,s,r,this.normal,this.thickness,this.totalDistance-l)),a.push(e+0,e+1,e+2),o){var h=yv([o[0],o[1]]);Uv(c,h)&&jv(h,c,_v(h,Pv(h,c,f))),Bv(Dv,h,c);var p=d(Wv(Fv,Tv(),Nv,Dv,this.thickness),2),v=p[0],g=p[1];Mv(Fv,this.normal);this.extrusions(u,s,n,g,v,this.totalDistance),a.push.apply(a,y(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),-1,Iv(this.normal,g),i+=2,this.lastFlip=-1}else zv(this.normal,Nv),this.extrusions(u,s,n,this.normal,this.thickness,this.totalDistance),a.push.apply(a,y(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),i+=2;return i}},{key:"segment",value:function(t,e,r,n,o){var i=0,a=t.indices,u=t.positions,s=t.normals,c="square"===this.cap,f="bevel"===this.join,l=yv([n[0],n[1]]),h=yv([r[0],r[1]]);Bv(Nv,l,h);var p=0;if(this.dash&&(p=this.lineSegmentDistance(l,h),this.totalDistance+=p),this.normal||(this.normal=Tv(),zv(this.normal,Nv)),!this.started)if(this.started=!0,c){var v=Tv(),g=Tv();jv(v,this.normal,Nv),jv(g,this.normal,Nv),s.push(g[0],g[1],0),s.push(v[0],v[1],0),u.push(r[0],r[1],0|r[2],this.totalDistance-p,-this.thickness,0|r[2]),this.complex.indexes.push(this.currentIndex),u.push(r[0],r[1],0|r[2],this.totalDistance-p,this.thickness,0|r[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(u,s,r,this.normal,this.thickness,this.totalDistance-p);if(a.push(e+0,e+1,e+2),o){var m=yv([o[0],o[1]]);Uv(l,m)&&jv(m,l,_v(m,Pv(m,l,h))),Bv(Dv,m,l);var x=d(Wv(Fv,Tv(),Nv,Dv,this.thickness),2),b=x[0],w=x[1],E=Mv(Fv,this.normal)<0?-1:1,A=f;if(!A&&"miter"===this.join)b>this.miterLimit&&(A=!0);A?(s.push(this.normal[0],this.normal[1],0),s.push(w[0],w[1],0),u.push(n[0],n[1],0|n[2],this.totalDistance,-this.thickness*E,0|n[2]),this.complex.indexes.push(this.currentIndex),u.push(n[0],n[1],0|n[2],this.totalDistance,this.thickness*E,0|n[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++,a.push.apply(a,y(this.lastFlip!==-E?[e,e+2,e+3]:[e+2,e+1,e+3])),a.push(e+2,e+3,e+4),zv(Cv,Dv),Iv(this.normal,Cv),s.push(this.normal[0],this.normal[1],0),u.push(n[0],n[1],0|n[2],this.totalDistance,-this.thickness*E,0|n[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++,i+=3):(this.extrusions(u,s,n,w,b,this.totalDistance),a.push.apply(a,y(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),E=-1,Iv(this.normal,w),i+=2),this.lastFlip=E}else{if(zv(this.normal,Nv),c){var O=Tv(),S=Tv();Rv(S,Nv,this.normal),jv(O,Nv,this.normal),s.push(S[0],S[1],0),s.push(O[0],O[1],0),u.push(n[0],n[1],0|n[2],this.totalDistance,this.thickness,0|n[2]),this.complex.indexes.push(this.currentIndex),u.push(n[0],n[1],0|n[2],this.totalDistance,this.thickness,0|n[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(u,s,n,this.normal,this.thickness,this.totalDistance);a.push.apply(a,y(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),i+=2}return i}},{key:"extrusions",value:function(t,e,r,n,o,i){e.push(n[0],n[1],0),e.push(n[0],n[1],0),t.push(r[0],r[1],0|r[2],i,-o,0|r[2]),this.complex.indexes.push(this.currentIndex),t.push(r[0],r[1],0|r[2],i,o,0|r[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++}},{key:"lineSegmentDistance",value:function(t,e){var r=e[0]-t[0],n=e[1]-t[1];return Math.sqrt(r*r+n*n)}}]),t}();function Hv(t){var e=t.coordinates,r=t.originCoordinates,n=t.version,o=new Gv({dash:!0,join:"bevel"});if("GAODE2.x"===n){var i=e;Array.isArray(i[0][0])||(i=[e]);var a=r;Array.isArray(a[0][0])||(a=[r]);for(var u=0;u<i.length;u++){var s=i[u],c=a[u];o.extrude_gaode2(s,c)}}else{var f=e;f[0]&&!Array.isArray(f[0][0])&&(f=[e]),f.forEach((function(t){o.extrude(t)}))}var l=o.complex;return{vertices:l.positions,indices:l.indices,normals:l.normals,indexes:l.indexes,size:6}}function Vv(t){var e=function(t){if(dv(t[0]))return t;if(dv(t[0][0]))throw new Error("当前数据不支持标注");if(dv(t[0][0][0])){var e=0,r=0,n=0;return t.forEach((function(t){t.forEach((function(t){e+=t[0],r+=t[1],n++}))})),[e/n,r/n,0]}throw new Error("当前数据不支持标注")}(t.coordinates);return{vertices:[].concat(y(e),y(e),y(e),y(e)),indices:[0,1,2,2,3,0],size:e.length}}function qv(t){var e=t.coordinates,r=up.flatten(e),n=r.vertices,o=r.dimensions,i=r.holes;return{indices:up(n,i,o),vertices:n,size:o}}var Zv=function(){var t=o(r().mark((function t(e){var n,o,i,a,u,s,c,f,l;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.descriptors,o=e.features,i=e.enablePicking,a=e.iconMap,u={a_Color:np,a_Position:op,filter:ip,a_vertexId:ap,a_PickingColor:function(t){var e=t.id;return i?tp(e):[0,0,0]},a_DistanceAndIndex:function(t,e,r,n,o,i){return void 0===i?[r[3],10]:[r[3],i]},a_Total_Distance:function(t,e,r){return[r[5]]},a_Size:function(t){var e=t.size,r=void 0===e?1:e;return Array.isArray(r)?[r[0],r[1]]:[r,0]},a_Normal:function(t,e,r,n,o){return o},a_Miter:function(t,e,r){return[r[4]]},a_iconMapUV:function(t){var e=t.texture,r=a[e]||{x:0,y:0};return[r.x,r.y]}},s={sizePerElement:0,elements:[]},c=0,f=[],l=3,o.forEach((function(t,e){var r=Hv(t),o=r.indices,i=r.vertices,a=r.normals,h=r.size,p=r.indexes;o.forEach((function(t){f.push(t+c)})),l=h;var v=i.length/h;s.sizePerElement=l,s.elements.push({featureIdx:e,vertices:i,normals:a,offset:c}),c+=v;for(var d=function(r){var o=(null==a?void 0:a.slice(3*r,3*r+3))||[],s=i.slice(r*h,r*h+h),c=0;p&&void 0!==p[r]&&(c=p[r]),n.forEach((function(n){var i;n&&u[n.name]&&(i=n.buffer.data).push.apply(i,y(u[n.name](t,e,s,r,o,c)))}))},g=0;g<v;g++)d(g)})),t.abrupt("return",{descriptors:n,featureLayout:s,indices:f});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Yv={pointFill:function(){var t=o(r().mark((function t(e){var n,o,i,a,u,s,c,f,l;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.descriptors,o=e.features,i=e.enablePicking,a=e.shape2d,u={a_Color:np,a_Position:op,filter:ip,a_vertexId:ap,a_PickingColor:function(t){var e=t.id;return i?tp(e):[0,0,0]},a_Shape:function(t){var e=t.shape,r=void 0===e?2:e;return[a.indexOf(r)]},a_Extrude:function(t,e,r,n){var o=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],i=n%4*3;return[o[i],o[i+1],o[i+2]]},a_Size:function(t){var e=t.size,r=void 0===e?5:e;return Array.isArray(r)?[r[0]]:[r]}},s={sizePerElement:0,elements:[]},c=0,f=[],l=3,o.forEach((function(t,e){var r=Vv(t),o=r.indices,i=r.vertices,a=r.normals,h=r.size;o.forEach((function(t){f.push(t+c)})),l=h;var p=i.length/h;s.sizePerElement=l,s.elements.push({featureIdx:e,vertices:i,normals:a,offset:c}),c+=p;for(var v=function(r){var o=[],a=i.slice(r*h,r*h+h);n.forEach((function(n){var i;n&&u[n.name]&&(i=n.buffer.data).push.apply(i,y(u[n.name](t,e,a,r,o,0)))}))},d=0;d<p;d++)v(d)})),t.abrupt("return",{descriptors:n,featureLayout:s,indices:f});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),line:Zv,polygonFill:function(){var t=o(r().mark((function t(e){var n,o,i,a,u,s,c,f;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.descriptors,o=e.features,i=e.enablePicking,a={a_Color:np,a_Position:op,filter:ip,a_vertexId:ap,a_PickingColor:function(t){var e=t.id;return i?tp(e):[0,0,0]}},u={sizePerElement:0,elements:[]},s=0,c=[],f=3,o.forEach((function(t,e){var r=qv(t),o=r.indices,i=r.vertices,l=r.normals,h=r.size;o.forEach((function(t){c.push(t+s)})),f=h;var p=i.length/h;u.sizePerElement=f,u.elements.push({featureIdx:e,vertices:i,normals:l,offset:s}),s+=p;for(var v=function(r){var o=[],u=i.slice(r*h,r*h+h);n.forEach((function(n){var i;n&&a[n.name]&&(i=n.buffer.data).push.apply(i,y(a[n.name](t,e,u,r,o,0)))}))},d=0;d<p;d++)v(d)})),t.abrupt("return",{descriptors:n,featureLayout:u,indices:c});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},$v=function(t){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?e(Object(n),!0).forEach((function(e){s(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):e(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},Yv);function Kv(t){return Qv.apply(this,arguments)}function Qv(){return(Qv=o(r().mark((function t(e){var n,o;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.workerType,o=e.data,!$v[n]){t.next=3;break}return t.abrupt("return",$v[n](o));case 3:return t.abrupt("return",Promise.reject(new Error(\'Worker with type "\'.concat(n,\'" non-existent.\'))));case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return fi(Kv),t.WorkerSourceMap=Yv,t.createWorker=fi,t.worker=Kv,t}({});\n');var pQ,dQ,mQ,vQ,gQ=1029,yQ=1028;function xQ(t){switch(t){case"GAODE1.x":case"GAODE2.x":case"GLOBEL":return gQ;default:return yQ}}(dQ=pQ||(pQ={})).Realtime="realtime",dQ.Overlap="overlap",dQ.Replace="replace",(vQ=mQ||(mQ={})).Loading="Loading",vQ.Loaded="Loaded",vQ.Failure="Failure",vQ.Cancelled="Cancelled";var bQ;function _Q(t){for(;t;){if(t.isLoaded)return t.properties.state|=2,!0;t=t.parent}return!1}function wQ(t){t.children.forEach((function(t){t.isLoaded?t.properties.state|=2:wQ(t)}))}var SQ=[-1/0,-1/0,1/0,1/0],MQ=($q(bQ={},pQ.Realtime,(function(t){t.forEach((function(t){t.isCurrent&&(t.isVisible=t.isLoaded)}))})),$q(bQ,pQ.Overlap,(function(t){t.forEach((function(t){t.properties.state=0})),t.forEach((function(t){t.isCurrent&&!_Q(t)&&wQ(t)})),t.forEach((function(t){t.isVisible=Boolean(2&t.properties.state)}))})),$q(bQ,pQ.Replace,(function(t){t.forEach((function(t){t.properties.state=0})),t.forEach((function(t){t.isCurrent&&_Q(t)})),t.slice().sort((function(t,e){return t.z-e.z})).forEach((function(t){t.isVisible=Boolean(2&t.properties.state),t.children.length&&(t.isVisible||1&t.properties.state)?t.children.forEach((function(t){t.properties.state=1})):t.isCurrent&&wQ(t)}))})),bQ),EQ=function(){};function AQ(t,e,n){return[Math.floor((t+180)/360*Math.pow(2,n)),Math.floor((1-Math.log(Math.tan(e*Math.PI/180)+1/Math.cos(e*Math.PI/180))/Math.PI)/2*Math.pow(2,n))]}function TQ(t,e,n){var r=t/Math.pow(2,n)*360-180,i=Math.PI-2*Math.PI*e/Math.pow(2,n);return[r,180/Math.PI*Math.atan(.5*(Math.exp(i)-Math.exp(-i)))]}var CQ=function(t,e,n){var r=lZ(TQ(t,e,n),2),i=r[0],o=r[1],a=lZ(TQ(t+1,e+1,n),2),s=a[0];return[i,a[1],s,o]};var OQ=function(t,e,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=Math.pow(2,n),o=i-1,a=t;return r&&(a<0?a+=i:a>o&&(a%=i)),{warpX:a,warpY:e}};function kQ(t,e){if(!t||!t.length)throw new Error("url is not allowed to be empty");var n=e.x,r=e.y,i=e.z,o=function(t){var e=[],n=/\{([a-z])-([a-z])\}/.exec(t);if(n){var r,i=n[1].charCodeAt(0),o=n[2].charCodeAt(0);for(r=i;r<=o;++r)e.push(t.replace(n[0],String.fromCharCode(r)));return e}if(n=/\{(\d+)-(\d+)\}/.exec(t)){for(var a=parseInt(n[2],10),s=parseInt(n[1],10);s<=a;s++)e.push(t.replace(n[0],s.toString()));return e}return e.push(t),e}(t);return o[Math.abs(n+r)%o.length].replace(/\{x\}/g,n.toString()).replace(/\{y\}/g,r.toString()).replace(/\{z\}/g,i.toString()).replace(/\{bbox\}/g,CQ(n,r,i).join(",")).replace(/\{-y\}/g,(Math.pow(2,i)-r-1).toString())}function PQ(t,e){var n=e.x,r=e.y,i=e.z,o=e.layer,a=e.version,s=void 0===a?"1.0.0":a,u=e.style,c=void 0===u?"default":u,l=e.format,h=e.service,f=void 0===h?"WMTS":h,p=e.tileMatrixset;return"".concat(t,"&SERVICE=").concat(f,"&REQUEST=GetTile&VERSION=").concat(s,"&LAYER=").concat(o,"&STYLE=").concat(c,"&TILEMATRIXSET=").concat(p,"&FORMAT=").concat(l,"&TILECOL=").concat(n,"&TILEROW=").concat(r,"&TILEMATRIX=").concat(i)}function LQ(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var RQ=function(t){wZ(r,hc.EventEmitter);var e,n=LQ(r);function r(t){var e;mZ(this,r),$q(SZ(e=n.call(this)),"tileSize",256),$q(SZ(e),"isVisible",!1),$q(SZ(e),"isCurrent",!1),$q(SZ(e),"isVisibleChange",!1),$q(SZ(e),"loadedLayers",0),$q(SZ(e),"isLayerLoaded",!1),$q(SZ(e),"isLoad",!1),$q(SZ(e),"isChildLoad",!1),$q(SZ(e),"parent",null),$q(SZ(e),"children",[]),$q(SZ(e),"data",null),$q(SZ(e),"properties",{}),$q(SZ(e),"loadDataId",0);var i=t.x,o=t.y,a=t.z,s=t.tileSize,u=t.warp,c=void 0===u||u;return e.x=i,e.y=o,e.z=a,e.warp=c||!0,e.tileSize=s,e}return gZ(r,[{key:"isLoading",get:function(){return this.loadStatus===mQ.Loading}},{key:"isLoaded",get:function(){return this.loadStatus===mQ.Loaded}},{key:"isFailure",get:function(){return this.loadStatus===mQ.Failure}},{key:"setTileLayerLoaded",value:function(){this.isLayerLoaded=!0}},{key:"isCancelled",get:function(){return this.loadStatus===mQ.Cancelled}},{key:"isDone",get:function(){return[mQ.Loaded,mQ.Cancelled,mQ.Failure].includes(this.loadStatus)}},{key:"bounds",get:function(){return CQ(this.x,this.y,this.z)}},{key:"bboxPolygon",get:function(){var t=lZ(this.bounds,4),e=t[0],n=t[1],r=[(t[2]-e)/2,(t[3]-n)/2];return function(t,e){void 0===e&&(e={});var n=Number(t[0]),r=Number(t[1]),i=Number(t[2]),o=Number(t[3]);if(6===t.length)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var a=[n,r];return rZ([[a,[i,r],[i,o],[n,o],a]],e.properties,{bbox:t,id:e.id})}(this.bounds,{properties:{key:this.key,id:this.key,bbox:this.bounds,center:r,meta:"\n      ".concat(this.key,"\n      ")}})}},{key:"key",get:function(){return"".concat(this.x,"_").concat(this.y,"_").concat(this.z)}},{key:"layerLoad",value:function(){this.loadedLayers++,this.emit("layerLoaded")}},{key:"loadData",value:(e=RK(jK.mark((function t(e){var n,r,i,o,a,s,u,c,l,h,f,p,d,m,v,g,y;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.getData,r=e.onLoad,i=e.onError,this.loadDataId++,o=this.loadDataId,this.isLoading&&this.abortLoad(),this.abortController=new AbortController,this.loadStatus=mQ.Loading,a=null,t.prev=7,u=this.x,c=this.y,l=this.z,h=this.bounds,f=this.tileSize,p=this.warp,d=OQ(u,c,l,p),m=d.warpX,v=d.warpY,g=this.abortController.signal,y={x:m,y:v,z:l,bounds:h,tileSize:f,signal:g,warp:p},t.next=14,n(y,this);case 14:a=t.sent,t.next=20;break;case 17:t.prev=17,t.t0=t.catch(7),s=t.t0;case 20:if(o===this.loadDataId){t.next=22;break}return t.abrupt("return");case 22:if(!this.isCancelled||a){t.next=24;break}return t.abrupt("return");case 24:if(!s&&a){t.next=28;break}return this.loadStatus=mQ.Failure,i(s,this),t.abrupt("return");case 28:this.loadStatus=mQ.Loaded,this.data=a,r(this);case 31:case"end":return t.stop()}}),t,this,[[7,17]])}))),function(t){return e.apply(this,arguments)})},{key:"reloadData",value:function(t){this.isLoading&&this.abortLoad(),this.loadData(t)}},{key:"abortLoad",value:function(){this.isLoaded||this.isCancelled||(this.loadStatus=mQ.Cancelled,this.abortController.abort(),this.xhrCancel&&this.xhrCancel())}}]),r}();function IQ(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return NQ(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return NQ(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function NQ(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function DQ(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var FQ,jQ,BQ=function(t){wZ(n,fc);var e=DQ(n);function n(t){var r;return mZ(this,n),$q(SZ(r=e.call(this)),"currentTiles",[]),$q(SZ(r),"cacheTiles",new Map),$q(SZ(r),"throttleUpdate",hZ.throttle((function(t,e){r.update(t,e)}),16)),$q(SZ(r),"onTileLoad",(function(t){r.emit("tile-loaded",t),r.updateTileVisible()})),$q(SZ(r),"onTileError",(function(t,e){r.emit("tile-error",{error:t,tile:e}),r.updateTileVisible()})),$q(SZ(r),"onTileUnload",(function(t){r.emit("tile-unload",t)})),r.options={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,extent:SQ,getTileData:EQ,warp:!0,updateStrategy:pQ.Overlap},r.updateOptions(t),r}return gZ(n,[{key:"isLoaded",get:function(){return this.currentTiles.every((function(t){return t.isDone}))}},{key:"tiles",get:function(){return Array.from(this.cacheTiles.values()).sort((function(t,e){return t.z-e.z}))}},{key:"updateOptions",value:function(t){var e=void 0===t.minZoom?this.options.minZoom:Math.ceil(t.minZoom),n=void 0===t.maxZoom?this.options.maxZoom:Math.floor(t.maxZoom);this.options=Jq(Jq(Jq({},this.options),t),{},{minZoom:e,maxZoom:n})}},{key:"update",value:function(t,e){var n=this,r=Math.max(0,Math.ceil(t));if(!this.lastViewStates||this.lastViewStates.zoom!==r||!function(t,e){return yK(xK(t),xK(e))}(this.lastViewStates.latLonBoundsBuffer,e)){var i=function(t,e){var n=gK(xK(t),e),r=85.0511287798065;return[Math.max(n[0][0],-900),Math.max(n[0][1],-r),Math.min(n[1][0],900),Math.min(n[1][1],r)]}(e,.2);this.lastViewStates={zoom:r,latLonBounds:e,latLonBoundsBuffer:i};var o=!1,a=this.getTileIndices(r,i).filter((function(t){return n.options.warp||t.x>=0&&t.x<Math.pow(2,r)}));this.currentTiles=a.map((function(t){var e,r,i=t.x,a=t.y,s=t.z,u=n.getTile(i,a,s);return u?(((null===(e=u)||void 0===e?void 0:e.isFailure)||(null===(r=u)||void 0===r?void 0:r.isCancelled))&&u.loadData({getData:n.options.getTileData,onLoad:n.onTileLoad,onError:n.onTileError}),u):(u=n.createTile(i,a,s),o=!0,u)})),o&&this.resizeCacheTiles(),this.updateTileVisible(),this.pruneRequests()}}},{key:"reloadAll",value:function(){var t,e=IQ(this.cacheTiles);try{for(e.s();!(t=e.n()).done;){var n=lZ(t.value,2),r=n[0],i=n[1];this.currentTiles.includes(i)||(this.cacheTiles.delete(r),this.onTileUnload(i)),this.onTileUnload(i),i.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError})}}catch(o){e.e(o)}finally{e.f()}}},{key:"pruneRequests",value:function(){var t,e=[],n=IQ(this.cacheTiles.values());try{for(n.s();!(t=n.n()).done;){var r=t.value;r.isLoading&&(r.isCurrent||r.isVisible||e.push(r))}}catch(i){n.e(i)}finally{n.f()}for(;e.length>0;){e.shift().abortLoad()}}},{key:"getTileByLngLat",value:function(t,e,n){var r=this.options.zoomOffset,i=Math.ceil(n)+r,o=AQ(t,e,i);return this.tiles.filter((function(t){return t.key==="".concat(o[0],"_").concat(o[1],"_").concat(i)}))[0]}},{key:"destroy",value:function(){var t,e=IQ(this.cacheTiles.values());try{for(e.s();!(t=e.n()).done;){var n=t.value;n.isLoading&&n.abortLoad()}}catch(r){e.e(r)}finally{e.f()}this.cacheTiles.clear(),this.currentTiles=[],this.removeAllListeners()}},{key:"updateTileVisible",value:function(){var t,e=this.options.updateStrategy,n=new Map,r=IQ(this.cacheTiles.values());try{for(r.s();!(t=r.n()).done;){var i=t.value;n.set(i.key,i.isVisible),i.isCurrent=!1,i.isVisible=!1}}catch(l){r.e(l)}finally{r.f()}var o,a=IQ(this.currentTiles);try{for(a.s();!(o=a.n()).done;){var s=o.value;s.isCurrent=!0,s.isVisible=!0}}catch(l){a.e(l)}finally{a.f()}var u=Array.from(this.cacheTiles.values());"function"==typeof e?e(u):MQ[e](u);var c=!1;Array.from(this.cacheTiles.values()).forEach((function(t){t.isVisible!==n.get(t.key)?(t.isVisibleChange=!0,c=!0):t.isVisibleChange=!1})),c&&this.emit("tile-update")}},{key:"getTileIndices",value:function(t,e){var n=this.options,r=n.tileSize,i=n.extent,o=n.zoomOffset,a=function(t){var e=t.zoom,n=t.latLonBounds,r=t.maxZoom,i=void 0===r?1/0:r,o=t.minZoom,a=void 0===o?0:o,s=t.zoomOffset,u=void 0===s?0:s,c=t.extent,l=void 0===c?SQ:c,h=Math.ceil(e)+u;if(Number.isFinite(a)&&h<a)return[];Number.isFinite(i)&&h>i&&(h=i);for(var f=lZ(n,4),p=f[0],d=f[1],m=f[2],v=f[3],g=[Math.max(p,l[0]),Math.max(d,l[1]),Math.min(m,l[2]),Math.min(v,l[3])],y=[],x=lZ(AQ(g[0],g[1],h),2),b=x[0],_=x[1],w=lZ(AQ(g[2],g[3],h),2),S=w[0],M=w[1],E=b;E<=S;E++)for(var A=M;A<=_;A++)y.push({x:E,y:A,z:h});var T=(S+b)/2,C=(_+M)/2,O=function(t,e){return Math.abs(t-T)+Math.abs(e-C)};return y.sort((function(t,e){return O(t.x,t.y)-O(e.x,e.y)})),y}({maxZoom:Math.floor(this.options.maxZoom),minZoom:Math.ceil(this.options.minZoom),zoomOffset:o,tileSize:r,zoom:t,latLonBounds:e,extent:i});return a}},{key:"getTileId",value:function(t,e,n){return"".concat(t,",").concat(e,",").concat(n)}},{key:"getTile",value:function(t,e,n){var r=this.getTileId(t,e,n);return this.cacheTiles.get(r)}},{key:"createTile",value:function(t,e,n){var r=this.getTileId(t,e,n),i=new RQ({x:t,y:e,z:n,tileSize:this.options.tileSize,warp:this.options.warp});return this.cacheTiles.set(r,i),i.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError}),i}},{key:"resizeCacheTiles",value:function(){var t=5*this.currentTiles.length;if(this.cacheTiles.size>t){var e,n=IQ(this.cacheTiles);try{for(n.s();!(e=n.n()).done;){var r=lZ(e.value,2),i=r[0],o=r[1];if(o.isVisible||this.currentTiles.includes(o)||(this.cacheTiles.delete(i),this.onTileUnload(o)),this.cacheTiles.size<=t)break}}catch(a){n.e(a)}finally{n.f()}}this.rebuildTileTree()}},{key:"rebuildTileTree",value:function(){var t,e=IQ(this.cacheTiles.values());try{for(e.s();!(t=e.n()).done;){var n=t.value;n.parent=null,n.children.length=0}}catch(s){e.e(s)}finally{e.f()}var r,i=IQ(this.cacheTiles.values());try{for(i.s();!(r=i.n()).done;){var o=r.value,a=this.getNearestAncestor(o.x,o.y,o.z);o.parent=a,null!=a&&a.children&&a.children.push(o)}}catch(s){i.e(s)}finally{i.f()}}},{key:"getNearestAncestor",value:function(t,e,n){for(;n>this.options.minZoom;){t=Math.floor(t/2),e=Math.floor(e/2),n-=1;var r=this.getTile(t,e,n);if(r)return r}return null}}]),n}();function zQ(t,e){var n=e.extent,r=void 0===n?[121.168,30.2828,121.384,30.4219]:n,i=new Promise((function(e){var n;t instanceof HTMLImageElement||(n=t,"undefined"!=typeof ImageBitmap&&n instanceof ImageBitmap)?e([t]):function(t,e){var n=t,r=[];if("string"==typeof n)sK({url:n},(function(t,n){n&&(r.push(n),e(r))}));else{var i=n.length,o=0;n.forEach((function(t){sK({url:t},(function(t,n){o++,n&&r.push(n),o===i&&e(r)}))}))}}(t,(function(t){e(t)}))}));return{originData:t,images:i,_id:1,dataArray:[{_id:0,coordinates:[[r[0],r[1]],[r[2],r[3]]]}]}}(jQ=FQ||(FQ={}))["GAODE1.x"]="GAODE1.x",jQ["GAODE2.x"]="GAODE2.x",jQ.MAPBOX="MAPBOX",jQ.DEFAULT="DEFAUlTMAP",jQ.SIMPLE="SIMPLE",jQ.GLOBEL="GLOBEL";var UQ=VQ;function VQ(t,e){this.x=t,this.y=e}VQ.prototype={clone:function(){return new VQ(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,n=t.y-this.y;return e*e+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[0]*this.x+t[1]*this.y,n=t[2]*this.x+t[3]*this.y;return this.x=e,this.y=n,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),n=Math.sin(t),r=e*this.x-n*this.y,i=n*this.x+e*this.y;return this.x=r,this.y=i,this},_rotateAround:function(t,e){var n=Math.cos(t),r=Math.sin(t),i=e.x+n*(this.x-e.x)-r*(this.y-e.y),o=e.y+r*(this.x-e.x)+n*(this.y-e.y);return this.x=i,this.y=o,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},VQ.convert=function(t){return t instanceof VQ?t:Array.isArray(t)?new VQ(t[0],t[1]):t};var GQ=UQ,WQ=HQ;function HQ(t,e,n,r,i){this.properties={},this.extent=n,this.type=0,this._pbf=t,this._geometry=-1,this._keys=r,this._values=i,t.readFields(YQ,this,e)}function YQ(t,e,n){1==t?e.id=n.readVarint():2==t?function(t,e){var n=t.readVarint()+t.pos;for(;t.pos<n;){var r=e._keys[t.readVarint()],i=e._values[t.readVarint()];e.properties[r]=i}}(n,e):3==t?e.type=n.readVarint():4==t&&(e._geometry=n.pos)}function XQ(t){for(var e,n,r=0,i=0,o=t.length,a=o-1;i<o;a=i++)e=t[i],r+=((n=t[a]).x-e.x)*(e.y+n.y);return r}HQ.types=["Unknown","Point","LineString","Polygon"],HQ.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,n=t.readVarint()+t.pos,r=1,i=0,o=0,a=0,s=[];t.pos<n;){if(i<=0){var u=t.readVarint();r=7&u,i=u>>3}if(i--,1===r||2===r)o+=t.readSVarint(),a+=t.readSVarint(),1===r&&(e&&s.push(e),e=[]),e.push(new GQ(o,a));else{if(7!==r)throw new Error("unknown command "+r);e&&e.push(e[0].clone())}}return e&&s.push(e),s},HQ.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,n=1,r=0,i=0,o=0,a=1/0,s=-1/0,u=1/0,c=-1/0;t.pos<e;){if(r<=0){var l=t.readVarint();n=7&l,r=l>>3}if(r--,1===n||2===n)(i+=t.readSVarint())<a&&(a=i),i>s&&(s=i),(o+=t.readSVarint())<u&&(u=o),o>c&&(c=o);else if(7!==n)throw new Error("unknown command "+n)}return[a,u,s,c]},HQ.prototype.toGeoJSON=function(t,e,n){var r,i,o=this.extent*Math.pow(2,n),a=this.extent*t,s=this.extent*e,u=this.loadGeometry(),c=HQ.types[this.type];function l(t){for(var e=0;e<t.length;e++){var n=t[e],r=180-360*(n.y+s)/o;t[e]=[360*(n.x+a)/o-180,360/Math.PI*Math.atan(Math.exp(r*Math.PI/180))-90]}}switch(this.type){case 1:var h=[];for(r=0;r<u.length;r++)h[r]=u[r][0];l(u=h);break;case 2:for(r=0;r<u.length;r++)l(u[r]);break;case 3:for(u=function(t){var e=t.length;if(e<=1)return[t];for(var n,r,i=[],o=0;o<e;o++){var a=XQ(t[o]);0!==a&&(void 0===r&&(r=a<0),r===a<0?(n&&i.push(n),n=[t[o]]):n.push(t[o]))}n&&i.push(n);return i}(u),r=0;r<u.length;r++)for(i=0;i<u[r].length;i++)l(u[r][i])}1===u.length?u=u[0]:c="Multi"+c;var f={type:"Feature",geometry:{type:c,coordinates:u},properties:this.properties};return"id"in this&&(f.id=this.id),f};var qQ=WQ,ZQ=$Q;function $Q(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(KQ,this,e),this.length=this._features.length}function KQ(t,e,n){15===t?e.version=n.readVarint():1===t?e.name=n.readString():5===t?e.extent=n.readVarint():2===t?e._features.push(n.pos):3===t?e._keys.push(n.readString()):4===t&&e._values.push(function(t){var e=null,n=t.readVarint()+t.pos;for(;t.pos<n;){var r=t.readVarint()>>3;e=1===r?t.readString():2===r?t.readFloat():3===r?t.readDouble():4===r?t.readVarint64():5===r?t.readVarint():6===r?t.readSVarint():7===r?t.readBoolean():null}return e}(n))}$Q.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new qQ(this._pbf,e,this.extent,this._keys,this._values)};var JQ=ZQ;function QQ(t,e,n){if(3===t){var r=new JQ(n,n.readVarint()+n.pos);r.length&&(e[r.name]=r)}}var t0=function(t,e){this.layers=t.readFields(QQ,{},e)},e0={
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
read:function(t,e,n,r,i){var o,a,s=8*i-r-1,u=(1<<s)-1,c=u>>1,l=-7,h=n?i-1:0,f=n?-1:1,p=t[e+h];for(h+=f,o=p&(1<<-l)-1,p>>=-l,l+=s;l>0;o=256*o+t[e+h],h+=f,l-=8);for(a=o&(1<<-l)-1,o>>=-l,l+=r;l>0;a=256*a+t[e+h],h+=f,l-=8);if(0===o)o=1-c;else{if(o===u)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,r),o-=c}return(p?-1:1)*a*Math.pow(2,o-r)},write:function(t,e,n,r,i,o){var a,s,u,c=8*o-i-1,l=(1<<c)-1,h=l>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,d=r?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=l):(a=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-a))<1&&(a--,u*=2),(e+=a+h>=1?f/u:f*Math.pow(2,1-h))*u>=2&&(a++,u/=2),a+h>=l?(s=0,a=l):a+h>=1?(s=(e*u-1)*Math.pow(2,i),a+=h):(s=e*Math.pow(2,h-1)*Math.pow(2,i),a=0));i>=8;t[n+p]=255&s,p+=d,s/=256,i-=8);for(a=a<<i|s,c+=i;c>0;t[n+p]=255&a,p+=d,a/=256,c-=8);t[n+p-d]|=128*m}},n0=i0,r0=e0;function i0(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}i0.Varint=0,i0.Fixed64=1,i0.Bytes=2,i0.Fixed32=5;var o0=4294967296,a0=1/o0,s0="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function u0(t){return t.type===i0.Bytes?t.readVarint()+t.pos:t.pos+1}function c0(t,e,n){return n?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function l0(t,e,n){var r=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));n.realloc(r);for(var i=n.pos-1;i>=t;i--)n.buf[i+r]=n.buf[i]}function h0(t,e){for(var n=0;n<t.length;n++)e.writeVarint(t[n])}function f0(t,e){for(var n=0;n<t.length;n++)e.writeSVarint(t[n])}function p0(t,e){for(var n=0;n<t.length;n++)e.writeFloat(t[n])}function d0(t,e){for(var n=0;n<t.length;n++)e.writeDouble(t[n])}function m0(t,e){for(var n=0;n<t.length;n++)e.writeBoolean(t[n])}function v0(t,e){for(var n=0;n<t.length;n++)e.writeFixed32(t[n])}function g0(t,e){for(var n=0;n<t.length;n++)e.writeSFixed32(t[n])}function y0(t,e){for(var n=0;n<t.length;n++)e.writeFixed64(t[n])}function x0(t,e){for(var n=0;n<t.length;n++)e.writeSFixed64(t[n])}function b0(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function _0(t,e,n){t[n]=e,t[n+1]=e>>>8,t[n+2]=e>>>16,t[n+3]=e>>>24}function w0(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}i0.prototype={destroy:function(){this.buf=null},readFields:function(t,e,n){for(n=n||this.length;this.pos<n;){var r=this.readVarint(),i=r>>3,o=this.pos;this.type=7&r,t(i,e,this),this.pos===o&&this.skip(r)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=b0(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=w0(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=b0(this.buf,this.pos)+b0(this.buf,this.pos+4)*o0;return this.pos+=8,t},readSFixed64:function(){var t=b0(this.buf,this.pos)+w0(this.buf,this.pos+4)*o0;return this.pos+=8,t},readFloat:function(){var t=r0.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=r0.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,n,r=this.buf;return e=127&(n=r[this.pos++]),n<128?e:(e|=(127&(n=r[this.pos++]))<<7,n<128?e:(e|=(127&(n=r[this.pos++]))<<14,n<128?e:(e|=(127&(n=r[this.pos++]))<<21,n<128?e:function(t,e,n){var r,i,o=n.buf;if(i=o[n.pos++],r=(112&i)>>4,i<128)return c0(t,r,e);if(i=o[n.pos++],r|=(127&i)<<3,i<128)return c0(t,r,e);if(i=o[n.pos++],r|=(127&i)<<10,i<128)return c0(t,r,e);if(i=o[n.pos++],r|=(127&i)<<17,i<128)return c0(t,r,e);if(i=o[n.pos++],r|=(127&i)<<24,i<128)return c0(t,r,e);if(i=o[n.pos++],r|=(1&i)<<31,i<128)return c0(t,r,e);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(n=r[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&s0?function(t,e,n){return s0.decode(t.subarray(e,n))}(this.buf,e,t):function(t,e,n){var r="",i=e;for(;i<n;){var o,a,s,u=t[i],c=null,l=u>239?4:u>223?3:u>191?2:1;if(i+l>n)break;1===l?u<128&&(c=u):2===l?128==(192&(o=t[i+1]))&&(c=(31&u)<<6|63&o)<=127&&(c=null):3===l?(o=t[i+1],a=t[i+2],128==(192&o)&&128==(192&a)&&((c=(15&u)<<12|(63&o)<<6|63&a)<=2047||c>=55296&&c<=57343)&&(c=null)):4===l&&(o=t[i+1],a=t[i+2],s=t[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&((c=(15&u)<<18|(63&o)<<12|(63&a)<<6|63&s)<=65535||c>=1114112)&&(c=null)),null===c?(c=65533,l=1):c>65535&&(c-=65536,r+=String.fromCharCode(c>>>10&1023|55296),c=56320|1023&c),r+=String.fromCharCode(c),i+=l}return r}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==i0.Bytes)return t.push(this.readVarint(e));var n=u0(this);for(t=t||[];this.pos<n;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==i0.Bytes)return t.push(this.readSVarint());var e=u0(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==i0.Bytes)return t.push(this.readBoolean());var e=u0(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==i0.Bytes)return t.push(this.readFloat());var e=u0(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==i0.Bytes)return t.push(this.readDouble());var e=u0(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==i0.Bytes)return t.push(this.readFixed32());var e=u0(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==i0.Bytes)return t.push(this.readSFixed32());var e=u0(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==i0.Bytes)return t.push(this.readFixed64());var e=u0(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==i0.Bytes)return t.push(this.readSFixed64());var e=u0(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===i0.Varint)for(;this.buf[this.pos++]>127;);else if(e===i0.Bytes)this.pos=this.readVarint()+this.pos;else if(e===i0.Fixed32)this.pos+=4;else{if(e!==i0.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var n=new Uint8Array(e);n.set(this.buf),this.buf=n,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),_0(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),_0(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),_0(this.buf,-1&t,this.pos),_0(this.buf,Math.floor(t*a0),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),_0(this.buf,-1&t,this.pos),_0(this.buf,Math.floor(t*a0),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(t,e){var n,r;t>=0?(n=t%4294967296|0,r=t/4294967296|0):(r=~(-t/4294967296),4294967295^(n=~(-t%4294967296))?n=n+1|0:(n=0,r=r+1|0));if(t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),function(t,e,n){n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos]=127&t}(n,0,e),function(t,e){var n=(7&t)<<4;if(e.buf[e.pos++]|=n|((t>>>=3)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;e.buf[e.pos++]=127&t}(r,e)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,n){for(var r,i,o=0;o<e.length;o++){if((r=e.charCodeAt(o))>55295&&r<57344){if(!i){r>56319||o+1===e.length?(t[n++]=239,t[n++]=191,t[n++]=189):i=r;continue}if(r<56320){t[n++]=239,t[n++]=191,t[n++]=189,i=r;continue}r=i-55296<<10|r-56320|65536,i=null}else i&&(t[n++]=239,t[n++]=191,t[n++]=189,i=null);r<128?t[n++]=r:(r<2048?t[n++]=r>>6|192:(r<65536?t[n++]=r>>12|224:(t[n++]=r>>18|240,t[n++]=r>>12&63|128),t[n++]=r>>6&63|128),t[n++]=63&r|128)}return n}(this.buf,t,this.pos);var n=this.pos-e;n>=128&&l0(e,n,this),this.pos=e-1,this.writeVarint(n),this.pos+=n},writeFloat:function(t){this.realloc(4),r0.write(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),r0.write(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var n=0;n<e;n++)this.buf[this.pos++]=t[n]},writeRawMessage:function(t,e){this.pos++;var n=this.pos;t(e,this);var r=this.pos-n;r>=128&&l0(n,r,this),this.pos=n-1,this.writeVarint(r),this.pos+=r},writeMessage:function(t,e,n){this.writeTag(t,i0.Bytes),this.writeRawMessage(e,n)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,h0,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,f0,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,m0,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,p0,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,d0,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,v0,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,g0,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,y0,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,x0,e)},writeBytesField:function(t,e){this.writeTag(t,i0.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,i0.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,i0.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,i0.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,i0.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,i0.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,i0.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,i0.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,i0.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,i0.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}};var S0=function(){function t(e,n,r,i){mZ(this,t),$q(this,"vectorLayerCache",{}),this.x=n,this.y=r,this.z=i,this.vectorTile=new t0(new n0(e))}return gZ(t,[{key:"getTileData",value:function(t){if(!t||!this.vectorTile.layers[t])return[];if(this.vectorLayerCache[t])return this.vectorLayerCache[t];var e=this.vectorTile.layers[t];if(Array.isArray(e.features))return this.vectorLayerCache[t]=e.features,e.features;for(var n=[],r=0;r<e.length;r++){var i=e.feature(r).toGeoJSON(this.x,this.y,this.z);n.push(Jq(Jq({},i),{},{properties:Jq({id:i.id},i.properties)}))}return this.vectorLayerCache[t]=n,n}},{key:"getFeatureById",value:function(){throw new Error("Method not implemented.")}}]),t}(),M0={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,warp:!0},E0=function(){var t=RK(jK.mark((function t(e,n,r,i){var o;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=kQ(e,n),t.abrupt("return",new Promise((function(t){var e=oK(Jq(Jq({},i),{},{url:o}),(function(e,n){if(e||!n)t(void 0);else{var i=new S0(n,r.x,r.y,r.z);t(i)}}));r.xhrCancel=function(){return e.abort()}})));case 2:case"end":return t.stop()}}),t)})));return function(e,n,r,i){return t.apply(this,arguments)}}();function A0(t,e,n,r){for(var i,o=r,a=n-e>>1,s=n-e,u=t[e],c=t[e+1],l=t[n],h=t[n+1],f=e+3;f<n;f+=3){var p=T0(t[f],t[f+1],u,c,l,h);if(p>o)i=f,o=p;else if(p===o){var d=Math.abs(f-a);d<s&&(i=f,s=d)}}o>r&&(i-e>3&&A0(t,e,i,r),t[i+2]=o,n-i>3&&A0(t,i,n,r))}function T0(t,e,n,r,i,o){var a=i-n,s=o-r;if(0!==a||0!==s){var u=((t-n)*a+(e-r)*s)/(a*a+s*s);u>1?(n=i,r=o):u>0&&(n+=a*u,r+=s*u)}return(a=t-n)*a+(s=e-r)*s}function C0(t,e,n,r){var i={id:void 0===t?null:t,type:e,geometry:n,tags:r,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(t){var e=t.geometry,n=t.type;if("Point"===n||"MultiPoint"===n||"LineString"===n)O0(t,e);else if("Polygon"===n||"MultiLineString"===n)for(var r=0;r<e.length;r++)O0(t,e[r]);else if("MultiPolygon"===n)for(r=0;r<e.length;r++)for(var i=0;i<e[r].length;i++)O0(t,e[r][i])}(i),i}function O0(t,e){for(var n=0;n<e.length;n+=3)t.minX=Math.min(t.minX,e[n]),t.minY=Math.min(t.minY,e[n+1]),t.maxX=Math.max(t.maxX,e[n]),t.maxY=Math.max(t.maxY,e[n+1])}function k0(t,e,n,r){if(e.geometry){var i=e.geometry.coordinates,o=e.geometry.type,a=Math.pow(n.tolerance/((1<<n.maxZoom)*n.extent),2),s=[],u=e.id;if(n.promoteId?u=e.properties[n.promoteId]:n.generateId&&(u=r||0),"Point"===o)P0(i,s);else if("MultiPoint"===o)for(var c=0;c<i.length;c++)P0(i[c],s);else if("LineString"===o)L0(i,s,a,!1);else if("MultiLineString"===o){if(n.lineMetrics){for(c=0;c<i.length;c++)s=[],L0(i[c],s,a,!1),t.push(C0(u,"LineString",s,e.properties));return}R0(i,s,a,!1)}else if("Polygon"===o)R0(i,s,a,!0);else{if("MultiPolygon"!==o){if("GeometryCollection"===o){for(c=0;c<e.geometry.geometries.length;c++)k0(t,{id:u,geometry:e.geometry.geometries[c],properties:e.properties},n,r);return}throw new Error("Input data is not a valid GeoJSON object.")}for(c=0;c<i.length;c++){var l=[];R0(i[c],l,a,!0),s.push(l)}}t.push(C0(u,o,s,e.properties))}}function P0(t,e){e.push(I0(t[0])),e.push(N0(t[1])),e.push(0)}function L0(t,e,n,r){for(var i,o,a=0,s=0;s<t.length;s++){var u=I0(t[s][0]),c=N0(t[s][1]);e.push(u),e.push(c),e.push(0),s>0&&(a+=r?(i*c-u*o)/2:Math.sqrt(Math.pow(u-i,2)+Math.pow(c-o,2))),i=u,o=c}var l=e.length-3;e[2]=1,A0(e,0,l,n),e[l+2]=1,e.size=Math.abs(a),e.start=0,e.end=e.size}function R0(t,e,n,r){for(var i=0;i<t.length;i++){var o=[];L0(t[i],o,n,r),e.push(o)}}function I0(t){return t/360+.5}function N0(t){var e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}function D0(t,e,n,r,i,o,a,s){if(r/=e,o>=(n/=e)&&a<r)return t;if(a<n||o>=r)return null;for(var u=[],c=0;c<t.length;c++){var l=t[c],h=l.geometry,f=l.type,p=0===i?l.minX:l.minY,d=0===i?l.maxX:l.maxY;if(p>=n&&d<r)u.push(l);else if(!(d<n||p>=r)){var m=[];if("Point"===f||"MultiPoint"===f)F0(h,m,n,r,i);else if("LineString"===f)j0(h,m,n,r,i,!1,s.lineMetrics);else if("MultiLineString"===f)z0(h,m,n,r,i,!1);else if("Polygon"===f)z0(h,m,n,r,i,!0);else if("MultiPolygon"===f)for(var v=0;v<h.length;v++){var g=[];z0(h[v],g,n,r,i,!0),g.length&&m.push(g)}if(m.length){if(s.lineMetrics&&"LineString"===f){for(v=0;v<m.length;v++)u.push(C0(l.id,f,m[v],l.tags));continue}"LineString"!==f&&"MultiLineString"!==f||(1===m.length?(f="LineString",m=m[0]):f="MultiLineString"),"Point"!==f&&"MultiPoint"!==f||(f=3===m.length?"Point":"MultiPoint"),u.push(C0(l.id,f,m,l.tags))}}}return u.length?u:null}function F0(t,e,n,r,i){for(var o=0;o<t.length;o+=3){var a=t[o+i];a>=n&&a<=r&&(e.push(t[o]),e.push(t[o+1]),e.push(t[o+2]))}}function j0(t,e,n,r,i,o,a){for(var s,u,c=B0(t),l=0===i?V0:G0,h=t.start,f=0;f<t.length-3;f+=3){var p=t[f],d=t[f+1],m=t[f+2],v=t[f+3],g=t[f+4],y=0===i?p:d,x=0===i?v:g,b=!1;a&&(s=Math.sqrt(Math.pow(p-v,2)+Math.pow(d-g,2))),y<n?x>n&&(u=l(c,p,d,v,g,n),a&&(c.start=h+s*u)):y>r?x<r&&(u=l(c,p,d,v,g,r),a&&(c.start=h+s*u)):U0(c,p,d,m),x<n&&y>=n&&(u=l(c,p,d,v,g,n),b=!0),x>r&&y<=r&&(u=l(c,p,d,v,g,r),b=!0),!o&&b&&(a&&(c.end=h+s*u),e.push(c),c=B0(t)),a&&(h+=s)}var _=t.length-3;p=t[_],d=t[_+1],m=t[_+2],(y=0===i?p:d)>=n&&y<=r&&U0(c,p,d,m),_=c.length-3,o&&_>=3&&(c[_]!==c[0]||c[_+1]!==c[1])&&U0(c,c[0],c[1],c[2]),c.length&&e.push(c)}function B0(t){var e=[];return e.size=t.size,e.start=t.start,e.end=t.end,e}function z0(t,e,n,r,i,o){for(var a=0;a<t.length;a++)j0(t[a],e,n,r,i,o,!1)}function U0(t,e,n,r){t.push(e),t.push(n),t.push(r)}function V0(t,e,n,r,i,o){var a=(o-e)/(r-e);return t.push(o),t.push(n+(i-n)*a),t.push(1),a}function G0(t,e,n,r,i,o){var a=(o-n)/(i-n);return t.push(e+(r-e)*a),t.push(o),t.push(1),a}function W0(t,e){for(var n=[],r=0;r<t.length;r++){var i,o=t[r],a=o.type;if("Point"===a||"MultiPoint"===a||"LineString"===a)i=H0(o.geometry,e);else if("MultiLineString"===a||"Polygon"===a){i=[];for(var s=0;s<o.geometry.length;s++)i.push(H0(o.geometry[s],e))}else if("MultiPolygon"===a)for(i=[],s=0;s<o.geometry.length;s++){for(var u=[],c=0;c<o.geometry[s].length;c++)u.push(H0(o.geometry[s][c],e));i.push(u)}n.push(C0(o.id,a,i,o.tags))}return n}function H0(t,e){var n=[];n.size=t.size,void 0!==t.start&&(n.start=t.start,n.end=t.end);for(var r=0;r<t.length;r+=3)n.push(t[r]+e,t[r+1],t[r+2]);return n}function Y0(t,e){if(t.transformed)return t;var n,r,i,o=1<<t.z,a=t.x,s=t.y;for(n=0;n<t.features.length;n++){var u=t.features[n],c=u.geometry,l=u.type;if(u.geometry=[],1===l)for(r=0;r<c.length;r+=2)u.geometry.push(X0(c[r],c[r+1],e,o,a,s));else for(r=0;r<c.length;r++){var h=[];for(i=0;i<c[r].length;i+=2)h.push(X0(c[r][i],c[r][i+1],e,o,a,s));u.geometry.push(h)}}return t.transformed=!0,t}function X0(t,e,n,r,i,o){return[Math.round(n*(t*r-i)),Math.round(n*(e*r-o))]}function q0(t,e,n,r,i){for(var o=e===i.maxZoom?0:i.tolerance/((1<<e)*i.extent),a={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:n,y:r,z:e,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},s=0;s<t.length;s++){a.numFeatures++,Z0(a,t[s],o,i);var u=t[s].minX,c=t[s].minY,l=t[s].maxX,h=t[s].maxY;u<a.minX&&(a.minX=u),c<a.minY&&(a.minY=c),l>a.maxX&&(a.maxX=l),h>a.maxY&&(a.maxY=h)}return a}function Z0(t,e,n,r){var i=e.geometry,o=e.type,a=[];if("Point"===o||"MultiPoint"===o)for(var s=0;s<i.length;s+=3)a.push(i[s]),a.push(i[s+1]),t.numPoints++,t.numSimplified++;else if("LineString"===o)$0(a,i,t,n,!1,!1);else if("MultiLineString"===o||"Polygon"===o)for(s=0;s<i.length;s++)$0(a,i[s],t,n,"Polygon"===o,0===s);else if("MultiPolygon"===o)for(var u=0;u<i.length;u++){var c=i[u];for(s=0;s<c.length;s++)$0(a,c[s],t,n,!0,0===s)}if(a.length){var l=e.tags||null;if("LineString"===o&&r.lineMetrics){for(var h in l={},e.tags)l[h]=e.tags[h];l.mapbox_clip_start=i.start/i.size,l.mapbox_clip_end=i.end/i.size}var f={geometry:a,type:"Polygon"===o||"MultiPolygon"===o?3:"LineString"===o||"MultiLineString"===o?2:1,tags:l};null!==e.id&&(f.id=e.id),t.features.push(f)}}function $0(t,e,n,r,i,o){var a=r*r;if(r>0&&e.size<(i?a:r))n.numPoints+=e.length/3;else{for(var s=[],u=0;u<e.length;u+=3)(0===r||e[u+2]>a)&&(n.numSimplified++,s.push(e[u]),s.push(e[u+1])),n.numPoints++;i&&function(t,e){for(var n=0,r=0,i=t.length,o=i-2;r<i;o=r,r+=2)n+=(t[r]-t[o])*(t[r+1]+t[o+1]);if(n>0===e)for(r=0,i=t.length;r<i/2;r+=2){var a=t[r],s=t[r+1];t[r]=t[i-2-r],t[r+1]=t[i-1-r],t[i-2-r]=a,t[i-1-r]=s}}(s,o),t.push(s)}}function K0(t,e){e=this.options=function(t,e){for(var n in e)t[n]=e[n];return t}(Object.create(this.options),e);var n=e.debug;if(e.maxZoom<0||e.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(e.promoteId&&e.generateId)throw new Error("promoteId and generateId cannot be used together.");var r=function(t,e){var n=[];if("FeatureCollection"===t.type)for(var r=0;r<t.features.length;r++)k0(n,t.features[r],e,r);else"Feature"===t.type?k0(n,t,e):k0(n,{geometry:t},e);return n}(t,e);this.tiles={},this.tileCoords=[],n&&(this.stats={},this.total=0),r=function(t,e){var n=e.buffer/e.extent,r=t,i=D0(t,1,-1-n,n,0,-1,2,e),o=D0(t,1,1-n,2+n,0,-1,2,e);return(i||o)&&(r=D0(t,1,-n,1+n,0,-1,2,e)||[],i&&(r=W0(i,1).concat(r)),o&&(r=r.concat(W0(o,-1)))),r}(r,e),r.length&&this.splitTile(r,0,0,0),n&&r.length}function J0(t,e,n){return 32*((1<<t)*n+e)+t}K0.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},K0.prototype.splitTile=function(t,e,n,r,i,o,a){for(var s=[t,e,n,r],u=this.options,c=u.debug;s.length;){r=s.pop(),n=s.pop(),e=s.pop(),t=s.pop();var l=1<<e,h=J0(e,n,r),f=this.tiles[h];if(!f&&(f=this.tiles[h]=q0(t,e,n,r,u),this.tileCoords.push({z:e,x:n,y:r}),c)){var p="z"+e;this.stats[p]=(this.stats[p]||0)+1,this.total++}if(f.source=t,i){if(e===u.maxZoom||e===i)continue;var d=1<<i-e;if(n!==Math.floor(o/d)||r!==Math.floor(a/d))continue}else if(e===u.indexMaxZoom||f.numPoints<=u.indexMaxPoints)continue;if(f.source=null,0!==t.length){var m,v,g,y,x,b,_=.5*u.buffer/u.extent,w=.5-_,S=.5+_,M=1+_;m=v=g=y=null,x=D0(t,l,n-_,n+S,0,f.minX,f.maxX,u),b=D0(t,l,n+w,n+M,0,f.minX,f.maxX,u),t=null,x&&(m=D0(x,l,r-_,r+S,1,f.minY,f.maxY,u),v=D0(x,l,r+w,r+M,1,f.minY,f.maxY,u),x=null),b&&(g=D0(b,l,r-_,r+S,1,f.minY,f.maxY,u),y=D0(b,l,r+w,r+M,1,f.minY,f.maxY,u),b=null),s.push(m||[],e+1,2*n,2*r),s.push(v||[],e+1,2*n,2*r+1),s.push(g||[],e+1,2*n+1,2*r),s.push(y||[],e+1,2*n+1,2*r+1)}}},K0.prototype.getTile=function(t,e,n){var r=this.options,i=r.extent;r.debug;if(t<0||t>24)return null;var o=1<<t,a=J0(t,e=(e%o+o)%o,n);if(this.tiles[a])return Y0(this.tiles[a],i);for(var s,u=t,c=e,l=n;!s&&u>0;)u--,c=Math.floor(c/2),l=Math.floor(l/2),s=this.tiles[J0(u,c,l)];return s&&s.source?(this.splitTile(s.source,u,c,l,t,e,n),this.tiles[a]?Y0(this.tiles[a],i):null):null};var Q0=function(){function t(e,n,r,i){mZ(this,t),$q(this,"vectorLayerCache",{}),this.x=n,this.y=r,this.z=i,this.vectorTile=e}return gZ(t,[{key:"getTileData",value:function(t){return t&&this.vectorTile.layers[t]?this.vectorLayerCache[t]?this.vectorLayerCache[t]:this.vectorTile.layers[t].features:[]}},{key:"getFeatureById",value:function(){throw new Error("Method not implemented.")}}]),t}(),t1={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0};function e1(t){for(var e,n,r=0,i=0,o=t.length,a=o-1;i<o;a=i++)e=t[i],r+=((n=t[a]).x-e.x)*(e.y+n.y);return r}var n1=["Unknown","Point","LineString","Polygon"];function r1(t,e,n,r,i){var o,a,s=i.geometry,u=i.type,c=i.tags,l=i.id,h=t*Math.pow(2,r),f=t*e,p=t*n,d=n1[u];function m(t){for(var e=0;e<t.length;e++){var n=t[e];if(n[3])break;var r=180-360*(n[1]+p)/h,i=360*(n[0]+f)/h-180,o=360/Math.PI*Math.atan(Math.exp(r*Math.PI/180))-90;t[e]=[i,o,0,1]}}switch(u){case 1:var v=[];for(o=0;o<s.length;o++)v[o]=s[o][0];m(s=v);break;case 2:for(o=0;o<s.length;o++)m(s[o]);break;case 3:for(s=function(t){var e=t.length;if(e<=1)return[t];for(var n,r,i=[],o=0;o<e;o++){var a=e1(t[o]);0!==a&&(void 0===r&&(r=a<0),r===a<0?(n&&i.push(n),n=[t[o]]):n.push(t[o]))}return n&&i.push(n),i}(s),o=0;o<s.length;o++)for(a=0;a<s[o].length;a++)m(s[o][a])}return 1===s.length?s=s[0]:d="Multi"+d,{type:"Feature",geometry:{type:d,coordinates:s},properties:c,id:l,tileOrigin:[0,0],coord:""}}var i1=function(){var t=RK(jK.mark((function t(e,n,r,i){return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){var o=n.getTile(e.z,e.x,e.y),a=o?o.features.map((function(t){return r1(i,r.x,r.y,r.z,t)})):[];t(new Q0({layers:{defaultLayer:{features:a}}},e.x,e.y,e.z))})));case 1:case"end":return t.stop()}}),t)})));return function(e,n,r,i){return t.apply(this,arguments)}}();function o1(t,e){for(var n=e[0],r=n.width,i=n.height,o=e.map((function(t){return t.rasterData})),a=r*i,s=[],u=JSON.stringify(t),c=0;c<a;c++){var l=JSON.parse(u),h=a1(l,o,c);if("number"==typeof h)s.push(h);else{var f=s1(l);s.push(f)}}return s}function a1(t,e,n){if(2===t.length&&"band"===t[0]&&"number"==typeof t[1])try{return e[t[1]][n]}catch(r){return 0}t.map((function(i,o){if(Array.isArray(i)&&i.length>0)if("band"===i[0])try{t[o]=e[i[1]][n]}catch(r){t[o]=0}else a1(i,e,n)}))}function s1(t){var e=function(t){var e=lZ(t,3),n=e[0],r=e[1],i=void 0===r?-1:r,o=e[2],a=void 0===o?-1:o;return void 0===n?["+",0,0]:[n.replace(/\s+/g,""),i,a]}(t),n=e[0],r=e[1],i=e[2];return Array.isArray(r)&&(r=s1(t[1])),Array.isArray(i)&&(i=s1(t[2])),function(t,e,n){switch(t){case"+":return e+n;case"-":return e-n;case"*":return e*n;case"/":return e/n;case"%":return e%n;case"^":return Math.pow(e,n);case"abs":return Math.abs(e);case"floor":return Math.floor(e);case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"sin":return Math.sin(e);case"cos":return Math.cos(e);case"atan":return-1===n?Math.atan(e):Math.atan2(e,n);default:return 0}}(n,r,i)}var u1={nd:{type:"operation",expression:["/",["-",["band",1],["band",0]],["+",["band",1],["band",0]]]},rgb:{type:"function",method:function(t,e){for(var n=t[0].rasterData,r=t[1].rasterData,i=t[2].rasterData,o=[],a=lZ((null==e?void 0:e.countCut)||[2,98],2),s=a[0],u=a[1],c=(null==e?void 0:e.RMinMax)||c1(n,s,u),l=(null==e?void 0:e.GMinMax)||c1(r,s,u),h=(null==e?void 0:e.BMinMax)||c1(i,s,u),f=0;f<n.length;f++)o.push(Math.max(0,n[f]-c[0])),o.push(Math.max(0,r[f]-l[0])),o.push(Math.max(0,i[f]-h[0]));return{rasterData:o,rMinMax:c,gMinMax:l,bMinMax:h}}}};function c1(t,e,n){var r=t.slice().sort((function(t,e){return t-e})),i=r.length;return[r[Math.ceil(i*e/100)],r[Math.ceil(i*n/100)]]}function l1(t,e,n){return h1.apply(this,arguments)}function h1(){return h1=RK(jK.mark((function t(e,n,r){var i,o,a,s,u,c;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0!==e.length){t.next=2;break}return t.abrupt("return",{rasterData:[0],width:1,heigh:1});case 2:return t.next=4,Promise.all(e.map((function(t){var e=t.data,r=t.bands;return n(e,void 0===r?[0]:r)})));case 4:i=t.sent,o=[],i.forEach((function(t){Array.isArray(t)?o.push.apply(o,Xq(t)):o.push(t)})),a=o[0],s=a.width,u=a.height,t.t0=qq(r),t.next="function"===t.t0?11:"object"===t.t0?13:15;break;case 11:return c=r(o),t.abrupt("break",16);case 13:return c=Array.isArray(r)?{rasterData:o1(r,o)}:f1(r,o),t.abrupt("break",16);case 15:c={rasterData:o[0].rasterData};case 16:return t.abrupt("return",Jq(Jq({},c),{},{width:s,height:u}));case 17:case"end":return t.stop()}}),t)}))),h1.apply(this,arguments)}function f1(t,e){var n=u1[t.type];return"function"===n.type?n.method(e,null==t?void 0:t.options):"operation"===n.type?"rgb"===t.type?function(t,e){t.r;t.g;t.b;var n=o1(t.r||["band",0],e),r=o1(t.g||["band",0],e),i=o1(t.b||["band",0],e);return[n,r,i]}(n.expression,e):{rasterData:o1(n.expression,e)}:void 0}function p1(t,e,n,r){return d1.apply(this,arguments)}function d1(){return(d1=RK(jK.mark((function t(e,n,r,i){var o;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l1(e,n,r);case 2:o=t.sent,i(null,{data:o});case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function m1(t){return!!Array.isArray(t)&&(0===t.length||"number"==typeof t[0])}function v1(t,e){if(null==t)return{};var n,r,i=function(t,e){if(null==t)return{};var n,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}var g1,y1,x1=["extent","min","max","width","height","format","operation"];y1=g1||(g1={}),function(t){var e="object"==typeof G?G:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),n=r(y1);function r(t,e){return function(n,r){"function"!=typeof t[n]&&Object.defineProperty(t,n,{configurable:!0,writable:!0,value:r}),e&&e(n,r)}}void 0===e.Reflect?e.Reflect=y1:n=r(e.Reflect,n),function(t){var e=Object.prototype.hasOwnProperty,n="function"==typeof Symbol,r=n&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",i=n&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",o="function"==typeof Object.create,a={__proto__:[]}instanceof Array,s=!o&&!a,u={create:o?function(){return rt(Object.create(null))}:a?function(){return rt({__proto__:null})}:function(){return rt({})},has:s?function(t,n){return e.call(t,n)}:function(t,e){return e in t},get:s?function(t,n){return e.call(t,n)?t[n]:void 0}:function(t,e){return t[e]}},c=Object.getPrototypeOf(Function),l="object"==typeof process&&process.env&&"true"===process.env.REFLECT_METADATA_USE_MAP_POLYFILL,h=l||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?tt():Map,f=l||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?et():Set,p=new(l||"function"!=typeof WeakMap?nt():WeakMap);function d(t,e,n,r){if(N(n)){if(!W(t))throw new TypeError;if(!Y(e))throw new TypeError;return M(t,e)}if(!W(t))throw new TypeError;if(!j(e))throw new TypeError;if(!j(r)&&!N(r)&&!D(r))throw new TypeError;return D(r)&&(r=void 0),E(t,e,n=G(n),r)}function m(t,e){function n(n,r){if(!j(n))throw new TypeError;if(!N(r)&&!X(r))throw new TypeError;P(t,e,n,r)}return n}function v(t,e,n,r){if(!j(n))throw new TypeError;return N(r)||(r=G(r)),P(t,e,n,r)}function g(t,e,n){if(!j(e))throw new TypeError;return N(n)||(n=G(n)),T(t,e,n)}function y(t,e,n){if(!j(e))throw new TypeError;return N(n)||(n=G(n)),C(t,e,n)}function x(t,e,n){if(!j(e))throw new TypeError;return N(n)||(n=G(n)),O(t,e,n)}function b(t,e,n){if(!j(e))throw new TypeError;return N(n)||(n=G(n)),k(t,e,n)}function _(t,e){if(!j(t))throw new TypeError;return N(e)||(e=G(e)),L(t,e)}function w(t,e){if(!j(t))throw new TypeError;return N(e)||(e=G(e)),R(t,e)}function S(t,e,n){if(!j(e))throw new TypeError;N(n)||(n=G(n));var r=A(e,n,!1);if(N(r))return!1;if(!r.delete(t))return!1;if(r.size>0)return!0;var i=p.get(e);return i.delete(n),i.size>0||p.delete(e),!0}function M(t,e){for(var n=t.length-1;n>=0;--n){var r=(0,t[n])(e);if(!N(r)&&!D(r)){if(!Y(r))throw new TypeError;e=r}}return e}function E(t,e,n,r){for(var i=t.length-1;i>=0;--i){var o=(0,t[i])(e,n,r);if(!N(o)&&!D(o)){if(!j(o))throw new TypeError;r=o}}return r}function A(t,e,n){var r=p.get(t);if(N(r)){if(!n)return;r=new h,p.set(t,r)}var i=r.get(e);if(N(i)){if(!n)return;i=new h,r.set(e,i)}return i}function T(t,e,n){if(C(t,e,n))return!0;var r=Q(e);return!D(r)&&T(t,r,n)}function C(t,e,n){var r=A(e,n,!1);return!N(r)&&U(r.has(t))}function O(t,e,n){if(C(t,e,n))return k(t,e,n);var r=Q(e);return D(r)?void 0:O(t,r,n)}function k(t,e,n){var r=A(e,n,!1);if(!N(r))return r.get(t)}function P(t,e,n,r){A(n,r,!0).set(t,e)}function L(t,e){var n=R(t,e),r=Q(t);if(null===r)return n;var i=L(r,e);if(i.length<=0)return n;if(n.length<=0)return i;for(var o=new f,a=[],s=0,u=n;s<u.length;s++){var c=u[s];o.has(c)||(o.add(c),a.push(c))}for(var l=0,h=i;l<h.length;l++)c=h[l],o.has(c)||(o.add(c),a.push(c));return a}function R(t,e){var n=[],r=A(t,e,!1);if(N(r))return n;for(var i=Z(r.keys()),o=0;;){var a=K(i);if(!a)return n.length=o,n;var s=$(a);try{n[o]=s}catch(u){try{J(i)}finally{throw u}}o++}}function I(t){if(null===t)return 1;switch(typeof t){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===t?1:6;default:return 6}}function N(t){return void 0===t}function D(t){return null===t}function F(t){return"symbol"==typeof t}function j(t){return"object"==typeof t?null!==t:"function"==typeof t}function B(t,e){switch(I(t)){case 0:case 1:case 2:case 3:case 4:case 5:return t}var n=3===e?"string":5===e?"number":"default",i=q(t,r);if(void 0!==i){var o=i.call(t,n);if(j(o))throw new TypeError;return o}return z(t,"default"===n?"number":n)}function z(t,e){if("string"===e){var n=t.toString;if(H(n)&&!j(i=n.call(t)))return i;if(H(r=t.valueOf)&&!j(i=r.call(t)))return i}else{var r;if(H(r=t.valueOf)&&!j(i=r.call(t)))return i;var i,o=t.toString;if(H(o)&&!j(i=o.call(t)))return i}throw new TypeError}function U(t){return!!t}function V(t){return""+t}function G(t){var e=B(t,3);return F(e)?e:V(e)}function W(t){return Array.isArray?Array.isArray(t):t instanceof Object?t instanceof Array:"[object Array]"===Object.prototype.toString.call(t)}function H(t){return"function"==typeof t}function Y(t){return"function"==typeof t}function X(t){switch(I(t)){case 3:case 4:return!0;default:return!1}}function q(t,e){var n=t[e];if(null!=n){if(!H(n))throw new TypeError;return n}}function Z(t){var e=q(t,i);if(!H(e))throw new TypeError;var n=e.call(t);if(!j(n))throw new TypeError;return n}function $(t){return t.value}function K(t){var e=t.next();return!e.done&&e}function J(t){var e=t.return;e&&e.call(t)}function Q(t){var e=Object.getPrototypeOf(t);if("function"!=typeof t||t===c)return e;if(e!==c)return e;var n=t.prototype,r=n&&Object.getPrototypeOf(n);if(null==r||r===Object.prototype)return e;var i=r.constructor;return"function"!=typeof i||i===t?e:i}function tt(){var t={},e=[],n=function(){function t(t,e,n){this._index=0,this._keys=t,this._values=e,this._selector=n}return t.prototype["@@iterator"]=function(){return this},t.prototype[i]=function(){return this},t.prototype.next=function(){var t=this._index;if(t>=0&&t<this._keys.length){var n=this._selector(this._keys[t],this._values[t]);return t+1>=this._keys.length?(this._index=-1,this._keys=e,this._values=e):this._index++,{value:n,done:!1}}return{value:void 0,done:!0}},t.prototype.throw=function(t){throw this._index>=0&&(this._index=-1,this._keys=e,this._values=e),t},t.prototype.return=function(t){return this._index>=0&&(this._index=-1,this._keys=e,this._values=e),{value:t,done:!0}},t}();return function(){function e(){this._keys=[],this._values=[],this._cacheKey=t,this._cacheIndex=-2}return Object.defineProperty(e.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),e.prototype.has=function(t){return this._find(t,!1)>=0},e.prototype.get=function(t){var e=this._find(t,!1);return e>=0?this._values[e]:void 0},e.prototype.set=function(t,e){var n=this._find(t,!0);return this._values[n]=e,this},e.prototype.delete=function(e){var n=this._find(e,!1);if(n>=0){for(var r=this._keys.length,i=n+1;i<r;i++)this._keys[i-1]=this._keys[i],this._values[i-1]=this._values[i];return this._keys.length--,this._values.length--,e===this._cacheKey&&(this._cacheKey=t,this._cacheIndex=-2),!0}return!1},e.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=t,this._cacheIndex=-2},e.prototype.keys=function(){return new n(this._keys,this._values,r)},e.prototype.values=function(){return new n(this._keys,this._values,o)},e.prototype.entries=function(){return new n(this._keys,this._values,a)},e.prototype["@@iterator"]=function(){return this.entries()},e.prototype[i]=function(){return this.entries()},e.prototype._find=function(t,e){return this._cacheKey!==t&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=t)),this._cacheIndex<0&&e&&(this._cacheIndex=this._keys.length,this._keys.push(t),this._values.push(void 0)),this._cacheIndex},e}();function r(t,e){return t}function o(t,e){return e}function a(t,e){return[t,e]}}function et(){return function(){function t(){this._map=new h}return Object.defineProperty(t.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),t.prototype.has=function(t){return this._map.has(t)},t.prototype.add=function(t){return this._map.set(t,t),this},t.prototype.delete=function(t){return this._map.delete(t)},t.prototype.clear=function(){this._map.clear()},t.prototype.keys=function(){return this._map.keys()},t.prototype.values=function(){return this._map.values()},t.prototype.entries=function(){return this._map.entries()},t.prototype["@@iterator"]=function(){return this.keys()},t.prototype[i]=function(){return this.keys()},t}()}function nt(){var t=16,n=u.create(),r=i();return function(){function t(){this._key=i()}return t.prototype.has=function(t){var e=o(t,!1);return void 0!==e&&u.has(e,this._key)},t.prototype.get=function(t){var e=o(t,!1);return void 0!==e?u.get(e,this._key):void 0},t.prototype.set=function(t,e){return o(t,!0)[this._key]=e,this},t.prototype.delete=function(t){var e=o(t,!1);return void 0!==e&&delete e[this._key]},t.prototype.clear=function(){this._key=i()},t}();function i(){var t;do{t="@@WeakMap@@"+c()}while(u.has(n,t));return n[t]=!0,t}function o(t,n){if(!e.call(t,r)){if(!n)return;Object.defineProperty(t,r,{value:u.create()})}return t[r]}function a(t,e){for(var n=0;n<e;++n)t[n]=255*Math.random()|0;return t}function s(t){return"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(t)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(t)):a(new Uint8Array(t),t):a(new Array(t),t)}function c(){var e=s(t);e[6]=79&e[6]|64,e[8]=191&e[8]|128;for(var n="",r=0;r<t;++r){var i=e[r];4!==r&&6!==r&&8!==r||(n+="-"),i<16&&(n+="0"),n+=i.toString(16).toLowerCase()}return n}}function rt(t){return t.__=void 0,delete t.__,t}t("decorate",d),t("metadata",m),t("defineMetadata",v),t("hasMetadata",g),t("hasOwnMetadata",y),t("getMetadata",x),t("getOwnMetadata",b),t("getMetadataKeys",_),t("getOwnMetadataKeys",w),t("deleteMetadata",S)}(n)}();var b1="named",_1="name",w1="unmanaged",S1="optional",M1="inject",E1="multi_inject",A1="inversify:tagged",T1="inversify:tagged_props",C1="inversify:paramtypes",O1="post_construct";var k1=[M1,E1,_1,w1,b1,S1],P1="Request",L1="Singleton",R1="Transient",I1="ConstantValue",N1="Constructor",D1="DynamicValue",F1="Factory",j1="Function",B1="Instance",z1="Invalid",U1="Provider",V1="ClassProperty",G1="ConstructorArgument",W1="Variable",H1=0;function Y1(){return H1++}var X1=function(){function t(t,e){this.id=Y1(),this.activated=!1,this.serviceIdentifier=t,this.scope=e,this.type=z1,this.constraint=function(t){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.dynamicValue=null}return t.prototype.clone=function(){var e=new t(this.serviceIdentifier,this.scope);return e.activated=e.scope===L1&&this.activated,e.implementationType=this.implementationType,e.dynamicValue=this.dynamicValue,e.scope=this.scope,e.type=this.type,e.factory=this.factory,e.provider=this.provider,e.constraint=this.constraint,e.onActivation=this.onActivation,e.cache=this.cache,e},t}(),q1="NULL argument",Z1="Key Not Found",$1="Ambiguous match found for serviceIdentifier:",K1="No matching bindings found for serviceIdentifier:",J1=function(){function t(){}return t.prototype.getConstructorMetadata=function(t){return{compilerGeneratedMetadata:Reflect.getMetadata(C1,t),userGeneratedMetadata:Reflect.getMetadata(A1,t)||{}}},t.prototype.getPropertiesMetadata=function(t){return Reflect.getMetadata(T1,t)||[]},t}(),Q1=0,t2=1;function e2(t){return t instanceof RangeError||"Maximum call stack size exceeded"===t.message}function n2(t){return"function"==typeof t?t.name:"symbol"==typeof t?t.toString():t}function r2(t,e,n){var r="",i=n(t,e);return 0!==i.length&&(r="\nRegistered bindings:",i.forEach((function(t){var e="Object";null!==t.implementationType&&(e=a2(t.implementationType)),r=r+"\n "+e,t.constraint.metaData&&(r=r+" - "+t.constraint.metaData)}))),r}function i2(t,e){return null!==t.parentRequest&&(t.parentRequest.serviceIdentifier===e||i2(t.parentRequest,e))}function o2(t){t.childRequests.forEach((function(t){if(i2(t,t.serviceIdentifier)){var e=function(t){var e=function t(e,n){void 0===n&&(n=[]);var r=n2(e.serviceIdentifier);return n.push(r),null!==e.parentRequest?t(e.parentRequest,n):n}(t);return e.reverse().join(" --\x3e ")}(t);throw new Error("Circular dependency found: "+e)}o2(t)}))}function a2(t){if(t.name)return t.name;var e=t.toString(),n=e.match(/^function\s*([^\s(]+)/);return n?n[1]:"Anonymous function: "+e}var s2=function(){function t(t){this.id=Y1(),this.container=t}return t.prototype.addPlan=function(t){this.plan=t},t.prototype.setCurrentRequest=function(t){this.currentRequest=t},t}(),u2=function(){function t(t,e){this.key=t,this.value=e}return t.prototype.toString=function(){return this.key===b1?"named: "+this.value.toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+this.value+" }"},t}(),c2=function(t,e){this.parentContext=t,this.rootRequest=e};function l2(t,e,n,r,i){var o={},a="number"==typeof i,s=void 0!==i&&a?i.toString():n;if(a&&void 0!==n)throw new Error("The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.");Reflect.hasOwnMetadata(t,e)&&(o=Reflect.getMetadata(t,e));var u=o[s];if(Array.isArray(u))for(var c=0,l=u;c<l.length;c++){var h=l[c];if(h.key===r.key)throw new Error("Metadata key was used more than once in a parameter: "+h.key.toString())}else u=[];u.push(r),o[s]=u,Reflect.defineMetadata(t,o,e)}function h2(t,e){Reflect.decorate(t,e)}function f2(t,e){return function(n,r){e(n,r,t)}}var p2=function(){function t(t){this._cb=t}return t.prototype.unwrap=function(){return this._cb()},t}();function d2(t){return function(e,n,r){if(void 0===t)throw new Error(function(t){return"@inject called with undefined this could mean that the class "+t+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."}(e.name));var i=new u2(M1,t);"number"==typeof r?function(t,e,n,r){l2(A1,t,e,r,n)}(e,n,r,i):function(t,e,n){l2(T1,t.constructor,e,n)}(e,n,i)}}var m2=function(){function t(t){this.str=t}return t.prototype.startsWith=function(t){return 0===this.str.indexOf(t)},t.prototype.endsWith=function(t){var e,n=t.split("").reverse().join("");return e=this.str.split("").reverse().join(""),this.startsWith.call({str:e},n)},t.prototype.contains=function(t){return-1!==this.str.indexOf(t)},t.prototype.equals=function(t){return this.str===t},t.prototype.value=function(){return this.str},t}(),v2=function(){function t(t,e,n,r){this.id=Y1(),this.type=t,this.serviceIdentifier=n,this.name=new m2(e||""),this.metadata=new Array;var i=null;"string"==typeof r?i=new u2(b1,r):r instanceof u2&&(i=r),null!==i&&this.metadata.push(i)}return t.prototype.hasTag=function(t){for(var e=0,n=this.metadata;e<n.length;e++){if(n[e].key===t)return!0}return!1},t.prototype.isArray=function(){return this.hasTag(E1)},t.prototype.matchesArray=function(t){return this.matchesTag(E1)(t)},t.prototype.isNamed=function(){return this.hasTag(b1)},t.prototype.isTagged=function(){return this.metadata.some((function(t){return k1.every((function(e){return t.key!==e}))}))},t.prototype.isOptional=function(){return this.matchesTag(S1)(!0)},t.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter((function(t){return t.key===b1}))[0]:null},t.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter((function(t){return k1.every((function(e){return t.key!==e}))})):null},t.prototype.matchesNamedTag=function(t){return this.matchesTag(b1)(t)},t.prototype.matchesTag=function(t){var e=this;return function(n){for(var r=0,i=e.metadata;r<i.length;r++){var o=i[r];if(o.key===t&&o.value===n)return!0}return!1}},t}(),g2=globalThis&&globalThis.__spreadArray||function(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t};function y2(t,e,n,r){var i=t.getConstructorMetadata(n),o=i.compilerGeneratedMetadata;if(void 0===o)throw new Error("Missing required @injectable annotation in: "+e+".");var a=i.userGeneratedMetadata,s=Object.keys(a),u=0===n.length&&s.length>0,c=s.length>n.length,l=function(t,e,n,r,i){for(var o=[],a=0;a<i;a++){var s=x2(a,t,e,n,r);null!==s&&o.push(s)}return o}(r,e,o,a,u||c?s.length:n.length),h=b2(t,n);return g2(g2([],l),h)}function x2(t,e,n,r,i){var o=i[t.toString()]||[],a=w2(o),s=!0!==a.unmanaged,u=r[t],c=a.inject||a.multiInject;if((u=c||u)instanceof p2&&(u=u.unwrap()),s){if(!e&&(u===Object||u===Function||void 0===u))throw new Error("Missing required @inject or @multiInject annotation in: argument "+t+" in class "+n+".");var l=new v2(G1,a.targetName,u);return l.metadata=o,l}return null}function b2(t,e){for(var n=t.getPropertiesMetadata(e),r=[],i=0,o=Object.keys(n);i<o.length;i++){var a=o[i],s=n[a],u=w2(n[a]),c=u.targetName||a,l=u.inject||u.multiInject,h=new v2(V1,c,l);h.metadata=s,r.push(h)}var f=Object.getPrototypeOf(e.prototype).constructor;if(f!==Object){var p=b2(t,f);r=g2(g2([],r),p)}return r}function _2(t,e){var n=Object.getPrototypeOf(e.prototype).constructor;if(n!==Object){var r=y2(t,a2(n),n,!0),i=r.map((function(t){return t.metadata.filter((function(t){return t.key===w1}))})),o=[].concat.apply([],i).length,a=r.length-o;return a>0?a:_2(t,n)}return 0}function w2(t){var e={};return t.forEach((function(t){e[t.key.toString()]=t.value})),{inject:e[M1],multiInject:e[E1],targetName:e[_1],unmanaged:e[w1]}}var S2=function(){function t(t,e,n,r,i){this.id=Y1(),this.serviceIdentifier=t,this.parentContext=e,this.parentRequest=n,this.target=i,this.childRequests=[],this.bindings=Array.isArray(r)?r:[r],this.requestScope=null===n?new Map:null}return t.prototype.addChildRequest=function(e,n,r){var i=new t(e,this.parentContext,this,n,r);return this.childRequests.push(i),i},t}();function M2(t){return t._bindingDictionary}function E2(t,e,n,r,i){var o=T2(n.container,i.serviceIdentifier),a=[];return o.length===Q1&&n.container.options.autoBindInjectable&&"function"==typeof i.serviceIdentifier&&t.getConstructorMetadata(i.serviceIdentifier).compilerGeneratedMetadata&&(n.container.bind(i.serviceIdentifier).toSelf(),o=T2(n.container,i.serviceIdentifier)),a=e?o:o.filter((function(t){var e=new S2(t.serviceIdentifier,n,r,t,i);return t.constraint(e)})),function(t,e,n,r){switch(e.length){case Q1:if(n.isOptional())return e;var i=n2(t),o=K1;throw o+=function(t,e){if(e.isTagged()||e.isNamed()){var n="",r=e.getNamedTag(),i=e.getCustomTags();return null!==r&&(n+=r.toString()+"\n"),null!==i&&i.forEach((function(t){n+=t.toString()+"\n"}))," "+t+"\n "+t+" - "+n}return" "+t}(i,n),o+=r2(r,i,T2),new Error(o);case t2:if(!n.isArray())return e;default:if(n.isArray())return e;i=n2(t),o=$1+" "+i;throw o+=r2(r,i,T2),new Error(o)}}(i.serviceIdentifier,a,i,n.container),a}function A2(t,e,n,r,i,o){var a,s;if(null===i){a=E2(t,e,r,null,o),s=new S2(n,r,null,a,o);var u=new c2(r,s);r.addPlan(u)}else a=E2(t,e,r,i,o),s=i.addChildRequest(o.serviceIdentifier,a,o);a.forEach((function(e){var n=null;if(o.isArray())n=s.addChildRequest(e.serviceIdentifier,e,o);else{if(e.cache)return;n=s}if(e.type===B1&&null!==e.implementationType){var i=function(t,e){return y2(t,a2(e),e,!1)}(t,e.implementationType);if(!r.container.options.skipBaseClassChecks){var a=_2(t,e.implementationType);if(i.length<a){var u=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return"The number of constructor arguments in the derived class "+t[0]+" must be >= than the number of constructor arguments of its base class."}(a2(e.implementationType));throw new Error(u)}}i.forEach((function(e){A2(t,!1,e.serviceIdentifier,r,n,e)}))}}))}function T2(t,e){var n=[],r=M2(t);return r.hasKey(e)?n=r.get(e):null!==t.parent&&(n=T2(t.parent,e)),n}function C2(t,e,n,r,i,o,a,s){void 0===s&&(s=!1);var u=new s2(e),c=function(t,e,n,r,i,o){var a=new u2(t?E1:M1,n),s=new v2(e,r,n,a);if(void 0!==i){var u=new u2(i,o);s.metadata.push(u)}return s}(n,r,i,"",o,a);try{return A2(t,s,i,u,null,c),u}catch(l){throw e2(l)&&u.plan&&o2(u.plan.rootRequest),l}}var O2=globalThis&&globalThis.__spreadArray||function(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t};function k2(t,e,n){var r,i,o=null;if(e.length>0){var a=e.filter((function(t){return null!==t.target&&t.target.type===G1})).map(n);i=a,o=function(t,e,n){var r=e.filter((function(t){return null!==t.target&&t.target.type===V1})),i=r.map(n);return r.forEach((function(e,n){var r;r=e.target.name.value();var o=i[n];t[r]=o})),t}(o=new((r=t).bind.apply(r,O2([void 0],i))),e,n)}else o=new t;return function(t,e){if(Reflect.hasMetadata(O1,t)){var n=Reflect.getMetadata(O1,t);try{e[n.value]()}catch(r){throw new Error(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return"@postConstruct error in class "+t[0]+": "+t[1]}(t.name,r.message))}}}(t,o),o}var P2=function(t,e,n){try{return n()}catch(r){throw e2(r)?new Error(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return"It looks like there is a circular dependency in one of the '"+t[0]+"' bindings. Please investigate bindings withservice identifier '"+t[1]+"'."}(t,e.toString())):r}},L2=function(t){return function(e){e.parentContext.setCurrentRequest(e);var n=e.bindings,r=e.childRequests,i=e.target&&e.target.isArray(),o=!(e.parentRequest&&e.parentRequest.target&&e.target&&e.parentRequest.target.matchesArray(e.target.serviceIdentifier));if(i&&o)return r.map((function(e){return L2(t)(e)}));var a=null;if(!e.target.isOptional()||0!==n.length){var s=n[0],u=s.scope===L1,c=s.scope===P1;if(u&&s.activated)return s.cache;if(c&&null!==t&&t.has(s.id))return t.get(s.id);if(s.type===I1)a=s.cache,s.activated=!0;else if(s.type===j1)a=s.cache,s.activated=!0;else if(s.type===N1)a=s.implementationType;else if(s.type===D1&&null!==s.dynamicValue)a=P2("toDynamicValue",s.serviceIdentifier,(function(){return s.dynamicValue(e.parentContext)}));else if(s.type===F1&&null!==s.factory)a=P2("toFactory",s.serviceIdentifier,(function(){return s.factory(e.parentContext)}));else if(s.type===U1&&null!==s.provider)a=P2("toProvider",s.serviceIdentifier,(function(){return s.provider(e.parentContext)}));else{if(s.type!==B1||null===s.implementationType){var l=n2(e.serviceIdentifier);throw new Error("Invalid binding type: "+l)}a=k2(s.implementationType,r,L2(t))}return"function"==typeof s.onActivation&&(a=s.onActivation(e.parentContext,a)),u&&(s.cache=a,s.activated=!0),c&&null!==t&&!t.has(s.id)&&t.set(s.id,a),a}}};var R2=function(t,e){var n=t.parentRequest;return null!==n&&(!!e(n)||R2(n,e))},I2=function(t){return function(e){var n=function(n){return null!==n&&null!==n.target&&n.target.matchesTag(t)(e)};return n.metaData=new u2(t,e),n}},N2=I2(b1),D2=function(t){return function(e){var n=null;if(null!==e){if(n=e.bindings[0],"string"==typeof t)return n.serviceIdentifier===t;var r=e.bindings[0].implementationType;return t===r}return!1}},F2=function(){function t(t){this._binding=t}return t.prototype.when=function(t){return this._binding.constraint=t,new j2(this._binding)},t.prototype.whenTargetNamed=function(t){return this._binding.constraint=N2(t),new j2(this._binding)},t.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(t){return null!==t.target&&!t.target.isNamed()&&!t.target.isTagged()},new j2(this._binding)},t.prototype.whenTargetTagged=function(t,e){return this._binding.constraint=I2(t)(e),new j2(this._binding)},t.prototype.whenInjectedInto=function(t){return this._binding.constraint=function(e){return D2(t)(e.parentRequest)},new j2(this._binding)},t.prototype.whenParentNamed=function(t){return this._binding.constraint=function(e){return N2(t)(e.parentRequest)},new j2(this._binding)},t.prototype.whenParentTagged=function(t,e){return this._binding.constraint=function(n){return I2(t)(e)(n.parentRequest)},new j2(this._binding)},t.prototype.whenAnyAncestorIs=function(t){return this._binding.constraint=function(e){return R2(e,D2(t))},new j2(this._binding)},t.prototype.whenNoAncestorIs=function(t){return this._binding.constraint=function(e){return!R2(e,D2(t))},new j2(this._binding)},t.prototype.whenAnyAncestorNamed=function(t){return this._binding.constraint=function(e){return R2(e,N2(t))},new j2(this._binding)},t.prototype.whenNoAncestorNamed=function(t){return this._binding.constraint=function(e){return!R2(e,N2(t))},new j2(this._binding)},t.prototype.whenAnyAncestorTagged=function(t,e){return this._binding.constraint=function(n){return R2(n,I2(t)(e))},new j2(this._binding)},t.prototype.whenNoAncestorTagged=function(t,e){return this._binding.constraint=function(n){return!R2(n,I2(t)(e))},new j2(this._binding)},t.prototype.whenAnyAncestorMatches=function(t){return this._binding.constraint=function(e){return R2(e,t)},new j2(this._binding)},t.prototype.whenNoAncestorMatches=function(t){return this._binding.constraint=function(e){return!R2(e,t)},new j2(this._binding)},t}(),j2=function(){function t(t){this._binding=t}return t.prototype.onActivation=function(t){return this._binding.onActivation=t,new F2(this._binding)},t}(),B2=function(){function t(t){this._binding=t,this._bindingWhenSyntax=new F2(this._binding),this._bindingOnSyntax=new j2(this._binding)}return t.prototype.when=function(t){return this._bindingWhenSyntax.when(t)},t.prototype.whenTargetNamed=function(t){return this._bindingWhenSyntax.whenTargetNamed(t)},t.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},t.prototype.whenTargetTagged=function(t,e){return this._bindingWhenSyntax.whenTargetTagged(t,e)},t.prototype.whenInjectedInto=function(t){return this._bindingWhenSyntax.whenInjectedInto(t)},t.prototype.whenParentNamed=function(t){return this._bindingWhenSyntax.whenParentNamed(t)},t.prototype.whenParentTagged=function(t,e){return this._bindingWhenSyntax.whenParentTagged(t,e)},t.prototype.whenAnyAncestorIs=function(t){return this._bindingWhenSyntax.whenAnyAncestorIs(t)},t.prototype.whenNoAncestorIs=function(t){return this._bindingWhenSyntax.whenNoAncestorIs(t)},t.prototype.whenAnyAncestorNamed=function(t){return this._bindingWhenSyntax.whenAnyAncestorNamed(t)},t.prototype.whenAnyAncestorTagged=function(t,e){return this._bindingWhenSyntax.whenAnyAncestorTagged(t,e)},t.prototype.whenNoAncestorNamed=function(t){return this._bindingWhenSyntax.whenNoAncestorNamed(t)},t.prototype.whenNoAncestorTagged=function(t,e){return this._bindingWhenSyntax.whenNoAncestorTagged(t,e)},t.prototype.whenAnyAncestorMatches=function(t){return this._bindingWhenSyntax.whenAnyAncestorMatches(t)},t.prototype.whenNoAncestorMatches=function(t){return this._bindingWhenSyntax.whenNoAncestorMatches(t)},t.prototype.onActivation=function(t){return this._bindingOnSyntax.onActivation(t)},t}(),z2=function(){function t(t){this._binding=t}return t.prototype.inRequestScope=function(){return this._binding.scope=P1,new B2(this._binding)},t.prototype.inSingletonScope=function(){return this._binding.scope=L1,new B2(this._binding)},t.prototype.inTransientScope=function(){return this._binding.scope=R1,new B2(this._binding)},t}(),U2=function(){function t(t){this._binding=t,this._bindingWhenSyntax=new F2(this._binding),this._bindingOnSyntax=new j2(this._binding),this._bindingInSyntax=new z2(t)}return t.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},t.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},t.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},t.prototype.when=function(t){return this._bindingWhenSyntax.when(t)},t.prototype.whenTargetNamed=function(t){return this._bindingWhenSyntax.whenTargetNamed(t)},t.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},t.prototype.whenTargetTagged=function(t,e){return this._bindingWhenSyntax.whenTargetTagged(t,e)},t.prototype.whenInjectedInto=function(t){return this._bindingWhenSyntax.whenInjectedInto(t)},t.prototype.whenParentNamed=function(t){return this._bindingWhenSyntax.whenParentNamed(t)},t.prototype.whenParentTagged=function(t,e){return this._bindingWhenSyntax.whenParentTagged(t,e)},t.prototype.whenAnyAncestorIs=function(t){return this._bindingWhenSyntax.whenAnyAncestorIs(t)},t.prototype.whenNoAncestorIs=function(t){return this._bindingWhenSyntax.whenNoAncestorIs(t)},t.prototype.whenAnyAncestorNamed=function(t){return this._bindingWhenSyntax.whenAnyAncestorNamed(t)},t.prototype.whenAnyAncestorTagged=function(t,e){return this._bindingWhenSyntax.whenAnyAncestorTagged(t,e)},t.prototype.whenNoAncestorNamed=function(t){return this._bindingWhenSyntax.whenNoAncestorNamed(t)},t.prototype.whenNoAncestorTagged=function(t,e){return this._bindingWhenSyntax.whenNoAncestorTagged(t,e)},t.prototype.whenAnyAncestorMatches=function(t){return this._bindingWhenSyntax.whenAnyAncestorMatches(t)},t.prototype.whenNoAncestorMatches=function(t){return this._bindingWhenSyntax.whenNoAncestorMatches(t)},t.prototype.onActivation=function(t){return this._bindingOnSyntax.onActivation(t)},t}(),V2=function(){function t(t){this._binding=t}return t.prototype.to=function(t){return this._binding.type=B1,this._binding.implementationType=t,new U2(this._binding)},t.prototype.toSelf=function(){if("function"!=typeof this._binding.serviceIdentifier)throw new Error("The toSelf function can only be applied when a constructor is used as service identifier");var t=this._binding.serviceIdentifier;return this.to(t)},t.prototype.toConstantValue=function(t){return this._binding.type=I1,this._binding.cache=t,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=L1,new B2(this._binding)},t.prototype.toDynamicValue=function(t){return this._binding.type=D1,this._binding.cache=null,this._binding.dynamicValue=t,this._binding.implementationType=null,new U2(this._binding)},t.prototype.toConstructor=function(t){return this._binding.type=N1,this._binding.implementationType=t,this._binding.scope=L1,new B2(this._binding)},t.prototype.toFactory=function(t){return this._binding.type=F1,this._binding.factory=t,this._binding.scope=L1,new B2(this._binding)},t.prototype.toFunction=function(t){if("function"!=typeof t)throw new Error("Value provided to function binding must be a function!");var e=this.toConstantValue(t);return this._binding.type=j1,this._binding.scope=L1,e},t.prototype.toAutoFactory=function(t){return this._binding.type=F1,this._binding.factory=function(e){return function(){return e.container.get(t)}},this._binding.scope=L1,new B2(this._binding)},t.prototype.toProvider=function(t){return this._binding.type=U1,this._binding.provider=t,this._binding.scope=L1,new B2(this._binding)},t.prototype.toService=function(t){this.toDynamicValue((function(e){return e.container.get(t)}))},t}(),G2=function(){function t(){}return t.of=function(e,n){var r=new t;return r.bindings=e,r.middleware=n,r},t}(),W2=function(){function t(){this._map=new Map}return t.prototype.getMap=function(){return this._map},t.prototype.add=function(t,e){if(null==t)throw new Error(q1);if(null==e)throw new Error(q1);var n=this._map.get(t);void 0!==n?(n.push(e),this._map.set(t,n)):this._map.set(t,[e])},t.prototype.get=function(t){if(null==t)throw new Error(q1);var e=this._map.get(t);if(void 0!==e)return e;throw new Error(Z1)},t.prototype.remove=function(t){if(null==t)throw new Error(q1);if(!this._map.delete(t))throw new Error(Z1)},t.prototype.removeByCondition=function(t){var e=this;this._map.forEach((function(n,r){var i=n.filter((function(e){return!t(e)}));i.length>0?e._map.set(r,i):e._map.delete(r)}))},t.prototype.hasKey=function(t){if(null==t)throw new Error(q1);return this._map.has(t)},t.prototype.clone=function(){var e=new t;return this._map.forEach((function(t,n){t.forEach((function(t){return e.add(n,t.clone())}))})),e},t.prototype.traverse=function(t){this._map.forEach((function(e,n){t(n,e)}))},t}(),H2=globalThis&&globalThis.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(e){o(e)}}function s(t){try{u(r.throw(t))}catch(e){o(e)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},Y2=globalThis&&globalThis.__generator||function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},X2=globalThis&&globalThis.__spreadArray||function(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t},q2=function(){function t(t){this._appliedMiddleware=[];var e=t||{};if("object"!=typeof e)throw new Error("Invalid Container constructor argument. Container options must be an object.");if(void 0===e.defaultScope)e.defaultScope=R1;else if(e.defaultScope!==L1&&e.defaultScope!==R1&&e.defaultScope!==P1)throw new Error("Invalid Container option. Default scope must be a string ('singleton' or 'transient').");if(void 0===e.autoBindInjectable)e.autoBindInjectable=!1;else if("boolean"!=typeof e.autoBindInjectable)throw new Error("Invalid Container option. Auto bind injectable must be a boolean");if(void 0===e.skipBaseClassChecks)e.skipBaseClassChecks=!1;else if("boolean"!=typeof e.skipBaseClassChecks)throw new Error("Invalid Container option. Skip base check must be a boolean");this.options={autoBindInjectable:e.autoBindInjectable,defaultScope:e.defaultScope,skipBaseClassChecks:e.skipBaseClassChecks},this.id=Y1(),this._bindingDictionary=new W2,this._snapshots=[],this._middleware=null,this.parent=null,this._metadataReader=new J1}return t.merge=function(e,n){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];var o=new t,a=X2([e,n],r).map((function(t){return M2(t)})),s=M2(o);function u(t,e){t.traverse((function(t,n){n.forEach((function(t){e.add(t.serviceIdentifier,t.clone())}))}))}return a.forEach((function(t){u(t,s)})),o},t.prototype.load=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=this._getContainerModuleHelpersFactory(),r=0,i=t;r<i.length;r++){var o=i[r],a=n(o.id);o.registry(a.bindFunction,a.unbindFunction,a.isboundFunction,a.rebindFunction)}},t.prototype.loadAsync=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return H2(this,void 0,void 0,(function(){var e,n,r,i,o;return Y2(this,(function(a){switch(a.label){case 0:e=this._getContainerModuleHelpersFactory(),n=0,r=t,a.label=1;case 1:return n<r.length?(i=r[n],o=e(i.id),[4,i.registry(o.bindFunction,o.unbindFunction,o.isboundFunction,o.rebindFunction)]):[3,4];case 2:a.sent(),a.label=3;case 3:return n++,[3,1];case 4:return[2]}}))}))},t.prototype.unload=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=function(t){return function(e){return e.moduleId===t}};e.forEach((function(e){var n=r(e.id);t._bindingDictionary.removeByCondition(n)}))},t.prototype.bind=function(t){var e=this.options.defaultScope||R1,n=new X1(t,e);return this._bindingDictionary.add(t,n),new V2(n)},t.prototype.rebind=function(t){return this.unbind(t),this.bind(t)},t.prototype.unbind=function(t){try{this._bindingDictionary.remove(t)}catch(e){throw new Error("Could not unbind serviceIdentifier: "+n2(t))}},t.prototype.unbindAll=function(){this._bindingDictionary=new W2},t.prototype.isBound=function(t){var e=this._bindingDictionary.hasKey(t);return!e&&this.parent&&(e=this.parent.isBound(t)),e},t.prototype.isBoundNamed=function(t,e){return this.isBoundTagged(t,b1,e)},t.prototype.isBoundTagged=function(t,e,n){var r=!1;if(this._bindingDictionary.hasKey(t)){var i=this._bindingDictionary.get(t),o=function(t,e,n,r){var i=new v2(W1,"",e,new u2(n,r)),o=new s2(t);return new S2(e,o,null,[],i)}(this,t,e,n);r=i.some((function(t){return t.constraint(o)}))}return!r&&this.parent&&(r=this.parent.isBoundTagged(t,e,n)),r},t.prototype.snapshot=function(){this._snapshots.push(G2.of(this._bindingDictionary.clone(),this._middleware))},t.prototype.restore=function(){var t=this._snapshots.pop();if(void 0===t)throw new Error("No snapshot available to restore.");this._bindingDictionary=t.bindings,this._middleware=t.middleware},t.prototype.createChild=function(e){var n=new t(e||this.options);return n.parent=this,n},t.prototype.applyMiddleware=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._appliedMiddleware=this._appliedMiddleware.concat(t);var n=this._middleware?this._middleware:this._planAndResolve();this._middleware=t.reduce((function(t,e){return e(t)}),n)},t.prototype.applyCustomMetadataReader=function(t){this._metadataReader=t},t.prototype.get=function(t){return this._get(!1,!1,W1,t)},t.prototype.getTagged=function(t,e,n){return this._get(!1,!1,W1,t,e,n)},t.prototype.getNamed=function(t,e){return this.getTagged(t,b1,e)},t.prototype.getAll=function(t){return this._get(!0,!0,W1,t)},t.prototype.getAllTagged=function(t,e,n){return this._get(!1,!0,W1,t,e,n)},t.prototype.getAllNamed=function(t,e){return this.getAllTagged(t,b1,e)},t.prototype.resolve=function(t){var e=this.createChild();return e.bind(t).toSelf(),this._appliedMiddleware.forEach((function(t){e.applyMiddleware(t)})),e.get(t)},t.prototype._getContainerModuleHelpersFactory=function(){var t=this,e=function(t,e){t._binding.moduleId=e},n=function(n){return function(r){var i=t.rebind.bind(t)(r);return e(i,n),i}};return function(r){return{bindFunction:(i=r,function(n){var r=t.bind.bind(t)(n);return e(r,i),r}),isboundFunction:function(e){return t.isBound.bind(t)(e)},rebindFunction:n(r),unbindFunction:function(e){t.unbind.bind(t)(e)}};var i}},t.prototype._get=function(t,e,n,r,i,o){var a=null,s={avoidConstraints:t,contextInterceptor:function(t){return t},isMultiInject:e,key:i,serviceIdentifier:r,targetType:n,value:o};if(this._middleware){if(null==(a=this._middleware(s)))throw new Error("Invalid return type in middleware. Middleware must return!")}else a=this._planAndResolve()(s);return a},t.prototype._planAndResolve=function(){var t=this;return function(e){var n=C2(t._metadataReader,t,e.isMultiInject,e.targetType,e.serviceIdentifier,e.key,e.value,e.avoidConstraints);return function(t){return L2(t.plan.rootRequest.requestScope)(t.plan.rootRequest)}(n=e.contextInterceptor(n))}},t}();function Z2(){return function(t){if(Reflect.hasOwnMetadata(C1,t))throw new Error("Cannot apply @injectable decorator multiple times.");var e=Reflect.getMetadata("design:paramtypes",t)||[];return Reflect.defineMetadata(C1,e,t),t}}var $2=Symbol.for("INJECTION");function K2(t,e,n,r){Object.defineProperty(t,e,{configurable:!0,enumerable:!0,get:function(){return r&&!Reflect.hasMetadata($2,this,e)&&Reflect.defineMetadata($2,n(),this,e),Reflect.hasMetadata($2,this,e)?Reflect.getMetadata($2,this,e):n()},set:function(t){Reflect.defineMetadata($2,t,this,e)}})}var J2={IEventEmitter:Symbol.for("IEventEmitter"),ISceneService:Symbol.for("ISceneService"),IGlobalConfigService:Symbol.for("IGlobalConfigService"),ICameraService:Symbol.for("ICameraService"),ICoordinateSystemService:Symbol.for("ICoordinateSystemService"),ILayerService:Symbol.for("ILayerService"),ILayerMappingService:Symbol.for("ILayerMappingService"),ILayerStyleService:Symbol.for("ILayerStyleService"),IMapService:Symbol.for("IMapService"),IMarkerService:Symbol.for("IMarkerService"),IPopupService:Symbol.for("PopupService"),IFactoryMapService:Symbol.for("Factory<IMapService>"),IRendererService:Symbol.for("IRendererService"),IShaderModuleService:Symbol.for("IShaderModuleService"),IIconService:Symbol.for("IIconService"),IFontService:Symbol.for("IFontService"),IInteractionService:Symbol.for("IInteractionService"),IPickingService:Symbol.for("IPickingService"),IControlService:Symbol.for("IControlService"),IStyleAttributeService:Symbol.for("IStyleAttributeService"),ILayer:Symbol.for("ILayer"),ILayerPlugin:Symbol.for("ILayerPlugin"),INormalPass:Symbol.for("INormalPass"),IPostProcessor:Symbol.for("IPostProcessor"),IPostProcessingPass:Symbol.for("IPostProcessingPass"),IFactoryPostProcessingPass:Symbol.for("Factory<IPostProcessingPass>"),IFactoryNormalPass:Symbol.for("Factory<IFactoryNormalPass>"),IMultiPassRenderer:Symbol.for("IMultiPassRenderer"),SceneID:Symbol.for("SceneID"),MapConfig:Symbol.for("MapConfig")},Q2={};({get exports(){return Q2},set exports(t){Q2=t}}).exports=e3,Q2.default=e3;var t3=1e20;function e3(t,e,n,r,i,o){this.fontSize=t||24,this.buffer=void 0===e?3:e,this.cutoff=r||.25,this.fontFamily=i||"sans-serif",this.fontWeight=o||"normal",this.radius=n||8;var a=this.size=this.fontSize+2*this.buffer,s=a+2*this.buffer,u="undefined"!=typeof my&&!!my&&"function"==typeof my.showToast&&!0!==my.isFRM;u?this.canvas=my.createOffscreenCanvas(a,a,"2d"):(this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=a),this.ctx=this.canvas.getContext("2d",{willReadFrequently:!0}),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textAlign="left",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(s*s),this.gridInner=new Float64Array(s*s),this.f=new Float64Array(s),this.z=new Float64Array(s+1),this.v=new Uint16Array(s),this.useMetrics=void 0!==this.ctx.measureText("A").actualBoundingBoxLeft,this.middle=u?Math.round(a/2*1):Math.round(a/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function n3(t,e,n,r,i,o){for(var a=0;a<e;a++)r3(t,a,e,n,r,i,o);for(var s=0;s<n;s++)r3(t,s*e,1,e,r,i,o)}function r3(t,e,n,r,i,o,a){var s,u,c,l;for(o[0]=0,a[0]=-t3,a[1]=t3,s=0;s<r;s++)i[s]=t[e+s*n];for(s=1,u=0,c=0;s<r;s++){do{l=o[u],c=(i[s]-i[l]+s*s-l*l)/(s-l)/2}while(c<=a[u]&&--u>-1);o[++u]=s,a[u]=c,a[u+1]=t3}for(s=0,u=0;s<r;s++){for(;a[u+1]<s;)u++;l=o[u],t[e+s*n]=i[l]+(s-l)*(s-l)}}function i3(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return o3(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o3(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function o3(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}e3.prototype._draw=function(t,e){var n,r,i,o,a,s,u,c,l,h=this.ctx.measureText(t),f=h.width,p=2*this.buffer;e&&this.useMetrics?(a=Math.floor(h.actualBoundingBoxAscent),c=this.buffer+Math.ceil(h.actualBoundingBoxAscent),s=this.buffer,u=this.buffer,n=(r=Math.min(this.size,Math.ceil(h.actualBoundingBoxRight-h.actualBoundingBoxLeft)))+p,i=(o=Math.min(this.size-s,Math.ceil(h.actualBoundingBoxAscent+h.actualBoundingBoxDescent)))+p,this.ctx.textBaseline="alphabetic"):(n=r=this.size,i=o=this.size,a=19*this.fontSize/24,s=u=0,c=this.middle,this.ctx.textBaseline="middle"),r&&o&&(this.ctx.clearRect(u,s,r,o),this.ctx.fillText(t,this.buffer,c),l=this.ctx.getImageData(u,s,r,o));var d=new Uint8ClampedArray(n*i);return function(t,e,n,r,i,o,a){o.fill(t3,0,e*n),a.fill(0,0,e*n);for(var s=(e-r)/2,u=0;u<i;u++)for(var c=0;c<r;c++){var l=(u+s)*e+c+s,h=t.data[4*(u*r+c)+3]/255;if(1===h)o[l]=0,a[l]=t3;else if(0===h)o[l]=t3,a[l]=0;else{var f=Math.max(0,.5-h),p=Math.max(0,h-.5);o[l]=f*f,a[l]=p*p}}}(l,n,i,r,o,this.gridOuter,this.gridInner),n3(this.gridOuter,n,i,this.f,this.v,this.z),n3(this.gridInner,n,i,this.f,this.v,this.z),function(t,e,n,r,i,o,a){for(var s=0;s<e*n;s++){var u=Math.sqrt(r[s])-Math.sqrt(i[s]);t[s]=Math.round(255-255*(u/o+a))}}(d,n,i,this.gridOuter,this.gridInner,this.radius,this.cutoff),{data:d,metrics:{width:r,height:o,sdfWidth:n,sdfHeight:i,top:a,left:0,advance:f}}},e3.prototype.draw=function(t){return this._draw(t,!1).data},e3.prototype.drawWithMetrics=function(t){return this._draw(t,!0)};var a3;function s3(t,e,n){var r,i=i3(e);try{for(i.s();!(r=i.n()).done;){var o=r.value,a=o.icon,s=o.xOffset;t[a.id]=Jq(Jq({},a),{},{x:s,y:n,image:a.image,width:a.width,height:a.height})}}catch(u){i.e(u)}finally{i.f()}}function u3(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function c3(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return l3(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l3(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function l3(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function h3(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var f3=function(){for(var t=[],e=32;e<128;e++)t.push(String.fromCharCode(e));return t}();function p3(t,e,n,r){t.font="".concat(r," ").concat(n,"px ").concat(e),t.fillStyle="black",t.textBaseline="middle"}function d3(t,e){for(var n=0;n<t.length;n++)e.data[4*n+3]=t[n]}var m3,v3=Z2()(a3=function(t){wZ(n,hc.EventEmitter);var e=h3(n);function n(){var t;mZ(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return $q(SZ(t=e.call.apply(e,[this].concat(i))),"fontAtlas",void 0),$q(SZ(t),"iconFontMap",void 0),$q(SZ(t),"iconFontGlyphs",{}),$q(SZ(t),"fontOptions",void 0),$q(SZ(t),"key",void 0),$q(SZ(t),"cache",new MK(3)),t}return gZ(n,[{key:"scale",get:function(){return 1}},{key:"canvas",get:function(){var t=this.cache.get(this.key);return t&&t.data}},{key:"mapping",get:function(){var t=this.cache.get(this.key);return t&&t.mapping||{}}},{key:"init",value:function(){this.cache.clear(),this.fontOptions={fontFamily:"sans-serif",fontWeight:"normal",characterSet:f3,fontSize:24,buffer:3,sdf:!0,cutoff:.25,radius:8,iconfont:!1},this.key="",this.iconFontMap=new Map}},{key:"addIconGlyphs",value:function(t){var e=this;t.forEach((function(t){e.iconFontGlyphs[t.name]=t.unicode}))}},{key:"addIconFont",value:function(t,e){this.iconFontMap.set(t,e)}},{key:"getIconFontKey",value:function(t){return this.iconFontMap.get(t)||t}},{key:"getGlyph",value:function(t){return this.iconFontGlyphs[t]?String.fromCharCode(parseInt(this.iconFontGlyphs[t],16)):""}},{key:"setFontOptions",value:function(t){this.fontOptions=Jq(Jq({},this.fontOptions),t),this.key=this.getKey();var e=this.getNewChars(this.key,this.fontOptions.characterSet),n=this.cache.get(this.key);if(!n||0!==e.length){var r=this.generateFontAtlas(this.key,e,n);this.fontAtlas=r,this.cache.set(this.key,r)}}},{key:"addFontFace",value:function(t,e){var n=this,r=document.createElement("style");r.type="text/css",r.innerText="\n        @font-face{\n            font-family: '".concat(t,"';\n            src: url('").concat(e,"') format('woff2'),\n            url('").concat(e,"') format('woff'),\n            url('").concat(e,"') format('truetype');\n        }"),r.onload=function(){if(document.fonts)try{document.fonts.load("24px ".concat(t),"L7text"),document.fonts.ready.then((function(){n.emit("fontloaded",{fontFamily:t})}))}catch(e){}},document.getElementsByTagName("head")[0].appendChild(r)}},{key:"destroy",value:function(){this.cache.clear(),this.iconFontMap.clear()}},{key:"generateFontAtlas",value:function(t,e,n){var r=this.fontOptions,i=r.fontFamily,o=r.fontWeight,a=r.fontSize,s=r.buffer,u=r.sdf,c=r.radius,l=r.cutoff,h=r.iconfont,f=n&&n.data;f||((f=F$.document.createElement("canvas")).width=1024);var p=f.getContext("2d",{willReadFrequently:!0});p3(p,i,a,o);var d=function(t){var e=t.characterSet,n=t.getFontWidth,r=t.fontHeight,i=t.buffer,o=t.maxCanvasWidth,a=t.mapping,s=void 0===a?{}:a,u=t.xOffset,c=void 0===u?0:u,l=t.yOffset,h=void 0===l?0:l,f=0,p=c;Array.from(e).forEach((function(t,e){if(!s[t]){var r=n(t,e);p+30>o&&(p=0,f++),s[t]={x:p,y:h+30*f,width:30,height:30,advance:r},p+=30}}));var d=r+2*i;return{mapping:s,xOffset:p,yOffset:h+f*d,canvasHeight:u3(h+(f+1)*d)}}(Jq({getFontWidth:function(t){return p.measureText(t).width},fontHeight:1*a,buffer:s,characterSet:e,maxCanvasWidth:1024},n&&{mapping:n.mapping,xOffset:n.xOffset,yOffset:n.yOffset})),m=d.mapping,v=d.canvasHeight,g=d.xOffset,y=d.yOffset,x=p.getImageData(0,0,f.width,f.height);if(f.height=v,p.putImageData(x,0,0),p3(p,i,a,o),u){var b,_=new Q2(a,s,c,l,i,o),w=p.getImageData(0,0,_.size,_.size),S=c3(e);try{for(S.s();!(b=S.n()).done;){var M=b.value;if(h){var E=String.fromCharCode(parseInt(M.replace("&#x","").replace(";",""),16));d3(_.draw(E),w)}else d3(_.draw(M),w);p.putImageData(w,m[M].x,m[M].y)}}catch(O){S.e(O)}finally{S.f()}}else{var A,T=c3(e);try{for(T.s();!(A=T.n()).done;){var C=A.value;p.fillText(C,m[C].x,m[C].y+1*a)}}catch(O){T.e(O)}finally{T.f()}}return{xOffset:g,yOffset:y,mapping:m,data:f,width:f.width,height:f.height}}},{key:"getKey",value:function(){return"key"}},{key:"getNewChars",value:function(t,e){var n=this.cache.get(t);if(!n)return e;var r=[],i=n.mapping,o=new Set(Object.keys(i));return new Set(e).forEach((function(t){o.has(t)||r.push(t)})),r}}]),n}())||a3;function g3(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var y3,x3,b3,_3,w3=Z2()(m3=function(t){wZ(r,hc.EventEmitter);var e,n=g3(r);function r(){var t;mZ(this,r);for(var e=arguments.length,i=new Array(e),o=0;o<e;o++)i[o]=arguments[o];return $q(SZ(t=n.call.apply(n,[this].concat(i))),"canvasHeight",128),$q(SZ(t),"texture",void 0),$q(SZ(t),"canvas",void 0),$q(SZ(t),"iconData",void 0),$q(SZ(t),"iconMap",void 0),$q(SZ(t),"ctx",void 0),$q(SZ(t),"loadingImageCount",0),t}return gZ(r,[{key:"isLoading",value:function(){return 0===this.loadingImageCount}},{key:"init",value:function(){this.iconData=[],this.iconMap={},this.canvas=F$.document.createElement("canvas"),this.canvas.width=128,this.canvas.height=128,this.ctx=this.canvas.getContext("2d")}},{key:"addImage",value:(e=RK(jK.mark((function t(e,n){var r,i;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=new Image,this.loadingImageCount++,this.hasImage(e)||this.iconData.push({id:e,size:64}),this.updateIconMap(),t.next=6,this.loadImage(n);case 6:r=t.sent,(i=this.iconData.find((function(t){return t.id===e})))&&(i.image=r,i.width=r.width,i.height=r.height),this.update();case 10:case"end":return t.stop()}}),t,this)}))),function(t,n){return e.apply(this,arguments)})},{key:"addImageMini",value:function(t,e,n){var r=this,i=n.getSceneConfig().canvas,o=i.createImage();if(this.loadingImageCount++,this.hasImage(t))throw new Error("Image Id already exists");this.iconData.push({id:t,size:64}),this.updateIconMap(),this.loadImageMini(e,i).then((function(e){o=e;var n=r.iconData.find((function(e){return e.id===t}));n&&(n.image=o,n.width=o.width,n.height=o.height),r.update()}))}},{key:"getTexture",value:function(){return this.texture}},{key:"getIconMap",value:function(){return this.iconMap}},{key:"getCanvas",value:function(){return this.canvas}},{key:"hasImage",value:function(t){return this.iconMap.hasOwnProperty(t)}},{key:"removeImage",value:function(t){this.hasImage(t)&&(this.iconData=this.iconData.filter((function(e){return e.id!==t})),delete this.iconMap[t],this.update())}},{key:"destroy",value:function(){this.removeAllListeners("imageUpdate"),this.iconData=[],this.iconMap={}}},{key:"loadImage",value:function(t){return new Promise((function(e,n){if(t instanceof HTMLImageElement)e(t);else{var r=new Image;r.crossOrigin="anonymous",r.onload=function(){e(r)},r.onerror=function(){n(new Error("Could not load image at "+t))},r.src=t instanceof File?URL.createObjectURL(t):t}}))}},{key:"update",value:function(){this.updateIconMap(),this.updateIconAtlas(),this.loadingImageCount--,0===this.loadingImageCount&&this.emit("imageUpdate")}},{key:"updateIconAtlas",value:function(){var t=this;this.canvas.width=1024,this.canvas.height=this.canvasHeight,Object.keys(this.iconMap).forEach((function(e){var n=t.iconMap[e],r=n.x,i=n.y,o=n.image,a=n.width,s=void 0===a?64:a,u=n.height,c=void 0===u?64:u,l=Math.max(s,c)/64,h=c/l,f=s/l;o&&t.ctx.drawImage(o,r+(64-f)/2,i+(64-h)/2,f,h)}))}},{key:"updateIconMap",value:function(){var t=function(t,e,n){var r,i=0,o=0,a=0,s=[],u={},c=i3(t);try{for(c.s();!(r=c.n()).done;){var l=r.value;if(!u[l.id]){var h=l.size;i+h+e>n&&(s3(u,s,o),i=0,o=a+o+e,a=0,s=[]),s.push({icon:l,xOffset:i}),i=i+h+e,a=Math.max(a,h)}}}catch(f){c.e(f)}finally{c.f()}return s.length>0&&s3(u,s,o),{mapping:u,canvasHeight:u3(a+o+e)}}(this.iconData,3,1024),e=t.mapping,n=t.canvasHeight;this.iconMap=e,this.canvasHeight=n}},{key:"loadImageMini",value:function(t,e){return new Promise((function(n,r){var i=e.createImage();i.crossOrigin="anonymous",i.onload=function(){n(i)},i.onerror=function(){r(new Error("Could not load image at "+t))},i.src=t}))}}]),r}())||m3,S3=Z2()(y3=function(){function t(){mZ(this,t),$q(this,"viewport",void 0),$q(this,"overridedViewProjectionMatrix",void 0),$q(this,"jitteredViewProjectionMatrix",void 0),$q(this,"jitteredProjectionMatrix",void 0),$q(this,"viewMatrixInverse",void 0),$q(this,"cameraPosition",void 0)}return gZ(t,[{key:"init",value:function(){}},{key:"update",value:function(t){this.viewport=t,this.viewMatrixInverse=no(),co(this.viewMatrixInverse,t.getViewMatrix()),this.cameraPosition=[this.viewMatrixInverse[12],this.viewMatrixInverse[13],this.viewMatrixInverse[14]]}},{key:"getProjectionMatrix",value:function(){return this.jitteredProjectionMatrix||this.viewport.getProjectionMatrix()}},{key:"getModelMatrix",value:function(){return this.viewport.getModelMatrix()}},{key:"getViewMatrix",value:function(){return this.viewport.getViewMatrix()}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.getViewMatrixUncentered()}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.getViewProjectionMatrixUncentered()}},{key:"getViewProjectionMatrix",value:function(){return this.overridedViewProjectionMatrix||this.jitteredViewProjectionMatrix||this.viewport.getViewProjectionMatrix()}},{key:"getZoom",value:function(){return this.viewport.getZoom()}},{key:"getZoomScale",value:function(){return this.viewport.getZoomScale()}},{key:"getCenter",value:function(){var t=lZ(this.viewport.getCenter(),2);return[t[0],t[1]]}},{key:"getFocalDistance",value:function(){return this.viewport.getFocalDistance()}},{key:"getCameraPosition",value:function(){return this.cameraPosition}},{key:"projectFlat",value:function(t,e){return this.viewport.projectFlat(t,e)}},{key:"setViewProjectionMatrix",value:function(t){this.overridedViewProjectionMatrix=t}},{key:"jitterProjectionMatrix",value:function(t,e){var n=yo(no(),[t,e,0]);this.jitteredProjectionMatrix=ho(no(),n,this.viewport.getProjectionMatrix()),this.jitteredViewProjectionMatrix=ho(no(),this.jitteredProjectionMatrix,this.viewport.getViewMatrix())}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0,this.jitteredViewProjectionMatrix=void 0}}]),t}())||y3;function M3(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return E3(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return E3(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function E3(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}(b3=x3||(x3={})).TOPRIGHT="topright",b3.TOPLEFT="topleft",b3.BOTTOMRIGHT="bottomright",b3.BOTTOMLEFT="bottomleft",b3.TOPCENTER="topcenter",b3.BOTTOMCENTER="bottomcenter",b3.LEFTCENTER="leftcenter",b3.RIGHTCENTER="rightcenter",b3.LEFTTOP="lefttop",b3.RIGHTTOP="righttop",b3.LEFTBOTTOM="leftbottom",b3.RIGHTBOTTOM="rightbottom";var A3,T3,C3,O3={topleft:"column",topright:"column",bottomright:"column",bottomleft:"column",leftcenter:"column",rightcenter:"column",topcenter:"row",bottomcenter:"row",lefttop:"row",righttop:"row",leftbottom:"row",rightbottom:"row"},k3=Z2()(_3=function(){function t(){mZ(this,t),$q(this,"container",void 0),$q(this,"controlCorners",void 0),$q(this,"controlContainer",void 0),$q(this,"scene",void 0),$q(this,"mapsService",void 0),$q(this,"controls",[]),$q(this,"unAddControls",[])}return gZ(t,[{key:"init",value:function(t,e){this.container=t.container,this.scene=e,this.mapsService=e.get(J2.IMapService),this.initControlPos()}},{key:"addControl",value:function(t,e){e.get(J2.IMapService).map?(t.addTo(this.scene),this.controls.push(t)):this.unAddControls.push(t)}},{key:"getControlByName",value:function(t){return this.controls.find((function(e){return e.controlOption.name===t}))}},{key:"removeControl",value:function(t){var e=this.controls.indexOf(t);return e>-1&&this.controls.splice(e,1),t.remove(),this}},{key:"addControls",value:function(){var t=this;this.unAddControls.forEach((function(e){e.addTo(t.scene),t.controls.push(e)})),this.unAddControls=[]}},{key:"destroy",value:function(){var t,e=M3(this.controls);try{for(e.s();!(t=e.n()).done;){t.value.remove()}}catch(n){e.e(n)}finally{e.f()}this.controls=[],this.clearControlPos()}},{key:"initControlPos",value:function(){var t=this.controlCorners={},e="l7-",n=this.controlContainer=z$("div",e+"control-container",this.container);Object.values(x3).forEach((function(r){var i,o;!function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=r.map((function(t){return e+t})).join(" ");t[r.filter((function(t){return!["row","column"].includes(t)})).join("")]=z$("div",i,n)}((i=r,o=i.replace(/^(top|bottom|left|right|center)/,"$1-").split("-"),[].concat(Xq(o),[O3[i]])))}))}},{key:"clearControlPos",value:function(){for(var t in this.controlCorners)this.controlCorners[t]&&U$(this.controlCorners[t]);this.controlContainer&&U$(this.controlContainer)}}]),t}())||_3,P3=Z2()(A3=function(){function t(){mZ(this,t),$q(this,"container",void 0),$q(this,"scene",void 0),$q(this,"mapsService",void 0),$q(this,"markers",[]),$q(this,"markerLayers",[]),$q(this,"unAddMarkers",[]),$q(this,"unAddMarkerLayers",[])}return gZ(t,[{key:"addMarkerLayer",value:function(t){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markerLayers.push(t),t.addTo(this.scene)):this.unAddMarkerLayers.push(t)}},{key:"removeMarkerLayer",value:function(t){t.destroy(),this.markerLayers.indexOf(t);var e=this.markerLayers.indexOf(t);e>-1&&this.markerLayers.splice(e,1)}},{key:"addMarker",value:function(t){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markers.push(t),t.addTo(this.scene)):this.unAddMarkers.push(t)}},{key:"addMarkers",value:function(){var t=this;this.unAddMarkers.forEach((function(e){e.addTo(t.scene),t.markers.push(e)})),this.unAddMarkers=[]}},{key:"addMarkerLayers",value:function(){var t=this;this.unAddMarkerLayers.forEach((function(e){t.markerLayers.push(e),e.addTo(t.scene)})),this.unAddMarkers=[]}},{key:"removeMarker",value:function(t){t.remove(),this.markers.indexOf(t);var e=this.markers.indexOf(t);e>-1&&this.markers.splice(e,1)}},{key:"removeAllMarkers",value:function(){this.destroy()}},{key:"init",value:function(t){this.scene=t,this.mapsService=t.get(J2.IMapService)}},{key:"destroy",value:function(){this.markers.forEach((function(t){t.remove()})),this.markers=[],this.markerLayers.forEach((function(t){t.destroy()})),this.markerLayers=[]}},{key:"removeMakerLayerMarker",value:function(t){t.destroy()}}]),t}())||A3,L3=Z2()(T3=function(){function t(){mZ(this,t),$q(this,"scene",void 0),$q(this,"mapsService",void 0),$q(this,"popups",[]),$q(this,"unAddPopups",[])}return gZ(t,[{key:"isMarkerReady",get:function(){return this.mapsService.map&&this.mapsService.getMarkerContainer()}},{key:"removePopup",value:function(t){null!=t&&t.isOpen()&&t.remove();var e=this.popups.indexOf(t);e>-1&&this.popups.splice(e,1);var n=this.unAddPopups.indexOf(t);n>-1&&this.unAddPopups.splice(n,1)}},{key:"destroy",value:function(){this.popups.forEach((function(t){return t.remove()}))}},{key:"addPopup",value:function(t){var e=this;t&&t.getOptions().autoClose&&[].concat(Xq(this.popups),Xq(this.unAddPopups)).forEach((function(t){t.getOptions().autoClose&&e.removePopup(t)})),this.isMarkerReady?(t.addTo(this.scene),this.popups.push(t)):this.unAddPopups.push(t),t.on("close",(function(){e.removePopup(t)}))}},{key:"initPopup",value:function(){var t=this;this.unAddPopups.length&&this.unAddPopups.forEach((function(e){t.addPopup(e),t.unAddPopups=[]}))}},{key:"init",value:function(t){this.scene=t,this.mapsService=t.get(J2.IMapService)}}]),t}())||T3,R3={MapToken:"您正在使用 Demo 测试 Token, 生产环境务必自行注册 Token 确保服务稳定",SDK:"请确认引入了mapbox-gl api且在L7之前引入"},I3={id:"map",logoPosition:"bottomleft",logoVisible:!0,antialias:!0,stencil:!0,isMini:!1,preserveDrawingBuffer:!1,pickBufferScale:1,fitBoundsOptions:{animate:!1}},N3={colors:["rgb(103,0,31)","rgb(178,24,43)","rgb(214,96,77)","rgb(244,165,130)","rgb(253,219,199)","rgb(247,247,247)","rgb(209,229,240)","rgb(146,197,222)","rgb(67,147,195)","rgb(33,102,172)","rgb(5,48,97)"],size:10,shape:"circle",scales:{},shape2d:["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"],shape3d:["cylinder","triangleColumn","hexagonColumn","squareColumn"],minZoom:-1,maxZoom:24,visible:!0,autoFit:!1,pickingBuffer:0,enablePropagation:!1,zIndex:0,blend:"normal",pickedFeatureID:-1,enableMultiPassRenderer:!1,enablePicking:!0,active:!1,activeColor:"#2f54eb",enableHighlight:!1,enableSelect:!1,highlightColor:"#2f54eb",activeMix:0,selectColor:"blue",selectMix:0,enableTAA:!1,jitterScale:1,enableLighting:!1,animateOption:{enable:!1,interval:.2,duration:4,trailLength:.15},forward:!0},D3=Z2()(C3=function(){function t(){mZ(this,t),$q(this,"sceneConfigCache",{}),$q(this,"layerConfigCache",{}),$q(this,"layerAttributeConfigCache",{})}return gZ(t,[{key:"getSceneConfig",value:function(t){return this.sceneConfigCache[t]}},{key:"getSceneWarninfo",value:function(t){return R3[t]}},{key:"setSceneConfig",value:function(t,e){this.sceneConfigCache[t]=Jq(Jq({},I3),e)}},{key:"getLayerConfig",value:function(t){return this.layerConfigCache[t]}},{key:"setLayerConfig",value:function(t,e,n){this.layerConfigCache[e]=Jq({},hZ.merge({},this.sceneConfigCache[t],N3,n))}},{key:"getAttributeConfig",value:function(t){return this.layerAttributeConfigCache[t]}},{key:"setAttributeConfig",value:function(t,e){this.layerAttributeConfigCache[t]=Jq(Jq({},this.layerAttributeConfigCache[t]),e)}},{key:"clean",value:function(){this.sceneConfigCache={},this.layerConfigCache={}}}]),t}())||C3;function F3(t,e,n,r){n&&Object.defineProperty(t,e,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function j3(t,e,n,r,i){var o={};return Object.keys(r).forEach((function(t){o[t]=r[t]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce((function(n,r){return r(t,e,n)||n}),o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(t,e,o),o=null),o}var B3,z3,U3=Math.PI/180,V3=4003e4;function G3(t){var e=t.latitude,n=void 0===e?0:e,r=t.zoom,i=void 0===r?0:r,o=t.scale,a=t.highPrecision,s=void 0!==a&&a,u=t.flipY,c=void 0!==u&&u,l={},h=512*(o=void 0!==o?o:Math.pow(2,i)),f=Math.cos(n*U3),p=h/360,d=p/f,m=h/V3/f;if(l.pixelsPerMeter=[m,-m,m],l.metersPerPixel=[1/m,-1/m,1/m],l.pixelsPerDegree=[p,-d,m],l.degreesPerPixel=[1/p,-1/d,1/m],s){var v=U3*Math.tan(n*U3)/f,g=p*v/2,y=h/V3*v,x=y/d*m;l.pixelsPerDegree2=[0,-g,y],l.pixelsPerMeter2=[x,0,x],c&&(l.pixelsPerDegree2[1]=-l.pixelsPerDegree2[1],l.pixelsPerMeter2[1]=-l.pixelsPerMeter2[1])}return c&&(l.pixelsPerMeter[1]=-l.pixelsPerMeter[1],l.metersPerPixel[1]=-l.metersPerPixel[1],l.pixelsPerDegree[1]=-l.pixelsPerDegree[1],l.degreesPerPixel[1]=-l.degreesPerPixel[1]),l}(z3=B3||(B3={}))[z3.LNGLAT=1]="LNGLAT",z3[z3.LNGLAT_OFFSET=2]="LNGLAT_OFFSET",z3[z3.VECTOR_TILE=3]="VECTOR_TILE",z3[z3.IDENTITY=4]="IDENTITY",z3[z3.P20=5]="P20",z3[z3.P20_OFFSET=6]="P20_OFFSET",z3[z3.METER_OFFSET=7]="METER_OFFSET",z3[z3.P20_2=8]="P20_2";var W3,H3,Y3,X3,q3,Z3,$3="u_CoordinateSystem",K3="u_ViewportCenter",J3="u_ViewportCenterProjection",Q3="u_PixelsPerDegree",t4="u_PixelsPerDegree2",e4="u_PixelsPerMeter",n4="u_Mvp",r4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],i4=(W3=Z2(),H3=d2(J2.ICameraService),W3((q3=j3((X3=function(){function t(){mZ(this,t),$q(this,"needRefresh",!0),F3(this,"cameraService",q3,this),$q(this,"coordinateSystem",void 0),$q(this,"viewportCenter",void 0),$q(this,"viewportCenterProjection",void 0),$q(this,"pixelsPerDegree",void 0),$q(this,"pixelsPerDegree2",void 0),$q(this,"pixelsPerMeter",void 0)}return gZ(t,[{key:"refresh",value:function(t){var e=this.cameraService.getZoom(),n=this.cameraService.getZoomScale(),r=t||this.cameraService.getCenter(),i=G3({latitude:r[1],zoom:e}),o=i.pixelsPerMeter,a=i.pixelsPerDegree;this.viewportCenter=r,this.viewportCenterProjection=[0,0,0,0],this.pixelsPerMeter=o,this.pixelsPerDegree=a,this.pixelsPerDegree2=[0,0,0],this.coordinateSystem===B3.LNGLAT||this.coordinateSystem===B3.P20?this.cameraService.setViewProjectionMatrix(void 0):this.coordinateSystem===B3.LNGLAT_OFFSET?this.calculateLnglatOffset(r,e):this.coordinateSystem===B3.P20_OFFSET&&this.calculateLnglatOffset(r,e,n,!0),this.needRefresh=!1}},{key:"getCoordinateSystem",value:function(){return this.coordinateSystem}},{key:"setCoordinateSystem",value:function(t){this.coordinateSystem=t}},{key:"getViewportCenter",value:function(){return this.viewportCenter}},{key:"getViewportCenterProjection",value:function(){return this.viewportCenterProjection}},{key:"getPixelsPerDegree",value:function(){return this.pixelsPerDegree}},{key:"getPixelsPerDegree2",value:function(){return this.pixelsPerDegree2}},{key:"getPixelsPerMeter",value:function(){return this.pixelsPerMeter}},{key:"calculateLnglatOffset",value:function(t,e,n,r){var i=G3({latitude:t[1],zoom:e,scale:n,flipY:r,highPrecision:!0}),o=i.pixelsPerMeter,a=i.pixelsPerDegree,s=i.pixelsPerDegree2,u=this.cameraService.getViewMatrix(),c=this.cameraService.getProjectionMatrix(),l=ho([],c,u),h=this.cameraService.projectFlat([Math.fround(t[0]),Math.fround(t[1])],Math.pow(2,e));this.viewportCenterProjection=ba([],[h[0],h[1],0,1],l),l=ho([],c,u=this.cameraService.getViewMatrixUncentered()||u),l=ho([],l,r4),this.cameraService.setViewProjectionMatrix(l),this.pixelsPerMeter=o,this.pixelsPerDegree=a,this.pixelsPerDegree2=s}}]),t}()).prototype,"cameraService",[H3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Y3=X3))||Y3),o4={};
/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */
Z3={get exports(){return o4},set exports(t){o4=t}},function(t,e,n,r){var i,o="undefined"!=typeof my&&!!my&&"function"==typeof my.showToast&&!0!==my.isFRM,a="undefined"!=typeof wx&&null!==wx&&(void 0!==wx.request||void 0!==wx.miniProgram),s=o||a,u=["","webkit","Moz","MS","ms","o"],c=s?"":e.createElement("div"),l=Math.round,h=Math.abs,f=Date.now;function p(t,e,n){return setTimeout(b(t,n),e)}function d(t,e,n){return!!Array.isArray(t)&&(m(t,n[e],n),!0)}function m(t,e,n){var i;if(t)if(t.forEach)t.forEach(e,n);else if(t.length!==r)for(i=0;i<t.length;)e.call(n,t[i],i,t),i++;else for(i in t)t.hasOwnProperty(i)&&e.call(n,t[i],i,t)}function v(e,n,r){var i="DEPRECATED METHOD: "+n+"\n"+r+" AT \n";return function(){var n=new Error("get-stack-trace"),r=n&&n.stack?n.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",o=t.console&&(t.console.warn||t.console.log);return o&&o.call(t.console,i,r),e.apply(this,arguments)}}i="function"!=typeof Object.assign?function(t){if(t===r||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var i=arguments[n];if(i!==r&&null!==i)for(var o in i)i.hasOwnProperty(o)&&(e[o]=i[o])}return e}:Object.assign;var g=v((function(t,e,n){for(var i=Object.keys(e),o=0;o<i.length;)(!n||n&&t[i[o]]===r)&&(t[i[o]]=e[i[o]]),o++;return t}),"extend","Use `assign`."),y=v((function(t,e){return g(t,e,!0)}),"merge","Use `assign`.");function x(t,e,n){var r,o=e.prototype;(r=t.prototype=Object.create(o)).constructor=t,r._super=o,n&&i(r,n)}function b(t,e){return function(){return t.apply(e,arguments)}}function _(t,e){return"function"==typeof t?t.apply(e&&e[0]||r,e):t}function w(t,e){return t===r?e:t}function S(t,e,n){m(T(e),(function(e){t.addEventListener(e,n,!1)}))}function M(t,e,n){m(T(e),(function(e){t.removeEventListener(e,n,!1)}))}function E(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function A(t,e){return t.indexOf(e)>-1}function T(t){return t.trim().split(/\s+/g)}function C(t,e,n){if(t.indexOf&&!n)return t.indexOf(e);for(var r=0;r<t.length;){if(n&&t[r][n]==e||!n&&t[r]===e)return r;r++}return-1}function O(t){return Array.prototype.slice.call(t,0)}function k(t,e,n){for(var r=[],i=[],o=0;o<t.length;){var a=e?t[o][e]:t[o];C(i,a)<0&&r.push(t[o]),i[o]=a,o++}return n&&(r=e?r.sort((function(t,n){return t[e]>n[e]})):r.sort()),r}function P(t,e){for(var n,i,o=e[0].toUpperCase()+e.slice(1),a=0;a<u.length;){if((i=(n=u[a])?n+o:e)in t)return i;a++}return r}var L=1;function R(e){var n=e.ownerDocument||e;return n.defaultView||n.parentWindow||t}var I="ontouchstart"in t,N=P(t,"PointerEvent")!==r,D=I&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),F="touch",j="mouse",B=24,z=["x","y"],U=["clientX","clientY"];function V(t,e){var n=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){_(t.options.enable,[t])&&n.handler(e)},this.init()}function G(t,e,n){var i=n.pointers.length,o=n.changedPointers.length,a=1&e&&i-o==0,s=12&e&&i-o==0;n.isFirst=!!a,n.isFinal=!!s,a&&(t.session={}),n.eventType=e,function(t,e){var n=t.session,i=e.pointers,o=i.length;n.firstInput||(n.firstInput=W(e)),o>1&&!n.firstMultiple?n.firstMultiple=W(e):1===o&&(n.firstMultiple=!1);var a=n.firstInput,s=n.firstMultiple,u=s?s.center:a.center,c=e.center=H(i);e.timeStamp=f(),e.deltaTime=e.timeStamp-a.timeStamp,e.angle=Z(u,c),e.distance=q(u,c),function(t,e){var n=e.center,r=t.offsetDelta||{},i=t.prevDelta||{},o=t.prevInput||{};1!==e.eventType&&4!==o.eventType||(i=t.prevDelta={x:o.deltaX||0,y:o.deltaY||0},r=t.offsetDelta={x:n.x,y:n.y}),e.deltaX=i.x+(n.x-r.x),e.deltaY=i.y+(n.y-r.y)}(n,e),e.offsetDirection=X(e.deltaX,e.deltaY);var l,p,d=Y(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=d.x,e.overallVelocityY=d.y,e.overallVelocity=h(d.x)>h(d.y)?d.x:d.y,e.scale=s?(l=s.pointers,q((p=i)[0],p[1],U)/q(l[0],l[1],U)):1,e.rotation=s?function(t,e){return Z(e[1],e[0],U)+Z(t[1],t[0],U)}(s.pointers,i):0,e.maxPointers=n.prevInput?e.pointers.length>n.prevInput.maxPointers?e.pointers.length:n.prevInput.maxPointers:e.pointers.length,function(t,e){var n,i,o,a,s=t.lastInterval||e,u=e.timeStamp-s.timeStamp;if(8!=e.eventType&&(u>25||s.velocity===r)){var c=e.deltaX-s.deltaX,l=e.deltaY-s.deltaY,f=Y(u,c,l);i=f.x,o=f.y,n=h(f.x)>h(f.y)?f.x:f.y,a=X(c,l),t.lastInterval=e}else n=s.velocity,i=s.velocityX,o=s.velocityY,a=s.direction;e.velocity=n,e.velocityX=i,e.velocityY=o,e.direction=a}(n,e);var m=t.element;E(e.srcEvent.target,m)&&(m=e.srcEvent.target),e.target=m}(t,n),t.emit("hammer.input",n),t.recognize(n),t.session.prevInput=n}function W(t){for(var e=[],n=0;n<t.pointers.length;)e[n]={clientX:l(t.pointers[n].clientX),clientY:l(t.pointers[n].clientY)},n++;return{timeStamp:f(),pointers:e,center:H(e),deltaX:t.deltaX,deltaY:t.deltaY}}function H(t){var e=t.length;if(1===e)return{x:l(t[0].clientX),y:l(t[0].clientY)};for(var n=0,r=0,i=0;i<e;)n+=t[i].clientX,r+=t[i].clientY,i++;return{x:l(n/e),y:l(r/e)}}function Y(t,e,n){return{x:e/t||0,y:n/t||0}}function X(t,e){return t===e?1:h(t)>=h(e)?t<0?2:4:e<0?8:16}function q(t,e,n){n||(n=z);var r=e[n[0]]-t[n[0]],i=e[n[1]]-t[n[1]];return Math.sqrt(r*r+i*i)}function Z(t,e,n){n||(n=z);var r=e[n[0]]-t[n[0]],i=e[n[1]]-t[n[1]];return 180*Math.atan2(i,r)/Math.PI}V.prototype={handler:function(){},init:function(){this.evEl&&S(this.element,this.evEl,this.domHandler),this.evTarget&&S(this.target,this.evTarget,this.domHandler),this.evWin&&S(R(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&M(this.element,this.evEl,this.domHandler),this.evTarget&&M(this.target,this.evTarget,this.domHandler),this.evWin&&M(R(this.element),this.evWin,this.domHandler)}};var $={mousedown:1,mousemove:2,mouseup:4},K="mousedown",J="mousemove mouseup";function Q(){this.evEl=K,this.evWin=J,this.pressed=!1,V.apply(this,arguments)}x(Q,V,{handler:function(t){var e=$[t.type];1&e&&0===t.button&&(this.pressed=!0),2&e&&1!==t.which&&(e=4),this.pressed&&(4&e&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:j,srcEvent:t}))}});var tt={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},et={2:F,3:"pen",4:j,5:"kinect"},nt="pointerdown",rt="pointermove pointerup pointercancel";function it(){this.evEl=nt,this.evWin=rt,V.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}s||!t.MSPointerEvent||t.PointerEvent||(nt="MSPointerDown",rt="MSPointerMove MSPointerUp MSPointerCancel"),x(it,V,{handler:function(t){var e=this.store,n=!1,r=t.type.toLowerCase().replace("ms",""),i=tt[r],o=et[t.pointerType]||t.pointerType,a=o==F,s=C(e,t.pointerId,"pointerId");1&i&&(0===t.button||a)?s<0&&(e.push(t),s=e.length-1):12&i&&(n=!0),s<0||(e[s]=t,this.callback(this.manager,i,{pointers:e,changedPointers:[t],pointerType:o,srcEvent:t}),n&&e.splice(s,1))}});var ot={touchstart:1,touchmove:2,touchend:4,touchcancel:8},at="touchstart",st="touchstart touchmove touchend touchcancel";function ut(){this.evTarget=at,this.evWin=st,this.started=!1,V.apply(this,arguments)}function ct(t,e){var n=O(t.touches),r=O(t.changedTouches);return 12&e&&(n=k(n.concat(r),"identifier",!0)),[n,r]}x(ut,V,{handler:function(t){var e=ot[t.type];if(1===e&&(this.started=!0),this.started){var n=ct.call(this,t,e);12&e&&n[0].length-n[1].length==0&&(this.started=!1),this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:F,srcEvent:t})}}});var lt={touchstart:1,touchmove:2,touchend:4,touchcancel:8},ht="touchstart touchmove touchend touchcancel";function ft(){this.evTarget=ht,this.targetIds={},V.apply(this,arguments)}function pt(t,e){var n=O(t.touches),r=this.targetIds;if(3&e&&1===n.length)return r[n[0].identifier]=!0,[n,n];var i,o,a=O(t.changedTouches),s=[],u=this.target;if(o=n.filter((function(t){return E(t.target,u)})),1===e)for(i=0;i<o.length;)r[o[i].identifier]=!0,i++;for(i=0;i<a.length;)r[a[i].identifier]&&s.push(a[i]),12&e&&delete r[a[i].identifier],i++;return s.length?[k(o.concat(s),"identifier",!0),s]:void 0}function dt(){V.apply(this,arguments);var t=b(this.handler,this);this.touch=new ft(this.manager,t),this.mouse=new Q(this.manager,t),this.primaryTouch=null,this.lastTouches=[]}function mt(t,e){1&t?(this.primaryTouch=e.changedPointers[0].identifier,vt.call(this,e)):12&t&&vt.call(this,e)}function vt(t){var e=t.changedPointers[0];if(e.identifier===this.primaryTouch){var n={x:e.clientX,y:e.clientY};this.lastTouches.push(n);var r=this.lastTouches;setTimeout((function(){var t=r.indexOf(n);t>-1&&r.splice(t,1)}),2500)}}function gt(t){for(var e=t.srcEvent.clientX,n=t.srcEvent.clientY,r=0;r<this.lastTouches.length;r++){var i=this.lastTouches[r],o=Math.abs(e-i.x),a=Math.abs(n-i.y);if(o<=25&&a<=25)return!0}return!1}x(ft,V,{handler:function(t){var e=lt[t.type],n=pt.call(this,t,e);n&&this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:F,srcEvent:t})}}),x(dt,V,{handler:function(t,e,n){var r=n.pointerType==F,i=n.pointerType==j;if(!(i&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(r)mt.call(this,e,n);else if(i&&gt.call(this,n))return;this.callback(t,e,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var yt=s?r:P(c.style,"touchAction"),xt=yt!==r,bt="compute",_t="auto",wt="manipulation",St="none",Mt="pan-x",Et="pan-y",At=function(){if(!xt)return!1;var e={};if(s)return e;var n=t.CSS&&t.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach((function(r){e[r]=!n||t.CSS.supports("touch-action",r)})),e}();function Tt(t,e){this.manager=t,this.set(e)}Tt.prototype={set:function(t){t==bt&&(t=this.compute()),xt&&this.manager.element.style&&At[t]&&(this.manager.element.style[yt]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return m(this.manager.recognizers,(function(e){_(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))})),function(t){if(A(t,St))return St;var e=A(t,Mt),n=A(t,Et);return e&&n?St:e||n?e?Mt:Et:A(t,wt)?wt:_t}(t.join(" "))},preventDefaults:function(t){var e=t.srcEvent,n=t.offsetDirection;if(this.manager.session.prevented)e.preventDefault();else{var r=this.actions,i=A(r,St)&&!At[St],o=A(r,Et)&&!At[Et],a=A(r,Mt)&&!At[Mt];if(i){var s=1===t.pointers.length,u=t.distance<2,c=t.deltaTime<250;if(s&&u&&c)return}if(!a||!o)return i||o&&6&n||a&&n&B?this.preventSrc(e):void 0}},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};var Ct=32;function Ot(t){this.options=i({},this.defaults,t||{}),this.id=L++,this.manager=null,this.options.enable=w(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function kt(t){return 16&t?"cancel":8&t?"end":4&t?"move":2&t?"start":""}function Pt(t){return 16==t?"down":8==t?"up":2==t?"left":4==t?"right":""}function Lt(t,e){var n=e.manager;return n?n.get(t):t}function Rt(){Ot.apply(this,arguments)}function It(){Rt.apply(this,arguments),this.pX=null,this.pY=null}function Nt(){Rt.apply(this,arguments)}function Dt(){Ot.apply(this,arguments),this._timer=null,this._input=null}function Ft(){Rt.apply(this,arguments)}function jt(){Rt.apply(this,arguments)}function Bt(){Ot.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function zt(t,e){return(e=e||{}).recognizers=w(e.recognizers,zt.defaults.preset),new Ut(t,e)}function Ut(t,e){var n;this.options=i({},zt.defaults,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=new((n=this).options.inputClass||(N?it:D?ft:I?dt:Q))(n,G),this.touchAction=new Tt(this,this.options.touchAction),Vt(this,!0),m(this.options.recognizers,(function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])}),this)}function Vt(t,e){var n,r=t.element;r.style&&(m(t.options.cssProps,(function(i,o){n=P(r.style,o),e?(t.oldCssProps[n]=r.style[n],r.style[n]=i):r.style[n]=t.oldCssProps[n]||""})),e||(t.oldCssProps={}))}Ot.prototype={defaults:{},set:function(t){return i(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(d(t,"recognizeWith",this))return this;var e=this.simultaneous;return e[(t=Lt(t,this)).id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return d(t,"dropRecognizeWith",this)||(t=Lt(t,this),delete this.simultaneous[t.id]),this},requireFailure:function(t){if(d(t,"requireFailure",this))return this;var e=this.requireFail;return-1===C(e,t=Lt(t,this))&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(d(t,"dropRequireFailure",this))return this;t=Lt(t,this);var e=C(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){var e=this,n=this.state;function r(n){e.manager.emit(n,t)}n<8&&r(e.options.event+kt(n)),r(e.options.event),t.additionalEvent&&r(t.additionalEvent),n>=8&&r(e.options.event+kt(n))},tryEmit:function(t){if(this.canEmit())return this.emit(t);this.state=Ct},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(33&this.requireFail[t].state))return!1;t++}return!0},recognize:function(t){var e=i({},t);if(!_(this.options.enable,[this,e]))return this.reset(),void(this.state=Ct);56&this.state&&(this.state=1),this.state=this.process(e),30&this.state&&this.tryEmit(e)},process:function(t){},getTouchAction:function(){},reset:function(){}},x(Rt,Ot,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,n=t.eventType,r=6&e,i=this.attrTest(t);return r&&(8&n||!i)?16|e:r||i?4&n?8|e:2&e?4|e:2:Ct}}),x(It,Rt,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var t=this.options.direction,e=[];return 6&t&&e.push(Et),t&B&&e.push(Mt),e},directionTest:function(t){var e=this.options,n=!0,r=t.distance,i=t.direction,o=t.deltaX,a=t.deltaY;return i&e.direction||(6&e.direction?(i=0===o?1:o<0?2:4,n=o!=this.pX,r=Math.abs(t.deltaX)):(i=0===a?1:a<0?8:16,n=a!=this.pY,r=Math.abs(t.deltaY))),t.direction=i,n&&r>e.threshold&&i&e.direction},attrTest:function(t){return Rt.prototype.attrTest.call(this,t)&&(2&this.state||!(2&this.state)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=Pt(t.direction);e&&(t.additionalEvent=this.options.event+e),this._super.emit.call(this,t)}}),x(Nt,Rt,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[St]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||2&this.state)},emit:function(t){if(1!==t.scale){var e=t.scale<1?"in":"out";t.additionalEvent=this.options.event+e}this._super.emit.call(this,t)}}),x(Dt,Ot,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[_t]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,r=t.distance<e.threshold,i=t.deltaTime>e.time;if(this._input=t,!r||!n||12&t.eventType&&!i)this.reset();else if(1&t.eventType)this.reset(),this._timer=p((function(){this.state=8,this.tryEmit()}),e.time,this);else if(4&t.eventType)return 8;return Ct},reset:function(){clearTimeout(this._timer)},emit:function(t){8===this.state&&(t&&4&t.eventType?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=f(),this.manager.emit(this.options.event,this._input)))}}),x(Ft,Rt,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[St]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||2&this.state)}}),x(jt,Rt,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return It.prototype.getTouchAction.call(this)},attrTest:function(t){var e,n=this.options.direction;return 30&n?e=t.overallVelocity:6&n?e=t.overallVelocityX:n&B&&(e=t.overallVelocityY),this._super.attrTest.call(this,t)&&n&t.offsetDirection&&t.distance>this.options.threshold&&t.maxPointers==this.options.pointers&&h(e)>this.options.velocity&&4&t.eventType},emit:function(t){var e=Pt(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),x(Bt,Ot,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[wt]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,r=t.distance<e.threshold,i=t.deltaTime<e.time;if(this.reset(),1&t.eventType&&0===this.count)return this.failTimeout();if(r&&i&&n){if(4!=t.eventType)return this.failTimeout();var o=!this.pTime||t.timeStamp-this.pTime<e.interval,a=!this.pCenter||q(this.pCenter,t.center)<e.posThreshold;if(this.pTime=t.timeStamp,this.pCenter=t.center,a&&o?this.count+=1:this.count=1,this._input=t,0==this.count%e.taps)return this.hasRequireFailures()?(this._timer=p((function(){this.state=8,this.tryEmit()}),e.interval,this),2):8}return Ct},failTimeout:function(){return this._timer=p((function(){this.state=Ct}),this.options.interval,this),Ct},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),zt.VERSION="2.0.7",zt.defaults={domEvents:!1,touchAction:bt,enable:!0,inputTarget:null,inputClass:null,preset:[[Ft,{enable:!1}],[Nt,{enable:!1},["rotate"]],[jt,{direction:6}],[It,{direction:6},["swipe"]],[Bt],[Bt,{event:"doubletap",taps:2},["tap"]],[Dt]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},Ut.prototype={set:function(t){return i(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?2:1},recognize:function(t){var e=this.session;if(!e.stopped){var n;this.touchAction.preventDefaults(t);var r=this.recognizers,i=e.curRecognizer;(!i||i&&8&i.state)&&(i=e.curRecognizer=null);for(var o=0;o<r.length;)n=r[o],2===e.stopped||i&&n!=i&&!n.canRecognizeWith(i)?n.reset():n.recognize(t),!i&&14&n.state&&(i=e.curRecognizer=n),o++}},get:function(t){if(t instanceof Ot)return t;for(var e=this.recognizers,n=0;n<e.length;n++)if(e[n].options.event==t)return e[n];return null},add:function(t){if(d(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(d(t,"remove",this))return this;if(t=this.get(t)){var e=this.recognizers,n=C(e,t);-1!==n&&(e.splice(n,1),this.touchAction.update())}return this},on:function(t,e){if(t!==r&&e!==r){var n=this.handlers;return m(T(t),(function(t){n[t]=n[t]||[],n[t].push(e)})),this}},off:function(t,e){if(t!==r){var n=this.handlers;return m(T(t),(function(t){e?n[t]&&n[t].splice(C(n[t],e),1):delete n[t]})),this}},emit:function(t,n){this.options.domEvents&&function(t,n){if(!s){var r=e.createEvent("Event");r.initEvent(t,!0,!0),r.gesture=n,n.target.dispatchEvent(r)}}(t,n);var r=this.handlers[t]&&this.handlers[t].slice();if(r&&r.length){n.type=t,n.preventDefault=function(){n.srcEvent.preventDefault()};for(var i=0;i<r.length;)r[i](n),i++}},destroy:function(){this.element&&Vt(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},s||(i(zt,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:Ct,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:B,DIRECTION_ALL:30,Manager:Ut,Input:V,TouchAction:Tt,TouchInput:ft,MouseInput:Q,PointerEventInput:it,TouchMouseInput:dt,SingleTouchInput:ut,Recognizer:Ot,AttrRecognizer:Rt,Tap:Bt,Pan:It,Swipe:jt,Pinch:Nt,Rotate:Ft,Press:Dt,on:S,off:M,each:m,merge:y,extend:g,assign:i,inherit:x,bindFn:b,prefixed:P}),("undefined"!=typeof window?window:"undefined"!=typeof self?self:{}).Hammer=zt,Z3.exports?Z3.exports=zt:t.Hammer=zt)}("undefined"!=typeof window?window:{console:null,MSPointerEvent:null,PointerEvent:null,CSS:null},document);const a4=o4;var s4,u4,c4,l4,h4,f4,p4;function d4(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}(u4=s4||(s4={})).Hover="hover",u4.Click="click",u4.Select="select",u4.Active="active",u4.Drag="drag";var m4,v4,g4,y4,x4,b4,_4,w4,S4,M4,E4,A4,T4,C4,O4,k4={panstart:"dragstart",panmove:"dragging",panend:"dragend",pancancel:"dragcancel"},P4=(c4=Z2(),l4=d2(J2.IMapService),c4((f4=function(t){wZ(n,fc);var e=d4(n);function n(){var t;mZ(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return $q(SZ(t=e.call.apply(e,[this].concat(i))),"indragging",!1),F3(SZ(t),"mapService",p4,SZ(t)),$q(SZ(t),"hammertime",void 0),$q(SZ(t),"lastClickTime",0),$q(SZ(t),"lastClickXY",[-1,-1]),$q(SZ(t),"clickTimer",void 0),$q(SZ(t),"$containter",void 0),$q(SZ(t),"onDrag",(function(e){var n=t.interactionEvent(e);n.type=k4[n.type],"dragging"===n.type?t.indragging=!0:t.indragging=!1,t.emit(s4.Drag,n)})),$q(SZ(t),"onHammer",(function(e){e.srcEvent.stopPropagation();var n=t.interactionEvent(e);t.emit(s4.Hover,n)})),$q(SZ(t),"onTouch",(function(e){var n=e.touches[0];t.onHover({x:n.pageX,y:n.pageY,type:"touch"})})),$q(SZ(t),"onHover",(function(e){var n=e.clientX,r=e.clientY,i=e.type,o=t.mapService.getMapContainer();if(o)if(N$)n=n-o.left-0,r=r-o.top-0;else{var a=o.getBoundingClientRect(),s=a.top;n=n-a.left-o.clientLeft,r=r-s-o.clientTop}var u=t.mapService.containerToLngLat([n,r]);if("click"!==i)"touch"!==i?"click"!==i&&"dblclick"!==i&&t.emit(s4.Hover,{x:n,y:r,lngLat:u,type:i,target:e}):t.isDoubleTap(n,r,u);else{if(!N$&&"ontouchstart"in document.documentElement==!0)return;t.isDoubleTap(n,r,u)}})),t}return gZ(n,[{key:"init",value:function(){this.addEventListenerOnMap(),this.$containter=this.mapService.getMapContainer()}},{key:"destroy",value:function(){this.hammertime&&this.hammertime.destroy(),this.removeEventListenerOnMap(),this.off(s4.Hover)}},{key:"triggerHover",value:function(t){var e=t.x,n=t.y;this.emit(s4.Hover,{x:e,y:n})}},{key:"triggerSelect",value:function(t){this.emit(s4.Select,{featureId:t})}},{key:"triggerActive",value:function(t){this.emit(s4.Active,{featureId:t})}},{key:"handleMiniEvent",value:function(t){this.onHover({clientX:t.touches[0].pageX,clientY:t.touches[0].pageY,type:"touch"})}},{key:"addEventListenerOnMap",value:function(){var t=this.mapService.getMapContainer();if(t)if(N$)F$.document.addEventListener("touchstart",this.handleMiniEvent.bind(this));else{var e=new a4.Manager(t);e.add(new a4.Tap({event:"dblclick",taps:2})),e.add(new a4.Tap({event:"click"})),e.add(new a4.Pan({threshold:0,pointers:0})),e.add(new a4.Press({})),e.on("dblclick click",this.onHammer),e.on("panstart panmove panend pancancel",this.onDrag),t.addEventListener("mousemove",this.onHover),t.addEventListener("mousedown",this.onHover,!0),t.addEventListener("mouseup",this.onHover),t.addEventListener("contextmenu",this.onHover),this.hammertime=e}}},{key:"removeEventListenerOnMap",value:function(){if(N$)F$.document.removeEventListener("touchstart",this.handleMiniEvent.bind(this));else{var t=this.mapService.getMapContainer();t&&(t.removeEventListener("mousemove",this.onHover),this.hammertime.off("dblclick click",this.onHammer),this.hammertime.off("panstart panmove panend pancancel",this.onDrag),t.removeEventListener("mousedown",this.onHover),t.removeEventListener("mouseup",this.onHover),t.removeEventListener("contextmenu",this.onHover))}}},{key:"interactionEvent",value:function(t){var e,n,r=t.type;"touch"===t.pointerType?(n=Math.floor(t.pointers[0].clientY),e=Math.floor(t.pointers[0].clientX)):(n=Math.floor(t.srcEvent.y),e=Math.floor(t.srcEvent.x));var i=this.mapService.getMapContainer();if(i){var o=i.getBoundingClientRect(),a=o.top;e-=o.left,n-=a}return{x:e,y:n,lngLat:this.mapService.containerToLngLat([e,n]),type:r,target:t.srcEvent}}},{key:"isDoubleTap",value:function(t,e,n){var r=this,i=(new Date).getTime(),o="click";i-this.lastClickTime<400&&Math.abs(this.lastClickXY[0]-t)<10&&Math.abs(this.lastClickXY[1]-e)<10?(this.lastClickTime=0,this.lastClickXY=[-1,-1],this.clickTimer&&clearTimeout(this.clickTimer),o="dblclick",this.emit(s4.Hover,{x:t,y:e,lngLat:n,type:o})):(this.lastClickTime=i,this.lastClickXY=[t,e],this.clickTimer=setTimeout((function(){o="click",r.emit(s4.Hover,{x:t,y:e,lngLat:n,type:o})}),400))}}]),n}(),p4=j3(f4.prototype,"mapService",[l4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h4=f4))||h4),L4=0;function R4(t){if(N$)return null;var e=t;if("string"==typeof t&&(e=document.getElementById(t)),e){var n=document.createElement("div");return n.style.cssText+="\n      position: absolute;\n      z-index:2;\n      height: 100%;\n      width: 100%;\n      pointer-events: none;\n    ",n.id="l7-scene-".concat(L4++),n.classList.add("l7-scene"),e.appendChild(n),n}return null}(v4=m4||(m4={}))[v4.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",v4[v4.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",v4[v4.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",v4[v4.POINTS=0]="POINTS",v4[v4.LINES=1]="LINES",v4[v4.LINE_LOOP=2]="LINE_LOOP",v4[v4.LINE_STRIP=3]="LINE_STRIP",v4[v4.TRIANGLES=4]="TRIANGLES",v4[v4.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",v4[v4.TRIANGLE_FAN=6]="TRIANGLE_FAN",v4[v4.ZERO=0]="ZERO",v4[v4.ONE=1]="ONE",v4[v4.SRC_COLOR=768]="SRC_COLOR",v4[v4.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",v4[v4.SRC_ALPHA=770]="SRC_ALPHA",v4[v4.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",v4[v4.DST_ALPHA=772]="DST_ALPHA",v4[v4.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",v4[v4.DST_COLOR=774]="DST_COLOR",v4[v4.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",v4[v4.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",v4[v4.FUNC_ADD=32774]="FUNC_ADD",v4[v4.BLEND_EQUATION=32777]="BLEND_EQUATION",v4[v4.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",v4[v4.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",v4[v4.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",v4[v4.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",v4[v4.MAX_EXT=32776]="MAX_EXT",v4[v4.MIN_EXT=32775]="MIN_EXT",v4[v4.BLEND_DST_RGB=32968]="BLEND_DST_RGB",v4[v4.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",v4[v4.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",v4[v4.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",v4[v4.CONSTANT_COLOR=32769]="CONSTANT_COLOR",v4[v4.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",v4[v4.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",v4[v4.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",v4[v4.BLEND_COLOR=32773]="BLEND_COLOR",v4[v4.ARRAY_BUFFER=34962]="ARRAY_BUFFER",v4[v4.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",v4[v4.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",v4[v4.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",v4[v4.STREAM_DRAW=35040]="STREAM_DRAW",v4[v4.STATIC_DRAW=35044]="STATIC_DRAW",v4[v4.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",v4[v4.BUFFER_SIZE=34660]="BUFFER_SIZE",v4[v4.BUFFER_USAGE=34661]="BUFFER_USAGE",v4[v4.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",v4[v4.FRONT=1028]="FRONT",v4[v4.BACK=1029]="BACK",v4[v4.FRONT_AND_BACK=1032]="FRONT_AND_BACK",v4[v4.CULL_FACE=2884]="CULL_FACE",v4[v4.BLEND=3042]="BLEND",v4[v4.DITHER=3024]="DITHER",v4[v4.STENCIL_TEST=2960]="STENCIL_TEST",v4[v4.DEPTH_TEST=2929]="DEPTH_TEST",v4[v4.SCISSOR_TEST=3089]="SCISSOR_TEST",v4[v4.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",v4[v4.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",v4[v4.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",v4[v4.NO_ERROR=0]="NO_ERROR",v4[v4.INVALID_ENUM=1280]="INVALID_ENUM",v4[v4.INVALID_VALUE=1281]="INVALID_VALUE",v4[v4.INVALID_OPERATION=1282]="INVALID_OPERATION",v4[v4.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",v4[v4.CW=2304]="CW",v4[v4.CCW=2305]="CCW",v4[v4.LINE_WIDTH=2849]="LINE_WIDTH",v4[v4.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",v4[v4.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",v4[v4.CULL_FACE_MODE=2885]="CULL_FACE_MODE",v4[v4.FRONT_FACE=2886]="FRONT_FACE",v4[v4.DEPTH_RANGE=2928]="DEPTH_RANGE",v4[v4.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",v4[v4.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",v4[v4.DEPTH_FUNC=2932]="DEPTH_FUNC",v4[v4.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",v4[v4.STENCIL_FUNC=2962]="STENCIL_FUNC",v4[v4.STENCIL_FAIL=2964]="STENCIL_FAIL",v4[v4.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",v4[v4.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",v4[v4.STENCIL_REF=2967]="STENCIL_REF",v4[v4.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",v4[v4.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",v4[v4.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",v4[v4.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",v4[v4.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",v4[v4.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",v4[v4.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",v4[v4.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",v4[v4.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",v4[v4.VIEWPORT=2978]="VIEWPORT",v4[v4.SCISSOR_BOX=3088]="SCISSOR_BOX",v4[v4.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",v4[v4.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",v4[v4.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",v4[v4.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",v4[v4.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",v4[v4.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",v4[v4.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",v4[v4.RED_BITS=3410]="RED_BITS",v4[v4.GREEN_BITS=3411]="GREEN_BITS",v4[v4.BLUE_BITS=3412]="BLUE_BITS",v4[v4.ALPHA_BITS=3413]="ALPHA_BITS",v4[v4.DEPTH_BITS=3414]="DEPTH_BITS",v4[v4.STENCIL_BITS=3415]="STENCIL_BITS",v4[v4.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",v4[v4.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",v4[v4.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",v4[v4.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",v4[v4.SAMPLES=32937]="SAMPLES",v4[v4.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",v4[v4.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",v4[v4.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",v4[v4.DONT_CARE=4352]="DONT_CARE",v4[v4.FASTEST=4353]="FASTEST",v4[v4.NICEST=4354]="NICEST",v4[v4.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",v4[v4.BYTE=5120]="BYTE",v4[v4.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",v4[v4.SHORT=5122]="SHORT",v4[v4.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",v4[v4.INT=5124]="INT",v4[v4.UNSIGNED_INT=5125]="UNSIGNED_INT",v4[v4.FLOAT=5126]="FLOAT",v4[v4.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",v4[v4.ALPHA=6406]="ALPHA",v4[v4.RGB=6407]="RGB",v4[v4.RGBA=6408]="RGBA",v4[v4.LUMINANCE=6409]="LUMINANCE",v4[v4.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",v4[v4.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",v4[v4.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",v4[v4.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",v4[v4.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",v4[v4.VERTEX_SHADER=35633]="VERTEX_SHADER",v4[v4.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",v4[v4.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",v4[v4.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",v4[v4.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",v4[v4.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",v4[v4.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",v4[v4.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",v4[v4.SHADER_TYPE=35663]="SHADER_TYPE",v4[v4.DELETE_STATUS=35712]="DELETE_STATUS",v4[v4.LINK_STATUS=35714]="LINK_STATUS",v4[v4.VALIDATE_STATUS=35715]="VALIDATE_STATUS",v4[v4.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",v4[v4.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",v4[v4.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",v4[v4.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",v4[v4.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",v4[v4.NEVER=512]="NEVER",v4[v4.LESS=513]="LESS",v4[v4.EQUAL=514]="EQUAL",v4[v4.LEQUAL=515]="LEQUAL",v4[v4.GREATER=516]="GREATER",v4[v4.NOTEQUAL=517]="NOTEQUAL",v4[v4.GEQUAL=518]="GEQUAL",v4[v4.ALWAYS=519]="ALWAYS",v4[v4.KEEP=7680]="KEEP",v4[v4.REPLACE=7681]="REPLACE",v4[v4.INCR=7682]="INCR",v4[v4.DECR=7683]="DECR",v4[v4.INVERT=5386]="INVERT",v4[v4.INCR_WRAP=34055]="INCR_WRAP",v4[v4.DECR_WRAP=34056]="DECR_WRAP",v4[v4.VENDOR=7936]="VENDOR",v4[v4.RENDERER=7937]="RENDERER",v4[v4.VERSION=7938]="VERSION",v4[v4.NEAREST=9728]="NEAREST",v4[v4.LINEAR=9729]="LINEAR",v4[v4.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",v4[v4.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",v4[v4.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",v4[v4.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",v4[v4.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",v4[v4.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",v4[v4.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",v4[v4.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",v4[v4.TEXTURE_2D=3553]="TEXTURE_2D",v4[v4.TEXTURE=5890]="TEXTURE",v4[v4.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",v4[v4.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",v4[v4.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",v4[v4.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",v4[v4.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",v4[v4.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",v4[v4.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",v4[v4.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",v4[v4.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",v4[v4.TEXTURE0=33984]="TEXTURE0",v4[v4.TEXTURE1=33985]="TEXTURE1",v4[v4.TEXTURE2=33986]="TEXTURE2",v4[v4.TEXTURE3=33987]="TEXTURE3",v4[v4.TEXTURE4=33988]="TEXTURE4",v4[v4.TEXTURE5=33989]="TEXTURE5",v4[v4.TEXTURE6=33990]="TEXTURE6",v4[v4.TEXTURE7=33991]="TEXTURE7",v4[v4.TEXTURE8=33992]="TEXTURE8",v4[v4.TEXTURE9=33993]="TEXTURE9",v4[v4.TEXTURE10=33994]="TEXTURE10",v4[v4.TEXTURE11=33995]="TEXTURE11",v4[v4.TEXTURE12=33996]="TEXTURE12",v4[v4.TEXTURE13=33997]="TEXTURE13",v4[v4.TEXTURE14=33998]="TEXTURE14",v4[v4.TEXTURE15=33999]="TEXTURE15",v4[v4.TEXTURE16=34e3]="TEXTURE16",v4[v4.TEXTURE17=34001]="TEXTURE17",v4[v4.TEXTURE18=34002]="TEXTURE18",v4[v4.TEXTURE19=34003]="TEXTURE19",v4[v4.TEXTURE20=34004]="TEXTURE20",v4[v4.TEXTURE21=34005]="TEXTURE21",v4[v4.TEXTURE22=34006]="TEXTURE22",v4[v4.TEXTURE23=34007]="TEXTURE23",v4[v4.TEXTURE24=34008]="TEXTURE24",v4[v4.TEXTURE25=34009]="TEXTURE25",v4[v4.TEXTURE26=34010]="TEXTURE26",v4[v4.TEXTURE27=34011]="TEXTURE27",v4[v4.TEXTURE28=34012]="TEXTURE28",v4[v4.TEXTURE29=34013]="TEXTURE29",v4[v4.TEXTURE30=34014]="TEXTURE30",v4[v4.TEXTURE31=34015]="TEXTURE31",v4[v4.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",v4[v4.REPEAT=10497]="REPEAT",v4[v4.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",v4[v4.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",v4[v4.FLOAT_VEC2=35664]="FLOAT_VEC2",v4[v4.FLOAT_VEC3=35665]="FLOAT_VEC3",v4[v4.FLOAT_VEC4=35666]="FLOAT_VEC4",v4[v4.INT_VEC2=35667]="INT_VEC2",v4[v4.INT_VEC3=35668]="INT_VEC3",v4[v4.INT_VEC4=35669]="INT_VEC4",v4[v4.BOOL=35670]="BOOL",v4[v4.BOOL_VEC2=35671]="BOOL_VEC2",v4[v4.BOOL_VEC3=35672]="BOOL_VEC3",v4[v4.BOOL_VEC4=35673]="BOOL_VEC4",v4[v4.FLOAT_MAT2=35674]="FLOAT_MAT2",v4[v4.FLOAT_MAT3=35675]="FLOAT_MAT3",v4[v4.FLOAT_MAT4=35676]="FLOAT_MAT4",v4[v4.SAMPLER_2D=35678]="SAMPLER_2D",v4[v4.SAMPLER_CUBE=35680]="SAMPLER_CUBE",v4[v4.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",v4[v4.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",v4[v4.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",v4[v4.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",v4[v4.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",v4[v4.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",v4[v4.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",v4[v4.COMPILE_STATUS=35713]="COMPILE_STATUS",v4[v4.LOW_FLOAT=36336]="LOW_FLOAT",v4[v4.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",v4[v4.HIGH_FLOAT=36338]="HIGH_FLOAT",v4[v4.LOW_INT=36339]="LOW_INT",v4[v4.MEDIUM_INT=36340]="MEDIUM_INT",v4[v4.HIGH_INT=36341]="HIGH_INT",v4[v4.FRAMEBUFFER=36160]="FRAMEBUFFER",v4[v4.RENDERBUFFER=36161]="RENDERBUFFER",v4[v4.RGBA4=32854]="RGBA4",v4[v4.RGB5_A1=32855]="RGB5_A1",v4[v4.RGB565=36194]="RGB565",v4[v4.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",v4[v4.STENCIL_INDEX=6401]="STENCIL_INDEX",v4[v4.STENCIL_INDEX8=36168]="STENCIL_INDEX8",v4[v4.DEPTH_STENCIL=34041]="DEPTH_STENCIL",v4[v4.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",v4[v4.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",v4[v4.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",v4[v4.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",v4[v4.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",v4[v4.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",v4[v4.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",v4[v4.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",v4[v4.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",v4[v4.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",v4[v4.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",v4[v4.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",v4[v4.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",v4[v4.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",v4[v4.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",v4[v4.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",v4[v4.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",v4[v4.NONE=0]="NONE",v4[v4.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",v4[v4.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",v4[v4.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",v4[v4.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",v4[v4.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",v4[v4.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",v4[v4.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",v4[v4.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",v4[v4.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",v4[v4.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",v4[v4.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",v4[v4.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",v4[v4.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",v4[v4.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL";var I4,N4,D4,F4,j4,B4,z4,U4=(g4=Z2(),y4=d2(J2.IMapService),x4=d2(J2.IRendererService),b4=d2(J2.IGlobalConfigService),_4=d2(J2.IInteractionService),w4=d2(J2.ILayerService),g4((M4=function(){function t(){var e=this;mZ(this,t),$q(this,"pickedColors",void 0),$q(this,"pickedTileLayers",[]),F3(this,"mapService",E4,this),F3(this,"rendererService",A4,this),F3(this,"configService",T4,this),F3(this,"interactionService",C4,this),F3(this,"layerService",O4,this),$q(this,"pickingFBO",void 0),$q(this,"width",0),$q(this,"height",0),$q(this,"alreadyInPicking",!1),$q(this,"pickBufferScale",1),$q(this,"pickFromPickingFBO",(function(t,n){var r=n.x,i=n.y,o=n.lngLat,a=n.type,s=n.target,u=!1,c=e.rendererService,l=c.readPixels,h=c.getContainer,f=e.getContainerSize(h()),p=f.width,d=f.height;p*=Y$,d*=Y$;var m=t.getLayerConfig(),v=m.enableHighlight,g=m.enableSelect,y=r*Y$,x=i*Y$;if(y>p-1*Y$||y<0||x>d-1*Y$||x<0)return!1;var b=l({x:Math.floor(y/e.pickBufferScale),y:Math.floor((d-(i+1)*Y$)/e.pickBufferScale),width:1,height:1,data:new Uint8Array(4),framebuffer:e.pickingFBO});if(e.pickedColors=b,0!==b[0]||0!==b[1]||0!==b[2]){var _=AK(b),w=t.layerPickService.getFeatureById(_);_!==t.getCurrentPickId()&&"mousemove"===a&&(a="mouseenter");var S={x:r,y:i,type:a,lngLat:o,featureId:_,feature:w,target:s};w&&(u=!0,t.setCurrentPickId(_),e.triggerHoverOnLayer(t,S))}else{var M={x:r,y:i,lngLat:o,type:null!==t.getCurrentPickId()&&"mousemove"===a?"mouseout":"un"+a,featureId:null,target:s,feature:null};e.triggerHoverOnLayer(t,Jq(Jq({},M),{},{type:"unpick"})),e.triggerHoverOnLayer(t,M),t.setCurrentPickId(null)}if(v&&t.layerPickService.highlightPickedFeature(b),g&&"click"===a&&(null==b?void 0:b.toString())!==[0,0,0,0].toString()){var E=AK(b);null===t.getCurrentSelectedId()||E!==t.getCurrentSelectedId()?(t.layerPickService.selectFeature(b),t.setCurrentSelectedId(E)):(t.layerPickService.selectFeature(new Uint8Array([0,0,0,0])),t.setCurrentSelectedId(null))}return u}))}var e,n,r;return gZ(t,[{key:"init",value:function(t){var e=this.rendererService,n=e.createTexture2D,r=e.createFramebuffer,i=e.getContainer,o=this.getContainerSize(i()),a=o.width,s=o.height;a*=Y$,s*=Y$,this.pickBufferScale=this.configService.getSceneConfig(t).pickBufferScale||1,this.pickingFBO=r({color:n({width:Math.round(a/this.pickBufferScale),height:Math.round(s/this.pickBufferScale),wrapS:m4.CLAMP_TO_EDGE,wrapT:m4.CLAMP_TO_EDGE})}),this.interactionService.on(s4.Hover,this.pickingAllLayer.bind(this))}},{key:"boxPickLayer",value:(r=RK(jK.mark((function t(e,n,r){var i,o,a,s=this;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=this.rendererService,o=i.useFramebuffer,a=i.clear,this.resizePickingFBO(),o(this.pickingFBO,(function(){a({framebuffer:s.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),e.hooks.beforePickingEncode.call(),e.renderModels(),e.hooks.afterPickingEncode.call();var t=s.pickBox(e,n);r(t)}));case 3:case"end":return t.stop()}}),t,this)}))),function(t,e,n){return r.apply(this,arguments)})},{key:"pickBox",value:function(t,e){var n=this,r=lZ(e.map((function(t){var e=t<0?0:t;return Math.floor(e*Y$/n.pickBufferScale)})),4),i=r[0],o=r[1],a=r[2],s=r[3],u=this.rendererService,c=u.readPixels,l=u.getContainer,h=this.getContainerSize(l()),f=h.width,p=h.height;if(p*=Y$,i>((f*=Y$)-1)*Y$/this.pickBufferScale||a<0||o>(p-1)*Y$/this.pickBufferScale||s<0)return[];for(var d=Math.min(f/this.pickBufferScale,a)-i,m=Math.min(p/this.pickBufferScale,s)-o,v=c({x:i,y:Math.floor(p/this.pickBufferScale-(s+1)),width:d,height:m,data:new Uint8Array(d*m*4),framebuffer:this.pickingFBO}),g=[],y={},x=0;x<v.length/4;x+=1){var b=AK(v.slice(4*x,4*x+4));if(-1!==b&&!y[b]){var _=t.layerPickService.getFeatureById(b);g.push(Jq(Jq({},_),{},{pickedFeatureIdx:b})),y[b]=!0}}return g}},{key:"handleCursor",value:function(t,e){var n=t.getLayerConfig(),r=n.cursor,i=void 0===r?"":r;if(n.cursorEnabled){var o="GAODE2.x"===this.mapService.version?this.mapService.getMapContainer():this.mapService.getMarkerContainer(),a=null==o?void 0:o.style.getPropertyValue("cursor");"unmousemove"===e&&""!==a?null==o||o.style.setProperty("cursor",""):"mousemove"===e&&(null==o||o.style.setProperty("cursor",i))}}},{key:"destroy",value:function(){this.pickingFBO.destroy(),this.pickingFBO=null}},{key:"getContainerSize",value:function(t){return t.getContext?{width:t.width/Y$,height:t.height/Y$}:t.getBoundingClientRect()}},{key:"pickingAllLayer",value:(n=RK(jK.mark((function t(e){return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.layerService.needPick(e.type)&&this.isPickingAllLayer()){t.next=2;break}return t.abrupt("return");case 2:return this.alreadyInPicking=!0,t.next=5,this.pickingLayers(e);case 5:this.layerService.renderLayers(),this.alreadyInPicking=!1;case 7:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"isPickingAllLayer",value:function(){return!this.alreadyInPicking&&(!this.layerService.alreadyInRendering&&(!this.interactionService.indragging&&!!this.layerService.getShaderPickStat()))}},{key:"resizePickingFBO",value:function(){var t=this.rendererService.getContainer,e=this.getContainerSize(t()),n=e.width,r=e.height;n*=Y$,r*=Y$,this.width===n&&this.height===r||(this.pickingFBO.resize({width:Math.round(n/this.pickBufferScale),height:Math.round(r/this.pickBufferScale)}),this.width=n,this.height=r)}},{key:"pickingLayers",value:(e=RK(jK.mark((function t(e){var n,r,i,o=this;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=this.rendererService,r=n.useFramebuffer,i=n.clear,this.resizePickingFBO(),r(this.pickingFBO,(function(){o.layerService.getRenderList().filter((function(t){return t.needPick(e.type)})).reverse().some((function(t){i({framebuffer:o.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),t.layerPickService.pickRender(e);var n=o.pickFromPickingFBO(t,e);return o.layerService.pickedLayerId=n?+t.id:-1,n&&!t.getLayerConfig().enablePropagation}))}));case 3:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})},{key:"triggerHoverOnLayer",value:function(t,e){var n,r,i,o;o=!0,null==(n=e)||null===(r=n.target)||void 0===r||null===(i=r.path)||void 0===i||i.map((function(t){var e;null!=t&&t.classList&&(null==t||null===(e=t.classList)||void 0===e||e.forEach((function(t){"l7-marker"!==t&&"l7-popup"!==t||(o=!1)})))})),o&&(this.handleCursor(t,e.type),t.emit(e.type,e))}}]),t}(),E4=j3(M4.prototype,"mapService",[y4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A4=j3(M4.prototype,"rendererService",[x4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T4=j3(M4.prototype,"configService",[b4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C4=j3(M4.prototype,"interactionService",[_4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O4=j3(M4.prototype,"layerService",[w4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S4=M4))||S4),V4=function(){function t(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];mZ(this,t),$q(this,"autoStart",void 0),$q(this,"startTime",0),$q(this,"oldTime",0),$q(this,"running",!1),$q(this,"elapsedTime",0),this.autoStart=e}return gZ(t,[{key:"start",value:function(){this.startTime=("undefined"==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}},{key:"stop",value:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}},{key:"getElapsedTime",value:function(){return this.getDelta(),this.elapsedTime}},{key:"getDelta",value:function(){var t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var e=("undefined"==typeof performance?Date:performance).now();t=(e-this.oldTime)/1e3,this.oldTime=e,this.elapsedTime+=t}return t}}]),t}();function G4(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return W4(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return W4(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function W4(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function H4(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var Y4,X4,q4,Z4,$4,K4,J4=(I4=Z2(),N4=d2(J2.IRendererService),D4=d2(J2.IMapService),I4((j4=function(t){wZ(a,hc.EventEmitter);var e,n,r,i,o=H4(a);function a(){var t;mZ(this,a);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return $q(SZ(t=o.call.apply(o,[this].concat(n))),"pickedLayerId",-1),$q(SZ(t),"clock",new V4),$q(SZ(t),"alreadyInRendering",!1),$q(SZ(t),"layers",[]),$q(SZ(t),"layerList",[]),$q(SZ(t),"layerRenderID",void 0),$q(SZ(t),"sceneInited",!1),$q(SZ(t),"animateInstanceCount",0),$q(SZ(t),"shaderPicking",!0),$q(SZ(t),"enableRender",!0),F3(SZ(t),"renderService",B4,SZ(t)),F3(SZ(t),"mapService",z4,SZ(t)),$q(SZ(t),"reRender",hZ.throttle((function(){t.updateLayerRenderList(),t.renderLayers()}),32)),$q(SZ(t),"throttleRenderLayers",hZ.throttle((function(){t.renderLayers()}),16)),t}return gZ(a,[{key:"needPick",value:function(t){return this.layerList.some((function(e){return e.needPick(t)}))}},{key:"add",value:function(t){var e=this;this.layers.push(t),this.sceneInited&&t.init().then((function(){e.updateLayerRenderList(),e.renderLayers()}))}},{key:"addMask",value:function(t){var e=this;this.sceneInited&&t.init().then((function(){e.renderLayers()}))}},{key:"initLayers",value:(i=RK(jK.mark((function t(){var e=this;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.sceneInited=!0,this.layers.forEach(function(){var t=RK(jK.mark((function t(n){return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.startInit){t.next=4;break}return t.next=3,n.init();case 3:e.updateLayerRenderList();case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"getSceneInited",value:function(){return this.sceneInited}},{key:"getRenderList",value:function(){return this.layerList}},{key:"getLayers",value:function(){return this.layers}},{key:"getLayer",value:function(t){return this.layers.find((function(e){return e.id===t}))}},{key:"getLayerByName",value:function(t){return this.layers.find((function(e){return e.name===t}))}},{key:"remove",value:function(t,e){if(e){var n=e.layerChildren.indexOf(t);n>-1&&e.layerChildren.splice(n,1)}else{var r=this.layers.indexOf(t);r>-1&&this.layers.splice(r,1)}this.updateLayerRenderList(),t.destroy(),this.renderLayers(),this.emit("layerChange",this.layers)}},{key:"removeAllLayers",value:function(){this.destroy(),this.renderLayers()}},{key:"setEnableRender",value:function(t){this.enableRender=t}},{key:"renderLayers",value:(r=RK(jK.mark((function t(){var e,n,r;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.alreadyInRendering&&this.enableRender){t.next=2;break}return t.abrupt("return");case 2:this.alreadyInRendering=!0,this.clear(),e=G4(this.layerList),t.prev=5,e.s();case 7:if((n=e.n()).done){t.next=19;break}if((r=n.value).masks.filter((function(t){return t.inited})).length>0&&(this.renderService.clear({stencil:0,depth:1,framebuffer:null}),r.masks.map(function(){var t=RK(jK.mark((function t(e){return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.render();case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())),!r.getLayerConfig().enableMultiPassRenderer){t.next=15;break}return t.next=13,r.renderMultiPass();case 13:t.next=17;break;case 15:return t.next=17,r.render();case 17:t.next=7;break;case 19:t.next=24;break;case 21:t.prev=21,t.t0=t.catch(5),e.e(t.t0);case 24:return t.prev=24,e.f(),t.finish(24);case 27:this.alreadyInRendering=!1;case 28:case"end":return t.stop()}}),t,this,[[5,21,24,27]])}))),function(){return r.apply(this,arguments)})},{key:"renderMask",value:function(t){t.filter((function(t){return t.inited})).map((function(t){t.render()}))}},{key:"beforeRenderData",value:(n=RK(jK.mark((function t(e){return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.hooks.beforeRenderData.promise();case 2:t.sent&&this.renderLayers();case 4:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"renderLayer",value:(e=RK(jK.mark((function t(e){var n=this;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.masks.filter((function(t){return t.inited})).length>0&&e.masks.map((function(t){n.renderService.clear({stencil:0,depth:1,framebuffer:null}),t.render()})),!e.getLayerConfig().enableMultiPassRenderer){t.next=6;break}return t.next=4,e.renderMultiPass();case 4:t.next=8;break;case 6:return t.next=8,e.render();case 8:case"end":return t.stop()}}),t)}))),function(t){return e.apply(this,arguments)})},{key:"updateLayerRenderList",value:function(){var t=this;this.layerList=[],this.layers.filter((function(t){return t.inited})).filter((function(t){return t.isVisible()})).sort((function(t,e){return t.zIndex-e.zIndex})).forEach((function(e){t.layerList.push(e)}))}},{key:"destroy",value:function(){this.layers.forEach((function(t){t.destroy()})),this.layers=[],this.layerList=[],this.emit("layerChange",this.layers)}},{key:"startAnimate",value:function(){0==this.animateInstanceCount++&&(this.clock.start(),this.runRender())}},{key:"stopAnimate",value:function(){0==--this.animateInstanceCount&&(this.stopRender(),this.clock.stop())}},{key:"getOESTextureFloat",value:function(){return this.renderService.extensionObject.OES_texture_float}},{key:"enableShaderPick",value:function(){this.shaderPicking=!0}},{key:"disableShaderPick",value:function(){this.shaderPicking=!1}},{key:"getShaderPickStat",value:function(){return this.shaderPicking}},{key:"clear",value:function(){var t=EK(this.mapService.bgColor);this.renderService.clear({color:t,depth:1,stencil:0,framebuffer:null})}},{key:"runRender",value:function(){this.renderLayers(),this.layerRenderID=F$.requestAnimationFrame(this.runRender.bind(this))}},{key:"stopRender",value:function(){F$.cancelAnimationFrame(this.layerRenderID)}}]),a}(),B4=j3(j4.prototype,"renderService",[N4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z4=j3(j4.prototype,"mapService",[D4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),F4=j4))||F4),Q4=function(){function t(e){var n=this;mZ(this,t),$q(this,"name",void 0),$q(this,"type",void 0),$q(this,"scale",void 0),$q(this,"descriptor",void 0),$q(this,"featureBufferLayout",[]),$q(this,"needRescale",!1),$q(this,"needRemapping",!1),$q(this,"needRegenerateVertices",!1),$q(this,"featureRange",{startIndex:0,endIndex:1/0}),$q(this,"vertexAttribute",void 0),$q(this,"defaultCallback",(function(t){var e;return 0===t.length?(null===(e=n.scale)||void 0===e?void 0:e.defaultValues)||[]:t.map((function(t,e){var r;return(null===(r=n.scale)||void 0===r?void 0:r.scalers[e].func)(t)}))})),this.setProps(e)}return gZ(t,[{key:"setProps",value:function(t){Object.assign(this,t)}},{key:"mapping",value:function(t){var e;if(null!==(e=this.scale)&&void 0!==e&&e.callback){var n,r=null===(n=this.scale)||void 0===n?void 0:n.callback.apply(n,Xq(t));if(!hZ.isNil(r))return[r]}return this.defaultCallback(t)}},{key:"resetDescriptor",value:function(){this.descriptor&&(this.descriptor.buffer.data=[])}}]),t}(),t5=["modelType"],e5=["buffer","update","name"],n5=["buffer","update","name"],r5=["buffer","update","name"],i5=($q(Y4={},m4.FLOAT,4),$q(Y4,m4.UNSIGNED_BYTE,1),$q(Y4,m4.UNSIGNED_SHORT,2),Y4),o5=(X4=Z2(),q4=d2(J2.IRendererService),X4(($4=function(){function t(){mZ(this,t),$q(this,"attributesAndIndices",void 0),F3(this,"rendererService",K4,this),$q(this,"attributes",[]),$q(this,"triangulation",void 0),$q(this,"featureLayout",{sizePerElement:0,elements:[]})}return gZ(t,[{key:"registerStyleAttribute",value:function(t){var e=this.getLayerStyleAttribute(t.name||"");return e?e.setProps(t):(e=new Q4(t),this.attributes.push(e)),e}},{key:"updateStyleAttribute",value:function(t,e,n){var r=this.getLayerStyleAttribute(t);r||(r=this.registerStyleAttribute(Jq(Jq({},e),{},{name:t})));var i=e.scale;i&&r&&(r.scale=i,r.needRescale=!0,r.needRemapping=!0,r.needRegenerateVertices=!0,n&&n.featureRange&&(r.featureRange=n.featureRange))}},{key:"getLayerStyleAttributes",value:function(){return this.attributes}},{key:"getLayerStyleAttribute",value:function(t){return this.attributes.find((function(e){return e.name===t}))}},{key:"getLayerAttributeScale",value:function(t){var e,n=this.getLayerStyleAttribute(t),r=null==n||null===(e=n.scale)||void 0===e?void 0:e.scalers;return r&&r[0]?r[0].func:null}},{key:"updateAttributeByFeatureRange",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,o=this.attributes.find((function(e){return e.name===t}));if(o&&o.descriptor){var a=o.descriptor,s=a.update,u=a.buffer,c=a.size,l=void 0===c?0:c,h=i5[u.type||m4.FLOAT];if(s){var f=this.featureLayout,p=f.elements,d=f.sizePerElement,m=p.slice(n,r);if(!m.length)return;var v=m[0].offset,g=v*l*h,y=m.map((function(t,n){for(var r=t.featureIdx,i=t.vertices,o=t.normals,a=i.length/d,u=[],c=0;c<a;c++){var l=o?o.slice(3*c,3*c+3):[];u.push.apply(u,Xq(s(e[r],r,i.slice(c*d,c*d+d),n,l)))}return u})).reduce((function(t,e){return t.push.apply(t,Xq(e)),t}),[]);o.vertexAttribute.updateBuffer({data:y,offset:g}),null==i||i.emit("legend:".concat(t),{type:t,attr:o})}}}},{key:"createAttributesAndIndicesAscy",value:function(t,e,n){var r=this;this.featureLayout={sizePerElement:0,elements:[]};var i=this.attributes.map((function(t){return t.resetDescriptor(),t.descriptor})).filter((function(t){return t})),o=n.modelType,a=v1(n,t5),s=this.rendererService,u=s.createAttribute,c=s.createBuffer,l=s.createElements,h={};return new Promise((function(n,s){(function(t,e){return fQ.apply(this,arguments)})(o,Jq({descriptors:r.getDescriptorsWithOutFunc(i),features:t,segmentNumber:e},a)).then((function(t){t.descriptors.forEach((function(t,e){if(t){var n=t.buffer;t.update,t.name;var i=v1(t,e5),o=u(Jq({buffer:c(n)},i));h[t.name||""]=o,r.attributes[e].vertexAttribute=o}})),r.featureLayout=t.featureLayout;var e=l({data:t.indices,type:m4.UNSIGNED_INT,count:t.indices.length});r.attributesAndIndices={attributes:h,elements:e,count:null},n(r.attributesAndIndices)})).catch((function(t){s(t)}))}))}},{key:"createAttributesAndIndices",value:function(t,e,n){var r=this;this.featureLayout={sizePerElement:0,elements:[]},e&&(this.triangulation=e);var i=this.attributes.map((function(t){return t.resetDescriptor(),t.descriptor})),o=0,a=0,s=[],u=3;t.forEach((function(t,e){var c=r.triangulation(t,n),l=c.indices,h=c.vertices,f=c.normals,p=c.size,d=c.indexes,m=c.count;"number"==typeof m&&(a+=m),l.forEach((function(t){s.push(t+o)})),u=p;var v=h.length/p;r.featureLayout.sizePerElement=u,r.featureLayout.elements.push({featureIdx:e,vertices:h,normals:f,offset:o}),o+=v;for(var g=function(n){var r=(null==f?void 0:f.slice(3*n,3*n+3))||[],o=h.slice(n*p,n*p+p),a=0;d&&void 0!==d[n]&&(a=d[n]),i.forEach((function(i,s){var u;i&&i.update&&(u=i.buffer.data).push.apply(u,Xq(i.update(t,e,o,n,r,a)))}))},y=0;y<v;y++)g(y)}));var c=this.rendererService,l=c.createAttribute,h=c.createBuffer,f=c.createElements,p={};i.forEach((function(t,e){if(t){var n=t.buffer;t.update,t.name;var i=v1(t,n5),o=l(Jq({buffer:h(n)},i));p[t.name||""]=o,r.attributes[e].vertexAttribute=o}}));var d=f({data:s,type:m4.UNSIGNED_INT,count:s.length});return this.attributesAndIndices={attributes:p,elements:d,count:a},this.attributesAndIndices}},{key:"createAttributes",value:function(t,e){var n=this;this.featureLayout={sizePerElement:0,elements:[]},e&&(this.triangulation=e);var r=this.attributes.map((function(t){return t.resetDescriptor(),t.descriptor})),i=0,o=3;t.forEach((function(t,e){var a=n.triangulation(t),s=a.indices,u=a.vertices,c=a.normals,l=a.size,h=a.indexes;s.forEach((function(t){})),o=l;var f=u.length/l;n.featureLayout.sizePerElement=o,n.featureLayout.elements.push({featureIdx:e,vertices:u,normals:c,offset:i}),i+=f;for(var p=function(n){var i=(null==c?void 0:c.slice(3*n,3*n+3))||[],o=u.slice(n*l,n*l+l),a=0;h&&void 0!==h[n]&&(a=h[n]),r.forEach((function(r,s){var u;r&&r.update&&(u=r.buffer.data).push.apply(u,Xq(r.update(t,e,o,n,i,a)))}))},d=0;d<f;d++)p(d)}));var a=this.rendererService,s=a.createAttribute,u=a.createBuffer,c={};return r.forEach((function(t,e){if(t){var r=t.buffer;t.update,t.name;var i=v1(t,r5),o=s(Jq({buffer:u(r)},i));c[t.name||""]=o,n.attributes[e].vertexAttribute=o}})),{attributes:c}}},{key:"clearAllAttributes",value:function(){var t;this.attributes.forEach((function(t){t.vertexAttribute&&t.vertexAttribute.destroy()})),null===(t=this.attributesAndIndices)||void 0===t||t.elements.destroy(),this.attributes=[]}},{key:"getDescriptorsWithOutFunc",value:function(t){return t.map((function(t){return{buffer:t.buffer,name:t.name,size:t.size}}))}}]),t}(),K4=j3($4.prototype,"rendererService",[q4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Z4=$4))||Z4);function a5(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(e){o(e)}}function s(t){try{u(r.throw(t))}catch(e){o(e)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))}function s5(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function u5(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function c5(t,e,n){if(n||2===arguments.length)for(var r,i=0,o=e.length;i<o;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))}function l5(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var h5={exports:{}},f5={exports:{}},p5={exports:{}};!function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return t&&"number"==typeof t.length&&t.length>=0&&t.length%1==0},t.exports=e.default}(p5,p5.exports);var d5={},m5={exports:{}},v5={exports:{}};!function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return function(){for(var e=[],n=arguments.length;n--;)e[n]=arguments[n];var r=e.pop();return t.call(this,e,r)}},t.exports=e.default}(v5,v5.exports);var g5={};Object.defineProperty(g5,"__esModule",{value:!0}),g5.fallback=w5,g5.wrap=S5;var y5,x5=g5.hasQueueMicrotask="function"==typeof queueMicrotask&&queueMicrotask,b5=g5.hasSetImmediate="function"==typeof setImmediate&&setImmediate,_5=g5.hasNextTick="object"==typeof process&&"function"==typeof process.nextTick;function w5(t){setTimeout(t,0)}function S5(t){return function(e){for(var n=[],r=arguments.length-1;r-- >0;)n[r]=arguments[r+1];return t((function(){return e.apply(void 0,n)}))}}y5=x5?queueMicrotask:b5?setImmediate:_5?process.nextTick:w5,g5.default=S5(y5),function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){if((0,i.isAsync)(t))return function(){for(var e=[],n=arguments.length;n--;)e[n]=arguments[n];var r=e.pop(),i=t.apply(this,e);return a(i,r)};return(0,n.default)((function(e,n){var r;try{r=t.apply(this,e)}catch(i){return n(i)}if(r&&"function"==typeof r.then)return a(r,n);n(null,r)}))};var n=o(v5.exports),r=o(g5),i=d5;function o(t){return t&&t.__esModule?t:{default:t}}function a(t,e){return t.then((function(t){s(e,null,t)}),(function(t){s(e,t&&t.message?t:new Error(t))}))}function s(t,e,n){try{t(e,n)}catch(i){(0,r.default)((function(t){throw t}),i)}}t.exports=e.default}(m5,m5.exports),Object.defineProperty(d5,"__esModule",{value:!0}),d5.isAsyncIterable=d5.isAsyncGenerator=d5.isAsync=void 0;var M5,E5=(M5=m5.exports)&&M5.__esModule?M5:{default:M5};function A5(t){return"AsyncFunction"===t[Symbol.toStringTag]}d5.default=function(t){if("function"!=typeof t)throw new Error("expected a function");return A5(t)?(0,E5.default)(t):t},d5.isAsync=A5,d5.isAsyncGenerator=function(t){return"AsyncGenerator"===t[Symbol.toStringTag]},d5.isAsyncIterable=function(t){return"function"==typeof t[Symbol.asyncIterator]};var T5={exports:{}};!function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){void 0===e&&(e=t.length);if(!e)throw new Error("arity is undefined");return function(){for(var n=this,r=[],i=arguments.length;i--;)r[i]=arguments[i];return"function"==typeof r[e-1]?t.apply(this,r):new Promise((function(i,o){r[e-1]=function(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];if(t)return o(t);i(e.length>1?e:e[0])},t.apply(n,r)}))}},t.exports=e.default}(T5,T5.exports),function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=o(p5.exports),r=o(d5),i=o(T5.exports);function o(t){return t&&t.__esModule?t:{default:t}}e.default=(0,i.default)((function(t,e,i){var o=(0,n.default)(e)?[]:{};t(e,(function(t,e,n){(0,r.default)(t)((function(t){for(var r=[],i=arguments.length-1;i-- >0;)r[i]=arguments[i+1];r.length<2&&(r=r[0]),o[e]=r,n(t)}))}),(function(t){return i(t,o)}))}),3),t.exports=e.default}(f5,f5.exports);var C5={exports:{}},O5={exports:{}},k5={exports:{}},P5={exports:{}};!function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){function e(){for(var e=[],n=arguments.length;n--;)e[n]=arguments[n];if(null!==t){var r=t;t=null,r.apply(this,e)}}return Object.assign(e,t),e},t.exports=e.default}(P5,P5.exports);var L5={exports:{}},R5={exports:{}};!function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return t[Symbol.iterator]&&t[Symbol.iterator]()},t.exports=e.default}(R5,R5.exports),function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){if((0,n.default)(t))return function(t){var e=-1,n=t.length;return function(){return++e<n?{value:t[e],key:e}:null}}(t);var e=(0,r.default)(t);return e?function(t){var e=-1;return function(){var n=t.next();return n.done?null:(e++,{value:n.value,key:e})}}(e):function(t){var e=t?Object.keys(t):[],n=-1,r=e.length;return function i(){var o=e[++n];return"__proto__"===o?i():n<r?{value:t[o],key:o}:null}}(t)};var n=i(p5.exports),r=i(R5.exports);function i(t){return t&&t.__esModule?t:{default:t}}t.exports=e.default}(L5,L5.exports);var I5={exports:{}};!function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return function(){for(var e=[],n=arguments.length;n--;)e[n]=arguments[n];if(null===t)throw new Error("Callback was already called.");var r=t;t=null,r.apply(this,e)}},t.exports=e.default}(I5,I5.exports);var N5={exports:{}},D5={exports:{}};!function(t,e){Object.defineProperty(e,"__esModule",{value:!0});e.default={},t.exports=e.default}(D5,D5.exports),function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,r,i){var o=!1,a=!1,s=!1,u=0,c=0;function l(){u>=e||s||o||(s=!0,t.next().then((function(t){var e=t.value,n=t.done;if(!a&&!o){if(s=!1,n)return o=!0,void(u<=0&&i(null));u++,r(e,c,h),c++,l()}})).catch(f))}function h(t,e){if(u-=1,!a)return t?f(t):!1===t?(o=!0,void(a=!0)):e===n.default||o&&u<=0?(o=!0,i(null)):void l()}function f(t){a||(s=!1,o=!0,i(t))}l()};var n=function(t){return t&&t.__esModule?t:{default:t}}(D5.exports);t.exports=e.default}(N5,N5.exports),function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=u(P5.exports),r=u(L5.exports),i=u(I5.exports),o=d5,a=u(N5.exports),s=u(D5.exports);function u(t){return t&&t.__esModule?t:{default:t}}e.default=function(t){return function(e,u,c){if(c=(0,n.default)(c),t<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!e)return c(null);if((0,o.isAsyncGenerator)(e))return(0,a.default)(e,t,u,c);if((0,o.isAsyncIterable)(e))return(0,a.default)(e[Symbol.asyncIterator](),t,u,c);var l=(0,r.default)(e),h=!1,f=!1,p=0,d=!1;function m(t,e){if(!f)if(p-=1,t)h=!0,c(t);else if(!1===t)h=!0,f=!0;else{if(e===s.default||h&&p<=0)return h=!0,c(null);d||v()}}function v(){for(d=!0;p<t&&!h;){var e=l();if(null===e)return h=!0,void(p<=0&&c(null));p+=1,u(e.value,e.key,(0,i.default)(m))}d=!1}v()}},t.exports=e.default}(k5,k5.exports),function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=o(k5.exports),r=o(d5),i=o(T5.exports);function o(t){return t&&t.__esModule?t:{default:t}}e.default=(0,i.default)((function(t,e,i,o){return(0,n.default)(e)(t,(0,r.default)(i),o)}),4),t.exports=e.default}(O5,O5.exports),function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=i(O5.exports),r=i(T5.exports);function i(t){return t&&t.__esModule?t:{default:t}}e.default=(0,r.default)((function(t,e,r){return(0,n.default)(t,1,e,r)}),3),t.exports=e.default}(C5,C5.exports),function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){return(0,n.default)(r.default,t,e)};var n=i(f5.exports),r=i(C5.exports);function i(t){return t&&t.__esModule?t:{default:t}}t.exports=e.default}(h5,h5.exports);var F5=l5(h5.exports),j5=function(){function t(){this.args=[],this.tasks=[]}return t.prototype.call=function(){for(var t=arguments,e=[],n=0;n<arguments.length;n++)e[n]=t[n];return this.args=e,F5(this.tasks)},t.prototype.tap=function(t,e){var n=this;this.tasks.push((function(r){e.apply(void 0,c5([],u5(n.args),!1)),r(null,t)}))},t}(),B5={exports:{}},z5={exports:{}};!function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=c(p5.exports),r=c(D5.exports),i=c(O5.exports),o=c(P5.exports),a=c(I5.exports),s=c(d5),u=c(T5.exports);function c(t){return t&&t.__esModule?t:{default:t}}function l(t,e,n){n=(0,o.default)(n);var i=0,s=0,u=t.length,c=!1;function l(t,e){!1===t&&(c=!0),!0!==c&&(t?n(t):++s!==u&&e!==r.default||n(null))}for(0===u&&n(null);i<u;i++)e(t[i],i,(0,a.default)(l))}function h(t,e,n){return(0,i.default)(t,1/0,e,n)}e.default=(0,u.default)((function(t,e,r){return((0,n.default)(t)?l:h)(t,(0,s.default)(e),r)}),3),t.exports=e.default}(z5,z5.exports),function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){return(0,r.default)(n.default,t,e)};var n=i(z5.exports),r=i(f5.exports);function i(t){return t&&t.__esModule?t:{default:t}}t.exports=e.default}(B5,B5.exports);var U5={exports:{}};!function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=a(P5.exports),r=a(I5.exports),i=a(d5),o=a(T5.exports);function a(t){return t&&t.__esModule?t:{default:t}}e.default=(0,o.default)((function(t,e){if(e=(0,n.default)(e),!Array.isArray(t))return e(new Error("First argument to waterfall must be an array of functions"));if(!t.length)return e();var o=0;function a(e){(0,i.default)(t[o++]).apply(void 0,e.concat([(0,r.default)(s)]))}function s(n){for(var r=[],i=arguments.length-1;i-- >0;)r[i]=arguments[i+1];if(!1!==n)return n||o===t.length?e.apply(void 0,[n].concat(r)):void a(r)}a([])})),t.exports=e.default}(U5,U5.exports);var V5=l5(U5.exports),G5=function(){function t(){this.tasks=[]}return t.prototype.call=function(){return F5(this.tasks)},t.prototype.tap=function(t,e){this.tasks.push((function(n){n(e(),t)}))},t}(),W5=function(){function t(){this.args=[],this.tasks=[]}return t.prototype.promise=function(){for(var t=arguments,e=[],n=0;n<arguments.length;n++)e[n]=t[n];return this.args=e,F5(this.tasks)},t.prototype.tapPromise=function(t,e){var n=this;this.tasks.push((function(r){return a5(n,void 0,void 0,(function(){return s5(this,(function(n){switch(n.label){case 0:return[4,e.apply(void 0,c5([],u5(this.args),!1))];case 1:return n.sent(),r(null,t),[2]}}))}))}))},t}(),H5=function(){function t(){this.args=[],this.tasks=[]}return t.prototype.promise=function(){for(var t=arguments,e=[],n=0;n<arguments.length;n++)e[n]=t[n];return this.args=e,F5(this.tasks)},t.prototype.tapPromise=function(t,e){var n=this;this.tasks.push((function(r){return a5(n,void 0,void 0,(function(){var n;return s5(this,(function(i){switch(i.label){case 0:return[4,e.apply(void 0,c5([],u5(this.args),!1))];case 1:return n=i.sent(),r(n,t),[2]}}))}))}))},t}(),Y5=function(){function t(){this.tasks=[]}return t.prototype.promise=function(){return V5(this.tasks)},t.prototype.tapPromise=function(t,e){0===this.tasks.length?this.tasks.push((function(t){e().then((function(e){t(null,e)}))})):this.tasks.push((function(t,n){e(t).then((function(t){n(null,t)}))}))},t}(),X5={};function q5(t){var e=t.target||t.srcElement;e.__resizeRAF__&&cancelAnimationFrame(e.__resizeRAF__),e.__resizeRAF__=requestAnimationFrame((function(){var n=e.__resizeTrigger__,r=n&&n.__resizeListeners__;r&&r.forEach((function(e){e.call(n,t)}))}))}var Z5=function(t,e){var n,r=this.document,i=r.attachEvent;if("undefined"!=typeof navigator&&(n=navigator.userAgent.match(/Trident/)||navigator.userAgent.match(/Edge/)),!t.__resizeListeners__)if(t.__resizeListeners__=[],i)t.__resizeTrigger__=t,t.attachEvent("onresize",q5);else{"static"===getComputedStyle(t).position&&(t.style.position="relative");var o=t.__resizeTrigger__=r.createElement("object");o.setAttribute("style","position: absolute; top: 0; left: 0; height: 100%; width: 100%; pointer-events: none; z-index: -1; opacity: 0;"),o.setAttribute("class","resize-sensor"),o.setAttribute("tabindex","-1"),o.setAttribute("title",""),o.__resizeElement__=t,o.onload=function(){this.contentDocument.defaultView.__resizeTrigger__=this.__resizeElement__,this.contentDocument.defaultView.addEventListener("resize",q5)},o.type="text/html",n&&t.appendChild(o),o.data="about:blank",n||t.appendChild(o)}t.__resizeListeners__.push(e)};({get exports(){return X5},set exports(t){X5=t}}).exports="undefined"==typeof window?Z5:Z5.bind(window);var $5,K5,J5,Q5,t6,e6,n6,r6,i6,o6,a6,s6,u6,c6,l6,h6,f6,p6,d6,m6,v6,g6,y6,x6,b6,_6,w6,S6,M6,E6,A6,T6,C6,O6=X5.unbind=function(t,e){var n=document.attachEvent,r=t.__resizeListeners__||[];if(e){var i=r.indexOf(e);-1!==i&&r.splice(i,1)}else r=t.__resizeListeners__=[];if(!r.length){if(n)t.detachEvent("onresize",q5);else if(t.__resizeTrigger__){var o=t.__resizeTrigger__.contentDocument,a=o&&o.defaultView;a&&(a.removeEventListener("resize",q5),delete a.__resizeTrigger__),t.__resizeTrigger__=!t.removeChild(t.__resizeTrigger__)}delete t.__resizeListeners__}};function k6(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var P6=($5=Z2(),K5=d2(J2.SceneID),J5=d2(J2.IIconService),Q5=d2(J2.IFontService),t6=d2(J2.IControlService),e6=d2(J2.IGlobalConfigService),n6=d2(J2.IMapService),r6=d2(J2.ICoordinateSystemService),i6=d2(J2.IRendererService),o6=d2(J2.ILayerService),a6=d2(J2.ICameraService),s6=d2(J2.IInteractionService),u6=d2(J2.IPickingService),c6=d2(J2.IShaderModuleService),l6=d2(J2.IMarkerService),h6=d2(J2.IPopupService),$5((p6=function(t){wZ(i,hc.EventEmitter);var e,n,r=k6(i);function i(){var t;return mZ(this,i),$q(SZ(t=r.call(this)),"destroyed",!1),$q(SZ(t),"loaded",!1),F3(SZ(t),"id",d6,SZ(t)),F3(SZ(t),"iconService",m6,SZ(t)),F3(SZ(t),"fontService",v6,SZ(t)),F3(SZ(t),"controlService",g6,SZ(t)),F3(SZ(t),"configService",y6,SZ(t)),F3(SZ(t),"map",x6,SZ(t)),F3(SZ(t),"coordinateSystemService",b6,SZ(t)),F3(SZ(t),"rendererService",_6,SZ(t)),F3(SZ(t),"layerService",w6,SZ(t)),F3(SZ(t),"cameraService",S6,SZ(t)),F3(SZ(t),"interactionService",M6,SZ(t)),F3(SZ(t),"pickingService",E6,SZ(t)),F3(SZ(t),"shaderModuleService",A6,SZ(t)),F3(SZ(t),"markerService",T6,SZ(t)),F3(SZ(t),"popupService",C6,SZ(t)),$q(SZ(t),"inited",!1),$q(SZ(t),"initPromise",void 0),$q(SZ(t),"rendering",!1),$q(SZ(t),"$container",void 0),$q(SZ(t),"canvas",void 0),$q(SZ(t),"markerContainer",void 0),$q(SZ(t),"hooks",void 0),$q(SZ(t),"handleWindowResized",(function(){t.emit("resize"),t.$container&&(t.initContainer(),function(){if("function"==typeof Event)F$.dispatchEvent(new Event("resize"));else{var t=F$.document.createEvent("UIEvents");t.initUIEvent("resize",!0,!1,F$,0),F$.dispatchEvent(t)}}(),t.coordinateSystemService.needRefresh=!0,t.render())})),$q(SZ(t),"handleMapCameraChanged",(function(e){t.cameraService.update(e),t.render()})),t.hooks={init:new W5},t}return gZ(i,[{key:"init",value:function(t){var e=this;this.configService.setSceneConfig(this.id,t),this.shaderModuleService.registerBuiltinModules(),this.iconService.init(),this.iconService.on("imageUpdate",(function(){return e.render()})),this.fontService.init(),this.hooks.init.tapPromise("initMap",RK(jK.mark((function t(){return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,new Promise((function(t){e.map.onCameraChanged((function(n){e.cameraService.init(),e.cameraService.update(n),t()})),e.map.init()}));case 2:e.map.onCameraChanged(e.handleMapCameraChanged),e.map.addMarkerContainer(),e.markerService.addMarkers(),e.markerService.addMarkerLayers(),e.popupService.initPopup(),e.interactionService.init(),e.interactionService.on(s4.Drag,e.addSceneEvent.bind(e));case 9:case"end":return t.stop()}}),t)})))),this.hooks.init.tapPromise("initRenderer",RK(jK.mark((function n(){var r,i;return jK.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=e.map.getOverlayContainer(),e.$container=r||R4(e.configService.getSceneConfig(e.id).id||""),!e.$container){n.next=12;break}return e.canvas=z$("canvas","",e.$container),e.setCanvas(),n.next=7,e.rendererService.init(e.canvas,e.configService.getSceneConfig(e.id),t.gl);case 7:e.initContainer(),X5(e.$container,e.handleWindowResized),F$.matchMedia&&(null===(i=F$.matchMedia("screen and (-webkit-min-device-pixel-ratio: 1.5)"))||void 0===i||i.addListener(e.handleWindowResized)),n.next=13;break;case 12:case 13:e.pickingService.init(e.id);case 14:case"end":return n.stop()}}),n)})))),this.render()}},{key:"initMiniScene",value:function(t){var e=this;this.configService.setSceneConfig(this.id,t),this.shaderModuleService.registerBuiltinModules(),this.iconService.init(),this.iconService.on("imageUpdate",(function(){return e.render()})),this.fontService.init(),this.hooks.init.tapPromise("initMap",RK(jK.mark((function t(){return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,new Promise((function(t){e.map.onCameraChanged((function(n){e.cameraService.init(),e.cameraService.update(n),"GAODE2.x"!==e.map.version&&t()})),e.map.initMiniMap()}));case 2:e.map.onCameraChanged(e.handleMapCameraChanged),e.interactionService.init(),e.interactionService.on(s4.Drag,e.addSceneEvent.bind(e));case 5:case"end":return t.stop()}}),t)})))),this.hooks.init.tapPromise("initRenderer",RK(jK.mark((function n(){var r;return jK.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=t.canvas,e.$container=r||null,!e.$container){n.next=7;break}return n.next=5,e.rendererService.init(t.canvas,e.configService.getSceneConfig(e.id),void 0);case 5:n.next=8;break;case 7:case 8:e.pickingService.init(e.id);case 9:case"end":return n.stop()}}),n)})))),this.initPromise=this.hooks.init.promise(),this.render()}},{key:"addLayer",value:function(t){this.layerService.sceneService=this,this.layerService.add(t)}},{key:"addMask",value:function(t){this.layerService.sceneService=this,this.layerService.addMask(t)}},{key:"render",value:(n=RK(jK.mark((function t(){return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.rendering&&!this.destroyed){t.next=2;break}return t.abrupt("return");case 2:if(this.rendering=!0,this.inited){t.next=16;break}return t.next=6,this.hooks.init.promise();case 6:return this.destroyed&&this.destroy(),t.next=9,this.layerService.initLayers();case 9:this.layerService.renderLayers(),this.controlService.addControls(),this.loaded=!0,this.emit("loaded"),this.inited=!0,t.next=20;break;case 16:return t.next=18,this.layerService.initLayers();case 18:return t.next=20,this.layerService.renderLayers();case 20:this.rendering=!1;case 21:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"addFontFace",value:function(t,e){this.fontService.addFontFace(t,e)}},{key:"getSceneContainer",value:function(){return this.$container}},{key:"exportPng",value:(e=RK(jK.mark((function t(e){var n,r,i;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=null===(n=this.$container)||void 0===n?void 0:n.getElementsByTagName("canvas")[0],t.next=3,this.render();case 3:return i="jpg"===e?null==r?void 0:r.toDataURL("image/jpeg"):null==r?void 0:r.toDataURL("image/png"),t.abrupt("return",i);case 5:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})},{key:"getSceneConfig",value:function(){return this.configService.getSceneConfig(this.id)}},{key:"getPointSizeRange",value:function(){return this.rendererService.getPointSizeRange()}},{key:"addMarkerContainer",value:function(){var t=this.$container.parentElement;null!==t&&(this.markerContainer=z$("div","l7-marker-container",t))}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"destroy",value:function(){var t,e,n=this;if(this.inited){var r;if(O6(this.$container,this.handleWindowResized),F$.matchMedia)null===(r=F$.matchMedia("screen and (min-resolution: 2dppx)"))||void 0===r||r.removeListener(this.handleWindowResized);this.pickingService.destroy(),this.layerService.destroy(),this.interactionService.destroy(),this.controlService.destroy(),this.markerService.destroy(),this.fontService.destroy(),this.iconService.destroy(),this.removeAllListeners(),this.inited=!1,this.map.destroy(),setTimeout((function(){var t;null===(t=n.$container)||void 0===t||t.removeChild(n.canvas),n.canvas=null,n.rendererService.destroy()})),null===(t=this.$container)||void 0===t||null===(e=t.parentNode)||void 0===e||e.removeChild(this.$container),this.emit("destroy")}else this.destroyed=!0}},{key:"initContainer",value:function(){var t,e,n=Y$,r=(null===(t=this.$container)||void 0===t?void 0:t.clientWidth)||400,i=(null===(e=this.$container)||void 0===e?void 0:e.clientHeight)||300,o=this.canvas;o&&(o.width=r*n,o.height=i*n),this.rendererService.viewport({x:0,y:0,width:n*r,height:n*i})}},{key:"setCanvas",value:function(){var t,e,n=Y$,r=(null===(t=this.$container)||void 0===t?void 0:t.clientWidth)||400,i=(null===(e=this.$container)||void 0===e?void 0:e.clientHeight)||300,o=this.canvas;o.width=r*n,o.height=i*n,o.style.width="100%",o.style.height="100%"}},{key:"addSceneEvent",value:function(t){this.emit(t.type,t)}}]),i}(),d6=j3(p6.prototype,"id",[K5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m6=j3(p6.prototype,"iconService",[J5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v6=j3(p6.prototype,"fontService",[Q5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g6=j3(p6.prototype,"controlService",[t6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y6=j3(p6.prototype,"configService",[e6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x6=j3(p6.prototype,"map",[n6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b6=j3(p6.prototype,"coordinateSystemService",[r6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_6=j3(p6.prototype,"rendererService",[i6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w6=j3(p6.prototype,"layerService",[o6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S6=j3(p6.prototype,"cameraService",[a6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M6=j3(p6.prototype,"interactionService",[s6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E6=j3(p6.prototype,"pickingService",[u6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A6=j3(p6.prototype,"shaderModuleService",[c6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T6=j3(p6.prototype,"markerService",[l6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C6=j3(p6.prototype,"popupService",[h6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f6=p6))||f6);var L6,R6=/uniform\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\s+([\s\S]*?);/g;function I6(t){var e={};return{content:t=t.replace(R6,(function(t,n,r){var i=r.split(":"),o=i[0].trim(),a="";switch(i.length>1&&(a=i[1].trim()),n){case"bool":a="true"===a;break;case"float":case"int":a=Number(a);break;case"vec2":case"vec3":case"vec4":case"ivec2":case"ivec3":case"ivec4":case"mat2":case"mat3":case"mat4":a=a?a.replace("[","").replace("]","").split(",").reduce((function(t,e){return t.push(Number(e.trim())),t}),[]):new Array(function(t){var e=0;switch(t){case"vec2":case"ivec2":e=2;break;case"vec3":case"ivec3":e=3;break;case"vec4":case"ivec4":case"mat2":e=4;break;case"mat3":e=9;break;case"mat4":e=16}return e}(n)).fill(0)}return e[o]=a,"uniform ".concat(n," ").concat(o,";\n")})),uniforms:e}}var N6,D6,F6,j6="#define PI 3.14159265359",B6=/precision\s+(high|low|medium)p\s+float/,z6=/#pragma include (["^+"]?["[a-zA-Z_0-9](.*)"]*?)/g,U6=Z2()(L6=function(){function t(){mZ(this,t),$q(this,"moduleCache",{}),$q(this,"rawContentCache",{})}return gZ(t,[{key:"registerBuiltinModules",value:function(){this.destroy(),this.registerModule("common",{vs:j6,fs:j6}),this.registerModule("decode",{vs:"#define SHIFT_RIGHT17 1.0 / 131072.0\n#define SHIFT_RIGHT18 1.0 / 262144.0\n#define SHIFT_RIGHT19 1.0 / 524288.0\n#define SHIFT_RIGHT20 1.0 / 1048576.0\n#define SHIFT_RIGHT21 1.0 / 2097152.0\n#define SHIFT_RIGHT22 1.0 / 4194304.0\n#define SHIFT_RIGHT23 1.0 / 8388608.0\n#define SHIFT_RIGHT24 1.0 / 16777216.0\n\n#define SHIFT_LEFT17 131072.0\n#define SHIFT_LEFT18 262144.0\n#define SHIFT_LEFT19 524288.0\n#define SHIFT_LEFT20 1048576.0\n#define SHIFT_LEFT21 2097152.0\n#define SHIFT_LEFT22 4194304.0\n#define SHIFT_LEFT23 8388608.0\n#define SHIFT_LEFT24 16777216.0\n\nvec2 unpack_float(float packedValue) {\n  int packedIntValue = int(packedValue);\n  int v0 = packedIntValue / 256;\n  return vec2(v0, packedIntValue - v0 * 256);\n}\n\nvec4 decode_color(vec2 encodedColor) {\n  return vec4(\n    unpack_float(encodedColor[0]) / 255.0,\n    unpack_float(encodedColor[1]) / 255.0\n  );\n}\n",fs:""}),this.registerModule("projection",{vs:"#define TILE_SIZE 512.0\n#define PI 3.1415926536\n#define WORLD_SCALE TILE_SIZE / (PI * 2.0)\n\n#define COORDINATE_SYSTEM_LNGLAT 1.0        // mapbox\n#define COORDINATE_SYSTEM_LNGLAT_OFFSET 2.0 // mapbox offset\n#define COORDINATE_SYSTEM_VECTOR_TILE 3.0\n#define COORDINATE_SYSTEM_IDENTITY 4.0\n#define COORDINATE_SYSTEM_P20 5.0           // amap\n#define COORDINATE_SYSTEM_P20_OFFSET 6.0    // amap offset\n#define COORDINATE_SYSTEM_METER_OFFSET 7.0\n\n#define COORDINATE_SYSTEM_P20_2 8.0         // amap2.0\n\nuniform mat4 u_ViewMatrix;\nuniform mat4 u_ProjectionMatrix;\nuniform mat4 u_ViewProjectionMatrix;\nuniform float u_Zoom : 1;\nuniform float u_ZoomScale : 1;\n\nuniform float u_CoordinateSystem;\nuniform vec2 u_ViewportCenter;\nuniform vec4 u_ViewportCenterProjection;\nuniform vec3 u_PixelsPerDegree;\nuniform vec3 u_PixelsPerDegree2;\nuniform vec3 u_PixelsPerMeter;\n\nuniform vec2 u_ViewportSize;\nuniform float u_DevicePixelRatio;\nuniform float u_FocalDistance;\nuniform vec3 u_CameraPosition;\n\n// uniform mat4 u_Mvp;\n\n// web mercator coords -> world coords\nvec2 project_mercator(vec2 lnglat) {\n  float x = lnglat.x;\n  return vec2(\n    radians(x) + PI,\n    PI - log(tan(PI * 0.25 + radians(lnglat.y) * 0.5))\n  );\n}\n\nfloat project_scale(float meters) {\n  return meters * u_PixelsPerMeter.z;\n}\n\n\n// offset coords -> world coords\nvec4 project_offset(vec4 offset) {\n  float dy = offset.y;\n  dy = clamp(dy, -1., 1.);\n  vec3 pixels_per_unit = u_PixelsPerDegree + u_PixelsPerDegree2 * dy;\n  return vec4(offset.xyz * pixels_per_unit, offset.w);\n}\n\nvec3 project_normal(vec3 normal) {\n  vec4 normal_modelspace = u_ModelMatrix * vec4(normal, 0.0);\n  return normalize(normal_modelspace.xyz * u_PixelsPerMeter);\n}\n\nvec3 project_offset_normal(vec3 vector) {\n  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01\n    || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {\n    // normals generated by the polygon tesselator are in lnglat offsets instead of meters\n    return normalize(vector * u_PixelsPerDegree);\n  }\n  return project_normal(vector);\n}\n// || u_CoordinateSystem < COORDINATE_SYSTEM_P20_OFFSET + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_P20_OFFSET - 0.01\n// reverse Y\nvec3 reverse_offset_normal(vec3 vector) {\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 ||u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET ) {\n    return vector * vec3(1.0, -1.0, 1.0);\n  }\n\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.0\n    return vector;\n  }\n  return vector;\n}\n\nvec4 project_mvt_offset_position(vec4 position) {\n  float a = COORDINATE_SYSTEM_LNGLAT_OFFSET;\n  float b = COORDINATE_SYSTEM_P20_OFFSET;\n  float c = COORDINATE_SYSTEM_LNGLAT;\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {\n    return project_offset(vec4(0.0, 0.0, position.z, position.w));\n  }\n  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01) {\n    return vec4(\n      project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale,\n      project_scale(position.z),\n      position.w\n    );\n  }\n  return position;\n}\n\nvec4 project_position(vec4 position) {\n  float a = COORDINATE_SYSTEM_LNGLAT_OFFSET;\n  float b = COORDINATE_SYSTEM_P20_OFFSET;\n  float c = COORDINATE_SYSTEM_LNGLAT;\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET\n    || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {\n    float X = position.x - u_ViewportCenter.x;\n    float Y = position.y - u_ViewportCenter.y;\n    return project_offset(vec4(X, Y, position.z, position.w));\n  }\n  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01) {\n    return vec4(\n      project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale,\n      project_scale(position.z),\n      position.w\n    );\n  }\n\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20) {\n    return vec4(\n      (project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale - vec2(215440491., 106744817.)) * vec2(1., -1.),\n      project_scale(position.z),\n      position.w\n    );\n  }\n\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {\n    // return vec4(\n    //   (position.xy * WORLD_SCALE * u_ZoomScale) * vec2(1., -1.), \n    //   project_scale(position.z), \n    //   position.w);\n\n     return vec4(\n      position.xy, \n      project_scale(position.z), \n      position.w);\n  }\n  return position;\n\n  // TODO: 瓦片坐标系 & 常规世界坐标系\n}\nvec2 project_pixel_size_to_clipspace(vec2 pixels) {\n  vec2 offset = pixels / u_ViewportSize * u_DevicePixelRatio * 2.0;\n  return offset * u_FocalDistance;\n}\n\nfloat project_pixel_allmap(float pixel) {\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n    return pixel * pow(2.0, u_Zoom);\n  }\n  return pixel * u_FocalDistance ;\n}\n\n// 适配纹理贴图的等像素大小\nfloat project_pixel_texture(float pixel) {\n  // mapbox zoom > 12\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {\n    return pixel * pow(0.5, u_Zoom) * u_FocalDistance ;\n  }\n\n  // amap2 zoom > 12\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {\n    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom))* u_FocalDistance ;\n  }\n\n  // amap zoom > 12\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {\n    return pixel * pow(0.5, u_Zoom)* u_FocalDistance ;\n  }\n  \n  // amap zoom < 12\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20) {\n    return pixel * pow(2.0, (20.0 - u_Zoom))* u_FocalDistance ;\n  }\n  return pixel * 2.0 *  u_FocalDistance;;\n}\n\n// 在不论什么底图下需要统一处理的时候使用\nfloat project_float_pixel(float pixel) {\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {\n    // mapbox P20 坐标系下，为了和 Web 墨卡托坐标系统一，zoom 默认减1\n    return pixel * pow(2.0, (19.0 - u_Zoom))  * u_FocalDistance ;\n  }\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {\n    // amap P20 坐标系下，为了和 Web 墨卡托坐标系统一，zoom 默认减1\n    return pixel * pow(2.0, (19.0 - u_Zoom));\n  }\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {\n    // amap2 P20_2 坐标系下，为了和 Web 墨卡托坐标系统一，zoom 默认减3\n    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom))* u_FocalDistance ;\n  }\n  return pixel * u_FocalDistance;\n}\n\nfloat project_pixel(float pixel) {\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {\n    // amap P20 坐标系下，为了和 Web 墨卡托坐标系统一，zoom 默认减1\n    return pixel * pow(2.0, (19.0 - u_Zoom)) * u_FocalDistance ;\n  }\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {\n    // amap2 P20_2 坐标系下，为了和 Web 墨卡托坐标系统一，zoom 默认减3\n    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom)) * u_FocalDistance ;\n  }\n  return pixel * u_FocalDistance;\n}\nvec2 project_pixel(vec2 pixel) {\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {\n    // P20 坐标系下，为了和 Web 墨卡托坐标系统一，zoom 默认减1\n    return pixel * pow(2.0, (19.0 - u_Zoom)) * u_FocalDistance ;\n  }\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {\n    // P20_2 坐标系下，为了和 Web 墨卡托坐标系统一，zoom 默认减3\n    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom)) * u_FocalDistance ;\n  }\n  return pixel * -1. * u_FocalDistance;\n}\nvec3 project_pixel(vec3 pixel) {\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {\n    // P20 坐标系下，为了和 Web 墨卡托坐标系统一，zoom 默认减1\n    return pixel * pow(2.0, (19.0 - u_Zoom)) *  u_FocalDistance ;\n  }\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {\n    // P20_2 坐标系下，为了和 Web 墨卡托坐标系统一，zoom 默认减3\n    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom))  * u_FocalDistance ;\n  }\n  return pixel * -1. * u_FocalDistance;\n}\n\nvec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||\n    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {\n    // Needs to be divided with project_uCommonUnitsPerMeter\n    position.w *= u_PixelsPerMeter.z;\n  }\n\n  return viewProjectionMatrix * position + center;\n}\n\n// Projects from common space coordinates to clip space\nvec4 project_common_position_to_clipspace(vec4 position) {\n  return project_common_position_to_clipspace(\n    position,\n    u_ViewProjectionMatrix,\n    u_ViewportCenterProjection\n  );\n}\n\nvec4 unproject_clipspace_to_position(vec4 clipspacePos, mat4 u_InverseViewProjectionMatrix) {\n  vec4 pos = u_InverseViewProjectionMatrix * (clipspacePos - u_ViewportCenterProjection);\n\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||\n    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {\n    // Needs to be divided with project_uCommonUnitsPerMeter\n     pos.w = pos.w / u_PixelsPerMeter.z;\n  }\n  return pos;\n}\n\n\nbool isEqual( float a,  float b) {\n    return  a< b + 0.001 && a > b - 0.001;\n}",fs:""}),this.registerModule("project",{vs:"\n#define E 2.718281828459045\nvec2 ProjectFlat(vec2 lnglat){\n  float maxs=85.0511287798;\n  float lat=max(min(maxs,lnglat.y),-maxs);\n  float scale= 268435456.;\n  float d=PI/180.;\n  float x=lnglat.x*d;\n  float y=lat*d;\n  y=log(tan((PI/4.)+(y/2.)));\n\n  float a=.5/PI,\n  b=.5,\n  c=-.5/PI;\n  d=.5;\n  x=scale*(a*x+b);\n  y=scale*(c*y+d);\n  return vec2(x,y);\n}\n\nvec2 unProjectFlat(vec2 px){\n  float a=.5/PI;\n  float b=.5;\n  float c=-.5/PI;\n  float d=.5;\n  float scale = 268435456.;\n  float x=(px.x/scale-b)/a;\n  float y=(px.y/scale-d)/c;\n  y=(atan(pow(E,y))-(PI/4.))*2.;\n  d=PI/180.;\n  float lat=y/d;\n  float lng=x/d;\n  return vec2(lng,lat);\n}\n\nfloat pixelDistance(vec2 from, vec2 to) {\n vec2 a1 = ProjectFlat(from);\n vec2 b1 = ProjectFlat(to);\n return distance(a1, b1);\n}\n\n// gaode2.0\nvec2 customProject(vec2 lnglat) { // 经纬度 => 平面坐标\n  float t = lnglat.x;\n  float e = lnglat.y;\n  float Sm = 180.0 / PI;\n  float Tm = 6378137.0;\n  float Rm = PI / 180.0;\n  float r = 85.0511287798;\n  e = max(min(r, e), -r);\n  t *= Rm;\n  e *= Rm;\n  e = log(tan(PI / 4.0 + e / 2.0));\n  return vec2(t * Tm, e * Tm);\n}\n\nvec2 unProjCustomCoord(vec2 point) { // 平面坐标 => 经纬度\n  float Sm = 57.29577951308232; //180 / Math.PI\n  float Tm = 6378137.0;\n  float t = point.x;\n  float e = point.y;\n  return vec2(t / Tm * Sm, (2.0 * atan(exp(e / Tm)) - PI / 2.0) * Sm);\n}\n\n\nfloat customPixelDistance(vec2 from, vec2 to) {\n vec2 a1 = ProjectFlat(from);\n vec2 b1 = ProjectFlat(to);\n return distance(a1, b1);\n}",fs:""}),this.registerModule("sdf_2d",{vs:"",fs:"/**\n * 2D signed distance field functions\n * @see http://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm\n */\n\nfloat ndot(vec2 a, vec2 b ) { return a.x*b.x - a.y*b.y; }\n\nfloat sdCircle(vec2 p, float r) {\n  return length(p) - r;\n}\n\nfloat sdEquilateralTriangle(vec2 p) {\n  float k = sqrt(3.0);\n  p.x = abs(p.x) - 1.0;\n  p.y = p.y + 1.0/k;\n  if( p.x + k*p.y > 0.0 ) p = vec2(p.x-k*p.y,-k*p.x-p.y)/2.0;\n  p.x -= clamp( p.x, -2.0, 0.0 );\n  return -length(p)*sign(p.y);\n}\n\nfloat sdBox(vec2 p, vec2 b) {\n  vec2 d = abs(p)-b;\n  return length(max(d,vec2(0))) + min(max(d.x,d.y),0.0);\n}\n\nfloat sdPentagon(vec2 p, float r) {\n  vec3 k = vec3(0.809016994,0.587785252,0.726542528);\n  p.x = abs(p.x);\n  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);\n  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);\n  p -= vec2(clamp(p.x,-r*k.z,r*k.z),r);\n  return length(p)*sign(p.y);\n}\n\nfloat sdHexagon(vec2 p, float r) {\n  vec3 k = vec3(-0.866025404,0.5,0.577350269);\n  p = abs(p);\n  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;\n  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);\n  return length(p)*sign(p.y);\n}\n\nfloat sdOctogon(vec2 p, float r) {\n  vec3 k = vec3(-0.9238795325, 0.3826834323, 0.4142135623 );\n  p = abs(p);\n  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);\n  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);\n  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);\n  return length(p)*sign(p.y);\n}\n\nfloat sdHexagram(vec2 p, float r) {\n  vec4 k=vec4(-0.5,0.8660254038,0.5773502692,1.7320508076);\n  p = abs(p);\n  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;\n  p -= 2.0*min(dot(k.yx,p),0.0)*k.yx;\n  p -= vec2(clamp(p.x,r*k.z,r*k.w),r);\n  return length(p)*sign(p.y);\n}\n\nfloat sdRhombus(vec2 p, vec2 b) {\n  vec2 q = abs(p);\n  float h = clamp((-2.0*ndot(q,b)+ndot(b,b))/dot(b,b),-1.0,1.0);\n  float d = length( q - 0.5*b*vec2(1.0-h,1.0+h) );\n  return d * sign( q.x*b.y + q.y*b.x - b.x*b.y );\n}\n\nfloat sdVesica(vec2 p, float r, float d) {\n  p = abs(p);\n  float b = sqrt(r*r-d*d); // can delay this sqrt\n  return ((p.y-b)*d>p.x*b)\n          ? length(p-vec2(0.0,b))\n          : length(p-vec2(-d,0.0))-r;\n}\n"}),this.registerModule("lighting",{vs:"// Blinn-Phong model\n// apply lighting in vertex shader instead of fragment shader\n// @see https://learnopengl.com/Advanced-Lighting/Advanced-Lighting\nuniform float u_Ambient : 1.0;\nuniform float u_Diffuse : 1.0;\nuniform float u_Specular : 1.0;\nuniform int u_NumOfDirectionalLights : 1;\nuniform int u_NumOfSpotLights : 0;\n\n#define SHININESS 32.0\n#define MAX_NUM_OF_DIRECTIONAL_LIGHTS 3\n#define MAX_NUM_OF_SPOT_LIGHTS 3\n\nstruct DirectionalLight {\n  vec3 direction;\n  vec3 ambient;\n  vec3 diffuse;\n  vec3 specular;\n};\n\nstruct SpotLight {\n  vec3 position;\n  vec3 direction;\n  vec3 ambient;\n  vec3 diffuse;\n  vec3 specular;\n  float constant;\n  float linear;\n  float quadratic;\n  float angle;\n  float blur;\n  float exponent;\n};\n\nuniform DirectionalLight u_DirectionalLights[MAX_NUM_OF_DIRECTIONAL_LIGHTS];\nuniform SpotLight u_SpotLights[MAX_NUM_OF_SPOT_LIGHTS];\n\nvec3 calc_directional_light(DirectionalLight light, vec3 normal, vec3 viewDir) {\n  vec3 lightDir = normalize(light.direction);\n  // diffuse shading\n  float diff = max(dot(normal, lightDir), 0.0);\n  // Blinn-Phong specular shading\n  vec3 halfwayDir = normalize(lightDir + viewDir);\n  float spec = pow(max(dot(normal, halfwayDir), 0.0), SHININESS);\n\n  vec3 ambient = light.ambient * u_Ambient;\n  vec3 diffuse = light.diffuse * diff * u_Diffuse;\n  vec3 specular = light.specular * spec * u_Specular;\n\n  return ambient + diffuse + specular;\n}\n\n// vec3 calc_spot_light(SpotLight light, vec3 normal, vec3 fragPos, vec3 viewDir) {\n//   vec3 lightDir = normalize(light.position - fragPos);\n//   // diffuse shading\n//   float diff = max(dot(normal, lightDir), 0.0);\n//   // specular shading\n//   vec3 reflectDir = reflect(-lightDir, normal);\n//   float spec = pow(max(dot(viewDir, reflectDir), 0.0), SHININESS);\n//   // attenuation\n//   float distance = length(light.position - fragPos);\n//   float attenuation = 1.0 / (light.constant + light.linear * distance +\n//           light.quadratic * (distance * distance));\n\n//   vec3 ambient = light.ambient * u_Ambient;\n//   vec3 diffuse = light.diffuse * diff * u_Diffuse;\n//   vec3 specular = light.specular * spec * u_Specular;\n\n//   float spotEffect = dot(normalize(light.direction), -lightDir);\n//   float spotCosCutoff = cos(light.angle / 180.0 * PI);\n//   float spotCosOuterCutoff = cos((light.angle + light.blur) / 180.0 * PI);\n//   float spotCosInnerCutoff = cos((light.angle - light.blur) / 180.0 * PI);\n//   if (spotEffect > spotCosCutoff) {\n//     spotEffect = pow(smoothstep(spotCosOuterCutoff, spotCosInnerCutoff, spotEffect), light.exponent);\n//   } else {\n//     spotEffect = 0.0;\n//   }\n\n//   return ambient + attenuation * (spotEffect * diffuse + specular);\n// }\n\nvec3 calc_lighting(vec3 position, vec3 normal, vec3 viewDir) {\n  vec3 weight = vec3(0.0);\n  for (int i = 0; i < MAX_NUM_OF_DIRECTIONAL_LIGHTS; i++) {\n    if (i >= u_NumOfDirectionalLights) {\n      break;\n    }\n    weight += calc_directional_light(u_DirectionalLights[i], normal, viewDir);\n  }\n  // for (int i = 0; i < MAX_NUM_OF_SPOT_LIGHTS; i++) {\n  //   if (i >= u_NumOfSpotLights) {\n  //     break;\n  //   }\n  //   weight += calc_spot_light(u_SpotLights[i], normal, position, viewDir);\n  // }\n  return weight;\n}\n",fs:""}),this.registerModule("light",{vs:"#define ambientRatio 0.5\n#define diffuseRatio 0.3\n#define specularRatio 0.2\n\n\nfloat calc_lighting(vec4 pos) {\n\n    vec3 worldPos = vec3(pos * u_ModelMatrix);\n\n    vec3 worldNormal = a_Normal;\n      // //cal light weight\n    vec3 viewDir = normalize(u_CameraPosition - worldPos);\n\n    vec3 lightDir = normalize(vec3(1, -10.5, 12));\n\n    vec3 halfDir = normalize(viewDir+lightDir);\n      // //lambert\n    float lambert = dot(worldNormal, lightDir);\n        //specular\n    float specular = pow(max(0.0, dot(worldNormal, halfDir)), 32.0);\n        //sum to light weight\n    float lightWeight = ambientRatio + diffuseRatio * lambert + specularRatio * specular;\n\n    return lightWeight;\n}\n",fs:""}),this.registerModule("picking",{vs:"attribute vec3 a_PickingColor;\nvarying vec4 v_PickingResult;\n\nuniform vec3 u_PickingColor : [0, 0, 0];\nuniform vec3 u_CurrentSelectedId : [0, 0, 0];\nuniform vec4 u_HighlightColor : [0, 0, 0, 0];\nuniform vec4 u_SelectColor : [0, 0, 0, 0];\nuniform float u_PickingStage : 0.0;\nuniform float u_PickingThreshold : 1.0;\nuniform float u_PickingBuffer: 0.0;\nuniform float u_shaderPick;\nuniform float u_EnableSelect: 0.0;\n\n#define PICKING_NONE 0.0\n#define PICKING_ENCODE 1.0\n#define PICKING_HIGHLIGHT 2.0\n#define COLOR_SCALE 1. / 255.\n\n#define NORMAL 0.0\n#define HIGHLIGHT 1.0\n#define SELECT 2.0\n\nbool isVertexPicked(vec3 vertexColor) {\n  return\n    abs(vertexColor.r - u_PickingColor.r) < u_PickingThreshold &&\n    abs(vertexColor.g - u_PickingColor.g) < u_PickingThreshold &&\n    abs(vertexColor.b - u_PickingColor.b) < u_PickingThreshold;\n}\n\n// 判断当前点是否已经被 select 选中\nbool isVertexSelected(vec3 vertexColor) {\n  return\n    abs(vertexColor.r - u_CurrentSelectedId.r) < u_PickingThreshold &&\n    abs(vertexColor.g - u_CurrentSelectedId.g) < u_PickingThreshold &&\n    abs(vertexColor.b - u_CurrentSelectedId.b) < u_PickingThreshold;\n}\n\nvoid setPickingColor(vec3 pickingColor) {\n  if(u_shaderPick < 0.5) {\n    return;\n  }\n  // compares only in highlight stage\n\n  v_PickingResult.a = float((u_PickingStage == PICKING_HIGHLIGHT) && isVertexPicked(pickingColor));\n\n  // if (u_EnableSelect == 1.0 && u_PickingStage == PICKING_HIGHLIGHT && isVertexSelected(pickingColor)) {\n  //   // 选中态\n  //   v_PickingResult.a = SELECT;\n  // } else if (u_PickingStage == PICKING_HIGHLIGHT && isVertexPicked(pickingColor)) {\n  //   // 高亮态\n  //   v_PickingResult.a = HIGHLIGHT;\n  // } else {\n  //   v_PickingResult.a = NORMAL;\n  // }\n\n  // Stores the picking color so that the fragment shader can render it during picking\n  v_PickingResult.rgb = pickingColor * COLOR_SCALE;\n}\n\nfloat setPickingSize(float x) {\n   return u_PickingStage == PICKING_ENCODE ? x + u_PickingBuffer : x;\n}\n\nfloat setPickingOrder(float z) {\n   bool selected = bool(v_PickingResult.a);\n   return selected ? z + 1. : 0.;\n}\n",fs:"varying vec4 v_PickingResult;\nuniform vec4 u_HighlightColor : [0, 0, 0, 0];\nuniform vec4 u_SelectColor : [0, 0, 0, 0];\nuniform float u_PickingStage : 0.0;\nuniform float u_shaderPick;\n\nuniform float u_activeMix: 0;\n\n#define PICKING_NONE 0.0\n#define PICKING_ENCODE 1.0\n#define PICKING_HIGHLIGHT 2.0\n#define COLOR_SCALE 1. / 255.\n\n#define HIGHLIGHT 1.0\n#define SELECT 2.0\n\n/*\n * Returns highlight color if this item is selected.\n */\nvec4 filterHighlightColor(vec4 color, float weight) {\n  // float selected = v_PickingResult.a;\n  bool selected = bool(v_PickingResult.a);\n\n  // if (selected == SELECT) {\n  if (selected) {\n  //   // 点击选中状态\n  //   vec4 selectColor = u_SelectColor * COLOR_SCALE;\n  //   return selectColor;\n  // } else if (selected == HIGHLIGHT) {\n  //   // hover 高亮状态\n    vec4 highLightColor = u_HighlightColor * COLOR_SCALE;\n\n    float highLightAlpha = highLightColor.a;\n    float highLightRatio = highLightAlpha / (highLightAlpha + color.a * (1.0 - highLightAlpha));\n\n    vec3 resultRGB = mix(color.rgb, highLightColor.rgb, highLightRatio);\n    return vec4(mix(resultRGB * weight, color.rgb, u_activeMix), color.a);\n  } else {\n    return color;\n  }\n}\n\n/*\n * Returns picking color if picking enabled else unmodified argument.\n */\nvec4 filterPickingColor(vec4 color) {\n  vec3 pickingColor = v_PickingResult.rgb;\n  if (u_PickingStage == PICKING_ENCODE && length(pickingColor) < 0.001) {\n    discard;\n  }\n  return u_PickingStage == PICKING_ENCODE ? vec4(pickingColor, step(0.001,color.a)): color;\n}\n\n/*\n * Returns picking color if picking is enabled if not\n * highlight color if this item is selected, otherwise unmodified argument.\n */\nvec4 filterColor(vec4 color) {\n  // 过滤多余的 shader 计算\n  // return color;\n  if(u_shaderPick < 0.5) {\n    return color; // 暂时去除 直接取消计算在选中时拖拽地图会有问题\n  } else {\n    return filterPickingColor(filterHighlightColor(color, 1.0));\n  }\n  \n}\n\nvec4 filterColorAlpha(vec4 color, float alpha) {\n  // 过滤多余的 shader 计算\n  // return color;\n  if(u_shaderPick < 0.5) {\n    return color; // 暂时去除 直接取消计算在选中时拖拽地图会有问题\n  } else {\n    return filterPickingColor(filterHighlightColor(color, alpha));\n  }\n}\n\n"}),this.registerModule("styleMapping",{vs:"attribute float a_vertexId;\n\nuniform mat4 u_cellTypeLayout;      // 描述数据纹理 cell 结构的矩阵\nuniform sampler2D u_dataTexture;    // 数据纹理\n\nbool hasOpacity() { // 判断 cell 中是否存在 opacity 的数据\n  return u_cellTypeLayout[1][0] > 0.0 && u_cellTypeLayout[3][3] > 0.0;\n}\n\nbool hasStrokeOpacity() { // 判断 cell 中是否存在 strokeOpacity 的数据\n  return u_cellTypeLayout[1][1] > 0.0 && u_cellTypeLayout[3][3] > 0.0;\n}\n\nbool hasStrokeWidth() { // 判断 cell 中是否存在 strokeWidth 的数据\n  return u_cellTypeLayout[1][2] > 0.0 && u_cellTypeLayout[3][3] > 0.0;\n}\n\nbool hasStroke() { // 判断 cell 中是否存在 stroke 的数据\n  return u_cellTypeLayout[1][3] > 0.0 && u_cellTypeLayout[3][3] > 0.0;\n}\n\nbool hasOffsets() { // 判断 cell 中是否存在 offsets 的数据\n  return u_cellTypeLayout[2][0] > 0.0 && u_cellTypeLayout[3][3] > 0.0;\n}\n\nbool hasThetaOffset() { // 判断 cell 中是否存在 thetaOffset 的数据\n  return u_cellTypeLayout[2][1] > 0.0 && u_cellTypeLayout[3][3] > 0.0;\n}\n\n// 根据坐标位置先是计算 uv ，然后根据 uv 从数据纹理中取值\nfloat pos2value(vec2 pos, float columnWidth, float rowHeight) {\n  float u = (pos.r - 1.0) * columnWidth + columnWidth/2.0;\n  float v = 1.0 - ((pos.g - 1.0) * rowHeight + rowHeight/2.0);\n  return texture2D(u_dataTexture, vec2(u, v)).r;\n}\n\n/*\n  currentRow 当前行\n  currentColumn 当前列\n  columnCount 有多少列\n  nextStep 需要计算当前 cell 后的第几个 cell （当前 cell 则 nextStep = 0）\n*/\nvec2 nextPos(float currentRow, float currentColumn, float columnCount, float nextStep) {\n  float nextColumn = currentColumn;\n  float nextRow = currentRow;\n  if(currentColumn + nextStep <= columnCount){\n    nextColumn = currentColumn + nextStep;\n  } else {\n    nextColumn = mod(currentColumn + nextStep, columnCount); // 不会出现跨两行\n    nextRow = currentRow + 1.0;\n  }\n  return vec2(nextColumn, nextRow);\n}\n\n// 计算当前单个 cell 的大小\nfloat calCellCount() { \n  //   u_cellTypeLayout\n  //   cal_height, WIDTH, 0.0, 0.0, // rowCount columnCount - 几行几列\n  //   1.0, 1.0, 1.0, 0.0, // opacity strokeOpacity strokeWidth stroke - 1.0 表示有数据映射、0.0 表示没有\n  //   1.0, 1.0, 0.0, 0.0, // offsets thetaOffset\n  //   0.0, 0.0, 0.0, 0.0\n  \n  return  u_cellTypeLayout[1][0] +        // opacity\n          u_cellTypeLayout[1][1] +        // strokeOpacity\n          u_cellTypeLayout[1][2] +        // strokeWidth\n          u_cellTypeLayout[1][3] * 4.0 +  // stroke\n          u_cellTypeLayout[2][0] * 2.0 +  // offsets\n          u_cellTypeLayout[2][1];         // thetaOffset\n}",fs:""}),this.registerModule("styleMappingCalThetaOffset",{vs:"\n// 计算 thetaOffset 和标示在 cell 中取值位置的偏移量 textureOffset\nvec2 calThetaOffsetAndOffset(float cellCurrentRow, float cellCurrentColumn, float columnCount, float textureOffset, float columnWidth, float rowHeight) {\n  if(!hasThetaOffset()) { // 数据纹理中不存在 thetaOffset 的时候取默认值（用户在 style 中传入的是常量）\n    return vec2(u_thetaOffset, textureOffset);\n  } else {\n    vec2 valuePos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    float textureThetaOffset = pos2value(valuePos, columnWidth, rowHeight);\n    return vec2(textureThetaOffset, textureOffset + 1.0);\n  }\n}\n",fs:""}),this.registerModule("styleMappingCalOpacity",{vs:"\n// 计算 opacity 和标示在 cell 中取值位置的偏移量 textureOffset\nvec2 calOpacityAndOffset(float cellCurrentRow, float cellCurrentColumn, float columnCount, float textureOffset, float columnWidth, float rowHeight) {\n  if(!hasOpacity()) { // 数据纹理中不存在 opacity 的时候取默认值（用户在 style 中传入的是常量）\n    return vec2(u_opacity, textureOffset);\n  } else {\n    vec2 valuePos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    float textureOpacity = pos2value(valuePos, columnWidth, rowHeight);\n    return vec2(textureOpacity, textureOffset + 1.0);\n  }\n}\n",fs:""}),this.registerModule("styleMappingCalStrokeOpacity",{vs:"\n// 计算 strokeOpaicty 和标示在 cell 中取值位置的偏移量 textureOffset\nvec2 calStrokeOpacityAndOffset(float cellCurrentRow, float cellCurrentColumn, float columnCount, float textureOffset, float columnWidth, float rowHeight) {\n  if(!hasStrokeOpacity()) {\n    return vec2(u_stroke_opacity, textureOffset);\n  } else {\n    vec2 valuePos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    float textureStrokeOpacity = pos2value(valuePos, columnWidth, rowHeight);\n    return vec2(textureStrokeOpacity, textureOffset + 1.0);\n  }\n}\n",fs:""}),this.registerModule("styleMappingCalStrokeWidth",{vs:"\n// 计算 strokeWidth 和标示在 cell 中取值位置的偏移量 textureOffset\nvec2 calStrokeWidthAndOffset(float cellCurrentRow, float cellCurrentColumn, float columnCount, float textureOffset, float columnWidth, float rowHeight) {\n  if(!hasStrokeWidth()) {\n    return vec2(u_stroke_width, textureOffset);\n  } else {\n    vec2 valuePos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    float textureStrokeWidth = pos2value(valuePos, columnWidth, rowHeight);\n    return vec2(textureStrokeWidth, textureOffset + 1.0);\n  }\n}\n",fs:""})}},{key:"registerModule",value:function(t,e){if(!this.rawContentCache[t]){var n=e.vs,r=e.fs,i=e.uniforms,o=I6(n),a=o.content,s=o.uniforms,u=I6(r),c=u.content,l=u.uniforms;this.rawContentCache[t]={fs:c,uniforms:Jq(Jq(Jq({},s),l),i),vs:a}}}},{key:"destroy",value:function(){this.moduleCache={},this.rawContentCache={}}},{key:"getModule",value:function(t){var e=this;if(this.moduleCache[t])return this.moduleCache[t];var n=this.rawContentCache[t].vs,r=this.rawContentCache[t].fs,i=this.processModule(n,[],"vs"),o=i.content,a=i.includeList,s=this.processModule(r,[],"fs"),u=s.content,c=s.includeList,l=u,h=hZ.uniq(a.concat(c).concat(t)).reduce((function(t,n){return Jq(Jq({},t),e.rawContentCache[n].uniforms)}),{});return B6.test(u)||(l="#ifdef GL_FRAGMENT_PRECISION_HIGH\n precision highp float;\n #else\n precision mediump float;\n#endif\n"+u),this.moduleCache[t]={fs:l.trim(),uniforms:h,vs:o.trim()},this.moduleCache[t]}},{key:"processModule",value:function(t,e,n){var r=this;return{content:t.replace(z6,(function(t,i){var o=i.split(" ")[0].replace(/"/g,"");if(e.indexOf(o)>-1)return"";var a=r.rawContentCache[o][n];return e.push(o),r.processModule(a,e,n).content})),includeList:e}}}]),t}())||L6;function V6(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=EZ(t)););return t}function G6(){return G6="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=V6(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},G6.apply(this,arguments)}(D6=N6||(N6={})).Normal="normal",D6.PostProcessing="post-processing";var W6,H6=Z2()(F6=function(){function t(){mZ(this,t),$q(this,"shaderModuleService",void 0),$q(this,"rendererService",void 0),$q(this,"cameraService",void 0),$q(this,"mapService",void 0),$q(this,"interactionService",void 0),$q(this,"layerService",void 0),$q(this,"config",void 0)}return gZ(t,[{key:"getName",value:function(){return""}},{key:"getType",value:function(){return N6.Normal}},{key:"init",value:function(t,e){this.config=e,this.rendererService=t.getContainer().get(J2.IRendererService),this.cameraService=t.getContainer().get(J2.ICameraService),this.mapService=t.getContainer().get(J2.IMapService),this.interactionService=t.getContainer().get(J2.IInteractionService),this.layerService=t.getContainer().get(J2.ILayerService),this.shaderModuleService=t.getContainer().get(J2.IShaderModuleService)}},{key:"render",value:function(t){}}]),t}())||F6;function Y6(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var X6,q6,Z6,$6,K6,J6=Z2()(W6=function(t){wZ(n,H6);var e=Y6(n);function n(){return mZ(this,n),e.apply(this,arguments)}return gZ(n,[{key:"getName",value:function(){return"clear"}},{key:"init",value:function(t,e){G6(EZ(n.prototype),"init",this).call(this,t,e)}},{key:"render",value:function(){this.rendererService.clear({color:[0,0,0,0],depth:1,framebuffer:null})}}]),n}())||W6;function Q6(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return t7(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return t7(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function t7(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var e7,n7=(X6=Z2(),q6=d2(J2.IPostProcessor),X6((K6=j3(($6=function(){function t(){mZ(this,t),$q(this,"passes",[]),F3(this,"postProcessor",K6,this),$q(this,"layer",void 0),$q(this,"renderFlag",void 0),$q(this,"width",0),$q(this,"height",0)}var e;return gZ(t,[{key:"setLayer",value:function(t){this.layer=t}},{key:"setRenderFlag",value:function(t){this.renderFlag=t}},{key:"getRenderFlag",value:function(){return this.renderFlag}},{key:"getPostProcessor",value:function(){return this.postProcessor}},{key:"render",value:(e=RK(jK.mark((function t(){var e,n,r;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=Q6(this.passes),t.prev=1,e.s();case 3:if((n=e.n()).done){t.next=9;break}return r=n.value,t.next=7,r.render(this.layer);case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:return t.next=19,this.postProcessor.render(this.layer);case 19:case"end":return t.stop()}}),t,this,[[1,11,14,17]])}))),function(){return e.apply(this,arguments)})},{key:"resize",value:function(t,e){this.width===t&&this.height===e||(this.postProcessor.resize(t,e),this.width=t,this.height=e)}},{key:"add",value:function(t,e){t.getType()===N6.PostProcessing?this.postProcessor.add(t,this.layer,e):(t.init(this.layer,e),this.passes.push(t))}},{key:"insert",value:function(t,e,n){t.init(this.layer,e),this.passes.splice(n,0,t)}},{key:"destroy",value:function(){this.passes.length=0}}]),t}()).prototype,"postProcessor",[q6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Z6=$6))||Z6);function r7(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var i7,o7,a7,s7,u7,c7,l7=Z2()(e7=function(t){wZ(n,H6);var e=r7(n);function n(){var t;mZ(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return $q(SZ(t=e.call.apply(e,[this].concat(i))),"pickingFBO",void 0),$q(SZ(t),"layer",void 0),$q(SZ(t),"width",0),$q(SZ(t),"height",0),$q(SZ(t),"alreadyInRendering",!1),$q(SZ(t),"pickFromPickingFBO",(function(e){var n=e.x,r=e.y,i=e.lngLat,o=e.type;if(t.layer.isVisible()&&t.layer.needPick(o)){var a,s=t.rendererService,u=s.getViewportSize,c=s.readPixels,l=s.useFramebuffer,h=u(),f=h.width,p=h.height,d=t.layer.getLayerConfig(),m=d.enableHighlight,v=d.enableSelect,g=n*Y$,y=r*Y$;if(!(g>f||g<0||y>p||y<0))l(t.pickingFBO,(function(){var e;if(0!==(a=c({x:Math.round(g),y:Math.round(p-(r+1)*Y$),width:1,height:1,data:new Uint8Array(4),framebuffer:t.pickingFBO}))[0]||0!==a[1]||0!==a[2]){var s=AK(a),u=t.layer.getSource().getFeatureById(s),l={x:n,y:r,type:o,lngLat:i,featureId:s,feature:u};u&&(t.layer.setCurrentPickId(s),t.triggerHoverOnLayer(l))}else{var h={x:n,y:r,lngLat:i,type:null===t.layer.getCurrentPickId()?"un"+o:"mouseout",featureId:null,feature:null};t.triggerHoverOnLayer(Jq(Jq({},h),{},{type:"unpick"})),t.triggerHoverOnLayer(h),t.layer.setCurrentPickId(null)}m&&t.highlightPickedFeature(a),v&&"click"===o&&(null===(e=a)||void 0===e?void 0:e.toString())!==[0,0,0,0].toString()&&t.selectFeature(a)}))}})),t}return gZ(n,[{key:"getType",value:function(){return N6.Normal}},{key:"getName",value:function(){return"pixelPicking"}},{key:"init",value:function(t,e){G6(EZ(n.prototype),"init",this).call(this,t,e),this.layer=t;var r=this.rendererService,i=r.createTexture2D,o=r.createFramebuffer,a=(0,r.getViewportSize)(),s=a.width,u=a.height;this.pickingFBO=o({color:i({width:s,height:u,wrapS:m4.CLAMP_TO_EDGE,wrapT:m4.CLAMP_TO_EDGE})}),this.interactionService.on(s4.Hover,this.pickFromPickingFBO),this.interactionService.on(s4.Select,this.selectFeatureHandle.bind(this)),this.interactionService.on(s4.Active,this.highlightFeatureHandle.bind(this))}},{key:"render",value:function(t){var e=this;if(!this.alreadyInRendering){var n=this.rendererService,r=n.getViewportSize,i=n.useFramebuffer,o=n.clear,a=r(),s=a.width,u=a.height;this.alreadyInRendering=!0,this.width===s&&this.height===u||(this.pickingFBO.resize({width:s,height:u}),this.width=s,this.height=u),i(this.pickingFBO,(function(){o({framebuffer:e.pickingFBO,color:[0,0,0,0],stencil:0,depth:1});var n=e.layer.multiPassRenderer.getRenderFlag();e.layer.multiPassRenderer.setRenderFlag(!1),t.hooks.beforePickingEncode.call(),t.render(),t.hooks.afterPickingEncode.call(),e.layer.multiPassRenderer.setRenderFlag(n),e.alreadyInRendering=!1}))}}},{key:"triggerHoverOnLayer",value:function(t){this.layer.emit(t.type,t)}},{key:"highlightPickedFeature",value:function(t){var e=lZ(t,3),n=e[0],r=e[1],i=e[2];this.layer.hooks.beforeHighlight.call([n,r,i]),this.layerService.renderLayers()}},{key:"selectFeature",value:function(t){var e=lZ(t,3),n=e[0],r=e[1],i=e[2];this.layer.hooks.beforeSelect.call([n,r,i]),this.layerService.renderLayers()}},{key:"selectFeatureHandle",value:function(t){var e=TK(t.featureId);this.selectFeature(new Uint8Array(e))}},{key:"highlightFeatureHandle",value:function(t){var e=TK(t.featureId);this.highlightPickedFeature(new Uint8Array(e))}}]),n}())||e7,h7=(i7=Z2(),o7=d2(J2.IShaderModuleService),i7((s7=function(){function t(){mZ(this,t),F3(this,"shaderModuleService",u7,this),$q(this,"rendererService",void 0),$q(this,"config",void 0),$q(this,"quad","attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}"),$q(this,"enabled",!0),$q(this,"renderToScreen",!1),$q(this,"model",void 0),$q(this,"name",void 0),$q(this,"optionsToUpdate",{})}return gZ(t,[{key:"getName",value:function(){return this.name}},{key:"setName",value:function(t){this.name=t}},{key:"getType",value:function(){return N6.PostProcessing}},{key:"init",value:function(t,e){this.config=e,this.rendererService=t.getContainer().get(J2.IRendererService),this.shaderModuleService=t.getContainer().get(J2.IShaderModuleService);var n=this.rendererService,r=n.createAttribute,i=n.createBuffer,o=n.createModel,a=this.setupShaders(),s=a.vs,u=a.fs,c=a.uniforms;this.model=o({vs:s,fs:u,attributes:{a_Position:r({buffer:i({data:[-4,-4,4,-4,0,4],type:m4.FLOAT}),size:2})},uniforms:Jq(Jq({u_Texture:null},c),this.config&&this.convertOptionsToUniforms(this.config)),depth:{enable:!1},count:3,blend:{enable:"copy"===this.getName()}})}},{key:"render",value:function(t,e){var n=this,r=t.multiPassRenderer.getPostProcessor(),i=this.rendererService,o=i.useFramebuffer,a=i.getViewportSize,s=i.clear,u=a(),c=u.width,l=u.height;o(this.renderToScreen?null:r.getWriteFBO(),(function(){s({framebuffer:r.getWriteFBO(),color:[0,0,0,0],depth:1,stencil:0});var t=Jq({u_BloomFinal:0,u_Texture:r.getReadFBO(),u_ViewportSize:[c,l]},n.convertOptionsToUniforms(n.optionsToUpdate));e&&(t.u_BloomFinal=1,t.u_Texture2=e),n.model.draw({uniforms:t})}))}},{key:"isEnabled",value:function(){return this.enabled}},{key:"setEnabled",value:function(t){this.enabled=t}},{key:"setRenderToScreen",value:function(t){this.renderToScreen=t}},{key:"updateOptions",value:function(t){this.optionsToUpdate=Jq(Jq({},this.optionsToUpdate),t)}},{key:"setupShaders",value:function(){throw new Error("Method not implemented.")}},{key:"convertOptionsToUniforms",value:function(t){var e={};return Object.keys(t).forEach((function(n){hZ.isNil(t[n])||(e["u_".concat(hZ.upperFirst(hZ.camelCase(n)))]=t[n])})),e}}]),t}(),u7=j3(s7.prototype,"shaderModuleService",[o7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a7=s7))||a7);function f7(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var p7,d7=Z2()(c7=function(t){wZ(n,h7);var e=f7(n);function n(){return mZ(this,n),e.apply(this,arguments)}return gZ(n,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:"varying vec2 v_UV;\n\nuniform float u_BloomFinal: 0.0;\nuniform sampler2D u_Texture;\nuniform sampler2D u_Texture2;\n\nuniform vec2 u_ViewportSize: [1.0, 1.0];\nuniform float u_radius: 5.0;\nuniform float u_intensity: 0.3;\nuniform float u_baseRadio: 0.5;\n\n// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl\nvec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {\n  vec4 color = vec4(0.0);\n  vec2 off1 = vec2(1.3846153846) * direction;\n  vec2 off2 = vec2(3.2307692308) * direction;\n  color += texture2D(image, uv) * 0.2270270270;\n  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;\n  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;\n  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;\n  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;\n  return color;\n}\n\nfloat luminance(vec4 color) {\n  return  0.2125 * color.r + 0.7154 * color.g + 0.0721 * color.b;\n}\n\nvoid main() {\n  // vec4 baseColor = texture2D(u_Texture, v_UV);\n\n  float r = sqrt(u_radius);\n\n  vec4 c1 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(u_radius, 0.0));\n  // c1 *= luminance(c1);\n  vec4 c2 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(0.0, u_radius));\n  // c2 *= luminance(c2);\n  vec4 c3 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(r, r));\n  // c3 *= luminance(c3);\n  vec4 c4 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(r, -r));\n  // c4 *= luminance(c4);\n  vec4 inbloomColor = (c1 + c2 + c3 + c4) * 0.25;\n\n  // float lum = luminance(inbloomColor);\n  // inbloomColor.rgb *= lum;\n\n  if(u_BloomFinal > 0.0) {\n    vec4 baseColor = texture2D(u_Texture2, v_UV);\n    float baselum = luminance(baseColor);\n    gl_FragColor = mix(inbloomColor, baseColor, u_baseRadio);\n    if(baselum <= 0.2) {\n      gl_FragColor = inbloomColor * u_intensity;\n    }\n  } else {\n    gl_FragColor = inbloomColor;\n  }\n}"});var t=this.shaderModuleService.getModule("blur-pass"),e=t.vs,n=t.fs,r=t.uniforms,i=this.rendererService.getViewportSize(),o=i.width,a=i.height;return{vs:e,fs:n,uniforms:Jq(Jq({},r),{},{u_ViewportSize:[o,a]})}}},{key:"convertOptionsToUniforms",value:function(t){var e={};return hZ.isNil(t.bloomRadius)||(e.u_radius=t.bloomRadius),hZ.isNil(t.bloomIntensity)||(e.u_intensity=t.bloomIntensity),hZ.isNil(t.bloomBaseRadio)||(e.u_baseRadio=t.bloomBaseRadio),e}}]),n}())||c7;function m7(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var v7,g7=Z2()(p7=function(t){wZ(n,h7);var e=m7(n);function n(){return mZ(this,n),e.apply(this,arguments)}return gZ(n,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:"varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\n\nuniform vec2 u_ViewportSize: [1.0, 1.0];\nuniform vec2 u_BlurDir: [1.0, 0.0];\n\n// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl\nvec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {\n  vec4 color = vec4(0.0);\n  vec2 off1 = vec2(1.3846153846) * direction;\n  vec2 off2 = vec2(3.2307692308) * direction;\n  color += texture2D(image, uv) * 0.2270270270;\n  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;\n  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;\n  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;\n  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;\n  return color;\n}\n\nvoid main() {\n  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);\n}"});var t=this.shaderModuleService.getModule("blur-pass"),e=t.vs,n=t.fs,r=t.uniforms,i=this.rendererService.getViewportSize(),o=i.width,a=i.height;return{vs:e,fs:n,uniforms:Jq(Jq({},r),{},{u_ViewportSize:[o,a]})}}},{key:"convertOptionsToUniforms",value:function(t){var e={};return hZ.isNil(t.blurRadius)||(e.u_BlurDir=[t.blurRadius,0]),e}}]),n}())||p7;function y7(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var x7,b7=Z2()(v7=function(t){wZ(n,h7);var e=y7(n);function n(){return mZ(this,n),e.apply(this,arguments)}return gZ(n,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:"varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\n\nuniform vec2 u_ViewportSize: [1.0, 1.0];\nuniform vec2 u_BlurDir: [1.0, 0.0];\n\n// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl\nvec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {\n  vec4 color = vec4(0.0);\n  vec2 off1 = vec2(1.3846153846) * direction;\n  vec2 off2 = vec2(3.2307692308) * direction;\n  color += texture2D(image, uv) * 0.2270270270;\n  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;\n  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;\n  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;\n  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;\n  return color;\n}\n\nvoid main() {\n  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);\n}"});var t=this.shaderModuleService.getModule("blur-pass"),e=t.vs,n=t.fs,r=t.uniforms,i=this.rendererService.getViewportSize(),o=i.width,a=i.height;return{vs:e,fs:n,uniforms:Jq(Jq({},r),{},{u_ViewportSize:[o,a]})}}},{key:"convertOptionsToUniforms",value:function(t){var e={};return hZ.isNil(t.blurRadius)||(e.u_BlurDir=[0,t.blurRadius]),e}}]),n}())||v7;function _7(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var w7,S7=Z2()(x7=function(t){wZ(n,h7);var e=_7(n);function n(){return mZ(this,n),e.apply(this,arguments)}return gZ(n,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("colorhalftone-pass",{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:'varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\nuniform vec2 u_ViewportSize: [1.0, 1.0];\nuniform vec2 u_Center : [0.5, 0.5];\nuniform float u_Angle : 0;\nuniform float u_Size : 8;\n\n#pragma include "common"\n\nfloat scale = PI / u_Size;\n\nfloat pattern(float u_Angle, vec2 texSize, vec2 texCoord) {\n  float s = sin(u_Angle), c = cos(u_Angle);\n  vec2 tex = texCoord * texSize - u_Center * texSize;\n  vec2 point = vec2(\n    c * tex.x - s * tex.y,\n    s * tex.x + c * tex.y\n  ) * scale;\n  return (sin(point.x) * sin(point.y)) * 4.0;\n}\n\n// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/colorhalftone.js\nvec4 colorHalftone_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {\n  vec3 cmy = 1.0 - color.rgb;\n  float k = min(cmy.x, min(cmy.y, cmy.z));\n  cmy = (cmy - k) / (1.0 - k);\n  cmy = clamp(\n    cmy * 10.0 - 3.0 + vec3(\n      pattern(u_Angle + 0.26179, texSize, texCoord),\n      pattern(u_Angle + 1.30899, texSize, texCoord),\n      pattern(u_Angle, texSize, texCoord)\n    ),\n    0.0,\n    1.0\n  );\n  k = clamp(k * 10.0 - 5.0 + pattern(u_Angle + 0.78539, texSize, texCoord), 0.0, 1.0);\n  return vec4(1.0 - cmy - k, color.a);\n}\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n  gl_FragColor = colorHalftone_filterColor(gl_FragColor, u_ViewportSize, v_UV);\n}'});var t=this.shaderModuleService.getModule("colorhalftone-pass"),e=t.vs,n=t.fs,r=t.uniforms,i=this.rendererService.getViewportSize(),o=i.width,a=i.height;return{vs:e,fs:n,uniforms:Jq(Jq({},r),{},{u_ViewportSize:[o,a]})}}}]),n}())||x7;function M7(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var E7,A7=Z2()(w7=function(t){wZ(n,h7);var e=M7(n);function n(){return mZ(this,n),e.apply(this,arguments)}return gZ(n,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("copy-pass",{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:"varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n}"}),this.shaderModuleService.getModule("copy-pass")}}]),n}())||w7;function T7(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var C7,O7=Z2()(E7=function(t){wZ(n,h7);var e=T7(n);function n(){return mZ(this,n),e.apply(this,arguments)}return gZ(n,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("hexagonalpixelate-pass",{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:"varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\nuniform vec2 u_ViewportSize: [1.0, 1.0];\nuniform vec2 u_Center : [0.5, 0.5];\nuniform float u_Scale : 10;\n\n// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/hexagonalpixelate.js\nvec4 hexagonalPixelate_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {\n  vec2 tex = (texCoord * texSize - u_Center * texSize) / u_Scale;\n  tex.y /= 0.866025404;\n  tex.x -= tex.y * 0.5;\n  vec2 a;\n  if (tex.x + tex.y - floor(tex.x) - floor(tex.y) < 1.0) {\n    a = vec2(floor(tex.x), floor(tex.y));\n  }\n  else a = vec2(ceil(tex.x), ceil(tex.y));\n  vec2 b = vec2(ceil(tex.x), floor(tex.y));\n  vec2 c = vec2(floor(tex.x), ceil(tex.y));\n  vec3 TEX = vec3(tex.x, tex.y, 1.0 - tex.x - tex.y);\n  vec3 A = vec3(a.x, a.y, 1.0 - a.x - a.y);\n  vec3 B = vec3(b.x, b.y, 1.0 - b.x - b.y);\n  vec3 C = vec3(c.x, c.y, 1.0 - c.x - c.y);\n  float alen = length(TEX - A);\n  float blen = length(TEX - B);\n  float clen = length(TEX - C);\n  vec2 choice;\n  if (alen < blen) {\n    if (alen < clen) choice = a;\n    else choice = c;\n  } else {\n    if (blen < clen) choice = b;\n    else choice = c;\n  }\n  choice.x += choice.y * 0.5;\n  choice.y *= 0.866025404;\n  choice *= u_Scale / texSize;\n  return texture2D(texture, choice + u_Center);\n}\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n  gl_FragColor = hexagonalPixelate_sampleColor(u_Texture, u_ViewportSize, v_UV);\n}"});var t=this.shaderModuleService.getModule("hexagonalpixelate-pass"),e=t.vs,n=t.fs,r=t.uniforms,i=this.rendererService.getViewportSize(),o=i.width,a=i.height;return{vs:e,fs:n,uniforms:Jq(Jq({},r),{},{u_ViewportSize:[o,a]})}}}]),n}())||E7;function k7(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var P7,L7=Z2()(C7=function(t){wZ(n,h7);var e=k7(n);function n(){return mZ(this,n),e.apply(this,arguments)}return gZ(n,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("ink-pass",{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:"varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\nuniform vec2 u_ViewportSize: [1.0, 1.0];\nuniform float u_Strength : 0.6;\n\nvec4 ink_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {\n  vec2 dx = vec2(1.0 / texSize.x, 0.0);\n  vec2 dy = vec2(0.0, 1.0 / texSize.y);\n  vec4 color = texture2D(texture, texCoord);\n  float bigTotal = 0.0;\n  float smallTotal = 0.0;\n  vec3 bigAverage = vec3(0.0);\n  vec3 smallAverage = vec3(0.0);\n  for (float x = -2.0; x <= 2.0; x += 1.0) {\n    for (float y = -2.0; y <= 2.0; y += 1.0) {\n      vec3 sample = texture2D(texture, texCoord + dx * x + dy * y).rgb;\n      bigAverage += sample;\n      bigTotal += 1.0;\n      if (abs(x) + abs(y) < 2.0) {\n        smallAverage += sample;\n        smallTotal += 1.0;\n      }\n    }\n  }\n  vec3 edge = max(vec3(0.0), bigAverage / bigTotal - smallAverage / smallTotal);\n  float power = u_Strength * u_Strength * u_Strength * u_Strength * u_Strength;\n  return vec4(color.rgb - dot(edge, edge) * power * 100000.0, color.a);\n}\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n  gl_FragColor = ink_sampleColor(u_Texture, u_ViewportSize, v_UV);\n}"});var t=this.shaderModuleService.getModule("ink-pass"),e=t.vs,n=t.fs,r=t.uniforms,i=this.rendererService.getViewportSize(),o=i.width,a=i.height;return{vs:e,fs:n,uniforms:Jq(Jq({},r),{},{u_ViewportSize:[o,a]})}}}]),n}())||C7;function R7(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var I7,N7=Z2()(P7=function(t){wZ(n,h7);var e=R7(n);function n(){return mZ(this,n),e.apply(this,arguments)}return gZ(n,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("noise-pass",{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:"varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\nuniform float u_Amount : 0.5;\n\nfloat rand(vec2 co) {\n  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n}\n\n// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/noise.js\nvec4 noise_filterColor(vec4 color, vec2 texCoord) {\n  float diff = (rand(texCoord) - 0.5) * u_Amount;\n  color.r += diff;\n  color.g += diff;\n  color.b += diff;\n  return color;\n}\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n  gl_FragColor = noise_filterColor(gl_FragColor, v_UV);\n}"}),this.shaderModuleService.getModule("noise-pass")}}]),n}())||P7;function D7(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var F7,j7,B7,z7,U7,V7,G7,W7=Z2()(I7=function(t){wZ(n,h7);var e=D7(n);function n(){return mZ(this,n),e.apply(this,arguments)}return gZ(n,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("sepia-pass",{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:"varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\n\nuniform float u_Amount : 0.5;\n\n// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/sepia.js\nvec4 sepia_filterColor(vec4 color) {\n  float r = color.r;\n  float g = color.g;\n  float b = color.b;\n  color.r =\n    min(1.0, (r * (1.0 - (0.607 * u_Amount))) + (g * (0.769 * u_Amount)) + (b * (0.189 * u_Amount)));\n  color.g = min(1.0, (r * 0.349 * u_Amount) + (g * (1.0 - (0.314 * u_Amount))) + (b * 0.168 * u_Amount));\n  color.b = min(1.0, (r * 0.272 * u_Amount) + (g * 0.534 * u_Amount) + (b * (1.0 - (0.869 * u_Amount))));\n  return color;\n}\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n  gl_FragColor = sepia_filterColor(gl_FragColor);\n}"}),this.shaderModuleService.getModule("sepia-pass")}}]),n}())||I7,H7=(F7=Z2(),j7=d2(J2.IRendererService),B7=function(t,e,n){var r=new u2(O1,e);if(Reflect.hasOwnMetadata(O1,t.constructor))throw new Error("Cannot apply @postConstruct decorator multiple times in the same class");Reflect.defineMetadata(O1,r,t.constructor)},F7((U7=function(){function t(){mZ(this,t),F3(this,"rendererService",V7,this),$q(this,"passes",[]),$q(this,"readFBO",void 0),$q(this,"writeFBO",void 0)}var e,n;return gZ(t,[{key:"getReadFBO",value:function(){return this.readFBO}},{key:"getWriteFBO",value:function(){return this.writeFBO}},{key:"getCurrentFBOTex",value:function(){var t=this.rendererService,e=t.getViewportSize,n=t.createTexture2D,r=e();return n({x:0,y:0,width:r.width,height:r.height,copy:!0})}},{key:"getReadFBOTex",value:function(){var t=this,e=this.rendererService.useFramebuffer;return new Promise((function(n){e(t.readFBO,RK(jK.mark((function e(){return jK.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n(t.getCurrentFBOTex());case 1:case"end":return e.stop()}}),e)}))))}))}},{key:"renderBloomPass",value:(n=RK(jK.mark((function t(e,n){var r,i;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getReadFBOTex();case 2:r=t.sent,i=0;case 4:if(!(i<4)){t.next=11;break}return t.next=7,n.render(e,r);case 7:this.swap(),i++,t.next=4;break;case 11:case"end":return t.stop()}}),t,this)}))),function(t,e){return n.apply(this,arguments)})},{key:"render",value:(e=RK(jK.mark((function t(e){var n,r;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=0;case 1:if(!(n<this.passes.length)){t.next=15;break}if((r=this.passes[n]).setRenderToScreen(this.isLastEnabledPass(n)),"bloom"!==r.getName()){t.next=9;break}return t.next=7,this.renderBloomPass(e,r);case 7:t.next=12;break;case 9:return t.next=11,r.render(e);case 11:n!==this.passes.length-1&&this.swap();case 12:n++,t.next=1;break;case 15:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})},{key:"resize",value:function(t,e){this.readFBO.resize({width:t,height:e}),this.writeFBO.resize({width:t,height:e})}},{key:"add",value:function(t,e,n){t.init(e,n),this.passes.push(t)}},{key:"insert",value:function(t,e,n,r){t.init(n,r),this.passes.splice(e,0,t)}},{key:"getPostProcessingPassByName",value:function(t){return this.passes.find((function(e){return e.getName()===t}))}},{key:"init",value:function(){var t=this.rendererService,e=t.createFramebuffer,n=t.createTexture2D;this.readFBO=e({color:n({width:1,height:1,wrapS:m4.CLAMP_TO_EDGE,wrapT:m4.CLAMP_TO_EDGE})}),this.writeFBO=e({color:n({width:1,height:1,wrapS:m4.CLAMP_TO_EDGE,wrapT:m4.CLAMP_TO_EDGE})})}},{key:"isLastEnabledPass",value:function(t){for(var e=t+1;e<this.passes.length;e++)if(this.passes[e].isEnabled())return!1;return!0}},{key:"swap",value:function(){var t=this.readFBO;this.readFBO=this.writeFBO,this.writeFBO=t}}]),t}(),V7=j3(U7.prototype,"rendererService",[j7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j3(U7.prototype,"init",[B7],Object.getOwnPropertyDescriptor(U7.prototype,"init"),U7.prototype),z7=U7))||z7);function Y7(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var X7,q7,Z7,$7,K7,J7=Z2()(G7=function(t){wZ(n,H6);var e=Y7(n);function n(){return mZ(this,n),e.apply(this,arguments)}return gZ(n,[{key:"getType",value:function(){return N6.Normal}},{key:"getName",value:function(){return"render"}},{key:"init",value:function(t,e){G6(EZ(n.prototype),"init",this).call(this,t,e)}},{key:"render",value:function(t){var e=this.rendererService,n=e.useFramebuffer,r=e.clear,i=t.multiPassRenderer.getPostProcessor().getReadFBO();n(i,(function(){r({color:[0,0,0,0],depth:1,stencil:0,framebuffer:i}),t.multiPassRenderer.setRenderFlag(!1),t.models.forEach((function(e){e.draw({uniforms:t.layerModel.getUninforms()})})),t.multiPassRenderer.setRenderFlag(!0)}))}}]),n}())||G7;function Q7(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var t8="varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n}";function e8(t,e){for(var n=0,r=1/e,i=t;i>0;)n+=r*(i%e),i=Math.floor(i/e),r/=e;return n}var n8,r8,i8,o8=1,a8=(X7=Z2(),q7=d2(J2.IShaderModuleService),X7(($7=function(t){wZ(n,H6);var e=Q7(n);function n(){var t;mZ(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return F3(SZ(t=e.call.apply(e,[this].concat(i))),"shaderModuleService",K7,SZ(t)),$q(SZ(t),"haltonSequence",[]),$q(SZ(t),"accumulatingId",0),$q(SZ(t),"frame",0),$q(SZ(t),"timer",void 0),$q(SZ(t),"sampleRenderTarget",void 0),$q(SZ(t),"prevRenderTarget",void 0),$q(SZ(t),"outputRenderTarget",void 0),$q(SZ(t),"copyRenderTarget",void 0),$q(SZ(t),"blendModel",void 0),$q(SZ(t),"outputModel",void 0),$q(SZ(t),"copyModel",void 0),t}return gZ(n,[{key:"getType",value:function(){return N6.Normal}},{key:"getName",value:function(){return"taa"}},{key:"init",value:function(t,e){G6(EZ(n.prototype),"init",this).call(this,t,e);var r=this.rendererService,i=r.createFramebuffer,o=r.createTexture2D;this.sampleRenderTarget=i({color:o({width:1,height:1,wrapS:m4.CLAMP_TO_EDGE,wrapT:m4.CLAMP_TO_EDGE})}),this.prevRenderTarget=i({color:o({width:1,height:1,wrapS:m4.CLAMP_TO_EDGE,wrapT:m4.CLAMP_TO_EDGE})}),this.outputRenderTarget=i({color:o({width:1,height:1,wrapS:m4.CLAMP_TO_EDGE,wrapT:m4.CLAMP_TO_EDGE})}),this.copyRenderTarget=i({color:o({width:1,height:1,wrapS:m4.CLAMP_TO_EDGE,wrapT:m4.CLAMP_TO_EDGE})});for(var a=0;a<30;a++)this.haltonSequence.push([e8(a,2),e8(a,3)]);this.blendModel=this.createTriangleModel("blend-pass","uniform float u_opacity : 1.0;\nuniform float u_MixRatio : 0.5;\n\nuniform sampler2D u_Diffuse1;\nuniform sampler2D u_Diffuse2;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  vec4 texel1 = texture2D(u_Diffuse1, v_UV);\n  vec4 texel2 = texture2D(u_Diffuse2, v_UV);\n  gl_FragColor = u_opacity * mix(texel1, texel2, u_MixRatio);\n}\n"),this.outputModel=this.createTriangleModel("copy-pass",t8,{blend:{enable:!0,func:{srcRGB:m4.ONE,dstRGB:m4.ONE_MINUS_SRC_ALPHA,srcAlpha:m4.ONE,dstAlpha:m4.ONE_MINUS_SRC_ALPHA},equation:{rgb:m4.FUNC_ADD,alpha:m4.FUNC_ADD}}}),this.copyModel=this.createTriangleModel("copy-pass",t8)}},{key:"render",value:function(t){var e=this,n=this.rendererService,r=n.clear,i=n.getViewportSize,o=n.useFramebuffer,a=i(),s=a.width,u=a.height;this.sampleRenderTarget.resize({width:s,height:u}),this.prevRenderTarget.resize({width:s,height:u}),this.outputRenderTarget.resize({width:s,height:u}),this.copyRenderTarget.resize({width:s,height:u}),this.resetFrame(),this.stopAccumulating();var c=t.multiPassRenderer.getPostProcessor().getReadFBO();o(c,(function(){r({color:[0,0,0,0],depth:1,stencil:0,framebuffer:c}),t.multiPassRenderer.setRenderFlag(!1),t.render(),t.multiPassRenderer.setRenderFlag(!0)}));var l=function n(r){e.accumulatingId&&r===e.accumulatingId&&(e.isFinished()||(e.doRender(t),F$.requestAnimationFrame((function(){n(r)}))))};this.accumulatingId=o8++,this.timer=F$.setTimeout((function(){l(e.accumulatingId)}),50)}},{key:"doRender",value:function(t){var e=this,n=this.rendererService,r=n.clear,i=n.getViewportSize,o=n.useFramebuffer,a=i(),s=a.width,u=a.height,c=t.getLayerConfig().jitterScale,l=void 0===c?1:c,h=this.haltonSequence[this.frame%this.haltonSequence.length];this.cameraService.jitterProjectionMatrix((2*h[0]-1)/s*l,(2*h[1]-1)/u*l),t.multiPassRenderer.setRenderFlag(!1),t.hooks.beforeRender.call(),o(this.sampleRenderTarget,(function(){r({color:[0,0,0,0],depth:1,stencil:0,framebuffer:e.sampleRenderTarget}),t.render()})),t.hooks.afterRender.call(),t.multiPassRenderer.setRenderFlag(!0);var f=t.getLayerConfig();o(this.outputRenderTarget,(function(){e.blendModel.draw({uniforms:{u_opacity:f.opacity||1,u_MixRatio:0===e.frame?1:.9,u_Diffuse1:e.sampleRenderTarget,u_Diffuse2:0===e.frame?t.multiPassRenderer.getPostProcessor().getReadFBO():e.prevRenderTarget}})})),0===this.frame&&r({color:[0,0,0,0],depth:1,stencil:0,framebuffer:this.copyRenderTarget}),this.frame>=1&&(o(this.copyRenderTarget,(function(){e.outputModel.draw({uniforms:{u_Texture:e.outputRenderTarget}})})),o(t.multiPassRenderer.getPostProcessor().getReadFBO(),(function(){e.copyModel.draw({uniforms:{u_Texture:e.copyRenderTarget}})})),t.multiPassRenderer.getPostProcessor().render(t));var p=this.prevRenderTarget;this.prevRenderTarget=this.outputRenderTarget,this.outputRenderTarget=p,this.frame++,this.cameraService.clearJitterProjectionMatrix()}},{key:"isFinished",value:function(){return this.frame>=this.haltonSequence.length}},{key:"resetFrame",value:function(){this.frame=0}},{key:"stopAccumulating",value:function(){this.accumulatingId=0,F$.clearTimeout(this.timer)}},{key:"createTriangleModel",value:function(t,e,n){this.shaderModuleService.registerModule(t,{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:e});var r=this.shaderModuleService.getModule(t),i=r.vs,o=r.fs,a=r.uniforms,s=this.rendererService,u=s.createAttribute,c=s.createBuffer;return(0,s.createModel)(Jq({vs:i,fs:o,attributes:{a_Position:u({buffer:c({data:[-4,-4,4,-4,0,4],type:m4.FLOAT}),size:2})},uniforms:Jq({},a),depth:{enable:!1},count:3},n))}}]),n}(),K7=j3($7.prototype,"shaderModuleService",[q7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Z7=$7))||Z7),s8=new q2;s8.bind(J2.IGlobalConfigService).to(D3).inSingletonScope(),n8=Z2(),r8=hc.EventEmitter,"number"==typeof i8?h2([f2(i8,n8)],r8):"string"==typeof i8?Reflect.decorate([n8],r8,i8):h2([n8],r8),s8.bind(J2.IEventEmitter).to(hc.EventEmitter);var u8,c8,l8,h8,f8,p8,d8,m8,v8,g8,y8=function(t,e){void 0===e&&(e=!0);var n=function(t,e){return function(n){return function(r,i){K2(r,i,(function(){return t.get(n)}),e)}}}(t,e),r=function(t,e){return function(n,r){return function(i,o){K2(i,o,(function(){return t.getNamed(n,r)}),e)}}}(t,e),i=function(t,e){return function(n,r,i){return function(o,a){K2(o,a,(function(){return t.getTagged(n,r,i)}),e)}}}(t,e),o=function(t,e){return function(n){return function(r,i){K2(r,i,(function(){return t.getAll(n)}),e)}}}(t,e);return{lazyInject:n,lazyInjectNamed:r,lazyInjectTagged:i,lazyMultiInject:o}}(s8,!1),x8=function(t){var e=y8.lazyInject(t);return function(t,n,r){e.call(this,t,n),r&&(r.initializer=function(){return t[n]})}},b8=0;function _8(t){var e=new q2;return e.parent=t,e.bind(J2.IStyleAttributeService).to(o5).inSingletonScope(),e.bind(J2.IMultiPassRenderer).to(n7).inSingletonScope(),e.bind(J2.IPostProcessor).to(H7).inSingletonScope(),e}(c8=u8||(u8={})).normal="normal",c8.additive="additive",c8.subtractive="subtractive",c8.min="min",c8.max="max",c8.none="none",(h8=l8||(l8={})).LINEAR="linear",h8.SEQUENTIAL="sequential",h8.POWER="power",h8.LOG="log",h8.IDENTITY="identity",h8.TIME="time",h8.QUANTILE="quantile",h8.QUANTIZE="quantize",h8.THRESHOLD="threshold",h8.CAT="cat",h8.DIVERGING="diverging",(p8=f8||(f8={})).CONSTANT="constant",p8.VARIABLE="variable",(m8=d8||(d8={}))[m8.Attribute=0]="Attribute",m8[m8.InstancedAttribute=1]="InstancedAttribute",m8[m8.Uniform=2]="Uniform",(g8=v8||(v8={})).IMAGE="image",g8.ARRAYBUFFER="arraybuffer",g8.RGB="rgb",g8.CUSTOMRGB="customRGB",g8.CUSTOMARRAYBUFFER="customArrayBuffer";var w8=["mapload","mapchange","mapAfterFrameChange"],S8="u_ProjectionMatrix",M8="u_ViewMatrix",E8="u_ViewProjectionMatrix",A8="u_Zoom",T8="u_ZoomScale",C8="u_FocalDistance",O8="u_CameraPosition",k8=["loaded","fontloaded","maploaded","resize","destroy","dragstart","dragging","dragend","dragcancel"],P8=function(){var t=RK(jK.mark((function t(e,n,r,i){return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,o){n({x:e.x,y:e.y,z:e.z},(function(e,n){e||0===n.length?o(e):n&&p1([{data:n,bands:[0]}],r,i,(function(e,n){e?o(e):n&&t(n)}))}))})));case 1:case"end":return t.stop()}}),t)})));return function(e,n,r,i){return t.apply(this,arguments)}}();function L8(t,e){return Array.isArray(t)?"string"==typeof t[0]?t.map((function(t){return kQ(t,e)})):t.map((function(t){return{url:kQ(t.url,e),bands:t.bands||[0]}})):kQ(t,e)}function R8(t,e){t.xhrCancel=function(){e.map((function(t){t.abort()}))}}var I8=function(){var t=RK(jK.mark((function t(e,n,r,i,o){var a,s,u,c,l,h;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(f=n.url,!((a="string"==typeof f?[{url:f,bands:[0]}]:"string"==typeof f[0]?f.map((function(t){return{url:t,bands:[0]}})):f).length>1)){t.next=15;break}return t.next=4,N8(a,n);case 4:if(s=t.sent,u=s.rasterFiles,c=s.xhrList,l=s.errList,R8(e,c),!(l.length>0)){t.next=12;break}return r(l,null),t.abrupt("return");case 12:p1(u,i,o,r),t.next=17;break;case 15:h=oK(n,(function(t,e){if(t)r(t);else if(e){p1([{data:e,bands:a[0].bands}],i,o,r)}})),R8(e,[h]);case 17:case"end":return t.stop()}var f}),t)})));return function(e,n,r,i,o){return t.apply(this,arguments)}}();function N8(t,e){return D8.apply(this,arguments)}function D8(){return D8=RK(jK.mark((function t(e,n){var r,i,o,a,s,u,c,l,h,f,p;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=[],i=[],o=[],a=0;case 4:if(!(a<e.length)){t.next=20;break}return s=e[a],u=Jq(Jq({},n),{},{url:s.url}),c=s.bands,t.next=10,rK(Jq(Jq({},u),{},{type:"arrayBuffer"}));case 10:l=t.sent,h=l.err,f=l.data,p=l.xhr,h&&o.push(h),i.push(p),r.push({data:f,bands:c});case 17:a++,t.next=4;break;case 20:return t.abrupt("return",{rasterFiles:r,xhrList:i,errList:o});case 21:case"end":return t.stop()}}),t)}))),D8.apply(this,arguments)}var F8=function(){var t=RK(jK.mark((function t(e,n,r,i,o){var a;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a={url:L8(e,n)},t.abrupt("return",new Promise((function(t,e){I8(r,a,(function(n,r){n?e(n):r&&t(r)}),i,o)})));case 2:case"end":return t.stop()}}),t)})));return function(e,n,r,i,o){return t.apply(this,arguments)}}(),j8=function(){var t=RK(jK.mark((function t(e,n,r,i){var o,a,s,u;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=Array.isArray(e)?e[0]:e,i.wmtsOptions?(s=(null==i?void 0:i.getURLFromTemplate)||PQ,o=s(a,Jq(Jq({},n),i.wmtsOptions))):(u=(null==i?void 0:i.getURLFromTemplate)||kQ,o=u(a,n)),t.abrupt("return",new Promise((function(t,e){var n,a=sK({url:o,type:(null==i||null===(n=i.requestParameters)||void 0===n?void 0:n.type)||"arrayBuffer"},(function(n,r){n?e(n):r&&t(r)}),i.transformResponse);r.xhrCancel=function(){return a.abort()}})));case 3:case"end":return t.stop()}}),t)})));return function(e,n,r,i){return t.apply(this,arguments)}}(),B8=function(){return{rasterData:new Uint8Array([0]),width:1,height:1}},z8={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,warp:!0};function U8(t){return!(!Array.isArray(t)||0!==t.length)||!Array.isArray(t)&&"string"!=typeof t}v8.ARRAYBUFFER,v8.RGB;var V8={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0},G8=function(){var t=RK(jK.mark((function t(e){return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){var n=lZ(e.bounds,4),r=n[0],i=n[1],o=n[2],a=n[3];t({layers:{testTile:{features:[{type:"Feature",properties:{key:e.x+"/"+e.y+"/"+e.z,textLng:(r+o)/2,textLat:(i+a)/2},geometry:{type:"LineString",coordinates:[[o,a],[o,i],[r,i],[r,i]]}}]}}})})));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();var W8={};({get exports(){return W8},set exports(t){W8=t}}).exports=function(){function t(n,r,i,o,a,s){if(!(a-o<=i)){var u=o+a>>1;e(n,r,u,o,a,s%2),t(n,r,i,o,u-1,s+1),t(n,r,i,u+1,a,s+1)}}function e(t,r,i,o,a,s){for(;a>o;){if(a-o>600){var u=a-o+1,c=i-o+1,l=Math.log(u),h=.5*Math.exp(2*l/3),f=.5*Math.sqrt(l*h*(u-h)/u)*(c-u/2<0?-1:1);e(t,r,i,Math.max(o,Math.floor(i-c*h/u+f)),Math.min(a,Math.floor(i+(u-c)*h/u+f)),s)}var p=r[2*i+s],d=o,m=a;for(n(t,r,o,i),r[2*a+s]>p&&n(t,r,o,a);d<m;){for(n(t,r,d,m),d++,m--;r[2*d+s]<p;)d++;for(;r[2*m+s]>p;)m--}r[2*o+s]===p?n(t,r,o,m):n(t,r,++m,a),m<=i&&(o=m+1),i<=m&&(a=m-1)}}function n(t,e,n,i){r(t,n,i),r(e,2*n,2*i),r(e,2*n+1,2*i+1)}function r(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function i(t,e,n,r,i,o,a){for(var s,u,c=[0,t.length-1,0],l=[];c.length;){var h=c.pop(),f=c.pop(),p=c.pop();if(f-p<=a)for(var d=p;d<=f;d++)s=e[2*d],u=e[2*d+1],s>=n&&s<=i&&u>=r&&u<=o&&l.push(t[d]);else{var m=Math.floor((p+f)/2);s=e[2*m],u=e[2*m+1],s>=n&&s<=i&&u>=r&&u<=o&&l.push(t[m]);var v=(h+1)%2;(0===h?n<=s:r<=u)&&(c.push(p),c.push(m-1),c.push(v)),(0===h?i>=s:o>=u)&&(c.push(m+1),c.push(f),c.push(v))}}return l}function o(t,e,n,r,i,o){for(var s=[0,t.length-1,0],u=[],c=i*i;s.length;){var l=s.pop(),h=s.pop(),f=s.pop();if(h-f<=o)for(var p=f;p<=h;p++)a(e[2*p],e[2*p+1],n,r)<=c&&u.push(t[p]);else{var d=Math.floor((f+h)/2),m=e[2*d],v=e[2*d+1];a(m,v,n,r)<=c&&u.push(t[d]);var g=(l+1)%2;(0===l?n-i<=m:r-i<=v)&&(s.push(f),s.push(d-1),s.push(g)),(0===l?n+i>=m:r+i>=v)&&(s.push(d+1),s.push(h),s.push(g))}}return u}function a(t,e,n,r){var i=t-n,o=e-r;return i*i+o*o}var s=function(t){return t[0]},u=function(t){return t[1]},c=function(e,n,r,i,o){void 0===n&&(n=s),void 0===r&&(r=u),void 0===i&&(i=64),void 0===o&&(o=Float64Array),this.nodeSize=i,this.points=e;for(var a=e.length<65536?Uint16Array:Uint32Array,c=this.ids=new a(e.length),l=this.coords=new o(2*e.length),h=0;h<e.length;h++)c[h]=h,l[2*h]=n(e[h]),l[2*h+1]=r(e[h]);t(c,l,i,0,c.length-1,0)};c.prototype.range=function(t,e,n,r){return i(this.ids,this.coords,t,e,n,r,this.nodeSize)},c.prototype.within=function(t,e,n){return o(this.ids,this.coords,t,e,n,this.nodeSize)};var l,h={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(t){return t}},f=Math.fround||(l=new Float32Array(1),function(t){return l[0]=+t,l[0]}),p=function(t){this.options=w(Object.create(h),t),this.trees=new Array(this.options.maxZoom+1)};function d(t,e,n,r,i){return{x:f(t),y:f(e),zoom:1/0,id:n,parentId:-1,numPoints:r,properties:i}}function m(t,e){var n=t.geometry.coordinates,r=n[0],i=n[1];return{x:f(y(r)),y:f(x(i)),zoom:1/0,index:e,parentId:-1}}function v(t){return{type:"Feature",id:t.id,properties:g(t),geometry:{type:"Point",coordinates:[b(t.x),_(t.y)]}}}function g(t){var e=t.numPoints,n=e>=1e4?Math.round(e/1e3)+"k":e>=1e3?Math.round(e/100)/10+"k":e;return w(w({},t.properties),{cluster:!0,cluster_id:t.id,point_count:e,point_count_abbreviated:n})}function y(t){return t/360+.5}function x(t){var e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}function b(t){return 360*(t-.5)}function _(t){var e=(180-360*t)*Math.PI/180;return 360*Math.atan(Math.exp(e))/Math.PI-90}function w(t,e){for(var n in e)t[n]=e[n];return t}function S(t){return t.x}function M(t){return t.y}return p.prototype.load=function(t){var e=this.options,n=(e.log,e.minZoom),r=e.maxZoom,i=e.nodeSize;t.length,this.points=t;for(var o=[],a=0;a<t.length;a++)t[a].geometry&&o.push(m(t[a],a));this.trees[r+1]=new c(o,S,M,i,Float32Array);for(var s=r;s>=n;s--)Date.now(),o=this._cluster(o,s),this.trees[s]=new c(o,S,M,i,Float32Array);return this},p.prototype.getClusters=function(t,e){var n=((t[0]+180)%360+360)%360-180,r=Math.max(-90,Math.min(90,t[1])),i=180===t[2]?180:((t[2]+180)%360+360)%360-180,o=Math.max(-90,Math.min(90,t[3]));if(t[2]-t[0]>=360)n=-180,i=180;else if(n>i){var a=this.getClusters([n,r,180,o],e),s=this.getClusters([-180,r,i,o],e);return a.concat(s)}for(var u=this.trees[this._limitZoom(e)],c=[],l=0,h=u.range(y(n),x(o),y(i),x(r));l<h.length;l+=1){var f=h[l],p=u.points[f];c.push(p.numPoints?v(p):this.points[p.index])}return c},p.prototype.getChildren=function(t){var e=this._getOriginId(t),n=this._getOriginZoom(t),r="No cluster with the specified id.",i=this.trees[n];if(!i)throw new Error(r);var o=i.points[e];if(!o)throw new Error(r);for(var a=this.options.radius/(this.options.extent*Math.pow(2,n-1)),s=[],u=0,c=i.within(o.x,o.y,a);u<c.length;u+=1){var l=c[u],h=i.points[l];h.parentId===t&&s.push(h.numPoints?v(h):this.points[h.index])}if(0===s.length)throw new Error(r);return s},p.prototype.getLeaves=function(t,e,n){e=e||10,n=n||0;var r=[];return this._appendLeaves(r,t,e,n,0),r},p.prototype.getTile=function(t,e,n){var r=this.trees[this._limitZoom(t)],i=Math.pow(2,t),o=this.options,a=o.extent,s=o.radius/a,u=(n-s)/i,c=(n+1+s)/i,l={features:[]};return this._addTileFeatures(r.range((e-s)/i,u,(e+1+s)/i,c),r.points,e,n,i,l),0===e&&this._addTileFeatures(r.range(1-s/i,u,1,c),r.points,i,n,i,l),e===i-1&&this._addTileFeatures(r.range(0,u,s/i,c),r.points,-1,n,i,l),l.features.length?l:null},p.prototype.getClusterExpansionZoom=function(t){for(var e=this._getOriginZoom(t)-1;e<=this.options.maxZoom;){var n=this.getChildren(t);if(e++,1!==n.length)break;t=n[0].properties.cluster_id}return e},p.prototype._appendLeaves=function(t,e,n,r,i){for(var o=0,a=this.getChildren(e);o<a.length;o+=1){var s=a[o],u=s.properties;if(u&&u.cluster?i+u.point_count<=r?i+=u.point_count:i=this._appendLeaves(t,u.cluster_id,n,r,i):i<r?i++:t.push(s),t.length===n)break}return i},p.prototype._addTileFeatures=function(t,e,n,r,i,o){for(var a=0,s=t;a<s.length;a+=1){var u=e[s[a]],c=u.numPoints,l=void 0,h=void 0,f=void 0;if(c)l=g(u),h=u.x,f=u.y;else{var p=this.points[u.index];l=p.properties,h=y(p.geometry.coordinates[0]),f=x(p.geometry.coordinates[1])}var d={type:1,geometry:[[Math.round(this.options.extent*(h*i-n)),Math.round(this.options.extent*(f*i-r))]],tags:l},m=void 0;c?m=u.id:this.options.generateId?m=u.index:this.points[u.index].id&&(m=this.points[u.index].id),void 0!==m&&(d.id=m),o.features.push(d)}},p.prototype._limitZoom=function(t){return Math.max(this.options.minZoom,Math.min(Math.floor(+t),this.options.maxZoom+1))},p.prototype._cluster=function(t,e){for(var n=[],r=this.options,i=r.radius,o=r.extent,a=r.reduce,s=r.minPoints,u=i/(o*Math.pow(2,e)),c=0;c<t.length;c++){var l=t[c];if(!(l.zoom<=e)){l.zoom=e;for(var h=this.trees[e+1],f=h.within(l.x,l.y,u),p=l.numPoints||1,m=p,v=0,g=f;v<g.length;v+=1){var y=g[v],x=h.points[y];x.zoom>e&&(m+=x.numPoints||1)}if(m>p&&m>=s){for(var b=l.x*p,_=l.y*p,w=a&&p>1?this._map(l,!0):null,S=(c<<5)+(e+1)+this.points.length,M=0,E=f;M<E.length;M+=1){var A=E[M],T=h.points[A];if(!(T.zoom<=e)){T.zoom=e;var C=T.numPoints||1;b+=T.x*C,_+=T.y*C,T.parentId=S,a&&(w||(w=this._map(l,!0)),a(w,this._map(T)))}}l.parentId=S,n.push(d(b/m,_/m,S,m,w))}else if(n.push(l),m>1)for(var O=0,k=f;O<k.length;O+=1){var P=k[O],L=h.points[P];L.zoom<=e||(L.zoom=e,n.push(L))}}}return n},p.prototype._getOriginId=function(t){return t-this.points.length>>5},p.prototype._getOriginZoom=function(t){return(t-this.points.length)%32},p.prototype._map=function(t,e){if(t.numPoints)return e?w({},t.properties):t.properties;var n=this.points[t.index].properties,r=this.options.map(n);return e&&r===n?w({},r):r},p}();const H8=W8;function Y8(t,e){var n=e.radius,r=void 0===n?40:n,i=e.maxZoom,o=void 0===i?18:i,a=e.minZoom,s=void 0===a?0:a,u=e.zoom,c=void 0===u?2:u;if(t.pointIndex){var l=t.pointIndex.getClusters(t.extent,Math.floor(c));return t.dataArray=l.map((function(t,e){return Jq({coordinates:t.geometry.coordinates,_id:e+1},t.properties)})),t}var h=new H8({radius:r,minZoom:s,maxZoom:o}),f={type:"FeatureCollection",features:[]};return f.features=t.dataArray.map((function(t){return{type:"Feature",geometry:{type:"Point",coordinates:t.coordinates},properties:Jq({},t)}})),h.load(f.features),h}function X8(t){if(0===t.length)return 0;for(var e,n=t[0],r=0,i=1;i<t.length;i++)e=n+1*t[i],Math.abs(n)>=Math.abs(t[i])?r+=n-e+t[i]:r+=t[i]-e+n,n=e;return n+1*r}var q8={min:function(t){if(0===t.length)throw new Error("min requires at least one data point");for(var e=t[0],n=1;n<t.length;n++)t[n]<e&&(e=t[n]);return e},max:function(t){if(0===t.length)throw new Error("max requires at least one data point");for(var e=t[0],n=1;n<t.length;n++)t[n]>e&&(e=t[n]);return e},mean:function(t){if(0===t.length)throw new Error("mean requires at least one data point");return X8(t)/t.length},sum:X8};function Z8(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}function $8(t,e){if(Array.isArray(e))return e}var K8=function(t){wZ(i,hc.EventEmitter);var e,n,r=Z8(i);function i(t,e){var n;return mZ(this,i),$q(SZ(n=r.call(this)),"type","source"),$q(SZ(n),"isTile",!1),$q(SZ(n),"inited",!1),$q(SZ(n),"hooks",{init:new j5}),$q(SZ(n),"parser",{type:"geojson"}),$q(SZ(n),"transforms",[]),$q(SZ(n),"cluster",!1),$q(SZ(n),"clusterOptions",{enable:!1,radius:40,maxZoom:20,zoom:-99,method:"count"}),$q(SZ(n),"invalidExtent",!1),$q(SZ(n),"dataArrayChanged",!1),$q(SZ(n),"cfg",{autoRender:!0}),n.originData=t,n.initCfg(e),n.init().then((function(){n.inited=!0,n.emit("update",{type:"inited"})})),n}return gZ(i,[{key:"getSourceCfg",value:function(){return this.cfg}},{key:"getClusters",value:function(t){return this.clusterIndex.getClusters(this.caculClusterExtent(2),t)}},{key:"getClustersLeaves",value:function(t){return this.clusterIndex.getLeaves(t,1/0)}},{key:"getParserType",value:function(){return this.parser.type}},{key:"updateClusterData",value:function(t){var e=this,n=this.clusterOptions,r=n.method,i=void 0===r?"sum":r,o=n.field,a=this.clusterIndex.getClusters(this.caculClusterExtent(2),Math.floor(t));this.clusterOptions.zoom=t,a.forEach((function(t){t.id||(t.properties.point_count=1)})),(o||hZ.isFunction(i))&&(a=a.map((function(t){var n=t.id;if(n){var r,a=e.clusterIndex.getLeaves(n,1/0).map((function(t){return t.properties}));if(hZ.isString(i)&&o){var s=function(t,e){return t.map((function(t){return 1*t[e]}))}(a,o);r=q8[i](s)}hZ.isFunction(i)&&(r=i(a)),t.properties.stat=r}else t.properties.point_count=1;return t}))),this.data=Iq("geojson")({type:"FeatureCollection",features:a}),this.executeTrans()}},{key:"getFeatureById",value:function(t){var e=this.parser,n=e.type,r=void 0===n?"geojson":n,i=e.geometry;if("geojson"!==r||this.cluster)return"json"===r&&i?this.data.dataArray.find((function(e){return e._id===t})):t<this.data.dataArray.length?this.data.dataArray[t]:"null";var o=t<this.originData.features.length?this.originData.features[t]:"null",a=hZ.cloneDeep(o);if(null!=a&&a.properties&&(0!==this.transforms.length||this.dataArrayChanged)){var s=this.data.dataArray.find((function(e){return e._id===t}));a.properties=s}return a}},{key:"updateFeaturePropertiesById",value:function(t,e){this.data.dataArray=this.data.dataArray.map((function(n){return n._id===t?Jq(Jq({},n),e):n})),this.dataArrayChanged=!0,this.emit("update",{type:"update"})}},{key:"getFeatureId",value:function(t,e){var n=this.data.dataArray.find((function(n){return n[t]===e}));return null==n?void 0:n._id}},{key:"setData",value:function(t,e){var n=this;this.originData=t,this.dataArrayChanged=!1,this.initCfg(e),this.init().then((function(){n.emit("update",{type:"update"})}))}},{key:"destroy",value:function(){var t;this.removeAllListeners(),this.originData=null,this.clusterIndex=null,this.data=null,null===(t=this.tileset)||void 0===t||t.destroy()}},{key:"processData",value:(n=RK(jK.mark((function t(){var e=this;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,new Promise((function(t,n){try{e.excuteParser(),e.initCluster(),e.executeTrans(),t({})}catch(r){n(r)}}));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)})},{key:"initCfg",value:function(t){this.cfg=hZ.mergeWith(this.cfg,t,$8);var e=this.cfg;e&&(e.parser&&(this.parser=e.parser),e.transforms&&(this.transforms=e.transforms),this.cluster=e.cluster||!1,e.clusterOptions&&(this.cluster=!0,this.clusterOptions=Jq(Jq({},this.clusterOptions),e.clusterOptions)))}},{key:"init",value:(e=RK(jK.mark((function t(){return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.inited=!1,t.next=3,this.processData();case 3:this.inited=!0;case 4:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"excuteParser",value:function(){var t=this.parser,e=t.type||"geojson",n=Iq(e);this.data=n(this.originData,t),this.tileset=this.initTileset(),t.cancelExtent||(this.extent=hK(this.data.dataArray),this.setCenter(this.extent),this.invalidExtent=this.extent[0]===this.extent[2]||this.extent[1]===this.extent[3])}},{key:"setCenter",value:function(t){this.center=[(t[0]+t[2])/2,(t[1]+t[3])/2],(isNaN(this.center[0])||isNaN(this.center[1]))&&(this.center=[108.92361111111111,34.54083333333333])}},{key:"initTileset",value:function(){var t=this.data.tilesetOptions;if(t)return this.isTile=!0,this.tileset?(this.tileset.updateOptions(t),this.tileset):new BQ(Jq({},t))}},{key:"executeTrans",value:function(){var t=this;this.transforms.forEach((function(e){var n=function(t){return Lq[t]}(e.type)(t.data,e);Object.assign(t.data,n)}))}},{key:"initCluster",value:function(){if(this.cluster){var t=this.clusterOptions||{};this.clusterIndex=Y8(this.data,t)}}},{key:"caculClusterExtent",value:function(t){var e=[[-1/0,-1/0],[1/0,1/0]];return this.invalidExtent||(e=gK(xK(this.extent),t)),e[0].concat(e[1])}}]),i}();function J8(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return Q8(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Q8(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Q8(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var t9=6378e3;var e9=Math.PI/3,n9=[0,e9,2*e9,3*e9,4*e9,5*e9];function r9(t){return t[0]}function i9(t){return t[1]}function o9(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}Nq("rasterTile",(function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(U8(t))throw new Error("tile server url is error");var n=(null==e?void 0:e.dataType)||v8.IMAGE;n===v8.RGB&&(n=v8.ARRAYBUFFER);var r=function(r,i){switch(n){case v8.IMAGE:return j8(t,r,i,e);case v8.ARRAYBUFFER:return F8(t,r,i,(null==e?void 0:e.format)||B8,null==e?void 0:e.operation);case v8.CUSTOMARRAYBUFFER:case v8.CUSTOMRGB:return P8(i,null==e?void 0:e.getCustomData,(null==e?void 0:e.format)||B8,null==e?void 0:e.operation);default:return j8(t,r,i,e)}},i=Jq(Jq(Jq({},z8),e),{},{getTileData:r});return{data:t,dataArray:[],tilesetOptions:i,isTile:!0}})),Nq("mvt",(function(t,e){var n=Array.isArray(t)?t[0]:t,r=Jq(Jq(Jq({},M0),e),{},{getTileData:function(t,r){return E0(n,t,r,null==e?void 0:e.requestParameters)}});return{data:n,dataArray:[],tilesetOptions:r,isTile:!0}})),Nq("geojsonvt",(function(t,e){var n=function(t){var e={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!0,debug:0};return void 0===t||void 0===t.geojsonvtOptions?e:Jq(Jq({},e),t.geojsonvtOptions)}(e),r=n.extent||4096,i=function(t,e){return new K0(t,e)}(t,n);return{data:t,dataArray:[],tilesetOptions:Jq(Jq(Jq({},t1),e),{},{getTileData:function(t,e){return i1(e,i,t,r)}}),isTile:!0}})),Nq("testTile",(function(t,e){return{data:t,dataArray:[],tilesetOptions:Jq(Jq(Jq({},V8),e),{},{getTileData:function(t){return G8(t)}}),isTile:!0}})),Nq("geojson",(function(t,e){var n=[],r={};return t.features?(t.features=t.features.filter((function(t){var e=t.geometry;return null!=t&&e&&e.type&&e.coordinates&&e.coordinates.length>0})),Qq(t,!0),0===t.features.length?{dataArray:[],featureKeys:r}:(uZ(t,(function(t,r){var i,o,a=(i=t,void 0===(o=null==e?void 0:e.featureId)?null:i.properties[o]?i.properties[o]:i.properties&&i.properties[o]?function(t){for(var e=t.toString(),n=5381,r=e.length;r;)n=33*n^e.charCodeAt(--r);return n>>>0}(i.properties[o]+"")%1000019:null);null===a&&(a=r);var s=a,u=oZ(t),c=Jq(Jq({},t.properties),{},{coordinates:u,_id:s});n.push(c)})),{dataArray:n,featureKeys:r})):(t.features=[],{dataArray:[]})})),Nq("image",zQ),Nq("csv",(function(t,e){return cZ(Wq(t),e)})),Nq("json",cZ),Nq("raster",(function(t,e){var n,r,i,o=e.extent,a=e.width,s=e.height,u=e.min,c=e.max,l=e.format,h=e.operation;return void 0===l||m1(t)?(n=Array.from(t),r=a,i=s):n=l1(Array.isArray(t)?t:[t],l,h),{_id:1,dataArray:[{_id:1,data:n,width:r,height:i,min:u,max:c,coordinates:[[o[0],o[1]],[o[2],o[3]]]}]}})),Nq("rasterRgb",(function(t,e){var n=e.extent,r=e.min,i=e.max,o=e.width,a=e.height,s=e.format,u=e.operation,c=v1(e,x1);return{_id:1,dataArray:[Jq(Jq({_id:1,data:void 0===s||m1(t)?Array.from(t):l1(Array.isArray(t)?t:[t],s,u),width:o,height:a},c),{},{min:r,max:i,coordinates:[[n[0],n[1]],[n[2],n[3]]]})]}}
/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */)),Dq("cluster",Y8),Dq("filter",(function(t,e){var n=e.callback;return n&&(t.dataArray=t.dataArray.filter(n)),t})),Dq("join",(function(t,e){var n=e.sourceField,r=e.targetField,i=e.data,o={};return i.forEach((function(t){o[t[n]]=t})),t.dataArray=t.dataArray.map((function(t){var e=t[r];return Jq(Jq({},t),o[e])})),t})),Dq("map",(function(t,e){var n=e.callback;return n&&(t.dataArray=t.dataArray.map(n)),t})),Dq("grid",(function(t,e){var n=t.dataArray,r=e.size,i=void 0===r?10:r,o=i/(2*Math.PI*t9)*(256<<20)/2,a=function(t,e){var n,r,i=1/0,o=-1/0,a=J8(t);try{for(a.s();!(r=a.n()).done;){n=r.value.coordinates[1],Number.isFinite(n)&&(i=n<i?n:i,o=n>o?n:o)}}catch(w){a.e(w)}finally{a.f()}var s=(u=e,c=(i+o)/2,f=u,l=f/t9*(180/Math.PI),h=function(t,e){return e/t9*(180/Math.PI)/Math.cos(t*Math.PI/180)}(c,u),{yOffset:l,xOffset:h});var u,c,l,h,f;if(s.xOffset<=0||s.yOffset<=0)return{gridHash:{},gridOffset:s};var p,d={},m=J8(t);try{for(m.s();!(p=m.n()).done;){var v=p.value,g=v.coordinates[1],y=v.coordinates[0];if(Number.isFinite(g)&&Number.isFinite(y)){var x=Math.floor((g+90)/s.yOffset),b=Math.floor((y+180)/s.xOffset),_="".concat(x,"-").concat(b);d[_]=d[_]||{count:0,points:[]},d[_].count+=1,d[_].points.push(v)}}}catch(w){m.e(w)}finally{m.f()}return{gridHash:d,gridOffset:s}}(n,i),s=function(t,e,n){return Object.keys(t).reduce((function(r,i,o){var a=i.split("-"),s=parseInt(a[0],10),u=parseInt(a[1],10),c={};if(n.field&&n.method){var l=$$(t[i].points,n.field);c[n.method]=Z$[n.method](l)}return Object.assign(c,{_id:o,coordinates:mK([e.xOffset*(u+.5)-180,e.yOffset*(s+.5)-90]),rawData:t[i].points,count:t[i].count}),r.push(c),r}),[])}(a.gridHash,a.gridOffset,e);return{yOffset:o,xOffset:o,radius:o,type:"grid",dataArray:s}})),Dq("hexagon",(function(t,e){var n=t.dataArray,r=e.size,i=void 0===r?10:r,o=e.method,a=void 0===o?"sum":o,s=i/(2*Math.PI*6378e3)*(256<<20)/2,u=n.map((function(t){var e=lZ(mK(t.coordinates),2),n=e[0],r=e[1];return Jq(Jq({},t),{},{coordinates:[n,r]})})),c=function(){var t,e,n,r=0,i=0,o=1,a=1,s=r9,u=i9;function c(t){var r,i={},o=[],a=t.length;for(r=0;r<a;++r)if(!isNaN(l=+s.call(null,c=t[r],r,t))&&!isNaN(h=+u.call(null,c,r,t))){var c,l,h,f=Math.round(h/=n),p=Math.round(l=l/e-(1&f)/2),d=h-f;if(3*Math.abs(d)>1){var m=l-p,v=p+(l<p?-1:1)/2,g=f+(h<f?-1:1),y=l-v,x=h-g;m*m+d*d>y*y+x*x&&(p=v+(1&f?1:-1)/2,f=g)}var b=p+"-"+f,_=i[b];_?_.push(c):(o.push(_=i[b]=[c]),_.x=(p+(1&f)/2)*e,_.y=f*n)}return o}function l(t){var e=0,n=0;return n9.map((function(r){var i=Math.sin(r)*t,o=-Math.cos(r)*t,a=i-e,s=o-n;return e=i,n=o,[a,s]}))}return c.hexagon=function(e){return"m"+l(null==e?t:+e).join("l")+"z"},c.centers=function(){for(var s=[],u=Math.round(i/n),c=Math.round(r/e),l=u*n;l<a+t;l+=n,++u)for(var h=c*e+(1&u)*e/2;h<o+e/2;h+=e)s.push([h,l]);return s},c.mesh=function(){var e=l(t).slice(0,4).join("l");return c.centers().map((function(t){return"M"+t+"m"+e})).join("")},c.x=function(t){return arguments.length?(s=t,c):s},c.y=function(t){return arguments.length?(u=t,c):u},c.radius=function(r){return arguments.length?(e=2*(t=+r)*Math.sin(e9),n=1.5*t,c):t},c.size=function(t){return arguments.length?(r=i=0,o=+t[0],a=+t[1],c):[o-r,a-i]},c.extent=function(t){return arguments.length?(r=+t[0][0],i=+t[0][1],o=+t[1][0],a=+t[1][1],c):[[r,i],[o,a]]},c.radius(1)}().radius(s).x((function(t){return t.coordinates[0]})).y((function(t){return t.coordinates[1]})),l={dataArray:c(u).map((function(t,n){var r;if(e.field&&a){var i=$$(t,e.field);t[a]=Z$[a](i)}return $q(r={},e.method,t[a]),$q(r,"count",t.length),$q(r,"rawData",t),$q(r,"coordinates",[t.x,t.y]),$q(r,"_id",n),r})),radius:s,xOffset:s,yOffset:s,type:"hexagon"};return l})),window._iconfont_svg_string_3580659='<svg><symbol id="l7-icon-area1" viewBox="0 0 1024 1024"><path d="M796.444444 56.888889a113.777778 113.777778 0 0 1 43.064889 219.136l38.798223 466.261333a113.777778 113.777778 0 1 1-133.518223 145.237334H279.210667a113.777778 113.777778 0 1 1-60.302223-137.272889L697.856 227.555556A113.777778 113.777778 0 0 1 796.444444 56.888889z m56.888889 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-682.666666 0a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m577.592889-534.072889L269.198222 796.444444c4.152889 7.168 7.509333 14.791111 10.012445 22.812445h465.578666a114.119111 114.119111 0 0 1 65.479111-71.224889l-38.798222-466.261333a112.924444 112.924444 0 0 1-23.210666-7.964445zM796.444444 125.155556a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-area" viewBox="0 0 1024 1024"><path d="M796.444444 56.888889a113.777778 113.777778 0 0 1 43.008 219.136l38.855112 466.261333a113.777778 113.777778 0 0 1-16.497778 224.540445L853.333333 967.111111a113.777778 113.777778 0 0 1-108.544-79.644444H279.210667a113.834667 113.834667 0 0 1-100.067556 79.36L170.666667 967.111111a113.777778 113.777778 0 0 1-17.066667-226.304l30.492444-351.175111a113.777778 113.777778 0 0 1 34.986667-218.680889L227.555556 170.666667a113.777778 113.777778 0 0 1 99.896888 59.221333l355.84-71.395556a113.777778 113.777778 0 0 1 104.675556-101.262222L796.444444 56.888889z m56.888889 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-682.666666 0a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m526.051555-582.314666L340.650667 296.903111a113.891556 113.891556 0 0 1-88.462223 98.645333l-30.947555 355.84c27.477333 13.653333 48.64 38.115556 58.026667 67.754667h465.521777a114.119111 114.119111 0 0 1 65.536-71.168l-38.855111-466.261333a113.948444 113.948444 0 0 1-74.752-56.206222zM227.555556 238.933333a45.511111 45.511111 0 1 0 0 91.022223 45.511111 45.511111 0 0 0 0-91.022223z m568.888888-113.777777a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-delete" viewBox="0 0 1024 1024"><path d="M705.422222 85.333333a34.133333 34.133333 0 0 1 34.133334 34.133334V227.555556h136.533333a34.133333 34.133333 0 0 1 0 68.266666h-25.543111l-24.348445 610.076445a34.133333 34.133333 0 0 1-34.133333 32.768H231.936a34.133333 34.133333 0 0 1-34.076444-32.768L173.340444 295.822222H147.911111a34.133333 34.133333 0 1 1 0-68.266666H284.444444V119.466667a34.133333 34.133333 0 0 1 34.133334-34.133334h386.844444zM241.720889 295.822222l22.983111 574.577778h494.535111l23.04-574.577778H241.720889zM671.288889 153.6H352.711111V227.555556h318.577778V153.6z"  ></path></symbol><symbol id="l7-icon-color" viewBox="0 0 1024 1024"><path d="M512 56.888889c9.841778 0 19.626667 0.341333 29.354667 0.910222 69.176889 4.437333 119.068444 62.577778 124.302222 131.072l0.455111 9.386667c0.739556 44.600889 15.303111 84.935111 44.999111 114.631111 27.022222 27.022222 62.805333 41.528889 102.570667 44.430222l12.060444 0.568889c72.476444 1.194667 135.793778 52.451556 140.458667 124.757333 1.137778 18.261333 1.251556 36.807111 0.170667 55.637334-13.198222 233.585778-211.399111 424.220444-445.326223 428.714666L512 967.111111a455.111111 455.111111 0 0 1-455.054222-464.156444c4.551111-233.927111 195.185778-432.128 428.771555-445.326223C494.535111 57.116444 503.296 56.888889 512 56.888889z m0 68.266667a385.706667 385.706667 0 0 0-22.414222 0.625777C291.726222 136.988444 129.080889 305.948444 125.155556 504.263111c-4.152889 212.366222 163.100444 387.185778 372.508444 394.353778l13.425778 0.227555 8.533333-0.113777c198.371556-3.811556 367.331556-166.456889 378.538667-364.373334a396.174222 396.174222 0 0 0-0.170667-47.331555c-1.991111-31.232-29.127111-56.604444-67.128889-60.472889l-8.248889-0.455111-14.051555-0.682667c-56.547556-4.209778-107.406222-25.884444-145.806222-64.284444-38.855111-38.798222-60.416-90.225778-64.284445-145.749334l-0.910222-21.333333c-2.901333-38.001778-28.785778-66.048-60.302222-68.096A433.891556 433.891556 0 0 0 512 125.155556zM438.044444 682.666667a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z m-170.666666-227.555556a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z m142.222222-227.555555a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z"  ></path></symbol><symbol id="l7-icon-base-map" viewBox="0 0 1024 1024"><path d="M923.761778 115.029333A34.133333 34.133333 0 0 1 967.111111 147.911111v624.128a34.133333 34.133333 0 0 1-22.186667 32.028445l-278.755555 103.992888a34.133333 34.133333 0 0 1-23.665778 0.056889L381.724444 812.714667a34.133333 34.133333 0 0 0-23.665777 0.113777L102.968889 908.060444a34.133333 34.133333 0 0 1-45.738667-26.965333L56.888889 876.088889V251.960889a34.133333 34.133333 0 0 1 22.186667-32.028445l278.755555-103.992888a34.133333 34.133333 0 0 1 20.992-0.967112l266.183111 72.988445a34.133333 34.133333 0 0 0 18.204445 0zM403.911111 192.625778v555.576889l216.177778 79.075555V251.960889l-216.177778-59.335111z m-68.266667 4.380444L125.155556 275.569778v551.310222l210.432-78.506667V197.006222zM898.844444 192.853333l-210.545777 58.936889v575.089778l210.545777-78.563556V192.853333z"  ></path></symbol><symbol id="l7-icon-dot" viewBox="0 0 1024 1024"><path d="M341.333333 739.555556a113.777778 113.777778 0 0 1 8.533334 227.271111L341.333333 967.111111a113.777778 113.777778 0 0 1-8.533333-227.271111L341.333333 739.555556z m0 68.266666a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM910.222222 341.333333a113.777778 113.777778 0 0 1 8.533334 227.271111L910.222222 568.888889a113.777778 113.777778 0 0 1-8.533333-227.271111L910.222222 341.333333z m0 68.266667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM227.555556 56.888889a113.777778 113.777778 0 0 1 8.533333 227.271111L227.555556 284.444444a113.777778 113.777778 0 0 1-8.533334-227.271111L227.555556 56.888889z m0 68.266667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-display" viewBox="0 0 1024 1024"><path d="M512 170.666667c284.444444 0 455.111111 227.555556 455.111111 341.333333s-170.666667 341.333333-455.111111 341.333333-455.111111-227.555556-455.111111-341.333333 170.666667-341.333333 455.111111-341.333333z m0 68.266666C303.729778 238.933333 125.155556 401.237333 125.155556 512c0 110.762667 178.574222 273.066667 386.844444 273.066667s386.844444-162.304 386.844444-273.066667c0-110.762667-178.574222-273.066667-386.844444-273.066667zM512 341.333333a170.666667 170.666667 0 1 1 0 341.333334 170.666667 170.666667 0 0 1 0-341.333334z m0 68.266667a102.4 102.4 0 1 0 0 204.8 102.4 102.4 0 0 0 0-204.8z"  ></path></symbol><symbol id="l7-icon-enlarge" viewBox="0 0 1024 1024"><path d="M546.133333 147.911111l-0.056889 329.955556H876.088889a34.133333 34.133333 0 0 1 0 68.266666H546.076444v329.955556a34.133333 34.133333 0 0 1-68.266666 0V546.133333H147.911111a34.133333 34.133333 0 1 1 0-68.266666h329.898667V147.911111a34.133333 34.133333 0 0 1 68.266666 0z"  ></path></symbol><symbol id="l7-icon-export-picture" viewBox="0 0 1024 1024"><path d="M883.873684 161.684211a32.336842 32.336842 0 0 1 32.336842 32.336842v582.063158a32.336842 32.336842 0 0 1-32.336842 32.336842H86.231579a32.336842 32.336842 0 0 1-32.336842-32.336842V194.021053a32.336842 32.336842 0 0 1 32.336842-32.336842h797.642105z m-32.336842 64.673684H118.568421v517.389473h170.792421a32.175158 32.175158 0 0 1 0.431158-0.646736l3.772632-4.473264 330.320842-330.374736a32.336842 32.336842 0 0 1 38.588631-5.389474l4.473263 3.018105 184.589474 147.725474V226.357895z m-202.428631 248.131368L379.850105 743.747368H851.536842v-107.304421l-202.428631-161.953684zM323.368421 323.368421a107.789474 107.789474 0 1 1 0 215.578947 107.789474 107.789474 0 0 1 0-215.578947z m0 64.673684a43.115789 43.115789 0 1 0 0 86.231579 43.115789 43.115789 0 0 0 0-86.231579z"  ></path></symbol><symbol id="l7-icon-exit-fullscreen" viewBox="0 0 1024 1024"><path d="M841.955556 591.644444a34.133333 34.133333 0 0 1 5.518222 67.811556l-5.518222 0.455111h-133.745778l192 192.056889a34.133333 34.133333 0 0 1-38.343111 55.182222l-5.176889-2.958222-4.721778-3.982222L659.911111 708.266667V841.955556a34.133333 34.133333 0 0 1-28.615111 33.678222L625.777778 876.088889a34.133333 34.133333 0 0 1-33.678222-28.615111L591.644444 841.955556V625.777778a34.133333 34.133333 0 0 1 28.615112-33.678222L625.777778 591.644444h216.177778z m-443.733334 0a34.133333 34.133333 0 0 1 33.678222 28.615112L432.355556 625.777778v216.177778a34.133333 34.133333 0 0 1-67.811556 5.518222L364.088889 841.955556v-133.745778l-192.056889 192a34.133333 34.133333 0 0 1-52.224-43.52l3.982222-4.721778L315.847111 659.911111H182.044444a34.133333 34.133333 0 0 1-33.678222-28.615111L147.911111 625.777778a34.133333 34.133333 0 0 1 28.615111-33.678222L182.044444 591.644444H398.222222zM167.310222 119.808l4.721778 3.982222L364.088889 315.847111V182.044444a34.133333 34.133333 0 0 1 28.615111-33.678222L398.222222 147.911111a34.133333 34.133333 0 0 1 33.678222 28.615111L432.355556 182.044444V398.222222a34.133333 34.133333 0 0 1-28.615112 33.678222L398.222222 432.355556H182.044444a34.133333 34.133333 0 0 1-5.518222-67.811556L182.044444 364.088889h133.802667L123.790222 172.032a34.133333 34.133333 0 0 1 43.52-52.224z m732.899556 3.982222a34.133333 34.133333 0 0 1 3.982222 43.52l-3.982222 4.721778L708.266667 364.088889H841.955556a34.133333 34.133333 0 0 1 33.678222 28.615111L876.088889 398.222222a34.133333 34.133333 0 0 1-28.615111 33.678222L841.955556 432.355556H625.777778a34.133333 34.133333 0 0 1-33.678222-28.615112L591.644444 398.222222V182.044444a34.133333 34.133333 0 0 1 67.811556-5.518222l0.455111 5.518222v133.802667l192.056889-192.056889a34.133333 34.133333 0 0 1 48.241778 0z"  ></path></symbol><symbol id="l7-icon-line" viewBox="0 0 1024 1024"><path d="M853.333333 56.888889a113.777778 113.777778 0 0 1 8.533334 227.271111L853.333333 284.444444c-19.000889 0-36.864-4.664889-52.622222-12.856888l-529.123555 529.066666a113.777778 113.777778 0 0 1-92.387556 166.115556L170.666667 967.111111a113.777778 113.777778 0 0 1-8.533334-227.271111L170.666667 739.555556c19.000889 0 36.864 4.664889 52.622222 12.856888l529.123555-529.066666a113.777778 113.777778 0 0 1 92.387556-166.115556L853.333333 56.888889zM170.666667 807.822222a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m682.666666-682.666666a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-layer" viewBox="0 0 1024 1024"><path d="M767.089778 625.777778l180.167111 82.773333a34.133333 34.133333 0 0 1 4.892444 59.278222l-4.892444 2.730667-420.977778 193.422222a34.133333 34.133333 0 0 1-22.983111 1.991111l-5.575111-1.991111-420.977778-193.422222a34.133333 34.133333 0 0 1-4.892444-59.278222l4.892444-2.730667L256.853333 625.777778l81.749334 37.546666L172.771556 739.555556 512 895.374222 851.171556 739.555556l-165.831112-76.231112 81.749334-37.546666z m0-227.555556l180.167111 82.773334a34.133333 34.133333 0 0 1 4.892444 59.278222l-4.892444 2.730666-420.977778 193.422223a34.133333 34.133333 0 0 1-22.983111 1.991111l-5.575111-1.991111-420.977778-193.422223a34.133333 34.133333 0 0 1-4.892444-59.278222l4.892444-2.730666L256.853333 398.222222l81.749334 37.546667-165.831111 76.174222L512 667.818667l339.171556-155.875556-165.831112-76.174222L767.089778 398.222222zM497.720889 60.017778a34.133333 34.133333 0 0 1 28.558222 0l420.977778 193.422222a34.133333 34.133333 0 0 1 0 62.008889l-420.977778 193.422222a34.133333 34.133333 0 0 1-28.558222 0l-420.977778-193.422222a34.133333 34.133333 0 0 1 0-62.008889zM512 128.568889L172.771556 284.387556 512 440.263111l339.171556-155.875555L512 128.568889z"  ></path></symbol><symbol id="l7-icon-narrow" viewBox="0 0 1024 1024"><path d="M910.222222 512a34.133333 34.133333 0 0 1-34.133333 34.133333H147.911111a34.133333 34.133333 0 1 1 0-68.266666h728.177778a34.133333 34.133333 0 0 1 34.133333 34.133333z"  ></path></symbol><symbol id="l7-icon-fullscreen" viewBox="0 0 1024 1024"><path d="M645.176889 597.674667l4.721778 3.982222L841.955556 793.6l0.056888-133.688889a34.133333 34.133333 0 0 1 28.615112-33.678222L876.088889 625.777778a34.133333 34.133333 0 0 1 33.678222 28.615111L910.222222 659.911111v216.177778a34.133333 34.133333 0 0 1-28.615111 33.678222L876.088889 910.222222h-216.177778a34.133333 34.133333 0 0 1-5.518222-67.811555l5.518222-0.455111h133.745778l-192-192.056889a34.133333 34.133333 0 0 1 43.52-52.224z m-222.833778 3.982222a34.133333 34.133333 0 0 1 3.982222 43.52l-3.982222 4.721778L230.286222 841.955556H364.088889a34.133333 34.133333 0 0 1 33.678222 28.615111L398.222222 876.088889a34.133333 34.133333 0 0 1-28.615111 33.678222L364.088889 910.222222H147.911111a34.133333 34.133333 0 0 1-33.678222-28.615111L113.777778 876.088889v-216.177778a34.133333 34.133333 0 0 1 67.811555-5.518222l0.455111 5.518222-0.056888 133.745778 192.113777-192a34.133333 34.133333 0 0 1 48.241778 0zM364.088889 113.777778a34.133333 34.133333 0 0 1 5.518222 67.811555L364.088889 182.044444H230.343111l192 192.056889a34.133333 34.133333 0 0 1-43.52 52.224l-4.721778-3.982222-192.113777-192.056889L182.044444 364.088889a34.133333 34.133333 0 0 1-28.615111 33.678222L147.911111 398.222222a34.133333 34.133333 0 0 1-33.678222-28.615111L113.777778 364.088889V147.911111a34.133333 34.133333 0 0 1 28.615111-33.678222L147.911111 113.777778h216.177778z m512 0a34.133333 34.133333 0 0 1 33.678222 28.615111L910.222222 147.911111v216.177778a34.133333 34.133333 0 0 1-67.811555 5.518222L841.955556 364.088889l-0.056889-133.745778-192 192a34.133333 34.133333 0 0 1-52.224-43.52l3.982222-4.721778L793.6 182.044444H659.911111a34.133333 34.133333 0 0 1-33.678222-28.615111L625.777778 147.911111a34.133333 34.133333 0 0 1 28.615111-33.678222L659.911111 113.777778h216.177778z"  ></path></symbol><symbol id="l7-icon-hide" viewBox="0 0 1024 1024"><path d="M875.52 87.836444a34.133333 34.133333 0 0 1 7.281778 43.121778l-3.527111 5.006222-682.666667 796.444445a34.133333 34.133333 0 0 1-55.409778-39.367111l3.527111-5.006222 97.166223-113.379556C123.164444 697.969778 56.888889 582.940444 56.888889 512c0-113.777778 170.666667-341.333333 455.111111-341.333333a496.64 496.64 0 0 1 208.952889 45.112889l106.439111-124.188445a34.133333 34.133333 0 0 1 48.128-3.754667z m-38.684444 202.524445C921.031111 362.951111 967.111111 452.835556 967.111111 512c0 113.777778-170.666667 341.333333-455.111111 341.333333-50.631111 0-97.678222-7.224889-140.8-19.740444l50.232889-58.595556A417.393778 417.393778 0 0 0 512 785.066667c208.270222 0 386.844444-162.304 386.844444-273.066667 0-52.849778-40.675556-117.418667-105.813333-170.496l43.804445-51.2zM512 238.933333C303.729778 238.933333 125.155556 401.237333 125.155556 512c0 66.787556 64.853333 152.291556 162.133333 209.692444L377.173333 616.675556a170.666667 170.666667 0 0 1 217.713778-253.895112l78.620445-91.704888A432.924444 432.924444 0 0 0 512 238.933333z m166.684444 236.088889a170.666667 170.666667 0 0 1-177.664 207.303111l177.607112-207.303111zM512 409.6a102.4 102.4 0 0 0-88.746667 153.486222L548.864 416.426667A102.172444 102.172444 0 0 0 512 409.6z"  ></path></symbol><symbol id="l7-icon-rectangle" viewBox="0 0 1024 1024"><path d="M170.666667 56.888889a113.777778 113.777778 0 0 1 108.544 79.644444H853.333333a34.133333 34.133333 0 0 1 33.678223 28.615111L887.466667 170.666667v574.122666a113.777778 113.777778 0 1 1-142.677334 142.734223L170.666667 887.466667a34.133333 34.133333 0 0 1-33.678223-28.615111L136.533333 853.333333V279.210667A113.777778 113.777778 0 0 1 170.666667 56.888889z m682.666666 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-34.133333-603.022222H279.210667a114.062222 114.062222 0 0 1-74.353778 74.410667L204.8 819.2h539.989333a114.062222 114.062222 0 0 1 74.410667-74.410667V204.8zM170.666667 125.155556a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-ranging" viewBox="0 0 1024 1024"><path d="M723.171556 50.403556l250.424888 250.424888a31.061333 31.061333 0 0 1 0 43.918223L344.746667 973.596444a31.061333 31.061333 0 0 1-43.918223 0L50.403556 723.171556a31.061333 31.061333 0 0 1 0-43.918223L679.253333 50.403556a31.061333 31.061333 0 0 1 43.918223 0z m-21.959112 74.524444l-39.765333 39.822222 98.986667 98.872889a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-63.886222 63.886222 62.179556 62.122667a34.133333 34.133333 0 0 1-44.088889 51.882667L563.2 387.242667 501.077333 325.063111 437.191111 388.949333l98.986667 98.929778a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-63.886222 63.886222L387.242667 563.2a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.584-62.122667-62.179556-63.886222 63.886222 98.986667 98.929778a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-39.765333 39.822222 197.802667 197.745778 576.284444-576.284444-197.802667-197.745778z"  ></path></symbol><symbol id="l7-icon-reposition" viewBox="0 0 1024 1024"><path d="M512 56.888889a34.133333 34.133333 0 0 1 34.133333 34.133333v24.177778A398.336 398.336 0 0 1 908.856889 477.866667h24.177778a34.133333 34.133333 0 0 1 0 68.266666h-24.177778A398.336 398.336 0 0 1 546.133333 908.856889L546.133333 932.977778a34.133333 34.133333 0 0 1-68.266666 0v-24.177778A398.336 398.336 0 0 1 115.2 546.133333L91.022222 546.133333a34.133333 34.133333 0 1 1 0-68.266666h24.177778A398.336 398.336 0 0 1 477.866667 115.2V91.022222A34.133333 34.133333 0 0 1 512 56.888889z m34.190222 126.862222L546.133333 193.422222a34.133333 34.133333 0 1 1-68.266666 0v-9.671111A330.069333 330.069333 0 0 0 183.751111 477.866667h9.671111a34.133333 34.133333 0 1 1 0 68.266666l-9.671111 0.056889A330.069333 330.069333 0 0 0 477.866667 840.248889V830.577778a34.133333 34.133333 0 0 1 68.266666 0l0.056889 9.671111A330.069333 330.069333 0 0 0 840.248889 546.133333L830.577778 546.133333a34.133333 34.133333 0 0 1 0-68.266666h9.671111A330.069333 330.069333 0 0 0 546.133333 183.751111zM512 341.333333a170.666667 170.666667 0 1 1 0 341.333334 170.666667 170.666667 0 0 1 0-341.333334z m0 68.266667a102.4 102.4 0 1 0 0 204.8 102.4 102.4 0 0 0 0-204.8z"  ></path></symbol><symbol id="l7-icon-round" viewBox="0 0 1024 1024"><path d="M512 56.888889a455.111111 455.111111 0 0 1 391.395556 687.502222 113.777778 113.777778 0 0 1-159.061334 158.890667A455.111111 455.111111 0 0 1 120.604444 279.608889 113.777778 113.777778 0 0 1 279.608889 120.604444 452.835556 452.835556 0 0 1 512 56.888889z m0 68.266667a384.910222 384.910222 0 0 0-191.715556 50.744888A113.777778 113.777778 0 0 1 175.957333 320.284444a386.844444 386.844444 0 0 0 527.815111 527.758223 113.777778 113.777778 0 0 1 144.270223-144.440889A386.844444 386.844444 0 0 0 512 125.155556z m299.406222 640.739555a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM212.593778 167.082667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-guanbi" viewBox="0 0 1024 1024"><path d="M576 512l277.333333 277.333333-64 64-277.333333-277.333333L234.666667 853.333333 170.666667 789.333333l277.333333-277.333333L170.666667 234.666667 234.666667 170.666667l277.333333 277.333333L789.333333 170.666667 853.333333 234.666667 576 512z"  ></path></symbol></svg>',function(t){try{let c=function(){s||(s=!0,o())},l=function(){try{a.documentElement.doScroll("left")}catch(t){return void setTimeout(l,50)}c()};var e,n=(e=(e=document.getElementsByTagName("script"))[e.length-1]).getAttribute("data-injectcss");if(!(e=e.getAttribute("data-disable-injectsvg"))){var r,i,o,a,s;if(n&&!t.__iconfont__svg__cssinject__){t.__iconfont__svg__cssinject__=!0;try{document.write("<style>.svgfont {display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;}</style>")}catch(u){console}}r=function(){var e,n=document.createElement("div");n.innerHTML=t._iconfont_svg_string_3580659,(n=n.getElementsByTagName("svg")[0])&&(n.setAttribute("aria-hidden","true"),n.style.position="absolute",n.style.width=0,n.style.height=0,n.style.overflow="hidden",(e=document.body).firstChild?function(t,e){e.parentNode.insertBefore(t,e)}(n,e.firstChild):e.appendChild(n))},document.addEventListener?~["complete","loaded","interactive"].indexOf(document.readyState)?setTimeout(r,0):(i=function(){document.removeEventListener("DOMContentLoaded",i,!1),r()},document.addEventListener("DOMContentLoaded",i,!1)):document.attachEvent&&(o=r,a=t.document,s=!1,l(),a.onreadystatechange=function(){"complete"==a.readyState&&(a.onreadystatechange=null,c())})}}catch(c){}}(window);var a9=function(t){wZ(n,fc);var e=o9(n);function n(t){var r;return mZ(this,n),r=e.call(this),n.controlCount++,r.controlOption=Jq(Jq({},r.getDefault(t)),t||{}),r}return gZ(n,[{key:"getOptions",value:function(){return this.controlOption}},{key:"setOptions",value:function(t){var e=this.getDefault(t);Object.entries(t).forEach((function(n){var r=lZ(n,2),i=r[0];void 0===r[1]&&(t[i]=e[i])})),"position"in t&&this.setPosition(t.position),"className"in t&&this.setClassName(t.className),"style"in t&&this.setStyle(t.style),this.controlOption=Jq(Jq({},this.controlOption),t)}},{key:"addTo",value:function(t){this.mapsService=t.get(J2.IMapService),this.renderService=t.get(J2.IRendererService),this.layerService=t.get(J2.ILayerService),this.controlService=t.get(J2.IControlService),this.configService=t.get(J2.IGlobalConfigService),this.scene=t.get(J2.ISceneService),this.sceneContainer=t,this.isShow=!0,this.container=this.onAdd(),V$(this.container,"l7-control");var e=this.controlOption,n=e.className,r=e.style;return n&&this.setClassName(n),r&&this.setStyle(r),this.insertContainer(),this.emit("add",this),this}},{key:"remove",value:function(){if(!this.mapsService)return this;U$(this.container),this.onRemove(),this.emit("remove",this)}},{key:"onAdd",value:function(){return z$("div")}},{key:"onRemove",value:function(){}},{key:"show",value:function(){G$(this.container,"l7-control--hide"),this.isShow=!0,this.emit("show",this)}},{key:"hide",value:function(){V$(this.container,"l7-control--hide"),this.isShow=!1,this.emit("hide",this)}},{key:"getDefault",value:function(t){return{position:x3.TOPRIGHT,name:"".concat(n.controlCount)}}},{key:"getContainer",value:function(){return this.container}},{key:"getIsShow",value:function(){return this.isShow}},{key:"_refocusOnMap",value:function(t){if(this.mapsService&&t&&t.screenX>0&&t.screenY>0){var e=this.mapsService.getContainer();null!==e&&e.focus()}}},{key:"setPosition",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x3.TOPLEFT,e=this.controlService;return e&&e.removeControl(this),this.controlOption.position=t,e&&e.addControl(this,this.sceneContainer),this}},{key:"setClassName",value:function(t){var e=this.container,n=this.controlOption.className;n&&G$(e,n),t&&V$(e,t)}},{key:"setStyle",value:function(t){var e=this.container;t?e.setAttribute("style",t):e.removeAttribute("style")}},{key:"insertContainer",value:function(){var t=this.controlOption.position,e=this.container;if(t instanceof Element)t.appendChild(e);else{var n=this.controlService.controlCorners[t];-1!==t.indexOf("bottom")?n.insertBefore(e,n.firstChild):n.appendChild(e)}}},{key:"checkUpdateOption",value:function(t,e){return e.some((function(e){return e in t}))}}]),n}();function s9(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}$q(a9,"controlCount",0);var u9,c9,l9=function(t){wZ(n,hc.EventEmitter);var e=s9(n);function n(t,r){var i;return mZ(this,n),$q(SZ(i=e.call(this)),"isShow",!1),$q(SZ(i),"timeout",null),$q(SZ(i),"show",(function(){return i.isShow||!i.contentDOM.innerHTML||(i.resetPopperPosition(),G$(i.popperDOM,"l7-popper-hide"),i.isShow=!0,i.option.unique&&n.conflictPopperList.forEach((function(t){t!==SZ(i)&&t.isShow&&t.hide()})),i.emit("show")),SZ(i)})),$q(SZ(i),"hide",(function(){return i.isShow?(V$(i.popperDOM,"l7-popper-hide"),i.isShow=!1,i.emit("hide"),SZ(i)):SZ(i)})),$q(SZ(i),"setHideTimeout",(function(){i.timeout||(i.timeout=window.setTimeout((function(){i.isShow&&(i.hide(),i.timeout=null)}),300))})),$q(SZ(i),"clearHideTimeout",(function(){i.timeout&&(window.clearTimeout(i.timeout),i.timeout=null)})),$q(SZ(i),"onBtnClick",(function(){i.isShow?i.hide():i.show()})),$q(SZ(i),"onBtnMouseLeave",(function(){i.setHideTimeout()})),$q(SZ(i),"onBtnMouseMove",(function(){i.clearHideTimeout(),i.isShow||i.show()})),i.button=t,i.option=r,i.init(),r.unique&&n.conflictPopperList.push(SZ(i)),i}return gZ(n,[{key:"buttonRect",get:function(){return this.button.getBoundingClientRect()}},{key:"getPopperDOM",value:function(){return this.popperDOM}},{key:"getIsShow",value:function(){return this.isShow}},{key:"getContent",value:function(){return this.content}},{key:"setContent",value:function(t){"string"==typeof t?this.contentDOM.innerHTML=t:t instanceof HTMLElement&&(X$(this.contentDOM),this.contentDOM.appendChild(t)),this.content=t}},{key:"init",value:function(){var t=this.option.trigger;this.popperDOM=this.createPopper(),"click"===t?this.button.addEventListener("click",this.onBtnClick):(this.button.addEventListener("mousemove",this.onBtnMouseMove),this.button.addEventListener("mouseleave",this.onBtnMouseLeave),this.popperDOM.addEventListener("mousemove",this.onBtnMouseMove),this.popperDOM.addEventListener("mouseleave",this.onBtnMouseLeave))}},{key:"destroy",value:function(){this.button.removeEventListener("click",this.onBtnClick),this.button.removeEventListener("mousemove",this.onBtnMouseMove),this.button.removeEventListener("mousemove",this.onBtnMouseLeave),this.popperDOM.removeEventListener("mousemove",this.onBtnMouseMove),this.popperDOM.removeEventListener("mouseleave",this.onBtnMouseLeave),U$(this.popperDOM)}},{key:"resetPopperPosition",value:function(){var t,e,n={},r=this.option,i=r.container,o=r.offset,a=void 0===o?[0,0]:o,s=r.placement,u=lZ(a,2),c=u[0],l=u[1],h=this.button.getBoundingClientRect(),f=i.getBoundingClientRect(),p=(e=f,{left:(t=h).left-e.left,top:t.top-e.top,right:e.left+e.width-t.left-t.width,bottom:e.top+e.height-t.top-t.height}),d=p.left,m=p.right,v=p.top,g=p.bottom,y=!1,x=!1;/^(left|right)/.test(s)?(s.includes("left")?n.right="".concat(h.width+m,"px"):s.includes("right")&&(n.left="".concat(h.width+d,"px")),s.includes("start")?n.top="".concat(v,"px"):s.includes("end")?n.bottom="".concat(g,"px"):(n.top="".concat(v+h.height/2,"px"),x=!0,n.transform="translate(".concat(c,"px, calc(").concat(l,"px - 50%))"))):/^(top|bottom)/.test(s)&&(s.includes("top")?n.bottom="".concat(h.height+g,"px"):s.includes("bottom")&&(n.top="".concat(h.height+v,"px")),s.includes("start")?n.left="".concat(d,"px"):s.includes("end")?n.right="".concat(m,"px"):(n.left="".concat(d+h.width/2,"px"),y=!0,n.transform="translate(calc(".concat(c,"px - 50%), ").concat(l,"px)"))),n.transform="translate(calc(".concat(c,"px - ").concat(y?"50%":"0%","), calc(").concat(l,"px - ").concat(x?"50%":"0%",")");var b,_,w=s.split("-");w.length&&V$(this.popperDOM,w.map((function(t){return"l7-popper-".concat(t)})).join(" ")),b=this.popperDOM,_=function(t){return Object.entries(t).map((function(t){var e=lZ(t,2),n=e[0],r=e[1];return"".concat(n,": ").concat(r)})).join(";")}(n),b.setAttribute("style","".concat(b.style.cssText).concat(_))}},{key:"createPopper",value:function(){var t=this.option,e=t.container,n=t.className,r=void 0===n?"":n,i=t.content,o=z$("div","l7-popper l7-popper-hide ".concat(r)),a=z$("div","l7-popper-content"),s=z$("div","l7-popper-arrow");return o.appendChild(a),o.appendChild(s),e.appendChild(o),this.popperDOM=o,this.contentDOM=a,i&&this.setContent(i),o}}]),n}();function h9(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}$q(l9,"conflictPopperList",[]),(c9=u9||(u9={})).ActiveOptionClassName="l7-select-control-item-active",c9.OptionValueAttrKey="data-option-value",c9.OptionIndexAttrKey="data-option-index";var f9=function(t){wZ(n,a9);var e=h9(n);function n(){return mZ(this,n),e.apply(this,arguments)}return gZ(n,[{key:"getDefault",value:function(){return{position:x3.BOTTOMLEFT,name:"logo",href:"https://l7.antv.antgroup.com/",img:"https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*GRb1TKp4HcMAAAAAAAAAAAAAARQnAQ"}}},{key:"onAdd",value:function(){var t=z$("div","l7-control-logo");return this.setLogoContent(t),t}},{key:"onRemove",value:function(){return null}},{key:"setOptions",value:function(t){G6(EZ(n.prototype),"setOptions",this).call(this,t),this.checkUpdateOption(t,["img","href"])&&(X$(this.container),this.setLogoContent(this.container))}},{key:"setLogoContent",value:function(t){var e=this.controlOption,n=e.href,r=e.img,i=z$("img");if(i.setAttribute("src",r),i.setAttribute("aria-label","AntV logo"),i.setAttribute("draggable","false"),n){var o=z$("a","l7-control-logo-link");o.target="_blank",o.href=n,o.rel="noopener nofollow",o.setAttribute("rel","noopener nofollow"),o.appendChild(i),t.appendChild(o)}else t.appendChild(i)}}]),n}();function p9(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return d9(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d9(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function d9(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var m9,v9=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],g9=function(){if("undefined"==typeof document)return!1;var t,e=v9[0],n={},r=p9(v9);try{for(r.s();!(t=r.n()).done;){var i=t.value;if((null==i?void 0:i[1])in document){var o,a=p9(i.entries());try{for(a.s();!(o=a.n()).done;){var s=lZ(o.value,2),u=s[0],c=s[1];n[e[u]]=c}}catch(l){a.e(l)}finally{a.f()}return n}}}catch(l){r.e(l)}finally{r.f()}return!1}(),y9={change:g9.fullscreenchange,error:g9.fullscreenerror},x9={request:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.documentElement,e=arguments.length>1?arguments[1]:void 0;return new Promise((function(n,r){var i=function t(){x9.off("change",t),n()};x9.on("change",i);var o=t[g9.requestFullscreen](e);o instanceof Promise&&o.then(i).catch(r)}))},exit:function(){return new Promise((function(t,e){if(x9.isFullscreen){var n=function e(){x9.off("change",e),t()};x9.on("change",n);var r=document[g9.exitFullscreen]();r instanceof Promise&&r.then(n).catch(e)}else t()}))},toggle:function(t,e){return x9.isFullscreen?x9.exit():x9.request(t,e)},onchange:function(t){x9.on("change",t)},onerror:function(t){x9.on("error",t)},on:function(t,e){var n=y9[t];n&&document.addEventListener(n,e,!1)},off:function(t,e){var n=y9[t];n&&document.removeEventListener(n,e,!1)},raw:g9};Object.defineProperties(x9,{isFullscreen:{get:function(){return Boolean(document[g9.fullscreenElement])}},element:{enumerable:!0,get:function(){var t;return null!==(t=document[g9.fullscreenElement])&&void 0!==t?t:void 0}},isEnabled:{enumerable:!0,get:function(){return Boolean(document[g9.fullscreenEnabled])}}}),g9||(x9={isEnabled:!1}),function(t,e){var n="undefined"!=typeof my&&!!my&&"function"==typeof my.showToast&&!0!==my.isFRM,r="undefined"!=typeof wx&&null!==wx&&(void 0!==wx.request||void 0!==wx.miniProgram);if(!n&&!r&&(e||(e=document),e)){var i=e.head||e.getElementsByTagName("head")[0];if(!i){i=e.createElement("head");var o=e.body||e.getElementsByTagName("body")[0];o?o.parentNode.insertBefore(i,o):e.documentElement.appendChild(i)}var a=e.createElement("style");a.type="text/css",a.styleSheet?a.styleSheet.cssText=t:a.appendChild(e.createTextNode(t)),i.appendChild(a)}}(".l7-marker-container {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n}\n.l7-marker {\n  position: absolute !important;\n  top: 0;\n  left: 0;\n  z-index: 5;\n  cursor: pointer;\n}\n.l7-marker-cluster {\n  width: 40px;\n  height: 40px;\n  background-color: rgba(181, 226, 140, 0.6);\n  background-clip: padding-box;\n  border-radius: 20px;\n}\n.l7-marker-cluster div {\n  width: 30px;\n  height: 30px;\n  margin-top: 5px;\n  margin-left: 5px;\n  font: 12px 'Helvetica Neue', Arial, Helvetica, sans-serif;\n  text-align: center;\n  background-color: rgba(110, 204, 57, 0.6);\n  border-radius: 15px;\n}\n.l7-marker-cluster span {\n  line-height: 30px;\n}\n.l7-touch .l7-control-attribution,\n.l7-touch .l7-control-layers,\n.l7-touch .l7-bar {\n  -webkit-box-shadow: none;\n          box-shadow: none;\n}\n.l7-touch .l7-control-layers,\n.l7-touch .l7-bar {\n  background-clip: padding-box;\n  border: 2px solid rgba(0, 0, 0, 0.2);\n}\n.mapboxgl-ctrl-logo,\n.amap-logo {\n  display: none !important;\n}\n.l7-select-box {\n  border: 3px dashed gray;\n  border-radius: 2px;\n  position: absolute;\n  z-index: 1000;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n}\n.l7-control-container {\n  font: 12px/1.5 'Helvetica Neue', Arial, Helvetica, sans-serif;\n}\n.l7-control-container .l7-control {\n  position: relative;\n  z-index: 800;\n  float: left;\n  clear: both;\n  color: #595959;\n  font-size: 12px;\n  pointer-events: visiblePainted;\n  /* IE 9-10 doesn't have auto */\n  pointer-events: auto;\n}\n.l7-control-container .l7-control.l7-control--hide {\n  display: none;\n}\n.l7-control-container .l7-top {\n  top: 0;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  position: absolute;\n  z-index: 1000;\n  pointer-events: none;\n}\n.l7-control-container .l7-top .l7-control:not(.l7-control--hide) {\n  margin-top: 8px;\n}\n.l7-control-container .l7-right {\n  right: 0;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  position: absolute;\n  z-index: 1000;\n  pointer-events: none;\n}\n.l7-control-container .l7-right .l7-control:not(.l7-control--hide) {\n  margin-right: 8px;\n}\n.l7-control-container .l7-bottom {\n  bottom: 0;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  position: absolute;\n  z-index: 1000;\n  pointer-events: none;\n}\n.l7-control-container .l7-bottom .l7-control:not(.l7-control--hide) {\n  margin-bottom: 8px;\n}\n.l7-control-container .l7-left {\n  left: 0;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  position: absolute;\n  z-index: 1000;\n  pointer-events: none;\n}\n.l7-control-container .l7-left .l7-control:not(.l7-control--hide) {\n  margin-left: 8px;\n}\n.l7-control-container .l7-center {\n  position: absolute;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-pack: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n}\n.l7-control-container .l7-center.l7-top,\n.l7-control-container .l7-center.l7-bottom {\n  width: 100%;\n}\n.l7-control-container .l7-center.l7-left,\n.l7-control-container .l7-center.l7-right {\n  height: 100%;\n}\n.l7-control-container .l7-center .l7-control {\n  margin-right: 8px;\n  margin-bottom: 8px;\n}\n.l7-control-container .l7-row {\n  -webkit-box-orient: horizontal;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: row;\n          flex-direction: row;\n}\n.l7-control-container .l7-row.l7-top {\n  -webkit-box-align: start;\n      -ms-flex-align: start;\n          align-items: flex-start;\n}\n.l7-control-container .l7-row.l7-bottom {\n  -webkit-box-align: end;\n      -ms-flex-align: end;\n          align-items: flex-end;\n}\n.l7-control-container .l7-column {\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: column;\n          flex-direction: column;\n}\n.l7-control-container .l7-column.l7-left {\n  -webkit-box-align: start;\n      -ms-flex-align: start;\n          align-items: flex-start;\n}\n.l7-control-container .l7-column.l7-right {\n  -webkit-box-align: end;\n      -ms-flex-align: end;\n          align-items: flex-end;\n}\n.l7-button-control {\n  min-width: 28px;\n  height: 28px;\n  background-color: #fff;\n  border-width: 0;\n  border-radius: 2px;\n  outline: 0;\n  cursor: pointer;\n  -webkit-transition: all 0.2s;\n  transition: all 0.2s;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-pack: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  padding: 0 6px;\n  -webkit-box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);\n          box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);\n  line-height: 16px;\n}\n.l7-button-control .l7-iconfont {\n  fill: #595959;\n  color: #595959;\n  width: 16px;\n  height: 16px;\n}\n.l7-button-control.l7-button-control--row {\n  padding: 0 16px 0 13px;\n}\n.l7-button-control.l7-button-control--row * + .l7-button-control__text {\n  margin-left: 8px;\n}\n.l7-button-control.l7-button-control--column {\n  height: 44px;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: column;\n          flex-direction: column;\n}\n.l7-button-control.l7-button-control--column .l7-iconfont {\n  margin-top: 3px;\n}\n.l7-button-control.l7-button-control--column .l7-button-control__text {\n  margin-top: 3px;\n  font-size: 10px;\n  -webkit-transform: scale(0.83333);\n          transform: scale(0.83333);\n}\n.l7-button-control:not(:disabled):hover {\n  background-color: #f3f3f3;\n}\n.l7-button-control:not(:disabled):active {\n  background-color: #f3f3f3;\n}\n.l7-button-control:disabled {\n  background-color: #fafafa;\n  color: #bdbdbd;\n  cursor: not-allowed;\n}\n.l7-button-control:disabled .l7-iconfont {\n  fill: #bdbdbd;\n  color: #bdbdbd;\n}\n.l7-button-control:disabled:hover {\n  background-color: #fafafa;\n}\n.l7-button-control:disabled:active {\n  background-color: #fafafa;\n}\n.l7-popper {\n  position: absolute;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-pack: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  z-index: 5;\n  color: #595959;\n}\n.l7-popper.l7-popper-hide {\n  display: none;\n}\n.l7-popper .l7-popper-content {\n  min-height: 28px;\n  background: #fff;\n  border-radius: 2px;\n  -webkit-box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);\n          box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);\n}\n.l7-popper .l7-popper-arrow {\n  width: 0;\n  height: 0;\n  border-width: 4px;\n  border-style: solid;\n  border-top-color: transparent;\n  border-bottom-color: transparent;\n  border-left-color: transparent;\n  border-right-color: transparent;\n  -webkit-box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);\n          box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);\n}\n.l7-popper.l7-popper-left {\n  -webkit-box-orient: horizontal;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: row;\n          flex-direction: row;\n}\n.l7-popper.l7-popper-left .l7-popper-arrow {\n  border-left-color: #fff;\n  margin: 10px 0;\n}\n.l7-popper.l7-popper-right {\n  -webkit-box-orient: horizontal;\n  -webkit-box-direction: reverse;\n      -ms-flex-direction: row-reverse;\n          flex-direction: row-reverse;\n}\n.l7-popper.l7-popper-right .l7-popper-arrow {\n  border-right-color: #fff;\n  margin: 10px 0;\n}\n.l7-popper.l7-popper-top {\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: column;\n          flex-direction: column;\n}\n.l7-popper.l7-popper-top .l7-popper-arrow {\n  border-top-color: #fff;\n  margin: 0 10px;\n}\n.l7-popper.l7-popper-bottom {\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: reverse;\n      -ms-flex-direction: column-reverse;\n          flex-direction: column-reverse;\n}\n.l7-popper.l7-popper-bottom .l7-popper-arrow {\n  border-bottom-color: #fff;\n  margin: 0 10px;\n}\n.l7-popper.l7-popper-start {\n  -webkit-box-align: start;\n      -ms-flex-align: start;\n          align-items: flex-start;\n}\n.l7-popper.l7-popper-end {\n  -webkit-box-align: end;\n      -ms-flex-align: end;\n          align-items: flex-end;\n}\n.l7-select-control--normal {\n  padding: 4px 0;\n}\n.l7-select-control--normal .l7-select-control-item {\n  height: 24px;\n  line-height: 24px;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  padding: 0 16px;\n  font-size: 12px;\n}\n.l7-select-control--normal .l7-select-control-item > * + * {\n  margin-left: 6px;\n}\n.l7-select-control--normal .l7-select-control-item input[type='checkbox'] {\n  height: 14px;\n  width: 14px;\n}\n.l7-select-control--normal .l7-select-control-item:hover {\n  background-color: #f3f3f3;\n}\n.l7-select-control--image {\n  padding: 12px 12px 0 12px;\n  width: 474px;\n  height: 320px;\n  overflow: auto;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -ms-flex-wrap: wrap;\n      flex-wrap: wrap;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n  -webkit-box-align: start;\n      -ms-flex-align: start;\n          align-items: flex-start;\n}\n.l7-select-control--image .l7-select-control-item {\n  margin-right: 12px;\n  border-radius: 2px;\n  overflow: hidden;\n  border: 1px solid #fff;\n  -webkit-box-sizing: content-box;\n          box-sizing: content-box;\n  width: calc((100% - 36px) / 3);\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: column;\n          flex-direction: column;\n  -webkit-box-pack: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n  margin-bottom: 12px;\n  position: relative;\n  font-size: 12px;\n}\n.l7-select-control--image .l7-select-control-item img {\n  width: 142px;\n  height: 80px;\n}\n.l7-select-control--image .l7-select-control-item input[type='checkbox'] {\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n.l7-select-control--image .l7-select-control-item .l7-select-control-item-row {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-pack: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  line-height: 26px;\n}\n.l7-select-control--image .l7-select-control-item .l7-select-control-item-row > * + * {\n  margin-left: 8px;\n}\n.l7-select-control--image .l7-select-control-item.l7-select-control-item-active {\n  border-color: #0370fe;\n}\n.l7-select-control--image .l7-select-control-item:nth-child(3n) {\n  margin-right: 0;\n}\n.l7-select-control-item {\n  cursor: pointer;\n}\n.l7-select-control-item input[type='checkbox'] {\n  margin: 0;\n  cursor: pointer;\n}\n.l7-select-control--multiple .l7-select-control-item:hover {\n  background-color: transparent;\n}\n.l7-control-logo {\n  width: 89px;\n  height: 16px;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none;\n}\n.l7-control-logo img {\n  height: 100%;\n  width: 100%;\n}\n.l7-control-logo .l7-control-logo-link {\n  display: block;\n  cursor: pointer;\n}\n.l7-control-logo .l7-control-logo-link img {\n  cursor: pointer;\n}\n.l7-control-mouse-location {\n  background-color: #fff;\n  border-radius: 2px;\n  -webkit-box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);\n          box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);\n  padding: 2px 4px;\n  min-width: 130px;\n}\n.l7-control-zoom {\n  -webkit-box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);\n          box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);\n  border-radius: 2px;\n  overflow: hidden;\n}\n.l7-control-zoom .l7-button-control {\n  -webkit-box-shadow: 0 0 0;\n          box-shadow: 0 0 0;\n  border-radius: 0;\n  font-size: 16px;\n}\n.l7-control-zoom .l7-button-control .l7-iconfont {\n  width: 14px;\n  height: 14px;\n}\n.l7-control-zoom .l7-button-control:first-child {\n  border-bottom: 1px solid #f0f0f0;\n}\n.l7-control-scale {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: column;\n          flex-direction: column;\n}\n.l7-control-scale .l7-control-scale-line {\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n  padding: 2px 5px 1px;\n  overflow: hidden;\n  color: #595959;\n  font-size: 10px;\n  line-height: 1.1;\n  white-space: nowrap;\n  background: #fff;\n  border: 2px solid #000;\n  border-top: 0;\n  -webkit-transition: width 0.1s;\n  transition: width 0.1s;\n}\n.l7-control-scale .l7-control-scale-line + .l7-control-scale .l7-control-scale-line {\n  margin-top: -2px;\n  border-top: 2px solid #777;\n  border-bottom: none;\n}\n.l7-right .l7-control-scale {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: end;\n      -ms-flex-align: end;\n          align-items: flex-end;\n}\n.l7-right .l7-control-scale .l7-control-scale-line {\n  text-align: right;\n}\n.l7-popup {\n  position: absolute;\n  top: 0;\n  left: 0;\n  z-index: 5;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  will-change: transform;\n  pointer-events: none;\n}\n.l7-popup.l7-popup-hide {\n  display: none;\n}\n.l7-popup .l7-popup-content {\n  position: relative;\n  padding: 16px;\n  font-size: 14px;\n  background: #fff;\n  border-radius: 3px;\n  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n}\n.l7-popup .l7-popup-content .l7-popup-content__title {\n  margin-bottom: 8px;\n  font-weight: bold;\n}\n.l7-popup .l7-popup-content .l7-popup-close-button,\n.l7-popup .l7-popup-content .l7-popup-content__title,\n.l7-popup .l7-popup-content .l7-popup-content__panel {\n  white-space: normal;\n  -webkit-user-select: text;\n     -moz-user-select: text;\n      -ms-user-select: text;\n          user-select: text;\n  pointer-events: initial;\n}\n.l7-popup .l7-popup-content .l7-popup-close-button {\n  position: absolute;\n  top: 0;\n  right: 0;\n  width: 18px;\n  height: 18px;\n  padding: 0;\n  font-size: 14px;\n  line-height: 18px;\n  text-align: center;\n  background-color: transparent;\n  border: 0;\n  border-radius: 0 3px 0 0;\n  cursor: pointer;\n}\n.l7-popup .l7-popup-tip {\n  position: relative;\n  z-index: 1;\n  width: 0;\n  height: 0;\n  border: 10px solid transparent;\n}\n.l7-popup.l7-popup-anchor-bottom,\n.l7-popup.l7-popup-anchor-bottom-left,\n.l7-popup.l7-popup-anchor-bottom-right {\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: reverse;\n      -ms-flex-direction: column-reverse;\n          flex-direction: column-reverse;\n}\n.l7-popup.l7-popup-anchor-bottom .l7-popup-tip,\n.l7-popup.l7-popup-anchor-bottom-left .l7-popup-tip,\n.l7-popup.l7-popup-anchor-bottom-right .l7-popup-tip {\n  bottom: 1px;\n}\n.l7-popup.l7-popup-anchor-top,\n.l7-popup.l7-popup-anchor-top-left,\n.l7-popup.l7-popup-anchor-top-right {\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: column;\n          flex-direction: column;\n}\n.l7-popup.l7-popup-anchor-top .l7-popup-tip,\n.l7-popup.l7-popup-anchor-top-left .l7-popup-tip,\n.l7-popup.l7-popup-anchor-top-right .l7-popup-tip {\n  top: 1px;\n}\n.l7-popup.l7-popup-anchor-left {\n  -webkit-box-orient: horizontal;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: row;\n          flex-direction: row;\n}\n.l7-popup.l7-popup-anchor-right {\n  -webkit-box-orient: horizontal;\n  -webkit-box-direction: reverse;\n      -ms-flex-direction: row-reverse;\n          flex-direction: row-reverse;\n}\n.l7-popup-anchor-top .l7-popup-tip {\n  position: relative;\n  -webkit-align-self: center;\n  -ms-flex-item-align: center;\n      align-self: center;\n  border-top: none;\n  border-bottom-color: #fff;\n}\n.l7-popup-anchor-top-left .l7-popup-tip {\n  -webkit-align-self: flex-start;\n  -ms-flex-item-align: start;\n      align-self: flex-start;\n  border-top: none;\n  border-bottom-color: #fff;\n  border-left: none;\n}\n.l7-popup-anchor-top-right .l7-popup-tip {\n  -webkit-align-self: flex-end;\n  -ms-flex-item-align: end;\n      align-self: flex-end;\n  border-top: none;\n  border-right: none;\n  border-bottom-color: #fff;\n}\n.l7-popup-anchor-bottom .l7-popup-tip {\n  -webkit-align-self: center;\n  -ms-flex-item-align: center;\n      align-self: center;\n  border-top-color: #fff;\n  border-bottom: none;\n}\n.l7-popup-anchor-bottom-left .l7-popup-tip {\n  -webkit-align-self: flex-start;\n  -ms-flex-item-align: start;\n      align-self: flex-start;\n  border-top-color: #fff;\n  border-bottom: none;\n  border-left: none;\n}\n.l7-popup-anchor-bottom-right .l7-popup-tip {\n  -webkit-align-self: flex-end;\n  -ms-flex-item-align: end;\n      align-self: flex-end;\n  border-top-color: #fff;\n  border-right: none;\n  border-bottom: none;\n}\n.l7-popup-anchor-left .l7-popup-tip {\n  -webkit-align-self: center;\n  -ms-flex-item-align: center;\n      align-self: center;\n  border-right-color: #fff;\n  border-left: none;\n}\n.l7-popup-anchor-right .l7-popup-tip {\n  right: 1px;\n  -webkit-align-self: center;\n  -ms-flex-item-align: center;\n      align-self: center;\n  border-right: none;\n  border-left-color: #fff;\n}\n.l7-popup-anchor-top-left .l7-popup-content {\n  border-top-left-radius: 0;\n}\n.l7-popup-anchor-top-right .l7-popup-content {\n  border-top-right-radius: 0;\n}\n.l7-popup-anchor-bottom-left .l7-popup-content {\n  border-bottom-left-radius: 0;\n}\n.l7-popup-anchor-bottom-right .l7-popup-content {\n  border-bottom-right-radius: 0;\n}\n.l7-popup-track-pointer {\n  display: none;\n}\n.l7-popup-track-pointer * {\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none;\n  pointer-events: none;\n}\n.l7-map:hover .l7-popup-track-pointer {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n}\n.l7-map:active .l7-popup-track-pointer {\n  display: none;\n}\n.l7-layer-popup__row {\n  font-size: 12px;\n}\n.l7-layer-popup__row + .l7-layer-popup__row {\n  margin-top: 4px;\n}\n");var b9,_9,w9,S9=($q(m9={},u8.additive,{enable:!0,func:{srcRGB:m4.ONE,dstRGB:m4.ONE,srcAlpha:1,dstAlpha:1}}),$q(m9,u8.none,{enable:!1}),$q(m9,u8.normal,{enable:!0,func:{srcRGB:m4.SRC_ALPHA,dstRGB:m4.ONE_MINUS_SRC_ALPHA,srcAlpha:1,dstAlpha:1}}),$q(m9,u8.subtractive,{enable:!0,func:{srcRGB:m4.ONE,dstRGB:m4.ONE,srcAlpha:m4.ZERO,dstAlpha:m4.ONE_MINUS_SRC_COLOR},equation:{rgb:m4.FUNC_SUBTRACT,alpha:m4.FUNC_SUBTRACT}}),$q(m9,u8.max,{enable:!0,func:{srcRGB:m4.ONE,dstRGB:m4.ONE},equation:{rgb:m4.MAX_EXT}}),$q(m9,u8.min,{enable:!0,func:{srcRGB:m4.ONE,dstRGB:m4.ONE},equation:{rgb:m4.MIN_EXT}}),m9);function M9(t,e,n,r,i){e.updateStyleAttribute(t,n,r,i)}function E9(t,e){e.tileLayer||e.isTileLayer||(t.opacity&&A9("opacity",e,t.opacity),t.strokeWidth&&A9("strokeWidth",e,t.strokeWidth),t.strokeOpacity&&A9("strokeOpacity",e,t.strokeOpacity),t.stroke&&function(t,e,n){hZ.isString(n)||(Array.isArray(n)&&2===n.length&&(hZ.isString(n[0])&&hZ.isFunction(n[1])||hZ.isString(n[0])&&Array.isArray(n[1])&&n[1].length>0)?M9(t,e,n[0],n[1]):M9(t,e,"#fff",void 0))}("stroke",e,t.stroke),t.offsets&&T9("offsets",e,t.offsets),t.textOffset&&T9("textOffset",e,t.textOffset),t.thetaOffset&&A9("thetaOffset",e,t.thetaOffset))}function A9(t,e,n){hZ.isString(n)?M9(t,e,n,(function(t){return t})):hZ.isNumber(n)||(Array.isArray(n)&&2===n.length&&(hZ.isString(n[0])&&hZ.isFunction(n[1])||hZ.isString(n[0])&&Array.isArray(n[1])&&hZ.isNumber(n[1][0])&&hZ.isNumber(n[1][1]))?M9(t,e,n[0],n[1]):M9(t,e,[1],void 0))}function T9(t,e,n){hZ.isString(n)?M9(t,e,n,(function(t){return t})):Array.isArray(n)&&2===n.length&&hZ.isString(n[0])&&hZ.isFunction(n[1])?M9(t,e,n[0],n[1]):Array.isArray(n)&&2===n.length&&hZ.isNumber(n[0])&&hZ.isNumber(n[1])?M9(t,e,n,void 0):M9(t,e,[0,0],void 0)}var C9=(b9=x8(J2.IGlobalConfigService),w9=j3((_9=function(){function t(e){mZ(this,t),F3(this,"configService",w9,this),this.config=e}return gZ(t,[{key:"setContainer",value:function(t,e,n,r){t.bind(J2.MapConfig).toConstantValue(Jq(Jq({},this.config),{},{id:e,canvas:n,hasBaseMap:r})),t.bind(J2.IMapService).to(this.getServiceConstructor()).inSingletonScope()}},{key:"getServiceConstructor",value:function(){throw new Error("Method not implemented.")}}]),t}()).prototype,"configService",[b9],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_9),O9={};({get exports(){return O9},set exports(t){O9=t}}).exports=function(){function t(t){var r=[];return t.AMapUI&&r.push(e(t.AMapUI)),t.Loca&&r.push(n(t.Loca)),Promise.all(r)}function e(t){return new Promise((function(e,n){var i=[];if(t.plugins)for(var u=0;u<t.plugins.length;u+=1)-1==o.AMapUI.plugins.indexOf(t.plugins[u])&&i.push(t.plugins[u]);if(a.AMapUI===r.failed)n("前次请求 AMapUI 失败");else if(a.AMapUI===r.notload){a.AMapUI=r.loading,o.AMapUI.version=t.version||o.AMapUI.version,u=o.AMapUI.version;var c=document.body||document.head,l=document.createElement("script");l.type="text/javascript",l.src="https://webapi.amap.com/ui/"+u+"/main.js",l.onerror=function(t){a.AMapUI=r.failed,n("请求 AMapUI 失败")},l.onload=function(){if(a.AMapUI=r.loaded,i.length)window.AMapUI.loadUI(i,(function(){for(var t=0,n=i.length;t<n;t++){var r=i[t].split("/").slice(-1)[0];window.AMapUI[r]=arguments[t]}for(e();s.AMapUI.length;)s.AMapUI.splice(0,1)[0]()}));else for(e();s.AMapUI.length;)s.AMapUI.splice(0,1)[0]()},c.appendChild(l)}else a.AMapUI===r.loaded?t.version&&t.version!==o.AMapUI.version?n("不允许多个版本 AMapUI 混用"):i.length?window.AMapUI.loadUI(i,(function(){for(var t=0,n=i.length;t<n;t++){var r=i[t].split("/").slice(-1)[0];window.AMapUI[r]=arguments[t]}e()})):e():t.version&&t.version!==o.AMapUI.version?n("不允许多个版本 AMapUI 混用"):s.AMapUI.push((function(t){t?n(t):i.length?window.AMapUI.loadUI(i,(function(){for(var t=0,n=i.length;t<n;t++){var r=i[t].split("/").slice(-1)[0];window.AMapUI[r]=arguments[t]}e()})):e()}))}))}function n(t){return new Promise((function(e,n){if(a.Loca===r.failed)n("前次请求 Loca 失败");else if(a.Loca===r.notload){a.Loca=r.loading,o.Loca.version=t.version||o.Loca.version;var i=o.Loca.version,u=o.AMap.version.startsWith("2"),c=i.startsWith("2");if(u&&!c||!u&&c)n("JSAPI 与 Loca 版本不对应！！");else{u=o.key,c=document.body||document.head;var l=document.createElement("script");l.type="text/javascript",l.src="https://webapi.amap.com/loca?v="+i+"&key="+u,l.onerror=function(t){a.Loca=r.failed,n("请求 AMapUI 失败")},l.onload=function(){for(a.Loca=r.loaded,e();s.Loca.length;)s.Loca.splice(0,1)[0]()},c.appendChild(l)}}else a.Loca===r.loaded?t.version&&t.version!==o.Loca.version?n("不允许多个版本 Loca 混用"):e():t.version&&t.version!==o.Loca.version?n("不允许多个版本 Loca 混用"):s.Loca.push((function(t){t?n(t):n()}))}))}if(!window)throw Error("AMap JSAPI can only be used in Browser.");var r,i;(i=r||(r={})).notload="notload",i.loading="loading",i.loaded="loaded",i.failed="failed";var o={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},a={AMap:r.notload,AMapUI:r.notload,Loca:r.notload},s={AMap:[],AMapUI:[],Loca:[]},u=[],c=function(t){"function"==typeof t&&(a.AMap===r.loaded?t(window.AMap):u.push(t))};return{load:function(e){return new Promise((function(n,i){if(a.AMap==r.failed)i("");else if(a.AMap==r.notload){var s=e.key,l=e.version,h=e.plugins;s?(window.AMap&&"lbs.amap.com"!==location.host&&i("禁止多种API加载方式混用"),o.key=s,o.AMap.version=l||o.AMap.version,o.AMap.plugins=h||o.AMap.plugins,a.AMap=r.loading,l=document.body||document.head,window.___onAPILoaded=function(o){if(delete window.___onAPILoaded,o)a.AMap=r.failed,i(o);else for(a.AMap=r.loaded,t(e).then((function(){n(window.AMap)})).catch(i);u.length;)u.splice(0,1)[0]()},(h=document.createElement("script")).type="text/javascript",h.src="https://webapi.amap.com/maps?callback=___onAPILoaded&v="+o.AMap.version+"&key="+s+"&plugin="+o.AMap.plugins.join(","),h.onerror=function(t){a.AMap=r.failed,i(t)},l.appendChild(h)):i("请填写key")}else if(a.AMap==r.loaded)if(e.key&&e.key!==o.key)i("多个不一致的 key");else if(e.version&&e.version!==o.AMap.version)i("不允许多个版本 JSAPI 混用");else{if(s=[],e.plugins)for(l=0;l<e.plugins.length;l+=1)-1==o.AMap.plugins.indexOf(e.plugins[l])&&s.push(e.plugins[l]);s.length?window.AMap.plugin(s,(function(){t(e).then((function(){n(window.AMap)})).catch(i)})):t(e).then((function(){n(window.AMap)})).catch(i)}else if(e.key&&e.key!==o.key)i("多个不一致的 key");else if(e.version&&e.version!==o.AMap.version)i("不允许多个版本 JSAPI 混用");else{var f=[];if(e.plugins)for(l=0;l<e.plugins.length;l+=1)-1==o.AMap.plugins.indexOf(e.plugins[l])&&f.push(e.plugins[l]);c((function(){f.length?window.AMap.plugin(f,(function(){t(e).then((function(){n(window.AMap)})).catch(i)})):t(e).then((function(){n(window.AMap)})).catch(i)}))}}))},reset:function(){delete window.AMap,delete window.AMapUI,delete window.Loca,o={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},a={AMap:r.notload,AMapUI:r.notload,Loca:r.notload},s={AMap:[],AMapUI:[],Loca:[]}}}}();const k9=O9;var P9;!function(t){t["GAODE1.x"]="GAODE1.x",t["GAODE2.x"]="GAODE2.x",t.MAPBOX="MAPBOX",t.DEFUALT="DEFUALTMAP",t.SIMPLE="SIMPLE",t.GLOBEL="GLOBEL"}(P9||(P9={}));var L9=function(){function t(e){mZ(this,t),$q(this,"size",1e4),this.size=e||1e4}return gZ(t,[{key:"setSize",value:function(t){this.size=t}},{key:"getSize",value:function(){return[this.size,this.size]}},{key:"mercatorXfromLng",value:function(t){return(180+t)/360*this.size}},{key:"mercatorYfromLat",value:function(t){return(1-(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360)*this.size}},{key:"lngFromMercatorX",value:function(t){return t/this.size*360-180}},{key:"latFromMercatorY",value:function(t){var e=180-360*(1-t/this.size);return 360/Math.PI*Math.atan(Math.exp(e*Math.PI/180))-90}},{key:"project",value:function(t){return[this.mercatorXfromLng(t[0]),this.mercatorYfromLat(t[1])]}},{key:"unproject",value:function(t){return[this.lngFromMercatorX(t[0]),this.latFromMercatorY(t[1])]}}]),t}();function R9(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e={top:0,right:0,bottom:0,left:0};if("number"==typeof t)return{top:t,right:t,bottom:t,left:t};if(Array.isArray(t)){if(4===t.length)return{top:t[0],right:t[1],bottom:t[2],left:t[3]};if(2===t.length)return{top:t[0],right:t[1],bottom:t[0],left:t[1]}}return Jq(Jq({},e),t)}function I9(t,e){var n,r,i,o=ba([],e,t);return n=o,r=o,i=1/o[3],n[0]=r[0]*i,n[1]=r[1]*i,n[2]=r[2]*i,n[3]=r[3]*i,o}function N9(t,e){if(!t)throw new Error(e||"viewport-mercator-project: assertion failed.")}var D9=Math.PI,F9=D9/4,j9=D9/180,B9=180/D9,z9=4003e4;function U9(t){return Math.pow(2,t)}function V9(t,e){var n=lZ(t,2),r=n[0],i=n[1];N9(Number.isFinite(r)&&Number.isFinite(e)),N9(Number.isFinite(i)&&i>=-90&&i<=90,"invalid latitude");var o=i*j9;return[(e*=512)*(r*j9+D9)/(2*D9),e*(D9-Math.log(Math.tan(F9+.5*o)))/(2*D9)]}function G9(t,e){var n=lZ(t,2),r=n[0],i=n[1],o=r/(e*=512)*(2*D9)-D9,a=2*(Math.atan(Math.exp(D9-i/e*(2*D9)))-F9);return[o*B9,a*B9]}function W9(t){var e=t.latitude,n=t.longitude,r=t.zoom,i=t.scale,o=t.highPrecision,a=void 0!==o&&o;i=void 0!==i?i:U9(r),N9(Number.isFinite(e)&&Number.isFinite(n)&&Number.isFinite(i));var s={},u=512*i,c=Math.cos(e*j9),l=u/360,h=l/c,f=u/z9/c;if(s.pixelsPerMeter=[f,-f,f],s.metersPerPixel=[1/f,-1/f,1/f],s.pixelsPerDegree=[l,-h,f],s.degreesPerPixel=[1/l,-1/h,1/f],a){var p=j9*Math.tan(e*j9)/c,d=l*p/2,m=u/z9*p,v=m/h*f;s.pixelsPerDegree2=[0,-d,m],s.pixelsPerMeter2=[v,0,v]}return s}function H9(t){var e=t.height,n=t.pitch,r=t.bearing,i=t.altitude,o=t.center,a=void 0===o?null:o,s=t.flipY,u=void 0!==s&&s,c=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return fo(c,c,[0,0,-i]),po(c,c,[1,1,1/e]),mo(c,c,-n*j9),go(c,c,r*j9),u&&po(c,c,[1,-1,1]),a&&fo(c,c,Jo([],a)),c}function Y9(t){var e=t.width,n=t.height,r=t.pitch,i=function(t){var e=t.width,n=t.height,r=t.altitude,i=void 0===r?1.5:r,o=t.pitch,a=void 0===o?0:o,s=t.nearZMultiplier,u=void 0===s?1:s,c=t.farZMultiplier,l=void 0===c?1:c,h=a*j9,f=Math.atan(.5/i),p=Math.sin(f)*i/Math.sin(Math.PI/2-h-f),d=Math.cos(Math.PI/2-h)*p+i;return{fov:2*Math.atan(n/2/i),aspect:e/n,focalDistance:i,near:u,far:d*l}}({width:e,height:n,altitude:t.altitude,pitch:r,nearZMultiplier:t.nearZMultiplier,farZMultiplier:t.farZMultiplier}),o=i.fov,a=i.aspect,s=i.near,u=i.far;return To([],o,a,s,u)}function X9(t,e){var n=lZ(t,3),r=n[0],i=n[1],o=n[2],a=void 0===o?0:o;return N9(Number.isFinite(r)&&Number.isFinite(i)&&Number.isFinite(a)),I9(e,[r,i,a,1])}function q9(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=lZ(t,3),i=r[0],o=r[1],a=r[2];if(N9(Number.isFinite(i)&&Number.isFinite(o),"invalid pixel coordinate"),Number.isFinite(a)){var s=I9(e,[i,o,a,1]);return s}var u=I9(e,[i,o,0,1]),c=I9(e,[i,o,1,1]),l=u[2],h=c[2],f=l===h?0:((n||0)-l)/(h-l);return Va([],u,c,f)}var Z9=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],$9=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.width,r=e.height,i=e.viewMatrix,o=void 0===i?Z9:i,a=e.projectionMatrix,s=void 0===a?Z9:a;mZ(this,t),this.width=n||1,this.height=r||1,this.scale=1,this.pixelsPerMeter=1,this.viewMatrix=o,this.projectionMatrix=s;var u=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];ho(u,u,this.projectionMatrix),ho(u,u,this.viewMatrix),this.viewProjectionMatrix=u;var c=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];po(c,c,[this.width/2,-this.height/2,1]),fo(c,c,[1,-1,0]),ho(c,c,this.viewProjectionMatrix);var l=co([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],c);if(!l)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=c,this.pixelUnprojectionMatrix=l,this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}return gZ(t,[{key:"equals",value:function(e){return e instanceof t&&(e.width===this.width&&e.height===this.height&&Lo(e.projectionMatrix,this.projectionMatrix)&&Lo(e.viewMatrix,this.viewMatrix))}},{key:"project",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.topLeft,r=void 0===n||n,i=this.projectPosition(t),o=X9(i,this.pixelProjectionMatrix),a=lZ(o,2),s=a[0],u=a[1],c=r?u:this.height-u;return 2===t.length?[s,c]:[s,c,o[2]]}},{key:"unproject",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.topLeft,r=void 0===n||n,i=e.targetZ,o=lZ(t,3),a=o[0],s=o[1],u=o[2],c=r?s:this.height-s,l=i&&i*this.pixelsPerMeter,h=q9([a,c,u],this.pixelUnprojectionMatrix,l),f=this.unprojectPosition(h),p=lZ(f,3),d=p[0],m=p[1],v=p[2];return Number.isFinite(u)?[d,m,v]:Number.isFinite(i)?[d,m,i]:[d,m]}},{key:"projectPosition",value:function(t){var e=lZ(this.projectFlat(t),2);return[e[0],e[1],(t[2]||0)*this.pixelsPerMeter]}},{key:"unprojectPosition",value:function(t){var e=lZ(this.unprojectFlat(t),2);return[e[0],e[1],(t[2]||0)/this.pixelsPerMeter]}},{key:"projectFlat",value:function(t){return arguments.length>1&&void 0!==arguments[1]||this.scale,t}},{key:"unprojectFlat",value:function(t){return arguments.length>1&&void 0!==arguments[1]||this.scale,t}}]),t}();function K9(t){var e=t.width,n=t.height,r=t.bounds,i=t.minExtent,o=void 0===i?0:i,a=t.maxZoom,s=void 0===a?24:a,u=t.padding,c=void 0===u?0:u,l=t.offset,h=void 0===l?[0,0]:l,f=lZ(r,2),p=lZ(f[0],2),d=p[0],m=p[1],v=lZ(f[1],2),g=v[0],y=v[1];if(Number.isFinite(c)){c={top:c,bottom:c,left:c,right:c}}else N9(Number.isFinite(c.top)&&Number.isFinite(c.bottom)&&Number.isFinite(c.left)&&Number.isFinite(c.right));var x=new ctt({width:e,height:n,longitude:0,latitude:0,zoom:0}),b=x.project([d,y]),_=x.project([g,m]),w=[Math.max(Math.abs(_[0]-b[0]),o),Math.max(Math.abs(_[1]-b[1]),o)],S=[e-c.left-c.right-2*Math.abs(h[0]),n-c.top-c.bottom-2*Math.abs(h[1])];N9(S[0]>0&&S[1]>0);var M=S[0]/w[0],E=S[1]/w[1],A=(c.right-c.left)/2/M,T=(c.bottom-c.top)/2/E,C=[(_[0]+b[0])/2+A,(_[1]+b[1])/2+T],O=x.unproject(C),k=x.zoom+Math.log2(Math.abs(Math.min(M,E)));return{longitude:O[0],latitude:O[1],zoom:Math.min(k,s)}}var J9,Q9,ttt,ett,ntt,rtt,itt,ott,att,stt,utt,ctt=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.width,i=n.height,o=n.latitude,a=void 0===o?0:o,s=n.longitude,u=void 0===s?0:s,c=n.zoom,l=void 0===c?0:c,h=n.pitch,f=void 0===h?0:h,p=n.bearing,d=void 0===p?0:p,m=n.altitude,v=void 0===m?1.5:m,g=n.nearZMultiplier,y=n.farZMultiplier;mZ(this,e),r=r||1,i=i||1;var x=U9(l);v=Math.max(.75,v);var b=V9([u,a],x);b[2]=0;var _=Y9({width:r,height:i,pitch:f,bearing:d,altitude:v,nearZMultiplier:g||1/i,farZMultiplier:y||1.01}),w=H9({height:i,center:b,pitch:f,bearing:d,altitude:v,flipY:!0});return(t=MZ(this,EZ(e).call(this,{width:r,height:i,viewMatrix:w,projectionMatrix:_}))).latitude=a,t.longitude=u,t.zoom=l,t.pitch=f,t.bearing=d,t.altitude=v,t.scale=x,t.center=b,t.pixelsPerMeter=W9(SZ(SZ(t))).pixelsPerMeter[2],Object.freeze(SZ(SZ(t))),t}return wZ(e,$9),gZ(e,[{key:"projectFlat",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale;return V9(t,e)}},{key:"unprojectFlat",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale;return G9(t,e)}},{key:"getMapCenterByLngLatPosition",value:function(t){var e,n,r=t.lngLat,i=q9(t.pos,this.pixelUnprojectionMatrix),o=Ia([],V9(r,this.scale),((e=[])[0]=-(n=i)[0],e[1]=-n[1],e));return G9(Ia([],this.center,o),this.scale)}},{key:"getLocationAtPoint",value:function(t){var e=t.lngLat,n=t.pos;return this.getMapCenterByLngLatPosition({lngLat:e,pos:n})}},{key:"fitBounds",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.width,i=this.height,o=K9(Object.assign({width:r,height:i,bounds:t},n)),a=o.longitude,s=o.latitude,u=o.zoom;return new e({width:r,height:i,longitude:a,latitude:s,zoom:u})}}]),e}(),ltt=function(){function t(){mZ(this,t)}return gZ(t,[{key:"syncWithMapCamera",value:function(t){var e=t.center,n=t.zoom,r=t.pitch,i=t.bearing,o=t.viewportHeight,a=t.viewportWidth,s=this.viewport?{width:this.viewport.width,height:this.viewport.height,longitude:this.viewport.center[0],latitude:this.viewport.center[1],zoom:this.viewport.zoom,pitch:this.viewport.pitch,bearing:this.viewport.bearing}:{};this.viewport=new ctt(Jq(Jq({},s),{},{width:a,height:o,longitude:e&&e[0],latitude:e&&e[1],zoom:n,pitch:r,bearing:i}))}},{key:"getZoom",value:function(){return this.viewport.zoom}},{key:"getZoomScale",value:function(){return Math.pow(2,this.getZoom())}},{key:"getCenter",value:function(){return[this.viewport.longitude,this.viewport.latitude]}},{key:"getProjectionMatrix",value:function(){return this.viewport.projectionMatrix}},{key:"getModelMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},{key:"getViewMatrix",value:function(){return this.viewport.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.viewMatrixUncentered}},{key:"getViewProjectionMatrix",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(t,e){return this.viewport.projectFlat(t,e)}}]),t}(),htt={normal:"amap://styles/normal",light:"amap://styles/c422f5c0cfced5be9fe3a83f05f28a68?isPublic=true",dark:"amap://styles/c9f1d10cae34f8ab05e425462c5a58d7?isPublic=true",blank:"amap://styles/07c17002b38775b32a7a76c66cf90e99?isPublic=true",fresh:"amap://styles/fresh",grey:"amap://styles/grey",graffiti:"amap://styles/graffiti",macaron:"amap://styles/macaron",darkblue:"amap://styles/darkblue",wine:"amap://styles/wine"},ftt=["id","style","minZoom","maxZoom","token","mapInstance","plugin"];!function(t,e){var n="undefined"!=typeof my&&!!my&&"function"==typeof my.showToast&&!0!==my.isFRM,r="undefined"!=typeof wx&&null!==wx&&(void 0!==wx.request||void 0!==wx.miniProgram);if(!n&&!r&&(e||(e=document),e)){var i=e.head||e.getElementsByTagName("head")[0];if(!i){i=e.createElement("head");var o=e.body||e.getElementsByTagName("body")[0];o?o.parentNode.insertBefore(i,o):e.documentElement.appendChild(i)}var a=e.createElement("style");a.type="text/css",a.styleSheet?a.styleSheet.cssText=t:a.appendChild(e.createTextNode(t)),i.appendChild(a)}}(".amap-logo{\n display: none !important;\n}\n");var ptt={contextmenu:"rightclick"},dtt=0;window.forceWebGL=!0;var mtt,vtt="15cd8a57710d40c9b7c0e3cc120f1200",gtt=!1,ytt=[],xtt=(J9=Z2(),Q9=d2(J2.IGlobalConfigService),ttt=d2(J2.MapConfig),ett=d2(J2.ICoordinateSystemService),ntt=d2(J2.IEventEmitter),J9((itt=function(){function t(){var e=this;mZ(this,t),$q(this,"version",P9["GAODE1.x"]),$q(this,"simpleMapCoord",new L9),$q(this,"bgColor","rgba(0, 0, 0, 0)"),F3(this,"configService",ott,this),F3(this,"config",att,this),F3(this,"coordinateSystemService",stt,this),F3(this,"eventEmitter",utt,this),$q(this,"handleCameraChanged",(function(t){var n=t.camera,r=n.fov,i=n.near,o=n.far,a=n.height,s=n.pitch,u=n.rotation,c=n.aspect,l=n.position,h=e.getCenter(),f=h.lng,p=h.lat;if(e.emit("mapchange"),e.cameraChangedCallback){e.viewport.syncWithMapCamera({aspect:c,bearing:360-u,far:o,fov:r,cameraHeight:a,near:i,pitch:s,zoom:e.map.getZoom()-1,center:[f,p],offsetOrigin:[l.x,l.y]});var d=e.config.offsetZoom,m=void 0===d?12:d;e.viewport.getZoom()>m?e.coordinateSystemService.setCoordinateSystem(B3.P20_OFFSET):e.coordinateSystemService.setCoordinateSystem(B3.P20),e.cameraChangedCallback(e.viewport)}}))}var e;return gZ(t,[{key:"setBgColor",value:function(t){this.bgColor=t}},{key:"addMarkerContainer",value:function(){var t=this.map.getContainer();if(null!==t){var e=t.getElementsByClassName("amap-maps")[0];this.markerContainer=z$("div","l7-marker-container",e)}}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(t,e){-1!==w8.indexOf(t)?this.eventEmitter.on(t,e):this.map.on(ptt[t]||t,e)}},{key:"off",value:function(t,e){-1!==w8.indexOf(t)?this.eventEmitter.off(t,e):this.map.off(ptt[t]||t,e)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){var t;return null===(t=this.map.getContainer())||void 0===t?void 0:t.getElementsByClassName("amap-maps")[0]}},{key:"getSize",value:function(){var t=this.map.getSize();return[t.getWidth(),t.getHeight()]}},{key:"getType",value:function(){return"amap"}},{key:"getZoom",value:function(){return this.map.getZoom()-1}},{key:"setZoom",value:function(t){return this.map.setZoom(t+1)}},{key:"getCenter",value:function(t){if(null!=t&&t.padding){var e=this.getCenter(),n=R9(t.padding),r=this.lngLatToPixel([e.lng,e.lat]),i=[(n.right-n.left)/2,(n.bottom-n.top)/2];return this.pixelToLngLat([r.x-i[0],r.y-i[1]])}var o=this.map.getCenter();return{lng:o.getLng(),lat:o.getLat()}}},{key:"setCenter",value:function(t,e){if(null!=e&&e.padding){var n=R9(e.padding),r=this.lngLatToPixel(t),i=[(n.right-n.left)/2,(n.bottom-n.top)/2],o=this.pixelToLngLat([r.x+i[0],r.y+i[1]]);this.map.setCenter([o.lng,o.lat])}else this.map.setCenter(t)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return 360-this.map.getRotation()}},{key:"getBounds",value:function(){var t=this.map.getBounds().toBounds(),e=t.getNorthEast(),n=t.getSouthWest(),r=this.getCenter(),i=r.lng>e.getLng()||r.lng<n.getLng()?180-e.getLng():e.getLng();return[[r.lng<n.getLng()?n.getLng()-180:n.getLng(),n.getLat()],[i,e.getLat()]]}},{key:"getMinZoom",value:function(){return this.map.get("zooms")[0]-1}},{key:"getMaxZoom",value:function(){return this.map.get("zooms")[1]-1}},{key:"setRotation",value:function(t){return this.map.setRotation(t)}},{key:"setPitch",value:function(t){return this.map.setPitch(t)}},{key:"zoomIn",value:function(){this.map.zoomIn()}},{key:"zoomOut",value:function(){this.map.zoomOut()}},{key:"panTo",value:function(t){this.map.panTo(t)}},{key:"panBy",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.map.panBy(t,e)}},{key:"fitBounds",value:function(t){this.map.setBounds(new AMap.Bounds([t[0][0],t[0][1],t[1][0],t[1][1]]))}},{key:"setZoomAndCenter",value:function(t,e){this.map.setZoomAndCenter(t+1,e)}},{key:"setMapStyle",value:function(t){this.map.setMapStyle(this.getMapStyleValue(t))}},{key:"setMapStatus",value:function(t){this.map.setStatus(t)}},{key:"getMapStyleConfig",value:function(){return htt}},{key:"getMapStyleValue",value:function(t){return this.getMapStyleConfig()[t]||t}},{key:"getMapStyle",value:function(){return this.map.getMapStyle()}},{key:"pixelToLngLat",value:function(t){var e=this.map.pixelToLngLat(new AMap.Pixel(t[0],t[1]));return{lng:e.getLng(),lat:e.getLat()}}},{key:"lngLatToPixel",value:function(t){var e=this.map.lnglatToPixel(new AMap.LngLat(t[0],t[1]));return{x:e.getX(),y:e.getY()}}},{key:"containerToLngLat",value:function(t){var e=new AMap.Pixel(t[0],t[1]),n=this.map.containerToLngLat(e);return{lng:null==n?void 0:n.getLng(),lat:null==n?void 0:n.getLat()}}},{key:"lngLatToContainer",value:function(t){var e=new AMap.LngLat(t[0],t[1]),n=this.map.lngLatToContainer(e);return{x:n.getX(),y:n.getY()}}},{key:"lngLatToCoord",value:function(t){var e=this.map.lngLatToGeodeticCoord(t);return[e.x,-e.y]}},{key:"lngLatToMercator",value:function(t,e){return{x:0,y:0,z:0}}},{key:"getModelMatrix",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1,1],i=this.viewport.projectFlat(t),o=no();return fo(o,o,Bo(i[0],i[1],e)),po(o,o,Bo(r[0],r[1],r[2])),mo(o,o,n[0]),vo(o,o,n[1]),go(o,o,n[2]),o}},{key:"init",value:(e=RK(jK.mark((function t(){var e,n,r,i,o,a,s,u,c,l,h,f,p,d,m=this;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.config,n=e.id,r=e.style,i=void 0===r?"light":r,o=e.minZoom,a=void 0===o?0:o,s=e.maxZoom,u=void 0===s?18:s,c=e.token,l=void 0===c?vtt:c,h=e.mapInstance,f=e.plugin,p=void 0===f?[]:f,d=v1(e,ftt),t.next=3,new Promise((function(t){var e=function(){if(h)m.map=h,m.$mapContainer=m.map.getContainer(),setTimeout((function(){m.map.on("camerachange",m.handleCameraChanged),t()}),30);else{m.$mapContainer=m.creatMapContainer(n);var e=Jq({mapStyle:m.getMapStyleValue(i),zooms:[a,u],viewMode:"3D"},d);e.zoom&&(e.zoom+=1);var r=new AMap.Map(m.$mapContainer,e);r.on("camerachange",m.handleCameraChanged),r.on("camerachange",(function(){setTimeout((function(){return m.handleAfterMapChange()}))})),m.map=r,setTimeout((function(){t()}),10)}};gtt||h?gtt&&window.AMap||h?e():ytt.push(e):(gtt=!0,p.push("Map3D"),k9.load({key:l,version:"1.4.15",plugins:p}).then((function(){e(),ytt.length&&(ytt.forEach((function(t){return t()})),ytt=[])})).catch((function(t){throw new Error(t)})))}));case 3:this.viewport=new ltt;case 4:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"meterToCoord",value:function(t,e){var n=AMap.GeometryUtil.distance(J$(AMap.LngLat,Xq(t)),J$(AMap.LngLat,Xq(e))),r=lZ(this.lngLatToCoord(t),2),i=r[0],o=r[1],a=lZ(this.lngLatToCoord(e),2),s=a[0],u=a[1];return Math.sqrt(Math.pow(i-s,2)+Math.pow(o-u,2))/n}},{key:"updateView",value:function(t){}},{key:"getOverlayContainer",value:function(){}},{key:"exportMap",value:function(t){var e,n=null===(e=this.getContainer())||void 0===e?void 0:e.getElementsByClassName("amap-layer")[0];return"jpg"===t?null==n?void 0:n.toDataURL("image/jpeg"):null==n?void 0:n.toDataURL("image/png")}},{key:"emit",value:function(t){for(var e,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];(e=this.eventEmitter).emit.apply(e,[t].concat(r))}},{key:"once",value:function(t){for(var e,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];(e=this.eventEmitter).once.apply(e,[t].concat(r))}},{key:"destroy",value:function(){var t,e;null===(t=this.$mapContainer)||void 0===t||null===(e=t.parentNode)||void 0===e||e.removeChild(this.$mapContainer),delete window.initAMap;var n=document.getElementById("amap-script");n&&document.head.removeChild(n),this.map.destroy()}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"onCameraChanged",value:function(t){this.cameraChangedCallback=t}},{key:"handleAfterMapChange",value:function(){this.emit("mapAfterFrameChange")}},{key:"creatMapContainer",value:function(t){var e=t;"string"==typeof t&&(e=document.getElementById(t));var n=document.createElement("div");return n.style.cssText+="\n       position: absolute;\n       top: 0;\n       height: 100%;\n       width: 100%;\n     ",n.id="l7_amap_div"+dtt++,e.appendChild(n),n}}]),t}(),ott=j3(itt.prototype,"configService",[Q9],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),att=j3(itt.prototype,"config",[ttt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),stt=j3(itt.prototype,"coordinateSystemService",[ett],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),utt=j3(itt.prototype,"eventEmitter",[ntt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rtt=itt))||rtt),btt=function(){function t(){mZ(this,t),$q(this,"projectionMatrix",no()),$q(this,"viewMatrix",no()),$q(this,"viewProjectionMatrix",no()),$q(this,"ViewProjectionMatrixUncentered",no()),$q(this,"viewUncenteredMatrix",no())}return gZ(t,[{key:"syncWithMapCamera",value:function(t){var e=t.zoom,n=void 0===e?1:e,r=t.center,i=void 0===r?[0,0]:r,o=t.offsetOrigin,a=void 0===o?[0,0]:o,s=t.cameraPosition,u=void 0===s?[0,0,0]:s,c=t.up,l=void 0===c?[0,1,0]:c,h=t.lookAt,f=void 0===h?[0,0,0]:h,p=t.aspect,d=void 0===p?1:p,m=t.near,v=void 0===m?.1:m,g=t.far,y=void 0===g?1e3:g,x=t.fov,b=void 0===x?45:x;this.zoom=n,this.center=i,To(this.projectionMatrix,b/180*Math.PI,d,v,y);var _=Bo.apply(ga,Xq(u)),w=Bo.apply(ga,Xq(f)),S=Bo.apply(ga,Xq(l));ko(this.viewMatrix,_,w,S),this.viewUncenteredMatrix=ro(this.viewMatrix),fo(this.viewMatrix,this.viewMatrix,Bo(-a[0],a[1],0)),ho(this.viewProjectionMatrix,this.projectionMatrix,this.viewMatrix),ho(this.ViewProjectionMatrixUncentered,this.projectionMatrix,this.viewMatrix)}},{key:"getZoom",value:function(){return this.zoom}},{key:"getZoomScale",value:function(){return 1048576}},{key:"getCenter",value:function(){var t=lZ(this.center,2);return[t[0],t[1]]}},{key:"getProjectionMatrix",value:function(){return this.projectionMatrix}},{key:"getModelMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},{key:"getViewMatrix",value:function(){return this.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewUncenteredMatrix}},{key:"getViewProjectionMatrix",value:function(){return this.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.ViewProjectionMatrixUncentered}},{key:"getFocalDistance",value:function(){return 1.2}},{key:"projectFlat",value:function(t){var e=85.0511287798,n=Math.max(Math.min(e,t[1]),-e),r=256<<20,i=Math.PI/180,o=t[0]*i,a=n*i;a=Math.log(Math.tan(Math.PI/4+a/2));return[o=r*(.5/Math.PI*o+.5)-215440491,a=-(r*(-.5/Math.PI*a+(i=.5))-106744817)]}}]),t}(),_tt=["id","style","minZoom","maxZoom","token","mapInstance","plugin","version"];function wtt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}!function(t,e){var n="undefined"!=typeof my&&!!my&&"function"==typeof my.showToast&&!0!==my.isFRM,r="undefined"!=typeof wx&&null!==wx&&(void 0!==wx.request||void 0!==wx.miniProgram);if(!n&&!r&&(e||(e=document),e)){var i=e.head||e.getElementsByTagName("head")[0];if(!i){i=e.createElement("head");var o=e.body||e.getElementsByTagName("body")[0];o?o.parentNode.insertBefore(i,o):e.documentElement.appendChild(i)}var a=e.createElement("style");a.type="text/css",a.styleSheet?a.styleSheet.cssText=t:a.appendChild(e.createTextNode(t)),i.appendChild(a)}}(".amap-logo{\n display: none !important;\n}\n");var Stt=[108.92361,34.54083];window.forceWebGL=!0;var Mtt="ff533602d57df6f8ab3b0fea226ae52f",Ett=Z2()(mtt=function(t){wZ(r,xtt);var e,n=wtt(r);function r(){var t;mZ(this,r);for(var e=arguments.length,i=new Array(e),o=0;o<e;o++)i[o]=arguments[o];return $q(SZ(t=n.call.apply(n,[this].concat(i))),"version",P9["GAODE2.x"]),$q(SZ(t),"handleViewChanged",(function(e){var n=t.map.customCoords.getCameraParams(),r=n.fov,i=n.near,o=n.far,a=n.aspect,s=n.position,u=n.lookAt,c=n.up;t.emit("mapchange");var l=t.map.customCoords.getCenter();t.cameraChangedCallback&&(t.viewport.syncWithMapCamera({aspect:a,far:o,fov:r,cameraPosition:s,lookAt:u,up:c,near:i,zoom:t.map.getZoom()-1,center:l,offsetOrigin:[s[0],s[1]]}),t.coordinateSystemService.setCoordinateSystem(B3.P20_2),t.cameraChangedCallback(t.viewport))})),t}return gZ(r,[{key:"setCustomCoordCenter",value:function(t){this.sceneCenter=t,this.sceneCenterMKT=vK.apply(void 0,Xq(t))}},{key:"getCustomCoordCenter",value:function(){return this.sceneCenterMKT}},{key:"lngLatToCoordByLayer",value:function(t,e){var n=e||this.sceneCenter,r=vK.apply(void 0,Xq(n)),i=this._sub(vK(t[0],t[1]),r);return t[2]&&i.push(t[2]),i}},{key:"lngLatToCoordsByLayer",value:function(t,e){var n=this;return t.map((function(t){return"number"==typeof t[0]?n.lngLatToCoordByLayer(t,e):t.map((function(t){return n.lngLatToCoordByLayer(t,e)}))}))}},{key:"setCoordCenter",value:function(t){this.map.customCoords.setCenter(t||Stt),this.setCustomCoordCenter(t||Stt)}},{key:"lngLatToCoord",value:function(t){return this.sceneCenter||(this.map.customCoords.setCenter(t),this.setCustomCoordCenter(t)),this._sub(vK(t[0],t[1]),this.sceneCenterMKT)}},{key:"lngLatToCoords",value:function(t){var e=this;return t.map((function(t){return"number"==typeof t[0]?e.lngLatToCoord(t):t.map((function(t){return e.lngLatToCoord(t)}))}))}},{key:"addMarkerContainer",value:function(){if(this.map){var t=this.map.getContainer();if(null!==t){var e=t.getElementsByClassName("amap-maps")[0];e.style.zIndex="auto",this.markerContainer=z$("div","l7-marker-container2",e)}}}},{key:"updateView",value:function(t){}},{key:"getOverlayContainer",value:function(){}},{key:"getType",value:function(){return"amap2"}},{key:"getBounds",value:function(){var t=this.map.getBounds(),e=t.getNorthEast(),n=t.getSouthWest(),r=this.getCenter(),i=r.lng>e.getLng()||r.lng<n.getLng()?180-e.getLng():e.getLng();return[[r.lng<n.getLng()?n.getLng()-180:n.getLng(),n.getLat()],[i,e.getLat()]]}},{key:"getMinZoom",value:function(){return this.map.getZooms()[0]-1}},{key:"getMaxZoom",value:function(){return this.map.getZooms()[1]-1}},{key:"lngLatToContainer",value:function(t){var e=this.map.lngLatToContainer(t);return{x:e.getX(),y:e.getY()}}},{key:"getModelMatrix",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1,1],i=this.map.customCoords.lngLatToCoord(t),o=no();return fo(o,o,Bo(i[0],i[1],e)),po(o,o,Bo(r[0],r[1],r[2])),mo(o,o,n[0]),vo(o,o,n[1]),go(o,o,n[2]),o}},{key:"init",value:(e=RK(jK.mark((function t(){var e,n,r,i,o,a,s,u,c,l,h,f,p,d,m,v,g,y,x,b;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=this.config,n=e.id,r=e.style,i=void 0===r?"light":r,o=e.minZoom,a=void 0===o?0:o,s=e.maxZoom,u=void 0===s?18:s,c=e.token,l=void 0===c?Mtt:c,h=e.mapInstance,f=e.plugin,p=void 0===f?[]:f,e.version,d=v1(e,_tt),this.viewport=new btt,window.AMap||h){t.next=6;break}return p.push("Map3D"),t.next=6,k9.load({key:l,version:"2.0",plugins:p});case 6:h?(this.map=h,this.$mapContainer=this.map.getContainer(),v=this.map.getCenter(),null===(m=this.map.customCoords)||void 0===m||m.setCenter([v.lng,v.lat]),this.setCustomCoordCenter([v.lng,v.lat]),this.map.on("viewchange",this.handleViewChanged)):(this.$mapContainer=this.creatMapContainer(n),(y=Jq({mapStyle:this.getMapStyleValue(i),zooms:[a,u],viewMode:"3D"},d)).zoom&&(y.zoom+=1),x=new AMap.Map(this.$mapContainer,y),this.map=x,b=x.getCenter(),null===(g=this.map.customCoords)||void 0===g||g.setCenter([b.lng,b.lat]),this.setCustomCoordCenter([b.lng,b.lat]),x.on("viewchange",this.handleViewChanged)),this.initViewPort();case 8:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"onCameraChanged",value:function(t){this.cameraChangedCallback=t}},{key:"initViewPort",value:function(){var t,e=null===(t=this.map.customCoords)||void 0===t?void 0:t.getCameraParams(),n=e.fov,r=e.near,i=e.far,o=e.aspect,a=e.position,s=e.lookAt,u=e.up;this.emit("mapchange");var c=this.map.customCoords.getCenter(),l=this.map.getZoom();this.cameraChangedCallback&&(this.viewport.syncWithMapCamera({aspect:o,far:i,fov:n,cameraPosition:a,lookAt:s,near:r,up:u,zoom:l-1,center:c,offsetOrigin:[a[0],a[1]]}),this.coordinateSystemService.setCoordinateSystem(B3.P20_2),this.cameraChangedCallback(this.viewport))}},{key:"_sub",value:function(t,e){var n=[0,0];return n[0]=t[0]-e[0],n[1]=t[1]-e[1],n}}]),r}())||mtt;function Att(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var Ttt=function(t){wZ(n,C9);var e=Att(n);function n(){return mZ(this,n),e.apply(this,arguments)}return gZ(n,[{key:"getServiceConstructor",value:function(){return Ett}}]),n}();function Ctt(t,e){t.length>0&&e.version===P9.SIMPLE&&t.map((function(t){t.simpleCoordinate||(t.coordinates=function(t,e){if("number"==typeof t[0])return e.simpleMapCoord.unproject(t);if(t[0]&&t[0][0]instanceof Array){var n=[];return t.map((function(t){var r=[];t.map((function(t){r.push(e.simpleMapCoord.unproject(t))})),n.push(r)})),n}var r=[];return t.map((function(t){r.push(e.simpleMapCoord.unproject(t))})),r}(t.coordinates,e),t.simpleCoordinate=!0)}))}function Ott(t,e,n,r,i){var o=(null==i?void 0:i.getLayerConfig()).arrow,a=void 0===o?{enable:!1}:o,s=e.map((function(e){var r,i,o,s={id:e._id,coordinates:e.coordinates};if(t.filter((function(t){return void 0!==t.scale})).forEach((function(t){var r=function(t,e){var n;if(!t.scale)return[];var r=(null==t||null===(n=t.scale)||void 0===n?void 0:n.scalers)||[],i=[];return r.forEach((function(n){var r,o=n.field;(e.hasOwnProperty(o)||"variable"===(null===(r=t.scale)||void 0===r?void 0:r.type))&&i.push(e[o])})),t.mapping?t.mapping(i):[]}(t,e);t.needRemapping=!1,"color"===t.name&&(r=r.map((function(t){return EK(t)}))),s[t.name]=Array.isArray(r)&&1===r.length?r[0]:r,"shape"===t.name&&(s.shape=n.getIconFontKey(s[t.name]))})),"line"===s.shape&&a.enable){var u=s.coordinates,c=(r=u[0],i=u[1],o=bK([i[0]-r[0],i[1]-r[1]]),[r[0]+1e-4*o[0],r[1]+1e-4*o[1]]);s.coordinates.splice(1,0,c,c)}return s}));return function(t,e,n){if(t.length>0&&e.version===P9["GAODE2.x"]){var r=n.coordCenter;"number"==typeof t[0].coordinates[0]?t.filter((function(t){return!t.originCoordinates})).map((function(t){t.version=P9["GAODE2.x"],t.originCoordinates=hZ.cloneDeep(t.coordinates),t.coordinates=e.lngLatToCoordByLayer(t.coordinates,r)})):t.filter((function(t){return!t.originCoordinates})).map((function(t){t.version=P9["GAODE2.x"],t.originCoordinates=hZ.cloneDeep(t.coordinates),t.coordinates=e.lngLatToCoordsByLayer(t.coordinates,r)}))}}(s,r,i),Ctt(s,r),s}function ktt(t){return t.map((function(t){return"string"==typeof t&&(t=[t,{}]),t}))}function Ptt(t,e,n,r){var i=t.multiPassRenderer;return t.getLayerConfig().enableTAA?i.add(r("taa")):i.add(r("render")),ktt(e).forEach((function(t){var e=lZ(t,2),r=e[0],o=e[1];i.add(n(r),o)})),i.add(n("copy")),i}var Ltt,Rtt,Itt,Ntt=function(){function t(e){mZ(this,t),this.layer=e}return gZ(t,[{key:"pickRender",value:function(t){var e=this.layer;if(e.tileLayer)return e.tileLayer.pickRender(t);e.hooks.beforePickingEncode.call(),e.masks.length>0&&e.masks.filter((function(t){return t.inited})).forEach(function(){var t=RK(jK.mark((function t(e){return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.render();case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),e.renderModels(!0),e.hooks.afterPickingEncode.call()}},{key:"pick",value:function(t,e){var n=this.layer.getContainer().get(J2.IPickingService);return"RasterLayer"===t.type?this.pickRasterLayer(t,e):(this.pickRender(e),n.pickFromPickingFBO(t,e))}},{key:"pickRasterLayer",value:function(t,e,n){var r=this.layer.getContainer(),i=r.get(J2.IPickingService),o=r.get(J2.IMapService),a=this.layer.getSource().extent,s=function(t,e){var n=lZ(e,4),r=n[0],i=n[1],o=n[2],a=n[3];return t.lng>r&&t.lng<=o&&t.lat>i&&t.lat<=a}(e.lngLat,a),u={x:e.x,y:e.y,type:e.type,lngLat:e.lngLat,target:e,rasterValue:null},c=n||t;if(s){var l=this.readRasterValue(t,a,o,e.x,e.y);return u.rasterValue=l,i.triggerHoverOnLayer(c,u),!0}return u.type="mousemove"===e.type?"mouseout":"un"+e.type,i.triggerHoverOnLayer(c,Jq(Jq({},u),{},{type:"unpick"})),i.triggerHoverOnLayer(c,u),!1}},{key:"readRasterValue",value:function(t,e,n,r,i){var o=t.getSource().data.dataArray[0],a=lZ(e,4),s=a[0],u=void 0===s?0:s,c=a[1],l=void 0===c?0:c,h=a[2],f=void 0===h?10:h,p=a[3],d=void 0===p?-10:p,m=n.lngLatToContainer([u,l]),v=n.lngLatToContainer([f,d]),g=v.x-m.x,y=m.y-v.y,x=[(r-m.x)/g,(i-v.y)/y],b=o.width||1,_=o.height||1,w=Math.floor(x[0]*b),S=Math.floor(x[1]*_),M=Math.max(0,S-1)*b+w;return o.data[M]}},{key:"selectFeature",value:function(t){var e=this.layer,n=lZ(t,3),r=n[0],i=n[1],o=n[2];e.hooks.beforeSelect.call([r,i,o])}},{key:"highlightPickedFeature",value:function(t){var e=lZ(t,3),n=e[0],r=e[1],i=e[2];this.layer.hooks.beforeHighlight.call([n,r,i])}},{key:"getFeatureById",value:function(t){return this.layer.getSource().getFeatureById(t)}}]),t}(),Dtt=function(){function t(e){mZ(this,t),this.layer=e;var n=this.layer.getContainer();this.rendererService=n.get(J2.IRendererService)}return gZ(t,[{key:"getColorTexture",value:function(t,e){var n=this.getTextureKey(t,e);return this.key===n||(this.createColorTexture(t,e),this.key=n),this.colorTexture}},{key:"createColorTexture",value:function(t,e){var n=this.rendererService.createTexture2D,r=this.getColorRampBar(t,e),i=n({data:r.data,width:r.width,height:r.height,flipY:!1});return this.colorTexture=i,i}},{key:"setColorTexture",value:function(t,e,n){this.key=this.getTextureKey(e,n),this.colorTexture=t}},{key:"destroy",value:function(){var t;null===(t=this.colorTexture)||void 0===t||t.destroy()}},{key:"getColorRampBar",value:function(t,e){switch(t.type){case"cat":return function(t){var e=F$.document.createElement("canvas"),n=e.getContext("2d");e.width=256,e.height=1;var r=n.createImageData(256,1);return r.data.fill(0),t.positions.forEach((function(e,n){var i=EK(t.colors[n]);r.data[4*e+0]=255*i[0],r.data[4*e+1]=255*i[1],r.data[4*e+2]=255*i[2],r.data[4*e+3]=255*i[3]})),e=null,n=null,r}(t);case"quantize":return function(t){var e=F$.document.createElement("canvas"),n=e.getContext("2d");n.globalAlpha=1,e.width=256,e.height=1;for(var r=256/t.colors.length,i=0;i<t.colors.length;i++)n.beginPath(),n.lineWidth=2,n.strokeStyle=t.colors[i],n.moveTo(i*r,0),n.lineTo((i+1)*r,0),n.stroke();var o=n.getImageData(0,0,256,1).data,a=OK(n,o);return e=null,n=null,a}(t);case"custom":return function(t,e){var n=F$.document.createElement("canvas"),r=n.getContext("2d");r.globalAlpha=1,n.width=256,n.height=1;var i=e[1]-e[0];t.positions.length,t.colors.length;for(var o=0;o<t.colors.length;o++)r.beginPath(),r.lineWidth=2,r.strokeStyle=t.colors[o],r.moveTo((t.positions[o]-e[0])/i*255,0),r.lineTo((t.positions[o+1]-e[0])/i*255,0),r.stroke();var a=r.getImageData(0,0,256,1).data,s=OK(r,a);return n=null,r=null,s}(t,e);case"linear":return function(t,e){var n=F$.document.createElement("canvas"),r=n.getContext("2d");n.width=256,n.height=1;for(var i=r.createLinearGradient(0,0,256,1),o=e[1]-e[0],a=0;a<t.colors.length;++a){var s=Math.max((t.positions[a]-e[0])/o,0);i.addColorStop(s,t.colors[a])}r.fillStyle=i,r.fillRect(0,0,256,1);var u=r.getImageData(0,0,256,1).data,c=OK(r,u);return n=null,r=null,c}(t,e);default:return CK(t)}}},{key:"getTextureKey",value:function(t,e){var n;return"".concat(t.colors.join("_"),"_").concat(null==t||null===(n=t.positions)||void 0===n?void 0:n.join("_"),"_").concat(t.type,"_").concat(null==e?void 0:e.join("_"))}}]),t}(),Ftt=["passes"],jtt=["moduleName","vertexShader","fragmentShader","triangulation","segmentNumber","workerEnabled","workerOptions"];function Btt(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return ztt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ztt(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function ztt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Utt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var Vtt,Gtt,Wtt,Htt=0,Ytt=(Ltt=x8(J2.IGlobalConfigService),Rtt=function(t){wZ(c,hc.EventEmitter);var e,n,r,i,o,a,s,u=Utt(c);function c(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return mZ(this,c),$q(SZ(t=u.call(this)),"id","".concat(Htt++)),$q(SZ(t),"name","".concat(Htt)),$q(SZ(t),"visible",!0),$q(SZ(t),"zIndex",0),$q(SZ(t),"inited",!1),$q(SZ(t),"layerModelNeedUpdate",!1),$q(SZ(t),"pickedFeatureID",null),$q(SZ(t),"selectedFeatureID",null),$q(SZ(t),"styleNeedUpdate",!1),$q(SZ(t),"forceRender",!1),$q(SZ(t),"clusterZoom",0),$q(SZ(t),"defaultSourceConfig",{data:[],options:{parser:{type:"json"}}}),$q(SZ(t),"dataState",{dataSourceNeedUpdate:!1,dataMappingNeedUpdate:!1,filterNeedUpdate:!1,featureScaleNeedUpdate:!1,StyleAttrNeedUpdate:!1}),$q(SZ(t),"hooks",{init:new H5,afterInit:new G5,beforeRender:new G5,beforeRenderData:new Y5,afterRender:new j5,beforePickingEncode:new j5,afterPickingEncode:new j5,beforeHighlight:new j5(["pickedColor"]),afterHighlight:new j5,beforeSelect:new j5(["pickedColor"]),afterSelect:new j5,beforeDestroy:new j5,afterDestroy:new j5}),$q(SZ(t),"models",[]),$q(SZ(t),"startInit",!1),$q(SZ(t),"layerChildren",[]),$q(SZ(t),"masks",[]),F3(SZ(t),"configService",Itt,SZ(t)),$q(SZ(t),"animateOptions",{enable:!1}),$q(SZ(t),"currentPickId",null),$q(SZ(t),"pendingStyleAttributes",[]),$q(SZ(t),"scaleOptions",{}),$q(SZ(t),"animateStatus",!1),$q(SZ(t),"isDestroyed",!1),$q(SZ(t),"encodeDataLength",0),$q(SZ(t),"sourceEvent",(function(){t.dataState.dataSourceNeedUpdate=!0;var e=t.getLayerConfig();e&&e.autoFit&&t.fitBounds(e.fitBoundsOptions),t.layerSource.getSourceCfg().autoRender&&t.reRender()})),t.name=e.name||t.id,t.zIndex=e.zIndex||0,t.rawConfig=e,t}return gZ(c,[{key:"addMaskLayer",value:function(t){this.masks.push(t)}},{key:"removeMaskLayer",value:function(t){var e=this.masks.indexOf(t);e>-1&&this.masks.splice(e,1),t.destroy()}},{key:"getAttribute",value:function(t){return this.styleAttributeService.getLayerStyleAttribute(t)}},{key:"getLayerConfig",value:function(){return this.configService.getLayerConfig(this.id)}},{key:"updateLayerConfig",value:function(t){var e=this;if(Object.keys(t).map((function(n){n in e.rawConfig&&(e.rawConfig[n]=t[n])})),this.startInit){var n=this.container.get(J2.SceneID);E9(t,this),this.configService.setLayerConfig(n,this.id,Jq(Jq(Jq({},this.configService.getLayerConfig(this.id)),this.needUpdateConfig),t)),this.needUpdateConfig={}}else this.needUpdateConfig=Jq(Jq({},this.needUpdateConfig),t)}},{key:"setContainer",value:function(t,e){this.container=t,this.sceneContainer=e}},{key:"getContainer",value:function(){return this.container}},{key:"addPlugin",value:function(t){return this.plugins.push(t),this}},{key:"init",value:(s=RK(jK.mark((function t(){var e,n,r,i,o,a,s=this;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=this.container.get(J2.SceneID),this.startInit=!0,this.configService.setLayerConfig(e,this.id,this.rawConfig),this.layerType=this.rawConfig.layerType,this.iconService=this.container.get(J2.IIconService),this.fontService=this.container.get(J2.IFontService),this.rendererService=this.container.get(J2.IRendererService),this.layerService=this.container.get(J2.ILayerService),this.interactionService=this.container.get(J2.IInteractionService),this.pickingService=this.container.get(J2.IPickingService),this.mapService=this.container.get(J2.IMapService),n=this.getLayerConfig(),r=n.enableMultiPassRenderer,i=n.passes,r&&null!=i&&i.length&&i.length>0&&this.mapService.on("mapAfterFrameChange",(function(){s.renderLayers()})),this.cameraService=this.container.get(J2.ICameraService),this.coordinateService=this.container.get(J2.ICoordinateSystemService),this.shaderModuleService=this.container.get(J2.IShaderModuleService),this.postProcessingPassFactory=this.container.get(J2.IFactoryPostProcessingPass),this.normalPassFactory=this.container.get(J2.IFactoryNormalPass),this.styleAttributeService=this.container.get(J2.IStyleAttributeService),r&&(this.multiPassRenderer=this.container.get(J2.IMultiPassRenderer),this.multiPassRenderer.setLayer(this)),this.pendingStyleAttributes.forEach((function(t){var e=t.attributeName,n=t.attributeField,r=t.attributeValues,i=t.updateOptions;s.styleAttributeService.updateStyleAttribute(e,{scale:Jq({field:n},s.splitValuesAndCallbackInAttribute(r,s.getLayerConfig()[e]))},i)})),this.pendingStyleAttributes=[],this.plugins=this.container.getAll(J2.ILayerPlugin),o=Btt(this.plugins);try{for(o.s();!(a=o.n()).done;)a.value.apply(this,{rendererService:this.rendererService,mapService:this.mapService,styleAttributeService:this.styleAttributeService,normalPassFactory:this.normalPassFactory,postProcessingPassFactory:this.postProcessingPassFactory})}catch(u){o.e(u)}finally{o.f()}return this.layerPickService=new Ntt(this),this.textureService=new Dtt(this),t.next=29,this.hooks.init.promise();case 29:this.inited=!0,this.emit("inited",{target:this,type:"inited"}),this.emit("add",{target:this,type:"add"}),this.hooks.afterInit.call();case 33:case"end":return t.stop()}}),t,this)}))),function(){return s.apply(this,arguments)})},{key:"updateModelData",value:function(t){t.attributes&&t.elements&&this.models.map((function(e){e.updateAttributesAndElements(t.attributes,t.elements)}))}},{key:"createModelData",value:function(t,e){var n;if(null!==(n=this.layerModel)&&void 0!==n&&n.createModelData)return this.layerModel.createModelData(e);var r=this.calculateEncodeData(t,e),i=this.triangulation;return r&&i?this.styleAttributeService.createAttributesAndIndices(r,i):{attributes:void 0,elements:void 0}}},{key:"setLayerPickService",value:function(t){this.layerPickService=t}},{key:"calculateEncodeData",value:function(t,e){return this.inited?function(t,e,n,r,i,o){var a=new K8(i,o),s=Ott(r.getLayerStyleAttributes()||[],a.data.dataArray,e,n,t);return a.destroy(),s}(this,this.fontService,this.mapService,this.styleAttributeService,t,e):null}},{key:"prepareBuildModel",value:function(){this.updateLayerConfig(Jq(Jq(Jq({},this.getDefaultConfig()),this.rawConfig),this.needUpdateConfig));var t=this.getLayerConfig().animateOption;null!=t&&t.enable&&(this.layerService.startAnimate(),this.animateStatus=!0)}},{key:"color",value:function(t,e,n){return this.updateStyleAttribute("color",t,e,n),this}},{key:"texture",value:function(t,e,n){return this.updateStyleAttribute("texture",t,e,n),this}},{key:"rotate",value:function(t,e,n){return this.updateStyleAttribute("rotate",t,e,n),this}},{key:"size",value:function(t,e,n){return this.updateStyleAttribute("size",t,e,n),this}},{key:"filter",value:function(t,e,n){var r=this.updateStyleAttribute("filter",t,e,n);return this.dataState.dataSourceNeedUpdate=r,this}},{key:"shape",value:function(t,e,n){this.shapeOption={field:t,values:e};var r=this.updateStyleAttribute("shape",t,e,n);return this.dataState.dataSourceNeedUpdate=r,this}},{key:"label",value:function(t,e,n){return this.pendingStyleAttributes.push({attributeName:"label",attributeField:t,attributeValues:e,updateOptions:n}),this}},{key:"animate",value:function(t){var e={};return hZ.isObject(t)?(e.enable=!0,e=Jq(Jq({},e),t)):e.enable=t,this.updateLayerConfig({animateOption:e}),this}},{key:"source",value:function(t,e){return"source"===(null==t?void 0:t.type)?(this.setSource(t),this):(this.sourceOption={data:t,options:e},this.clusterZoom=0,this)}},{key:"setData",value:function(t,e){var n=this;return this.inited?this.layerSource.setData(t,e):this.on("inited",(function(){n.getSource()?n.layerSource.setData(t,e):n.source(new K8(t,e))})),this}},{key:"style",value:function(t){var e=this,n=t.passes,r=v1(t,Ftt);return n&&ktt(n).forEach((function(t){var n=e.multiPassRenderer.getPostProcessor().getPostProcessingPassByName(t[0]);n&&n.updateOptions(t[1])})),this.rawConfig=Jq(Jq({},this.rawConfig),r),this.container&&(this.updateLayerConfig(this.rawConfig),this.styleNeedUpdate=!0),this}},{key:"scale",value:function(t,e){return hZ.isObject(t)?this.scaleOptions=Jq(Jq({},this.scaleOptions),t):this.scaleOptions[t]=e,this}},{key:"renderLayers",value:function(){this.rendering=!0,this.layerService.renderLayers(),this.rendering=!1}},{key:"render",value:function(){return this.tileLayer?(this.tileLayer.render(),this):(this.layerService.beforeRenderData(this),this.encodeDataLength<=0&&!this.forceRender||this.renderModels(),this)}},{key:"renderMultiPass",value:(a=RK(jK.mark((function t(){return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(this.encodeDataLength<=0)||this.forceRender){t.next=2;break}return t.abrupt("return");case 2:if(!this.multiPassRenderer||!this.multiPassRenderer.getRenderFlag()){t.next=7;break}return t.next=5,this.multiPassRenderer.render();case 5:t.next=8;break;case 7:this.multiPassRenderer,this.renderModels();case 8:case"end":return t.stop()}}),t,this)}))),function(){return a.apply(this,arguments)})},{key:"active",value:function(t){var e={};return e.enableHighlight=!!hZ.isObject(t)||t,hZ.isObject(t)?(e.enableHighlight=!0,t.color&&(e.highlightColor=t.color),t.mix&&(e.activeMix=t.mix)):e.enableHighlight=!!t,this.updateLayerConfig(e),this}},{key:"setActive",value:function(t,e){var n=this;if(hZ.isObject(t)){var r=t.x,i=void 0===r?0:r,o=t.y,a=void 0===o?0:o;this.updateLayerConfig({highlightColor:hZ.isObject(e)?e.color:this.getLayerConfig().highlightColor,activeMix:hZ.isObject(e)?e.mix:this.getLayerConfig().activeMix}),this.pick({x:i,y:a})}else this.updateLayerConfig({pickedFeatureID:t,highlightColor:hZ.isObject(e)?e.color:this.getLayerConfig().highlightColor,activeMix:hZ.isObject(e)?e.mix:this.getLayerConfig().activeMix}),this.hooks.beforeSelect.call(TK(t)).then((function(){setTimeout((function(){n.reRender()}),1)}))}},{key:"select",value:function(t){var e={};return e.enableSelect=!!hZ.isObject(t)||t,hZ.isObject(t)?(e.enableSelect=!0,t.color&&(e.selectColor=t.color),t.mix&&(e.selectMix=t.mix)):e.enableSelect=!!t,this.updateLayerConfig(e),this}},{key:"setSelect",value:function(t,e){var n=this;if(hZ.isObject(t)){var r=t.x,i=void 0===r?0:r,o=t.y,a=void 0===o?0:o;this.updateLayerConfig({selectColor:hZ.isObject(e)?e.color:this.getLayerConfig().selectColor,selectMix:hZ.isObject(e)?e.mix:this.getLayerConfig().selectMix}),this.pick({x:i,y:a})}else this.updateLayerConfig({pickedFeatureID:t,selectColor:hZ.isObject(e)?e.color:this.getLayerConfig().selectColor,selectMix:hZ.isObject(e)?e.mix:this.getLayerConfig().selectMix}),this.hooks.beforeSelect.call(TK(t)).then((function(){setTimeout((function(){n.reRender()}),1)}))}},{key:"setBlend",value:function(t){return this.updateLayerConfig({blend:t}),this.layerModelNeedUpdate=!0,this.reRender(),this}},{key:"show",value:function(){return this.updateLayerConfig({visible:!0}),this.reRender(),this.emit("show"),this}},{key:"hide",value:function(){return this.updateLayerConfig({visible:!1}),this.reRender(),this.emit("hide"),this}},{key:"setIndex",value:function(t){return this.zIndex=t,this.layerService.updateLayerRenderList(),this.layerService.renderLayers(),this}},{key:"setCurrentPickId",value:function(t){this.currentPickId=t}},{key:"getCurrentPickId",value:function(){return this.currentPickId}},{key:"setCurrentSelectedId",value:function(t){this.selectedFeatureID=t}},{key:"getCurrentSelectedId",value:function(){return this.selectedFeatureID}},{key:"isVisible",value:function(){var t=this.mapService.getZoom(),e=this.getLayerConfig(),n=e.visible,r=e.minZoom,i=void 0===r?-1/0:r,o=e.maxZoom;return!!n&&t>=i&&t<(void 0===o?1/0:o)}},{key:"setMultiPass",value:function(t,e){if(this.updateLayerConfig({enableMultiPassRenderer:t}),e&&this.updateLayerConfig({passes:e}),t){var n=this.getLayerConfig().passes,r=void 0===n?[]:n;this.multiPassRenderer=Ptt(this,r,this.postProcessingPassFactory,this.normalPassFactory),this.multiPassRenderer.setRenderFlag(!0);var i=this.rendererService.getViewportSize(),o=i.width,a=i.height;this.multiPassRenderer.resize(o,a)}return this}},{key:"setMinZoom",value:function(t){return this.updateLayerConfig({minZoom:t}),this}},{key:"getMinZoom",value:function(){return this.getLayerConfig().minZoom}},{key:"getMaxZoom",value:function(){return this.getLayerConfig().maxZoom}},{key:"get",value:function(t){return this.getLayerConfig()[t]}},{key:"setMaxZoom",value:function(t){return this.updateLayerConfig({maxZoom:t}),this}},{key:"setAutoFit",value:function(t){return this.updateLayerConfig({autoFit:t}),this}},{key:"fitBounds",value:function(t){if(!this.inited)return this.updateLayerConfig({autoFit:!0}),this;var e=this.getSource().extent;return e.some((function(t){return Math.abs(t)===1/0}))||this.mapService.fitBounds([[e[0],e[1]],[e[2],e[3]]],t),this}},{key:"destroy",value:function(){var t,e,n,r=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isDestroyed||(this.layerChildren.map((function(t){return t.destroy(!1)})),this.layerChildren=[],this.masks.map((function(t){return t.destroy(!1)})),this.masks=[],this.hooks.beforeDestroy.call(),this.layerSource.off("update",this.sourceEvent),null===(t=this.multiPassRenderer)||void 0===t||t.destroy(),this.textureService.destroy(),this.styleAttributeService.clearAllAttributes(),this.hooks.afterDestroy.call(),null===(e=this.layerModel)||void 0===e||e.clearModels(r),null===(n=this.tileLayer)||void 0===n||n.destroy(),this.models=[],this.emit("remove",{target:this,type:"remove"}),this.emit("destroy",{target:this,type:"destroy"}),this.removeAllListeners(),this.isDestroyed=!0)}},{key:"clear",value:function(){this.styleAttributeService.clearAllAttributes()}},{key:"clearModels",value:function(){var t;this.models.forEach((function(t){return t.destroy()})),null===(t=this.layerModel)||void 0===t||t.clearModels(),this.models=[]}},{key:"isDirty",value:function(){return!!(this.styleAttributeService.getLayerStyleAttributes()||[]).filter((function(t){return t.needRescale||t.needRemapping||t.needRegenerateVertices})).length}},{key:"setSource",value:function(t){var e=this;if(this.layerSource&&this.layerSource.off("update",this.sourceEvent),this.layerSource=t,this.clusterZoom=0,this.inited&&this.layerSource.cluster){var n=this.mapService.getZoom();this.layerSource.updateClusterData(n)}this.layerSource.inited&&this.sourceEvent(),this.layerSource.on("update",(function(t){var n=t.type;if(void 0===e.coordCenter){var r,i=e.layerSource.center;e.coordCenter=i,null!==(r=e.mapService)&&void 0!==r&&r.setCoordCenter&&e.mapService.setCoordCenter(i)}"update"===n&&e.sourceEvent()}))}},{key:"initSource",value:function(t){this.layerSource=t,this.clusterZoom=0,this.addSourceEvent()}},{key:"getSource",value:function(){return this.layerSource}},{key:"addSourceEvent",value:function(){var t=this;this.layerSource.on("update",(function(){if(void 0===t.coordCenter){var e,n=t.layerSource.center;t.coordCenter=n,null!==(e=t.mapService)&&void 0!==e&&e.setCoordCenter&&t.mapService.setCoordCenter(n)}t.sourceEvent()}))}},{key:"getScaleOptions",value:function(){return this.scaleOptions}},{key:"setEncodedData",value:function(t){this.encodedData=t,this.encodeDataLength=t.length}},{key:"getEncodedData",value:function(){return this.encodedData}},{key:"getScale",value:function(t){return this.styleAttributeService.getLayerAttributeScale(t)}},{key:"getLegend",value:function(t){var e,n,r,i=this.styleAttributeService.getLayerStyleAttribute(t);return{type:null===(n=((null==i||null===(e=i.scale)||void 0===e?void 0:e.scalers)||[])[0].option)||void 0===n?void 0:n.type,field:null==i||null===(r=i.scale)||void 0===r?void 0:r.field,items:this.getLegendItems(t)}}},{key:"getLegendItems",value:function(t){var e=this.styleAttributeService.getLayerAttributeScale(t);return e?e.invertExtent?e.range().map((function(n){return $q({value:e.invertExtent(n)},t,n)})):e.ticks?e.ticks().map((function(n){return $q({value:n},t,e(n))})):null!=e&&e.domain?e.domain().filter((function(t){return!hZ.isUndefined(t)})).map((function(n){return $q({value:n},t,e(n))})):[]:[]}},{key:"pick",value:function(t){var e=t.x,n=t.y;this.interactionService.triggerHover({x:e,y:n})}},{key:"boxSelect",value:function(t,e){this.pickingService.boxPickLayer(this,t,e)}},{key:"buildLayerModel",value:(o=RK(jK.mark((function t(e){var n,r,i,o,a,s,u,c,l,h,f,p,d,m,v=this;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.moduleName,r=e.vertexShader,i=e.fragmentShader,o=e.triangulation,a=e.segmentNumber,s=e.workerEnabled,u=void 0!==s&&s,c=e.workerOptions,l=v1(e,jtt),this.shaderModuleService.registerModule(n,{vs:r,fs:i}),h=this.shaderModuleService.getModule(n),f=h.vs,p=h.fs,d=h.uniforms,m=this.rendererService.createModel,t.abrupt("return",new Promise((function(t,e){if(c&&c.modelType in aQ&&u)v.styleAttributeService.createAttributesAndIndicesAscy(v.encodedData,a,c).then((function(e){var n=e.attributes,r=e.elements,i=m(Jq({attributes:n,uniforms:d,fs:p,vs:f,elements:r,blend:S9[u8.normal]},l));t(i)})).catch((function(t){return e(t)}));else{var n=v.styleAttributeService.createAttributesAndIndices(v.encodedData,o,a),r=n.attributes,i=n.elements,s=n.count,h=Jq({attributes:r,uniforms:d,fs:p,vs:f,elements:i,blend:S9[u8.normal]},l);s&&(h.count=s);var g=m(h);t(g)}})));case 5:case"end":return t.stop()}}),t,this)}))),function(t){return o.apply(this,arguments)})},{key:"createAttributes",value:function(t){var e=t.triangulation;return this.styleAttributeService.createAttributes(this.encodedData,e).attributes}},{key:"getTime",value:function(){return this.layerService.clock.getDelta()}},{key:"setAnimateStartTime",value:function(){this.animateStartTime=this.layerService.clock.getElapsedTime()}},{key:"stopAnimate",value:function(){this.animateStatus&&(this.layerService.stopAnimate(),this.animateStatus=!1,this.updateLayerConfig({animateOption:{enable:!1}}))}},{key:"getLayerAnimateTime",value:function(){return this.layerService.clock.getElapsedTime()-this.animateStartTime}},{key:"needPick",value:function(t){var e=this.getLayerConfig(),n=e.enableHighlight,r=void 0===n||n,i=e.enableSelect,o=void 0===i||i,a=-1!==this.eventNames().indexOf(t)||-1!==this.eventNames().indexOf("un"+t);return"click"!==t&&"dblclick"!==t||!o||(a=!0),"mousemove"!==t||!r&&-1===this.eventNames().indexOf("mouseenter")&&-1===this.eventNames().indexOf("unmousemove")&&-1===this.eventNames().indexOf("mouseout")||(a=!0),this.isVisible()&&a}},{key:"buildModels",value:(i=RK(jK.mark((function t(){return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:throw new Error("Method not implemented.");case 1:case"end":return t.stop()}}),t)}))),function(){return i.apply(this,arguments)})},{key:"rebuildModels",value:(r=RK(jK.mark((function t(){return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.buildModels();case 2:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"renderMulPass",value:(n=RK(jK.mark((function t(e){return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.render();case 2:case"end":return t.stop()}}),t)}))),function(t){return n.apply(this,arguments)})},{key:"renderModels",value:function(t){var e=this;return this.encodeDataLength<=0&&!this.forceRender||(this.hooks.beforeRender.call(),this.models.forEach((function(n){n.draw({uniforms:e.layerModel.getUninforms()},t)})),this.hooks.afterRender.call()),this}},{key:"updateStyleAttribute",value:function(t,e,n,r){var i=this.configService.getAttributeConfig(this.id)||{};return!hZ.isEqual(i[t],{field:e,values:n})&&(-1!==["color","size","texture","rotate","filter","label","shape"].indexOf(t)&&this.configService.setAttributeConfig(this.id,$q({},t,{field:e,values:n})),this.startInit?this.styleAttributeService.updateStyleAttribute(t,{scale:Jq({field:e},this.splitValuesAndCallbackInAttribute(n,this.getLayerConfig()[e]))},r):this.pendingStyleAttributes.push({attributeName:t,attributeField:e,attributeValues:n,updateOptions:r}),!0)}},{key:"getLayerAttributeConfig",value:function(){return this.configService.getAttributeConfig(this.id)}},{key:"getShaderPickStat",value:function(){return this.layerService.getShaderPickStat()}},{key:"setEarthTime",value:function(t){}},{key:"processData",value:function(t){return t}},{key:"getModelType",value:function(){throw new Error("Method not implemented.")}},{key:"getDefaultConfig",value:function(){return{}}},{key:"initLayerModels",value:(e=RK(jK.mark((function t(){return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.models.forEach((function(t){return t.destroy()})),this.models=[],t.next=4,this.layerModel.initModels();case 4:this.models=t.sent;case 5:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"reRender",value:function(){this.inited&&this.layerService.reRender()}},{key:"splitValuesAndCallbackInAttribute",value:function(t,e){return{values:hZ.isFunction(t)?void 0:t||e,callback:hZ.isFunction(t)?t:void 0}}}]),c}(),Itt=j3(Rtt.prototype,"configService",[Ltt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rtt);function Xtt(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return qtt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return qtt(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function qtt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var Ztt,$tt,Ktt,Jtt,Qtt,tet,eet,net,ret,iet,oet=(Vtt=x8(J2.IGlobalConfigService),Gtt=function(){function t(e){mZ(this,t),F3(this,"configService",Wtt,this),this.layer=e,this.rendererService=e.getContainer().get(J2.IRendererService),this.pickingService=e.getContainer().get(J2.IPickingService),this.shaderModuleService=e.getContainer().get(J2.IShaderModuleService),this.styleAttributeService=e.getContainer().get(J2.IStyleAttributeService),this.mapService=e.getContainer().get(J2.IMapService),this.iconService=e.getContainer().get(J2.IIconService),this.fontService=e.getContainer().get(J2.IFontService),this.cameraService=e.getContainer().get(J2.ICameraService),this.layerService=e.getContainer().get(J2.ILayerService),this.registerBuiltinAttributes(),this.startModelAnimate();var n=this.rendererService.createTexture2D;this.createTexture2D=n,this.DATA_TEXTURE_WIDTH=1024,this.rowCount=1,this.cellLength=0,this.cellProperties=[],this.cacheStyleProperties={thetaOffset:void 0,opacity:void 0,strokeOpacity:void 0,strokeWidth:void 0,stroke:void 0,offsets:void 0},this.stylePropertiesExist={hasThetaOffset:0,hasOpacity:0,hasStrokeOpacity:0,hasStrokeWidth:0,hasStroke:0,hasOffsets:0},this.dataTextureTest=this.layerService.getOESTextureFloat(),this.dataTextureTest||(this.dataTexture=this.createTexture2D({data:new Uint8Array(4),mag:m4.NEAREST,min:m4.NEAREST,width:1,height:1}))}var e,n,r;return gZ(t,[{key:"clearLastCalRes",value:function(){this.cellProperties=[],this.cellLength=0,this.stylePropertiesExist={hasThetaOffset:0,hasOpacity:0,hasStrokeOpacity:0,hasStrokeWidth:0,hasStroke:0,hasOffsets:0}}},{key:"getCellTypeLayout",value:function(){return this.dataTextureTest?[this.rowCount,this.DATA_TEXTURE_WIDTH,0,0,this.stylePropertiesExist.hasOpacity,this.stylePropertiesExist.hasStrokeOpacity,this.stylePropertiesExist.hasStrokeWidth,this.stylePropertiesExist.hasStroke,this.stylePropertiesExist.hasOffsets,this.stylePropertiesExist.hasThetaOffset,0,0,0,0,0,1]:[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,-1]}},{key:"dataTextureNeedUpdate",value:function(t){var e=!1;return hZ.isEqual(t.thetaOffset,this.cacheStyleProperties.thetaOffset)||(e=!0,this.cacheStyleProperties.thetaOffset=t.thetaOffset),hZ.isEqual(t.opacity,this.cacheStyleProperties.opacity)||(e=!0,this.cacheStyleProperties.opacity=t.opacity),hZ.isEqual(t.strokeOpacity,this.cacheStyleProperties.strokeOpacity)||(e=!0,this.cacheStyleProperties.strokeOpacity=t.strokeOpacity),hZ.isEqual(t.strokeWidth,this.cacheStyleProperties.strokeWidth)||(e=!0,this.cacheStyleProperties.strokeWidth=t.strokeWidth),hZ.isEqual(t.stroke,this.cacheStyleProperties.stroke)||(e=!0,this.cacheStyleProperties.stroke=t.stroke),hZ.isEqual(t.offsets,this.cacheStyleProperties.offsets)||(e=!0,this.cacheStyleProperties.offsets=t.offsets),void 0===this.dataTexture&&(e=!0),e}},{key:"judgeStyleAttributes",value:function(t){this.clearLastCalRes(),void 0===t.opacity||hZ.isNumber(t.opacity)||(this.cellProperties.push({attr:"opacity",count:1}),this.stylePropertiesExist.hasOpacity=1,this.cellLength+=1),void 0===t.strokeOpacity||hZ.isNumber(t.strokeOpacity)||(this.cellProperties.push({attr:"strokeOpacity",count:1}),this.stylePropertiesExist.hasStrokeOpacity=1,this.cellLength+=1),void 0===t.strokeWidth||hZ.isNumber(t.strokeWidth)||(this.cellProperties.push({attr:"strokeWidth",count:1}),this.stylePropertiesExist.hasStrokeWidth=1,this.cellLength+=1),void 0===t.stroke||this.isStaticColor(t.stroke)||(this.cellProperties.push({attr:"stroke",count:4}),this.stylePropertiesExist.hasStroke=1,this.cellLength+=4),void 0===t.offsets||this.isOffsetStatic(t.offsets)||(this.cellProperties.push({attr:"offsets",count:2}),this.stylePropertiesExist.hasOffsets=1,this.cellLength+=2),void 0===t.thetaOffset||hZ.isNumber(t.thetaOffset)||(this.cellProperties.push({attr:"thetaOffset",count:1}),this.stylePropertiesExist.hasThetaOffset=1,this.cellLength+=1)}},{key:"isStaticColor",value:function(t){return!!hZ.isString(t)&&!!ju(t)}},{key:"getStrokeColor",value:function(t){if(this.isStaticColor(t)){var e=EK(t);return e[0]=e[0]?e[0]:0,e[1]=e[1]?e[1]:0,e[2]=e[2]?e[2]:0,e[3]=e[3]?e[3]:0,e}return[0,0,0,0]}},{key:"isOffsetStatic",value:function(t){return!!(Array.isArray(t)&&2===t.length&&hZ.isNumber(t[0])&&hZ.isNumber(t[1]))}},{key:"patchMod",value:function(t,e){for(var n=0;n<e;n++)t.push(-1)}},{key:"patchData",value:function(t,e,n){var r,i=Xtt(n);try{for(i.s();!(r=i.n()).done;){var o=r.value,a=o.attr,s=o.count,u=e[a];void 0!==u?"stroke"===a?t.push.apply(t,Xq(EK(u))):"offsets"===a?this.isOffsetStatic(u)?t.push(-u[0],u[1]):t.push(0,0):t.push(hZ.isNumber(u)?u:1):this.patchMod(t,s)}}catch(c){i.e(c)}finally{i.f()}}},{key:"calDataFrame",value:function(t,e,n){for(var r=e.length,i=Math.ceil(r*t/this.DATA_TEXTURE_WIDTH),o=i*this.DATA_TEXTURE_WIDTH,a=[],s=0;s<r;s++){var u=e[s];this.patchData(a,u,n)}for(var c=a.length;c<o;c++)a.push(-1);return{data:a,width:this.DATA_TEXTURE_WIDTH,height:i}}},{key:"getBlend",value:function(){var t=this.layer.getLayerConfig().blend;return S9[u8[void 0===t?"normal":t]]}},{key:"getDefaultStyle",value:function(){return{}}},{key:"getUninforms",value:function(){throw new Error("Method not implemented.")}},{key:"getAnimateUniforms",value:function(){return{}}},{key:"needUpdate",value:(r=RK(jK.mark((function t(){return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",!1);case 1:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)})},{key:"buildModels",value:(n=RK(jK.mark((function t(){return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:throw new Error("Method not implemented.");case 1:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)})},{key:"initModels",value:(e=RK(jK.mark((function t(){return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:throw new Error("Method not implemented.");case 1:case"end":return t.stop()}}),t)}))),function(){return e.apply(this,arguments)})},{key:"clearModels",value:function(){}},{key:"getAttribute",value:function(){throw new Error("Method not implemented.")}},{key:"render",value:function(){throw new Error("Method not implemented.")}},{key:"registerBuiltinAttributes",value:function(){throw new Error("Method not implemented.")}},{key:"animateOption2Array",value:function(t){return[t.enable?0:1,t.duration||4,t.interval||.2,t.trailLength||.1]}},{key:"startModelAnimate",value:function(){this.layer.getLayerConfig().animateOption.enable&&this.layer.setAnimateStartTime()}}]),t}(),Wtt=j3(Gtt.prototype,"configService",[Vtt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gtt);($tt=Ztt||(Ztt={}))[$tt.solid=0]="solid",$tt[$tt.dash=1]="dash",(Jtt=Ktt||(Ktt={})).VERTICAL="vertical",Jtt.HORIZONTAL="horizontal",(tet=Qtt||(Qtt={})).NORMAL="normal",tet.REPLACE="replace",(net=eet||(eet={}))[net.pixel=0]="pixel",net[net.meter=1]="meter",(iet=ret||(ret={})).ALWAYS="always",iet.DRAGEND="dragend";function aet(t){return t/180*Math.acos(-1)}function set(t){var e=aet(t[0])+Math.PI/2,n=aet(t[1]),r=100+.4*Math.random(),i=r*Math.cos(n)*Math.cos(e);return[r*Math.cos(n)*Math.sin(e),r*Math.sin(n),i]}var uet=ka();ka();var cet=ka(),het=ka(),fet=ka();function pet(t,e,n,r,i){return Ia(t,n,r),za(t,t),[i/Ua(e=Pa(-t[1],t[0]),Pa(-n[1],n[0])),e]}function det(t,e){return Ra(t,-e[1],e[0])}function met(t,e,n){return Ha(t,e,n),za(t,t),t}function vet(t,e){return t[0]===e[0]&&t[1]===e[1]}var get,yet,xet,bet,_et,wet=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};mZ(this,t),$q(this,"lastFlip",-1),$q(this,"miter",Pa(0,0)),$q(this,"started",!1),$q(this,"dash",!1),$q(this,"totalDistance",0),$q(this,"currentIndex",0),this.join=e.join||"miter",this.cap=e.cap||"butt",this.miterLimit=e.miterLimit||10,this.thickness=e.thickness||1,this.dash=e.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0,indexes:[]}}return gZ(t,[{key:"simpleExtrude",value:function(t){var e=this.complex;if(t.length<=1)return e;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var n=t.length,r=e.startIndex,i=1;i<n;i++){var o=t[i-1],a=t[i],s=i<t.length-1?t[i+1]:null;r+=this.simpleSegment(e,r,o,a,s)}if(this.dash)for(var u=0;u<e.positions.length/6;u++)e.positions[6*u+5]=this.totalDistance;return e.startIndex=e.positions.length/6,e}},{key:"simpleExtrude_gaode2",value:function(t,e){var n=this.complex;if(t.length<=1)return n;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var r=t.length,i=n.startIndex,o=1;o<r;o++){var a,s,u,c=t[o-1];c.push(null!==(a=e[o-1][2])&&void 0!==a?a:0);var l=e[o-1],h=t[o];h.push(null!==(s=e[o][2])&&void 0!==s?s:0);var f=e[o],p=o<t.length-1?[].concat(Xq(t[o+1]),[null!==(u=e[o+1][2])&&void 0!==u?u:0]):null,d=o<e.length-1?e[o+1]:null;i+=this.simpleSegment(n,i,c,h,p,l,f,d)}if(this.dash)for(var m=0;m<n.positions.length/6;m++)n.positions[6*m+5]=this.totalDistance;return n.startIndex=n.positions.length/6,n}},{key:"extrude_gaode2",value:function(t,e){var n=this.complex;if(t.length<=1)return n;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var r=t.length,i=n.startIndex,o=1;o<r;o++){var a,s,u,c=t[o-1];c.push(null!==(a=e[o-1][2])&&void 0!==a?a:0);var l=e[o-1],h=t[o];h.push(null!==(s=e[o][2])&&void 0!==s?s:0);var f=e[o],p=o<t.length-1?[].concat(Xq(t[o+1]),[null!==(u=e[o+1][2])&&void 0!==u?u:0]):null,d=o<e.length-1?e[o+1]:null;i+=this.segment_gaode2(n,i,c,h,p,l,f,d)}if(this.dash)for(var m=0;m<n.positions.length/6;m++)n.positions[6*m+5]=this.totalDistance;return n.startIndex=n.positions.length/6,n}},{key:"extrude",value:function(t){var e=this.complex;if(t.length<=1)return e;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var n=t.length,r=e.startIndex,i=1;i<n;i++){var o=t[i-1],a=t[i],s=i<t.length-1?t[i+1]:null;r+=this.segment(e,r,o,a,s)}if(this.dash)for(var u=0;u<e.positions.length/6;u++)e.positions[6*u+5]=this.totalDistance;return e.startIndex=e.positions.length/6,e}},{key:"simpleSegment",value:function(t,e,n,r,i){var o=0,a=t.indices,s=t.positions,u=t.normals,c=mK([r[0],r[1]]),l=mK([n[0],n[1]]);met(cet,c,l);var h=0;if(this.dash&&(h=this.lineSegmentDistance(c,l),this.totalDistance+=h),this.normal||(this.normal=ka(),det(this.normal,cet)),this.started||(this.started=!0,this.extrusions(s,u,n,this.normal,this.thickness,this.totalDistance-h)),a.push(e+0,e+1,e+2),i){var f=mK([i[0],i[1]]);vet(c,f)&&Ia(f,c,za(f,Na(f,c,l))),met(het,f,c);var p=lZ(pet(fet,ka(),cet,het,this.thickness),2),d=p[0],m=p[1];Ua(fet,this.normal);this.extrusions(s,u,r,m,d,this.totalDistance),a.push.apply(a,Xq(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),-1,La(this.normal,m),o+=2,this.lastFlip=-1}else det(this.normal,cet),this.extrusions(s,u,r,this.normal,this.thickness,this.totalDistance),a.push.apply(a,Xq(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),o+=2;return o}},{key:"segment_gaode2",value:function(t,e,n,r,i,o,a,s){var u=0,c=t.indices,l=t.positions,h=t.normals,f="square"===this.cap,p="bevel"===this.join,d=mK([a[0],a[1]]),m=mK([o[0],o[1]]);met(cet,r,n);var v=0;if(this.dash&&(v=this.lineSegmentDistance(d,m),this.totalDistance+=v),this.normal||(this.normal=ka(),det(this.normal,cet)),!this.started)if(this.started=!0,f){var g=ka(),y=ka();Ia(g,this.normal,cet),Ia(y,this.normal,cet),h.push(y[0],y[1],0),h.push(g[0],g[1],0),l.push(n[0],n[1],0|n[2],this.totalDistance-v,-this.thickness,0|n[2]),this.complex.indexes.push(this.currentIndex),l.push(n[0],n[1],0|n[2],this.totalDistance-v,this.thickness,0|n[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(l,h,n,this.normal,this.thickness,this.totalDistance-v);if(c.push(e+0,e+1,e+2),i){vet(r,i)&&Ia(i,r,za(i,Na(i,r,n))),met(het,i,r);var x=lZ(pet(fet,ka(),cet,het,this.thickness),2),b=x[0],_=x[1],w=Ua(fet,this.normal)<0?-1:1,S=p;if(!S&&"miter"===this.join)b>this.miterLimit&&(S=!0);S?(h.push(this.normal[0],this.normal[1],0),h.push(_[0],_[1],0),l.push(r[0],r[1],0|r[2],this.totalDistance,-this.thickness*w,0|r[2]),this.complex.indexes.push(this.currentIndex),l.push(r[0],r[1],0|r[2],this.totalDistance,this.thickness*w,0|r[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++,c.push.apply(c,Xq(this.lastFlip!==-w?[e,e+2,e+3]:[e+2,e+1,e+3])),c.push(e+2,e+3,e+4),det(uet,het),La(this.normal,uet),h.push(this.normal[0],this.normal[1],0),l.push(r[0],r[1],0|r[2],this.totalDistance,-this.thickness*w,0|r[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++,u+=3):(this.extrusions(l,h,r,_,b,this.totalDistance),c.push.apply(c,Xq(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),w=-1,La(this.normal,_),u+=2),this.lastFlip=w}else{if(det(this.normal,cet),f){var M=ka(),E=ka();Ha(E,cet,this.normal),Ia(M,cet,this.normal),h.push(E[0],E[1],0),h.push(M[0],M[1],0),l.push(r[0],r[1],0|r[2],this.totalDistance,this.thickness,0|r[2]),this.complex.indexes.push(this.currentIndex),l.push(r[0],r[1],0|r[2],this.totalDistance,this.thickness,0|r[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(l,h,r,this.normal,this.thickness,this.totalDistance);c.push.apply(c,Xq(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),u+=2}return u}},{key:"segment",value:function(t,e,n,r,i){var o=0,a=t.indices,s=t.positions,u=t.normals,c="square"===this.cap,l="bevel"===this.join,h=mK([r[0],r[1]]),f=mK([n[0],n[1]]);met(cet,h,f);var p=0;if(this.dash&&(p=this.lineSegmentDistance(h,f),this.totalDistance+=p),this.normal||(this.normal=ka(),det(this.normal,cet)),!this.started)if(this.started=!0,c){var d=ka(),m=ka();Ia(d,this.normal,cet),Ia(m,this.normal,cet),u.push(m[0],m[1],0),u.push(d[0],d[1],0),s.push(n[0],n[1],0|n[2],this.totalDistance-p,-this.thickness,0|n[2]),this.complex.indexes.push(this.currentIndex),s.push(n[0],n[1],0|n[2],this.totalDistance-p,this.thickness,0|n[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(s,u,n,this.normal,this.thickness,this.totalDistance-p);if(a.push(e+0,e+1,e+2),i){var v=mK([i[0],i[1]]);vet(h,v)&&Ia(v,h,za(v,Na(v,h,f))),met(het,v,h);var g=lZ(pet(fet,ka(),cet,het,this.thickness),2),y=g[0],x=g[1],b=Ua(fet,this.normal)<0?-1:1,_=l;if(!_&&"miter"===this.join)y>this.miterLimit&&(_=!0);_?(u.push(this.normal[0],this.normal[1],0),u.push(x[0],x[1],0),s.push(r[0],r[1],0|r[2],this.totalDistance,-this.thickness*b,0|r[2]),this.complex.indexes.push(this.currentIndex),s.push(r[0],r[1],0|r[2],this.totalDistance,this.thickness*b,0|r[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++,a.push.apply(a,Xq(this.lastFlip!==-b?[e,e+2,e+3]:[e+2,e+1,e+3])),a.push(e+2,e+3,e+4),det(uet,het),La(this.normal,uet),u.push(this.normal[0],this.normal[1],0),s.push(r[0],r[1],0|r[2],this.totalDistance,-this.thickness*b,0|r[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++,o+=3):(this.extrusions(s,u,r,x,y,this.totalDistance),a.push.apply(a,Xq(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),b=-1,La(this.normal,x),o+=2),this.lastFlip=b}else{if(det(this.normal,cet),c){var w=ka(),S=ka();Ha(S,cet,this.normal),Ia(w,cet,this.normal),u.push(S[0],S[1],0),u.push(w[0],w[1],0),s.push(r[0],r[1],0|r[2],this.totalDistance,this.thickness,0|r[2]),this.complex.indexes.push(this.currentIndex),s.push(r[0],r[1],0|r[2],this.totalDistance,this.thickness,0|r[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(s,u,r,this.normal,this.thickness,this.totalDistance);a.push.apply(a,Xq(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),o+=2}return o}},{key:"extrusions",value:function(t,e,n,r,i,o){e.push(r[0],r[1],0),e.push(r[0],r[1],0),t.push(n[0],n[1],0|n[2],o,-i,0|n[2]),this.complex.indexes.push(this.currentIndex),t.push(n[0],n[1],0|n[2],o,i,0|n[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++}},{key:"lineSegmentDistance",value:function(t,e){var n=e[0]-t[0],r=e[1]-t[1];return Math.sqrt(n*n+r*r)}}]),t}();function Met(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t[0][0],r=t[0][t[0].length-1];n[0]===r[0]&&n[1]===r[1]&&(t[0]=t[0].slice(0,t[0].length-1));for(var i=t[0].length,o=yJ.flatten(t),a=o.vertices,s=o.dimensions,u=[],c=[],l=[],h=0;h<a.length/s;h++)2===s?u.push(a[2*h],a[2*h+1],1,-1,-1):u.push(a[3*h],a[3*h+1],1,-1,-1),l.push(0,0,1);var f=yJ(o.vertices,o.holes,o.dimensions);c.push.apply(c,Xq(f));for(var p=function(t){var n=o.vertices.slice(t*s,(t+1)*s),r=o.vertices.slice((t+1)*s,(t+2)*s);0===r.length&&(r=o.vertices.slice(0,s));var i=u.length/5;u.push(n[0],n[1],1,0,0,r[0],r[1],1,.1,0,n[0],n[1],0,0,.8,r[0],r[1],0,.1,.8);var a=Eet([r[0],r[1],1],[n[0],n[1],0],[n[0],n[1],1],e);l.push.apply(l,Xq(a).concat(Xq(a),Xq(a),Xq(a))),c.push.apply(c,Xq([1,2,0,3,2,1].map((function(t){return t+i}))))},d=0;d<i;d++)p(d);return{positions:u,index:c,normals:l}}function Eet(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=Do(),o=Do(),a=Do();r&&(t=pK(t),e=pK(e),n=pK(n));var s=Bo.apply(ga,Xq(t)),u=Bo.apply(ga,Xq(e)),c=Bo.apply(ga,Xq(n));ca(i,c,u),ca(o,s,u),ea(a,i,o);var l=Do();return Qo(l,a),l}function Aet(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=2*Math.PI/t,r=[],i=0;i<t;i++)r.push(n*i+e*Math.PI/12);var o=r.map((function(t){return[Math.sin(t+Math.PI/4),Math.cos(t+Math.PI/4),0]}));return o}function Tet(){return Aet(30)}function Cet(){return Aet(4)}function Oet(){return Aet(3)}function ket(){return Aet(6,1)}function Pet(){return Aet(5)}(xet=yet||(yet={})).CYLINDER="cylinder",xet.SQUARECOLUMN="squareColumn",xet.TRIANGLECOLUMN="triangleColumn",xet.HEXAGONCOLUMN="hexagonColumn",xet.PENTAGONCOLUMN="pentagonColumn",(_et=bet||(bet={})).CIRCLE="circle",_et.SQUARE="square",_et.TRIANGLE="triangle",_et.HEXAGON="hexagon",_et.PENTAGON="pentagon";var Let=($q(get={},bet.CIRCLE,Tet),$q(get,bet.HEXAGON,ket),$q(get,bet.TRIANGLE,Oet),$q(get,bet.SQUARE,Cet),$q(get,bet.PENTAGON,Pet),$q(get,yet.CYLINDER,Tet),$q(get,yet.HEXAGONCOLUMN,ket),$q(get,yet.TRIANGLECOLUMN,Oet),$q(get,yet.SQUARECOLUMN,Cet),$q(get,yet.PENTAGONCOLUMN,Pet),get),Ret={};function Iet(t){var e=_K(t.coordinates);return{vertices:[].concat(Xq(e),Xq(e),Xq(e),Xq(e)),indices:[0,1,2,2,3,0],size:e.length}}function Net(t){var e=set(_K(t.coordinates));return{vertices:[].concat(Xq(e),Xq(e),Xq(e),Xq(e)),indices:[0,1,2,2,3,0],size:e.length}}function Det(t){var e=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(Ret&&Ret[t])return Ret[t];var n=Let[t]?Let[t]():Let.cylinder(),r=Met([n],e);return Ret[t]=r,r}(t.shape,!1);return{vertices:e.positions,indices:e.index,normals:e.normals,size:5}}function Fet(t){var e=_K(t.coordinates);return{vertices:Xq(e),indices:[0],size:e.length}}function jet(t){var e=t.coordinates,n=t.originCoordinates,r=t.version,i=new wet({dash:!0,join:"bevel"});if("GAODE2.x"===r){var o=e;Array.isArray(o[0][0])||(o=[e]);var a=n;Array.isArray(a[0][0])||(a=[n]);for(var s=0;s<o.length;s++){var u=o[s],c=a[s];i.extrude_gaode2(u,c)}}else{var l=e;l[0]&&!Array.isArray(l[0][0])&&(l=[e]),l.forEach((function(t){i.extrude(t)}))}var h=i.complex;return{vertices:h.positions,indices:h.indices,normals:h.normals,indexes:h.indexes,size:6}}function Bet(t){var e=t.coordinates,n=[];if(!Array.isArray(e[0]))return{vertices:[],indices:[],normals:[],size:6,count:0};var r=function(t){var e=t;Array.isArray(e)&&Array.isArray(e[0])&&Array.isArray(e[0][0])&&(e=t.flat());var n=0;if(e.length<2)return{results:e,totalDistance:0};var r=[],i=Uet(e[0],n);r.push(i);for(var o=1;o<e.length-1;o++){n+=zet(e[o-1],e[o]);var a=Uet(e[o],n);r.push(a),r.push(a)}return n+=zet(e[e.length-2],e[e.length-1]),r.push(Uet(e[e.length-1],n)),{results:r,totalDistance:n}}(e),i=r.results,o=r.totalDistance;return i.map((function(t){n.push(t[0],t[1],t[2],t[3],0,o)})),{vertices:n,indices:[],normals:[],size:6,count:i.length}}function zet(t,e){var n=e[0]-t[0],r=e[1]-t[1];return Math.sqrt(n*n+r*r)}function Uet(t,e){return t.length<3&&t.push(0),void 0!==e&&t.push(e),t}function Vet(t){var e=t.coordinates,n=yJ.flatten(e),r=n.vertices,i=n.dimensions,o=n.holes;return{indices:yJ(r,o,i),vertices:r,size:i}}function Get(t){var e=t.coordinates,n=yJ.flatten(e),r=n.vertices,i=n.dimensions,o=n.holes;return{indices:yJ(r,o,i),vertices:Wet(r),size:i+4}}function Wet(t){for(var e=[],n=function(t){for(var e=t[0],n=t[1],r=t[0],i=t[1],o=0,a=0,s=0,u=0;u<t.length;u+=2){var c=t[u],l=t[u+1];c&&l&&(e=Math.max(c,e),n=Math.max(l,n),r=Math.min(c,r),i=Math.min(l,i),o+=c,a+=l,s++)}return{center:[o/s,a/s],radius:Math.sqrt(Math.pow(e-r,2)+Math.pow(n-i,2))/2}}(t),r=n.center,i=n.radius,o=0;o<t.length;o+=2){var a=t[o],s=t[o+1];e.push.apply(e,[a,s,0].concat(Xq(r),[i]))}return e}function Het(t){var e=Met(t.coordinates,!0);return{vertices:e.positions,indices:e.index,normals:e.normals,size:5}}function Yet(t){var e=t.coordinates;return{vertices:[].concat(Xq(e[0]),[0,0,1,e[1][0],e[0][1],0,1,1],Xq(e[1]),[0,1,0],Xq(e[0]),[0,0,1],Xq(e[1]),[0,1,0,e[0][0],e[1][1],0,0,0]),indices:[0,1,2,3,4,5],size:5}}function Xet(t,e){for(var n=e||30,r=t.coordinates,i=[],o=[],a=function(t){i.push(t,1,t,r[0][0],r[0][1],r[1][0],r[1][1],t,-1,t,r[0][0],r[0][1],r[1][0],r[1][1]),t!==n-1&&o.push.apply(o,Xq([0,1,2,1,3,2].map((function(e){return 2*t+e}))))},s=0;s<n;s++)a(s);return{vertices:i,indices:o,size:7}}function qet(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var Zet=function(t){wZ(i,oet);var e,n,r=qet(i);function i(){return mZ(this,i),r.apply(this,arguments)}return gZ(i,[{key:"getUninforms",value:function(){return{u_opacity:this.layer.getLayerConfig().opacity||1,u_texture:this.texture}}},{key:"initModels",value:(n=RK(jK.mark((function t(){var e,n,r,i,o,a,s,u,c,l,h,f=this;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=this.layer.getLayerConfig(),n=e.mask,r=void 0!==n&&n,i=e.maskInside,o=void 0===i||i,a=this.layer.getSource(),s=this.rendererService.createTexture2D,this.texture=s({height:0,width:0}),!N$){t.next=12;break}u=this.layerService.sceneService.getSceneConfig().canvas,(c=u.createImage()).crossOrigin="anonymous",c.src=a.data.originData,c.onload=function(){f.texture=s({data:c,width:c.width,height:c.height}),f.layerService.reRender()},t.next=16;break;case 12:return t.next=14,a.data.images;case 14:l=t.sent,this.texture=s({data:l[0],width:l[0].width,height:l[0].height,mag:m4.LINEAR,min:m4.LINEAR});case 16:return t.next=18,this.layer.buildLayerModel({moduleName:"rasterImage",vertexShader:'precision highp float;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\nattribute vec3 a_Position;\nattribute vec2 a_Uv;\nvarying vec2 v_texCoord;\n#pragma include "projection"\nvoid main() {\n   v_texCoord = a_Uv;\n   vec4 project_pos = project_position(vec4(a_Position, 1.0));\n   // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));\n   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n      gl_Position = u_Mvp * (vec4(project_pos.xy,0., 1.0));\n   } else {\n      gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));\n   }\n}\n',fragmentShader:"precision mediump float;\nuniform float u_opacity: 1.0;\nuniform sampler2D u_texture;\nvarying vec2 v_texCoord;\nvoid main() {\n  vec4 color = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y));\n  gl_FragColor = color;\n  gl_FragColor.a *= u_opacity;\n}\n",triangulation:Yet,primitive:m4.TRIANGLES,blend:{enable:!0},depth:{enable:!1},stencil:PK(r,o)});case 18:return h=t.sent,t.abrupt("return",[h]);case 20:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"clearModels",value:function(){var t;null===(t=this.texture)||void 0===t||t.destroy()}},{key:"buildModels",value:(e=RK(jK.mark((function t(){return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.initModels();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:d8.Attribute,descriptor:{name:"a_Uv",buffer:{usage:m4.DYNAMIC_DRAW,data:[],type:m4.FLOAT},size:2,update:function(t,e,n){return[n[3],n[4]]}}})}}]),i}();const $et={image:Zet};function Ket(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var Jet=function(t){wZ(r,Ytt);var e,n=Ket(r);function r(){var t;mZ(this,r);for(var e=arguments.length,i=new Array(e),o=0;o<e;o++)i[o]=arguments[o];return $q(SZ(t=n.call.apply(n,[this].concat(i))),"type","ImageLayer"),t}return gZ(r,[{key:"buildModels",value:(e=RK(jK.mark((function t(){var e;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.getModelType(),this.layerModel=new $et[e](this),t.next=4,this.initLayerModels();case 4:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"getDefaultConfig",value:function(){return{image:{}}[this.getModelType()]}},{key:"getModelType",value:function(){return"image"}}]),r}();function Qet(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var tnt={solid:0,dash:1},ent=function(t){wZ(i,oet);var e,n,r=Qet(i);function i(){var t;mZ(this,i);for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return $q(SZ(t=r.call.apply(r,[this].concat(n))),"updateTexture",(function(){var e=t.rendererService.createTexture2D;if(t.texture)return t.texture.update({data:t.iconService.getCanvas()}),void t.layer.render();t.texture=e({data:t.iconService.getCanvas(),mag:m4.NEAREST,min:m4.NEAREST,premultiplyAlpha:!1,width:1024,height:t.iconService.canvasHeight||128})})),t}return gZ(i,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),e=t.opacity,n=void 0===e?1:e,r=t.sourceColor,i=t.targetColor,o=t.textureBlend,a=void 0===o?"normal":o,s=t.lineType,u=void 0===s?"solid":s,c=t.dashArray,l=void 0===c?[10,5]:c,h=t.forward,f=void 0===h||h,p=t.lineTexture,d=void 0!==p&&p,m=t.iconStep,v=void 0===m?100:m,g=t.segmentNumber,y=void 0===g?30:g,x=t.thetaOffset,b=void 0===x?.314:x;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:n,thetaOffset:b})){this.judgeStyleAttributes({opacity:n,thetaOffset:b});var _=this.layer.getEncodedData(),w=this.calDataFrame(this.cellLength,_,this.cellProperties),S=w.data,M=w.width,E=w.height;this.rowCount=E,this.dataTexture=this.cellLength>0&&S.length>0?this.createTexture2D({flipY:!0,data:S,format:m4.LUMINANCE,type:m4.FLOAT,width:M,height:E}):this.createTexture2D({flipY:!0,data:[1],format:m4.LUMINANCE,type:m4.FLOAT,width:1,height:1})}2===l.length&&l.push(0,0);var A=0,T=[0,0,0,0],C=[0,0,0,0];return r&&i&&(T=EK(r),C=EK(i),A=1),this.rendererService.getDirty()&&this.texture.bind(),{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_thetaOffset:hZ.isNumber(b)?b:0,u_opacity:hZ.isNumber(n)?n:1,u_textureBlend:"normal"===a?0:1,segmentNumber:y,u_line_type:tnt[u||"solid"],u_dash_array:l,u_blur:.9,u_lineDir:f?1:-1,u_texture:this.texture,u_line_texture:d?1:0,u_icon_step:v,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:A,u_sourceColor:T,u_targetColor:C}}},{key:"getAnimateUniforms",value:function(){var t=this.layer.getLayerConfig().animateOption;return{u_animate:this.animateOption2Array(t),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:(n=RK(jK.mark((function t(){return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),t.next=4,this.buildModels();case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"clearModels",value:function(){var t,e;null===(t=this.texture)||void 0===t||t.destroy(),null===(e=this.dataTexture)||void 0===e||e.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"getShaders",value:function(){var t=this.layer.getLayerConfig(),e=t.sourceColor,n=t.targetColor;return"dash"===t.lineType?{frag:'\nuniform float u_opacity;\n\nvarying vec4 v_dash_array;\nvarying vec4 v_color;\n\nuniform float segmentNumber;\n\nvarying mat4 styleMappingMat; // 传递从片元中传递的映射数据\n\n#pragma include "picking"\n\nvoid main() {\n  float opacity = styleMappingMat[0][0];\n  float d_distance_ratio = styleMappingMat[3].b; // 当前顶点在弧线中所处的分段比例\n\n  gl_FragColor = v_color;\n  gl_FragColor.a *= opacity;\n\n  float flag = 0.;\n  float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);\n  if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {\n    flag = 1.;\n  };\n  gl_FragColor.a *=flag;\n  \n  gl_FragColor = filterColor(gl_FragColor);\n}',vert:'\nattribute vec4 a_Color;\nattribute vec3 a_Position;\nattribute vec4 a_Instance;\nattribute float a_Size;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\nuniform float segmentNumber;\nvarying vec4 v_color;\n\n\nuniform vec4 u_dash_array: [10.0, 5., 0, 0];\nuniform float u_lineDir: 1.0;\nvarying vec4 v_dash_array;\n\nuniform float u_thetaOffset: 0.314;\n\nuniform float u_opacity: 1.0;\nvarying mat4 styleMappingMat; // 用于将在顶点着色器中计算好的样式值传递给片元\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n#pragma include "styleMappingCalThetaOffset"\n\n#pragma include "projection"\n#pragma include "project"\n#pragma include "picking"\n\nfloat bezier3(vec3 arr, float t) {\n  float ut = 1. - t;\n  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;\n}\nvec2 midPoint(vec2 source, vec2 target, float arcThetaOffset) {\n  vec2 center = target - source;\n  float r = length(center);\n  float theta = atan(center.y, center.x);\n  float thetaOffset = arcThetaOffset;\n  float r2 = r / 2.0 / cos(thetaOffset);\n  float theta2 = theta + thetaOffset;\n  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);\n  if(u_lineDir == 1.0) { // 正向\n    return mid;\n  } else { // 逆向\n    // (mid + vmin)/2 = (s + t)/2\n    vec2 vmid = source + target - mid;\n    return vmid;\n  }\n  // return mid;\n}\nfloat getSegmentRatio(float index) {\n  // dash: index / (segmentNumber - 1.);\n  // normal: smoothstep(0.0, 1.0, index / (segmentNumber - 1.));\n  return index / (segmentNumber - 1.);\n}\nvec2 interpolate (vec2 source, vec2 target, float t, float arcThetaOffset) {\n  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation\n  vec2 mid = midPoint(source, target, arcThetaOffset);\n  vec3 x = vec3(source.x, mid.x, target.x);\n  vec3 y = vec3(source.y, mid.y, target.y);\n  return vec2(bezier3(x ,t), bezier3(y,t));\n}\nvec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace);\n  // rotate by 90 degrees\n   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;\n  return offset;\n}\nvec2 getNormal(vec2 line_clipspace, float offset_direction) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace);\n  // rotate by 90 degrees\n   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);\n}\n\nvoid main() {\n  v_color = a_Color;\n\n  // cal style mapping - 数据纹理映射部分的计算\n  styleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0  // dataset 数据集\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // 当前的数据纹理有几行\n  float columnCount = u_cellTypeLayout[0][1]; // 当看到数据纹理有几列\n  float columnWidth = 1.0/columnCount;  // 列宽\n  float rowHeight = 1.0/rowCount;       // 行高\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // 第n个顶点\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // 起始点在第几行\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // 起始点在第几列\n  \n  // cell 固定顺序 opacity -> strokeOpacity -> strokeWidth -> stroke -> thetaOffset... \n  // 按顺序从 cell 中取值、若没有则自动往下取值\n  float textureOffset = 0.0; // 在 cell 中取值的偏移量\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n\n  vec2 thetaOffsetAndOffset = calThetaOffsetAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][1] = thetaOffsetAndOffset.r;\n  textureOffset = thetaOffsetAndOffset.g;\n  // cal style mapping - 数据纹理映射部分的计算\n\n  \n  vec2 source = a_Instance.rg;  // 起始点\n  vec2 target =  a_Instance.ba; // 终点\n  float segmentIndex = a_Position.x;\n  float segmentRatio = getSegmentRatio(segmentIndex);\n\n  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));\n  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);\n\n  vec2 s = source;\n  vec2 t = target;\n  \n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n    s = unProjCustomCoord(source);\n    t = unProjCustomCoord(target);\n  }\n  float total_Distance = pixelDistance(s, t) / 2.0 * PI;\n  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / total_Distance;\n\n  styleMappingMat[3].b = segmentIndex / segmentNumber;\n\n  // styleMappingMat[0][1] - arcThetaOffset\n  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio, styleMappingMat[0][1]), 0.0, 1.0));\n  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio, styleMappingMat[0][1]), 0.0, 1.0));\n  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);\n  //unProjCustomCoord\n  \n  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));\n  \n\n  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n    // gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));\n    gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));\n  } else {\n    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));\n  }\n  gl_PointSize = 5.0;\n  setPickingColor(a_PickingColor);\n}\n',type:"Dash"}:e&&n?{frag:'#define Animate 0.0\n#define LineTexture 1.0\n\nuniform float u_opacity;\nuniform float u_textureBlend;\nuniform float u_blur : 0.9;\nuniform float u_line_type: 0.0;\n// varying vec2 v_normal;\nvarying vec4 v_dash_array;\nvarying vec4 v_color;\n\nuniform float u_time;\nuniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];\n\nuniform float u_line_texture;\nuniform sampler2D u_texture;\nuniform vec2 u_textSize;\n\nuniform float segmentNumber;\nvarying vec2 v_iconMapUV;\n\nvarying mat4 styleMappingMat; // 传递从片元中传递的映射数据\n\nuniform float u_linearColor: 0;\nuniform vec4 u_sourceColor;\nuniform vec4 u_targetColor;\n\n#pragma include "picking"\n\nvoid main() {\n  float opacity = styleMappingMat[0][0];\n  float d_segmentIndex = styleMappingMat[3].r;   // 当前顶点在弧线中所处的分段位置\n\n  // 设置弧线的底色\n  gl_FragColor = mix(u_sourceColor, u_targetColor, d_segmentIndex/segmentNumber);\n  gl_FragColor.a *= opacity;\n  gl_FragColor = filterColor(gl_FragColor);\n}',vert:'\nattribute vec4 a_Color;\nattribute vec3 a_Position;\nattribute vec4 a_Instance;\nattribute float a_Size;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\nuniform float segmentNumber;\nvarying vec4 v_color;\n\nuniform float u_lineDir: 1.0;\n\nuniform float u_thetaOffset: 0.314;\n\nuniform float u_opacity: 1.0;\nvarying mat4 styleMappingMat; // 用于将在顶点着色器中计算好的样式值传递给片元\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n#pragma include "styleMappingCalThetaOffset"\n\n#pragma include "projection"\n#pragma include "project"\n#pragma include "picking"\n\nfloat bezier3(vec3 arr, float t) {\n  float ut = 1. - t;\n  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;\n}\nvec2 midPoint(vec2 source, vec2 target, float arcThetaOffset) {\n  vec2 center = target - source;\n  float r = length(center);\n  float theta = atan(center.y, center.x);\n  float thetaOffset = arcThetaOffset;\n  float r2 = r / 2.0 / cos(thetaOffset);\n  float theta2 = theta + thetaOffset;\n  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);\n  if(u_lineDir == 1.0) { // 正向\n    return mid;\n  } else { // 逆向\n    // (mid + vmin)/2 = (s + t)/2\n    vec2 vmid = source + target - mid;\n    return vmid;\n  }\n  // return mid;\n}\nfloat getSegmentRatio(float index) {\n    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));\n}\nvec2 interpolate (vec2 source, vec2 target, float t, float arcThetaOffset) {\n  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation\n  vec2 mid = midPoint(source, target, arcThetaOffset);\n  vec3 x = vec3(source.x, mid.x, target.x);\n  vec3 y = vec3(source.y, mid.y, target.y);\n  return vec2(bezier3(x ,t), bezier3(y,t));\n}\nvec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace);\n  // rotate by 90 degrees\n   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;\n  return offset;\n}\nvec2 getNormal(vec2 line_clipspace, float offset_direction) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace);\n  // rotate by 90 degrees\n   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);\n}\n\nvoid main() {\n  v_color = a_Color;\n\n  // cal style mapping - 数据纹理映射部分的计算\n  styleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0  // dataset 数据集\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // 当前的数据纹理有几行\n  float columnCount = u_cellTypeLayout[0][1]; // 当看到数据纹理有几列\n  float columnWidth = 1.0/columnCount;  // 列宽\n  float rowHeight = 1.0/rowCount;       // 行高\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // 第n个顶点\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // 起始点在第几行\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // 起始点在第几列\n  \n  // cell 固定顺序 opacity -> strokeOpacity -> strokeWidth -> stroke -> thetaOffset... \n  // 按顺序从 cell 中取值、若没有则自动往下取值\n  float textureOffset = 0.0; // 在 cell 中取值的偏移量\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n\n  vec2 thetaOffsetAndOffset = calThetaOffsetAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][1] = thetaOffsetAndOffset.r;\n  textureOffset = thetaOffsetAndOffset.g;\n  // cal style mapping - 数据纹理映射部分的计算\n\n  \n  vec2 source = a_Instance.rg;  // 起始点\n  vec2 target =  a_Instance.ba; // 终点\n  float segmentIndex = a_Position.x;\n  float segmentRatio = getSegmentRatio(segmentIndex);\n\n  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));\n  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);\n  float d_distance_ratio;\n\n   styleMappingMat[3].b = d_distance_ratio;\n\n  // styleMappingMat[0][1] - arcThetaOffset\n  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio, styleMappingMat[0][1]), 0.0, 1.0));\n  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio, styleMappingMat[0][1]), 0.0, 1.0));\n  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);\n  //unProjCustomCoord\n  \n  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));\n\n\n  float d_segmentIndex = a_Position.x + 1.0; // 当前顶点在弧线中所处的分段位置\n  styleMappingMat[3].r = d_segmentIndex;\n\n  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n    // gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));\n    gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));\n  } else {\n    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));\n  }\n  setPickingColor(a_PickingColor);\n}\n',type:"Linear"}:{frag:'\n#define Animate 0.0\n#define LineTexture 1.0\n\nuniform float u_opacity;\nuniform float u_textureBlend;\nuniform float u_blur : 0.9;\nuniform float u_line_type: 0.0;\n// varying vec2 v_normal;\nvarying vec4 v_dash_array;\nvarying vec4 v_color;\n\nuniform float u_time;\nuniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];\n\nuniform float u_line_texture;\nuniform sampler2D u_texture;\nuniform vec2 u_textSize;\n\nuniform float segmentNumber;\nvarying vec2 v_iconMapUV;\n\nvarying mat4 styleMappingMat; // 传递从片元中传递的映射数据\n\n#pragma include "picking"\n\nvoid main() {\n  float opacity = styleMappingMat[0][0];\n  float animateSpeed = 0.0; // 运动速度\n  float d_segmentIndex = styleMappingMat[3].r;   // 当前顶点在弧线中所处的分段位置\n  float d_distance_ratio = styleMappingMat[3].b; // 当前顶点在弧线中所处的分段比例\n\n  gl_FragColor = v_color;\n  \n  gl_FragColor.a *= opacity;\n\n  if(u_animate.x == Animate && u_line_texture != LineTexture) {\n      animateSpeed = u_time / u_animate.y;\n      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);\n      alpha = (alpha + u_animate.w -1.0) / u_animate.w;\n      // alpha = smoothstep(0., 1., alpha);\n      alpha = clamp(alpha, 0.0, 1.0);\n      gl_FragColor.a *= alpha;\n  }\n\n  // 当存在贴图时在底色上贴上贴图\n  if(u_line_texture == LineTexture) { // while load texture\n    float arcRadio = smoothstep( 0.0, 1.0, (d_segmentIndex / segmentNumber));\n    // float arcRadio = smoothstep( 0.0, 1.0, d_distance_ratio);\n\n    float count = styleMappingMat[3].g; // 贴图在弧线上重复的数量\n\n    float time = 0.0;\n    if(u_animate.x == Animate) {\n      time = u_time / u_animate.y;\n    }\n    float redioCount = arcRadio * count;\n\n    float u = fract(redioCount - time);\n    float v = styleMappingMat[3].a; // 横向 v\n    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;\n\n    vec4 pattern = texture2D(u_texture, uv);\n\n    if(u_animate.x == Animate) {\n      float currentPlane = floor(redioCount - time);\n      float textureStep = floor(count * u_animate.z);\n      float a = mod(currentPlane, textureStep);\n      if(a < textureStep - 1.0) {\n        pattern = vec4(0.0);\n      }\n    }\n\n    if(u_textureBlend == 0.0) { // normal\n      pattern.a = 0.0;\n      gl_FragColor = filterColor(gl_FragColor + pattern);\n    } else { // replace\n        pattern.a *= opacity;\n        if(gl_FragColor.a <= 0.0) {\n          pattern.a = 0.0;\n        }\n        gl_FragColor = filterColor(pattern);\n    }\n    \n  } else {\n     gl_FragColor = filterColor(gl_FragColor);\n  }\n}',vert:'#define Animate 0.0\n#define LineTexture 1.0\n\nattribute vec4 a_Color;\nattribute vec3 a_Position;\nattribute vec4 a_Instance;\nattribute float a_Size;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\nuniform float segmentNumber;\nuniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];\nvarying vec4 v_color;\n\nuniform float u_lineDir: 1.0;\n\nuniform float u_thetaOffset: 0.314;\nuniform float u_icon_step: 100;\nuniform float u_line_texture: 0.0;\nattribute vec2 a_iconMapUV;\nvarying vec2 v_iconMapUV;\n\nuniform float u_opacity: 1.0;\nvarying mat4 styleMappingMat; // 用于将在顶点着色器中计算好的样式值传递给片元\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n#pragma include "styleMappingCalThetaOffset"\n\n#pragma include "projection"\n#pragma include "project"\n#pragma include "picking"\n\nfloat bezier3(vec3 arr, float t) {\n  float ut = 1. - t;\n  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;\n}\nvec2 midPoint(vec2 source, vec2 target, float arcThetaOffset) {\n  vec2 center = target - source;\n  float r = length(center);\n  float theta = atan(center.y, center.x);\n  float thetaOffset = arcThetaOffset;\n  float r2 = r / 2.0 / cos(thetaOffset);\n  float theta2 = theta + thetaOffset;\n  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);\n  if(u_lineDir == 1.0) { // 正向\n    return mid;\n  } else { // 逆向\n    // (mid + vmin)/2 = (s + t)/2\n    vec2 vmid = source + target - mid;\n    return vmid;\n  }\n  // return mid;\n}\nfloat getSegmentRatio(float index) {\n    // dash: index / (segmentNumber - 1.);\n    // normal: smoothstep(0.0, 1.0, index / (segmentNumber - 1.));\n    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));\n    //  return index / (segmentNumber - 1.);\n}\nvec2 interpolate (vec2 source, vec2 target, float t, float arcThetaOffset) {\n  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation\n  vec2 mid = midPoint(source, target, arcThetaOffset);\n  vec3 x = vec3(source.x, mid.x, target.x);\n  vec3 y = vec3(source.y, mid.y, target.y);\n  return vec2(bezier3(x ,t), bezier3(y,t));\n}\nvec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace);\n  // rotate by 90 degrees\n   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;\n  return offset;\n}\nvec2 getNormal(vec2 line_clipspace, float offset_direction) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace);\n  // rotate by 90 degrees\n   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);\n}\n\nvoid main() {\n  v_color = a_Color;\n\n  // cal style mapping - 数据纹理映射部分的计算\n  styleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0  // dataset 数据集\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // 当前的数据纹理有几行\n  float columnCount = u_cellTypeLayout[0][1]; // 当看到数据纹理有几列\n  float columnWidth = 1.0/columnCount;  // 列宽\n  float rowHeight = 1.0/rowCount;       // 行高\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // 第n个顶点\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // 起始点在第几行\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // 起始点在第几列\n  \n  // cell 固定顺序 opacity -> strokeOpacity -> strokeWidth -> stroke -> thetaOffset... \n  // 按顺序从 cell 中取值、若没有则自动往下取值\n  float textureOffset = 0.0; // 在 cell 中取值的偏移量\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n\n  vec2 thetaOffsetAndOffset = calThetaOffsetAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][1] = thetaOffsetAndOffset.r;\n  textureOffset = thetaOffsetAndOffset.g;\n  // cal style mapping - 数据纹理映射部分的计算\n\n  \n  vec2 source = a_Instance.rg;  // 起始点\n  vec2 target =  a_Instance.ba; // 终点\n  float segmentIndex = a_Position.x;\n  float segmentRatio = getSegmentRatio(segmentIndex);\n\n  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));\n  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);\n  float d_distance_ratio;\n  \n  if(u_animate.x == Animate) {\n      d_distance_ratio = segmentIndex / segmentNumber;\n      if(u_lineDir != 1.0) {\n        d_distance_ratio = 1.0 - d_distance_ratio;\n      }\n  }\n\n   styleMappingMat[3].b = d_distance_ratio;\n\n  // styleMappingMat[0][1] - arcThetaOffset\n  float arcThetaOffset = styleMappingMat[0][1];\n  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio, arcThetaOffset), 0.0, 1.0));\n  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio, arcThetaOffset), 0.0, 1.0));\n  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);\n  //unProjCustomCoord\n  \n  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));\n\n\n  float d_segmentIndex = a_Position.x + 1.0; // 当前顶点在弧线中所处的分段位置\n  styleMappingMat[3].r = d_segmentIndex;\n\n  if(LineTexture == u_line_texture) { // 开启贴图模式\n\n    float arcDistrance = length(source - target); // 起始点和终点的距离\n    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20) { // amap\n      arcDistrance *= 1000000.0;\n    }\n    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) { // mapbox\n      // arcDistrance *= 8.0;\n      arcDistrance = project_pixel_allmap(arcDistrance);\n    }\n    v_iconMapUV = a_iconMapUV;\n\n    float pixelLen = project_pixel_texture(u_icon_step); // 贴图沿弧线方向的长度 - 随地图缩放改变\n    float texCount = floor(arcDistrance/pixelLen); // 贴图在弧线上重复的数量\n     styleMappingMat[3].g = texCount;\n\n    float lineOffsetWidth = length(offset + offset * sign(a_Position.y)); // 线横向偏移的距离\n    float linePixelSize = project_pixel(a_Size); // 定点位置偏移\n     styleMappingMat[3].a = lineOffsetWidth/linePixelSize; // 线图层贴图部分的 v 坐标值\n  }\n  \n\n  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n    // gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));\n    gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));\n  } else {\n    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));\n  }\n  setPickingColor(a_PickingColor);\n}\n',type:""}}},{key:"buildModels",value:(e=RK(jK.mark((function t(){var e,n,r,i,o,a,s,u,c,l,h,f;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.layer.getLayerConfig(),n=e.segmentNumber,r=void 0===n?30:n,i=e.mask,o=void 0!==i&&i,a=e.maskInside,s=void 0===a||a,u=this.getShaders(),c=u.frag,l=u.vert,h=u.type,t.next=4,this.layer.buildLayerModel({moduleName:"lineArc2d"+h,vertexShader:l,fragmentShader:c,triangulation:Xet,depth:{enable:!1},blend:this.getBlend(),segmentNumber:r,stencil:PK(o,s)});case 4:return f=t.sent,t.abrupt("return",[f]);case 6:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"registerBuiltinAttributes",value:function(){var t=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:d8.Attribute,descriptor:{name:"a_Size",buffer:{usage:m4.DYNAMIC_DRAW,data:[],type:m4.FLOAT},size:1,update:function(t){var e=t.size,n=void 0===e?1:e;return Array.isArray(n)?[n[0]]:[n]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:d8.Attribute,descriptor:{name:"a_Instance",buffer:{usage:m4.STATIC_DRAW,data:[],type:m4.FLOAT},size:4,update:function(t,e,n){return[n[3],n[4],n[5],n[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:d8.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:m4.DYNAMIC_DRAW,data:[],type:m4.FLOAT},size:2,update:function(e){var n=t.iconService.getIconMap()[e.texture]||{x:0,y:0};return[n.x,n.y]}}})}}]),i}();function nnt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var rnt={solid:0,dash:1},int=function(t){wZ(i,oet);var e,n,r=nnt(i);function i(){var t;mZ(this,i);for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return $q(SZ(t=r.call.apply(r,[this].concat(n))),"updateTexture",(function(){var e=t.rendererService.createTexture2D;if(t.texture)return t.texture.update({data:t.iconService.getCanvas()}),void t.layer.render();t.texture=e({data:t.iconService.getCanvas(),mag:m4.NEAREST,min:m4.NEAREST,premultiplyAlpha:!1,width:1024,height:t.iconService.canvasHeight||128})})),t}return gZ(i,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),e=t.opacity,n=void 0===e?1:e,r=t.sourceColor,i=t.targetColor,o=t.textureBlend,a=void 0===o?"normal":o,s=t.lineType,u=void 0===s?"solid":s,c=t.dashArray,l=void 0===c?[10,5]:c,h=t.lineTexture,f=void 0!==h&&h,p=t.iconStep,d=void 0===p?100:p,m=t.segmentNumber,v=void 0===m?30:m,g=t.globalArcHeight,y=void 0===g?10:g;2===l.length&&l.push(0,0);var x=0,b=[0,0,0,0],_=[0,0,0,0];if(r&&i&&(b=EK(r),_=EK(i),x=1),this.rendererService.getDirty()&&this.texture.bind(),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:n})){this.judgeStyleAttributes({opacity:n});var w=this.layer.getEncodedData(),S=this.calDataFrame(this.cellLength,w,this.cellProperties),M=S.data,E=S.width,A=S.height;this.rowCount=A,this.dataTexture=this.cellLength>0&&M.length>0?this.createTexture2D({flipY:!0,data:M,format:m4.LUMINANCE,type:m4.FLOAT,width:E,height:A}):this.createTexture2D({flipY:!0,data:[1],format:m4.LUMINANCE,type:m4.FLOAT,width:1,height:1})}return{u_globel:"GLOBEL"===this.mapService.version?1:0,u_globel_radius:100,u_global_height:y,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:hZ.isNumber(n)?n:1,u_textureBlend:"normal"===a?0:1,segmentNumber:v,u_line_type:rnt[u]||0,u_dash_array:l,u_texture:this.texture,u_line_texture:f?1:0,u_icon_step:d,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:x,u_sourceColor:b,u_targetColor:_}}},{key:"getAnimateUniforms",value:function(){var t=this.layer.getLayerConfig().animateOption;return{u_animate:this.animateOption2Array(t),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:(n=RK(jK.mark((function t(){return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),t.next=4,this.buildModels();case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"clearModels",value:function(){var t,e;null===(t=this.texture)||void 0===t||t.destroy(),null===(e=this.dataTexture)||void 0===e||e.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"getShaders",value:function(){var t=this.layer.getLayerConfig(),e=t.sourceColor,n=t.targetColor;return e&&n?{frag:'\n#define Animate 0.0\n\nuniform float u_opacity;\nuniform float u_blur : 0.9;\nvarying float v_segmentIndex;\nuniform float segmentNumber;\n\nuniform float u_time;\nuniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];\n\nuniform float u_linearColor: 0;\nuniform vec4 u_sourceColor;\nuniform vec4 u_targetColor;\n\nvarying mat4 styleMappingMat;\n\n#pragma include "picking"\n\nvoid main() {\n  float opacity = styleMappingMat[0][0];\n  float animateSpeed = 0.0; // 运动速度\n  float d_distance_ratio = styleMappingMat[3].g; // 当前点位距离占线总长的比例\n\n  gl_FragColor = mix(u_sourceColor, u_targetColor, v_segmentIndex/segmentNumber);\n\n  gl_FragColor.a *= opacity;\n\n  if(u_animate.x == Animate) {\n      animateSpeed = u_time / u_animate.y;\n      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);\n\n      alpha = (alpha + u_animate.w -1.0) / u_animate.w;\n      // alpha = smoothstep(0., 1., alpha);\n      alpha = clamp(alpha, 0.0, 1.0);\n      gl_FragColor.a *= alpha;\n\n      // u_animate \n      // x enable\n      // y duration\n      // z interval\n      // w trailLength\n  }\n\n  gl_FragColor = filterColor(gl_FragColor);\n}\n',vert:'#define LineTypeSolid 0.0\n#define LineTypeDash 1.0\n#define Animate 0.0\n#define LineTexture 1.0\nattribute vec3 a_Position;\nattribute vec4 a_Instance;\nattribute vec4 a_Color;\nattribute float a_Size;\nattribute vec2 a_iconMapUV;\n\nuniform float u_globel;\nuniform float u_globel_radius;\nuniform float u_global_height: 10;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\nuniform float segmentNumber;\nuniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];\n\nuniform float u_line_type: 0.0;\nuniform vec4 u_dash_array: [10.0, 5., 0, 0];\nuniform float u_icon_step: 100;\nuniform float u_line_texture: 0.0;\nuniform float u_opacity: 1.0;\n\nvarying vec4 v_dash_array;\nvarying vec4 v_color;\nvarying float v_segmentIndex;\nvarying vec2 v_iconMapUV;\nvarying mat4 styleMappingMat; // 用于将在顶点着色器中计算好的样式值传递给片元\n\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n\n#pragma include "projection"\n#pragma include "project"\n#pragma include "picking"\n\nfloat maps (float value, float start1, float stop1, float start2, float stop2) {\n  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));\n}\n\nfloat getSegmentRatio(float index) {\n  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));\n}\n\nfloat paraboloid(vec2 source, vec2 target, float ratio) {\n  vec2 x = mix(source, target, ratio);\n  vec2 center = mix(source, target, 0.5);\n  float dSourceCenter = distance(source, center);\n  float dXCenter = distance(x, center);\n  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);\n}\n\nvec3 getPos(vec2 source, vec2 target, float segmentRatio) {\n  float vertex_height = paraboloid(source, target, segmentRatio);\n\n  return vec3(\n    mix(source, target, segmentRatio),\n    sqrt(max(0.0, vertex_height))\n  );\n}\nvec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace);\n  // rotate by 90 degrees\n  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n\n  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;\n\n  return offset;\n}\nvec2 getNormal(vec2 line_clipspace, float offset_direction) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace);\n  // rotate by 90 degrees\n  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);\n}\n\nfloat torad(float deg) {\n  return (deg / 180.0) * acos(-1.0);\n}\n\nvec3 lglt2xyz(vec2 lnglat) {\n  float pi = 3.1415926;\n  // + Math.PI/2 是为了对齐坐标\n  float lng = torad(lnglat.x) + pi / 2.0;\n  float lat = torad(lnglat.y);\n\n  // 手动增加一些偏移，减轻面的冲突\n  float radius = u_globel_radius;\n\n  float z = radius * cos(lat) * cos(lng);\n  float x = radius * cos(lat) * sin(lng);\n  float y = radius * sin(lat);\n  return vec3(x, y, z);\n}\n\nvoid main() {\n  // cal style mapping - 数据纹理映射部分的计算\n  styleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0  // dataset 数据集\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // 当前的数据纹理有几行\n  float columnCount = u_cellTypeLayout[0][1]; // 当看到数据纹理有几列\n  float columnWidth = 1.0/columnCount;  // 列宽\n  float rowHeight = 1.0/rowCount;       // 行高\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // 第n个顶点\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // 起始点在第几行\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // 起始点在第几列\n  \n  // cell 固定顺序 opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // 按顺序从 cell 中取值、若没有则自动往下取值\n  float textureOffset = 0.0; // 在 cell 中取值的偏移量\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n  // cal style mapping - 数据纹理映射部分的计算\n\n  v_color = a_Color;\n  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;\n  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;\n  float segmentIndex = a_Position.x;\n  float segmentRatio = getSegmentRatio(segmentIndex);\n  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));\n\n  float d_distance_ratio;\n   if(u_line_type == LineTypeDash) {\n    d_distance_ratio = segmentIndex / segmentNumber;\n    // float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba) / 2.0 * PI;\n    vec2 s = source;\n    vec2 t = target;\n    \n    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n      s = unProjCustomCoord(source);\n      t = unProjCustomCoord(target);\n    }\n    float total_Distance = pixelDistance(s, t) / 2.0 * PI;\n    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);\n  }\n    if(u_animate.x == Animate) {\n      d_distance_ratio = segmentIndex / segmentNumber;\n  }\n  styleMappingMat[3].g = d_distance_ratio; // 当前点位距离占线总长的比例\n\n  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);\n  vec3 curr = getPos(source, target, segmentRatio);\n  vec3 next = getPos(source, target, nextSegmentRatio);\n  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);\n  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);\n\n\n  v_segmentIndex = a_Position.x;\n  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { // 开启贴图模式  \n\n    float arcDistrance = length(source - target);\n    float pixelLen =  project_pixel_texture(u_icon_step);\n    styleMappingMat[3].b = floor(arcDistrance/pixelLen); // 贴图在弧线上重复的数量\n\n    vec2 projectOffset = project_pixel(offset);\n    float lineOffsetWidth = length(projectOffset + projectOffset * sign(a_Position.y)); // 线横向偏移的距离\n    float linePixelSize = project_pixel(a_Size);  // 定点位置偏移，按地图等级缩放后的距离\n    styleMappingMat[3].a = lineOffsetWidth/linePixelSize;  // 线图层贴图部分的 v 坐标值\n\n    v_iconMapUV = a_iconMapUV;\n  }\n  \n\n  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n    gl_Position = u_Mvp * (vec4(curr.xy + project_pixel(offset), curr.z, 1.0));\n  } else {\n    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));\n  }\n\n  // 地球模式\n  if(u_globel > 0.0) {\n    vec3 startLngLat = lglt2xyz(a_Instance.rg);\n    vec3 endLngLat = lglt2xyz(a_Instance.ba);\n    float globalRadius = length(startLngLat);\n\n    vec3 lineDir = normalize(endLngLat - startLngLat);\n    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);\n\n    // 线的偏移\n    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;\n    // 计算起始点和终止点的距离\n    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;\n    // 计算飞线各个节点相应的高度\n    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;\n    // 地球点位\n    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;\n    \n    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);\n  }\n \n\n  setPickingColor(a_PickingColor);\n}\n',type:"Linear"}:{frag:'#define LineTypeSolid 0.0\n#define LineTypeDash 1.0\n#define Animate 0.0\n#define LineTexture 1.0\n\nuniform float u_opacity;\nuniform float u_textureBlend;\nuniform float u_blur : 0.9;\nuniform float u_line_type: 0.0;\n// varying vec2 v_normal;\nvarying vec4 v_dash_array;\nvarying vec4 v_color;\n\nuniform float u_line_texture: 0.0;\nuniform sampler2D u_texture;\nuniform vec2 u_textSize;\nvarying float v_segmentIndex;\nuniform float segmentNumber;\n\nvarying vec2 v_iconMapUV;\n\nuniform float u_time;\nuniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];\n\nvarying mat4 styleMappingMat;\n\n#pragma include "picking"\n\nvoid main() {\n  float opacity = styleMappingMat[0][0];\n  float animateSpeed = 0.0; // 运动速度\n  float d_distance_ratio = styleMappingMat[3].g; // 当前点位距离占线总长的比例\n  gl_FragColor = v_color;\n\n  gl_FragColor.a *= opacity;\n  if(u_line_type == LineTypeDash) {\n    float flag = 0.;\n    float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);\n    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {\n      flag = 1.;\n    }\n    gl_FragColor.a *=flag;\n  }\n\n  if(u_animate.x == Animate && u_line_texture != LineTexture) {\n      animateSpeed = u_time / u_animate.y;\n      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);\n\n      alpha = (alpha + u_animate.w -1.0) / u_animate.w;\n      // alpha = smoothstep(0., 1., alpha);\n      alpha = clamp(alpha, 0.0, 1.0);\n      gl_FragColor.a *= alpha;\n\n      // u_animate \n      // x enable\n      // y duration\n      // z interval\n      // w trailLength\n  }\n\n  if(u_line_texture == LineTexture && u_line_type != LineTypeDash) { // while load texture\n    // float arcRadio = smoothstep( 0.0, 1.0, (v_segmentIndex / segmentNumber));\n    float arcRadio = v_segmentIndex / (segmentNumber - 1.0);\n    float count = styleMappingMat[3].b; // // 贴图在弧线上重复的数量\n\n    float time = 0.0;\n    if(u_animate.x == Animate) {\n      time = u_time / u_animate.y;\n    }\n    float redioCount = arcRadio * count;\n\n    float u = fract(redioCount - time);\n\n    float v = styleMappingMat[3].a;  // 线图层贴图部分的 v 坐标值\n    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;\n    vec4 pattern = texture2D(u_texture, uv);\n\n    if(u_animate.x == Animate) {\n      float currentPlane = floor(redioCount - time);\n      float textureStep = floor(count * u_animate.z);\n      float a = mod(currentPlane, textureStep);\n      if(a < textureStep - 1.0) {\n        pattern = vec4(0.0);\n      }\n    }\n\n    if(u_textureBlend == 0.0) { // normal\n      pattern.a = 0.0;\n      gl_FragColor = filterColor(gl_FragColor + pattern);\n    } else { // replace\n        pattern.a *= opacity;\n        if(gl_FragColor.a <= 0.0) {\n          pattern.a = 0.0;\n          discard;\n        } else {\n          gl_FragColor = filterColor(pattern);\n        }\n    }\n\n  } else {\n    gl_FragColor = filterColor(gl_FragColor);\n  }\n}\n',vert:'#define LineTypeSolid 0.0\n#define LineTypeDash 1.0\n#define Animate 0.0\n#define LineTexture 1.0\nattribute vec3 a_Position;\nattribute vec4 a_Instance;\nattribute vec4 a_Color;\nattribute float a_Size;\n\nuniform float u_globel;\nuniform float u_globel_radius;\nuniform float u_global_height: 10;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\nuniform float segmentNumber;\nuniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];\nvarying vec4 v_color;\n\nuniform float u_line_type: 0.0;\nuniform vec4 u_dash_array: [10.0, 5., 0, 0];\nvarying vec4 v_dash_array;\n\nuniform float u_icon_step: 100;\nuniform float u_line_texture: 0.0;\nvarying float v_segmentIndex;\n\nattribute vec2 a_iconMapUV;\nvarying vec2 v_iconMapUV;\n\nuniform float u_opacity: 1.0;\nvarying mat4 styleMappingMat; // 用于将在顶点着色器中计算好的样式值传递给片元\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n\n#pragma include "projection"\n#pragma include "project"\n#pragma include "picking"\n\nfloat maps (float value, float start1, float stop1, float start2, float stop2) {\n  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));\n}\n\nfloat getSegmentRatio(float index) {\n  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));\n}\n\nfloat paraboloid(vec2 source, vec2 target, float ratio) {\n  vec2 x = mix(source, target, ratio);\n  vec2 center = mix(source, target, 0.5);\n  float dSourceCenter = distance(source, center);\n  float dXCenter = distance(x, center);\n  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);\n}\n\nvec3 getPos(vec2 source, vec2 target, float segmentRatio) {\n  float vertex_height = paraboloid(source, target, segmentRatio);\n\n  return vec3(\n    mix(source, target, segmentRatio),\n    sqrt(max(0.0, vertex_height))\n  );\n}\nvec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace);\n  // rotate by 90 degrees\n  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n\n  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;\n\n  return offset;\n}\nvec2 getNormal(vec2 line_clipspace, float offset_direction) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace);\n  // rotate by 90 degrees\n  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);\n}\n\nfloat torad(float deg) {\n  return (deg / 180.0) * acos(-1.0);\n}\n\nvec3 lglt2xyz(vec2 lnglat) {\n  float pi = 3.1415926;\n  // + Math.PI/2 是为了对齐坐标\n  float lng = torad(lnglat.x) + pi / 2.0;\n  float lat = torad(lnglat.y);\n\n  // 手动增加一些偏移，减轻面的冲突\n  float radius = u_globel_radius;\n\n  float z = radius * cos(lat) * cos(lng);\n  float x = radius * cos(lat) * sin(lng);\n  float y = radius * sin(lat);\n  return vec3(x, y, z);\n}\n\nvoid main() {\n  // cal style mapping - 数据纹理映射部分的计算\n  styleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0  // dataset 数据集\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // 当前的数据纹理有几行\n  float columnCount = u_cellTypeLayout[0][1]; // 当看到数据纹理有几列\n  float columnWidth = 1.0/columnCount;  // 列宽\n  float rowHeight = 1.0/rowCount;       // 行高\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // 第n个顶点\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // 起始点在第几行\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // 起始点在第几列\n  \n  // cell 固定顺序 opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // 按顺序从 cell 中取值、若没有则自动往下取值\n  float textureOffset = 0.0; // 在 cell 中取值的偏移量\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n  // cal style mapping - 数据纹理映射部分的计算\n\n  v_color = a_Color;\n  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;\n  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;\n  float segmentIndex = a_Position.x;\n  float segmentRatio = getSegmentRatio(segmentIndex);\n  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));\n\n  float d_distance_ratio;\n   if(u_line_type == LineTypeDash) {\n    d_distance_ratio = segmentIndex / segmentNumber;\n    vec2 s = source;\n    vec2 t = target;\n    \n    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n      s = unProjCustomCoord(source);\n      t = unProjCustomCoord(target);\n    }\n    float total_Distance = pixelDistance(s, t) / 2.0 * PI;\n    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);\n  }\n    if(u_animate.x == Animate) {\n      d_distance_ratio = segmentIndex / segmentNumber;\n  }\n  styleMappingMat[3].g = d_distance_ratio; // 当前点位距离占线总长的比例\n\n  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);\n  vec3 curr = getPos(source, target, segmentRatio);\n  vec3 next = getPos(source, target, nextSegmentRatio);\n  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);\n  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);\n\n\n  v_segmentIndex = a_Position.x;\n  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { // 开启贴图模式  \n\n    float arcDistrance = length(source - target);\n    float pixelLen =  project_pixel_texture(u_icon_step);\n    styleMappingMat[3].b = floor(arcDistrance/pixelLen); // 贴图在弧线上重复的数量\n\n    vec2 projectOffset = project_pixel(offset);\n    float lineOffsetWidth = length(projectOffset + projectOffset * sign(a_Position.y)); // 线横向偏移的距离\n    float linePixelSize = project_pixel(a_Size);  // 定点位置偏移，按地图等级缩放后的距离\n    styleMappingMat[3].a = lineOffsetWidth/linePixelSize;  // 线图层贴图部分的 v 坐标值\n\n    v_iconMapUV = a_iconMapUV;\n  }\n  \n\n  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n    gl_Position = u_Mvp * (vec4(curr.xy + project_pixel(offset), curr.z, 1.0));\n  } else {\n    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));\n  }\n\n  // 地球模式\n  if(u_globel > 0.0) {\n    vec3 startLngLat = lglt2xyz(a_Instance.rg);\n    vec3 endLngLat = lglt2xyz(a_Instance.ba);\n    float globalRadius = length(startLngLat);\n\n    vec3 lineDir = normalize(endLngLat - startLngLat);\n    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);\n\n    // 线的偏移\n    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;\n    // 计算起始点和终止点的距离\n    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;\n    // 计算飞线各个节点相应的高度\n    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;\n    // 地球点位\n    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;\n    \n    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);\n  }\n \n\n  setPickingColor(a_PickingColor);\n}\n',type:""}}},{key:"buildModels",value:(e=RK(jK.mark((function t(){var e,n,r,i,o,a,s,u,c,l,h,f;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.layer.getLayerConfig(),n=e.segmentNumber,r=void 0===n?30:n,i=e.mask,o=void 0!==i&&i,a=e.maskInside,s=void 0===a||a,u=this.getShaders(),c=u.frag,l=u.vert,h=u.type,t.next=4,this.layer.buildLayerModel({moduleName:"lineArc3d"+h,vertexShader:l,fragmentShader:c,triangulation:Xet,blend:this.getBlend(),segmentNumber:r,stencil:PK(o,s)});case 4:return f=t.sent,t.abrupt("return",[f]);case 6:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"registerBuiltinAttributes",value:function(){var t=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:d8.Attribute,descriptor:{name:"a_Size",buffer:{usage:m4.DYNAMIC_DRAW,data:[],type:m4.FLOAT},size:1,update:function(t){var e=t.size,n=void 0===e?1:e;return Array.isArray(n)?[n[0]]:[n]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:d8.Attribute,descriptor:{name:"a_Instance",buffer:{usage:m4.STATIC_DRAW,data:[],type:m4.FLOAT},size:4,update:function(t,e,n){return[n[3],n[4],n[5],n[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:d8.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:m4.DYNAMIC_DRAW,data:[],type:m4.FLOAT},size:2,update:function(e){var n=t.iconService.getIconMap()[e.texture]||{x:0,y:0};return[n.x,n.y]}}})}}]),i}();function ont(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var ant={solid:0,dash:1},snt=function(t){wZ(i,oet);var e,n,r=ont(i);function i(){var t;mZ(this,i);for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return $q(SZ(t=r.call.apply(r,[this].concat(n))),"updateTexture",(function(){var e=t.rendererService.createTexture2D;if(t.texture)return t.texture.update({data:t.iconService.getCanvas()}),void t.layer.render();t.texture=e({data:t.iconService.getCanvas(),mag:m4.NEAREST,min:m4.NEAREST,premultiplyAlpha:!1,width:1024,height:t.iconService.canvasHeight||128})})),t}return gZ(i,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),e=t.opacity,n=void 0===e?1:e,r=t.sourceColor,i=t.targetColor,o=t.textureBlend,a=void 0===o?"normal":o,s=t.lineType,u=void 0===s?"solid":s,c=t.dashArray,l=void 0===c?[10,5]:c,h=t.lineTexture,f=void 0!==h&&h,p=t.iconStep,d=void 0===p?100:p,m=t.segmentNumber,v=void 0===m?30:m,g=t.globalArcHeight,y=void 0===g?10:g;2===l.length&&l.push(0,0);var x=0,b=[0,0,0,0],_=[0,0,0,0];if(r&&i&&(b=EK(r),_=EK(i),x=1),this.rendererService.getDirty()&&this.texture.bind(),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:n})){this.judgeStyleAttributes({opacity:n});var w=this.layer.getEncodedData(),S=this.calDataFrame(this.cellLength,w,this.cellProperties),M=S.data,E=S.width,A=S.height;this.rowCount=A,this.dataTexture=this.cellLength>0&&M.length>0?this.createTexture2D({flipY:!0,data:M,format:m4.LUMINANCE,type:m4.FLOAT,width:E,height:A}):this.createTexture2D({flipY:!0,data:[1],format:m4.LUMINANCE,type:m4.FLOAT,width:1,height:1})}return{u_globel:1,u_globel_radius:100,u_global_height:y,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:hZ.isNumber(n)?n:1,u_textureBlend:"normal"===a?0:1,segmentNumber:v,u_line_type:ant[u]||0,u_dash_array:l,u_texture:this.texture,u_line_texture:f?1:0,u_icon_step:d,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:x,u_sourceColor:b,u_targetColor:_}}},{key:"getAnimateUniforms",value:function(){var t=this.layer.getLayerConfig().animateOption;return{u_animate:this.animateOption2Array(t),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:(n=RK(jK.mark((function t(){return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),t.next=4,this.buildModels();case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"clearModels",value:function(){var t,e;null===(t=this.texture)||void 0===t||t.destroy(),null===(e=this.dataTexture)||void 0===e||e.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"getShaders",value:function(){var t=this.layer.getLayerConfig(),e=t.sourceColor,n=t.targetColor;return e&&n?{frag:'\n#define Animate 0.0\n\nuniform float u_opacity;\nuniform float u_blur : 0.9;\nvarying float v_segmentIndex;\nuniform float segmentNumber;\n\nuniform float u_time;\nuniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];\n\nuniform float u_linearColor: 0;\nuniform vec4 u_sourceColor;\nuniform vec4 u_targetColor;\n\nvarying mat4 styleMappingMat;\n\n#pragma include "picking"\n\nvoid main() {\n  float opacity = styleMappingMat[0][0];\n  float animateSpeed = 0.0; // 运动速度\n  float d_distance_ratio = styleMappingMat[3].g; // 当前点位距离占线总长的比例\n\n  gl_FragColor = mix(u_sourceColor, u_targetColor, v_segmentIndex/segmentNumber);\n\n  gl_FragColor.a *= opacity;\n\n  if(u_animate.x == Animate) {\n      animateSpeed = u_time / u_animate.y;\n      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);\n\n      alpha = (alpha + u_animate.w -1.0) / u_animate.w;\n      // alpha = smoothstep(0., 1., alpha);\n      alpha = clamp(alpha, 0.0, 1.0);\n      gl_FragColor.a *= alpha;\n\n      // u_animate \n      // x enable\n      // y duration\n      // z interval\n      // w trailLength\n  }\n\n  gl_FragColor = filterColor(gl_FragColor);\n}\n',vert:'#define LineTypeSolid 0.0\n#define LineTypeDash 1.0\n#define Animate 0.0\n#define LineTexture 1.0\nattribute vec3 a_Position;\nattribute vec4 a_Instance;\nattribute vec4 a_Color;\nattribute float a_Size;\nattribute vec2 a_iconMapUV;\n\nuniform float u_globel;\nuniform float u_globel_radius;\nuniform float u_global_height: 10;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\nuniform float segmentNumber;\nuniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];\n\nuniform float u_line_type: 0.0;\nuniform vec4 u_dash_array: [10.0, 5., 0, 0];\nuniform float u_icon_step: 100;\nuniform float u_line_texture: 0.0;\nuniform float u_opacity: 1.0;\n\nvarying vec4 v_dash_array;\nvarying vec4 v_color;\nvarying float v_segmentIndex;\nvarying vec2 v_iconMapUV;\nvarying mat4 styleMappingMat; // 用于将在顶点着色器中计算好的样式值传递给片元\n\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n\n#pragma include "projection"\n#pragma include "project"\n#pragma include "picking"\n\nfloat maps (float value, float start1, float stop1, float start2, float stop2) {\n  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));\n}\n\nfloat getSegmentRatio(float index) {\n  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));\n}\n\nfloat paraboloid(vec2 source, vec2 target, float ratio) {\n  vec2 x = mix(source, target, ratio);\n  vec2 center = mix(source, target, 0.5);\n  float dSourceCenter = distance(source, center);\n  float dXCenter = distance(x, center);\n  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);\n}\n\nvec3 getPos(vec2 source, vec2 target, float segmentRatio) {\n  float vertex_height = paraboloid(source, target, segmentRatio);\n\n  return vec3(\n    mix(source, target, segmentRatio),\n    sqrt(max(0.0, vertex_height))\n  );\n}\nvec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace);\n  // rotate by 90 degrees\n  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n\n  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;\n\n  return offset;\n}\nvec2 getNormal(vec2 line_clipspace, float offset_direction) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace);\n  // rotate by 90 degrees\n  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);\n}\n\nfloat torad(float deg) {\n  return (deg / 180.0) * acos(-1.0);\n}\n\nvec3 lglt2xyz(vec2 lnglat) {\n  float pi = 3.1415926;\n  // + Math.PI/2 是为了对齐坐标\n  float lng = torad(lnglat.x) + pi / 2.0;\n  float lat = torad(lnglat.y);\n\n  // 手动增加一些偏移，减轻面的冲突\n  float radius = u_globel_radius;\n\n  float z = radius * cos(lat) * cos(lng);\n  float x = radius * cos(lat) * sin(lng);\n  float y = radius * sin(lat);\n  return vec3(x, y, z);\n}\n\nvoid main() {\n  // cal style mapping - 数据纹理映射部分的计算\n  styleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0  // dataset 数据集\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // 当前的数据纹理有几行\n  float columnCount = u_cellTypeLayout[0][1]; // 当看到数据纹理有几列\n  float columnWidth = 1.0/columnCount;  // 列宽\n  float rowHeight = 1.0/rowCount;       // 行高\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // 第n个顶点\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // 起始点在第几行\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // 起始点在第几列\n  \n  // cell 固定顺序 opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // 按顺序从 cell 中取值、若没有则自动往下取值\n  float textureOffset = 0.0; // 在 cell 中取值的偏移量\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n  // cal style mapping - 数据纹理映射部分的计算\n\n  v_color = a_Color;\n  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;\n  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;\n  float segmentIndex = a_Position.x;\n  float segmentRatio = getSegmentRatio(segmentIndex);\n  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));\n\n  float d_distance_ratio;\n   if(u_line_type == LineTypeDash) {\n    d_distance_ratio = segmentIndex / segmentNumber;\n    // float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba) / 2.0 * PI;\n    vec2 s = source;\n    vec2 t = target;\n    \n    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n      s = unProjCustomCoord(source);\n      t = unProjCustomCoord(target);\n    }\n    float total_Distance = pixelDistance(s, t) / 2.0 * PI;\n    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);\n  }\n    if(u_animate.x == Animate) {\n      d_distance_ratio = segmentIndex / segmentNumber;\n  }\n  styleMappingMat[3].g = d_distance_ratio; // 当前点位距离占线总长的比例\n\n  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);\n  vec3 curr = getPos(source, target, segmentRatio);\n  vec3 next = getPos(source, target, nextSegmentRatio);\n  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);\n  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);\n\n\n  v_segmentIndex = a_Position.x;\n  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { // 开启贴图模式  \n\n    float arcDistrance = length(source - target);\n    float pixelLen =  project_pixel_texture(u_icon_step);\n    styleMappingMat[3].b = floor(arcDistrance/pixelLen); // 贴图在弧线上重复的数量\n\n    vec2 projectOffset = project_pixel(offset);\n    float lineOffsetWidth = length(projectOffset + projectOffset * sign(a_Position.y)); // 线横向偏移的距离\n    float linePixelSize = project_pixel(a_Size);  // 定点位置偏移，按地图等级缩放后的距离\n    styleMappingMat[3].a = lineOffsetWidth/linePixelSize;  // 线图层贴图部分的 v 坐标值\n\n    v_iconMapUV = a_iconMapUV;\n  }\n  \n\n  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n    gl_Position = u_Mvp * (vec4(curr.xy + project_pixel(offset), curr.z, 1.0));\n  } else {\n    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));\n  }\n\n  // 地球模式\n  if(u_globel > 0.0) {\n    vec3 startLngLat = lglt2xyz(a_Instance.rg);\n    vec3 endLngLat = lglt2xyz(a_Instance.ba);\n    float globalRadius = length(startLngLat);\n\n    vec3 lineDir = normalize(endLngLat - startLngLat);\n    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);\n\n    // 线的偏移\n    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;\n    // 计算起始点和终止点的距离\n    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;\n    // 计算飞线各个节点相应的高度\n    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;\n    // 地球点位\n    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;\n    \n    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);\n  }\n \n\n  setPickingColor(a_PickingColor);\n}\n',type:"Linear"}:{frag:'#define LineTypeSolid 0.0\n#define LineTypeDash 1.0\n#define Animate 0.0\n#define LineTexture 1.0\n\nuniform float u_opacity;\nuniform float u_textureBlend;\nuniform float u_blur : 0.9;\nuniform float u_line_type: 0.0;\n// varying vec2 v_normal;\nvarying vec4 v_dash_array;\nvarying vec4 v_color;\n\nuniform float u_line_texture: 0.0;\nuniform sampler2D u_texture;\nuniform vec2 u_textSize;\nvarying float v_segmentIndex;\nuniform float segmentNumber;\n\nvarying vec2 v_iconMapUV;\n\nuniform float u_time;\nuniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];\n\nvarying mat4 styleMappingMat;\n\n#pragma include "picking"\n\nvoid main() {\n  float opacity = styleMappingMat[0][0];\n  float animateSpeed = 0.0; // 运动速度\n  float d_distance_ratio = styleMappingMat[3].g; // 当前点位距离占线总长的比例\n  gl_FragColor = v_color;\n\n  gl_FragColor.a *= opacity;\n  if(u_line_type == LineTypeDash) {\n    float flag = 0.;\n    float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);\n    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {\n      flag = 1.;\n    }\n    gl_FragColor.a *=flag;\n  }\n\n  if(u_animate.x == Animate && u_line_texture != LineTexture) {\n      animateSpeed = u_time / u_animate.y;\n      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);\n\n      alpha = (alpha + u_animate.w -1.0) / u_animate.w;\n      // alpha = smoothstep(0., 1., alpha);\n      alpha = clamp(alpha, 0.0, 1.0);\n      gl_FragColor.a *= alpha;\n\n      // u_animate \n      // x enable\n      // y duration\n      // z interval\n      // w trailLength\n  }\n\n  if(u_line_texture == LineTexture && u_line_type != LineTypeDash) { // while load texture\n    // float arcRadio = smoothstep( 0.0, 1.0, (v_segmentIndex / segmentNumber));\n    float arcRadio = v_segmentIndex / (segmentNumber - 1.0);\n    float count = styleMappingMat[3].b; // // 贴图在弧线上重复的数量\n\n    float time = 0.0;\n    if(u_animate.x == Animate) {\n      time = u_time / u_animate.y;\n    }\n    float redioCount = arcRadio * count;\n\n    float u = fract(redioCount - time);\n\n    float v = styleMappingMat[3].a;  // 线图层贴图部分的 v 坐标值\n    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;\n    vec4 pattern = texture2D(u_texture, uv);\n\n    if(u_animate.x == Animate) {\n      float currentPlane = floor(redioCount - time);\n      float textureStep = floor(count * u_animate.z);\n      float a = mod(currentPlane, textureStep);\n      if(a < textureStep - 1.0) {\n        pattern = vec4(0.0);\n      }\n    }\n\n    if(u_textureBlend == 0.0) { // normal\n      pattern.a = 0.0;\n      gl_FragColor = filterColor(gl_FragColor + pattern);\n    } else { // replace\n        pattern.a *= opacity;\n        if(gl_FragColor.a <= 0.0) {\n          pattern.a = 0.0;\n          discard;\n        } else {\n          gl_FragColor = filterColor(pattern);\n        }\n    }\n\n  } else {\n    gl_FragColor = filterColor(gl_FragColor);\n  }\n}\n',vert:'#define LineTypeSolid 0.0\n#define LineTypeDash 1.0\n#define Animate 0.0\n#define LineTexture 1.0\nattribute vec3 a_Position;\nattribute vec4 a_Instance;\nattribute vec4 a_Color;\nattribute float a_Size;\n\nuniform float u_globel;\nuniform float u_globel_radius;\nuniform float u_global_height: 10;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\nuniform float segmentNumber;\nuniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];\nvarying vec4 v_color;\n\nuniform float u_line_type: 0.0;\nuniform vec4 u_dash_array: [10.0, 5., 0, 0];\nvarying vec4 v_dash_array;\n\nuniform float u_icon_step: 100;\nuniform float u_line_texture: 0.0;\nvarying float v_segmentIndex;\n\nattribute vec2 a_iconMapUV;\nvarying vec2 v_iconMapUV;\n\nuniform float u_opacity: 1.0;\nvarying mat4 styleMappingMat; // 用于将在顶点着色器中计算好的样式值传递给片元\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n\n#pragma include "projection"\n#pragma include "project"\n#pragma include "picking"\n\nfloat maps (float value, float start1, float stop1, float start2, float stop2) {\n  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));\n}\n\nfloat getSegmentRatio(float index) {\n  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));\n}\n\nfloat paraboloid(vec2 source, vec2 target, float ratio) {\n  vec2 x = mix(source, target, ratio);\n  vec2 center = mix(source, target, 0.5);\n  float dSourceCenter = distance(source, center);\n  float dXCenter = distance(x, center);\n  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);\n}\n\nvec3 getPos(vec2 source, vec2 target, float segmentRatio) {\n  float vertex_height = paraboloid(source, target, segmentRatio);\n\n  return vec3(\n    mix(source, target, segmentRatio),\n    sqrt(max(0.0, vertex_height))\n  );\n}\nvec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace);\n  // rotate by 90 degrees\n  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n\n  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;\n\n  return offset;\n}\nvec2 getNormal(vec2 line_clipspace, float offset_direction) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace);\n  // rotate by 90 degrees\n  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);\n}\n\nfloat torad(float deg) {\n  return (deg / 180.0) * acos(-1.0);\n}\n\nvec3 lglt2xyz(vec2 lnglat) {\n  float pi = 3.1415926;\n  // + Math.PI/2 是为了对齐坐标\n  float lng = torad(lnglat.x) + pi / 2.0;\n  float lat = torad(lnglat.y);\n\n  // 手动增加一些偏移，减轻面的冲突\n  float radius = u_globel_radius;\n\n  float z = radius * cos(lat) * cos(lng);\n  float x = radius * cos(lat) * sin(lng);\n  float y = radius * sin(lat);\n  return vec3(x, y, z);\n}\n\nvoid main() {\n  // cal style mapping - 数据纹理映射部分的计算\n  styleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0  // dataset 数据集\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // 当前的数据纹理有几行\n  float columnCount = u_cellTypeLayout[0][1]; // 当看到数据纹理有几列\n  float columnWidth = 1.0/columnCount;  // 列宽\n  float rowHeight = 1.0/rowCount;       // 行高\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // 第n个顶点\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // 起始点在第几行\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // 起始点在第几列\n  \n  // cell 固定顺序 opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // 按顺序从 cell 中取值、若没有则自动往下取值\n  float textureOffset = 0.0; // 在 cell 中取值的偏移量\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n  // cal style mapping - 数据纹理映射部分的计算\n\n  v_color = a_Color;\n  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;\n  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;\n  float segmentIndex = a_Position.x;\n  float segmentRatio = getSegmentRatio(segmentIndex);\n  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));\n\n  float d_distance_ratio;\n   if(u_line_type == LineTypeDash) {\n    d_distance_ratio = segmentIndex / segmentNumber;\n    vec2 s = source;\n    vec2 t = target;\n    \n    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n      s = unProjCustomCoord(source);\n      t = unProjCustomCoord(target);\n    }\n    float total_Distance = pixelDistance(s, t) / 2.0 * PI;\n    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);\n  }\n    if(u_animate.x == Animate) {\n      d_distance_ratio = segmentIndex / segmentNumber;\n  }\n  styleMappingMat[3].g = d_distance_ratio; // 当前点位距离占线总长的比例\n\n  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);\n  vec3 curr = getPos(source, target, segmentRatio);\n  vec3 next = getPos(source, target, nextSegmentRatio);\n  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);\n  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);\n\n\n  v_segmentIndex = a_Position.x;\n  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { // 开启贴图模式  \n\n    float arcDistrance = length(source - target);\n    float pixelLen =  project_pixel_texture(u_icon_step);\n    styleMappingMat[3].b = floor(arcDistrance/pixelLen); // 贴图在弧线上重复的数量\n\n    vec2 projectOffset = project_pixel(offset);\n    float lineOffsetWidth = length(projectOffset + projectOffset * sign(a_Position.y)); // 线横向偏移的距离\n    float linePixelSize = project_pixel(a_Size);  // 定点位置偏移，按地图等级缩放后的距离\n    styleMappingMat[3].a = lineOffsetWidth/linePixelSize;  // 线图层贴图部分的 v 坐标值\n\n    v_iconMapUV = a_iconMapUV;\n  }\n  \n\n  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n    gl_Position = u_Mvp * (vec4(curr.xy + project_pixel(offset), curr.z, 1.0));\n  } else {\n    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));\n  }\n\n  // 地球模式\n  if(u_globel > 0.0) {\n    vec3 startLngLat = lglt2xyz(a_Instance.rg);\n    vec3 endLngLat = lglt2xyz(a_Instance.ba);\n    float globalRadius = length(startLngLat);\n\n    vec3 lineDir = normalize(endLngLat - startLngLat);\n    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);\n\n    // 线的偏移\n    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;\n    // 计算起始点和终止点的距离\n    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;\n    // 计算飞线各个节点相应的高度\n    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;\n    // 地球点位\n    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;\n    \n    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);\n  }\n \n\n  setPickingColor(a_PickingColor);\n}\n',type:""}}},{key:"buildModels",value:(e=RK(jK.mark((function t(){var e,n,r,i,o,a,s,u,c,l,h,f;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.layer.getLayerConfig(),n=e.segmentNumber,r=void 0===n?30:n,i=e.mask,o=void 0!==i&&i,a=e.maskInside,s=void 0===a||a,u=this.getShaders(),c=u.frag,l=u.vert,h=u.type,t.next=4,this.layer.buildLayerModel({moduleName:"lineEarthArc3d"+h,vertexShader:l,fragmentShader:c,triangulation:Xet,depth:{enable:!0},blend:this.getBlend(),segmentNumber:r,stencil:PK(o,s)});case 4:return f=t.sent,t.abrupt("return",[f]);case 6:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"registerBuiltinAttributes",value:function(){var t=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:d8.Attribute,descriptor:{name:"a_Size",buffer:{usage:m4.DYNAMIC_DRAW,data:[],type:m4.FLOAT},size:1,update:function(t){var e=t.size,n=void 0===e?1:e;return Array.isArray(n)?[n[0]]:[n]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:d8.Attribute,descriptor:{name:"a_Instance",buffer:{usage:m4.STATIC_DRAW,data:[],type:m4.FLOAT},size:4,update:function(t,e,n){return[n[3],n[4],n[5],n[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:d8.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:m4.DYNAMIC_DRAW,data:[],type:m4.FLOAT},size:2,update:function(e){var n=t.iconService.getIconMap()[e.texture]||{x:0,y:0};return[n.x,n.y]}}})}}]),i}();function unt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var cnt={solid:0,dash:1},lnt=function(t){wZ(i,oet);var e,n,r=unt(i);function i(){var t;mZ(this,i);for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return $q(SZ(t=r.call.apply(r,[this].concat(n))),"updateTexture",(function(){var e=t.rendererService.createTexture2D;if(t.texture)return t.texture.update({data:t.iconService.getCanvas()}),void t.layer.render();t.texture=e({data:t.iconService.getCanvas(),mag:m4.NEAREST,min:m4.NEAREST,premultiplyAlpha:!1,width:1024,height:t.iconService.canvasHeight||128})})),t}return gZ(i,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),e=t.opacity,n=void 0===e?1:e,r=t.sourceColor,i=t.targetColor,o=t.textureBlend,a=void 0===o?"normal":o,s=t.lineType,u=void 0===s?"solid":s,c=t.dashArray,l=void 0===c?[10,5]:c,h=t.lineTexture,f=void 0!==h&&h,p=t.iconStep,d=void 0===p?100:p,m=t.segmentNumber,v=void 0===m?30:m;2===l.length&&l.push(0,0),this.rendererService.getDirty()&&this.texture.bind();var g=0,y=[0,0,0,0],x=[0,0,0,0];if(r&&i&&(y=EK(r),x=EK(i),g=1),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:n})){this.judgeStyleAttributes({opacity:n});var b=this.layer.getEncodedData(),_=this.calDataFrame(this.cellLength,b,this.cellProperties),w=_.data,S=_.width,M=_.height;this.rowCount=M,this.dataTexture=this.cellLength>0&&w.length>0?this.createTexture2D({flipY:!0,data:w,format:m4.LUMINANCE,type:m4.FLOAT,width:S,height:M}):this.createTexture2D({flipY:!0,data:[1],format:m4.LUMINANCE,type:m4.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:hZ.isNumber(n)?n:1,u_textureBlend:"normal"===a?0:1,segmentNumber:v,u_line_type:cnt[u]||0,u_dash_array:l,u_texture:this.texture,u_line_texture:f?1:0,u_icon_step:d,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:g,u_sourceColor:y,u_targetColor:x}}},{key:"getAnimateUniforms",value:function(){var t=this.layer.getLayerConfig().animateOption;return{u_animate:this.animateOption2Array(t),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:(n=RK(jK.mark((function t(){return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),t.next=4,this.buildModels();case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"clearModels",value:function(){var t,e;null===(t=this.texture)||void 0===t||t.destroy(),null===(e=this.dataTexture)||void 0===e||e.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:(e=RK(jK.mark((function t(){var e,n,r,i,o,a;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.layer.getLayerConfig(),n=e.mask,r=void 0!==n&&n,i=e.maskInside,o=void 0===i||i,t.next=3,this.layer.buildLayerModel({moduleName:"lineGreatCircle",vertexShader:'#define LineTypeSolid 0.0\n#define LineTypeDash 1.0\n#define Animate 0.0\n#define LineTexture 1.0\n\nattribute vec4 a_Color;\nattribute vec3 a_Position;\nattribute vec4 a_Instance;\nattribute float a_Size;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\nuniform float segmentNumber;\nuniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];\nvarying vec4 v_color;\n\nvarying float v_distance_ratio;\nuniform float u_line_type: 0.0;\nuniform vec4 u_dash_array: [10.0, 5., 0, 0];\nvarying vec4 v_dash_array;\n\nuniform float u_icon_step: 100;\nuniform float u_line_texture: 0.0;\n\nattribute vec2 a_iconMapUV;\nvarying vec2 v_iconMapUV;\n\nuniform float u_opacity: 1.0;\nvarying mat4 styleMappingMat; // 用于将在顶点着色器中计算好的样式值传递给片元\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n\n#pragma include "projection"\n#pragma include "project"\n#pragma include "picking"\n\nfloat maps (float value, float start1, float stop1, float start2, float stop2) {\n    return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));\n}\n\nfloat getSegmentRatio(float index) {\n    return index / (segmentNumber - 1.);\n}\n\nfloat paraboloid(vec2 source, vec2 target, float ratio) {\n    vec2 x = mix(source, target, ratio);\n    vec2 center = mix(source, target, 0.5);\n    float dSourceCenter = distance(source, center);\n    float dXCenter = distance(x, center);\n    return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);\n}\n\nvec3 getPos(vec2 source, vec2 target, float segmentRatio) {\n     float vertex_height = paraboloid(source, target, segmentRatio);\n\n    return vec3(\n    mix(source, target, segmentRatio),\n    sqrt(max(0.0, vertex_height))\n    );\n}\nvec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace);\n  // rotate by 90 degrees\n   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size)/ 2.0;\n  return offset;\n}\nvec2 getNormal(vec2 line_clipspace, float offset_direction) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace);\n  // rotate by 90 degrees\n   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);\n}\nfloat getAngularDist (vec2 source, vec2 target) {\n  vec2 delta = source - target;\n  vec2 sin_half_delta = sin(delta / 2.0);\n  float a =\n    sin_half_delta.y * sin_half_delta.y +\n    cos(source.y) * cos(target.y) *\n    sin_half_delta.x * sin_half_delta.x;\n  return 2.0 * atan(sqrt(a), sqrt(1.0 - a));\n}\n\nvec2 midPoint(vec2 source, vec2 target) {\n  vec2 center = target - source;\n  float r = length(center);\n  float theta = atan(center.y, center.x);\n  float thetaOffset = 0.314;\n  float r2 = r / 2.0 / cos(thetaOffset);\n  float theta2 = theta + thetaOffset;\n  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);\n  return mid;\n}\nfloat bezier3(vec3 arr, float t) {\n  float ut = 1. - t;\n  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;\n}\n\nvec2 interpolate (vec2 source, vec2 target, float angularDist, float t) {\n  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n    vec2 mid = midPoint(source, target);\n    vec3 x = vec3(source.x, mid.x, target.x);\n    vec3 y = vec3(source.y, mid.y, target.y);\n    return vec2(bezier3(x ,t), bezier3(y,t));\n  }else {\n    if(abs(angularDist - PI) < 0.001) {\n      return (1.0 - t) * source + t * target;\n    }\n    float a = sin((1.0 - t) * angularDist) / sin(angularDist);\n    float b = sin(t * angularDist) / sin(angularDist);\n    vec2 sin_source = sin(source);\n    vec2 cos_source = cos(source);\n    vec2 sin_target = sin(target);\n    vec2 cos_target = cos(target);\n    float x = a * cos_source.y * cos_source.x + b * cos_target.y * cos_target.x;\n    float y = a * cos_source.y * sin_source.x + b * cos_target.y * sin_target.x;\n    float z = a * sin_source.y + b * sin_target.y;\n    return vec2(atan(y, x), atan(z, sqrt(x * x + y * y)));\n  }\n}\n\nvoid main() {\n  // cal style mapping - 数据纹理映射部分的计算\n  styleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0  // dataset 数据集\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // 当前的数据纹理有几行\n  float columnCount = u_cellTypeLayout[0][1]; // 当看到数据纹理有几列\n  float columnWidth = 1.0/columnCount;  // 列宽\n  float rowHeight = 1.0/rowCount;       // 行高\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // 第n个顶点\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // 起始点在第几行\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // 起始点在第几列\n  \n  // cell 固定顺序 opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // 按顺序从 cell 中取值、若没有则自动往下取值\n  float textureOffset = 0.0; // 在 cell 中取值的偏移量\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n  // cal style mapping - 数据纹理映射部分的计算\n\n  v_color = a_Color;\n  vec2 source = radians(a_Instance.rg);\n  vec2 target = radians(a_Instance.ba);\n  float angularDist = getAngularDist(source, target);\n  float segmentIndex = a_Position.x;\n  float segmentRatio = getSegmentRatio(segmentIndex);\n  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));\n\n  if(u_line_type == LineTypeDash) {\n    v_distance_ratio = segmentIndex / segmentNumber;\n    vec2 s = source;\n    vec2 t = target;\n    \n    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n      s = unProjCustomCoord(source);\n      t = unProjCustomCoord(target);\n    }\n    float total_Distance = pixelDistance(s, t) / 2.0 * PI;\n    total_Distance = total_Distance*16.0; // total_Distance*16.0 调整默认的效果\n    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / total_Distance;\n  }\n\n  if(u_animate.x == Animate) {\n      v_distance_ratio = segmentIndex / segmentNumber;\n  }\n\n  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);\n  v_distance_ratio = segmentIndex / segmentNumber;\n  vec4 curr = project_position(vec4(degrees(interpolate(source, target, angularDist, segmentRatio)), 0.0, 1.0));\n  vec4 next = project_position(vec4(degrees(interpolate(source, target, angularDist, nextSegmentRatio)), 0.0, 1.0));\n  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);\n  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));\n  //  vec4 project_pos = project_position(vec4(curr.xy, 0, 1.0));\n  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, curr.z, 1.0));\n\n  styleMappingMat[3].g = a_Position.x; // 该顶点在弧线上的分段排序\n  if(LineTexture == u_line_texture) { // 开启贴图模式  \n    // float mapZoomScale = u_CoordinateSystem !== COORDINATE_SYSTEM_P20_2?10000000.0:1.0;\n    float d_arcDistrance = length(source - target);\n    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20) { // amap\n      d_arcDistrance = d_arcDistrance * 1000000.0;\n    }\n    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) { // mapbox\n      d_arcDistrance = project_pixel_allmap(d_arcDistrance);\n    }\n    float d_pixelLen = project_pixel(u_icon_step)/8.0;\n    styleMappingMat[3].b = floor(d_arcDistrance/d_pixelLen); // 贴图在弧线上重复的数量\n\n    float lineOffsetWidth = length(offset + offset * sign(a_Position.y)); // 线横向偏移的距离\n    float linePixelSize = project_pixel(a_Size);  // 定点位置偏移，按地图等级缩放后的距离\n    styleMappingMat[3].a = lineOffsetWidth/linePixelSize;  // 线图层贴图部分的 v 坐标值\n\n    v_iconMapUV = a_iconMapUV;\n  }\n\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n    gl_Position = u_Mvp * (vec4(curr.xy + offset, curr.z, 1.0));\n  } else {\n    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, curr.z, 1.0));\n  }\n  setPickingColor(a_PickingColor);\n}\n\n',fragmentShader:'#define LineTypeSolid 0.0\n#define LineTypeDash 1.0\n#define Animate 0.0\n#define LineTexture 1.0\n\nuniform float u_opacity;\nuniform float u_textureBlend;\nuniform float u_blur : 0.9;\nuniform float u_line_type: 0.0;\n// varying vec2 v_normal;\nvarying vec4 v_dash_array;\nvarying float v_distance_ratio;\nvarying vec4 v_color;\n\nuniform float u_time;\nuniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];\n\nuniform float u_line_texture: 0.0;\nuniform sampler2D u_texture;\nuniform vec2 u_textSize;\nuniform float segmentNumber;\n\nvarying vec2 v_iconMapUV;\n\nuniform float u_linearColor: 0;\nuniform vec4 u_sourceColor;\nuniform vec4 u_targetColor;\n\nvarying mat4 styleMappingMat;\n\n#pragma include "picking"\n#pragma include "project"\n#pragma include "projection"\n\nvoid main() {\n  float opacity = styleMappingMat[0][0];\n  float animateSpeed = 0.0;\n  float d_segmentIndex = styleMappingMat[3].g;\n  \n  // 设置弧线的底色\n  if(u_linearColor == 1.0) { // 使用渐变颜色\n    gl_FragColor = mix(u_sourceColor, u_targetColor, d_segmentIndex/segmentNumber);\n  } else { // 使用 color 方法传入的颜色\n     gl_FragColor = v_color;\n  }\n\n  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));\n  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));\n  gl_FragColor.a *= opacity;\n  if(u_line_type == LineTypeDash) {\n    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);\n    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {\n      // 实线部分\n    } else {\n      // 虚线部分\n      discard;\n    };\n  }\n\n  // 设置弧线的动画模式\n  if(u_animate.x == Animate) {\n      animateSpeed = u_time / u_animate.y;\n      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);\n      alpha = (alpha + u_animate.w -1.0) / u_animate.w;\n      alpha = smoothstep(0., 1., alpha);\n      gl_FragColor.a *= alpha;\n  }\n\n  // 设置弧线的贴图\n  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { \n    float arcRadio = smoothstep( 0.0, 1.0, (d_segmentIndex / (segmentNumber - 1.0)));\n    // float arcRadio = d_segmentIndex / (segmentNumber - 1.0);\n    float count = styleMappingMat[3].b; // 贴图在弧线上重复的数量\n    float u = fract(arcRadio * count - animateSpeed * count);\n    // float u = fract(arcRadio * count - animateSpeed);\n    if(u_animate.x == Animate) {\n      u = gl_FragColor.a/opacity;\n    }\n\n    float v = styleMappingMat[3].a; // 线图层贴图部分的 v 坐标值\n\n    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;\n    vec4 pattern = texture2D(u_texture, uv);\n    \n    // 设置贴图和底色的叠加模式\n    if(u_textureBlend == 0.0) { // normal\n      pattern.a = 0.0;\n      gl_FragColor = filterColor(gl_FragColor + pattern);\n    } else { // replace\n        pattern.a *= opacity;\n        if(gl_FragColor.a <= 0.0) {\n          pattern.a = 0.0;\n        }\n        gl_FragColor = filterColor(pattern);\n    }\n  } else {\n    gl_FragColor = filterColor(gl_FragColor);\n  }\n\n  // gl_FragColor = filterColor(gl_FragColor);\n}',triangulation:Xet,depth:{enable:!1},blend:this.getBlend(),stencil:PK(r,o)});case 3:return a=t.sent,t.abrupt("return",[a]);case 5:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"registerBuiltinAttributes",value:function(){var t=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:d8.Attribute,descriptor:{name:"a_Size",buffer:{usage:m4.DYNAMIC_DRAW,data:[],type:m4.FLOAT},size:1,update:function(t){var e=t.size,n=void 0===e?1:e;return Array.isArray(n)?[n[0]]:[n]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:d8.Attribute,descriptor:{name:"a_Instance",buffer:{usage:m4.STATIC_DRAW,data:[],type:m4.FLOAT},size:4,update:function(t,e,n){return[n[3],n[4],n[5],n[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:d8.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:m4.DYNAMIC_DRAW,data:[],type:m4.FLOAT},size:2,update:function(e){var n=t.iconService.getIconMap()[e.texture]||{x:0,y:0};return[n.x,n.y]}}})}}]),i}();function hnt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var fnt=function(t){wZ(i,oet);var e,n,r=hnt(i);function i(){return mZ(this,i),r.apply(this,arguments)}return gZ(i,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),e=t.opacity,n=void 0===e?1:e,r=t.sourceColor,i=t.targetColor,o=t.arrow,a=void 0===o?{enable:!1,arrowWidth:2,arrowHeight:3,tailWidth:1}:o,s=0,u=[0,0,0,0],c=[0,0,0,0];if(r&&i&&(u=EK(r),c=EK(i),s=1),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:n})){this.judgeStyleAttributes({opacity:n});var l=this.layer.getEncodedData(),h=this.calDataFrame(this.cellLength,l,this.cellProperties),f=h.data,p=h.width,d=h.height;this.rowCount=d,this.dataTexture=this.cellLength>0&&f.length>0?this.createTexture2D({flipY:!0,data:f,format:m4.LUMINANCE,type:m4.FLOAT,width:p,height:d}):this.createTexture2D({flipY:!0,data:[1],format:m4.LUMINANCE,type:m4.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:hZ.isNumber(n)?n:1,u_linearColor:s,u_sourceColor:u,u_targetColor:c,u_arrow:Number(a.enable),u_arrowHeight:a.arrowHeight||3,u_arrowWidth:a.arrowWidth||2,u_tailWidth:void 0===a.tailWidth?1:a.tailWidth}}},{key:"initModels",value:(n=RK(jK.mark((function t(){return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.buildModels();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"clearModels",value:function(){var t;null===(t=this.dataTexture)||void 0===t||t.destroy()}},{key:"buildModels",value:(e=RK(jK.mark((function t(){var e,n,r,i,o,a,s,u,c,l,h;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.layer.getLayerConfig(),n=e.mask,r=void 0!==n&&n,i=e.maskInside,o=void 0===i||i,a=e.depth,s=void 0!==a&&a,u=this.getShaders(),c=u.frag,l=u.vert,this.layer.triangulation=jet,t.next=5,this.layer.buildLayerModel({moduleName:"lineHalf",vertexShader:l,fragmentShader:c,triangulation:jet,depth:{enable:s},blend:this.getBlend(),stencil:PK(r,o)});case 5:return h=t.sent,t.abrupt("return",[h]);case 7:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"getShaders",value:function(){return{frag:'#define COORDINATE_SYSTEM_LNGLAT 1.0        // mapbox\n#define COORDINATE_SYSTEM_LNGLAT_OFFSET 2.0 // mapbox offset\n#define COORDINATE_SYSTEM_VECTOR_TILE 3.0\n#define COORDINATE_SYSTEM_IDENTITY 4.0\n#define COORDINATE_SYSTEM_P20 5.0           // amap\n#define COORDINATE_SYSTEM_P20_OFFSET 6.0    // amap offset\n#define COORDINATE_SYSTEM_METER_OFFSET 7.0\n\n#define COORDINATE_SYSTEM_P20_2 8.0         // amap2.0\nuniform float u_CoordinateSystem;\nvarying vec4 v_color;\nuniform float u_arrow: 0.0;\nuniform float u_linearColor: 0;\nuniform vec4 u_sourceColor;\nuniform vec4 u_targetColor;\n\n#pragma include "picking"\n\nvarying mat4 styleMappingMat;\nvoid main() {\n  float distanceAndIndex = styleMappingMat[0][3];\n  float miter = styleMappingMat[0][2];\n\n  float opacity = styleMappingMat[0][0];\n  float d_distance_ratio = styleMappingMat[3].r; // 当前点位距离占线总长的比例\n\n\n  if(u_arrow > 0.0 && distanceAndIndex < 2.0) { // arrow\n    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) { \n      if(cross(vec3(styleMappingMat[1].rg, 0.0), vec3(styleMappingMat[1].ba, 0.0)).z < 0.0) { // amap\n        discard;\n      }\n    } else { // amap2 mapbox map\n      if(cross(vec3(styleMappingMat[1].rg, 0.0), vec3(styleMappingMat[1].ba, 0.0)).z > 0.0) { \n        discard;\n      }\n    }\n  } else { // line body\n    if(miter < 0.0) {\n      discard;\n    }\n  }\n\n\n  if(u_linearColor == 1.0) { // 使用渐变颜色\n    gl_FragColor = mix(u_sourceColor, u_targetColor, d_distance_ratio);\n  } else { // 使用 color 方法传入的颜色\n    gl_FragColor = v_color;\n  }\n\n  gl_FragColor.a *= opacity; // 全局透明度\n  gl_FragColor = filterColor(gl_FragColor);\n}\n',vert:'attribute float a_Miter;\nattribute vec4 a_Color;\nattribute vec2 a_Size;\nattribute vec3 a_Normal;\nattribute vec3 a_Position;\n\n// dash line\nattribute vec4 a_dirPoints;\nattribute vec3 a_DistanceAndIndex;\n\nuniform vec4 u_lineDir;\n\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\n\n#pragma include "projection"\n#pragma include "picking"\n\nvarying vec4 v_color;\n\nuniform float u_linearColor: 0;\nuniform float u_arrow: 0.0;\nuniform float u_arrowHeight: 3.0;\nuniform float u_arrowWidth: 2.0;\nuniform float u_tailWidth: 1.0;\n\nuniform float u_opacity: 1.0;\nvarying mat4 styleMappingMat; // 用于将在顶点着色器中计算好的样式值传递给片元\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n\nvec2 calculateArrow(vec2 offset) {\n  /*\n  * 在支持箭头的时候，第二、第三组顶点是额外插入用于构建顶点的\n  */\n  float arrowFlag = -1.0;\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {\n    // 高德 2.0 的旋转角度不同\n    arrowFlag = 1.0;\n  }\n  float pi = arrowFlag * 3.1415926/2.;\n  if(a_Miter < 0.) {\n    // 根据线的两侧偏移不同、旋转的方向相反\n    pi = -pi;\n  }\n  highp float angle_sin = sin(pi);\n  highp float angle_cos = cos(pi);\n  // 计算垂直与线方向的旋转矩阵\n  mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);\n  float arrowWidth = u_arrowWidth;\n  float arrowHeight = u_arrowHeight;\n\n  vec2 arrowOffset = vec2(0.0);\n  /*\n  * a_DistanceAndIndex.y 用于标记当前顶点属于哪一组（两个顶点一组，构成线的其实是矩形，最简需要四个顶点、两组顶点构成）\n  */\n  if(a_DistanceAndIndex.y == 0.0) {\n    // 箭头尖部\n    offset = vec2(0.0);\n  } else if(a_DistanceAndIndex.y == 1.0) {\n    // 箭头两侧\n    arrowOffset = rotation_matrix*(offset * arrowHeight);\n    offset += arrowOffset; // 沿线偏移\n    offset = offset * arrowWidth; // 垂直线向外偏移（是构建箭头两侧的顶点）\n  } else if(a_DistanceAndIndex.y == 2.0 || a_DistanceAndIndex.y == 3.0 || a_DistanceAndIndex.y == 4.0) {\n    // 偏移其余的点位（将长度让位给箭头）\n    arrowOffset = rotation_matrix*(offset * arrowHeight) * arrowWidth;\n    offset += arrowOffset;// 沿线偏移\n  }\n\n  return offset;\n}\n\nvoid main() {\n  // cal style mapping - 数据纹理映射部分的计算\n  styleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - a_Miter - a_DistanceAndIndex\n    0.0, 0.0, 0.0, 0.0, // originX - originY - vectorX - vectorY\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0  // distance_ratio/distance/pixelLen/texV\n  );\n  styleMappingMat[0][3] = a_DistanceAndIndex.y;\n  styleMappingMat[0][2] = a_Miter;\n\n  float rowCount = u_cellTypeLayout[0][0];    // 当前的数据纹理有几行\n  float columnCount = u_cellTypeLayout[0][1]; // 当看到数据纹理有几列\n  float columnWidth = 1.0/columnCount;  // 列宽\n  float rowHeight = 1.0/rowCount;       // 行高\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // 第n个顶点\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // 起始点在第几行\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // 起始点在第几列\n  \n  // cell 固定顺序 opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // 按顺序从 cell 中取值、若没有则自动往下取值\n  float textureOffset = 0.0; // 在 cell 中取值的偏移量\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n  // cal style mapping - 数据纹理映射部分的计算\n\n\n  v_color = a_Color;\n\n  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);\n  \n  vec2 offset = project_pixel(size.xy);\n\n  // styleMappingMat[1].rg = a_Position.xy + offset;\n\n  vec2 copyOffset = vec2(offset.x, offset.y);\n\n  float lineDistance = a_DistanceAndIndex.x;\n  float total_Distance = a_DistanceAndIndex.z;\n  float currentLinePointRatio = lineDistance / total_Distance;\n \n  if(u_arrow > 0.0) {\n      //  计算箭头\n    offset = calculateArrow(offset);\n\n    if(a_DistanceAndIndex.y > 4.0) {\n      offset *= mix(1.0, u_tailWidth, currentLinePointRatio);\n    }\n  }\n\n  float lineOffsetWidth = length(offset + offset * sign(a_Miter)); // 线横向偏移的距离（向两侧偏移的和）\n  float linePixelSize = project_pixel(a_Size.x) * 2.0;  // 定点位置偏移，按地图等级缩放后的距离 单侧 * 2\n\n  // 设置数据集的参数\n  styleMappingMat[3][0] = currentLinePointRatio; // 当前点位距离占线总长的比例\n  styleMappingMat[3][1] = lineDistance;       // 当前顶点的距离\n\n  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));\n\n  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));\n\n  float h = float(a_Position.z); // 线顶点的高度 - 兼容不存在第三个数值的情况 vertex height\n  float lineHeight = a_Size.y; // size 第二个参数代表的高度 [linewidth, lineheight]\n\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n    lineHeight *= 0.2; // 保持和 amap/mapbox 一致的效果\n    gl_Position = u_Mvp * (vec4(project_pos.xy + offset, lineHeight, 1.0));\n  } else {\n    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, lineHeight, 1.0));\n  }\n  \n  if(u_arrow > 0.0 && a_DistanceAndIndex.y < 2.0) {\n    vec2 startPoint = a_dirPoints.rg;\n    vec2 endPoint = a_dirPoints.ba;\n    vec4 t1 = project_position(vec4(startPoint, 0, 1.0));\n    vec4 t2 = project_position(vec4(endPoint, 0, 1.0));\n    // TODO： 后续优化可以把位置计算放在 cpu 中完成\n    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n      vec2 p1 = (u_Mvp * vec4(t1.xy, 0.0, 1.0)).xy;\n      vec2 p2 = (u_Mvp * vec4(t2.xy, 0.0, 1.0)).xy;\n      styleMappingMat[1].rg = normalize(p1 - p2);\n      styleMappingMat[1].ba = normalize(gl_Position.xy - p2);\n    } else {\n      vec2 p1 = project_common_position_to_clipspace(vec4(t1.xy, 0.0, 1.0)).xy;\n      vec2 p2 = project_common_position_to_clipspace(vec4(t2.xy, 0.0, 1.0)).xy;\n      styleMappingMat[1].rg = normalize(p1 - p2);\n      styleMappingMat[1].ba = normalize(gl_Position.xy - p2);\n    }\n  }\n\n  setPickingColor(a_PickingColor);\n}\n',type:"normal"}}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"distanceAndIndex",type:d8.Attribute,descriptor:{name:"a_DistanceAndIndex",buffer:{usage:m4.STATIC_DRAW,data:[],type:m4.FLOAT},size:3,update:function(t,e,n,r,i,o){return void 0===o?[n[3],10,n[5]]:[n[3],o,n[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"dirPoints",type:d8.Attribute,descriptor:{name:"a_dirPoints",buffer:{usage:m4.STATIC_DRAW,data:[],type:m4.FLOAT},size:4,update:function(t){var e=t.coordinates[0]||[0,0],n=t.coordinates[3]||[0,0];return[e[0],e[1],n[0],n[1]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:d8.Attribute,descriptor:{name:"a_Size",buffer:{usage:m4.DYNAMIC_DRAW,data:[],type:m4.FLOAT},size:2,update:function(t){var e=t.size,n=void 0===e?1:e;return Array.isArray(n)?[n[0],n[1]]:[n,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:d8.Attribute,descriptor:{name:"a_Normal",buffer:{usage:m4.STATIC_DRAW,data:[],type:m4.FLOAT},size:3,update:function(t,e,n,r,i){return i}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:d8.Attribute,descriptor:{name:"a_Miter",buffer:{usage:m4.STATIC_DRAW,data:[],type:m4.FLOAT},size:1,update:function(t,e,n){return[n[4]]}}})}}]),i}();function pnt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var dnt='\n#define Animate 0.0\n\nattribute float a_Miter;\nattribute vec4 a_Color;\nattribute vec2 a_Size;\nattribute vec3 a_Normal;\nattribute vec3 a_Position;\n\nattribute vec2 a_iconMapUV;\n\n// dash line\nattribute float a_Total_Distance;\nattribute vec2 a_DistanceAndIndex;\n\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\nuniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];\nuniform float u_icon_step: 100;\n\nuniform float u_heightfixed: 0.0;\nuniform float u_vertexScale: 1.0;\nuniform float u_raisingHeight: 0.0;\n\n#pragma include "projection"\n#pragma include "picking"\n\nvarying vec4 v_color;\n\n// texV 线图层 - 贴图部分的 v 坐标（线的宽度方向）\nvarying vec2 v_iconMapUV;\n\n\nuniform float u_linearColor: 0;\nuniform float u_arrow: 0.0;\nuniform float u_arrowHeight: 3.0;\nuniform float u_arrowWidth: 2.0;\nuniform float u_tailWidth: 1.0;\n\nuniform float u_opacity: 1.0;\nvarying mat4 styleMappingMat; // 用于将在顶点着色器中计算好的样式值传递给片元\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n\nvec2 calculateArrow(vec2 offset) {\n  /*\n  * 在支持箭头的时候，第二、第三组顶点是额外插入用于构建顶点的\n  */\n  float arrowFlag = -1.0;\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {\n    // 高德 2.0 的旋转角度不同\n    arrowFlag = 1.0;\n  }\n  float pi = arrowFlag * 3.1415926/2.;\n  if(a_Miter < 0.) {\n    // 根据线的两侧偏移不同、旋转的方向相反\n    pi = -pi;\n  }\n  highp float angle_sin = sin(pi);\n  highp float angle_cos = cos(pi);\n  // 计算垂直与线方向的旋转矩阵\n  mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);\n  float arrowWidth = u_arrowWidth;\n  float arrowHeight = u_arrowHeight;\n\n  vec2 arrowOffset = vec2(0.0);\n  /*\n  * a_DistanceAndIndex.y 用于标记当前顶点属于哪一组（两个顶点一组，构成线的其实是矩形，最简需要四个顶点、两组顶点构成）\n  */\n  if(a_DistanceAndIndex.y == 0.0) {\n    // 箭头尖部\n    offset = vec2(0.0);\n  } else if(a_DistanceAndIndex.y == 1.0) {\n    // 箭头两侧\n    arrowOffset = rotation_matrix*(offset * arrowHeight);\n    offset += arrowOffset; // 沿线偏移\n    offset = offset * arrowWidth; // 垂直线向外偏移（是构建箭头两侧的顶点）\n  } else if(a_DistanceAndIndex.y == 2.0 || a_DistanceAndIndex.y == 3.0 || a_DistanceAndIndex.y == 4.0) {\n    // 偏移其余的点位（将长度让位给箭头）\n    arrowOffset = rotation_matrix*(offset * arrowHeight) * arrowWidth;\n    offset += arrowOffset;// 沿线偏移\n  }\n\n  return offset;\n}\n\nvoid main() {\n  // cal style mapping - 数据纹理映射部分的计算\n  styleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0  // distance_ratio/distance/pixelLen/texV\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // 当前的数据纹理有几行\n  float columnCount = u_cellTypeLayout[0][1]; // 当看到数据纹理有几列\n  float columnWidth = 1.0/columnCount;  // 列宽\n  float rowHeight = 1.0/rowCount;       // 行高\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // 第n个顶点\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // 起始点在第几行\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // 起始点在第几列\n  \n  // cell 固定顺序 opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // 按顺序从 cell 中取值、若没有则自动往下取值\n  float textureOffset = 0.0; // 在 cell 中取值的偏移量\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n  // cal style mapping - 数据纹理映射部分的计算\n\n  float d_texPixelLen;    // 贴图的像素长度，根据地图层级缩放\n\n  v_iconMapUV = a_iconMapUV;\n  d_texPixelLen = project_float_pixel(u_icon_step);\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {\n    d_texPixelLen *= 10.0;\n  }\n\n  v_color = a_Color;\n\n  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);\n  \n  vec2 offset = project_pixel(size.xy);\n\n  float lineDistance = a_DistanceAndIndex.x;\n  float currentLinePointRatio = lineDistance / a_Total_Distance;\n \n  if(u_arrow > 0.0) {\n      //  计算箭头\n    offset = calculateArrow(offset);\n\n    if(a_DistanceAndIndex.y > 4.0) {\n      offset *= mix(1.0, u_tailWidth, currentLinePointRatio);\n    }\n  }\n\n  float lineOffsetWidth = length(offset + offset * sign(a_Miter)); // 线横向偏移的距离（向两侧偏移的和）\n  float linePixelSize = project_pixel(a_Size.x) * 2.0;  // 定点位置偏移，按地图等级缩放后的距离 单侧 * 2\n  float texV = lineOffsetWidth/linePixelSize; // 线图层贴图部分的 v 坐标值\n\n  // 设置数据集的参数\n  styleMappingMat[3][0] = currentLinePointRatio; // 当前点位距离占线总长的比例\n  styleMappingMat[3][1] = lineDistance;       // 当前顶点的距离\n  styleMappingMat[3][2] = d_texPixelLen;    // 贴图的像素长度，根据地图层级缩放\n  styleMappingMat[3][3] = texV;             // 线图层贴图部分的 v 坐标值\n\n  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));\n\n  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));\n\n  float h = float(a_Position.z) * u_vertexScale; // 线顶点的高度 - 兼容不存在第三个数值的情况 vertex height\n  float lineHeight = a_Size.y; // size 第二个参数代表的高度 [linewidth, lineheight]\n\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n    lineHeight *= 0.2; // 保持和 amap/mapbox 一致的效果\n    h *= 0.2;\n    if(u_heightfixed < 1.0) {\n      lineHeight = project_pixel(a_Size.y);\n    }\n    gl_Position = u_Mvp * (vec4(project_pos.xy + offset, lineHeight + h + u_raisingHeight, 1.0));\n  } else {\n    // mapbox -  amap\n    \n    // 兼容 mapbox 在线高度上的效果表现基本一致\n    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {\n      // mapbox\n      // 保持高度相对不变\n      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);\n      h *= mapboxZoomScale;\n      h += u_raisingHeight * mapboxZoomScale;\n      if(u_heightfixed > 0.0) {\n        lineHeight *= mapboxZoomScale;\n      }\n      \n    } else {\n      // amap\n      h += u_raisingHeight;\n      // lineHeight 顶点偏移高度\n      if(u_heightfixed < 1.0) {\n        lineHeight *= pow(2.0, 20.0 - u_Zoom);\n      }\n    }\n\n    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, lineHeight + h, 1.0));\n  }\n\n  setPickingColor(a_PickingColor);\n}\n',mnt={solid:0,dash:1},vnt=function(t){wZ(i,oet);var e,n,r=pnt(i);function i(){var t;mZ(this,i);for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return $q(SZ(t=r.call.apply(r,[this].concat(n))),"texture",t.createTexture2D({data:[0,0,0,0],mag:m4.NEAREST,min:m4.NEAREST,premultiplyAlpha:!1,width:1,height:1})),$q(SZ(t),"updateTexture",(function(){var e=t.rendererService.createTexture2D;if(t.texture)return t.texture.update({data:t.iconService.getCanvas()}),void t.layer.render();t.texture=e({data:t.iconService.getCanvas(),mag:m4.NEAREST,min:m4.NEAREST,premultiplyAlpha:!1,width:1024,height:t.iconService.canvasHeight||128})})),t}return gZ(i,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),e=t.opacity,n=void 0===e?1:e,r=t.sourceColor,i=t.targetColor,o=t.textureBlend,a=void 0===o?"normal":o,s=t.lineType,u=void 0===s?"solid":s,c=t.dashArray,l=void 0===c?[10,5,0,0]:c,h=t.lineTexture,f=void 0!==h&&h,p=t.iconStep,d=void 0===p?100:p,m=t.vertexHeightScale,v=void 0===m?20:m,g=t.borderWidth,y=void 0===g?0:g,x=t.borderColor,b=void 0===x?"#ccc":x,_=t.raisingHeight,w=void 0===_?0:_,S=t.heightfixed,M=void 0!==S&&S,E=t.linearDir,A=void 0===E?Ktt.VERTICAL:E,T=t.blur,C=void 0===T?[1,1,1]:T,O=t.arrow,k=void 0===O?{enable:!1,arrowWidth:2,arrowHeight:3,tailWidth:1}:O;2===l.length&&l.push(0,0),this.rendererService.getDirty()&&this.texture&&this.texture.bind();var P=0,L=[0,0,0,0],R=[0,0,0,0];if(r&&i&&(L=EK(r),R=EK(i),P=1),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:n})){this.judgeStyleAttributes({opacity:n});var I=this.layer.getEncodedData(),N=this.calDataFrame(this.cellLength,I,this.cellProperties),D=N.data,F=N.width,j=N.height;this.rowCount=j,this.dataTexture=this.cellLength>0&&D.length>0?this.createTexture2D({flipY:!0,data:D,format:m4.LUMINANCE,type:m4.FLOAT,width:F,height:j}):this.createTexture2D({flipY:!0,data:[1],format:m4.LUMINANCE,type:m4.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:hZ.isNumber(n)?n:1,u_textureBlend:a===Qtt.NORMAL?0:1,u_line_type:mnt[u],u_dash_array:l,u_blur:C,u_texture:this.texture,u_line_texture:f?1:0,u_icon_step:d,u_textSize:[1024,this.iconService.canvasHeight||128],u_borderWidth:y,u_borderColor:EK(b),u_linearDir:A===Ktt.VERTICAL?1:0,u_linearColor:P,u_sourceColor:L,u_targetColor:R,u_heightfixed:Number(M),u_vertexScale:v,u_raisingHeight:Number(w),u_arrow:Number(k.enable),u_arrowHeight:k.arrowHeight||3,u_arrowWidth:k.arrowWidth||2,u_tailWidth:void 0===k.tailWidth?1:k.tailWidth}}},{key:"getAnimateUniforms",value:function(){var t=this.layer.getLayerConfig().animateOption;return{u_animate:this.animateOption2Array(t),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:(n=RK(jK.mark((function t(){return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.buildModels();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"clearModels",value:function(){var t,e;null===(t=this.texture)||void 0===t||t.destroy(),null===(e=this.dataTexture)||void 0===e||e.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:(e=RK(jK.mark((function t(){var e,n,r,i,o,a,s,u,c,l,h,f,p,d,m;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.layer.getLayerConfig(),n=e.mask,r=void 0!==n&&n,i=e.maskInside,o=void 0===i||i,a=e.depth,s=void 0!==a&&a,u=e.workerEnabled,c=void 0!==u&&u,l=e.enablePicking,h=this.getShaders(),f=h.frag,p=h.vert,d=h.type,this.layer.triangulation=tQ,t.next=5,this.layer.buildLayerModel({moduleName:"line"+d,vertexShader:p,fragmentShader:f,triangulation:tQ,depth:{enable:s},blend:this.getBlend(),stencil:PK(r,o),workerEnabled:c,workerOptions:{modelType:"line"+d,enablePicking:l,iconMap:this.iconService.getIconMap()}});case 5:return m=t.sent,t.abrupt("return",[m]);case 7:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"getShaders",value:function(){var t=this.layer.getLayerConfig(),e=t.sourceColor,n=t.targetColor;return"dash"===t.lineType?{frag:'#define LineTypeSolid 0.0\nuniform float u_opacity : 1.0;\n\nvarying vec4 v_color;\n\n// dash\nvarying vec4 v_dash_array;\n\n#pragma include "picking"\n\nuniform float u_time;\nuniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ]; // 控制运动\n\nvarying mat4 styleMappingMat;\n// [animate, duration, interval, trailLength],\nvoid main() {\n  float opacity = styleMappingMat[0][0];\n  float d_distance_ratio = styleMappingMat[3].r; // 当前点位距离占线总长的比例\n  gl_FragColor = v_color;\n  gl_FragColor.a *= opacity; // 全局透明度\n \n  float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);\n  if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {\n    // 实线部分\n  } else {\n    // 虚线部分\n    discard;\n  };\n\n  gl_FragColor = filterColor(gl_FragColor);\n}\n',vert:'#define LineTypeSolid 0.0\n#define LineTypeDash 1.0\n#define Animate 0.0\n\nattribute float a_Miter;\nattribute vec4 a_Color;\nattribute vec2 a_Size;\nattribute vec3 a_Normal;\nattribute vec3 a_Position;\n\nattribute vec2 a_iconMapUV;\n\n// dash line\nattribute float a_Total_Distance;\nattribute vec2 a_DistanceAndIndex;\n\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\nuniform vec4 u_dash_array: [10.0, 5., 0, 0];\n\nuniform float u_vertexScale: 1.0;\n\n#pragma include "projection"\n#pragma include "picking"\n\nvarying vec4 v_color;\nvarying vec4 v_dash_array;\n\nuniform float u_opacity: 1.0;\nvarying mat4 styleMappingMat; // 用于将在顶点着色器中计算好的样式值传递给片元\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n\nvoid main() {\n  // cal style mapping - 数据纹理映射部分的计算\n  styleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0  // distance_ratio/distance/pixelLen/texV\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // 当前的数据纹理有几行\n  float columnCount = u_cellTypeLayout[0][1]; // 当看到数据纹理有几列\n  float columnWidth = 1.0/columnCount;  // 列宽\n  float rowHeight = 1.0/rowCount;       // 行高\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // 第n个顶点\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // 起始点在第几行\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // 起始点在第几列\n  \n  // cell 固定顺序 opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // 按顺序从 cell 中取值、若没有则自动往下取值\n  float textureOffset = 0.0; // 在 cell 中取值的偏移量\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n  // cal style mapping - 数据纹理映射部分的计算\n\n  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / a_Total_Distance;\n  v_color = a_Color;\n\n  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);\n  vec2 offset = project_pixel(size.xy);\n\n  // 设置数据集的参数\n  styleMappingMat[3][0] = a_DistanceAndIndex.x / a_Total_Distance; // 当前点位距离占线总长的比例\n  styleMappingMat[3][1] = a_DistanceAndIndex.x;       // 当前顶点的距离\n\n  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));\n\n  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));\n\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n    gl_Position = u_Mvp * (vec4(project_pos.xy + offset, project_pixel(a_Size.y), 1.0));\n  } else {\n    float lineHeight = a_Size.y;\n \n    // #define COORDINATE_SYSTEM_P20 5.0\n    // #define COORDINATE_SYSTEM_P20_OFFSET 6.0\n    // amap1.x\n    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {\n      // 保持高度相对不变\n      lineHeight *= pow(2.0, 20.0 - u_Zoom);\n    }\n\n    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, lineHeight, 1.0));\n  }\n\n  setPickingColor(a_PickingColor);\n}\n',type:"Dash"}:e&&n?{frag:'varying vec4 v_color;\nuniform float u_linearDir: 1.0;\nuniform float u_linearColor: 0;\nuniform vec4 u_sourceColor;\nuniform vec4 u_targetColor;\n\n#pragma include "picking"\n\n\nvarying mat4 styleMappingMat;\n\nvoid main() {\n  float opacity = styleMappingMat[0][0];\n  float linearRadio = styleMappingMat[3][0]; // 当前点位距离占线总长的比例\n  if(u_linearDir < 1.0) {\n    linearRadio = styleMappingMat[3][3];\n  }\n\n  if(u_linearColor == 1.0) { // 使用渐变颜色\n    gl_FragColor = mix(u_sourceColor, u_targetColor, linearRadio);\n  } else { // 使用 color 方法传入的颜色\n     gl_FragColor = v_color;\n  }\n\n  gl_FragColor.a *= opacity; // 全局透明度\n  gl_FragColor = filterColor(gl_FragColor);\n}\n',vert:dnt,type:"Linear"}:{frag:'#define Animate 0.0\n#define LineTexture 1.0\nuniform float u_opacity : 1.0;\nuniform float u_textureBlend;\n\nuniform float u_borderWidth: 0.0;\n\nuniform vec3 u_blur;\nuniform vec4 u_borderColor;\nvarying vec4 v_color;\n\n// line texture\nuniform float u_line_texture;\nuniform sampler2D u_texture;\nuniform vec2 u_textSize;\n\nvarying vec2 v_iconMapUV;\n\n#pragma include "picking"\n\nuniform float u_time;\nuniform vec4 u_animate: [ 1, 2., 1.0, 0.2 ]; // 控制运动\n\nvarying mat4 styleMappingMat;\n// [animate, duration, interval, trailLength],\nvoid main() {\n  float opacity = styleMappingMat[0][0];\n  float animateSpeed = 0.0; // 运动速度\n  float d_distance_ratio = styleMappingMat[3].r; // 当前点位距离占线总长的比例\n  gl_FragColor = v_color;\n  // anti-alias\n  // float blur = 1.0 - smoothstep(u_blur, 1., length(v_normal.xy));\n  gl_FragColor.a *= opacity; // 全局透明度\n  if(u_animate.x == Animate) {\n      animateSpeed = u_time / u_animate.y;\n       float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + animateSpeed);\n      alpha = (alpha + u_animate.w -1.0) / u_animate.w;\n      alpha = smoothstep(0., 1., alpha);\n      gl_FragColor.a *= alpha;\n  }\n\n  if(u_line_texture == LineTexture) { // while load texture\n    float aDistance = styleMappingMat[3].g;      // 当前顶点的距离\n    float d_texPixelLen = styleMappingMat[3].b;  // 贴图的像素长度，根据地图层级缩放\n    float u = fract(mod(aDistance, d_texPixelLen)/d_texPixelLen - animateSpeed);\n    float v = styleMappingMat[3].a;  // 线图层贴图部分的 v 坐标值\n\n    // v = max(smoothstep(0.95, 1.0, v), v);\n    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;\n    \n    // gl_FragColor = filterColor(gl_FragColor + texture2D(u_texture, vec2(u, v)));\n    // gl_FragColor = filterColor(gl_FragColor + texture2D(u_texture, uv));\n     vec4 pattern = texture2D(u_texture, uv);\n\n    if(u_textureBlend == 0.0) { // normal\n      pattern.a = 0.0;\n      gl_FragColor += pattern;\n    } else { // replace\n        pattern.a *= opacity;\n        if(gl_FragColor.a <= 0.0) {\n          pattern.a = 0.0;\n        }\n        gl_FragColor = pattern;\n    }\n  } \n\n  float v = styleMappingMat[3].a;\n  float borderWidth = min(0.5, u_borderWidth);\n  // 绘制 border\n  if(borderWidth > 0.01) {\n    float borderOuterWidth = borderWidth/2.0;\n\n    if(v >= 1.0 - borderWidth || v <= borderWidth) {\n      if(v > borderWidth) {\n        float linear = smoothstep(0.0, 1.0, (v - (1.0 - borderWidth))/borderWidth);\n        gl_FragColor.rgb = mix(gl_FragColor.rgb, u_borderColor.rgb, linear);\n      } else if(v <= borderWidth) {\n        float linear = smoothstep(0.0, 1.0, v/borderWidth);\n        gl_FragColor.rgb = mix(u_borderColor.rgb, gl_FragColor.rgb, linear);\n      }\n    }\n\n    if(v < borderOuterWidth) {\n      gl_FragColor.a = mix(0.0, gl_FragColor.a, v/borderOuterWidth);\n    } else if(v > 1.0 - borderOuterWidth) {\n      gl_FragColor.a = mix(gl_FragColor.a, 0.0, (v - (1.0 - borderOuterWidth))/borderOuterWidth);\n    }\n  }\n\n  // blur\n  float blurV = styleMappingMat[3][3];\n  if(blurV < 0.5) {\n    gl_FragColor.a *= mix(u_blur.r, u_blur.g, blurV/0.5);\n  } else {\n    gl_FragColor.a *= mix(u_blur.g, u_blur.b, (blurV - 0.5)/0.5);\n  }\n  \n  gl_FragColor = filterColor(gl_FragColor);\n}\n',vert:dnt,type:""}}},{key:"registerBuiltinAttributes",value:function(){var t=this;this.styleAttributeService.registerStyleAttribute({name:"distanceAndIndex",type:d8.Attribute,descriptor:{name:"a_DistanceAndIndex",buffer:{usage:m4.STATIC_DRAW,data:[],type:m4.FLOAT},size:2,update:function(t,e,n,r,i,o){return void 0===o?[n[3],10]:[n[3],o]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:d8.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:m4.STATIC_DRAW,data:[],type:m4.FLOAT},size:1,update:function(t,e,n){return[n[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:d8.Attribute,descriptor:{name:"a_Size",buffer:{usage:m4.DYNAMIC_DRAW,data:[],type:m4.FLOAT},size:2,update:function(t){var e=t.size,n=void 0===e?1:e;return Array.isArray(n)?[n[0],n[1]]:[n,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:d8.Attribute,descriptor:{name:"a_Normal",buffer:{usage:m4.STATIC_DRAW,data:[],type:m4.FLOAT},size:3,update:function(t,e,n,r,i){return i}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:d8.Attribute,descriptor:{name:"a_Miter",buffer:{usage:m4.STATIC_DRAW,data:[],type:m4.FLOAT},size:1,update:function(t,e,n){return[n[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:d8.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:m4.DYNAMIC_DRAW,data:[],type:m4.FLOAT},size:2,update:function(e){var n=t.iconService.getIconMap()[e.texture]||{x:0,y:0};return[n.x,n.y]}}})}}]),i}();function gnt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var ynt=function(t){wZ(i,oet);var e,n,r=gnt(i);function i(){var t;mZ(this,i);for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return $q(SZ(t=r.call.apply(r,[this].concat(n))),"updateTexture",(function(){var e=t.rendererService.createTexture2D;t.colorTexture&&t.colorTexture.destroy();var n=CK(t.layer.getLayerConfig().rampColors);t.colorTexture=e({data:new Uint8Array(n.data),width:n.width,height:n.height,wrapS:m4.CLAMP_TO_EDGE,wrapT:m4.CLAMP_TO_EDGE,min:m4.NEAREST,mag:m4.NEAREST,flipY:!1})})),t}return gZ(i,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),e=t.opacity,n=void 0===e?1:e,r=t.vertexHeightScale,i=void 0===r?20:r,o=t.raisingHeight,a=void 0===o?0:o,s=t.heightfixed,u=void 0!==s&&s,c=t.linearDir,l=void 0===c?Ktt.VERTICAL:c;if(this.rendererService.getDirty()&&this.colorTexture.bind(),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:n})){this.judgeStyleAttributes({opacity:n});var h=this.layer.getEncodedData(),f=this.calDataFrame(this.cellLength,h,this.cellProperties),p=f.data,d=f.width,m=f.height;this.rowCount=m,this.dataTexture=this.cellLength>0&&p.length>0?this.createTexture2D({flipY:!0,data:p,format:m4.LUMINANCE,type:m4.FLOAT,width:d,height:m}):this.createTexture2D({flipY:!0,data:[1],format:m4.LUMINANCE,type:m4.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_linearDir:l===Ktt.VERTICAL?1:0,u_opacity:hZ.isNumber(n)?n:1,u_texture:this.colorTexture,u_heightfixed:Number(u),u_vertexScale:i,u_raisingHeight:Number(a)}}},{key:"initModels",value:(n=RK(jK.mark((function t(){return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.updateTexture(),t.next=3,this.buildModels();case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"clearModels",value:function(){var t,e;null===(t=this.colorTexture)||void 0===t||t.destroy(),null===(e=this.dataTexture)||void 0===e||e.destroy()}},{key:"buildModels",value:(e=RK(jK.mark((function t(){var e,n,r,i,o,a,s,u;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.layer.getLayerConfig(),n=e.mask,r=void 0!==n&&n,i=e.maskInside,o=void 0===i||i,a=e.depth,s=void 0!==a&&a,this.layer.triangulation=jet,t.next=4,this.layer.buildLayerModel({moduleName:"lineRampColors",vertexShader:'\nattribute float a_Miter;\nattribute vec2 a_Size;\nattribute vec3 a_Normal;\nattribute vec3 a_Position;\n\n// dash line\nattribute float a_Total_Distance;\nattribute vec2 a_DistanceAndIndex;\n\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\n\nuniform float u_heightfixed: 0.0;\nuniform float u_vertexScale: 1.0;\nuniform float u_raisingHeight: 0.0;\n\nuniform float u_opacity: 1.0;\n\n#pragma include "projection"\n#pragma include "picking"\n\nvarying mat4 styleMappingMat; // 用于将在顶点着色器中计算好的样式值传递给片元\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n\nvoid main() {\n  // cal style mapping - 数据纹理映射部分的计算\n  styleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0  // distance_ratio/distance/pixelLen/texV\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // 当前的数据纹理有几行\n  float columnCount = u_cellTypeLayout[0][1]; // 当看到数据纹理有几列\n  float columnWidth = 1.0/columnCount;  // 列宽\n  float rowHeight = 1.0/rowCount;       // 行高\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // 第n个顶点\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // 起始点在第几行\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // 起始点在第几列\n  \n  // cell 固定顺序 opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // 按顺序从 cell 中取值、若没有则自动往下取值\n  float textureOffset = 0.0; // 在 cell 中取值的偏移量\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n  // cal style mapping - 数据纹理映射部分的计算\n\n  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);\n  \n  vec2 offset = project_pixel(size.xy);\n\n  float lineDistance = a_DistanceAndIndex.x;\n  float currentLinePointRatio = lineDistance / a_Total_Distance;\n \n\n  float lineOffsetWidth = length(offset + offset * sign(a_Miter)); // 线横向偏移的距离（向两侧偏移的和）\n  float linePixelSize = project_pixel(a_Size.x) * 2.0;  // 定点位置偏移，按地图等级缩放后的距离 单侧 * 2\n  float texV = lineOffsetWidth/linePixelSize; // 线图层贴图部分的 v 坐标值\n\n  // 设置数据集的参数\n  styleMappingMat[3][0] = currentLinePointRatio; // 当前点位距离占线总长的比例\n  styleMappingMat[3][3] = texV;             // 线图层贴图部分的 v 坐标值\n\n  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));\n\n  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));\n\n  float h = float(a_Position.z) * u_vertexScale; // 线顶点的高度 - 兼容不存在第三个数值的情况 vertex height\n  float lineHeight = a_Size.y; // size 第二个参数代表的高度 [linewidth, lineheight]\n\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n    lineHeight *= 0.2; // 保持和 amap/mapbox 一致的效果\n    h *= 0.2;\n    if(u_heightfixed < 1.0) {\n      lineHeight = project_pixel(a_Size.y);\n    }\n    gl_Position = u_Mvp * (vec4(project_pos.xy + offset, lineHeight + h + u_raisingHeight, 1.0));\n  } else {\n    // mapbox -  amap\n    \n    // 兼容 mapbox 在线高度上的效果表现基本一致\n    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {\n      // mapbox\n      // 保持高度相对不变\n      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);\n      h *= mapboxZoomScale;\n      h += u_raisingHeight * mapboxZoomScale;\n      if(u_heightfixed > 0.0) {\n        lineHeight *= mapboxZoomScale;\n      }\n      \n    } else {\n      // amap\n      h += u_raisingHeight;\n      // lineHeight 顶点偏移高度\n      if(u_heightfixed < 1.0) {\n        lineHeight *= pow(2.0, 20.0 - u_Zoom);\n      }\n    }\n\n    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, lineHeight + h, 1.0));\n  }\n\n  setPickingColor(a_PickingColor);\n}\n',fragmentShader:'uniform float u_opacity : 1.0;\nuniform sampler2D u_texture;\nuniform float u_linearDir: 1.0;\n\n#pragma include "picking"\n\nvarying mat4 styleMappingMat;\n\nvoid main() {\n  float opacity = styleMappingMat[0][0];\n  float linearRadio = styleMappingMat[3].r; // 当前点位距离占线总长的比例\n  if(u_linearDir < 1.0) {\n    linearRadio = styleMappingMat[3][3];\n  }\n\n  gl_FragColor = texture2D(u_texture, vec2(linearRadio, 0.5));\n\n  gl_FragColor.a *= opacity; // 全局透明度\n  gl_FragColor = filterColor(gl_FragColor);\n}\n',triangulation:jet,depth:{enable:s},blend:this.getBlend(),stencil:PK(r,o)});case 4:return u=t.sent,t.abrupt("return",[u]);case 6:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"distanceAndIndex",type:d8.Attribute,descriptor:{name:"a_DistanceAndIndex",buffer:{usage:m4.STATIC_DRAW,data:[],type:m4.FLOAT},size:2,update:function(t,e,n,r,i,o){return void 0===o?[n[3],10]:[n[3],o]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:d8.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:m4.STATIC_DRAW,data:[],type:m4.FLOAT},size:1,update:function(t,e,n){return[n[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:d8.Attribute,descriptor:{name:"a_Size",buffer:{usage:m4.DYNAMIC_DRAW,data:[],type:m4.FLOAT},size:2,update:function(t){var e=t.size,n=void 0===e?1:e;return Array.isArray(n)?[n[0],n[1]]:[n,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:d8.Attribute,descriptor:{name:"a_Normal",buffer:{usage:m4.STATIC_DRAW,data:[],type:m4.FLOAT},size:3,update:function(t,e,n,r,i){return i}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:d8.Attribute,descriptor:{name:"a_Miter",buffer:{usage:m4.STATIC_DRAW,data:[],type:m4.FLOAT},size:1,update:function(t,e,n){return[n[4]]}}})}}]),i}();function xnt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var bnt='attribute vec4 a_Color;\nattribute vec2 a_Size;\nattribute vec3 a_Position;\n\nattribute float a_Total_Distance;\nattribute float a_Distance;\n\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\n\nuniform float u_opacity: 1.0;\nuniform float u_vertexScale: 1.0;\n\n#pragma include "projection"\n\nvarying vec4 v_color;\n\nvarying mat4 styleMappingMat; // 用于将在顶点着色器中计算好的样式值传递给片元\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n\nvoid main() {\n  // cal style mapping - 数据纹理映射部分的计算\n  styleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0  // distance_ratio/distance/pixelLen/texV\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // 当前的数据纹理有几行\n  float columnCount = u_cellTypeLayout[0][1]; // 当看到数据纹理有几列\n  float columnWidth = 1.0/columnCount;  // 列宽\n  float rowHeight = 1.0/rowCount;       // 行高\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // 第n个顶点\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // 起始点在第几行\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // 起始点在第几列\n  \n  // cell 固定顺序 opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // 按顺序从 cell 中取值、若没有则自动往下取值\n  float textureOffset = 0.0; // 在 cell 中取值的偏移量\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n  // cal style mapping - 数据纹理映射部分的计算\n\n  \n  v_color = a_Color; \n  styleMappingMat[3][0] = a_Distance / a_Total_Distance;\n\n  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));\n\n  float h = float(a_Position.z) * u_vertexScale; // 线顶点的高度 - 兼容不存在第三个数值的情况\n\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n    gl_Position = u_Mvp * (vec4(project_pos.xy, project_pixel(a_Size.y) + h * 0.2, 1.0));\n  } else {\n    float lineHeight = a_Size.y;\n    // 兼容 mapbox 在线高度上的效果表现基本一致\n    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {\n      // 保持高度相对不变\n      h *= 2.0/pow(2.0, 20.0 - u_Zoom);\n    }\n\n    // #define COORDINATE_SYSTEM_P20 5.0\n    // #define COORDINATE_SYSTEM_P20_OFFSET 6.0\n    // amap1.x\n    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {\n      // 保持高度相对不变\n      lineHeight *= pow(2.0, 20.0 - u_Zoom);\n    }\n\n    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, lineHeight + h, 1.0));\n    gl_PointSize = 10.0;\n  }\n}\n',_nt=function(t){wZ(i,oet);var e,n,r=xnt(i);function i(){return mZ(this,i),r.apply(this,arguments)}return gZ(i,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),e=t.opacity,n=void 0===e?1:e,r=t.sourceColor,i=t.targetColor,o=t.vertexHeightScale,a=void 0===o?20:o,s=0,u=[0,0,0,0],c=[0,0,0,0];if(r&&i&&(u=EK(r),c=EK(i),s=1),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:n})){this.judgeStyleAttributes({opacity:n});var l=this.layer.getEncodedData(),h=this.calDataFrame(this.cellLength,l,this.cellProperties),f=h.data,p=h.width,d=h.height;this.rowCount=d,this.dataTexture=this.cellLength>0&&f.length>0?this.createTexture2D({flipY:!0,data:f,format:m4.LUMINANCE,type:m4.FLOAT,width:p,height:d}):this.createTexture2D({flipY:!0,data:[1],format:m4.LUMINANCE,type:m4.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:hZ.isNumber(n)?n:1,u_linearColor:s,u_sourceColor:u,u_targetColor:c,u_vertexScale:a}}},{key:"initModels",value:(n=RK(jK.mark((function t(){return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.buildModels();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"clearModels",value:function(){var t;null===(t=this.dataTexture)||void 0===t||t.destroy()}},{key:"getShaders",value:function(){var t=this.layer.getLayerConfig(),e=t.sourceColor,n=t.targetColor;return e&&n?{frag:"uniform vec4 u_sourceColor;\nuniform vec4 u_targetColor;\n\nvarying mat4 styleMappingMat;\nvoid main() {\n  float opacity = styleMappingMat[0][0];\n\n  // styleMappingMat[3][0] 当前点位距离占线总长的比例\n  gl_FragColor = mix(u_sourceColor, u_targetColor, styleMappingMat[3][0]);\n  gl_FragColor.a *= opacity; // 全局透明度\n}\n",vert:bnt,type:"lineSimpleLinear"}:{frag:"\nvarying vec4 v_color;\nvarying mat4 styleMappingMat;\nvoid main() {\n  float opacity = styleMappingMat[0][0];\n  float d_distance_ratio = styleMappingMat[3].r; // 当前点位距离占线总长的比例\n\n  gl_FragColor = v_color;\n  gl_FragColor.a *= opacity; // 全局透明度\n}\n",vert:bnt,type:"lineSimpleNormal"}}},{key:"buildModels",value:(e=RK(jK.mark((function t(){var e,n,r,i,o,a,s,u,c,l;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.layer.getLayerConfig(),n=e.mask,r=void 0!==n&&n,i=e.maskInside,o=void 0===i||i,a=this.getShaders(),s=a.frag,u=a.vert,c=a.type,t.next=4,this.layer.buildLayerModel({moduleName:c,vertexShader:u,fragmentShader:s,triangulation:Bet,primitive:m4.LINES,depth:{enable:!1},blend:this.getBlend(),stencil:PK(r,o),pick:!1});case 4:return l=t.sent,t.abrupt("return",[l]);case 6:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"distance",type:d8.Attribute,descriptor:{name:"a_Distance",buffer:{usage:m4.STATIC_DRAW,data:[],type:m4.FLOAT},size:1,update:function(t,e,n){return[n[3]]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:d8.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:m4.STATIC_DRAW,data:[],type:m4.FLOAT},size:1,update:function(t,e,n){return[n[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:d8.Attribute,descriptor:{name:"a_Size",buffer:{usage:m4.DYNAMIC_DRAW,data:[],type:m4.FLOAT},size:2,update:function(t){var e=t.size,n=void 0===e?1:e;return Array.isArray(n)?[n[0],n[1]]:[n,0]}}})}}]),i}();function wnt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var Snt=function(t){wZ(i,oet);var e,n,r=wnt(i);function i(){var t;mZ(this,i);for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return $q(SZ(t=r.call.apply(r,[this].concat(n))),"updateTexture",(function(){var e=t.rendererService.createTexture2D;if(t.texture)return t.texture.update({data:t.iconService.getCanvas()}),void t.layer.render();t.texture=e({data:t.iconService.getCanvas(),mag:m4.NEAREST,min:m4.NEAREST,premultiplyAlpha:!1,width:1024,height:t.iconService.canvasHeight||128})})),t}return gZ(i,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),e=t.opacity,n=void 0===e?1:e,r=t.sourceColor,i=t.targetColor,o=t.textureBlend,a=void 0===o?"normal":o,s=t.heightfixed,u=void 0!==s&&s,c=t.lineTexture,l=void 0!==c&&c,h=t.iconStep,f=void 0===h?100:h,p=t.iconStepCount,d=void 0===p?1:p;this.rendererService.getDirty()&&this.texture.bind();var m=0,v=[0,0,0,0],g=[0,0,0,0];return r&&i&&(v=EK(r),g=EK(i),m=1),{u_heightfixed:Number(u),u_opacity:hZ.isNumber(n)?n:1,u_textureBlend:"normal"===a?0:1,u_texture:this.texture,u_line_texture:l?1:0,u_iconStepCount:d,u_icon_step:f,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:m,u_sourceColor:v,u_targetColor:g}}},{key:"getAnimateUniforms",value:function(){var t=this.layer.getLayerConfig().animateOption;return{u_animate:this.animateOption2Array(t),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:(n=RK(jK.mark((function t(){return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),t.next=4,this.buildModels();case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"clearModels",value:function(){var t;null===(t=this.texture)||void 0===t||t.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:(e=RK(jK.mark((function t(){var e;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.layer.buildLayerModel({moduleName:"lineWall",vertexShader:'#define Animate 0.0\n\nattribute float a_Miter;\nattribute vec4 a_Color;\nattribute vec2 a_Size;\nattribute vec3 a_Normal;\nattribute vec3 a_Position;\nattribute vec2 a_iconMapUV;\nattribute float a_Total_Distance;\nattribute float a_Distance;\n\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\nuniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];\nuniform float u_icon_step: 100;\nuniform float u_heightfixed;\nuniform float u_linearColor: 0;\n\n#pragma include "projection"\n#pragma include "light"\n#pragma include "picking"\n\n// texV 线图层 - 贴图部分的 v 坐标（线的宽度方向）\nvarying vec2 v_iconMapUV;\nvarying vec4 v_color;\nvarying float v_blur;\nvarying float v_radio;\nvarying vec4 v_dataset;\n\nvoid main() {\n\n\n  float d_distance_ratio; // 当前点位距离占线总长的比例\n  float d_texPixelLen;    // 贴图的像素长度，根据地图层级缩放\n\n  v_iconMapUV = a_iconMapUV;\n  if(u_heightfixed < 1.0) {     // 高度随 zoom 调整\n    d_texPixelLen = project_pixel(u_icon_step);\n  } else {\n    d_texPixelLen = u_icon_step;\n  }\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {\n    d_texPixelLen *= 10.0;\n  }\n\n  if(u_animate.x == Animate || u_linearColor == 1.0) {\n      d_distance_ratio = a_Distance / a_Total_Distance;\n  }\n\n  float miter = (a_Miter + 1.0)/2.0;\n  // 设置数据集的参数\n  v_dataset[0] = d_distance_ratio; // 当前点位距离占线总长的比例\n  v_dataset[1] = a_Distance;       // 当前顶点的距离\n  v_dataset[2] = d_texPixelLen;    // 贴图的像素长度，根据地图层级缩放\n  v_dataset[3] = miter;          // 线图层贴图部分的 v 坐标值 0 - 1\n\n  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));\n\n  float originSize = a_Size.x;  // 固定高度\n  if(u_heightfixed < 1.0) {     // 高度随 zoom 调整\n    originSize = project_float_pixel(a_Size.x);\n  }\n\n  float wallHeight = originSize * miter;\n  float lightWeight = calc_lighting(vec4(project_pos.xy, wallHeight, 1.0));\n\n  v_blur = min(project_float_pixel(2.0) / originSize, 0.05);\n  v_color = vec4(a_Color.rgb * lightWeight, a_Color.w);\n\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n    gl_Position = u_Mvp * (vec4(project_pos.xy, wallHeight, 1.0));\n  } else {\n    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, wallHeight, 1.0));\n  }\n\n  setPickingColor(a_PickingColor);\n}\n',fragmentShader:'#define Animate 0.0\n#define LineTexture 1.0\n\n// line texture\nuniform float u_line_texture;\nuniform sampler2D u_texture;\nuniform vec2 u_textSize;\nuniform float u_linearColor: 0;\nuniform vec4 u_sourceColor;\nuniform vec4 u_targetColor;\nuniform float u_opacity : 1.0;\nuniform float u_textureBlend;\nuniform float u_iconStepCount;\nuniform float u_time;\nuniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ]; // 控制运动\n\nvarying vec2 v_iconMapUV;\nvarying float v_blur;\nvarying float v_radio;\nvarying vec4 v_color;\nvarying vec4 v_dataset;\n\n#pragma include "picking"\n\nvoid main() {\n  float opacity = u_opacity;\n  float animateSpeed = 0.0; // 运动速度\n  float d_distance_ratio = v_dataset.r; // 当前点位距离占线总长的比例\n  float v = v_dataset.a;\n\n  if(u_linearColor == 1.0) { // 使用渐变颜色\n    gl_FragColor = mix(u_sourceColor, u_targetColor, v);\n  } else { // 使用 color 方法传入的颜色\n     gl_FragColor = v_color;\n  }\n\n  gl_FragColor.a *= opacity; // 全局透明度\n  if(u_animate.x == Animate) {\n      animateSpeed = u_time / u_animate.y;\n       float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + animateSpeed);\n      alpha = (alpha + u_animate.w -1.0) / u_animate.w;\n      alpha = smoothstep(0., 1., alpha);\n      gl_FragColor.a *= alpha;\n  }\n\n  if(u_line_texture == LineTexture) { // while load texture\n    float aDistance = v_dataset.g;      // 当前顶点的距离\n    float d_texPixelLen = v_dataset.b;  // 贴图的像素长度，根据地图层级缩放\n    float u = fract(mod(aDistance, d_texPixelLen)/d_texPixelLen - animateSpeed);\n    float v = v_dataset.a;  // 线图层贴图部分的 v 坐标值\n\n    // 计算纹理间隔 start\n    float flag = 0.0;\n    if(u > 1.0/u_iconStepCount) {\n      flag = 1.0;\n    }\n    u = fract(u*u_iconStepCount);\n    // 计算纹理间隔 end\n\n    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;\n    vec4 pattern = texture2D(u_texture, uv);\n\n    // Tip: 判断纹理间隔\n    if(flag > 0.0) {\n      pattern = vec4(0.0);\n    }\n\n    if(u_textureBlend == 0.0) { // normal\n      pattern.a = 0.0;\n      gl_FragColor = filterColor(gl_FragColor + pattern);\n    } else { // replace\n        pattern.a *= opacity;\n        if(gl_FragColor.a <= 0.0) {\n          pattern.a = 0.0;\n        }\n        gl_FragColor = filterColor(pattern);\n    }\n  }\n  \n\n  // blur - AA\n  if(v < v_blur) {\n    gl_FragColor.a = mix(0.0, gl_FragColor.a, v/v_blur);\n  } else if(v > 1.0 - v_blur) {\n    gl_FragColor.a = mix(gl_FragColor.a, 0.0, (v - (1.0 - v_blur))/v_blur);\n  }\n\n  gl_FragColor = filterColor(gl_FragColor);\n}\n',triangulation:jet,depth:{enable:!1},blend:this.getBlend()});case 2:return e=t.sent,t.abrupt("return",[e]);case 4:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"registerBuiltinAttributes",value:function(){var t=this;this.styleAttributeService.registerStyleAttribute({name:"distance",type:d8.Attribute,descriptor:{name:"a_Distance",buffer:{usage:m4.STATIC_DRAW,data:[],type:m4.FLOAT},size:1,update:function(t,e,n){return[n[3]]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:d8.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:m4.STATIC_DRAW,data:[],type:m4.FLOAT},size:1,update:function(t,e,n){return[n[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:d8.Attribute,descriptor:{name:"a_Size",buffer:{usage:m4.DYNAMIC_DRAW,data:[],type:m4.FLOAT},size:2,update:function(t){var e=t.size,n=void 0===e?1:e;return Array.isArray(n)?[n[0],n[1]]:[n,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:d8.Attribute,descriptor:{name:"a_Normal",buffer:{usage:m4.STATIC_DRAW,data:[],type:m4.FLOAT},size:3,update:function(t,e,n,r,i){return i}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:d8.Attribute,descriptor:{name:"a_Miter",buffer:{usage:m4.STATIC_DRAW,data:[],type:m4.FLOAT},size:1,update:function(t,e,n){return[n[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:d8.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:m4.DYNAMIC_DRAW,data:[],type:m4.FLOAT},size:2,update:function(e){var n=t.iconService.getIconMap()[e.texture]||{x:0,y:0};return[n.x,n.y]}}})}}]),i}();const Mnt={arc:ent,arc3d:int,greatcircle:lnt,wall:Snt,line:vnt,halfLine:fnt,simple:_nt,linearline:ynt,earthArc3d:snt};function Ent(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var Ant=function(t){wZ(r,Ytt);var e,n=Ent(r);function r(){var t;mZ(this,r);for(var e=arguments.length,i=new Array(e),o=0;o<e;o++)i[o]=arguments[o];return $q(SZ(t=n.call.apply(n,[this].concat(i))),"type","LineLayer"),$q(SZ(t),"arrowInsertCount",0),$q(SZ(t),"defaultSourceConfig",{data:[{lng1:100,lat1:30,lng2:130,lat2:30}],options:{parser:{type:"json",x:"lng1",y:"lat1",x1:"lng2",y1:"lat2"}}}),t}return gZ(r,[{key:"buildModels",value:(e=RK(jK.mark((function t(){var e;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.getModelType(),this.layerModel=new Mnt[e](this),t.next=4,this.initLayerModels();case 4:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"getDefaultConfig",value:function(){return{line:{},linearline:{},simple:{},wall:{},arc3d:{blend:"additive"},arc:{blend:"additive"},greatcircle:{blend:"additive"},tileLine:{},halfLine:{},earthArc3d:{}}[this.getModelType()]}},{key:"getModelType",value:function(){var t;if(this.layerType)return this.layerType;var e=this.styleAttributeService.getLayerStyleAttribute("shape");return(null==e||null===(t=e.scale)||void 0===t?void 0:t.field)||"line"}},{key:"processData",value:function(t){if("simple"!==this.getModelType())return t;var e=[];return t.map((function(t){if(Array.isArray(t.coordinates)&&Array.isArray(t.coordinates[0])&&Array.isArray(t.coordinates[0][0])){var n=Jq({},t);t.coordinates.map((function(t){e.push(Jq(Jq({},n),{},{coordinates:t}))}))}else e.push(t)})),e}}]),r}();function Tnt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var Cnt=function(t){wZ(i,oet);var e,n,r=Tnt(i);function i(){var t;mZ(this,i);for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return $q(SZ(t=r.call.apply(r,[this].concat(n))),"raiseCount",0),$q(SZ(t),"raiseRepeat",0),t}return gZ(i,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),e=t.animateOption,n=void 0===e?{enable:!1,speed:.01,repeat:!1}:e,r=t.opacity,i=void 0===r?1:r,o=t.sourceColor,a=t.targetColor,s=t.pickLight,u=void 0!==s&&s,c=t.heightfixed,l=void 0!==c&&c,h=t.opacityLinear,f=void 0===h?{enable:!1,dir:"up"}:h,p=t.lightEnable,d=void 0===p||p;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:i})){this.judgeStyleAttributes({opacity:i});var m=this.layer.getEncodedData(),v=this.calDataFrame(this.cellLength,m,this.cellProperties),g=v.data,y=v.width,x=v.height;this.rowCount=x,this.dataTexture=this.cellLength>0&&g.length>0?this.createTexture2D({flipY:!0,data:g,format:m4.LUMINANCE,type:m4.FLOAT,width:y,height:x}):this.createTexture2D({flipY:!0,data:[1],format:m4.LUMINANCE,type:m4.FLOAT,width:1,height:1})}var b=0,_=[0,0,0,0],w=[0,0,0,0];if(o&&a&&(_=EK(o),w=EK(a),b=1),this.raiseCount<1&&this.raiseRepeat>0&&n.enable){var S=n.speed,M=void 0===S?.01:S;this.raiseCount+=M,this.raiseCount>=1&&(this.raiseRepeat>1?(this.raiseCount=0,this.raiseRepeat--):this.raiseCount=1)}return{u_pickLight:Number(u),u_heightfixed:Number(l),u_r:n.enable&&this.raiseRepeat>0?this.raiseCount:1,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:hZ.isNumber(i)?i:1,u_linearColor:b,u_sourceColor:_,u_targetColor:w,u_opacitylinear:Number(f.enable),u_opacitylinear_dir:"up"===f.dir?1:0,u_lightEnable:Number(d)}}},{key:"initModels",value:(n=RK(jK.mark((function t(){return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.buildModels();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"buildModels",value:(e=RK(jK.mark((function t(){var e,n,r,i;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.layer.getLayerConfig(),n=e.animateOption.repeat,r=void 0===n?1:n,this.raiseRepeat=r,t.next=4,this.layer.buildLayerModel({moduleName:"pointEarthExtrude",vertexShader:'precision highp float;\n\n#define pi 3.1415926535\n#define ambientRatio 0.5\n#define diffuseRatio 0.3\n#define specularRatio 0.2\n\nattribute vec3 a_Position;\nattribute vec3 a_Pos;\nattribute vec4 a_Color;\nattribute vec3 a_Size;\nattribute vec3 a_Normal;\n\nuniform float u_heightfixed: 0.0; // 默认不固定\nuniform float u_globel;\nuniform float u_r;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\nvarying vec4 v_color;\n\nuniform float u_opacity : 1;\nuniform float u_lightEnable: 1;\n\nvarying mat4 styleMappingMat; // 用于将在顶点着色器中计算好的样式值传递给片元\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n\n#pragma include "projection"\n#pragma include "light"\n#pragma include "picking"\n\nfloat getYRadian(float x, float z) {\n  if(x > 0.0 && z > 0.0) {\n    return atan(x/z);\n  } else if(x > 0.0 && z <= 0.0){\n    return atan(-z/x) + pi/2.0;\n  } else if(x <= 0.0 && z <= 0.0) {\n    return  pi + atan(x/z); //atan(x/z) + \n  } else {\n    return atan(z/-x) + pi*3.0/2.0;\n  }\n}\n\nfloat getXRadian(float y, float r) {\n  return atan(y/r);\n}\n\nvoid main() {\n\n  // cal style mapping - 数据纹理映射部分的计算\n  styleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA - lightWeight\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1] - linearZ(垂直方向 0 - 1 的值)\n    0.0, 0.0, 0.0, 0.0\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // 当前的数据纹理有几行\n  float columnCount = u_cellTypeLayout[0][1]; // 当看到数据纹理有几列\n  float columnWidth = 1.0/columnCount;  // 列宽\n  float rowHeight = 1.0/rowCount;       // 行高\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // 第n个顶点\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // 起始点在第几行\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // 起始点在第几列\n  \n  // cell 固定顺序 opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // 按顺序从 cell 中取值、若没有则自动往下取值\n  float textureOffset = 0.0; // 在 cell 中取值的偏移量\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n  // cal style mapping - 数据纹理映射部分的计算\n  vec3 size = a_Size * a_Position;\n\n  // a_Position.z 是在构建网格的时候传入的标准值 0 - 1，在插值器插值可以获取 0～1 线性渐变的值\n  styleMappingMat[2][3] =  a_Position.z;\n\n  vec3 offset = size; // 控制圆柱体的大小 - 从标准单位圆柱体进行偏移\n  if(u_heightfixed < 1.0) { // 圆柱体不固定高度\n    \n    if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {\n      // P20 坐标系下，为了和 Web 墨卡托坐标系统一，zoom 默认减1\n      offset = offset * pow(2.0, (19.0 - u_Zoom));\n    }\n    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {\n      // P20_2 坐标系下，为了和 Web 墨卡托坐标系统一，zoom 默认减3\n      offset = offset * pow(2.0, (19.0 - 3.0 - u_Zoom));\n    }\n  } else {// 圆柱体固定高度 （ 处理 mapbox ）\n    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {\n      offset *= 4.0/pow(2.0, 21.0 - u_Zoom);\n    }\n  }\n\n\n  vec4 project_pos = project_position(vec4(a_Pos.xy, 0., 1.0));\n\n  // u_r 控制圆柱的生长\n  vec4 pos = vec4(project_pos.xy + offset.xy, offset.z * u_r, 1.0);\n\n  // 圆柱光照效果\n  float lightWeight = 1.0;\n  if(u_lightEnable > 0.0) { // 取消三元表达式，增强健壮性\n    lightWeight = calc_lighting(pos);\n  }\n  styleMappingMat[1][3] = lightWeight;\n\n  v_color =vec4(a_Color.rgb * lightWeight, a_Color.w);\n\n  \n  // 在地球模式下，将原本垂直于 xy 平面的圆柱调整姿态到适应圆的角度\n  //旋转矩阵mx，创建绕x轴旋转矩阵\n  float r = sqrt(a_Pos.z*a_Pos.z + a_Pos.x*a_Pos.x);\n  float xRadian = getXRadian(a_Pos.y, r);\n  float xcos = cos(xRadian);//求解旋转角度余弦值\n  float xsin = sin(xRadian);//求解旋转角度正弦值\n  mat4 mx = mat4(\n    1,0,0,0,  \n    0,xcos,-xsin,0,  \n    0,xsin,xcos,0,  \n    0,0,0,1);\n\n  //旋转矩阵my，创建绕y轴旋转矩阵\n  float yRadian = getYRadian(a_Pos.x, a_Pos.z);\n  float ycos = cos(yRadian);//求解旋转角度余弦值\n  float ysin = sin(yRadian);//求解旋转角度正弦值\n  mat4 my = mat4(\n    ycos,0,-ysin,0,  \n    0,1,0,0,  \n    ysin,0,ycos,0,  \n    0,0,0,1);\n\n  gl_Position = u_ViewProjectionMatrix * vec4(( my * mx *  vec4(a_Position * a_Size, 1.0)).xyz + a_Pos, 1.0);\n  \n\n  setPickingColor(a_PickingColor);\n}\n',fragmentShader:'varying vec4 v_color;\nuniform float u_opacity: 1.0;\n\nuniform float u_pickLight: 0.0;\n\n#pragma include "picking"\n\nvarying mat4 styleMappingMat; // 传递从片元中传递的映射数据\n\nuniform float u_linearColor: 0;\nuniform vec4 u_sourceColor;\nuniform vec4 u_targetColor;\n\nuniform float u_opacitylinear: 0.0;\nuniform float u_opacitylinear_dir: 1.0;\n\nvoid main() {\n  float opacity = styleMappingMat[0][0];\n  float lightWeight = styleMappingMat[1][3];\n  float barLinearZ = styleMappingMat[2][3];\n\n  // 设置圆柱的底色\n  if(u_linearColor == 1.0) { // 使用渐变颜色\n    gl_FragColor = mix(u_sourceColor, u_targetColor, barLinearZ);\n    gl_FragColor.rgb *= lightWeight;\n  } else { // 使用 color 方法传入的颜色\n     gl_FragColor = v_color;\n  }\n\n  // 应用透明度\n  gl_FragColor.a *= opacity;\n\n  // 开启透明度渐变\n  if(u_opacitylinear > 0.0) {\n    gl_FragColor.a *= u_opacitylinear_dir > 0.0 ? (1.0 - barLinearZ): barLinearZ;\n  }\n\n  // picking\n  if(u_pickLight > 0.0) {\n    gl_FragColor = filterColorAlpha(gl_FragColor, lightWeight);\n  } else {\n    gl_FragColor = filterColor(gl_FragColor);\n  }\n}\n',triangulation:Det,depth:{enable:!0},cull:{enable:!0,face:xQ(this.mapService.version)},blend:this.getBlend()});case 4:return i=t.sent,t.abrupt("return",[i]);case 6:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"clearModels",value:function(){var t;null===(t=this.dataTexture)||void 0===t||t.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:d8.Attribute,descriptor:{name:"a_Size",buffer:{usage:m4.DYNAMIC_DRAW,data:[],type:m4.FLOAT},size:3,update:function(t){var e=t.size;if(e){var n=[];return Array.isArray(e)&&(n=2===e.length?[e[0],e[0],e[1]]:e),Array.isArray(e)||(n=[e,e,e]),n}return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:d8.Attribute,descriptor:{name:"a_Normal",buffer:{usage:m4.STATIC_DRAW,data:[],type:m4.FLOAT},size:3,update:function(t,e,n,r,i){return i}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:d8.Attribute,descriptor:{name:"a_Pos",buffer:{usage:m4.DYNAMIC_DRAW,data:[],type:m4.FLOAT},size:3,update:function(t){var e=_K(t.coordinates);return set([e[0],e[1]])}}})}}]),i}();function Ont(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var knt=function(t){wZ(i,oet);var e,n,r=Ont(i);function i(){return mZ(this,i),r.apply(this,arguments)}return gZ(i,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),e=t.opacity,n=void 0===e?1:e,r=t.strokeOpacity,i=void 0===r?1:r,o=t.strokeWidth,a=void 0===o?0:o,s=t.stroke,u=void 0===s?"rgba(0,0,0,0)":s,c=t.offsets,l=void 0===c?[0,0]:c,h=t.blend,f=t.blur,p=void 0===f?0:f;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:n,strokeOpacity:i,strokeWidth:a,stroke:u,offsets:l})){this.judgeStyleAttributes({opacity:n,strokeOpacity:i,strokeWidth:a,stroke:u,offsets:l});var d=this.layer.getEncodedData(),m=this.calDataFrame(this.cellLength,d,this.cellProperties),v=m.data,g=m.width,y=m.height;this.rowCount=y,this.dataTexture=this.cellLength>0&&v.length>0?this.createTexture2D({flipY:!0,data:v,format:m4.LUMINANCE,type:m4.FLOAT,width:g,height:y}):this.createTexture2D({flipY:!0,data:[1],format:m4.LUMINANCE,type:m4.FLOAT,width:1,height:1})}return{u_blur:p,u_additive:"additive"===h?1:0,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:hZ.isNumber(n)?n:1,u_stroke_opacity:hZ.isNumber(i)?i:1,u_stroke_width:hZ.isNumber(a)?a:1,u_stroke_color:this.getStrokeColor(u),u_offsets:this.isOffsetStatic(l)?l:[0,0]}}},{key:"getAnimateUniforms",value:function(){var t=this.layer.getLayerConfig().animateOption,e=void 0===t?{enable:!1}:t;return{u_animate:this.animateOption2Array(e),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:(n=RK(jK.mark((function t(){return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.buildModels();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"buildModels",value:(e=RK(jK.mark((function t(){var e;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.layer.triangulation=Net,t.next=3,this.layer.buildLayerModel({moduleName:"pointEarthFill",vertexShader:'attribute vec4 a_Color;\nattribute vec3 a_Position;\nattribute vec3 a_Extrude;\nattribute float a_Size;\nattribute float a_Shape;\n\nvarying mat4 styleMappingMat; // 用于将在顶点着色器中计算好的样式值传递给片元\n\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\n\nvarying vec4 v_data;\nvarying vec4 v_color;\nvarying float v_radius;\n\nuniform float u_opacity : 1;\nuniform float u_stroke_opacity : 1;\nuniform float u_stroke_width : 2;\nuniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];\nuniform vec2 u_offsets;\n\nuniform float u_blur : 0.0;\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n#pragma include "styleMappingCalStrokeOpacity"\n#pragma include "styleMappingCalStrokeWidth"\n\n#pragma include "projection"\n#pragma include "picking"\n\n\nvoid main() {\n  vec3 extrude = a_Extrude;\n  float shape_type = a_Shape;\n  /*\n  *  setPickingSize 设置拾取大小\n  */\n  float newSize = setPickingSize(a_Size);\n  // float newSize = setPickingSize(a_Size) * 0.00001038445708445579;\n\n  // cal style mapping - 数据纹理映射部分的计算\n  styleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // 当前的数据纹理有几行\n  float columnCount = u_cellTypeLayout[0][1]; // 当看到数据纹理有几列\n  float columnWidth = 1.0/columnCount;  // 列宽\n  float rowHeight = 1.0/rowCount;       // 行高\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // 第n个顶点\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // 起始点在第几行\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // 起始点在第几列\n  \n  // cell 固定顺序 opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // 按顺序从 cell 中取值、若没有则自动往下取值\n  float textureOffset = 0.0; // 在 cell 中取值的偏移量\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n\n  vec2 strokeOpacityAndOffset = calStrokeOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][1] = strokeOpacityAndOffset.r;\n  textureOffset = strokeOpacityAndOffset.g;\n\n  vec2 strokeWidthAndOffset = calStrokeWidthAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][2] = strokeWidthAndOffset.r;\n  textureOffset = strokeWidthAndOffset.g;\n\n  vec4 textrueStroke = vec4(-1.0, -1.0, -1.0, -1.0);\n  if(hasStroke()) {\n    vec2 valueRPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    styleMappingMat[1][0] = pos2value(valueRPos, columnWidth, rowHeight); // R\n    textureOffset += 1.0;\n\n    vec2 valueGPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    styleMappingMat[1][1] = pos2value(valueGPos, columnWidth, rowHeight); // G\n    textureOffset += 1.0;\n\n    vec2 valueBPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    styleMappingMat[1][2] = pos2value(valueBPos, columnWidth, rowHeight); // B\n    textureOffset += 1.0;\n\n    vec2 valueAPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    styleMappingMat[1][3] = pos2value(valueAPos, columnWidth, rowHeight); // A\n    textureOffset += 1.0;\n  } else {\n    if(u_stroke_color == vec4(0.0)) {\n      styleMappingMat[1][0] = v_color.r;\n      styleMappingMat[1][1] = v_color.g;\n      styleMappingMat[1][2] = v_color.b;\n      styleMappingMat[1][3] = v_color.a;\n    } else {\n      styleMappingMat[1][0] = u_stroke_color.r;\n      styleMappingMat[1][1] = u_stroke_color.g;\n      styleMappingMat[1][2] = u_stroke_color.b;\n      styleMappingMat[1][3] = u_stroke_color.a;\n    }\n  }\n\n  // cal style mapping\n\n  // unpack color(vec2)\n  v_color = a_Color;\n\n  // radius(16-bit)\n  v_radius = newSize;\n\n  // anti-alias\n  //  float antialiased_blur = -max(u_blur, antialiasblur);\n  float antialiasblur = -max(2.0 / u_DevicePixelRatio / newSize, u_blur);\n\n  // TODP: /abs(extrude.x) 是为了兼容地球模式\n  v_data = vec4(extrude.x/abs(extrude.x), extrude.y/abs(extrude.y), antialiasblur,shape_type);\n\n\n  gl_Position = u_ViewProjectionMatrix * vec4(a_Position + extrude * newSize * 0.1, 1.0);\n\n  setPickingColor(a_PickingColor);\n}\n',fragmentShader:"uniform float u_additive;\n\nvarying mat4 styleMappingMat; // 传递从片元中传递的映射数据\n\nvarying vec4 v_data;\nvarying vec4 v_color;\nvarying float v_radius;\n\n#pragma include \"sdf_2d\"\n#pragma include \"picking\"\n\n\nvoid main() {\n  int shape = int(floor(v_data.w + 0.5));\n\n  vec4 textrueStroke = vec4(\n    styleMappingMat[1][0],\n    styleMappingMat[1][1],\n    styleMappingMat[1][2],\n    styleMappingMat[1][3]\n  );\n\n  float opacity = styleMappingMat[0][0];\n  float stroke_opacity = styleMappingMat[0][1];\n  float strokeWidth = styleMappingMat[0][2];\n  vec4 strokeColor = textrueStroke == vec4(0) ? v_color : textrueStroke;\n\n  lowp float antialiasblur = v_data.z;\n  float r = v_radius / (v_radius + strokeWidth);\n\n  float outer_df;\n  float inner_df;\n  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'\n  if (shape == 0) {\n    outer_df = sdCircle(v_data.xy, 1.0);\n    inner_df = sdCircle(v_data.xy, r);\n  } else if (shape == 1) {\n    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);\n    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);\n  } else if (shape == 2) {\n    outer_df = sdBox(v_data.xy, vec2(1.));\n    inner_df = sdBox(v_data.xy, vec2(r));\n  } else if (shape == 3) {\n    outer_df = sdPentagon(v_data.xy, 0.8);\n    inner_df = sdPentagon(v_data.xy, r * 0.8);\n  } else if (shape == 4) {\n    outer_df = sdHexagon(v_data.xy, 0.8);\n    inner_df = sdHexagon(v_data.xy, r * 0.8);\n  } else if (shape == 5) {\n    outer_df = sdOctogon(v_data.xy, 1.0);\n    inner_df = sdOctogon(v_data.xy, r);\n  } else if (shape == 6) {\n    outer_df = sdHexagram(v_data.xy, 0.52);\n    inner_df = sdHexagram(v_data.xy, r * 0.52);\n  } else if (shape == 7) {\n    outer_df = sdRhombus(v_data.xy, vec2(1.0));\n    inner_df = sdRhombus(v_data.xy, vec2(r));\n  } else if (shape == 8) {\n    outer_df = sdVesica(v_data.xy, 1.1, 0.8);\n    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);\n  }\n\n  if(outer_df > antialiasblur + 0.018) discard;\n\n  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);\n\n  float color_t = strokeWidth < 0.01 ? 0.0 : smoothstep(\n    antialiasblur,\n    0.0,\n    inner_df\n  );\n\n  if(strokeWidth < 0.01) {\n    gl_FragColor = vec4(v_color.rgb, v_color.a * opacity);\n  } else {\n    gl_FragColor = mix(vec4(v_color.rgb, v_color.a * opacity), strokeColor * stroke_opacity, color_t);\n  }\n\n  if(u_additive > 0.0) {\n    gl_FragColor *= opacity_t;\n    gl_FragColor = filterColorAlpha(gl_FragColor, gl_FragColor.a);\n  } else {\n    gl_FragColor.a *= opacity_t;\n    gl_FragColor = filterColor(gl_FragColor);\n  }\n}\n",triangulation:Net,depth:{enable:!0},blend:this.getBlend()});case 3:return e=t.sent,t.abrupt("return",[e]);case 5:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"clearModels",value:function(){var t;null===(t=this.dataTexture)||void 0===t||t.destroy()}},{key:"animateOption2Array",value:function(t){return[t.enable?0:1,t.speed||1,t.rings||3,0]}},{key:"registerBuiltinAttributes",value:function(){var t=this;this.styleAttributeService.registerStyleAttribute({name:"extrude",type:d8.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:m4.DYNAMIC_DRAW,data:[],type:m4.FLOAT},size:3,update:function(t,e,n,r){var i=lZ(n,3),o=i[0],a=i[1],s=i[2],u=Bo(0,0,1),c=Bo(o,0,s),l=o>=0?aa(u,c):2*Math.PI-aa(u,c),h=2*Math.PI-Math.asin(a/100),f=no();vo(f,f,l),mo(f,f,h);var p=Bo(1,1,0);ra(p,p,f),Qo(p,p);var d=Bo(-1,1,0);ra(d,d,f),Qo(d,d);var m=Bo(-1,-1,0);ra(m,m,f),Qo(m,m);var v=Bo(1,-1,0);ra(v,v,f),Qo(v,v);var g=[].concat(Xq(p),Xq(d),Xq(m),Xq(v)),y=r%4*3;return[g[y],g[y+1],g[y+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:d8.Attribute,descriptor:{name:"a_Size",buffer:{usage:m4.DYNAMIC_DRAW,data:[],type:m4.FLOAT},size:1,update:function(t){var e=t.size,n=void 0===e?5:e;return Array.isArray(n)?[n[0]]:[n]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:d8.Attribute,descriptor:{name:"a_Shape",buffer:{usage:m4.DYNAMIC_DRAW,data:[],type:m4.FLOAT},size:1,update:function(e){var n=e.shape,r=void 0===n?2:n;return[t.layer.getLayerConfig().shape2d.indexOf(r)]}}})}}]),i}();function Pnt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var Lnt=function(t){wZ(i,oet);var e,n,r=Pnt(i);function i(){var t;mZ(this,i);for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return $q(SZ(t=r.call.apply(r,[this].concat(n))),"raiseCount",0),$q(SZ(t),"raiseRepeat",0),t}return gZ(i,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),e=t.animateOption,n=void 0===e?{enable:!1,speed:.01,repeat:!1}:e,r=t.opacity,i=void 0===r?1:r,o=t.sourceColor,a=t.targetColor,s=t.pickLight,u=void 0!==s&&s,c=t.heightfixed,l=void 0!==c&&c,h=t.opacityLinear,f=void 0===h?{enable:!1,dir:"up"}:h,p=t.lightEnable,d=void 0===p||p;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:i})){this.judgeStyleAttributes({opacity:i});var m=this.layer.getEncodedData(),v=this.calDataFrame(this.cellLength,m,this.cellProperties),g=v.data,y=v.width,x=v.height;this.rowCount=x,this.dataTexture=this.cellLength>0&&g.length>0?this.createTexture2D({flipY:!0,data:g,format:m4.LUMINANCE,type:m4.FLOAT,width:y,height:x}):this.createTexture2D({flipY:!0,data:[1],format:m4.LUMINANCE,type:m4.FLOAT,width:1,height:1})}var b=0,_=[0,0,0,0],w=[0,0,0,0];if(o&&a&&(_=EK(o),w=EK(a),b=1),this.raiseCount<1&&this.raiseRepeat>0&&n.enable){var S=n.speed,M=void 0===S?.01:S;this.raiseCount+=M,this.raiseCount>=1&&(this.raiseRepeat>1?(this.raiseCount=0,this.raiseRepeat--):this.raiseCount=1)}return{u_pickLight:Number(u),u_heightfixed:Number(l),u_r:n.enable&&this.raiseRepeat>0?this.raiseCount:1,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:hZ.isNumber(i)?i:1,u_linearColor:b,u_sourceColor:_,u_targetColor:w,u_opacitylinear:Number(f.enable),u_opacitylinear_dir:"up"===f.dir?1:0,u_lightEnable:Number(d)}}},{key:"initModels",value:(n=RK(jK.mark((function t(){return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.buildModels();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"buildModels",value:(e=RK(jK.mark((function t(){var e,n,r,i,o,a;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.layer.getLayerConfig(),n=e.depth,r=void 0===n||n,i=e.animateOption.repeat,o=void 0===i?1:i,this.raiseRepeat=o,t.next=4,this.layer.buildLayerModel({moduleName:"pointExtrude",vertexShader:'precision highp float;\n\n#define pi 3.1415926535\n#define ambientRatio 0.5\n#define diffuseRatio 0.3\n#define specularRatio 0.2\n\nattribute vec3 a_Position;\nattribute vec3 a_Pos;\nattribute vec4 a_Color;\nattribute vec3 a_Size;\nattribute vec3 a_Normal;\n\nuniform float u_heightfixed: 0.0; // 默认不固定\nuniform float u_r;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\nvarying vec4 v_color;\n\nuniform float u_opacity : 1;\nuniform float u_lightEnable: 1;\n\nvarying mat4 styleMappingMat; // 用于将在顶点着色器中计算好的样式值传递给片元\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n\n#pragma include "projection"\n#pragma include "light"\n#pragma include "picking"\n\nfloat getYRadian(float x, float z) {\n  if(x > 0.0 && z > 0.0) {\n    return atan(x/z);\n  } else if(x > 0.0 && z <= 0.0){\n    return atan(-z/x) + pi/2.0;\n  } else if(x <= 0.0 && z <= 0.0) {\n    return  pi + atan(x/z); //atan(x/z) + \n  } else {\n    return atan(z/-x) + pi*3.0/2.0;\n  }\n}\n\nfloat getXRadian(float y, float r) {\n  return atan(y/r);\n}\n\nvoid main() {\n\n  // cal style mapping - 数据纹理映射部分的计算\n  styleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA - lightWeight\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1] - linearZ(垂直方向 0 - 1 的值)\n    0.0, 0.0, 0.0, 0.0\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // 当前的数据纹理有几行\n  float columnCount = u_cellTypeLayout[0][1]; // 当看到数据纹理有几列\n  float columnWidth = 1.0/columnCount;  // 列宽\n  float rowHeight = 1.0/rowCount;       // 行高\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // 第n个顶点\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // 起始点在第几行\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // 起始点在第几列\n  \n  // cell 固定顺序 opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // 按顺序从 cell 中取值、若没有则自动往下取值\n  float textureOffset = 0.0; // 在 cell 中取值的偏移量\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n  // cal style mapping - 数据纹理映射部分的计算\n  vec3 size = a_Size * a_Position;\n\n  // a_Position.z 是在构建网格的时候传入的标准值 0 - 1，在插值器插值可以获取 0～1 线性渐变的值\n  styleMappingMat[2][3] =  a_Position.z;\n\n  vec3 offset = size; // 控制圆柱体的大小 - 从标准单位圆柱体进行偏移\n  if(u_heightfixed < 1.0) { // 圆柱体不固定高度\n    \n    if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {\n      // P20 坐标系下，为了和 Web 墨卡托坐标系统一，zoom 默认减1\n      offset = offset * pow(2.0, (19.0 - u_Zoom));\n    }\n    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {\n      // P20_2 坐标系下，为了和 Web 墨卡托坐标系统一，zoom 默认减3\n      offset = offset * pow(2.0, (19.0 - 3.0 - u_Zoom));\n    }\n  } else {// 圆柱体固定高度 （ 处理 mapbox ）\n    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {\n      offset *= 4.0/pow(2.0, 21.0 - u_Zoom);\n    }\n  }\n\n\n  vec4 project_pos = project_position(vec4(a_Pos.xy, 0., 1.0));\n\n  // u_r 控制圆柱的生长\n  vec4 pos = vec4(project_pos.xy + offset.xy, offset.z * u_r, 1.0);\n\n  // 圆柱光照效果\n  float lightWeight = 1.0;\n  if(u_lightEnable > 0.0) { // 取消三元表达式，增强健壮性\n    lightWeight = calc_lighting(pos);\n  }\n  styleMappingMat[1][3] = lightWeight;\n\n  v_color =vec4(a_Color.rgb * lightWeight, a_Color.w);\n\n  // gl_Position = project_common_position_to_clipspace(pos);\n\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n    gl_Position = u_Mvp * pos;\n  } else {\n    gl_Position = project_common_position_to_clipspace(pos);\n  }\n\n  setPickingColor(a_PickingColor);\n}\n',fragmentShader:'varying vec4 v_color;\nuniform float u_opacity: 1.0;\n\nuniform float u_pickLight: 0.0;\n\n#pragma include "picking"\n\nvarying mat4 styleMappingMat; // 传递从片元中传递的映射数据\n\nuniform float u_linearColor: 0;\nuniform vec4 u_sourceColor;\nuniform vec4 u_targetColor;\n\nuniform float u_opacitylinear: 0.0;\nuniform float u_opacitylinear_dir: 1.0;\n\nvoid main() {\n  float opacity = styleMappingMat[0][0];\n  float lightWeight = styleMappingMat[1][3];\n  float barLinearZ = styleMappingMat[2][3];\n\n  // 设置圆柱的底色\n  if(u_linearColor == 1.0) { // 使用渐变颜色\n    gl_FragColor = mix(u_sourceColor, u_targetColor, barLinearZ);\n    gl_FragColor.rgb *= lightWeight;\n  } else { // 使用 color 方法传入的颜色\n     gl_FragColor = v_color;\n  }\n\n  // 应用透明度\n  gl_FragColor.a *= opacity;\n\n  // 开启透明度渐变\n  if(u_opacitylinear > 0.0) {\n    gl_FragColor.a *= u_opacitylinear_dir > 0.0 ? (1.0 - barLinearZ): barLinearZ;\n  }\n\n  // picking\n  if(u_pickLight > 0.0) {\n    gl_FragColor = filterColorAlpha(gl_FragColor, lightWeight);\n  } else {\n    gl_FragColor = filterColor(gl_FragColor);\n  }\n}\n',triangulation:Det,blend:this.getBlend(),cull:{enable:!0,face:xQ(this.mapService.version)},depth:{enable:r}});case 4:return a=t.sent,t.abrupt("return",[a]);case 6:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"clearModels",value:function(){var t;null===(t=this.dataTexture)||void 0===t||t.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:d8.Attribute,descriptor:{name:"a_Size",buffer:{usage:m4.DYNAMIC_DRAW,data:[],type:m4.FLOAT},size:3,update:function(t){var e=t.size;if(e){var n=[];return Array.isArray(e)&&(n=2===e.length?[e[0],e[0],e[1]]:e),Array.isArray(e)||(n=[e,e,e]),n}return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:d8.Attribute,descriptor:{name:"a_Normal",buffer:{usage:m4.STATIC_DRAW,data:[],type:m4.FLOAT},size:3,update:function(t,e,n,r,i){return i}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:d8.Attribute,descriptor:{name:"a_Pos",buffer:{usage:m4.DYNAMIC_DRAW,data:[],type:m4.FLOAT},size:3,update:function(t){var e=_K(t.coordinates);return[e[0],e[1],0]}}})}}]),i}();function Rnt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var Int="\nuniform float u_additive;\n\nvarying mat4 styleMappingMat; // 传递从片元中传递的映射数据\n\nvarying vec4 v_data;\nvarying vec4 v_color;\nvarying float v_radius;\nuniform float u_time;\nuniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];\n\n#pragma include \"sdf_2d\"\n#pragma include \"picking\"\n\nvoid main() {\n\n  vec4 textrueStroke = vec4(\n    styleMappingMat[1][0],\n    styleMappingMat[1][1],\n    styleMappingMat[1][2],\n    styleMappingMat[1][3]\n  );\n\n  float opacity = styleMappingMat[0][0];\n\n  lowp float antialiasblur = v_data.z;\n  float r = v_radius / (v_radius);\n\n  float outer_df;\n  float inner_df;\n  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'\n  \n  outer_df = sdCircle(v_data.xy, 1.0);\n  inner_df = sdCircle(v_data.xy, r);\n\n\n  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);\n\n  float color_t = smoothstep(\n    antialiasblur,\n    0.0,\n    inner_df\n  );\n  float PI = 3.14159;\n  float N_RINGS = 3.0;\n  float FREQ = 1.0;\n\n gl_FragColor = vec4(v_color.rgb, v_color.a * opacity);\n\n  float d = length(v_data.xy);\n  if(d > 0.5) {\n    discard;\n  }\n  float intensity = clamp(cos(d * PI), 0.0, 1.0) * clamp(cos(2.0 * PI * (d * 2.0 * u_animate.z - u_animate.y * u_time)), 0.0, 1.0);\n  \n  // 根据叠加模式选择效果\n  if(u_additive > 0.0) {\n    gl_FragColor *= intensity;\n    // 优化水波点 blend additive 模式下有的拾取效果 \n    gl_FragColor = filterColorAlpha(gl_FragColor, gl_FragColor.a);\n  } else {\n    gl_FragColor = vec4(gl_FragColor.xyz, gl_FragColor.a * intensity);\n    gl_FragColor = filterColor(gl_FragColor);\n  }\n}\n",Nnt='attribute vec4 a_Color;\nattribute vec3 a_Position;\nattribute vec3 a_Extrude;\nattribute float a_Size;\nattribute float a_Shape;\n\nvarying mat4 styleMappingMat; // 用于将在顶点着色器中计算好的样式值传递给片元\n\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\nuniform int u_Size_Unit;\n\nvarying vec4 v_data;\nvarying vec4 v_color;\nvarying float v_radius;\n\nuniform float u_opacity : 1;\nuniform float u_stroke_opacity : 1;\nuniform float u_stroke_width : 2;\nuniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];\nuniform vec2 u_offsets;\n\nuniform float u_blur : 0.0;\nuniform float u_raisingHeight: 0.0;\nuniform float u_heightfixed: 0.0;\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n#pragma include "styleMappingCalStrokeOpacity"\n#pragma include "styleMappingCalStrokeWidth"\n\n#pragma include "projection"\n#pragma include "picking"\n\n\nvoid main() {\n  vec3 extrude = a_Extrude;\n  float shape_type = a_Shape;\n  /*\n  *  setPickingSize 设置拾取大小\n  *  u_meter2coord 在等面积大小的时候设置单位\n  */\n  float newSize = setPickingSize(a_Size);\n  // float newSize = setPickingSize(a_Size) * 0.00001038445708445579;\n\n  // cal style mapping - 数据纹理映射部分的计算\n  styleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // 当前的数据纹理有几行\n  float columnCount = u_cellTypeLayout[0][1]; // 当看到数据纹理有几列\n  float columnWidth = 1.0/columnCount;  // 列宽\n  float rowHeight = 1.0/rowCount;       // 行高\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // 第n个顶点\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // 起始点在第几行\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // 起始点在第几列\n  \n  // cell 固定顺序 opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // 按顺序从 cell 中取值、若没有则自动往下取值\n  float textureOffset = 0.0; // 在 cell 中取值的偏移量\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n\n  vec2 strokeOpacityAndOffset = calStrokeOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][1] = strokeOpacityAndOffset.r;\n  textureOffset = strokeOpacityAndOffset.g;\n\n  vec2 strokeWidthAndOffset = calStrokeWidthAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][2] = strokeWidthAndOffset.r;\n  textureOffset = strokeWidthAndOffset.g;\n\n  vec4 textrueStroke = vec4(-1.0, -1.0, -1.0, -1.0);\n  if(hasStroke()) {\n    vec2 valueRPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    styleMappingMat[1][0] = pos2value(valueRPos, columnWidth, rowHeight); // R\n    textureOffset += 1.0;\n\n    vec2 valueGPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    styleMappingMat[1][1] = pos2value(valueGPos, columnWidth, rowHeight); // G\n    textureOffset += 1.0;\n\n    vec2 valueBPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    styleMappingMat[1][2] = pos2value(valueBPos, columnWidth, rowHeight); // B\n    textureOffset += 1.0;\n\n    vec2 valueAPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    styleMappingMat[1][3] = pos2value(valueAPos, columnWidth, rowHeight); // A\n    textureOffset += 1.0;\n  } else {\n    if(u_stroke_color == vec4(0.0)) {\n      styleMappingMat[1][0] = v_color.r;\n      styleMappingMat[1][1] = v_color.g;\n      styleMappingMat[1][2] = v_color.b;\n      styleMappingMat[1][3] = v_color.a;\n    } else {\n      styleMappingMat[1][0] = u_stroke_color.r;\n      styleMappingMat[1][1] = u_stroke_color.g;\n      styleMappingMat[1][2] = u_stroke_color.b;\n      styleMappingMat[1][3] = u_stroke_color.a;\n    }\n  }\n\n  vec2 textrueOffsets = vec2(0.0, 0.0);\n  if(hasOffsets()) {\n    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x\n    textureOffset += 1.0;\n\n    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x\n    textureOffset += 1.0;\n  } else {\n    textrueOffsets = u_offsets;\n  }\n\n  // cal style mapping\n\n  // unpack color(vec2)\n  v_color = a_Color;\nif(u_Size_Unit == 1) {\n    newSize = newSize  * u_PixelsPerMeter.z;\n  }\n\n   v_radius = newSize;\n\n  // anti-alias\n  //  float antialiased_blur = -max(u_blur, antialiasblur);\n  float antialiasblur = -max(2.0 / u_DevicePixelRatio / newSize, u_blur);\n\n  vec2 offset = (extrude.xy * (newSize + u_stroke_width) + textrueOffsets);\n  vec3 aPosition = a_Position;\n\n  offset = project_pixel(offset);\n  \n  // TODP: /abs(extrude.x) 是为了兼容地球模式\n  v_data = vec4(extrude.x/abs(extrude.x), extrude.y/abs(extrude.y), antialiasblur,shape_type);\n\n\n  // vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));\n  vec4 project_pos = project_position(vec4(aPosition.xy, 0.0, 1.0));\n  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));\n\n  float raisingHeight = u_raisingHeight;\n\n  if(u_heightfixed < 1.0) { // false\n    raisingHeight = project_pixel(u_raisingHeight);\n  } else {\n     if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {\n      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);\n      raisingHeight = u_raisingHeight * mapboxZoomScale;\n    }\n  }\n \n\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n    gl_Position =  u_Mvp * vec4(project_pos.xy + offset, raisingHeight, 1.0);\n  } else {\n    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, raisingHeight, 1.0));\n  }\n \n  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));\n\n  setPickingColor(a_PickingColor);\n}\n',Dnt=function(t){wZ(i,oet);var e,n,r=Rnt(i);function i(){return mZ(this,i),r.apply(this,arguments)}return gZ(i,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),e=t.opacity,n=void 0===e?1:e,r=t.strokeOpacity,i=void 0===r?1:r,o=t.strokeWidth,a=void 0===o?0:o,s=t.stroke,u=void 0===s?"rgba(0,0,0,0)":s,c=t.offsets,l=void 0===c?[0,0]:c,h=t.blend,f=t.blur,p=void 0===f?0:f,d=t.raisingHeight,m=void 0===d?0:d,v=t.heightfixed,g=void 0!==v&&v,y=t.unit,x=void 0===y?"pixel":y;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:n,strokeOpacity:i,strokeWidth:a,stroke:u,offsets:l})){this.judgeStyleAttributes({opacity:n,strokeOpacity:i,strokeWidth:a,stroke:u,offsets:l});var b=this.layer.getEncodedData(),_=this.calDataFrame(this.cellLength,b,this.cellProperties),w=_.data,S=_.width,M=_.height;this.rowCount=M,this.dataTexture=this.cellLength>0&&w.length>0?this.createTexture2D({flipY:!0,data:w,format:m4.LUMINANCE,type:m4.FLOAT,width:S,height:M}):this.createTexture2D({flipY:!0,data:[1],format:m4.LUMINANCE,type:m4.FLOAT,width:1,height:1})}return{u_raisingHeight:Number(m),u_heightfixed:Number(g),u_blur:p,u_additive:"additive"===h?1:0,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:hZ.isNumber(n)?n:1,u_stroke_opacity:hZ.isNumber(i)?i:1,u_stroke_width:hZ.isNumber(a)?a:1,u_stroke_color:this.getStrokeColor(u),u_Size_Unit:eet[x],u_offsets:this.isOffsetStatic(l)?l:[0,0]}}},{key:"getAnimateUniforms",value:function(){var t=this.layer.getLayerConfig().animateOption,e=void 0===t?{enable:!1}:t;return{u_animate:this.animateOption2Array(e),u_time:this.layer.getLayerAnimateTime()}}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),eQ)}},{key:"initModels",value:(n=RK(jK.mark((function t(){return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.buildModels();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"buildModels",value:(e=RK(jK.mark((function t(){var e,n,r,i,o,a,s,u,c,l,h,f,p,d,m,v;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.layer.getLayerConfig(),n=e.mask,r=void 0!==n&&n,i=e.maskInside,o=void 0===i||i,a=e.animateOption,s=void 0===a?{enable:!1}:a,u=e.workerEnabled,c=void 0!==u&&u,l=e.enablePicking,h=e.shape2d,f=this.getShaders(s),p=f.frag,d=f.vert,m=f.type,this.layer.triangulation=eQ,t.next=5,this.layer.buildLayerModel({moduleName:m,vertexShader:d,fragmentShader:p,triangulation:eQ,depth:{enable:!1},blend:this.getBlend(),stencil:PK(r,o),workerEnabled:c,workerOptions:{modelType:m,enablePicking:l,shape2d:h}});case 5:return v=t.sent,t.abrupt("return",[v]);case 7:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"getShaders",value:function(t){return t.enable?(t.type,{frag:Int,vert:Nnt,type:"pointWave"}):{frag:"uniform float u_additive;\n\nvarying mat4 styleMappingMat; // 传递从片元中传递的映射数据\n\nvarying vec4 v_data;\nvarying vec4 v_color;\nvarying float v_radius;\n\n#pragma include \"sdf_2d\"\n#pragma include \"picking\"\n\n\nvoid main() {\n  int shape = int(floor(v_data.w + 0.5));\n\n  vec4 textrueStroke = vec4(\n    styleMappingMat[1][0],\n    styleMappingMat[1][1],\n    styleMappingMat[1][2],\n    styleMappingMat[1][3]\n  );\n\n  float opacity = styleMappingMat[0][0];\n  float stroke_opacity = styleMappingMat[0][1];\n  float strokeWidth = styleMappingMat[0][2];\n  vec4 strokeColor = textrueStroke == vec4(0) ? v_color : textrueStroke;\n\n  lowp float antialiasblur = v_data.z;\n  float r = v_radius / (v_radius + strokeWidth);\n\n  float outer_df;\n  float inner_df;\n  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'\n  if (shape == 0) {\n    outer_df = sdCircle(v_data.xy, 1.0);\n    inner_df = sdCircle(v_data.xy, r);\n  } else if (shape == 1) {\n    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);\n    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);\n  } else if (shape == 2) {\n    outer_df = sdBox(v_data.xy, vec2(1.));\n    inner_df = sdBox(v_data.xy, vec2(r));\n  } else if (shape == 3) {\n    outer_df = sdPentagon(v_data.xy, 0.8);\n    inner_df = sdPentagon(v_data.xy, r * 0.8);\n  } else if (shape == 4) {\n    outer_df = sdHexagon(v_data.xy, 0.8);\n    inner_df = sdHexagon(v_data.xy, r * 0.8);\n  } else if (shape == 5) {\n    outer_df = sdOctogon(v_data.xy, 1.0);\n    inner_df = sdOctogon(v_data.xy, r);\n  } else if (shape == 6) {\n    outer_df = sdHexagram(v_data.xy, 0.52);\n    inner_df = sdHexagram(v_data.xy, r * 0.52);\n  } else if (shape == 7) {\n    outer_df = sdRhombus(v_data.xy, vec2(1.0));\n    inner_df = sdRhombus(v_data.xy, vec2(r));\n  } else if (shape == 8) {\n    outer_df = sdVesica(v_data.xy, 1.1, 0.8);\n    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);\n  }\n\n  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);\n\n  float color_t = strokeWidth < 0.01 ? 0.0 : smoothstep(\n    antialiasblur,\n    0.0,\n    inner_df\n  );\n\n  if(strokeWidth < 0.01) {\n    gl_FragColor = vec4(v_color.rgb, v_color.a * opacity);\n  } else {\n    gl_FragColor = mix(vec4(v_color.rgb, v_color.a * opacity), strokeColor * stroke_opacity, color_t);\n  }\n\n  if(u_additive > 0.0) {\n    gl_FragColor *= opacity_t;\n    gl_FragColor = filterColorAlpha(gl_FragColor, gl_FragColor.a);\n  } else {\n    gl_FragColor.a *= opacity_t;\n    gl_FragColor = filterColor(gl_FragColor);\n  }\n}\n",vert:Nnt,type:"pointFill"}}},{key:"clearModels",value:function(){var t;null===(t=this.dataTexture)||void 0===t||t.destroy()}},{key:"animateOption2Array",value:function(t){return[t.enable?0:1,t.speed||1,t.rings||3,0]}},{key:"registerBuiltinAttributes",value:function(){var t=this.layer.getLayerConfig().shape2d;this.styleAttributeService.registerStyleAttribute({name:"extrude",type:d8.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:m4.DYNAMIC_DRAW,data:[],type:m4.FLOAT},size:3,update:function(t,e,n,r){var i=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],o=r%4*3;return[i[o],i[o+1],i[o+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:d8.Attribute,descriptor:{name:"a_Size",buffer:{usage:m4.DYNAMIC_DRAW,data:[],type:m4.FLOAT},size:1,update:function(t){var e=t.size,n=void 0===e?5:e;return Array.isArray(n)?[n[0]]:[n]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:d8.Attribute,descriptor:{name:"a_Shape",buffer:{usage:m4.DYNAMIC_DRAW,data:[],type:m4.FLOAT},size:1,update:function(e){var n=e.shape,r=void 0===n?2:n;return[t.indexOf(r)]}}})}}]),i}();function Fnt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var jnt=function(t){wZ(i,oet);var e,n,r=Fnt(i);function i(){var t;mZ(this,i);for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return $q(SZ(t=r.call.apply(r,[this].concat(n))),"meter2coord",1),$q(SZ(t),"isMeter",!1),$q(SZ(t),"radian",0),$q(SZ(t),"updateTexture",(function(){var e=t.rendererService.createTexture2D;if(t.texture)return t.texture.update({data:t.iconService.getCanvas(),mag:"linear",min:"linear mipmap nearest",mipmap:!0}),void t.layerService.throttleRenderLayers();t.texture=e({data:t.iconService.getCanvas(),mag:m4.LINEAR,min:m4.LINEAR_MIPMAP_LINEAR,premultiplyAlpha:!1,width:1024,height:t.iconService.canvasHeight||128,mipmap:!0})})),t}return gZ(i,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),e=t.opacity,n=void 0===e?1:e,r=t.offsets,i=void 0===r?[0,0]:r,o=t.rotation,a=t.raisingHeight,s=void 0===a?0:a,u=t.heightfixed,c=void 0!==u&&u,l=t.unit,h=void 0===l?"pixel":l;this.rendererService.getDirty()&&this.texture.bind();var f=1;if("GAODE2.x"!==this.mapService.version&&"GAODE1.x"!==this.mapService.version||(f=-1),this.radian=void 0!==o?f*Math.PI*o/180:f*Math.PI*(this.mapService.getRotation()%360)/180,this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:n,offsets:i})){this.judgeStyleAttributes({opacity:n,offsets:i});var p=this.layer.getEncodedData(),d=this.calDataFrame(this.cellLength,p,this.cellProperties),m=d.data,v=d.width,g=d.height;this.rowCount=g,this.dataTexture=this.cellLength>0&&m.length>0?this.createTexture2D({flipY:!0,data:m,format:m4.LUMINANCE,type:m4.FLOAT,width:v,height:g}):this.createTexture2D({flipY:!0,data:[1],format:m4.LUMINANCE,type:m4.FLOAT,width:1,height:1})}return{u_raisingHeight:Number(s),u_heightfixed:Number(c),u_Size_Unit:eet[h],u_RotateMatrix:new Float32Array([Math.cos(this.radian),Math.sin(this.radian),-Math.sin(this.radian),Math.cos(this.radian)]),u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128],u_opacity:hZ.isNumber(n)?n:1,u_offsets:this.isOffsetStatic(i)?i:[0,0]}}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),Iet)}},{key:"initModels",value:(n=RK(jK.mark((function t(){return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.iconService.on("imageUpdate",this.updateTexture),this.updateTexture(),t.next=4,this.buildModels();case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"buildModels",value:(e=RK(jK.mark((function t(){var e,n,r,i,o,a;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.layer.getLayerConfig(),n=e.mask,r=void 0!==n&&n,i=e.maskInside,o=void 0===i||i,t.next=3,this.layer.buildLayerModel({moduleName:"pointFillImage",vertexShader:'attribute vec4 a_Color;\nattribute vec3 a_Position;\nattribute vec3 a_Extrude;\nattribute float a_Size;\nattribute vec2 a_Uv;\nattribute float a_Rotate;\n\nvarying mat4 styleMappingMat; // 用于将在顶点着色器中计算好的样式值传递给片元\n\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\nuniform mat2 u_RotateMatrix;\nuniform int u_Size_Unit;\n\nvarying vec2 v_uv; // 本身的 uv 坐标\nvarying vec2 v_Iconuv; // icon 贴图的 uv 坐标\n\nuniform float u_raisingHeight: 0.0;\nuniform float u_heightfixed: 0.0;\nuniform float u_opacity : 1;\nuniform vec2 u_offsets;\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n\n#pragma include "projection"\n#pragma include "picking"\n\nvoid main() {\n  vec3 extrude = a_Extrude;\n\n  v_uv = (a_Extrude.xy + 1.0)/2.0;\n  v_uv.y = 1.0 - v_uv.y;\n  v_Iconuv = a_Uv;\n\n  // cal style mapping - 数据纹理映射部分的计算\n  styleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - empty - empty - empty\n    0.0, 0.0, 0.0, 0.0, // empty - empty - empty - empty\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // 当前的数据纹理有几行\n  float columnCount = u_cellTypeLayout[0][1]; // 当看到数据纹理有几列\n  float columnWidth = 1.0/columnCount;  // 列宽\n  float rowHeight = 1.0/rowCount;       // 行高\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // 第n个顶点\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // 起始点在第几行\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // 起始点在第几列\n  \n  // cell 固定顺序 opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // 按顺序从 cell 中取值、若没有则自动往下取值\n  float textureOffset = 0.0; // 在 cell 中取值的偏移量\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n\n  vec2 textrueOffsets = vec2(0.0, 0.0);\n  if(hasOffsets()) {\n    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x\n    textureOffset += 1.0;\n\n    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x\n    textureOffset += 1.0;\n  } else {\n    textrueOffsets = u_offsets;\n  }\n\n  // cal style mapping\n\n  highp float angle_sin = sin(a_Rotate);\n  highp float angle_cos = cos(a_Rotate);\n  mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);\n  float newSize = a_Size;\n  if(u_Size_Unit == 1) {\n    newSize = newSize  * u_PixelsPerMeter.z;\n  }\n\n  // vec2 offset = (u_RotateMatrix * extrude.xy * (a_Size) + textrueOffsets);\n  vec2 offset = (rotation_matrix * u_RotateMatrix * extrude.xy * (newSize) + textrueOffsets);\n  vec3 aPosition = a_Position;\n\n  offset = project_pixel(offset);\n\n  vec4 project_pos = project_position(vec4(aPosition.xy, 0.0, 1.0));\n  float raisingHeight = u_raisingHeight;\n  if(u_heightfixed < 1.0) { // height fixed\n    raisingHeight = project_pixel(u_raisingHeight);\n  } else {\n    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {\n      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);\n      raisingHeight = u_raisingHeight * mapboxZoomScale;\n    }\n  }\n\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n    gl_Position = u_Mvp *vec4(project_pos.xy + offset, raisingHeight, 1.0);\n  } else {\n    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, raisingHeight, 1.0));\n  }\n \n  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));\n\n  setPickingColor(a_PickingColor);\n}\n',fragmentShader:'uniform sampler2D u_texture;\nuniform vec2 u_textSize;\n\nvarying mat4 styleMappingMat; // 传递从片元中传递的映射数据\n\n#pragma include "sdf_2d"\n#pragma include "picking"\nvarying vec2 v_uv; // 本身的 uv 坐标\nvarying vec2 v_Iconuv;\n\nvoid main() {\n\n  float opacity = styleMappingMat[0][0];\n\n  vec2 pos = v_Iconuv / u_textSize + v_uv / u_textSize * 64.;\n  gl_FragColor = texture2D(u_texture, pos);\n  gl_FragColor.a *= opacity;\n\n  gl_FragColor = filterColor(gl_FragColor);\n}\n',triangulation:Iet,depth:{enable:!1},blend:this.getBlend(),stencil:PK(r,o),cull:{enable:!0,face:xQ(this.mapService.version)}});case 3:return a=t.sent,t.abrupt("return",[a]);case 5:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"clearModels",value:function(){var t,e;this.iconService.off("imageUpdate",this.updateTexture),null===(t=this.texture)||void 0===t||t.destroy(),null===(e=this.dataTexture)||void 0===e||e.destroy()}},{key:"registerBuiltinAttributes",value:function(){var t=this;this.styleAttributeService.registerStyleAttribute({name:"rotate",type:d8.Attribute,descriptor:{name:"a_Rotate",buffer:{usage:m4.DYNAMIC_DRAW,data:[],type:m4.FLOAT},size:1,update:function(t){var e=t.rotate,n=void 0===e?0:e;return Array.isArray(n)?[n[0]]:[n]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:d8.Attribute,descriptor:{name:"a_Uv",buffer:{usage:m4.DYNAMIC_DRAW,data:[],type:m4.FLOAT},size:2,update:function(e){var n=t.iconService.getIconMap()[e.shape]||{x:0,y:0};return[n.x,n.y]}}}),this.styleAttributeService.registerStyleAttribute({name:"extrude",type:d8.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:m4.DYNAMIC_DRAW,data:[],type:m4.FLOAT},size:3,update:function(t,e,n,r){var i=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],o=r%4*3;return[i[o],i[o+1],i[o+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:d8.Attribute,descriptor:{name:"a_Size",buffer:{usage:m4.DYNAMIC_DRAW,data:[],type:m4.FLOAT},size:1,update:function(t){var e=t.size,n=void 0===e?5:e;return Array.isArray(n)?[n[0]]:[n]}}})}}]),i}();function Bnt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var znt=function(t){wZ(i,oet);var e,n,r=Bnt(i);function i(){var t;mZ(this,i);for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return $q(SZ(t=r.call.apply(r,[this].concat(n))),"updateTexture",(function(){var e=t.rendererService.createTexture2D;if(t.texture)return t.texture.update({data:t.iconService.getCanvas(),mag:"linear",min:"linear mipmap nearest",mipmap:!0}),void setTimeout((function(){t.layerService.throttleRenderLayers()}));t.texture=e({data:t.iconService.getCanvas(),mag:m4.LINEAR,min:m4.LINEAR_MIPMAP_LINEAR,premultiplyAlpha:!1,width:1024,height:t.iconService.canvasHeight||128,mipmap:!0})})),t}return gZ(i,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),e=t.opacity,n=void 0===e?1:e,r=t.offsets,i=void 0===r?[0,0]:r,o=t.raisingHeight,a=void 0===o?0:o,s=t.heightfixed,u=void 0!==s&&s;if(this.rendererService.getDirty()&&this.texture.bind(),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:n,offsets:i})){this.judgeStyleAttributes({opacity:n,offsets:i});var c=this.layer.getEncodedData(),l=this.calDataFrame(this.cellLength,c,this.cellProperties),h=l.data,f=l.width,p=l.height;this.rowCount=p,this.dataTexture=this.cellLength>0&&h.length>0?this.createTexture2D({flipY:!0,data:h,format:m4.LUMINANCE,type:m4.FLOAT,width:f,height:p}):this.createTexture2D({flipY:!0,data:[1],format:m4.LUMINANCE,type:m4.FLOAT,width:1,height:1})}return{u_raisingHeight:Number(a),u_heightfixed:Number(u),u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128],u_opacity:hZ.isNumber(n)?n:1,u_offsets:this.isOffsetStatic(i)?i:[0,0]}}},{key:"initModels",value:(n=RK(jK.mark((function t(){return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.iconService.on("imageUpdate",this.updateTexture),this.updateTexture(),t.next=4,this.buildModels();case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"clearModels",value:function(){var t,e;null===(t=this.texture)||void 0===t||t.destroy(),null===(e=this.dataTexture)||void 0===e||e.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:(e=RK(jK.mark((function t(){var e,n,r,i,o,a;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.layer.getLayerConfig(),n=e.mask,r=void 0!==n&&n,i=e.maskInside,o=void 0===i||i,t.next=3,this.layer.buildLayerModel({moduleName:"pointImage",vertexShader:'precision highp float;\nattribute vec3 a_Position;\nattribute vec4 a_Color;\nattribute vec2 a_Uv;\nattribute float a_Size;\nvarying vec4 v_color;\nvarying vec2 v_uv;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\nuniform vec2 u_offsets;\n\nuniform float u_opacity : 1;\nuniform float u_raisingHeight: 0.0;\nuniform float u_heightfixed: 0.0;\n\nvarying mat4 styleMappingMat; // 用于将在顶点着色器中计算好的样式值传递给片元\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n\n#pragma include "projection"\n#pragma include "picking"\n\nvoid main() {\n  // cal style mapping - 数据纹理映射部分的计算\n  styleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // 当前的数据纹理有几行\n  float columnCount = u_cellTypeLayout[0][1]; // 当看到数据纹理有几列\n  float columnWidth = 1.0/columnCount;  // 列宽\n  float rowHeight = 1.0/rowCount;       // 行高\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // 第n个顶点\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // 起始点在第几行\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // 起始点在第几列\n  \n  // cell 固定顺序 opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // 按顺序从 cell 中取值、若没有则自动往下取值\n  float textureOffset = 0.0; // 在 cell 中取值的偏移量\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n\n  styleMappingMat[1][0] = a_Size;\n\n  vec2 textrueOffsets = vec2(0.0, 0.0);\n  if(hasOffsets()) {\n    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x\n    textureOffset += 1.0;\n\n    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x\n    textureOffset += 1.0;\n  } else {\n    textrueOffsets = u_offsets;\n  }\n\n  // cal style mapping - 数据纹理映射部分的计算\n  v_color = a_Color;\n  v_uv = a_Uv;\n  vec4 project_pos = project_position(vec4(a_Position, 1.0));\n   \n  vec2 offset = project_pixel(textrueOffsets);\n\n  float raisingHeight = u_raisingHeight;\n  if(u_heightfixed < 1.0) { // false\n    raisingHeight = project_pixel(u_raisingHeight);\n  } else {\n     if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {\n      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);\n      raisingHeight = u_raisingHeight * mapboxZoomScale;\n    }\n  }\n\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n    gl_Position = u_Mvp * vec4(project_pos.xy + offset, raisingHeight, 1.0);\n  } else {\n    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, raisingHeight, 1.0));\n  }\n\n  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;\n  setPickingColor(a_PickingColor);\n}\n',fragmentShader:'\nuniform sampler2D u_texture;\nvarying vec4 v_color;\nvarying vec2 v_uv;\nuniform vec2 u_textSize;\nuniform float u_opacity : 1;\n\nvarying mat4 styleMappingMat; // 传递从片元中传递的映射数据\n\n#pragma include "picking"\n\nvoid main(){\n      float opacity = styleMappingMat[0][0];\n      float size = styleMappingMat[1][0];\n      vec2 pos = v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;\n      vec4 textureColor;\n\n      // Y = 0.299R + 0.587G + 0.114B // 亮度提取\n     \n      textureColor = texture2D(u_texture, pos);\n\n      // Tip: 去除边缘部分 mipmap 导致的混合变暗\n      float fragmengTocenter = distance(vec2(0.5), gl_PointCoord);\n      if(fragmengTocenter >= 0.5) {\n            float luma = 0.299 * textureColor.r + 0.587 * textureColor.g + 0.114 * textureColor.b;\n            textureColor.a *= luma;\n      }\n      \n      \n\n      if(all(lessThan(v_color, vec4(1.0+0.00001))) && all(greaterThan(v_color, vec4(1.0-0.00001))) || v_color==vec4(1.0)){\n            gl_FragColor= textureColor;\n      }else {\n            gl_FragColor= step(0.01, textureColor.z) * v_color;\n      }\n\n      gl_FragColor.a = gl_FragColor.a * opacity;\n      gl_FragColor = filterColor(gl_FragColor);\n}\n',triangulation:Fet,depth:{enable:!1},primitive:m4.POINTS,blend:this.getBlend(),stencil:PK(r,o)});case 3:return a=t.sent,t.abrupt("return",[a]);case 5:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"registerBuiltinAttributes",value:function(){var t=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:d8.Attribute,descriptor:{name:"a_Size",buffer:{usage:m4.DYNAMIC_DRAW,data:[],type:m4.FLOAT},size:1,update:function(t){var e=t.size,n=void 0===e?5:e;return Array.isArray(n)?[n[0]]:[n]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:d8.Attribute,descriptor:{name:"a_Uv",buffer:{usage:m4.DYNAMIC_DRAW,data:[],type:m4.FLOAT},size:2,update:function(e){var n=t.iconService.getIconMap()[e.shape]||{x:0,y:0};return[n.x,n.y]}}})}}]),i}();function Unt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}function Vnt(t){var e=t.coordinates;return{vertices:Xq(e),indices:[0],size:e.length}}var Gnt=function(t){wZ(i,oet);var e,n,r=Unt(i);function i(){return mZ(this,i),r.apply(this,arguments)}return gZ(i,[{key:"getDefaultStyle",value:function(){return{blend:"additive"}}},{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig().opacity,e=void 0===t?1:t;return{u_opacity:hZ.isNumber(e)?e:1}}},{key:"initModels",value:(n=RK(jK.mark((function t(){return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.buildModels();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"buildModels",value:(e=RK(jK.mark((function t(){var e,n,r,i,o,a;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.layer.getLayerConfig(),n=e.mask,r=void 0!==n&&n,i=e.maskInside,o=void 0===i||i,this.layer.triangulation=Vnt,t.next=4,this.layer.buildLayerModel({moduleName:"pointNormal",vertexShader:'\nattribute vec3 a_Position;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\nattribute float a_Size;\nattribute vec4 a_Color;\n\nvarying vec4 v_color;\n\n#pragma include "projection"\n#pragma include "project"\n\nvoid main() {\n  v_color = a_Color;\n\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n    gl_Position = u_Mvp * vec4(a_Position.xy, a_Position.z, 1.0);\n  } else {\n    vec4 project_pos = project_position(vec4(a_Position, 1.0)) + vec4(a_Size / 2.,-a_Size /2.,0.,0.);\n    gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy),project_pos.z,project_pos.w));\n  }\n\n  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;\n}\n',fragmentShader:"uniform float u_opacity : 1;\nvarying vec4 v_color;\nvoid main() {\n  gl_FragColor = v_color;\n  gl_FragColor.a *= u_opacity;\n}\n",triangulation:Vnt,depth:{enable:!1},primitive:m4.POINTS,blend:this.getBlend(),stencil:PK(r,o),pick:!1});case 4:return a=t.sent,t.abrupt("return",[a]);case 6:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"clearModels",value:function(){}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:d8.Attribute,descriptor:{name:"a_Size",buffer:{usage:m4.DYNAMIC_DRAW,data:[],type:m4.FLOAT},size:1,update:function(t){var e=t.size,n=void 0===e?1:e;return Array.isArray(n)?[n[0]]:[n]}}})}}]),i}();function Wnt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var Hnt=function(t){wZ(i,oet);var e,n,r=Wnt(i);function i(){return mZ(this,i),r.apply(this,arguments)}return gZ(i,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),e=t.opacity,n=void 0===e?1:e,r=t.blend,i=t.speed,o=void 0===i?1:i,a=t.unit;return{u_Size_Unit:eet[void 0===a?"pixel":a],u_speed:o,u_additive:"additive"===r?1:0,u_opacity:hZ.isNumber(n)?n:1}}},{key:"getAnimateUniforms",value:function(){var t=this.layer.getLayerConfig().animateOption,e=void 0===t?{enable:!1}:t;return{u_animate:this.animateOption2Array(e),u_time:this.layer.getLayerAnimateTime()}}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),Iet)}},{key:"initModels",value:(n=RK(jK.mark((function t(){return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.buildModels();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"buildModels",value:(e=RK(jK.mark((function t(){var e,n,r,i,o,a;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.layer.getLayerConfig(),n=e.mask,r=void 0!==n&&n,i=e.maskInside,o=void 0===i||i,t.next=3,this.layer.buildLayerModel({moduleName:"pointRadar",vertexShader:'attribute vec4 a_Color;\nattribute vec3 a_Position;\nattribute vec3 a_Extrude;\nattribute float a_Size;\nuniform float u_speed: 1.0;\nuniform float u_time;\n\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\nuniform int u_Size_Unit;\n\nvarying vec4 v_data;\nvarying vec4 v_color;\nvarying float v_radius;\nvarying vec2 v_exteude;\n\n#pragma include "projection"\n#pragma include "picking"\n\nvoid main() {\n  vec3 extrude = a_Extrude;\n  float newSize = setPickingSize(a_Size);\n\n  float time = u_time * u_speed;\n  mat2 rotateMatrix = mat2( \n    cos(time), sin(time), \n    -sin(time), cos(time)\n  );\n  v_exteude = rotateMatrix * a_Extrude.xy;\n\n  // unpack color(vec2)\n  v_color = a_Color;\n\n\n\n  // anti-alias\n  float blur = 0.0;\n  float antialiasblur = -max(2.0 / u_DevicePixelRatio / a_Size, blur);\n\n  if(u_Size_Unit == 1) {\n    newSize = newSize  * u_PixelsPerMeter.z;\n  }\n  // radius(16-bit)\n  v_radius = newSize;\n\n  vec2 offset = (extrude.xy * (newSize));\n  vec3 aPosition = a_Position;\n  \n    // 不以米为实际单位\n  offset = project_pixel(offset);\n  \n  v_data = vec4(extrude.x, extrude.y, antialiasblur, -1.0);\n\n  vec4 project_pos = project_position(vec4(aPosition.xy, 0.0, 1.0));\n\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n    gl_Position = u_Mvp *vec4(project_pos.xy + offset, 0.0, 1.0);\n  } else {\n    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));\n  }\n\n  setPickingColor(a_PickingColor);\n}\n',fragmentShader:'\nuniform float u_additive;\nuniform float u_opacity: 1.0;\n\nvarying vec4 v_data;\nvarying vec4 v_color;\nvarying float v_radius;\nvarying vec2 v_exteude;\n#pragma include "sdf_2d"\n#pragma include "picking"\n\nvoid main() {\n\n  lowp float antialiasblur = v_data.z;\n  float r = v_radius / (v_radius);\n\n  float outer_df = sdCircle(v_data.xy, 1.0);\n  float inner_df = sdCircle(v_data.xy, r);\n\n  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);\n\n  gl_FragColor = vec4(v_color.rgb, v_color.a * u_opacity);\n\n  if(u_additive > 0.0) {\n    gl_FragColor *= opacity_t;\n  } else {\n    gl_FragColor.a *= opacity_t;\n  }\n\n  if(gl_FragColor.a > 0.0) {\n    gl_FragColor = filterColor(gl_FragColor);\n  }\n\n  vec2 extrude =  v_exteude;\n  vec2 dir = normalize(extrude);\n  vec2 baseDir = vec2(1.0, 0.0);\n  float pi = 3.14159265359;\n  // full circle\n  // float rades = dot(dir, baseDir);\n  // float flag = sign(dir.y);\n  // float radar_v = (flag - 1.0) * -0.5 + flag * acos(rades)/pi/2.0;\n  \n  // half circle\n  float flag = sign(dir.y);\n  float rades = dot(dir, baseDir);\n  float radar_v = (flag - 1.0) * -0.5 * acos(rades)/pi;\n  // simple AA\n  if(radar_v > 0.99) {\n    radar_v = 1.0 - (radar_v - 0.99)/0.01;\n  }\n\n  gl_FragColor.a *= radar_v;\n}\n',triangulation:Iet,depth:{enable:!1},blend:this.getBlend(),stencil:PK(r,o)});case 3:return a=t.sent,t.abrupt("return",[a]);case 5:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"clearModels",value:function(){var t;null===(t=this.dataTexture)||void 0===t||t.destroy()}},{key:"animateOption2Array",value:function(t){return[t.enable?0:1,t.speed||1,t.rings||3,0]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"extrude",type:d8.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:m4.DYNAMIC_DRAW,data:[],type:m4.FLOAT},size:3,update:function(t,e,n,r){var i=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],o=r%4*3;return[i[o],i[o+1],i[o+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:d8.Attribute,descriptor:{name:"a_Size",buffer:{usage:m4.DYNAMIC_DRAW,data:[],type:m4.FLOAT},size:1,update:function(t){var e=t.size,n=void 0===e?5:e;return Array.isArray(n)?[n[0]]:[n]}}})}}]),i}();function Ynt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}function Xnt(t){var e=t.coordinates;return{vertices:Xq(e),indices:[0],size:e.length}}var qnt=function(t){wZ(i,oet);var e,n,r=Ynt(i);function i(){return mZ(this,i),r.apply(this,arguments)}return gZ(i,[{key:"getDefaultStyle",value:function(){return{blend:"additive"}}},{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),e=t.opacity,n=void 0===e?1:e,r=t.offsets,i=void 0===r?[0,0]:r,o=t.blend,a=t.strokeOpacity,s=void 0===a?1:a,u=t.strokeWidth,c=void 0===u?0:u,l=t.stroke,h=void 0===l?"#fff":l;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:n,offsets:i})){this.judgeStyleAttributes({opacity:n,offsets:i});var f=this.layer.getEncodedData(),p=this.calDataFrame(this.cellLength,f,this.cellProperties),d=p.data,m=p.width,v=p.height;this.rowCount=v,this.dataTexture=this.cellLength>0&&d.length>0?this.createTexture2D({flipY:!0,data:d,format:m4.LUMINANCE,type:m4.FLOAT,width:m,height:v}):this.createTexture2D({flipY:!0,data:[1],format:m4.LUMINANCE,type:m4.FLOAT,width:1,height:1})}return{u_additive:"additive"===o?1:0,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:hZ.isNumber(n)?n:1,u_offsets:this.isOffsetStatic(i)?i:[0,0],u_stroke_opacity:hZ.isNumber(s)?s:1,u_stroke_width:hZ.isNumber(c)?c:1,u_stroke_color:this.getStrokeColor(h)}}},{key:"initModels",value:(n=RK(jK.mark((function t(){return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.buildModels();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"buildModels",value:(e=RK(jK.mark((function t(){var e,n,r,i,o,a;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.layer.getLayerConfig(),n=e.mask,r=void 0!==n&&n,i=e.maskInside,o=void 0===i||i,this.layer.triangulation=Xnt,t.next=4,this.layer.buildLayerModel({moduleName:"pointSimple",vertexShader:'\nattribute vec3 a_Position;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\nattribute float a_Size;\nattribute vec4 a_Color;\nvarying vec4 v_color;\n\nuniform float u_opacity : 1;\nuniform vec2 u_offsets;\nuniform float u_stroke_width;\n\nvarying mat4 styleMappingMat; // 用于将在顶点着色器中计算好的样式值传递给片元\nvarying float v_blur;\nvarying float v_innerRadius;\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n\n#pragma include "projection"\n#pragma include "picking"\n#pragma include "project"\nvoid main() {\n  v_color = a_Color;\n  v_blur = 1.0 - max(2.0/a_Size, 0.05);\n  v_innerRadius = max((a_Size - u_stroke_width) / a_Size, 0.0);\n\n  // cal style mapping - 数据纹理映射部分的计算\nstyleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // 当前的数据纹理有几行\n  float columnCount = u_cellTypeLayout[0][1]; // 当看到数据纹理有几列\n  float columnWidth = 1.0/columnCount;  // 列宽\n  float rowHeight = 1.0/rowCount;       // 行高\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // 第n个顶点\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // 起始点在第几行\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // 起始点在第几列\n  \n  // cell 固定顺序 opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // 按顺序从 cell 中取值、若没有则自动往下取值\n  float textureOffset = 0.0; // 在 cell 中取值的偏移量\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n\n  vec2 textrueOffsets = vec2(0.0, 0.0);\n  if(hasOffsets()) {\n    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x\n    textureOffset += 1.0;\n\n    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x\n    textureOffset += 1.0;\n  } else {\n    textrueOffsets = u_offsets;\n  }\n\n  // cal style mapping\n  \n  vec2 offset = project_pixel(textrueOffsets);\n  \n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n    gl_Position = u_Mvp * vec4(a_Position.xy + offset, a_Position.z, 1.0);\n  } else { // else\n    vec4 project_pos = project_position(vec4(a_Position, 1.0)) + vec4(a_Size / 2.,-a_Size /2.,0.,0.);\n    gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy+offset),project_pos.z,project_pos.w));\n  }\n\n  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;\n  setPickingColor(a_PickingColor);\n}\n',fragmentShader:'\nuniform float u_opacity : 1;\nuniform vec2 u_offsets;\nuniform float u_additive;\n\nuniform float u_stroke_opacity : 1;\n\nuniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];\n\nvarying vec4 v_color;\nvarying mat4 styleMappingMat; // 传递从片元中传递的映射数据\nvarying float v_blur;\nvarying float v_innerRadius;\n\n#pragma include "picking"\nvoid main() {\n  vec2 center = vec2(0.5);\n\n  float opacity = styleMappingMat[0][0];\n  // Tip: 片元到中心点的距离 0 - 1\n  float fragmengTocenter = distance(center, gl_PointCoord) * 2.0;\n  // Tip: 片元的剪切成圆形\n  float circleClipOpacity = 1.0 - smoothstep(v_blur, 1.0, fragmengTocenter);\n\n\n  if(v_innerRadius < 0.99) {\n    // 当存在 stroke 且 stroke > 0.01\n    float blurWidth = (1.0 - v_blur)/2.0;\n    vec4 stroke = vec4(u_stroke_color.rgb, u_stroke_opacity);\n    if(fragmengTocenter > v_innerRadius + blurWidth) {\n      gl_FragColor = stroke;\n    } else if(fragmengTocenter > v_innerRadius - blurWidth){\n      float mixR = (fragmengTocenter - (v_innerRadius - blurWidth)) / (blurWidth * 2.0);\n      gl_FragColor = mix(v_color, stroke, mixR);\n    } else {\n      gl_FragColor = v_color;\n    }\n  } else {\n    // 当不存在 stroke 或 stroke <= 0.01\n    gl_FragColor = v_color;\n  }\n\n  gl_FragColor.a *= opacity;\n\n  gl_FragColor = filterColor(gl_FragColor);\n  \n  if(u_additive > 0.0) {\n    gl_FragColor *= circleClipOpacity;\n  } else {\n    gl_FragColor.a *= circleClipOpacity;\n  }\n\n}\n',triangulation:Xnt,depth:{enable:!1},primitive:m4.POINTS,blend:this.getBlend(),stencil:PK(r,o)});case 4:return a=t.sent,t.abrupt("return",[a]);case 6:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"clearModels",value:function(){var t;null===(t=this.dataTexture)||void 0===t||t.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:d8.Attribute,descriptor:{name:"a_Size",buffer:{usage:m4.DYNAMIC_DRAW,data:[],type:m4.FLOAT},size:1,update:function(t){var e=t.size,n=void 0===e?1:e;return Array.isArray(n)?[n[0]]:[n]}}})}}]),i}();function Znt(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return $nt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $nt(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function $nt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var Knt=function(){function t(e,n,r){mZ(this,t),$q(this,"boxCells",[]);var i=this.boxCells;this.xCellCount=Math.ceil(e/r),this.yCellCount=Math.ceil(n/r);for(var o=0;o<this.xCellCount*this.yCellCount;o++)i.push([]);this.boxKeys=[],this.bboxes=[],this.width=e,this.height=n,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/n,this.boxUid=0}return gZ(t,[{key:"insert",value:function(t,e,n,r,i){this.forEachCell(e,n,r,i,this.insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(e),this.bboxes.push(n),this.bboxes.push(r),this.bboxes.push(i)}},{key:"query",value:function(t,e,n,r,i){return this.queryHitTest(t,e,n,r,!1,i)}},{key:"hitTest",value:function(t,e,n,r,i){return this.queryHitTest(t,e,n,r,!0,i)}},{key:"insertBoxCell",value:function(t,e,n,r,i,o){this.boxCells[i].push(o)}},{key:"queryHitTest",value:function(t,e,n,r,i,o){if(n<0||t>this.width||r<0||e>this.height)return!i&&[];var a=[];if(t<=0&&e<=0&&this.width<=n&&this.height<=r){if(i)return!0;for(var s=0;s<this.boxKeys.length;s++)a.push({key:this.boxKeys[s],x1:this.bboxes[4*s],y1:this.bboxes[4*s+1],x2:this.bboxes[4*s+2],y2:this.bboxes[4*s+3]});return o?a.filter(o):a}var u={hitTest:i,seenUids:{box:{},circle:{}}};return this.forEachCell(t,e,n,r,this.queryCell,a,u,o),i?a.length>0:a}},{key:"queryCell",value:function(t,e,n,r,i,o,a,s){var u=a.seenUids,c=this.boxCells[i];if(null!==c){var l,h=this.bboxes,f=Znt(c);try{for(f.s();!(l=f.n()).done;){var p=l.value;if(!u.box[p]){u.box[p]=!0;var d=4*p;if(t<=h[d+2]&&e<=h[d+3]&&n>=h[d+0]&&r>=h[d+1]&&(!s||s(this.boxKeys[p]))){if(a.hitTest)return o.push(!0),!0;o.push({key:this.boxKeys[p],x1:h[d],y1:h[d+1],x2:h[d+2],y2:h[d+3]})}}}}catch(m){f.e(m)}finally{f.f()}}return!1}},{key:"forEachCell",value:function(t,e,n,r,i,o,a,s){for(var u=this.convertToXCellCoord(t),c=this.convertToYCellCoord(e),l=this.convertToXCellCoord(n),h=this.convertToYCellCoord(r),f=u;f<=l;f++)for(var p=c;p<=h;p++){var d=this.xCellCount*p+f;if(i.call(this,t,e,n,r,d,o,a,s))return}}},{key:"convertToXCellCoord",value:function(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}},{key:"convertToYCellCoord",value:function(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}}]),t}();const Jnt=Knt;var Qnt=function(){function t(e,n){mZ(this,t),$q(this,"viewportPadding",100),this.width=e,this.height=n,this.viewportPadding=Math.max(e,n),this.grid=new Jnt(e+this.viewportPadding,n+this.viewportPadding,25),this.screenRightBoundary=e+this.viewportPadding,this.screenBottomBoundary=n+this.viewportPadding,this.gridRightBoundary=e+2*this.viewportPadding,this.gridBottomBoundary=n+2*this.viewportPadding}return gZ(t,[{key:"placeCollisionBox",value:function(t){var e=t.x1+t.anchorPointX+this.viewportPadding,n=t.y1+t.anchorPointY+this.viewportPadding,r=t.x2+t.anchorPointX+this.viewportPadding,i=t.y2+t.anchorPointY+this.viewportPadding;return!this.isInsideGrid(e,n,r,i)||this.grid.hitTest(e,n,r,i)?{box:[]}:{box:[e,n,r,i]}}},{key:"insertCollisionBox",value:function(t,e){var n={featureIndex:e};this.grid.insert(n,t[0],t[1],t[2],t[3])}},{key:"project",value:function(t,e,n){var r=xa(e,n,0,1),i=ya();return ba(i,r,oo.apply(No,Xq(t))),{x:(i[0]/i[3]+1)/2*this.width+this.viewportPadding,y:(-i[1]/i[3]+1)/2*this.height+this.viewportPadding}}},{key:"isInsideGrid",value:function(t,e,n,r){return n>=0&&t<this.gridRightBoundary&&r>=0&&e<this.gridBottomBoundary}}]),t}();function trt(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return ert(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ert(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function ert(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function nrt(t){var e=.5,n=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0;break;default:e=.5}switch(t){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0;break;default:n=.5}return{horizontalAlign:e,verticalAlign:n}}function rrt(t,e,n,r,i){if(i){var o=t[r],a=o.glyph;if(a)for(var s=e[a].advance*o.scale,u=(t[r].x+s)*i,c=n;c<=r;c++)t[c].x-=u}}function irt(t,e,n,r,i,o,a){var s,u=(e-n)*i,c=(-r*a+.5)*o,l=trt(t);try{for(l.s();!(s=l.n()).done;){var h=s.value;h.x+=u,h.y+=c}}catch(f){l.e(f)}finally{l.f()}}function ort(t,e,n,r,i,o,a){var s=0,u=-8,c=0,l=t.positionedGlyphs,h="right"===o?1:"left"===o?0:.5,f=l.length;n.forEach((function(t){if(t.split("").forEach((function(t){var n=e[t];n&&(l.push({glyph:t,x:s,y:u+0,vertical:!1,scale:1,metrics:n}),s+=n.advance+a)})),l.length!==f){var n=s-a;c=Math.max(n,c),rrt(l,e,f,l.length-1,h)}s=0,u-=r+5}));var p=nrt(i),d=p.horizontalAlign,m=p.verticalAlign;irt(l,h,d,m,c,r,n.length);var v=u- -8;t.top+=-m*v,t.bottom=t.top-v,t.left+=-d*c,t.right=t.left+c}function art(t,e,n,r,i,o,a){var s=0,u=-8,c=0,l=t.positionedGlyphs,h="right"===o?1:"left"===o?0:.5,f=l.length;n.forEach((function(t){var n=e[t];if(n&&(l.push({glyph:t,x:n.advance/2,y:u+0,vertical:!1,scale:1,metrics:n}),s+=n.advance+a),l.length!==f){var i=s-a;c=Math.max(i,c),rrt(l,e,f,l.length-1,h)}s=0,u-=r+5}));var p=nrt(i),d=p.horizontalAlign,m=p.verticalAlign;irt(l,h,d,m,c,r,n.length);var v=u- -8;t.top+=-m*v,t.bottom=t.top-v,t.left+=-d*c,t.right=t.left+c}function srt(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return urt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return urt(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function urt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function crt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var lrt='#define SDF_PX 8.0\n#define EDGE_GAMMA 0.105\n#define FONT_SIZE 48.0\nuniform sampler2D u_sdf_map;\nuniform float u_gamma_scale : 0.5;\n// uniform float u_font_size : 24.0;\nuniform float u_opacity : 1.0;\nuniform vec4 u_stroke_color : [0, 0, 0, 1];\nuniform float u_stroke_width : 2.0;\nuniform float u_halo_blur : 0.5;\nuniform float u_DevicePixelRatio;\n\nvarying vec4 v_color;\nvarying vec2 v_uv;\nvarying float v_gamma_scale;\nvarying float v_fontScale;\n\nvarying mat4 styleMappingMat; // 传递从片元中传递的映射数据\n\n#pragma include "picking"\nvoid main() {\n  // get style data mapping\n  float opacity = styleMappingMat[0][0];\n  float strokeWidth = styleMappingMat[0][2];\n  vec4 textrueStroke = vec4(\n    styleMappingMat[1][0],\n    styleMappingMat[1][1],\n    styleMappingMat[1][2],\n    styleMappingMat[1][3]\n  );\n\n  // get sdf from atlas\n  float dist = texture2D(u_sdf_map, v_uv).a;\n\n  // float fontScale = u_font_size / FONT_SIZE;\n\n  // lowp float buff = (6.0 - u_stroke_width / v_fontScale) / SDF_PX;\n  lowp float buff = (6.0 - strokeWidth / v_fontScale) / SDF_PX;\n  highp float gamma = (u_halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (v_fontScale * u_gamma_scale) / 1.0;\n\n  highp float gamma_scaled = gamma * v_gamma_scale;\n\n  highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);\n  // gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), vec4(u_stroke_color.rgb, u_stroke_color.a * u_opacity), smoothstep(0., 0.5, 1. - dist));\n  gl_FragColor = mix(vec4(v_color.rgb, v_color.a * opacity), vec4(textrueStroke.rgb, textrueStroke.a * opacity), smoothstep(0., 0.5, 1. - dist));\n  gl_FragColor.a= gl_FragColor.a * alpha;\n  gl_FragColor = filterColor(gl_FragColor);\n}\n',hrt='#define SDF_PX 8.0\n#define EDGE_GAMMA 0.105\n#define FONT_SIZE 24.0\nattribute vec3 a_Position;\nattribute vec2 a_tex;\nattribute vec2 a_textOffsets;\nattribute vec4 a_Color;\nattribute float a_Size;\nattribute float a_Rotate;\n\nuniform vec2 u_sdf_map_size;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\nuniform float u_raisingHeight: 0.0;\n\nvarying vec2 v_uv;\nvarying float v_gamma_scale;\nvarying vec4 v_color;\nvarying float v_fontScale;\n\nvarying mat4 styleMappingMat; // 用于将在顶点着色器中计算好的样式值传递给片元\n\nuniform float u_opacity : 1;\nuniform float u_stroke_width : 2;\nuniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n#pragma include "styleMappingCalStrokeWidth"\n\n#pragma include "projection"\n#pragma include "picking"\n\nvoid main() {\n  // cal style mapping - 数据纹理映射部分的计算\n   styleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // 当前的数据纹理有几行\n  float columnCount = u_cellTypeLayout[0][1]; // 当看到数据纹理有几列\n  float columnWidth = 1.0/columnCount;  // 列宽\n  float rowHeight = 1.0/rowCount;       // 行高\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // 第n个顶点\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // 起始点在第几行\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // 起始点在第几列\n  \n  // cell 固定顺序 opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // 按顺序从 cell 中取值、若没有则自动往下取值\n  float textureOffset = 0.0; // 在 cell 中取值的偏移量\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n\n   vec2 strokeWidthAndOffset = calStrokeWidthAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][2] = strokeWidthAndOffset.r;\n  textureOffset = strokeWidthAndOffset.g;\n\n  vec4 textrueStroke = vec4(-1.0, -1.0, -1.0, -1.0);\n  if(hasStroke()) {\n    vec2 valueRPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    styleMappingMat[1][0] = pos2value(valueRPos, columnWidth, rowHeight); // R\n    textureOffset += 1.0;\n\n    vec2 valueGPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    styleMappingMat[1][1] = pos2value(valueGPos, columnWidth, rowHeight); // G\n    textureOffset += 1.0;\n\n    vec2 valueBPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    styleMappingMat[1][2] = pos2value(valueBPos, columnWidth, rowHeight); // B\n    textureOffset += 1.0;\n\n    vec2 valueAPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    styleMappingMat[1][3] = pos2value(valueAPos, columnWidth, rowHeight); // A\n    textureOffset += 1.0;\n  } else {\n    if(u_stroke_color == vec4(0.0)) {\n      styleMappingMat[1][0] = v_color.r;\n      styleMappingMat[1][1] = v_color.g;\n      styleMappingMat[1][2] = v_color.b;\n      styleMappingMat[1][3] = v_color.a;\n    } else {\n      styleMappingMat[1][0] = u_stroke_color.r;\n      styleMappingMat[1][1] = u_stroke_color.g;\n      styleMappingMat[1][2] = u_stroke_color.b;\n      styleMappingMat[1][3] = u_stroke_color.a;\n    }\n  }\n  \n  // cal style mapping - 数据纹理映射部分的计算\n\n  v_color = a_Color;\n  v_uv = a_tex / u_sdf_map_size;\n\n  // 文本缩放比例\n  float fontScale = a_Size / FONT_SIZE;\n  v_fontScale = fontScale;\n\n  vec4 project_pos = project_position(vec4(a_Position, 1.0));\n  // vec4 projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n\n  highp float angle_sin = sin(a_Rotate);\n  highp float angle_cos = cos(a_Rotate);\n  mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);\n  \n  // gl_Position = vec4(projected_position.xy / projected_position.w + rotation_matrix * a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);\n\n  float raiseHeight = u_raisingHeight;\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {\n    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);\n    raiseHeight = u_raisingHeight * mapboxZoomScale;\n  }\n\n  vec4 projected_position;\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n   projected_position  = u_Mvp *(vec4(a_Position.xyz + vec3(0.0, 0.0, raiseHeight), 1.0));\n  } else { // else\n   projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz + vec3(0.0, 0.0, raiseHeight), 1.0));\n  }\n\n  gl_Position = vec4(\n    projected_position.xy / projected_position.w + rotation_matrix * a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);\n  v_gamma_scale = gl_Position.w;\n  setPickingColor(a_PickingColor);\n\n}\n';function frt(t){var e=this,n=t.id,r=[],i=[];if(!e.glyphInfoMap||!e.glyphInfoMap[n])return{vertices:[],indices:[],size:7};var o=e.glyphInfoMap[n].centroid,a=2===o.length?[o[0],o[1],0]:o;return e.glyphInfoMap[n].glyphQuads.forEach((function(t,e){r.push.apply(r,Xq(a).concat([t.tex.x,t.tex.y+t.tex.height,t.tl.x,t.tl.y],Xq(a),[t.tex.x+t.tex.width,t.tex.y+t.tex.height,t.tr.x,t.tr.y],Xq(a),[t.tex.x+t.tex.width,t.tex.y,t.br.x,t.br.y],Xq(a),[t.tex.x,t.tex.y,t.bl.x,t.bl.y])),i.push(0+4*e,1+4*e,2+4*e,2+4*e,3+4*e,0+4*e)})),{vertices:r,indices:i,size:7}}var prt=function(t){wZ(a,oet);var e,n,r,i,o=crt(a);function a(){var t;mZ(this,a);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return $q(SZ(t=o.call.apply(o,[this].concat(n))),"glyphInfoMap",{}),$q(SZ(t),"currentZoom",-1),$q(SZ(t),"textureHeight",0),$q(SZ(t),"textCount",0),$q(SZ(t),"preTextStyle",{}),$q(SZ(t),"mapping",RK(jK.mark((function e(){return jK.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.initGlyph(),t.updateTexture(),e.next=4,t.reBuildModel();case 4:case"end":return e.stop()}}),e)})))),t}return gZ(a,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),e=t.opacity,n=void 0===e?1:e,r=t.stroke,i=void 0===r?"#fff":r,o=t.strokeWidth,a=void 0===o?0:o,s=t.textAnchor,u=void 0===s?"center":s,c=t.textOffset,l=t.textAllowOverlap,h=void 0!==l&&l,f=t.halo,p=void 0===f?.5:f,d=t.gamma,m=void 0===d?2:d,v=t.raisingHeight,g=void 0===v?0:v,y=this.fontService,x=y.canvas,b=y.mapping;if(b&&Object.keys(b).length!==this.textCount&&x&&(this.updateTexture(),this.textCount=Object.keys(b).length),this.preTextStyle={textAnchor:u,textAllowOverlap:h,textOffset:c},this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:n,strokeWidth:a,stroke:i})){this.judgeStyleAttributes({opacity:n,strokeWidth:a,stroke:i});var _=this.layer.getEncodedData(),w=this.calDataFrame(this.cellLength,_,this.cellProperties),S=w.data,M=w.width,E=w.height;this.rowCount=E,this.dataTexture=this.cellLength>0&&S.length>0?this.createTexture2D({flipY:!0,data:S,format:m4.LUMINANCE,type:m4.FLOAT,width:M,height:E}):this.createTexture2D({flipY:!0,data:[1],format:m4.LUMINANCE,type:m4.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_raisingHeight:Number(g),u_opacity:hZ.isNumber(n)?n:1,u_stroke_width:hZ.isNumber(a)?a:1,u_stroke_color:this.getStrokeColor(i),u_sdf_map:this.texture,u_halo_blur:p,u_gamma_scale:m,u_sdf_map_size:[(null==x?void 0:x.width)||1,(null==x?void 0:x.height)||1]}}},{key:"initModels",value:(i=RK(jK.mark((function t(){var e,n,r,i,o,a;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.bindEvent(),this.extent=this.textExtent(),e=this.layer.getLayerConfig(),n=e.textAnchor,r=void 0===n?"center":n,i=e.textAllowOverlap,o=void 0===i||i,a=e.textOffset,this.preTextStyle={textAnchor:r,textAllowOverlap:o,textOffset:a},t.next=6,this.buildModels();case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"buildModels",value:(r=RK(jK.mark((function t(){var e,n,r,i,o,a,s,u;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.layer.getLayerConfig(),n=e.mask,r=void 0!==n&&n,i=e.maskInside,o=void 0===i||i,a=e.textAllowOverlap,s=void 0!==a&&a,this.initGlyph(),this.updateTexture(),s||this.filterGlyphs(),t.next=6,this.layer.buildLayerModel({moduleName:"pointText",vertexShader:hrt,fragmentShader:lrt,triangulation:frt.bind(this),depth:{enable:!1},blend:this.getBlend(),stencil:PK(r,o)});case 6:return u=t.sent,t.abrupt("return",[u]);case 8:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"needUpdate",value:(n=RK(jK.mark((function t(){var e,n,r,i,o,a,s,u,c,l;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=this.layer.getLayerConfig(),n=e.textAllowOverlap,r=void 0!==n&&n,i=e.textAnchor,o=void 0===i?"center":i,a=e.textOffset,s=this.layer.getEncodedData(),JSON.stringify(a)===JSON.stringify(this.preTextStyle.textOffset)&&o===this.preTextStyle.textAnchor){t.next=6;break}return t.next=5,this.mapping();case 5:case 14:return t.abrupt("return",!0);case 6:if(!(s.length<5||r)){t.next=8;break}return t.abrupt("return",!1);case 8:if(u=this.mapService.getZoom(),c=this.mapService.getBounds(),l=yK(this.extent,c),!(Math.abs(this.currentZoom-u)>1)&&l&&r===this.preTextStyle.textAllowOverlap){t.next=15;break}return t.next=14,this.reBuildModel();case 15:return t.abrupt("return",!1);case 16:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"clearModels",value:function(){var t,e;null===(t=this.texture)||void 0===t||t.destroy(),null===(e=this.dataTexture)||void 0===e||e.destroy(),this.layer.off("remapping",this.mapping)}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"rotate",type:d8.Attribute,descriptor:{name:"a_Rotate",buffer:{usage:m4.DYNAMIC_DRAW,data:[],type:m4.FLOAT},size:1,update:function(t){var e=t.rotate,n=void 0===e?0:e;return Array.isArray(n)?[n[0]]:[n]}}}),this.styleAttributeService.registerStyleAttribute({name:"textOffsets",type:d8.Attribute,descriptor:{name:"a_textOffsets",buffer:{usage:m4.STATIC_DRAW,data:[],type:m4.FLOAT},size:2,update:function(t,e,n){return[n[5],n[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:d8.Attribute,descriptor:{name:"a_Size",buffer:{usage:m4.DYNAMIC_DRAW,data:[],type:m4.FLOAT},size:1,update:function(t){var e=t.size,n=void 0===e?12:e;return Array.isArray(n)?[n[0]]:[n]}}}),this.styleAttributeService.registerStyleAttribute({name:"textUv",type:d8.Attribute,descriptor:{name:"a_tex",buffer:{usage:m4.DYNAMIC_DRAW,data:[],type:m4.FLOAT},size:2,update:function(t,e,n){return[n[3],n[4]]}}})}},{key:"bindEvent",value:function(){this.layer.isTileLayer||this.layer.on("remapping",this.mapping)}},{key:"textExtent",value:function(){return gK(this.mapService.getBounds(),.5)}},{key:"initTextFont",value:function(){var t=this.layer.getLayerConfig(),e=t.fontWeight,n=void 0===e?"400":e,r=t.fontFamily,i=void 0===r?"sans-serif":r,o=this.layer.getEncodedData(),a=[];o.forEach((function(t){var e,n=t.shape,r=void 0===n?"":n,i=srt(r=r.toString());try{for(i.s();!(e=i.n()).done;){var o=e.value;-1===a.indexOf(o)&&a.push(o)}}catch(s){i.e(s)}finally{i.f()}})),this.fontService.setFontOptions({characterSet:a,fontWeight:n,fontFamily:i,iconfont:!1})}},{key:"initIconFontTex",value:function(){var t=this.layer.getLayerConfig(),e=t.fontWeight,n=void 0===e?"400":e,r=t.fontFamily,i=void 0===r?"sans-serif":r,o=this.layer.getEncodedData(),a=[];o.forEach((function(t){var e=t.shape,n=void 0===e?"":e;n="".concat(n),-1===a.indexOf(n)&&a.push(n)})),this.fontService.setFontOptions({characterSet:a,fontWeight:n,fontFamily:i,iconfont:!0})}},{key:"generateGlyphLayout",value:function(t){var e=this,n=this.fontService.mapping,r=this.layer.getLayerConfig(),i=r.spacing,o=void 0===i?2:i,a=r.textAnchor,s=void 0===a?"center":a,u=r.textOffset,c=this.layer.getEncodedData();this.glyphInfo=c.map((function(r){var i=r.shape,a=void 0===i?"":i,c=r.id,l=r.size,h=void 0===l?1:l,f=function(t,e,n,r,i,o){var a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[0,0],s=arguments.length>7?arguments[7]:void 0,u=t.split("\n"),c=[],l={positionedGlyphs:c,top:a[1],bottom:a[1],left:a[0],right:a[0],lineCount:u.length,text:t};return s?art(l,e,u,n,r,i,o):ort(l,e,u,n,r,i,o),!!c.length&&l}(a.toString(),n,h,s,"left",o,u||r.textOffset||[0,0],t),p=function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],r=arguments.length>2?arguments[2]:void 0,i=t.positionedGlyphs,o=[],a=trt(void 0===i?[]:i);try{for(a.s();!(e=a.n()).done;){var s=e.value,u=s.metrics,c=4,l=u.advance*s.scale/2,h=r?[s.x+l,s.y]:[0,0],f=r?[0,0]:[s.x+l+n[0],s.y+n[1]],p=(0-c)*s.scale-l+f[0],d=(0-c)*s.scale+f[1],m=p+u.width*s.scale,v=d+u.height*s.scale,g={x:p,y:d},y={x:m,y:d},x={x:p,y:v},b={x:m,y:v};o.push({tl:g,tr:y,bl:x,br:b,tex:u,glyphOffset:h})}}catch(_){a.e(_)}finally{a.f()}return o}(f,u,!1);return r.shaping=f,r.glyphQuads=p,r.centroid=_K(r.coordinates),r.originCentroid="GAODE2.x"===r.version?_K(r.originCoordinates):r.originCentroid=r.centroid,e.glyphInfoMap[c]={shaping:f,glyphQuads:p,centroid:_K(r.coordinates)},r}))}},{key:"filterGlyphs",value:function(){var t=this,e=this.layer.getLayerConfig(),n=e.padding,r=void 0===n?[0,0]:n,i=e.textAllowOverlap;if(!(void 0!==i&&i)){this.glyphInfoMap={},this.currentZoom=this.mapService.getZoom(),this.extent=this.textExtent();var o=this.rendererService.getViewportSize(),a=o.width,s=o.height,u=new Qnt(a,s);this.glyphInfo.filter((function(e){var n=e.shaping,i=e.id,o=void 0===i?0:i,a="GAODE2.x"===e.version?e.originCentroid:e.centroid,s=e.size/16,c=t.mapService.lngLatToContainer(a),l=u.placeCollisionBox({x1:n.left*s-r[0],x2:n.right*s+r[0],y1:n.top*s-r[1],y2:n.bottom*s+r[1],anchorPointX:c.x,anchorPointY:c.y}).box;return!(!l||!l.length)&&(u.insertCollisionBox(l,o),!0)})).forEach((function(e){t.glyphInfoMap[e.id]=e}))}}},{key:"initGlyph",value:function(){var t=this.layer.getLayerConfig().iconfont,e=void 0!==t&&t;e?this.initIconFontTex():this.initTextFont(),this.generateGlyphLayout(e)}},{key:"updateTexture",value:function(){var t=this.rendererService.createTexture2D,e=this.fontService.canvas;this.textureHeight=e.height,this.texture&&this.texture.destroy(),this.texture=t({data:e,mag:m4.LINEAR,min:m4.LINEAR,width:e.width,height:e.height})}},{key:"reBuildModel",value:(e=RK(jK.mark((function t(){var e,n,r,i,o,a;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.layer.getLayerConfig(),n=e.mask,r=void 0!==n&&n,i=e.maskInside,o=void 0===i||i,this.filterGlyphs(),t.next=4,this.layer.buildLayerModel({moduleName:"pointText",vertexShader:hrt,fragmentShader:lrt,triangulation:frt.bind(this),depth:{enable:!1},blend:this.getBlend(),stencil:PK(r,o)});case 4:a=t.sent,this.layer.models=[a];case 6:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})}]),a}();const drt={fillImage:jnt,fill:Dnt,radar:Hnt,image:znt,normal:Gnt,simplePoint:qnt,extrude:Lnt,text:prt,earthFill:knt,earthExtrude:Cnt};function mrt(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return vrt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return vrt(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function vrt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function grt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var yrt=function(t){wZ(i,Ytt);var e,n,r=grt(i);function i(){var t;mZ(this,i);for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return $q(SZ(t=r.call.apply(r,[this].concat(n))),"type","PointLayer"),$q(SZ(t),"defaultSourceConfig",{data:[],options:{parser:{type:"json",x:"lng",y:"lat"}}}),t}return gZ(i,[{key:"buildModels",value:(n=RK(jK.mark((function t(){var e;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.getModelType(),this.layerModel&&this.layerModel.clearModels(),this.layerModel=new drt[e](this),t.next=5,this.initLayerModels();case 5:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"rebuildModels",value:(e=RK(jK.mark((function t(){return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.buildModels();case 2:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"getModelTypeWillEmptyData",value:function(){if(this.shapeOption){var t=this.shapeOption,e=t.field,n=t.values,r=this.getLayerConfig().shape2d,i=this.iconService.getIconMap();if(e&&-1!==(null==r?void 0:r.indexOf(e)))return"fill";if("text"===n)return"text";if(n&&n instanceof Array){var o,a=mrt(n);try{for(a.s();!(o=a.n()).done;){var s=o.value;if("string"==typeof s&&i.hasOwnProperty(s))return"image"}}catch(u){a.e(u)}finally{a.f()}}}return"normal"}},{key:"getDefaultConfig",value:function(){return{fillImage:{},normal:{blend:"additive"},radar:{},simplePoint:{},fill:{blend:"normal"},extrude:{},image:{},text:{blend:"normal"},tile:{},tileText:{},earthFill:{},earthExtrude:{}}[this.getModelType()]}},{key:"getModelType",value:function(){var t=this.getEncodedData(),e=this.getLayerConfig(),n=e.shape2d,r=e.shape3d,i=this.iconService.getIconMap(),o=t.find((function(t){return t.hasOwnProperty("shape")}));if(o){var a=o.shape;return"dot"===a?"normal":"simple"===a?"simplePoint":"radar"===a?"radar":"fillImage"===this.layerType?"fillImage":-1!==(null==n?void 0:n.indexOf(a))?"GLOBEL"===this.mapService.version?"earthFill":"fill":-1!==(null==r?void 0:r.indexOf(a))?"GLOBEL"===this.mapService.version?"earthExtrude":"extrude":i.hasOwnProperty(a)?"image":"text"}return this.getModelTypeWillEmptyData()}}]),i}();function xrt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var brt=function(t){wZ(i,oet);var e,n,r=xrt(i);function i(){return mZ(this,i),r.apply(this,arguments)}return gZ(i,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),e=t.opacity,n=void 0===e?1:e,r=t.heightfixed,i=void 0!==r&&r,o=t.raisingHeight,a=void 0===o?0:o,s=t.topsurface,u=void 0===s||s,c=t.sidesurface,l=void 0===c||c,h=t.sourceColor,f=t.targetColor;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:n})){this.judgeStyleAttributes({opacity:n});var p=this.layer.getEncodedData(),d=this.calDataFrame(this.cellLength,p,this.cellProperties),m=d.data,v=d.width,g=d.height;this.rowCount=g,this.dataTexture=this.cellLength>0&&m.length>0?this.createTexture2D({flipY:!0,data:m,format:m4.LUMINANCE,type:m4.FLOAT,width:v,height:g}):this.createTexture2D({flipY:!0,data:[1],format:m4.LUMINANCE,type:m4.FLOAT,width:1,height:1})}var y=0,x=[1,1,1,1],b=[1,1,1,1];return h&&f&&(x=EK(h),b=EK(f),y=1),{u_topsurface:Number(u),u_sidesurface:Number(l),u_heightfixed:Number(i),u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_raisingHeight:Number(a),u_opacity:hZ.isNumber(n)?n:1,u_linearColor:y,u_sourceColor:x,u_targetColor:b,u_texture:this.texture}}},{key:"initModels",value:(n=RK(jK.mark((function t(){return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.loadTexture(),t.next=3,this.buildModels();case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"buildModels",value:(e=RK(jK.mark((function t(){var e,n,r,i,o,a,s,u,c,l;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.layer.getLayerConfig(),n=e.mask,r=void 0!==n&&n,i=e.maskInside,o=void 0===i||i,a=this.getShaders(),s=a.frag,u=a.vert,c=a.type,t.next=4,this.layer.buildLayerModel({moduleName:c,vertexShader:u,fragmentShader:s,triangulation:Het,stencil:PK(r,o)});case 4:return l=t.sent,t.abrupt("return",[l]);case 6:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"getShaders",value:function(){var t=this.layer.getLayerConfig(),e=t.pickLight;return t.mapTexture?{frag:'uniform sampler2D u_texture;\nuniform float u_opacity: 1.0;\nuniform vec4 u_sourceColor;\nuniform vec4 u_targetColor;\nuniform float u_linearColor: 0;\n\nuniform float u_topsurface: 1.0;\nuniform float u_sidesurface: 1.0;\n\nvarying vec4 v_Color;\nvarying mat4 styleMappingMat; // 传递从片元中传递的映射数据\n#pragma include "picking"\n\nvoid main() {\n  float opacity = styleMappingMat[0][0];\n  float isSide = styleMappingMat[0][3];\n  float lightWeight = styleMappingMat[3][1];\n  float topU = styleMappingMat[2][2];\n  float topV = styleMappingMat[2][3];\n\n  float sidey = styleMappingMat[3][0];\n  // Tip: 部分机型 GPU 计算精度兼容\n  if(isSide < 0.999) {\n    // side face\n    if(u_sidesurface < 1.0) {\n      discard;\n    }\n\n    if(u_linearColor == 1.0) {\n      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);\n      linearColor.rgb *= lightWeight;\n      gl_FragColor = linearColor;\n    } else {\n      gl_FragColor = v_Color;\n    }\n  } else {\n\n     // top face\n    if(u_topsurface < 1.0) {\n      discard;\n    }\n\n    gl_FragColor = texture2D(u_texture, vec2(topU, topV));\n  }\n  \n\n  gl_FragColor.a *= opacity;\n  gl_FragColor = filterColor(gl_FragColor);\n}\n',vert:'precision highp float;\n\n#define ambientRatio 0.5\n#define diffuseRatio 0.3\n#define specularRatio 0.2\n\nattribute vec4 a_Color;\nattribute vec3 a_Position;\nattribute vec3 a_Normal;\nattribute float a_Size;\nattribute vec3 a_uvs;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\n\nvarying vec4 v_Color;\nuniform float u_heightfixed: 0.0; // 默认不固定\nuniform float u_raisingHeight: 0.0;\nuniform float u_opacity: 1.0;\nvarying mat4 styleMappingMat; // 用于将在顶点着色器中计算好的样式值传递给片元\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n\n#pragma include "projection"\n#pragma include "light"\n#pragma include "picking"\n\nvoid main() {\n  v_Color = a_Color;\n\n  // cal style mapping - 数据纹理映射部分的计算\n  styleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - a_Position.z(judge side by a_Position.z)\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1] - u - v\n    0.0, 0.0, 0.0, 0.0  // sidey\n  );\n  \n  styleMappingMat[0][3] = a_Position.z;\n  styleMappingMat[2][2] = a_uvs[0];\n  styleMappingMat[2][3] = 1.0 - a_uvs[1];\n  styleMappingMat[3][0] = a_uvs[2];\n\n\n  float rowCount = u_cellTypeLayout[0][0];    // 当前的数据纹理有几行\n  float columnCount = u_cellTypeLayout[0][1]; // 当看到数据纹理有几列\n  float columnWidth = 1.0/columnCount;  // 列宽\n  float rowHeight = 1.0/rowCount;       // 行高\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // 第n个顶点\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // 起始点在第几行\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // 起始点在第几列\n  \n  // cell 固定顺序 opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // 按顺序从 cell 中取值、若没有则自动往下取值\n  float textureOffset = 0.0; // 在 cell 中取值的偏移量\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n  // cal style mapping - 数据纹理映射部分的计算\n\n  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);\n  vec4 project_pos = project_position(pos);\n\n  if(u_heightfixed > 0.0) { // 判断几何体是否固定高度\n    project_pos.z = a_Position.z * a_Size;\n    project_pos.z += u_raisingHeight;\n\n    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {\n      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);\n      project_pos.z *= mapboxZoomScale;\n      project_pos.z += u_raisingHeight * mapboxZoomScale;\n    }\n  }\n\n  // project_pos.z += 500000.0; // amap1\n\n  // project_pos.z += (500000.0 * 4.0)/pow(2.0, 21.0 - u_Zoom); // mapbox\n  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n    // gl_Position = u_Mvp * (vec4(project_pos.xyz * vec3(1.0, 1.0, -1.0), 1.0));\n    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));\n  } else {\n    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n  }\n\n  float lightWeight = calc_lighting(pos);\n  styleMappingMat[3][1] = lightWeight;\n\n  setPickingColor(a_PickingColor);\n}\n',type:"polygonExtrudeTexture"}:e?{frag:'uniform float u_opacity: 1.0;\nuniform vec4 u_sourceColor;\nuniform vec4 u_targetColor;\nuniform float u_linearColor: 0;\n\nuniform float u_topsurface: 1.0;\nuniform float u_sidesurface: 1.0;\n\nvarying vec4 v_Color;\nvarying mat4 styleMappingMat; // 传递从片元中传递的映射数据\n#pragma include "picking"\n\nvoid main() {\n  float opacity = styleMappingMat[0][0];\n  float isSide = styleMappingMat[0][3];\n  float sidey = styleMappingMat[3][0];\n  float lightWeight = styleMappingMat[3][1];\n\n  // Tip: 部分机型 GPU 计算精度兼容\n  if(isSide < 0.999) {\n    // side face\n    if(u_sidesurface < 1.0) {\n      discard;\n    }\n    \n    if( u_linearColor == 1.0) {\n      // side use linear\n      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);\n      linearColor.rgb *= lightWeight;\n      gl_FragColor = linearColor;\n    } else {\n      // side notuse linear\n       gl_FragColor = v_Color;\n    }\n  } else {\n    // top face\n    if(u_topsurface < 1.0) {\n      discard;\n    }\n    gl_FragColor = v_Color;\n  }\n\n  gl_FragColor.a *= opacity;\n  gl_FragColor = filterColorAlpha(gl_FragColor, lightWeight);\n}\n',vert:'precision highp float;\n\n#define ambientRatio 0.5\n#define diffuseRatio 0.3\n#define specularRatio 0.2\n\nattribute vec4 a_Color;\nattribute vec3 a_Position;\nattribute vec3 a_Normal;\nattribute float a_Size;\nattribute vec3 a_uvs;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\n\nvarying vec4 v_Color;\nuniform float u_heightfixed: 0.0; // 默认不固定\nuniform float u_raisingHeight: 0.0;\nuniform float u_opacity: 1.0;\nvarying mat4 styleMappingMat; // 用于将在顶点着色器中计算好的样式值传递给片元\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n\n#pragma include "projection"\n#pragma include "light"\n#pragma include "picking"\n\nvoid main() {\n  // cal style mapping - 数据纹理映射部分的计算\n  styleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - isSide\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0  // sidey\n  );\n  styleMappingMat[0][3] = a_Position.z;\n  styleMappingMat[3][0] = a_uvs[2];\n\n  float rowCount = u_cellTypeLayout[0][0];    // 当前的数据纹理有几行\n  float columnCount = u_cellTypeLayout[0][1]; // 当看到数据纹理有几列\n  float columnWidth = 1.0/columnCount;  // 列宽\n  float rowHeight = 1.0/rowCount;       // 行高\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // 第n个顶点\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // 起始点在第几行\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // 起始点在第几列\n  \n  // cell 固定顺序 opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // 按顺序从 cell 中取值、若没有则自动往下取值\n  float textureOffset = 0.0; // 在 cell 中取值的偏移量\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n  // cal style mapping - 数据纹理映射部分的计算\n  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);\n  vec4 project_pos = project_position(pos);\n\n  if(u_heightfixed > 0.0) { // 判断几何体是否固定高度\n    project_pos.z = a_Position.z * a_Size;\n    project_pos.z += u_raisingHeight;\n    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {\n      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);\n      project_pos.z *= mapboxZoomScale;\n      project_pos.z += u_raisingHeight * mapboxZoomScale;\n    }\n  }\n\n  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n    // gl_Position = u_Mvp * (vec4(project_pos.xyz * vec3(1.0, 1.0, -1.0), 1.0));\n    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));\n  } else {\n    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n  }\n\n  float lightWeight = calc_lighting(pos);\n  // v_Color = a_Color;\n  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w);\n\n  styleMappingMat[3][1] = lightWeight;\n\n  setPickingColor(a_PickingColor);\n}\n',type:"polygonExtrudePickLight"}:{frag:'uniform float u_opacity: 1.0;\nuniform vec4 u_sourceColor;\nuniform vec4 u_targetColor;\nuniform float u_linearColor: 0;\n\nuniform float u_topsurface: 1.0;\nuniform float u_sidesurface: 1.0;\n\nvarying vec4 v_Color;\nvarying mat4 styleMappingMat; // 传递从片元中传递的映射数据\n#pragma include "picking"\n\nvoid main() {\n  float opacity = styleMappingMat[0][0];  \n  float isSide = styleMappingMat[0][3];\n  float sidey = styleMappingMat[3][0];\n  float lightWeight = styleMappingMat[3][1];\n\n  // Tip: 部分机型 GPU 计算精度兼容\n  if(isSide < 0.999) {\n    // side face\n    if(u_sidesurface < 1.0) {\n      discard;\n    }\n\n    if(u_linearColor == 1.0) {\n      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);\n      linearColor.rgb *= lightWeight;\n      gl_FragColor = linearColor;\n    } else {\n      gl_FragColor = v_Color;\n    }\n\n  } else {\n     // top face\n    if(u_topsurface < 1.0) {\n      discard;\n    }\n\n    gl_FragColor = v_Color;\n  }\n\n  gl_FragColor.a *= opacity;\n  gl_FragColor = filterColor(gl_FragColor);\n}\n',vert:'precision highp float;\n\n#define ambientRatio 0.5\n#define diffuseRatio 0.3\n#define specularRatio 0.2\n\nattribute vec4 a_Color;\nattribute vec3 a_Position;\nattribute vec3 a_Normal;\nattribute float a_Size;\nattribute vec3 a_uvs;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\n\nvarying vec4 v_Color;\nuniform float u_heightfixed: 0.0; // 默认不固定\nuniform float u_raisingHeight: 0.0;\nuniform float u_opacity: 1.0;\nvarying mat4 styleMappingMat; // 用于将在顶点着色器中计算好的样式值传递给片元\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n\n#pragma include "projection"\n#pragma include "light"\n#pragma include "picking"\n\nvoid main() {\n  // cal style mapping - 数据纹理映射部分的计算\n  styleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - isSide\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0  // sidey\n  );\n  styleMappingMat[0][3] = a_Position.z;\n  styleMappingMat[3][0] = a_uvs[2];\n\n  float rowCount = u_cellTypeLayout[0][0];    // 当前的数据纹理有几行\n  float columnCount = u_cellTypeLayout[0][1]; // 当看到数据纹理有几列\n  float columnWidth = 1.0/columnCount;  // 列宽\n  float rowHeight = 1.0/rowCount;       // 行高\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // 第n个顶点\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // 起始点在第几行\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // 起始点在第几列\n  \n  // cell 固定顺序 opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // 按顺序从 cell 中取值、若没有则自动往下取值\n  float textureOffset = 0.0; // 在 cell 中取值的偏移量\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n  // cal style mapping - 数据纹理映射部分的计算\n\n  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);\n  vec4 project_pos = project_position(pos);\n\n  if(u_heightfixed > 0.0) { // 判断几何体是否固定高度\n    project_pos.z = a_Position.z * a_Size;\n    project_pos.z += u_raisingHeight;\n\n    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {\n      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);\n      project_pos.z *= mapboxZoomScale;\n      project_pos.z += u_raisingHeight * mapboxZoomScale;\n    }\n  }\n\n  // project_pos.z += 500000.0; // amap1\n\n  // project_pos.z += (500000.0 * 4.0)/pow(2.0, 21.0 - u_Zoom); // mapbox\n  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n    // gl_Position = u_Mvp * (vec4(project_pos.xyz * vec3(1.0, 1.0, -1.0), 1.0));\n    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));\n  } else {\n    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n  }\n\n  float lightWeight = calc_lighting(pos);\n  // v_Color = a_Color;\n  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w);\n\n  styleMappingMat[3][1] = lightWeight;\n\n  setPickingColor(a_PickingColor);\n}\n',type:"polygonExtrude"}}},{key:"clearModels",value:function(){var t,e;null===(t=this.dataTexture)||void 0===t||t.destroy(),null===(e=this.texture)||void 0===e||e.destroy()}},{key:"registerBuiltinAttributes",value:function(){var t=lZ(this.layer.getSource().extent,4),e=t[0],n=t[1],r=t[2],i=t[3],o=r-e,a=i-n;this.styleAttributeService.registerStyleAttribute({name:"uvs",type:d8.Attribute,descriptor:{name:"a_uvs",buffer:{usage:m4.STATIC_DRAW,data:[],type:m4.FLOAT},size:3,update:function(t,r,i){var s=i[0],u=i[1];return[(s-e)/o,(u-n)/a,i[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:d8.Attribute,descriptor:{name:"a_Normal",buffer:{usage:m4.STATIC_DRAW,data:[],type:m4.FLOAT},size:3,update:function(t,e,n,r,i){return i}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:d8.Attribute,descriptor:{name:"a_Size",buffer:{usage:m4.DYNAMIC_DRAW,data:[],type:m4.FLOAT},size:1,update:function(t){var e=t.size,n=void 0===e?10:e;return Array.isArray(n)?[n[0]]:[n]}}})}},{key:"loadTexture",value:function(){var t=this,e=this.layer.getLayerConfig().mapTexture,n=this.rendererService.createTexture2D;if(this.texture=n({height:0,width:0}),e){var r=new Image;r.crossOrigin="",r.src=e,r.onload=function(){t.texture=n({data:r,width:r.width,height:r.height,wrapS:m4.CLAMP_TO_EDGE,wrapT:m4.CLAMP_TO_EDGE,min:m4.LINEAR,mag:m4.LINEAR}),t.layerService.reRender()}}}}]),i}();function _rt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var wrt=function(t){wZ(i,oet);var e,n,r=_rt(i);function i(){return mZ(this,i),r.apply(this,arguments)}return gZ(i,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),e=t.raisingHeight,n=void 0===e?0:e,r=t.opacity,i=void 0===r?1:r,o=t.opacityLinear,a=void 0===o?{enable:!1,dir:"in"}:o;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:i})){this.judgeStyleAttributes({opacity:i});var s=this.layer.getEncodedData(),u=this.calDataFrame(this.cellLength,s,this.cellProperties),c=u.data,l=u.width,h=u.height;this.rowCount=h,this.dataTexture=this.cellLength>0&&c.length>0?this.createTexture2D({flipY:!0,data:c,format:m4.LUMINANCE,type:m4.FLOAT,width:l,height:h}):this.createTexture2D({flipY:!0,data:[1],format:m4.LUMINANCE,type:m4.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_raisingHeight:Number(n),u_opacity:hZ.isNumber(i)?i:1,u_opacitylinear:Number(a.enable),u_dir:"in"===a.dir?1:0}}},{key:"initModels",value:(n=RK(jK.mark((function t(){return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.buildModels();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"buildModels",value:(e=RK(jK.mark((function t(){var e,n,r,i,o,a,s,u,c,l,h,f,p,d;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.getModelParams(),n=e.frag,r=e.vert,i=e.triangulation,o=e.type,a=this.layer.getLayerConfig(),s=a.mask,u=void 0!==s&&s,c=a.maskInside,l=void 0===c||c,h=a.workerEnabled,f=void 0!==h&&h,p=a.enablePicking,this.layer.triangulation=i,t.next=5,this.layer.buildLayerModel({moduleName:o,vertexShader:r,fragmentShader:n,triangulation:i,primitive:m4.TRIANGLES,depth:{enable:!1},blend:this.getBlend(),stencil:PK(u,l),workerEnabled:f,workerOptions:{modelType:o,enablePicking:p}});case 5:return d=t.sent,t.abrupt("return",[d]);case 7:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"clearModels",value:function(){var t;null===(t=this.dataTexture)||void 0===t||t.destroy()}},{key:"registerBuiltinAttributes",value:function(){var t=this.layer.getLayerConfig().opacityLinear;(void 0===t?{enable:!1,dir:"in"}:t).enable&&this.styleAttributeService.registerStyleAttribute({name:"linear",type:d8.Attribute,descriptor:{name:"a_linear",buffer:{usage:m4.STATIC_DRAW,data:[],type:m4.FLOAT},size:3,update:function(t,e,n){return[n[3],n[4],n[5]]}}})}},{key:"getModelParams",value:function(){var t=this.layer.getLayerConfig().opacityLinear;return(void 0===t?{enable:!1}:t).enable?{frag:'uniform float u_opacity: 1.0;\nvarying vec4 v_Color;\nvarying mat4 styleMappingMat; // 传递从片元中传递的映射数据\n\n#pragma include "picking"\nuniform float u_opacitylinear: 0.0;\nuniform float u_dir: 1.0;\nvarying vec3 v_linear;\nvarying vec2 v_pos;\n\n\nvoid main() {\n  float opacity = styleMappingMat[0][0];\n  gl_FragColor = v_Color;\n  \n  if(u_opacitylinear > 0.0) {\n    gl_FragColor.a *= u_dir == 1.0 ? 1.0 - length(v_pos - v_linear.xy)/v_linear.z : length(v_pos - v_linear.xy)/v_linear.z;\n  }\n\n  gl_FragColor.a *= opacity;\n  gl_FragColor = filterColor(gl_FragColor);\n}\n',vert:'attribute vec4 a_Color;\nattribute vec3 a_Position;\n\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\nuniform float u_opacity: 1.0;\nuniform float u_raisingHeight: 0.0;\n\nvarying vec4 v_Color;\nvarying mat4 styleMappingMat; // 用于将在顶点着色器中计算好的样式值传递给片元\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n\n#pragma include "projection"\n#pragma include "picking"\n\nuniform float u_opacitylinear: 0.0;\n\nattribute vec3 a_linear;\nvarying vec3 v_linear;\nvarying vec2 v_pos;\n\nvoid main() {\n  if(u_opacitylinear > 0.0) {\n    v_linear = a_linear;\n    v_pos = a_Position.xy;\n  }\n  \n  // cal style mapping - 数据纹理映射部分的计算\nstyleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // 当前的数据纹理有几行\n  float columnCount = u_cellTypeLayout[0][1]; // 当看到数据纹理有几列\n  float columnWidth = 1.0/columnCount;  // 列宽\n  float rowHeight = 1.0/rowCount;       // 行高\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // 第n个顶点\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // 起始点在第几行\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // 起始点在第几列\n  \n  // cell 固定顺序 opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // 按顺序从 cell 中取值、若没有则自动往下取值\n  float textureOffset = 0.0; // 在 cell 中取值的偏移量\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n  // cal style mapping - 数据纹理映射部分的计算\n\n  v_Color = a_Color;\n  vec4 project_pos = project_position(vec4(a_Position, 1.0));\n  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n  project_pos.z += u_raisingHeight;\n\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {\n    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);\n    project_pos.z *= mapboxZoomScale;\n    project_pos.z += u_raisingHeight * mapboxZoomScale;\n  }\n\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));\n  } else {\n    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n  }\n\n  setPickingColor(a_PickingColor);\n}',type:"polygonLinear",triangulation:Get}:{frag:'uniform float u_opacity: 1.0;\nvarying vec4 v_color;\nvarying mat4 styleMappingMat; // 传递从片元中传递的映射数据\n\n#pragma include "picking"\n\nvoid main() {\n  float opacity = styleMappingMat[0][0];\n  gl_FragColor = v_color;\n  gl_FragColor.a *= opacity;\n  gl_FragColor = filterColor(gl_FragColor);\n}\n',vert:'attribute vec4 a_Color;\nattribute vec3 a_Position;\n\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\n\nuniform float u_opacity: 1.0;\nuniform float u_raisingHeight: 0.0;\n\nvarying vec4 v_color;\nvarying mat4 styleMappingMat; // 用于将在顶点着色器中计算好的样式值传递给片元\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n\n#pragma include "projection"\n#pragma include "picking"\n\nvoid main() {\n  // cal style mapping - 数据纹理映射部分的计算\nstyleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // 当前的数据纹理有几行\n  float columnCount = u_cellTypeLayout[0][1]; // 当看到数据纹理有几列\n  float columnWidth = 1.0/columnCount;  // 列宽\n  float rowHeight = 1.0/rowCount;       // 行高\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // 第n个顶点\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // 起始点在第几行\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // 起始点在第几列\n  \n  // cell 固定顺序 opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // 按顺序从 cell 中取值、若没有则自动往下取值\n  float textureOffset = 0.0; // 在 cell 中取值的偏移量\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n  // cal style mapping - 数据纹理映射部分的计算\n\n  v_color = a_Color;\n  vec4 project_pos = project_position(vec4(a_Position, 1.0));\n  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n\n  project_pos.z += u_raisingHeight;\n\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {\n    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);\n    project_pos.z *= mapboxZoomScale;\n    project_pos.z += u_raisingHeight * mapboxZoomScale;\n  }\n\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));\n  } else {\n    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n  }\n\n  setPickingColor(a_PickingColor);\n}\n\n',type:"polygonFill",triangulation:nQ}}}]),i}();function Srt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var Mrt=function(t){wZ(i,oet);var e,n,r=Srt(i);function i(){return mZ(this,i),r.apply(this,arguments)}return gZ(i,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),e=t.opacity,n=void 0===e?1:e,r=t.watercolor,i=void 0===r?"#6D99A8":r,o=t.watercolor2,a=void 0===o?"#0F121C":o;return{u_texture1:this.texture1,u_texture2:this.texture2,u_texture3:this.texture3,u_watercolor:EK(i),u_watercolor2:EK(a),u_opacity:hZ.isNumber(n)?n:1}}},{key:"getAnimateUniforms",value:function(){return{u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:(n=RK(jK.mark((function t(){return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.loadTexture(),t.next=3,this.buildModels();case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"buildModels",value:(e=RK(jK.mark((function t(){var e,n,r,i,o,a;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.layer.getLayerConfig(),n=e.mask,r=void 0!==n&&n,i=e.maskInside,o=void 0===i||i,t.next=3,this.layer.buildLayerModel({moduleName:"polygonOcean",vertexShader:'attribute vec2 a_uv;\nattribute vec3 a_Position;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\n\nvarying vec2 v_uv;\n\n#pragma include "projection"\n\nvoid main() {\n  v_uv = a_uv;\n\n  vec4 project_pos = project_position(vec4(a_Position, 1.0));\n\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));\n  } else {\n    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n  }\n}\n\n',fragmentShader:"\nuniform float u_time: 0.0;\nuniform float u_opacity: 1.0;\n\nvarying vec2 v_uv;\n\nfloat coast2water_fadedepth = 0.10;\nfloat large_waveheight      = .750; // change to adjust the \"heavy\" waves\nfloat large_wavesize        = 3.4;  // factor to adjust the large wave size\nfloat small_waveheight      = 0.6;  // change to adjust the small random waves\nfloat small_wavesize        = 0.5;   // factor to ajust the small wave size\nfloat water_softlight_fact  = 15.;  // range [1..200] (should be << smaller than glossy-fact)\nfloat water_glossylight_fact= 120.; // range [1..200]\nfloat particle_amount       = 70.;\n// vec3 watercolor             = vec3(0.43, 0.60, 0.66); // 'transparent' low-water color (RGB)\n// vec3 watercolor2            = vec3(0.06, 0.07, 0.11); // deep-water color (RGB, should be darker than the low-water color)\nuniform vec4 u_watercolor;\nuniform vec4 u_watercolor2;\nvec3 water_specularcolor    = vec3(1.3, 1.3, 0.9);    // specular Color (RGB) of the water-highlights\n#define light                 vec3(-0., sin(u_time*0.5)*.5 + .35, 2.8) // position of the sun\n\nuniform sampler2D u_texture1;\nuniform sampler2D u_texture2;\nuniform sampler2D u_texture3;\n\n  \n\nfloat hash( float n ) {\n    return fract(sin(n)*43758.5453123);\n}\n\n// 2d noise function\nfloat noise1( in vec2 x ) {\n  vec2 p  = floor(x);\n  vec2 f  = smoothstep(0.0, 1.0, fract(x));\n  float n = p.x + p.y*57.0;\n  return mix(mix( hash(n+  0.0), hash(n+  1.0),f.x),\n    mix( hash(n+ 57.0), hash(n+ 58.0),f.x),f.y);\n}\n\nfloat noise(vec2 p) {\n    return texture2D(u_texture2,p*vec2(1./256.)).x;\n}\n\nvec4 highness(vec2 p) {\n    vec4 t = texture2D(u_texture1,fract(p));\n    float clipped = -2.0-smoothstep(3.,10.,t.a)*6.9-smoothstep(10.,100.,t.a)*89.9-smoothstep(0.,10000.,t.a)*10000.0;\n    return clamp(t, 0.0,3.0)+clamp(t/3.0-1.0, 0.0,1.0)+clamp(t/16.0-1.0, 0.0,1.0);\n}\n\nfloat height_map( vec2 p ) {\n    vec4 height=highness(p);\n    /*\n    height = -0.5+\n        0.5*smoothstep(-100.,0.,-height)+\n        2.75*smoothstep(0.,2.,height)+\n        1.75*smoothstep(2.,4.,height)+\n        2.75*smoothstep(4.,16.,height)+\n        1.5*smoothstep(16.,1000.,height);\n    */\n\n    mat2 m = mat2( 0.9563*1.4,  -0.2924*1.4,  0.2924*1.4,  0.9563*1.4 );\n    //p = p*6.;\n    float f = 0.6000*noise1( p ); p = m*p*1.1*6.;\n    f += 0.2500*noise( p ); p = m*p*1.32;\n    f += 0.1666*noise( p ); p = m*p*1.11;\n    f += 0.0834*noise( p ); p = m*p*1.12;\n    f += 0.0634*noise( p ); p = m*p*1.13;\n    f += 0.0444*noise( p ); p = m*p*1.14;\n    f += 0.0274*noise( p ); p = m*p*1.15;\n    f += 0.0134*noise( p ); p = m*p*1.16;\n    f += 0.0104*noise( p ); p = m*p*1.17;\n    f += 0.0084*noise( p );\n    f = .25*f+dot(height,vec4(-.03125,-.125,.25,.25))*.5;\n        const float FLAT_LEVEL = 0.92525;\n        //f = f*0.25+height*0.75;\n    if (f<FLAT_LEVEL)\n        f = f;\n    else\n        f = pow((f-FLAT_LEVEL)/(1.-FLAT_LEVEL), 2.)*(1.-FLAT_LEVEL)*2.0+FLAT_LEVEL; // makes a smooth coast-increase\n    return clamp(f, 0., 10.);\n}\n\nvec3 plasma_quintic( float x ) {\n    x = clamp( x, 0.0, 1.0);\n    vec4 x1 = vec4( 1.0, x, x * x, x * x * x ); // 1 x x2 x3\n    vec4 x2 = x1 * x1.w * x; // x4 x5 x6 x7\n    return vec3(\n        dot( x1.xyzw, vec4( +0.063861086, +1.992659096, -1.023901152, -0.490832805 ) ) + dot( x2.xy, vec2( +1.308442123, -0.914547012 ) ),\n        dot( x1.xyzw, vec4( +0.049718590, -0.791144343, +2.892305078, +0.811726816 ) ) + dot( x2.xy, vec2( -4.686502417, +2.717794514 ) ),\n        dot( x1.xyzw, vec4( +0.513275779, +1.580255060, -5.164414457, +4.559573646 ) ) + dot( x2.xy, vec2( -1.916810682, +0.570638854 ) ) );\n}\n\nvec4 color(vec2 p){\n    vec4 c1 = vec4(1.7,1.6,.9,1);\n    vec4 c2 = vec4(.2,.94,.1,1);\n    vec4 c3 = vec4(.3,.2,.0,1);\n    vec4 c4 = vec4(.99,.99,1.6,1);\n    vec4 v = highness(p);\n    float los = smoothstep(0.1,1.1,v.b);\n    float his = smoothstep(3.5,6.5,v.b);\n    float ces = smoothstep(1.,5.,v.a);\n    vec4 lo = mix(c1,c2,los);\n    vec4 hi = mix(c3,c4,his);\n    vec4 ce = mix(lo,hi,ces);\n\n    return vec4(plasma_quintic(ces),1).ragb;\n}\n\nvec3 terrain_map( vec2 p )\n{\n  return color(p).rgb*0.75+0.25*vec3(0.7, .55, .4)+texture2D(u_texture3, fract(p*5.)).rgb*.5; // test-terrain is simply 'sandstone'\n}\n\nconst mat2 m = mat2( 0.72, -1.60,  1.60,  0.72 );\n\nfloat water_map( vec2 p, float height ) {\n    vec2 p2 = p*large_wavesize;\n    vec2 shift1 = 0.001*vec2( u_time*160.0*2.0, u_time*120.0*2.0 );\n    vec2 shift2 = 0.001*vec2( u_time*190.0*2.0, -u_time*130.0*2.0 );\n\n    // coarse crossing 'ocean' waves...\n    float f = 0.6000*noise( p );\n    f += 0.2500*noise( p*m );\n    f += 0.1666*noise( p*m*m );\n    float wave = sin(p2.x*0.622+p2.y*0.622+shift2.x*4.269)*large_waveheight*f*height*height ;\n\n    p *= small_wavesize;\n    f = 0.;\n    float amp = 1.0, s = .5;\n    for (int i=0; i<9; i++)\n    { p = m*p*.947; f -= amp*abs(sin((noise( p+shift1*s )-.5)*2.)); amp = amp*.59; s*=-1.329; }\n    \n    return wave+f*small_waveheight;\n}\n\nfloat nautic(vec2 p) {\n    p *= 18.;\n    float f = 0.;\n    float amp = 1.0, s = .5;\n    for (int i=0; i<3; i++)\n    { p = m*p*1.2; f += amp*abs(smoothstep(0., 1., noise( p+u_time*s ))-.5); amp = amp*.5; s*=-1.227; }\n    return pow(1.-f, 5.);\n}\n\nfloat particles(vec2 p) {\n    p *= 200.;\n    float f = 0.;\n    float amp = 1.0, s = 1.5;\n    for (int i=0; i<3; i++)\n    { p = m*p*1.2; f += amp*noise( p+u_time*s ); amp = amp*.5; s*=-1.227; }\n    return pow(f*.35, 7.)*particle_amount;\n}\n\nfloat test_shadow( vec2 xy, float height) {\n    vec3 r0 = vec3(xy, height);\n    vec3 rd = normalize( light - r0 );\n    \n    float hit = 1.0;\n    float t   = 0.001;\n    for (int j=1; j<25; j++)\n    {\n        vec3 p = r0 + t*rd;\n        float h = height_map( p.xy );\n        float height_diff = p.z - h;\n        if (height_diff<0.0)\n        {\n            return 0.0;\n        }\n        t += 0.01+height_diff*.02;\n        hit = min(hit, 2.*height_diff/t); // soft shaddow   \n    }\n    return hit;\n}\n\nvec3 CalcTerrain(vec2 uv, float height) {\n    vec3 col = terrain_map( uv );\n    vec2 iResolution = vec2(512.);\n    float h1 = height_map(uv-vec2(0., 0.5)/ iResolution.xy);\n    float h2 = height_map(uv+vec2(0., 0.5)/ iResolution.xy);\n    float h3 = height_map(uv-vec2(0.5, 0.)/ iResolution.xy);\n    float h4 = height_map(uv+vec2(0.5, 0.)/ iResolution.xy);\n    vec3 norm = normalize(vec3(h3-h4, h1-h2, 1.));\n    vec3 r0 = vec3(uv, height);\n    vec3 rd = normalize( light - r0 );\n    float grad = dot(norm, rd);\n    col *= grad+pow(grad, 8.);\n    float terrainshade = test_shadow( uv, height );\n    col = mix(col*.25, col, terrainshade);\n    return col;\n}\n\n\nvoid main() {\n  vec3 watercolor = u_watercolor.rgb;\n  vec3 watercolor2 = u_watercolor2.rgb;\n  vec2 uv = v_uv;\n  float WATER_LEVEL = 0.84; // Water level (range: 0.0 - 2.0)\n  float deepwater_fadedepth   = 0.4 + coast2water_fadedepth;\n  float height = height_map( uv );\n  vec3 col;\n\n    float waveheight = clamp(WATER_LEVEL*3.-1.5, 0., 1.);\n    float level = WATER_LEVEL + .2*water_map(uv*15. + vec2(u_time*.1), waveheight);\n    if (height > level)\n    {\n        col = CalcTerrain(uv, height);\n    }\n    if (height <= level)\n    {\n        vec2 dif = vec2(.0, .01);\n        vec2 pos = uv*15. + vec2(u_time*.01);\n        float h1 = water_map(pos-dif,waveheight);\n        float h2 = water_map(pos+dif,waveheight);\n        float h3 = water_map(pos-dif.yx,waveheight);\n        float h4 = water_map(pos+dif.yx,waveheight);\n        vec3 normwater = normalize(vec3(h3-h4, h1-h2, .125)); // norm-vector of the 'bumpy' water-plane\n        uv += normwater.xy*.002*(level-height);\n        \n        col = CalcTerrain(uv, height);\n\n        float coastfade = clamp((level-height)/coast2water_fadedepth, 0., 1.);\n        float coastfade2= clamp((level-height)/deepwater_fadedepth, 0., 1.);\n        float intensity = col.r*.2126+col.g*.7152+col.b*.0722;\n        watercolor = mix(watercolor*intensity, watercolor2, smoothstep(0., 1., coastfade2));\n\n        vec3 r0 = vec3(uv, WATER_LEVEL);\n        vec3 rd = normalize( light - r0 ); // ray-direction to the light from water-position\n        float grad     = dot(normwater, rd); // dot-product of norm-vector and light-direction\n        float specular = pow(grad, water_softlight_fact);  // used for soft highlights                          \n        float specular2= pow(grad, water_glossylight_fact); // used for glossy highlights\n        float gradpos  = dot(vec3(0., 0., 1.), rd);\n        float specular1= smoothstep(0., 1., pow(gradpos, 5.));  // used for diffusity (some darker corona around light's specular reflections...)                          \n        float watershade  = test_shadow( uv, level );\n        watercolor *= 2.2+watershade;\n        watercolor += (.2+.8*watershade) * ((grad-1.0)*.5+specular) * .25;\n        watercolor /= (1.+specular1*1.25);\n        watercolor += watershade*specular2*water_specularcolor;\n        watercolor += watershade*coastfade*(1.-coastfade2)*(vec3(.5, .6, .7)*nautic(uv)+vec3(1., 1., 1.)*particles(uv));\n        \n        col = mix(col, watercolor, coastfade);\n    }\n    \n\n  float opacity = u_opacity;\n  gl_FragColor = vec4(col, opacity);  \n}\n",triangulation:Vet,primitive:m4.TRIANGLES,depth:{enable:!1},stencil:PK(r,o)});case 3:return a=t.sent,t.abrupt("return",[a]);case 5:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"clearModels",value:function(){var t,e,n;null===(t=this.texture1)||void 0===t||t.destroy(),null===(e=this.texture2)||void 0===e||e.destroy(),null===(n=this.texture3)||void 0===n||n.destroy()}},{key:"registerBuiltinAttributes",value:function(){var t=lZ(this.layer.getSource().extent,4),e=t[0],n=t[1],r=t[2],i=t[3],o=r-e,a=i-n;this.styleAttributeService.registerStyleAttribute({name:"oceanUv",type:d8.Attribute,descriptor:{name:"a_uv",buffer:{usage:m4.STATIC_DRAW,data:[],type:m4.FLOAT},size:2,update:function(t,r,i,s){var u=lZ(t.version===P9["GAODE2.x"]?t.originCoordinates[0][s]:i,2),c=u[0],l=u[1];return[(c-e)/o,(l-n)/a]}}})}},{key:"loadTexture",value:function(){var t,e,n,r=this,i=this.rendererService.createTexture2D,o={height:0,width:0};function a(t){return i({data:t,width:t.width,height:t.height,wrapS:m4.MIRRORED_REPEAT,wrapT:m4.MIRRORED_REPEAT,min:m4.LINEAR,mag:m4.LINEAR})}this.texture1=i(o),this.texture2=i(o),this.texture3=i(o),t=function(t){r.texture1=a(t[0]),r.texture2=a(t[1]),r.texture3=a(t[2]),r.layerService.reRender()},e=0,n=[],["https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ","https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*MJ22QbpuCzIAAAAAAAAAAAAAARQnAQ","https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*-z2HSIVDsHIAAAAAAAAAAAAAARQnAQ"].map((function(r){var i=new Image;i.crossOrigin="",i.src=r,n.push(i),i.onload=function(){3==++e&&t(n)}}))}}]),i}();function Ert(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var Art=function(t){wZ(i,oet);var e,n,r=Ert(i);function i(){return mZ(this,i),r.apply(this,arguments)}return gZ(i,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),e=t.opacity,n=void 0===e?1:e,r=t.speed,i=void 0===r?.5:r;return{u_texture:this.texture,u_speed:i,u_opacity:hZ.isNumber(n)?n:1}}},{key:"getAnimateUniforms",value:function(){return{u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:(n=RK(jK.mark((function t(){return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.loadTexture(),t.next=3,this.buildModels();case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"buildModels",value:(e=RK(jK.mark((function t(){var e,n,r,i,o,a;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.layer.getLayerConfig(),n=e.mask,r=void 0!==n&&n,i=e.maskInside,o=void 0===i||i,t.next=3,this.layer.buildLayerModel({moduleName:"polygonWater",vertexShader:'attribute vec4 a_Color;\nattribute vec2 a_uv;\nattribute vec3 a_Position;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\n\nvarying vec4 v_Color;\nvarying vec2 v_uv;\nuniform float u_opacity: 1.0;\n\n\n#pragma include "projection"\n\nvoid main() {\n  v_uv = a_uv;\n\n  v_Color = a_Color;\n  vec4 project_pos = project_position(vec4(a_Position, 1.0));\n\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));\n  } else {\n    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n  }\n}\n\n',fragmentShader:"uniform sampler2D u_texture;\nuniform float u_time: 0.0;\nuniform float u_speed: 1.0;\nuniform float u_opacity: 1.0;\n\nvarying vec4 v_Color;\nvarying vec2 v_uv;\n\nfloat rand(vec2 n) { return 0.5 + 0.5 * fract(sin(dot(n.xy, vec2(12.9898, 78.233)))* 43758.5453); }\n\nfloat water(vec3 p) {\n  float t = u_time * u_speed;\n  p.z += t * 2.; p.x += t * 2.;\n  vec3 c1 = texture2D(u_texture, p.xz / 30.).xyz;\n  p.z += t * 3.; p.x += t * 0.52;\n  vec3 c2 = texture2D(u_texture, p.xz / 30.).xyz;\n  p.z += t * 4.; p.x += t * 0.8;\n  vec3 c3 = texture2D(u_texture, p.xz / 30.).xyz;\n  c1 += c2 - c3;\n  float z = (c1.x + c1.y + c1.z) / 3.;\n  return p.y + z / 4.;\n}\n\nfloat map(vec3 p) {\n  float d = 100.0;\n  d = water(p);\n  return d;\n}\n\nfloat intersect(vec3 ro, vec3 rd) {\n  float d = 0.0;\n  for (int i = 0; i <= 100; i++) {\n    float h = map(ro + rd * d);\n    if (h < 0.1) return  d;\n    d += h;\n  }\n  return 0.0;\n}\n\nvec3 norm(vec3 p) {\n  float eps = .1;\n  return normalize(vec3(\n    map(p + vec3(eps, 0, 0)) - map(p + vec3(-eps, 0, 0)),\n    map(p + vec3(0, eps, 0)) - map(p + vec3(0, -eps, 0)),\n    map(p + vec3(0, 0, eps)) - map(p + vec3(0, 0, -eps))\n  ));\n} \n\nfloat calSpc() {\n  vec3 l1 = normalize(vec3(1, 1, 1));\n  vec3 ro = vec3(-3, 20, -8);\n  vec3 rc = vec3(0, 0, 0);\n  vec3 ww = normalize(rc - ro);\n  vec3 uu = normalize(cross(vec3(0,1,0), ww));\n  vec3 vv = normalize(cross(rc - ro, uu));\n  vec3 rd = normalize(uu * v_uv.x + vv * v_uv.y + ww);\n  float d = intersect(ro, rd);\n  vec3 p = ro + rd * d;\n  vec3 n = norm(p);\n  float spc = pow(max(0.0, dot(reflect(l1, n), rd)), 30.0);\n  return spc;\n}\n\nvoid main() {\n  float opacity = u_opacity;\n  gl_FragColor = v_Color;\n  gl_FragColor.a *= opacity;\n\n  float spc = calSpc();\n  gl_FragColor += spc * 0.4;\n}\n",triangulation:Vet,primitive:m4.TRIANGLES,depth:{enable:!1},stencil:PK(r,o)});case 3:return a=t.sent,t.abrupt("return",[a]);case 5:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"clearModels",value:function(){var t;null===(t=this.texture)||void 0===t||t.destroy()}},{key:"registerBuiltinAttributes",value:function(){var t=lZ(this.layer.getSource().extent,4),e=t[0],n=t[1],r=t[2],i=t[3],o=r-e,a=i-n;this.styleAttributeService.registerStyleAttribute({name:"waterUv",type:d8.Attribute,descriptor:{name:"a_uv",buffer:{usage:m4.STATIC_DRAW,data:[],type:m4.FLOAT},size:2,update:function(t,r,i,s){var u=lZ(t.version===P9["GAODE2.x"]?t.originCoordinates[0][s]:i,2),c=u[0],l=u[1];return[(c-e)/o,(l-n)/a]}}})}},{key:"loadTexture",value:function(){var t=this,e=this.layer.getLayerConfig().waterTexture,n=this.rendererService.createTexture2D;this.texture=n({height:0,width:0});var r=new Image;r.crossOrigin="",r.src=e||"https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ",r.onload=function(){t.texture=n({data:r,width:r.width,height:r.height,wrapS:m4.MIRRORED_REPEAT,wrapT:m4.MIRRORED_REPEAT,min:m4.LINEAR,mag:m4.LINEAR}),t.layerService.reRender()}}}]),i}();const Trt={fill:wrt,line:vnt,extrude:brt,text:prt,point_fill:Dnt,point_image:znt,point_normal:Gnt,point_extrude:Lnt,water:Art,ocean:Mrt};function Crt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var Ort=function(t){wZ(r,Ytt);var e,n=Crt(r);function r(){var t;mZ(this,r);for(var e=arguments.length,i=new Array(e),o=0;o<e;o++)i[o]=arguments[o];return $q(SZ(t=n.call.apply(n,[this].concat(i))),"type","PolygonLayer"),t}return gZ(r,[{key:"buildModels",value:(e=RK(jK.mark((function t(){var e;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.getModelType(),this.layerModel=new Trt[e](this),t.next=4,this.initLayerModels();case 4:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"getModelType",value:function(){var t,e=this.styleAttributeService.getLayerStyleAttribute("shape"),n=null==e||null===(t=e.scale)||void 0===t?void 0:t.field;return"fill"===n?"fill":"extrude"===n?"extrude":"water"===n?"water":"ocean"===n?"ocean":"line"===n?"line":this.getPointModelType()}},{key:"getPointModelType",value:function(){var t=this.getEncodedData(),e=this.getLayerConfig(),n=e.shape2d,r=e.shape3d,i=this.iconService.getIconMap(),o=t.find((function(t){return t.hasOwnProperty("shape")}));if(o){var a=o.shape;return"dot"===a?"point_normal":-1!==(null==n?void 0:n.indexOf(a))?"point_fill":-1!==(null==r?void 0:r.indexOf(a))?"point_extrude":i.hasOwnProperty(a)?"point_image":"text"}return"fill"}}]),r}();function krt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var Prt=function(t){wZ(o,oet);var e,n,r,i=krt(o);function o(){return mZ(this,o),i.apply(this,arguments)}return gZ(o,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),e=t.opacity,n=void 0===e?1:e,r=t.clampLow,i=void 0===r||r,o=t.clampHigh,a=void 0===o||o,s=t.noDataValue,u=void 0===s?-9999999:s,c=t.domain,l=t.rampColors,h=c||kK(l);return this.colorTexture=this.layer.textureService.getColorTexture(l,h),{u_opacity:n||1,u_texture:this.texture,u_domain:h,u_clampLow:i,u_clampHigh:void 0!==a?a:i,u_noDataValue:u,u_colorTexture:this.colorTexture}}},{key:"getRasterData",value:(r=RK(jK.mark((function t(e){var n,r,i,o;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!Array.isArray(e.data)){t.next=4;break}return t.abrupt("return",{data:e.data,width:e.width,height:e.height});case 4:return t.next=6,e.data;case 6:return n=t.sent,r=n.rasterData,i=n.width,o=n.height,t.abrupt("return",{data:Array.from(r),width:i,height:o});case 11:case"end":return t.stop()}}),t)}))),function(t){return r.apply(this,arguments)})},{key:"initModels",value:(n=RK(jK.mark((function t(){var e,n,r,i,o,a,s,u,c,l,h,f,p;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.layer.getLayerConfig(),n=e.mask,r=void 0!==n&&n,i=e.maskInside,o=void 0===i||i,a=this.layer.getSource(),s=this.rendererService.createTexture2D,u=a.data.dataArray[0],t.next=6,this.getRasterData(u);case 6:return c=t.sent,l=c.data,h=c.width,f=c.height,this.texture=s({data:l,width:h,height:f,format:m4.LUMINANCE,type:m4.FLOAT}),t.next=13,this.layer.buildLayerModel({moduleName:"rasterImageData",vertexShader:'precision highp float;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\nattribute vec3 a_Position;\nattribute vec2 a_Uv;\nvarying vec2 v_texCoord;\n#pragma include "projection"\nvoid main() {\n   v_texCoord = a_Uv;\n   vec4 project_pos = project_position(vec4(a_Position, 1.0));\n\n   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n      gl_Position = u_Mvp * (vec4(project_pos.xy,0., 1.0));\n   } else {\n      gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));\n   }\n}\n',fragmentShader:"precision mediump float;\nuniform float u_opacity: 1.0;\nuniform sampler2D u_texture;\nuniform sampler2D u_colorTexture;\nuniform float u_min;\nuniform float u_max;\nuniform vec2 u_domain;\nuniform float u_noDataValue;\nuniform bool u_clampLow: true;\nuniform bool u_clampHigh: true;\nvarying vec2 v_texCoord;\nbool isnan_emu(float x) { return (x > 0.0 || x < 0.0) ? x != x : x != 0.0; }\n\n\nvoid main() {\n\n  float value = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y)).r;\n  if (value == u_noDataValue || isnan_emu(value))\n    gl_FragColor = vec4(0.0, 0, 0, 0.0);\n  else if ((!u_clampLow && value < u_domain[0]) || (!u_clampHigh && value > u_domain[1]))\n    gl_FragColor = vec4(0, 0, 0, 0);\n  else {\n   \n    float normalisedValue =(value - u_domain[0]) / (u_domain[1] -u_domain[0]);\n    vec4 color = texture2D(u_colorTexture,vec2(normalisedValue, 0));\n    gl_FragColor = color;\n    gl_FragColor.a =  gl_FragColor.a * u_opacity ;\n  }\n}\n",triangulation:Yet,primitive:m4.TRIANGLES,depth:{enable:!1},stencil:PK(r,o)});case 13:return p=t.sent,t.abrupt("return",[p]);case 15:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"buildModels",value:(e=RK(jK.mark((function t(){return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.initModels();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"clearModels",value:function(){var t,e;null===(t=this.texture)||void 0===t||t.destroy(),null===(e=this.colorTexture)||void 0===e||e.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:d8.Attribute,descriptor:{name:"a_Uv",buffer:{usage:m4.DYNAMIC_DRAW,data:[],type:m4.FLOAT},size:2,update:function(t,e,n){return[n[3],n[4]]}}})}}]),o}(),Lrt=["data"],Rrt=["rasterData"];function Irt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var Nrt=function(t){wZ(o,oet);var e,n,r,i=Irt(o);function o(){var t;mZ(this,o);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return $q(SZ(t=i.call.apply(i,[this].concat(n))),"dataOption",{}),t}return gZ(o,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),e=t.opacity,n=void 0===e?1:e,r=t.noDataValue,i=void 0===r?0:r,o=this.dataOption,a=o.rMinMax,s=o.gMinMax,u=o.bMinMax;return{u_opacity:n||1,u_texture:this.texture,u_noDataValue:i,u_rminmax:a,u_gminmax:s,u_bminmax:u}}},{key:"getRasterData",value:(r=RK(jK.mark((function t(e){var n,r,i,o,a;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!Array.isArray(e.data)){t.next=4;break}return n=e.data,r=v1(e,Lrt),this.dataOption=r,t.abrupt("return",Jq({data:n},r));case 4:return t.next=6,e.data;case 6:if(i=t.sent,o=i.rasterData,a=v1(i,Rrt),this.dataOption=a,!Array.isArray(o)){t.next=14;break}return t.abrupt("return",Jq({data:o},a));case 14:return t.abrupt("return",Jq({data:Array.from(o)},a));case 15:case"end":return t.stop()}}),t,this)}))),function(t){return r.apply(this,arguments)})},{key:"initModels",value:(n=RK(jK.mark((function t(){var e,n,r,i,o,a,s,u,c,l,h,f,p;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.layer.getLayerConfig(),n=e.mask,r=void 0!==n&&n,i=e.maskInside,o=void 0===i||i,a=this.layer.getSource(),s=this.rendererService.createTexture2D,u=a.data.dataArray[0],t.next=6,this.getRasterData(u);case 6:return c=t.sent,l=c.data,h=c.width,f=c.height,this.texture=s({data:l,width:h,height:f,format:m4.RGB,type:m4.FLOAT}),t.next=13,this.layer.buildLayerModel({moduleName:"rasterImageDataRGBA",vertexShader:'precision highp float;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\nattribute vec3 a_Position;\nattribute vec2 a_Uv;\nvarying vec2 v_texCoord;\n#pragma include "projection"\nvoid main() {\n   v_texCoord = a_Uv;\n   vec4 project_pos = project_position(vec4(a_Position, 1.0));\n\n   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n      gl_Position = u_Mvp * (vec4(project_pos.xy,0., 1.0));\n   } else {\n      gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));\n   }\n}\n',fragmentShader:"precision mediump float;\nuniform vec2 u_rminmax: vec2(0,255); \nuniform vec2 u_gminmax: vec2(0,255);\nuniform vec2 u_bminmax: vec2(0,255);\nuniform float u_opacity: 1.0;\nuniform sampler2D u_texture;\nuniform float u_noDataValue : 0.0;\nvarying vec2 v_texCoord;\n\nvoid main() {\n  vec3 rgb = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y)).rgb;\n  if(rgb == vec3(u_noDataValue)) {\n    gl_FragColor = vec4(0.0, 0, 0, 0.0);\n  } else {\n    gl_FragColor = vec4(rgb.r / (u_rminmax.y -u_rminmax.x), rgb.g /(u_gminmax.y -u_gminmax.x), rgb.b/ (u_bminmax.y - u_bminmax.x), u_opacity);\n  }\n \n}",triangulation:Yet,primitive:m4.TRIANGLES,depth:{enable:!1},stencil:PK(r,o)});case 13:return p=t.sent,t.abrupt("return",[p]);case 15:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"buildModels",value:(e=RK(jK.mark((function t(){return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.initModels();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"clearModels",value:function(){var t;null===(t=this.texture)||void 0===t||t.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:d8.Attribute,descriptor:{name:"a_Uv",buffer:{usage:m4.DYNAMIC_DRAW,data:[],type:m4.FLOAT},size:2,update:function(t,e,n){return[n[3],n[4]]}}})}}]),o}();function Drt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var Frt=function(t){wZ(i,oet);var e,n,r=Drt(i);function i(){return mZ(this,i),r.apply(this,arguments)}return gZ(i,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),e=t.opacity,n=t.clampLow,r=void 0===n||n,i=t.clampHigh,o=void 0===i||i,a=t.noDataValue,s=void 0===a?-9999999:a,u=t.domain,c=t.rampColors,l=t.colorTexture,h=u||kK(c),f=l;return l?this.layer.textureService.setColorTexture(l,c,h):f=this.layer.textureService.getColorTexture(c,h),{u_opacity:e||1,u_texture:this.texture,u_domain:h,u_clampLow:r,u_clampHigh:void 0!==o?o:r,u_noDataValue:s,u_colorTexture:f}}},{key:"initModels",value:(n=RK(jK.mark((function t(){var e,n,r,i,o,a,s,u,c;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.layer.getLayerConfig(),n=e.mask,r=void 0!==n&&n,i=e.maskInside,o=void 0===i||i,a=this.layer.getSource(),s=this.rendererService.createTexture2D,t.next=5,a.data.images;case 5:return u=t.sent,this.texture=s({data:u[0],width:u[0].width,height:u[0].height}),t.next=9,this.layer.buildLayerModel({moduleName:"RasterTileDataImage",vertexShader:'precision highp float;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\nattribute vec3 a_Position;\nattribute vec2 a_Uv;\nvarying vec2 v_texCoord;\n#pragma include "projection"\nvoid main() {\n   v_texCoord = a_Uv;\n   vec4 project_pos = project_position(vec4(a_Position, 1.0));\n   // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));\n   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n      gl_Position = u_Mvp * (vec4(project_pos.xy,0., 1.0));\n   } else {\n      gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));\n   }\n}\n',fragmentShader:"precision mediump float;\nuniform float u_opacity: 1.0;\n\nuniform sampler2D u_texture;\nuniform sampler2D u_colorTexture;\n\nvarying vec2 v_texCoord;\n\nuniform vec2 u_domain;\nuniform float u_noDataValue;\nuniform bool u_clampLow: true;\nuniform bool u_clampHigh: true;\n\nvoid main() {\n  vec4 baseColor = texture2D(u_texture, vec2(v_texCoord.x, v_texCoord.y)) * 256.0;\n  float r = baseColor.r * 256.0 * 256.0;\n  float g = baseColor.g * 256.0;\n  float b = baseColor.b;\n  float value =  (r + g + b) * 0.1 - 10000.0;\n  \n  if (value == u_noDataValue) {\n    gl_FragColor = vec4(0.0, 0, 0, 0.0);\n  } else if ((!u_clampLow && value < u_domain[0]) || (!u_clampHigh && value > u_domain[1])) {\n     gl_FragColor = vec4(0.0, 0, 0, 0.0);\n  } else {\n    float normalisedValue =(value - u_domain[0]) / (u_domain[1] - u_domain[0]);\n    vec4 color = texture2D(u_colorTexture, vec2(normalisedValue, 0));\n    gl_FragColor = color;\n    gl_FragColor.a =  gl_FragColor.a * u_opacity ;\n  }\n}\n",triangulation:Yet,primitive:m4.TRIANGLES,depth:{enable:!1},blend:this.getBlend(),stencil:PK(r,o)});case 9:return c=t.sent,t.abrupt("return",[c]);case 11:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"clearModels",value:function(){var t;null===(t=this.texture)||void 0===t||t.destroy()}},{key:"buildModels",value:(e=RK(jK.mark((function t(){return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.initModels();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:d8.Attribute,descriptor:{name:"a_Uv",buffer:{usage:m4.DYNAMIC_DRAW,data:[],type:m4.FLOAT},size:2,update:function(t,e,n){return[n[3],n[4]]}}})}}]),i}();const jrt={raster:Prt,rasterRgb:Nrt,raster3d:Prt,rasterTerrainRgb:Frt};function Brt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var zrt=function(t){wZ(r,Ytt);var e,n=Brt(r);function r(){var t;mZ(this,r);for(var e=arguments.length,i=new Array(e),o=0;o<e;o++)i[o]=arguments[o];return $q(SZ(t=n.call.apply(n,[this].concat(i))),"type","RasterLayer"),t}return gZ(r,[{key:"buildModels",value:(e=RK(jK.mark((function t(){var e;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.getModelType(),this.layerModel=new jrt[e](this),t.next=4,this.initLayerModels();case 4:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"getDefaultConfig",value:function(){return{raster:{},rasterRgb:{},raster3d:{},rasterTerrainRgb:{}}[this.getModelType()]}},{key:"getModelType",value:function(){switch(this.layerSource.getParserType()){case"raster":default:return"raster";case"rasterRgb":return"rasterRgb";case"image":return"rasterTerrainRgb"}}}]),r}();function Urt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var Vrt=function(t){wZ(i,oet);var e,n,r=Urt(i);function i(){return mZ(this,i),r.apply(this,arguments)}return gZ(i,[{key:"getUninforms",value:function(){var t=this.layer.getLayerConfig(),e=t.opacity,n=void 0===e?0:e,r=t.color,i=void 0===r?"#000":r;return{u_opacity:hZ.isNumber(n)?n:0,u_color:EK(i)}}},{key:"initModels",value:(n=RK(jK.mark((function t(){return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.buildModels();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"buildModels",value:(e=RK(jK.mark((function t(){var e;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.layer.buildLayerModel({moduleName:"mask",vertexShader:'attribute vec3 a_Position;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\n\n#pragma include "projection"\n\nvoid main() {\n  vec4 project_pos = project_position(vec4(a_Position, 1.0));\n\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));\n  } else {\n    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n  }\n}\n\n',fragmentShader:"uniform float u_opacity : 1.0;\nuniform vec4 u_color;\n\nvoid main() {\n  gl_FragColor = u_color;\n  gl_FragColor.a *= u_opacity;\n}\n",triangulation:Vet,depth:{enable:!1},blend:this.getBlend(),stencil:{enable:!0,mask:255,func:{cmp:m4.ALWAYS,ref:1,mask:255},opFront:{fail:m4.REPLACE,zfail:m4.REPLACE,zpass:m4.REPLACE}},pick:!1});case 2:return e=t.sent,t.abrupt("return",[e]);case 4:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"clearModels",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];t&&this.layerService.clear()}},{key:"registerBuiltinAttributes",value:function(){return""}}]),i}();const Grt={fill:Vrt};function Wrt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var Hrt,Yrt,Xrt,qrt,Zrt,$rt,Krt,Jrt,Qrt=function(t){wZ(r,Ytt);var e,n=Wrt(r);function r(){var t;mZ(this,r);for(var e=arguments.length,i=new Array(e),o=0;o<e;o++)i[o]=arguments[o];return $q(SZ(t=n.call.apply(n,[this].concat(i))),"type","MaskLayer"),t}return gZ(r,[{key:"buildModels",value:(e=RK(jK.mark((function t(){var e;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.getModelType(),this.layerModel=new Grt[e](this),t.next=4,this.initLayerModels();case 4:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"getModelType",value:function(){return"fill"}}]),r}(),tit=(Hrt=Z2(),Yrt=d2(J2.IMapService),Xrt=d2(J2.IFontService),Hrt((Zrt=function(){function t(){mZ(this,t),F3(this,"mapService",$rt,this),F3(this,"fontService",Krt,this)}return gZ(t,[{key:"apply",value:function(t,e){var n=this,r=e.styleAttributeService;t.hooks.init.tapPromise("DataMappingPlugin",RK(jK.mark((function e(){return jK.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.generateMaping(t,{styleAttributeService:r});case 1:case"end":return e.stop()}}),e)})))),t.hooks.beforeRenderData.tapPromise("DataMappingPlugin",function(){var e=RK(jK.mark((function e(i){return jK.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i){e.next=2;break}return e.abrupt("return",i);case 2:return t.dataState.dataMappingNeedUpdate=!1,e.abrupt("return",n.generateMaping(t,{styleAttributeService:r}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),t.hooks.beforeRender.tap("DataMappingPlugin",(function(){var e=t.getSource();if(!t.layerModelNeedUpdate&&e&&e.inited){var i=r.getLayerStyleAttributes()||[],o=r.getLayerStyleAttribute("filter"),a=e.data.dataArray;if(!Array.isArray(a)||0!==a.length){var s=i.filter((function(t){return t.needRemapping})),u=a;if(null!=o&&o.needRemapping&&null!=o&&o.scale&&(u=a.filter((function(t){return n.applyAttributeMapping(o,t)[0]}))),s.length){var c=n.mapping(t,s,u,t.getEncodedData());t.setEncodedData(c)}}}}))}},{key:"generateMaping",value:function(t,e){var n=this,r=e.styleAttributeService,i=r.getLayerStyleAttributes()||[],o=r.getLayerStyleAttribute("filter"),a=t.getSource().data.dataArray,s=a;null!=o&&o.scale&&(s=a.filter((function(t){return n.applyAttributeMapping(o,t)[0]}))),s=t.processData(s);var u=this.mapping(t,i,s,void 0);return t.setEncodedData(u),(0!==a.length||0!==t.encodeDataLength)&&(t.emit("dataUpdate",null),!0)}},{key:"mapping",value:function(t,e,n,r){var i=this,o=t.getLayerConfig().arrow,a=void 0===o?{enable:!1}:o,s=e.filter((function(t){return void 0!==t.scale})).filter((function(t){return"filter"!==t.name})),u=n.map((function(e,n){var o=r?r[n]:{},u=Jq({id:e._id,coordinates:e.coordinates},o);if(s.forEach((function(t){var n=i.applyAttributeMapping(t,e);"color"===t.name&&(n=n.map((function(t){return EK(t)}))),u[t.name]=Array.isArray(n)&&1===n.length?n[0]:n,"shape"===t.name&&(u.shape=i.fontService.getIconFontKey(u[t.name]))})),a.enable&&("line"===u.shape||"halfLine"===u.shape)){var c=u.coordinates;if(t.arrowInsertCount<t.encodeDataLength){var l=i.getArrowPoints(c[0],c[1]);u.coordinates.splice(1,0,l,l),t.arrowInsertCount++}}return u}));return e.forEach((function(t){t.needRemapping=!1})),this.adjustData2Amap2Coordinates(u,t),this.adjustData2SimpleCoordinates(u),u}},{key:"adjustData2Amap2Coordinates",value:function(t,e){var n=this;if(t.length>0&&this.mapService.version===P9["GAODE2.x"]){var r=e.coordCenter||e.getSource().center;"number"==typeof t[0].coordinates[0]?t.filter((function(t){return!t.originCoordinates})).map((function(t){t.version=P9["GAODE2.x"],t.originCoordinates=hZ.cloneDeep(t.coordinates),t.coordinates=n.mapService.lngLatToCoordByLayer(t.coordinates,r)})):t.filter((function(t){return!t.originCoordinates})).map((function(t){t.version=P9["GAODE2.x"],t.originCoordinates=hZ.cloneDeep(t.coordinates),t.coordinates=n.mapService.lngLatToCoordsByLayer(t.coordinates,r)}))}}},{key:"adjustData2SimpleCoordinates",value:function(t){var e=this;t.length>0&&this.mapService.version===P9.SIMPLE&&t.map((function(t){t.simpleCoordinate||(t.coordinates=e.unProjectCoordinates(t.coordinates),t.simpleCoordinate=!0)}))}},{key:"unProjectCoordinates",value:function(t){var e=this;if("number"==typeof t[0])return this.mapService.simpleMapCoord.unproject(t);if(t[0]&&t[0][0]instanceof Array){var n=[];return t.map((function(t){var r=[];t.map((function(t){r.push(e.mapService.simpleMapCoord.unproject(t))})),n.push(r)})),n}var r=[];return t.map((function(t){r.push(e.mapService.simpleMapCoord.unproject(t))})),r}},{key:"applyAttributeMapping",value:function(t,e){var n;if(!t.scale)return[];var r=(null==t||null===(n=t.scale)||void 0===n?void 0:n.scalers)||[],i=[];return r.forEach((function(n){var r,o=n.field;(e.hasOwnProperty(o)||"variable"===(null===(r=t.scale)||void 0===r?void 0:r.type))&&i.push(e[o])})),t.mapping?t.mapping(i):[]}},{key:"getArrowPoints",value:function(t,e){var n=bK([e[0]-t[0],e[1]-t[1]]);return[t[0]+1e-4*n[0],t[1]+1e-4*n[1]]}}]),t}(),$rt=j3(Zrt.prototype,"mapService",[Yrt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Krt=j3(Zrt.prototype,"fontService",[Xrt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qrt=Zrt))||qrt),eit=Z2()(Jrt=function(){function t(){mZ(this,t)}return gZ(t,[{key:"apply",value:function(t){var e=this;this.mapService=t.getContainer().get(J2.IMapService),t.hooks.init.tapPromise("DataSourcePlugin",RK(jK.mark((function n(){var r,i,o,a;return jK.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if((r=t.getSource())||(i=t.sourceOption||t.defaultSourceConfig,o=i.data,a=i.options,r=new K8(o,a),t.setSource(r)),!r.inited){n.next=6;break}e.updateClusterData(t),n.next=8;break;case 6:return n.next=8,new Promise((function(n){r.on("update",(function(r){"inited"===r.type&&e.updateClusterData(t),n(null)}))}));case 8:case"end":return n.stop()}}),n)})))),t.hooks.beforeRenderData.tapPromise("DataSourcePlugin",RK(jK.mark((function n(){var r,i;return jK.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=e.updateClusterData(t),i=t.dataState.dataSourceNeedUpdate,t.dataState.dataSourceNeedUpdate=!1,n.abrupt("return",r||i);case 4:case"end":return n.stop()}}),n)}))))}},{key:"updateClusterData",value:function(t){if(t.isTileLayer||t.tileLayer||!t.getSource())return!1;var e=t.getSource(),n=e.cluster,r=e.clusterOptions.zoom,i=void 0===r?0:r,o=this.mapService.getZoom()-1,a=t.dataState.dataSourceNeedUpdate;return n&&a&&e.updateClusterData(Math.floor(o)),!!(n&&Math.abs(t.clusterZoom-o)>=1)&&(i!==Math.floor(o)&&e.updateClusterData(Math.floor(o)),t.clusterZoom=o,!0)}}]),t}())||Jrt;function nit(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function rit(t){var e;return 1===t.length&&(e=t,t=function(t,n){return nit(e(t),n)}),{left:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var o=r+i>>>1;t(e[o],n)<0?r=o+1:i=o}return r},right:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var o=r+i>>>1;t(e[o],n)>0?i=o:r=o+1}return r}}}var iit=rit(nit).right;function oit(t){return null===t?NaN:+t}function ait(t,e){var n,r,i,o=t.length,a=-1;if(null==e){for(;++a<o;)if(null!=(n=t[a])&&n>=n)for(r=i=n;++a<o;)null!=(n=t[a])&&(r>n&&(r=n),i<n&&(i=n))}else for(;++a<o;)if(null!=(n=e(t[a],a,t))&&n>=n)for(r=i=n;++a<o;)null!=(n=e(t[a],a,t))&&(r>n&&(r=n),i<n&&(i=n));return[r,i]}var sit=Math.sqrt(50),uit=Math.sqrt(10),cit=Math.sqrt(2);function lit(t,e,n){var r,i,o,a,s=-1;if(n=+n,(t=+t)===(e=+e)&&n>0)return[t];if((r=e<t)&&(i=t,t=e,e=i),0===(a=hit(t,e,n))||!isFinite(a))return[];if(a>0)for(t=Math.ceil(t/a),e=Math.floor(e/a),o=new Array(i=Math.ceil(e-t+1));++s<i;)o[s]=(t+s)*a;else for(t=Math.floor(t*a),e=Math.ceil(e*a),o=new Array(i=Math.ceil(t-e+1));++s<i;)o[s]=(t-s)/a;return r&&o.reverse(),o}function hit(t,e,n){var r=(e-t)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),o=r/Math.pow(10,i);return i>=0?(o>=sit?10:o>=uit?5:o>=cit?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(o>=sit?10:o>=uit?5:o>=cit?2:1)}function fit(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),o=r/i;return o>=sit?i*=10:o>=uit?i*=5:o>=cit&&(i*=2),e<t?-i:i}function pit(t,e,n){if(null==n&&(n=oit),r=t.length){if((e=+e)<=0||r<2)return+n(t[0],0,t);if(e>=1)return+n(t[r-1],r-1,t);var r,i=(r-1)*e,o=Math.floor(i),a=+n(t[o],o,t);return a+(+n(t[o+1],o+1,t)-a)*(i-o)}}function dit(t){return function(){return t}}function mit(t){return 1==(t=+t)?vit:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):dit(isNaN(e)?n:e)}}function vit(t,e){var n=e-t;return n?function(t,e){return function(n){return t+n*e}}(t,n):dit(isNaN(t)?e:t)}const git=function t(e){var n=mit(e);function r(t,e){var r=n((t=Vu(t)).r,(e=Vu(e)).r),i=n(t.g,e.g),o=n(t.b,e.b),a=vit(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=o(e),t.opacity=a(e),t+""}}return r.gamma=t,r}(1);var yit=function(t){return function(e){var n,r,i=e.length,o=new Array(i),a=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=Vu(e[n]),o[n]=r.r||0,a[n]=r.g||0,s[n]=r.b||0;return o=t(o),a=t(a),s=t(s),r.opacity=1,function(t){return r.r=o(t),r.g=a(t),r.b=s(t),r+""}}}((function(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],o=t[r+1],a=r>0?t[r-1]:2*i-o,s=r<e-1?t[r+2]:2*o-i;return function(t,e,n,r,i){var o=t*t,a=o*t;return((1-3*t+3*o-a)*e+(4-6*o+3*a)*n+(1+3*t+3*o-3*a)*r+a*i)/6}((n-r/e)*e,a,i,o,s)}}));function xit(t,e){e||(e=[]);var n,r=t?Math.min(e.length,t.length):0,i=e.slice();return function(o){for(n=0;n<r;++n)i[n]=t[n]*(1-o)+e[n]*o;return i}}function bit(t,e){var n,r=e?e.length:0,i=t?Math.min(r,t.length):0,o=new Array(i),a=new Array(r);for(n=0;n<i;++n)o[n]=Tit(t[n],e[n]);for(;n<r;++n)a[n]=e[n];return function(t){for(n=0;n<i;++n)a[n]=o[n](t);return a}}function _it(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function wit(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function Sit(t,e){var n,r={},i={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?r[n]=Tit(t[n],e[n]):i[n]=e[n];return function(t){for(n in r)i[n]=r[n](t);return i}}var Mit=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Eit=new RegExp(Mit.source,"g");function Ait(t,e){var n,r,i,o=Mit.lastIndex=Eit.lastIndex=0,a=-1,s=[],u=[];for(t+="",e+="";(n=Mit.exec(t))&&(r=Eit.exec(e));)(i=r.index)>o&&(i=e.slice(o,i),s[a]?s[a]+=i:s[++a]=i),(n=n[0])===(r=r[0])?s[a]?s[a]+=r:s[++a]=r:(s[++a]=null,u.push({i:a,x:wit(n,r)})),o=Eit.lastIndex;return o<e.length&&(i=e.slice(o),s[a]?s[a]+=i:s[++a]=i),s.length<2?u[0]?function(t){return function(e){return t(e)+""}}(u[0].x):function(t){return function(){return t}}(e):(e=u.length,function(t){for(var n,r=0;r<e;++r)s[(n=u[r]).i]=n.x(t);return s.join("")})}function Tit(t,e){var n,r=typeof e;return null==e||"boolean"===r?dit(e):("number"===r?wit:"string"===r?(n=ju(e))?(e=n,git):Ait:e instanceof ju?git:e instanceof Date?_it:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}(e)?xit:Array.isArray(e)?bit:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?Sit:wit)(t,e)}function Cit(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function Oit(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}function kit(t,e){switch(arguments.length){case 0:break;case 1:this.interpolator(t);break;default:this.interpolator(e).domain(t)}return this}var Pit="$";function Lit(){}function Rit(t,e){var n=new Lit;if(t instanceof Lit)t.each((function(t,e){n.set(e,t)}));else if(Array.isArray(t)){var r,i=-1,o=t.length;if(null==e)for(;++i<o;)n.set(i,t[i]);else for(;++i<o;)n.set(e(r=t[i],i,t),r)}else if(t)for(var a in t)n.set(a,t[a]);return n}function Iit(){}Lit.prototype=Rit.prototype={constructor:Lit,has:function(t){return Pit+t in this},get:function(t){return this[Pit+t]},set:function(t,e){return this[Pit+t]=e,this},remove:function(t){var e=Pit+t;return e in this&&delete this[e]},clear:function(){for(var t in this)t[0]===Pit&&delete this[t]},keys:function(){var t=[];for(var e in this)e[0]===Pit&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)e[0]===Pit&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)e[0]===Pit&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)e[0]===Pit&&++t;return t},empty:function(){for(var t in this)if(t[0]===Pit)return!1;return!0},each:function(t){for(var e in this)e[0]===Pit&&t(this[e],e.slice(1),this)}};var Nit=Rit.prototype;Iit.prototype={constructor:Iit,has:Nit.has,add:function(t){return this[Pit+(t+="")]=t,this},remove:Nit.remove,clear:Nit.clear,values:Nit.keys,size:Nit.size,empty:Nit.empty,each:Nit.each};var Dit=Array.prototype,Fit=Dit.map,jit=Dit.slice,Bit={name:"implicit"};function zit(){var t=Rit(),e=[],n=[],r=Bit;function i(i){var o=i+"",a=t.get(o);if(!a){if(r!==Bit)return r;t.set(o,a=e.push(i))}return n[(a-1)%n.length]}return i.domain=function(n){if(!arguments.length)return e.slice();e=[],t=Rit();for(var r,o,a=-1,s=n.length;++a<s;)t.has(o=(r=n[a])+"")||t.set(o,e.push(r));return i},i.range=function(t){return arguments.length?(n=jit.call(t),i):n.slice()},i.unknown=function(t){return arguments.length?(r=t,i):r},i.copy=function(){return zit(e,n).unknown(r)},Oit.apply(i,arguments),i}function Uit(t){return+t}var Vit=[0,1];function Git(t){return t}function Wit(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:function(t){return function(){return t}}(isNaN(e)?NaN:.5)}function Hit(t){var e,n=t[0],r=t[t.length-1];return n>r&&(e=n,n=r,r=e),function(t){return Math.max(n,Math.min(r,t))}}function Yit(t,e,n){var r=t[0],i=t[1],o=e[0],a=e[1];return i<r?(r=Wit(i,r),o=n(a,o)):(r=Wit(r,i),o=n(o,a)),function(t){return o(r(t))}}function Xit(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),o=new Array(r),a=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<r;)i[a]=Wit(t[a],t[a+1]),o[a]=n(e[a],e[a+1]);return function(e){var n=iit(t,e,1,r)-1;return o[n](i[n](e))}}function qit(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Zit(){var t,e,n,r,i,o,a=Vit,s=Vit,u=Tit,c=Git;function l(){return r=Math.min(a.length,s.length)>2?Xit:Yit,i=o=null,h}function h(e){return isNaN(e=+e)?n:(i||(i=r(a.map(t),s,u)))(t(c(e)))}return h.invert=function(n){return c(e((o||(o=r(s,a.map(t),wit)))(n)))},h.domain=function(t){return arguments.length?(a=Fit.call(t,Uit),c===Git||(c=Hit(a)),l()):a.slice()},h.range=function(t){return arguments.length?(s=jit.call(t),l()):s.slice()},h.rangeRound=function(t){return s=jit.call(t),u=Cit,l()},h.clamp=function(t){return arguments.length?(c=t?Hit(a):Git,h):c!==Git},h.interpolate=function(t){return arguments.length?(u=t,l()):u},h.unknown=function(t){return arguments.length?(n=t,h):n},function(n,r){return t=n,e=r,l()}}function $it(t,e){return Zit()(t,e)}function Kit(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function Jit(t){return(t=Kit(Math.abs(t)))?t[1]:NaN}var Qit,tot=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function eot(t){if(!(e=tot.exec(t)))throw new Error("invalid format: "+t);var e;return new not({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function not(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function rot(t,e){var n=Kit(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}eot.prototype=not.prototype,not.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const iot={"%":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return rot(100*t,e)},r:rot,s:function(t,e){var n=Kit(t,e);if(!n)return t+"";var r=n[0],i=n[1],o=i-(Qit=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+Kit(t,Math.max(0,e+o-1))[0]},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}};function oot(t){return t}var aot,sot,uot,cot=Array.prototype.map,lot=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function hot(t){var e,n,r=void 0===t.grouping||void 0===t.thousands?oot:(e=cot.call(t.grouping,Number),n=t.thousands+"",function(t,r){for(var i=t.length,o=[],a=0,s=e[0],u=0;i>0&&s>0&&(u+s+1>r&&(s=Math.max(1,r-u)),o.push(t.substring(i-=s,i+s)),!((u+=s+1)>r));)s=e[a=(a+1)%e.length];return o.reverse().join(n)}),i=void 0===t.currency?"":t.currency[0]+"",o=void 0===t.currency?"":t.currency[1]+"",a=void 0===t.decimal?".":t.decimal+"",s=void 0===t.numerals?oot:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(cot.call(t.numerals,String)),u=void 0===t.percent?"%":t.percent+"",c=void 0===t.minus?"-":t.minus+"",l=void 0===t.nan?"NaN":t.nan+"";function h(t){var e=(t=eot(t)).fill,n=t.align,h=t.sign,f=t.symbol,p=t.zero,d=t.width,m=t.comma,v=t.precision,g=t.trim,y=t.type;"n"===y?(m=!0,y="g"):iot[y]||(void 0===v&&(v=12),g=!0,y="g"),(p||"0"===e&&"="===n)&&(p=!0,e="0",n="=");var x="$"===f?i:"#"===f&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",b="$"===f?o:/[%p]/.test(y)?u:"",_=iot[y],w=/[defgprs%]/.test(y);function S(t){var i,o,u,f=x,S=b;if("c"===y)S=_(t)+S,t="";else{var M=(t=+t)<0||1/t<0;if(t=isNaN(t)?l:_(Math.abs(t),v),g&&(t=function(t){t:for(var e,n=t.length,r=1,i=-1;r<n;++r)switch(t[r]){case".":i=e=r;break;case"0":0===i&&(i=r),e=r;break;default:if(!+t[r])break t;i>0&&(i=0)}return i>0?t.slice(0,i)+t.slice(e+1):t}(t)),M&&0==+t&&"+"!==h&&(M=!1),f=(M?"("===h?h:c:"-"===h||"("===h?"":h)+f,S=("s"===y?lot[8+Qit/3]:"")+S+(M&&"("===h?")":""),w)for(i=-1,o=t.length;++i<o;)if(48>(u=t.charCodeAt(i))||u>57){S=(46===u?a+t.slice(i+1):t.slice(i))+S,t=t.slice(0,i);break}}m&&!p&&(t=r(t,1/0));var E=f.length+t.length+S.length,A=E<d?new Array(d-E+1).join(e):"";switch(m&&p&&(t=r(A+t,A.length?d-S.length:1/0),A=""),n){case"<":t=f+t+S+A;break;case"=":t=f+A+t+S;break;case"^":t=A.slice(0,E=A.length>>1)+f+t+S+A.slice(E);break;default:t=A+f+t+S}return s(t)}return v=void 0===v?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,v)):Math.max(0,Math.min(20,v)),S.toString=function(){return t+""},S}return{format:h,formatPrefix:function(t,e){var n=h(((t=eot(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(Jit(e)/3))),i=Math.pow(10,-r),o=lot[8+r/3];return function(t){return n(i*t)+o}}}}function fot(t,e,n,r){var i,o=fit(t,e,n);switch((r=eot(null==r?",f":r)).type){case"s":var a=Math.max(Math.abs(t),Math.abs(e));return null!=r.precision||isNaN(i=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Jit(e)/3)))-Jit(Math.abs(t)))}(o,a))||(r.precision=i),uot(r,a);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Jit(e)-Jit(t))+1}(o,Math.max(Math.abs(t),Math.abs(e))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=function(t){return Math.max(0,-Jit(Math.abs(t)))}(o))||(r.precision=i-2*("%"===r.type))}return sot(r)}function pot(t){var e=t.domain;return t.ticks=function(t){var n=e();return lit(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var r=e();return fot(r[0],r[r.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var r,i=e(),o=0,a=i.length-1,s=i[o],u=i[a];return u<s&&(r=s,s=u,u=r,r=o,o=a,a=r),(r=hit(s,u,n))>0?r=hit(s=Math.floor(s/r)*r,u=Math.ceil(u/r)*r,n):r<0&&(r=hit(s=Math.ceil(s*r)/r,u=Math.floor(u*r)/r,n)),r>0?(i[o]=Math.floor(s/r)*r,i[a]=Math.ceil(u/r)*r,e(i)):r<0&&(i[o]=Math.ceil(s*r)/r,i[a]=Math.floor(u*r)/r,e(i)),t},t}function dot(t,e){var n,r=0,i=(t=t.slice()).length-1,o=t[r],a=t[i];return a<o&&(n=r,r=i,i=n,n=o,o=a,a=n),t[r]=e.floor(o),t[i]=e.ceil(a),t}function mot(t){return Math.log(t)}function vot(t){return Math.exp(t)}function got(t){return-Math.log(-t)}function yot(t){return-Math.exp(-t)}function xot(t){return isFinite(t)?+("1e"+t):t<0?0:t}function bot(t){return function(e){return-t(-e)}}function _ot(t){var e,n,r=t(mot,vot),i=r.domain,o=10;function a(){return e=function(t){return t===Math.E?Math.log:10===t&&Math.log10||2===t&&Math.log2||(t=Math.log(t),function(e){return Math.log(e)/t})}(o),n=function(t){return 10===t?xot:t===Math.E?Math.exp:function(e){return Math.pow(t,e)}}(o),i()[0]<0?(e=bot(e),n=bot(n),t(got,yot)):t(mot,vot),r}return r.base=function(t){return arguments.length?(o=+t,a()):o},r.domain=function(t){return arguments.length?(i(t),a()):i()},r.ticks=function(t){var r,a=i(),s=a[0],u=a[a.length-1];(r=u<s)&&(f=s,s=u,u=f);var c,l,h,f=e(s),p=e(u),d=null==t?10:+t,m=[];if(!(o%1)&&p-f<d){if(f=Math.round(f)-1,p=Math.round(p)+1,s>0){for(;f<p;++f)for(l=1,c=n(f);l<o;++l)if(!((h=c*l)<s)){if(h>u)break;m.push(h)}}else for(;f<p;++f)for(l=o-1,c=n(f);l>=1;--l)if(!((h=c*l)<s)){if(h>u)break;m.push(h)}}else m=lit(f,p,Math.min(p-f,d)).map(n);return r?m.reverse():m},r.tickFormat=function(t,i){if(null==i&&(i=10===o?".0e":","),"function"!=typeof i&&(i=sot(i)),t===1/0)return i;null==t&&(t=10);var a=Math.max(1,o*t/r.ticks().length);return function(t){var r=t/n(Math.round(e(t)));return r*o<o-.5&&(r*=o),r<=a?i(t):""}},r.nice=function(){return i(dot(i(),{floor:function(t){return n(Math.floor(e(t)))},ceil:function(t){return n(Math.ceil(e(t)))}}))},r}function wot(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function Sot(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function Mot(t){return t<0?-t*t:t*t}function Eot(t){var e=t(Git,Git),n=1;function r(){return 1===n?t(Git,Git):.5===n?t(Sot,Mot):t(wot(n),wot(1/n))}return e.exponent=function(t){return arguments.length?(n=+t,r()):n},pot(e)}!function(t){aot=hot(t),sot=aot.format,uot=aot.formatPrefix}({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});var Aot=new Date,Tot=new Date;function Cot(t,e,n,r){function i(e){return t(e=0===arguments.length?new Date:new Date(+e)),e}return i.floor=function(e){return t(e=new Date(+e)),e},i.ceil=function(n){return t(n=new Date(n-1)),e(n,1),t(n),n},i.round=function(t){var e=i(t),n=i.ceil(t);return t-e<n-t?e:n},i.offset=function(t,n){return e(t=new Date(+t),null==n?1:Math.floor(n)),t},i.range=function(n,r,o){var a,s=[];if(n=i.ceil(n),o=null==o?1:Math.floor(o),!(n<r&&o>0))return s;do{s.push(a=new Date(+n)),e(n,o),t(n)}while(a<n&&n<r);return s},i.filter=function(n){return Cot((function(e){if(e>=e)for(;t(e),!n(e);)e.setTime(e-1)}),(function(t,r){if(t>=t)if(r<0)for(;++r<=0;)for(;e(t,-1),!n(t););else for(;--r>=0;)for(;e(t,1),!n(t););}))},n&&(i.count=function(e,r){return Aot.setTime(+e),Tot.setTime(+r),t(Aot),t(Tot),Math.floor(n(Aot,Tot))},i.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?i.filter(r?function(e){return r(e)%t==0}:function(e){return i.count(0,e)%t==0}):i:null}),i}var Oot=Cot((function(){}),(function(t,e){t.setTime(+t+e)}),(function(t,e){return e-t}));Oot.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?Cot((function(e){e.setTime(Math.floor(e/t)*t)}),(function(e,n){e.setTime(+e+n*t)}),(function(e,n){return(n-e)/t})):Oot:null};const kot=Oot;Oot.range;var Pot=1e3,Lot=6e4,Rot=36e5,Iot=864e5,Not=6048e5,Dot=Cot((function(t){t.setTime(t-t.getMilliseconds())}),(function(t,e){t.setTime(+t+e*Pot)}),(function(t,e){return(e-t)/Pot}),(function(t){return t.getUTCSeconds()}));const Fot=Dot;Dot.range;var jot=Cot((function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*Pot)}),(function(t,e){t.setTime(+t+e*Lot)}),(function(t,e){return(e-t)/Lot}),(function(t){return t.getMinutes()}));const Bot=jot;jot.range;var zot=Cot((function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*Pot-t.getMinutes()*Lot)}),(function(t,e){t.setTime(+t+e*Rot)}),(function(t,e){return(e-t)/Rot}),(function(t){return t.getHours()}));const Uot=zot;zot.range;var Vot=Cot((function(t){t.setHours(0,0,0,0)}),(function(t,e){t.setDate(t.getDate()+e)}),(function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Lot)/Iot}),(function(t){return t.getDate()-1}));const Got=Vot;function Wot(t){return Cot((function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)}),(function(t,e){t.setDate(t.getDate()+7*e)}),(function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Lot)/Not}))}Vot.range;var Hot=Wot(0),Yot=Wot(1),Xot=Wot(2),qot=Wot(3),Zot=Wot(4),$ot=Wot(5),Kot=Wot(6);Hot.range,Yot.range,Xot.range,qot.range,Zot.range,$ot.range,Kot.range;var Jot=Cot((function(t){t.setDate(1),t.setHours(0,0,0,0)}),(function(t,e){t.setMonth(t.getMonth()+e)}),(function(t,e){return e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())}),(function(t){return t.getMonth()}));const Qot=Jot;Jot.range;var tat=Cot((function(t){t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,e){t.setFullYear(t.getFullYear()+e)}),(function(t,e){return e.getFullYear()-t.getFullYear()}),(function(t){return t.getFullYear()}));tat.every=function(t){return isFinite(t=Math.floor(t))&&t>0?Cot((function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,n){e.setFullYear(e.getFullYear()+n*t)})):null};const eat=tat;tat.range;var nat=Cot((function(t){t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+e)}),(function(t,e){return(e-t)/Iot}),(function(t){return t.getUTCDate()-1}));const rat=nat;function iat(t){return Cot((function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+7*e)}),(function(t,e){return(e-t)/Not}))}nat.range;var oat=iat(0),aat=iat(1),sat=iat(2),uat=iat(3),cat=iat(4),lat=iat(5),hat=iat(6);oat.range,aat.range,sat.range,uat.range,cat.range,lat.range,hat.range;var fat=Cot((function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)}),(function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()}),(function(t){return t.getUTCFullYear()}));fat.every=function(t){return isFinite(t=Math.floor(t))&&t>0?Cot((function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)})):null};const pat=fat;function dat(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function mat(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function vat(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}fat.range;var gat,yat,xat={"-":"",_:" ",0:"0"},bat=/^\s*\d+/,_at=/^%/,wat=/[\\^$*+?|[\]().{}]/g;function Sat(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(e)+i:i)}function Mat(t){return t.replace(wat,"\\$&")}function Eat(t){return new RegExp("^(?:"+t.map(Mat).join("|")+")","i")}function Aat(t){for(var e={},n=-1,r=t.length;++n<r;)e[t[n].toLowerCase()]=n;return e}function Tat(t,e,n){var r=bat.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function Cat(t,e,n){var r=bat.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function Oat(t,e,n){var r=bat.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function kat(t,e,n){var r=bat.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function Pat(t,e,n){var r=bat.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function Lat(t,e,n){var r=bat.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function Rat(t,e,n){var r=bat.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function Iat(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function Nat(t,e,n){var r=bat.exec(e.slice(n,n+1));return r?(t.q=3*r[0]-3,n+r[0].length):-1}function Dat(t,e,n){var r=bat.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function Fat(t,e,n){var r=bat.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function jat(t,e,n){var r=bat.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function Bat(t,e,n){var r=bat.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function zat(t,e,n){var r=bat.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function Uat(t,e,n){var r=bat.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function Vat(t,e,n){var r=bat.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function Gat(t,e,n){var r=bat.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function Wat(t,e,n){var r=_at.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function Hat(t,e,n){var r=bat.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function Yat(t,e,n){var r=bat.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function Xat(t,e){return Sat(t.getDate(),e,2)}function qat(t,e){return Sat(t.getHours(),e,2)}function Zat(t,e){return Sat(t.getHours()%12||12,e,2)}function $at(t,e){return Sat(1+Got.count(eat(t),t),e,3)}function Kat(t,e){return Sat(t.getMilliseconds(),e,3)}function Jat(t,e){return Kat(t,e)+"000"}function Qat(t,e){return Sat(t.getMonth()+1,e,2)}function tst(t,e){return Sat(t.getMinutes(),e,2)}function est(t,e){return Sat(t.getSeconds(),e,2)}function nst(t){var e=t.getDay();return 0===e?7:e}function rst(t,e){return Sat(Hot.count(eat(t)-1,t),e,2)}function ist(t){var e=t.getDay();return e>=4||0===e?Zot(t):Zot.ceil(t)}function ost(t,e){return t=ist(t),Sat(Zot.count(eat(t),t)+(4===eat(t).getDay()),e,2)}function ast(t){return t.getDay()}function sst(t,e){return Sat(Yot.count(eat(t)-1,t),e,2)}function ust(t,e){return Sat(t.getFullYear()%100,e,2)}function cst(t,e){return Sat((t=ist(t)).getFullYear()%100,e,2)}function lst(t,e){return Sat(t.getFullYear()%1e4,e,4)}function hst(t,e){var n=t.getDay();return Sat((t=n>=4||0===n?Zot(t):Zot.ceil(t)).getFullYear()%1e4,e,4)}function fst(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+Sat(e/60|0,"0",2)+Sat(e%60,"0",2)}function pst(t,e){return Sat(t.getUTCDate(),e,2)}function dst(t,e){return Sat(t.getUTCHours(),e,2)}function mst(t,e){return Sat(t.getUTCHours()%12||12,e,2)}function vst(t,e){return Sat(1+rat.count(pat(t),t),e,3)}function gst(t,e){return Sat(t.getUTCMilliseconds(),e,3)}function yst(t,e){return gst(t,e)+"000"}function xst(t,e){return Sat(t.getUTCMonth()+1,e,2)}function bst(t,e){return Sat(t.getUTCMinutes(),e,2)}function _st(t,e){return Sat(t.getUTCSeconds(),e,2)}function wst(t){var e=t.getUTCDay();return 0===e?7:e}function Sst(t,e){return Sat(oat.count(pat(t)-1,t),e,2)}function Mst(t){var e=t.getUTCDay();return e>=4||0===e?cat(t):cat.ceil(t)}function Est(t,e){return t=Mst(t),Sat(cat.count(pat(t),t)+(4===pat(t).getUTCDay()),e,2)}function Ast(t){return t.getUTCDay()}function Tst(t,e){return Sat(aat.count(pat(t)-1,t),e,2)}function Cst(t,e){return Sat(t.getUTCFullYear()%100,e,2)}function Ost(t,e){return Sat((t=Mst(t)).getUTCFullYear()%100,e,2)}function kst(t,e){return Sat(t.getUTCFullYear()%1e4,e,4)}function Pst(t,e){var n=t.getUTCDay();return Sat((t=n>=4||0===n?cat(t):cat.ceil(t)).getUTCFullYear()%1e4,e,4)}function Lst(){return"+0000"}function Rst(){return"%"}function Ist(t){return+t}function Nst(t){return Math.floor(+t/1e3)}!function(t){gat=function(t){var e=t.dateTime,n=t.date,r=t.time,i=t.periods,o=t.days,a=t.shortDays,s=t.months,u=t.shortMonths,c=Eat(i),l=Aat(i),h=Eat(o),f=Aat(o),p=Eat(a),d=Aat(a),m=Eat(s),v=Aat(s),g=Eat(u),y=Aat(u),x={a:function(t){return a[t.getDay()]},A:function(t){return o[t.getDay()]},b:function(t){return u[t.getMonth()]},B:function(t){return s[t.getMonth()]},c:null,d:Xat,e:Xat,f:Jat,g:cst,G:hst,H:qat,I:Zat,j:$at,L:Kat,m:Qat,M:tst,p:function(t){return i[+(t.getHours()>=12)]},q:function(t){return 1+~~(t.getMonth()/3)},Q:Ist,s:Nst,S:est,u:nst,U:rst,V:ost,w:ast,W:sst,x:null,X:null,y:ust,Y:lst,Z:fst,"%":Rst},b={a:function(t){return a[t.getUTCDay()]},A:function(t){return o[t.getUTCDay()]},b:function(t){return u[t.getUTCMonth()]},B:function(t){return s[t.getUTCMonth()]},c:null,d:pst,e:pst,f:yst,g:Ost,G:Pst,H:dst,I:mst,j:vst,L:gst,m:xst,M:bst,p:function(t){return i[+(t.getUTCHours()>=12)]},q:function(t){return 1+~~(t.getUTCMonth()/3)},Q:Ist,s:Nst,S:_st,u:wst,U:Sst,V:Est,w:Ast,W:Tst,x:null,X:null,y:Cst,Y:kst,Z:Lst,"%":Rst},_={a:function(t,e,n){var r=p.exec(e.slice(n));return r?(t.w=d[r[0].toLowerCase()],n+r[0].length):-1},A:function(t,e,n){var r=h.exec(e.slice(n));return r?(t.w=f[r[0].toLowerCase()],n+r[0].length):-1},b:function(t,e,n){var r=g.exec(e.slice(n));return r?(t.m=y[r[0].toLowerCase()],n+r[0].length):-1},B:function(t,e,n){var r=m.exec(e.slice(n));return r?(t.m=v[r[0].toLowerCase()],n+r[0].length):-1},c:function(t,n,r){return M(t,e,n,r)},d:Fat,e:Fat,f:Gat,g:Rat,G:Lat,H:Bat,I:Bat,j:jat,L:Vat,m:Dat,M:zat,p:function(t,e,n){var r=c.exec(e.slice(n));return r?(t.p=l[r[0].toLowerCase()],n+r[0].length):-1},q:Nat,Q:Hat,s:Yat,S:Uat,u:Cat,U:Oat,V:kat,w:Tat,W:Pat,x:function(t,e,r){return M(t,n,e,r)},X:function(t,e,n){return M(t,r,e,n)},y:Rat,Y:Lat,Z:Iat,"%":Wat};function w(t,e){return function(n){var r,i,o,a=[],s=-1,u=0,c=t.length;for(n instanceof Date||(n=new Date(+n));++s<c;)37===t.charCodeAt(s)&&(a.push(t.slice(u,s)),null!=(i=xat[r=t.charAt(++s)])?r=t.charAt(++s):i="e"===r?" ":"0",(o=e[r])&&(r=o(n,i)),a.push(r),u=s+1);return a.push(t.slice(u,s)),a.join("")}}function S(t,e){return function(n){var r,i,o=vat(1900,void 0,1);if(M(o,t,n+="",0)!=n.length)return null;if("Q"in o)return new Date(o.Q);if("s"in o)return new Date(1e3*o.s+("L"in o?o.L:0));if(e&&!("Z"in o)&&(o.Z=0),"p"in o&&(o.H=o.H%12+12*o.p),void 0===o.m&&(o.m="q"in o?o.q:0),"V"in o){if(o.V<1||o.V>53)return null;"w"in o||(o.w=1),"Z"in o?(i=(r=mat(vat(o.y,0,1))).getUTCDay(),r=i>4||0===i?aat.ceil(r):aat(r),r=rat.offset(r,7*(o.V-1)),o.y=r.getUTCFullYear(),o.m=r.getUTCMonth(),o.d=r.getUTCDate()+(o.w+6)%7):(i=(r=dat(vat(o.y,0,1))).getDay(),r=i>4||0===i?Yot.ceil(r):Yot(r),r=Got.offset(r,7*(o.V-1)),o.y=r.getFullYear(),o.m=r.getMonth(),o.d=r.getDate()+(o.w+6)%7)}else("W"in o||"U"in o)&&("w"in o||(o.w="u"in o?o.u%7:"W"in o?1:0),i="Z"in o?mat(vat(o.y,0,1)).getUTCDay():dat(vat(o.y,0,1)).getDay(),o.m=0,o.d="W"in o?(o.w+6)%7+7*o.W-(i+5)%7:o.w+7*o.U-(i+6)%7);return"Z"in o?(o.H+=o.Z/100|0,o.M+=o.Z%100,mat(o)):dat(o)}}function M(t,e,n,r){for(var i,o,a=0,s=e.length,u=n.length;a<s;){if(r>=u)return-1;if(37===(i=e.charCodeAt(a++))){if(i=e.charAt(a++),!(o=_[i in xat?e.charAt(a++):i])||(r=o(t,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return x.x=w(n,x),x.X=w(r,x),x.c=w(e,x),b.x=w(n,b),b.X=w(r,b),b.c=w(e,b),{format:function(t){var e=w(t+="",x);return e.toString=function(){return t},e},parse:function(t){var e=S(t+="",!1);return e.toString=function(){return t},e},utcFormat:function(t){var e=w(t+="",b);return e.toString=function(){return t},e},utcParse:function(t){var e=S(t+="",!0);return e.toString=function(){return t},e}}}(t),yat=gat.format,gat.parse,gat.utcFormat,gat.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var Dst,Fst,jst=1e3,Bst=6e4,zst=36e5,Ust=864e5,Vst=2592e6,Gst=31536e6;function Wst(t){return new Date(t)}function Hst(t){return t instanceof Date?+t:+new Date(+t)}function Yst(t,e,n,r,i,o,a,s,u){var c=$it(Git,Git),l=c.invert,h=c.domain,f=u(".%L"),p=u(":%S"),d=u("%I:%M"),m=u("%I %p"),v=u("%a %d"),g=u("%b %d"),y=u("%B"),x=u("%Y"),b=[[a,1,jst],[a,5,5e3],[a,15,15e3],[a,30,3e4],[o,1,Bst],[o,5,3e5],[o,15,9e5],[o,30,18e5],[i,1,zst],[i,3,108e5],[i,6,216e5],[i,12,432e5],[r,1,Ust],[r,2,1728e5],[n,1,6048e5],[e,1,Vst],[e,3,7776e6],[t,1,Gst]];function _(s){return(a(s)<s?f:o(s)<s?p:i(s)<s?d:r(s)<s?m:e(s)<s?n(s)<s?v:g:t(s)<s?y:x)(s)}function w(e,n,r,i){if(null==e&&(e=10),"number"==typeof e){var o=Math.abs(r-n)/e,a=rit((function(t){return t[2]})).right(b,o);a===b.length?(i=fit(n/Gst,r/Gst,e),e=t):a?(i=(a=b[o/b[a-1][2]<b[a][2]/o?a-1:a])[1],e=a[0]):(i=Math.max(fit(n,r,e),1),e=s)}return null==i?e:e.every(i)}return c.invert=function(t){return new Date(l(t))},c.domain=function(t){return arguments.length?h(Fit.call(t,Hst)):h().map(Wst)},c.ticks=function(t,e){var n,r=h(),i=r[0],o=r[r.length-1],a=o<i;return a&&(n=i,i=o,o=n),n=(n=w(t,i,o,e))?n.range(i,o+1):[],a?n.reverse():n},c.tickFormat=function(t,e){return null==e?_:u(e)},c.nice=function(t,e){var n=h();return(t=w(t,n[0],n[n.length-1],e))?h(dot(n,t)):c},c.copy=function(){return qit(c,Yst(t,e,n,r,i,o,a,s,u))},c}function Xst(){var t,e,n,r,i,o=0,a=1,s=Git,u=!1;function c(e){return isNaN(e=+e)?i:s(0===n?.5:(e=(r(e)-t)*n,u?Math.max(0,Math.min(1,e)):e))}return c.domain=function(i){return arguments.length?(t=r(o=+i[0]),e=r(a=+i[1]),n=t===e?0:1/(e-t),c):[o,a]},c.clamp=function(t){return arguments.length?(u=!!t,c):u},c.interpolator=function(t){return arguments.length?(s=t,c):s},c.unknown=function(t){return arguments.length?(i=t,c):i},function(i){return r=i,t=i(o),e=i(a),n=t===e?0:1/(e-t),c}}function qst(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function Zst(){var t,e,n,r,i,o,a,s=0,u=.5,c=1,l=Git,h=!1;function f(t){return isNaN(t=+t)?a:(t=.5+((t=+o(t))-e)*(t<e?r:i),l(h?Math.max(0,Math.min(1,t)):t))}return f.domain=function(a){return arguments.length?(t=o(s=+a[0]),e=o(u=+a[1]),n=o(c=+a[2]),r=t===e?0:.5/(e-t),i=e===n?0:.5/(n-e),f):[s,u,c]},f.clamp=function(t){return arguments.length?(h=!!t,f):h},f.interpolator=function(t){return arguments.length?(l=t,f):l},f.unknown=function(t){return arguments.length?(a=t,f):a},function(a){return o=a,t=a(s),e=a(u),n=a(c),r=t===e?0:.5/(e-t),i=e===n?0:.5/(n-e),f}}var $st,Kst=/^(?:(?!0000)[0-9]{4}([-/.]+)(?:(?:0?[1-9]|1[0-2])\1(?:0?[1-9]|1[0-9]|2[0-8])|(?:0?[13-9]|1[0-2])\1(?:29|30)|(?:0?[13578]|1[02])\1(?:31))|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)([-/.]?)0?2\2(?:29))(\s+([01]|([01][0-9]|2[0-3])):([0-9]|[0-5][0-9]):([0-9]|[0-5][0-9]))?$/,Jst=($q(Dst={},l8.LINEAR,(function t(){var e=$it(Git,Git);return e.copy=function(){return qit(e,t())},Oit.apply(e,arguments),pot(e)})),$q(Dst,l8.POWER,(function t(){var e=Eot(Zit());return e.copy=function(){return qit(e,t()).exponent(e.exponent())},Oit.apply(e,arguments),e})),$q(Dst,l8.LOG,(function t(){var e=_ot(Zit()).domain([1,10]);return e.copy=function(){return qit(e,t()).base(e.base())},Oit.apply(e,arguments),e})),$q(Dst,l8.IDENTITY,(function t(e){var n,r=[];function i(t){return null==t?n:t}return i.invert=i,i.domain=i.range=function(t){return t?(r=t,t):r},i.unknown=function(t){return t?(n=t,t):n},i.copy=function(){return t().unknown(n)},i})),$q(Dst,l8.SEQUENTIAL,(function t(){var e=pot(Xst()(Git));return e.copy=function(){return qst(e,t())},kit.apply(e,arguments)})),$q(Dst,l8.TIME,(function(){return Oit.apply(Yst(eat,Qot,Hot,Got,Uot,Bot,Fot,kot,yat).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)})),$q(Dst,l8.QUANTILE,(function t(){var e,n=[],r=[],i=[];function o(){var t=0,e=Math.max(1,r.length);for(i=new Array(e-1);++t<e;)i[t-1]=pit(n,t/e);return a}function a(t){return isNaN(t=+t)?e:r[iit(i,t)]}return a.invertExtent=function(t){var e=r.indexOf(t);return e<0?[NaN,NaN]:[e>0?i[e-1]:n[0],e<i.length?i[e]:n[n.length-1]]},a.domain=function(t){if(!arguments.length)return n.slice();n=[];for(var e,r=0,i=t.length;r<i;++r)null==(e=t[r])||isNaN(e=+e)||n.push(e);return n.sort(nit),o()},a.range=function(t){return arguments.length?(r=jit.call(t),o()):r.slice()},a.unknown=function(t){return arguments.length?(e=t,a):e},a.quantiles=function(){return i.slice()},a.copy=function(){return t().domain(n).range(r).unknown(e)},Oit.apply(a,arguments)})),$q(Dst,l8.QUANTIZE,(function t(){var e,n=0,r=1,i=1,o=[.5],a=[0,1];function s(t){return t<=t?a[iit(o,t,0,i)]:e}function u(){var t=-1;for(o=new Array(i);++t<i;)o[t]=((t+1)*r-(t-i)*n)/(i+1);return s}return s.domain=function(t){return arguments.length?(n=+t[0],r=+t[1],u()):[n,r]},s.range=function(t){return arguments.length?(i=(a=jit.call(t)).length-1,u()):a.slice()},s.invertExtent=function(t){var e=a.indexOf(t);return e<0?[NaN,NaN]:e<1?[n,o[0]]:e>=i?[o[i-1],r]:[o[e-1],o[e]]},s.unknown=function(t){return arguments.length?(e=t,s):s},s.thresholds=function(){return o.slice()},s.copy=function(){return t().domain([n,r]).range(a).unknown(e)},Oit.apply(pot(s),arguments)})),$q(Dst,l8.THRESHOLD,(function t(){var e,n=[.5],r=[0,1],i=1;function o(t){return t<=t?r[iit(n,t,0,i)]:e}return o.domain=function(t){return arguments.length?(n=jit.call(t),i=Math.min(n.length,r.length-1),o):n.slice()},o.range=function(t){return arguments.length?(r=jit.call(t),i=Math.min(n.length,r.length-1),o):r.slice()},o.invertExtent=function(t){var e=r.indexOf(t);return[n[e-1],n[e]]},o.unknown=function(t){return arguments.length?(e=t,o):e},o.copy=function(){return t().domain(n).range(r).unknown(e)},Oit.apply(o,arguments)})),$q(Dst,l8.CAT,zit),$q(Dst,l8.DIVERGING,(function t(){var e=pot(Zst()(Git));return e.copy=function(){return qst(e,t())},kit.apply(e,arguments)})),Dst),Qst=Z2()(Fst=function(){function t(){mZ(this,t),$q(this,"scaleOptions",{})}return gZ(t,[{key:"apply",value:function(t,e){var n=this,r=e.styleAttributeService;t.hooks.init.tapPromise("FeatureScalePlugin",RK(jK.mark((function e(){var i,o,a;return jK.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.scaleOptions=t.getScaleOptions(),o=r.getLayerStyleAttributes(),a=null===(i=t.getSource())||void 0===i?void 0:i.data.dataArray,!Array.isArray(a)||0!==a.length){e.next=7;break}return e.abrupt("return");case 7:n.caculateScalesForAttributes(o||[],a);case 8:case"end":return e.stop()}}),e)})))),t.hooks.beforeRenderData.tapPromise("FeatureScalePlugin",function(){var e=RK(jK.mark((function e(i){var o,a;return jK.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i){e.next=2;break}return e.abrupt("return",i);case 2:if(n.scaleOptions=t.getScaleOptions(),o=r.getLayerStyleAttributes(),a=t.getSource().data.dataArray,!Array.isArray(a)||0!==a.length){e.next=7;break}return e.abrupt("return",!0);case 7:return n.caculateScalesForAttributes(o||[],a),t.layerModelNeedUpdate=!0,e.abrupt("return",!0);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),t.hooks.beforeRender.tap("FeatureScalePlugin",(function(){if(!t.layerModelNeedUpdate){n.scaleOptions=t.getScaleOptions();var e=r.getLayerStyleAttributes(),i=t.getSource().data.dataArray;if((!Array.isArray(i)||0!==i.length)&&e){var o=e.filter((function(t){return t.needRescale}));o.length&&n.caculateScalesForAttributes(o,i)}}}))}},{key:"isNumber",value:function(t){return!isNaN(parseFloat(t))&&isFinite(t)}},{key:"caculateScalesForAttributes",value:function(t,e){var n=this;t.forEach((function(t){if(t.scale){var r=t.scale;r.names=n.parseFields(t.scale.field||[]);var i=[];r.names.forEach((function(r){var o;i.push(n.createScale(r,t.name,null===(o=t.scale)||void 0===o?void 0:o.values,e))})),i.some((function(t){return t.type===f8.VARIABLE}))?(r.type=f8.VARIABLE,i.forEach((function(t){var e,n;if(!r.callback&&"text"!==r.values)switch(null===(e=t.option)||void 0===e?void 0:e.type){case l8.LOG:case l8.LINEAR:case l8.POWER:if(r.values&&r.values.length>2){var i=t.scale.ticks(r.values.length);t.scale.domain(i)}r.values?t.scale.range(r.values):t.scale.range(t.option.domain);break;case l8.QUANTILE:case l8.QUANTIZE:case l8.THRESHOLD:t.scale.range(r.values);break;case l8.IDENTITY:break;case l8.CAT:r.values?t.scale.range(r.values):t.scale.range(t.option.domain);break;case l8.DIVERGING:case l8.SEQUENTIAL:t.scale.interpolator(yit(r.values))}"text"===r.values&&t.scale.range(null===(n=t.option)||void 0===n?void 0:n.domain)}))):(r.type=f8.CONSTANT,r.defaultValues=i.map((function(t,e){return t.scale(r.names[e])}))),r.scalers=i.map((function(t){return{field:t.field,func:t.scale,option:t.option}})),t.needRescale=!1}}))}},{key:"parseFields",value:function(t){return Array.isArray(t)?t:hZ.isString(t)?t.split("*"):[t]}},{key:"createScale",value:function(t,e,n,r){var i,o,a=this.scaleOptions[e]&&(null===(i=this.scaleOptions[e])||void 0===i?void 0:i.field)===t?this.scaleOptions[e]:this.scaleOptions[t],s={field:t,scale:void 0,type:f8.VARIABLE,option:a};if(!r||!r.length)return a&&a.type?s.scale=this.createDefaultScale(a):(s.scale=zit([t]),s.type=f8.CONSTANT),s;var u=null===(o=r.find((function(e){return!hZ.isNil(e[t])})))||void 0===o?void 0:o[t];if(this.isNumber(t)||hZ.isNil(u)&&!a)s.scale=zit([t]),s.type=f8.CONSTANT;else{var c=a&&a.type||this.getDefaultType(u);"text"===n&&(c=l8.CAT);var l=this.createScaleConfig(c,t,a,r);s.scale=this.createDefaultScale(l),s.option=l}return s}},{key:"getDefaultType",value:function(t){var e=l8.LINEAR;return"string"==typeof t&&(e=Kst.test(t)?l8.TIME:l8.CAT),e}},{key:"createScaleConfig",value:function(t,e,n,r){var i={type:t},o=(null==r?void 0:r.map((function(t){return t[e]})))||[];if(null!=n&&n.domain)i.domain=null==n?void 0:n.domain;else if(t===l8.CAT||t===l8.IDENTITY)i.domain=hZ.uniq(o);else if(t===l8.QUANTILE)i.domain=o;else if(t===l8.DIVERGING){var a=ait(o),s=void 0!==(null==n?void 0:n.neutral)?null==n?void 0:n.neutral:(a[0]+a[1])/2;i.domain=[a[0],s,a[1]]}else i.domain=ait(o);return Jq(Jq({},i),n)}},{key:"createDefaultScale",value:function(t){var e=t.type,n=t.domain,r=t.unknown,i=t.clamp,o=t.nice,a=Jst[e]();return n&&a.domain&&a.domain(n),r&&a.unknown(r),void 0!==i&&a.clamp&&a.clamp(i),void 0!==o&&a.nice&&a.nice(o),a}}]),t}())||Fst,tut=Z2()($st=function(){function t(){mZ(this,t)}return gZ(t,[{key:"apply",value:function(t){t.hooks.beforeRender.tap("LayerAnimateStylePlugin",(function(){t.animateStatus&&t.models.forEach((function(e){e.addUniforms(Jq({},t.layerModel.getAnimateUniforms()))}))}))}}]),t}())||$st,eut=function(){function t(e){var n=e.rendererService,r=e.layerService,i=e.parent;mZ(this,t),$q(this,"tileResource",new Map),$q(this,"_tiles",[]),this.rendererService=n,this.layerService=r,this.parent=i}var e;return gZ(t,[{key:"tiles",get:function(){return this._tiles}},{key:"hasTile",value:function(t){return this._tiles.some((function(e){return e.key===t}))}},{key:"addTile",value:function(t){this._tiles.push(t)}},{key:"getTile",value:function(t){return this._tiles.find((function(e){return e.key===t}))}},{key:"getVisibleTileBylngLat",value:function(t){return this._tiles.find((function(e){return e.isLoaded&&e.visible&&e.lnglatInBounds(t)}))}},{key:"removeTile",value:function(t){var e=this._tiles.findIndex((function(e){return e.key===t})),n=this._tiles.splice(e,1);n[0]&&n[0].destroy()}},{key:"updateTileVisible",value:function(t){var e=this.getTile(t.key);null==e||e.updateVisible(t.isVisible)}},{key:"isParentLoaded",value:function(t){var e=t.parent;if(!e)return!0;var n=this.getTile(null==e?void 0:e.key);return!(null==n||!n.isLoaded)}},{key:"isChildrenLoaded",value:function(t){var e=this,n=null==t?void 0:t.children;return 0===n.length||n.some((function(t){var n=e.getTile(null==t?void 0:t.key);return!1===(null==n?void 0:n.isLoaded)}))}},{key:"render",value:(e=RK(jK.mark((function t(){var e=this;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.getRenderLayers().map(function(){var t=RK(jK.mark((function t(n){return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.layerService.renderLayer(n);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"getRenderLayers",value:function(){var t=this._tiles.filter((function(t){return t.visible&&t.isLoaded})),e=[];return t.map((function(t){return e.push.apply(e,Xq(t.getLayers()))})),e}},{key:"getLayers",value:function(){var t=this._tiles.filter((function(t){return t.isLoaded})),e=[];return t.map((function(t){return e.push.apply(e,Xq(t.getLayers()))})),e}},{key:"getTiles",value:function(){return this._tiles}},{key:"destroy",value:function(){this._tiles.forEach((function(t){return t.destroy()})),this.tileResource.clear()}}]),t}();
/**
 * splaytree v3.1.1
 * Fast Splay tree for Node and browser
 *
 * @author Alexander Milevski <info@w8r.name>
 * @license MIT
 * @preserve
 */
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
function nut(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var rut=function(t,e){this.next=null,this.key=t,this.data=e,this.left=null,this.right=null};function iut(t,e){return t>e?1:t<e?-1:0}function out(t,e,n){for(var r=new rut(null,null),i=r,o=r;;){var a=n(t,e.key);if(a<0){if(null===e.left)break;if(n(t,e.left.key)<0){var s=e.left;if(e.left=s.right,s.right=e,null===(e=s).left)break}o.left=e,o=e,e=e.left}else{if(!(a>0))break;if(null===e.right)break;if(n(t,e.right.key)>0){s=e.right;if(e.right=s.left,s.left=e,null===(e=s).right)break}i.right=e,i=e,e=e.right}}return i.right=e.left,o.left=e.right,e.left=r.right,e.right=r.left,e}function aut(t,e,n,r){var i=new rut(t,e);if(null===n)return i.left=i.right=null,i;var o=r(t,(n=out(t,n,r)).key);return o<0?(i.left=n.left,i.right=n,n.left=null):o>=0&&(i.right=n.right,i.left=n,n.right=null),i}function sut(t,e,n){var r=null,i=null;if(e){var o=n((e=out(t,e,n)).key,t);0===o?(r=e.left,i=e.right):o<0?(i=e.right,e.right=null,r=e):(r=e.left,e.left=null,i=e)}return{left:r,right:i}}function uut(t,e,n,r,i){if(t){r(e+(n?"└── ":"├── ")+i(t)+"\n");var o=e+(n?"    ":"│   ");t.left&&uut(t.left,o,!1,r,i),t.right&&uut(t.right,o,!0,r,i)}}var cut=function(){function t(t){void 0===t&&(t=iut),this._root=null,this._size=0,this._comparator=t}return t.prototype.insert=function(t,e){return this._size++,this._root=aut(t,e,this._root,this._comparator)},t.prototype.add=function(t,e){var n=new rut(t,e);null===this._root&&(n.left=n.right=null,this._size++,this._root=n);var r=this._comparator,i=out(t,this._root,r),o=r(t,i.key);return 0===o?this._root=i:(o<0?(n.left=i.left,n.right=i,i.left=null):o>0&&(n.right=i.right,n.left=i,i.right=null),this._size++,this._root=n),this._root},t.prototype.remove=function(t){this._root=this._remove(t,this._root,this._comparator)},t.prototype._remove=function(t,e,n){var r;return null===e?null:0===n(t,(e=out(t,e,n)).key)?(null===e.left?r=e.right:(r=out(t,e.left,n)).right=e.right,this._size--,r):e},t.prototype.pop=function(){var t=this._root;if(t){for(;t.left;)t=t.left;return this._root=out(t.key,this._root,this._comparator),this._root=this._remove(t.key,this._root,this._comparator),{key:t.key,data:t.data}}return null},t.prototype.findStatic=function(t){for(var e=this._root,n=this._comparator;e;){var r=n(t,e.key);if(0===r)return e;e=r<0?e.left:e.right}return null},t.prototype.find=function(t){return this._root&&(this._root=out(t,this._root,this._comparator),0!==this._comparator(t,this._root.key))?null:this._root},t.prototype.contains=function(t){for(var e=this._root,n=this._comparator;e;){var r=n(t,e.key);if(0===r)return!0;e=r<0?e.left:e.right}return!1},t.prototype.forEach=function(t,e){for(var n=this._root,r=[],i=!1;!i;)null!==n?(r.push(n),n=n.left):0!==r.length?(n=r.pop(),t.call(e,n),n=n.right):i=!0;return this},t.prototype.range=function(t,e,n,r){for(var i=[],o=this._comparator,a=this._root;0!==i.length||a;)if(a)i.push(a),a=a.left;else{if(o((a=i.pop()).key,e)>0)break;if(o(a.key,t)>=0&&n.call(r,a))return this;a=a.right}return this},t.prototype.keys=function(){var t=[];return this.forEach((function(e){var n=e.key;return t.push(n)})),t},t.prototype.values=function(){var t=[];return this.forEach((function(e){var n=e.data;return t.push(n)})),t},t.prototype.min=function(){return this._root?this.minNode(this._root).key:null},t.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},t.prototype.minNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.left;)t=t.left;return t},t.prototype.maxNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.right;)t=t.right;return t},t.prototype.at=function(t){for(var e=this._root,n=!1,r=0,i=[];!n;)if(e)i.push(e),e=e.left;else if(i.length>0){if(e=i.pop(),r===t)return e;r++,e=e.right}else n=!0;return null},t.prototype.next=function(t){var e=this._root,n=null;if(t.right){for(n=t.right;n.left;)n=n.left;return n}for(var r=this._comparator;e;){var i=r(t.key,e.key);if(0===i)break;i<0?(n=e,e=e.left):e=e.right}return n},t.prototype.prev=function(t){var e=this._root,n=null;if(null!==t.left){for(n=t.left;n.right;)n=n.right;return n}for(var r=this._comparator;e;){var i=r(t.key,e.key);if(0===i)break;i<0?e=e.left:(n=e,e=e.right)}return n},t.prototype.clear=function(){return this._root=null,this._size=0,this},t.prototype.toList=function(){return function(t){var e=t,n=[],r=!1,i=new rut(null,null),o=i;for(;!r;)e?(n.push(e),e=e.left):n.length>0?e=(e=o=o.next=n.pop()).right:r=!0;return o.next=null,i.next}(this._root)},t.prototype.load=function(t,e,n){void 0===e&&(e=[]),void 0===n&&(n=!1);var r=t.length,i=this._comparator;if(n&&fut(t,e,0,r-1,i),null===this._root)this._root=lut(t,e,0,r),this._size=r;else{var o=function(t,e,n){var r=new rut(null,null),i=r,o=t,a=e;for(;null!==o&&null!==a;)n(o.key,a.key)<0?(i.next=o,o=o.next):(i.next=a,a=a.next),i=i.next;null!==o?i.next=o:null!==a&&(i.next=a);return r.next}(this.toList(),function(t,e){for(var n=new rut(null,null),r=n,i=0;i<t.length;i++)r=r.next=new rut(t[i],e[i]);return r.next=null,n.next}(t,e),i);r=this._size+r,this._root=hut({head:o},0,r)}return this},t.prototype.isEmpty=function(){return null===this._root},Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),t.prototype.toString=function(t){void 0===t&&(t=function(t){return String(t.key)});var e=[];return uut(this._root,"",!0,(function(t){return e.push(t)}),t),e.join("")},t.prototype.update=function(t,e,n){var r=this._comparator,i=sut(t,this._root,r),o=i.left,a=i.right;r(t,e)<0?a=aut(e,n,a,r):o=aut(e,n,o,r),this._root=function(t,e,n){return null===e?t:(null===t||((e=out(t.key,e,n)).left=t),e)}(o,a,r)},t.prototype.split=function(t){return sut(t,this._root,this._comparator)},t.prototype[Symbol.iterator]=function(){var t;return nut(this,(function(e){switch(e.label){case 0:t=this.minNode(),e.label=1;case 1:return t?[4,t]:[3,3];case 2:return e.sent(),t=this.next(t),[3,1];case 3:return[2]}}))},t}();function lut(t,e,n,r){var i=r-n;if(i>0){var o=n+Math.floor(i/2),a=t[o],s=e[o],u=new rut(a,s);return u.left=lut(t,e,n,o),u.right=lut(t,e,o+1,r),u}return null}function hut(t,e,n){var r=n-e;if(r>0){var i=e+Math.floor(r/2),o=hut(t,e,i),a=t.head;return a.left=o,t.head=t.head.next,a.right=hut(t,i+1,n),a}return null}function fut(t,e,n,r,i){if(!(n>=r)){for(var o=t[n+r>>1],a=n-1,s=r+1;;){do{a++}while(i(t[a],o)<0);do{s--}while(i(t[s],o)>0);if(a>=s)break;var u=t[a];t[a]=t[s],t[s]=u,u=e[a],e[a]=e[s],e[s]=u}fut(t,e,n,s,i),fut(t,e,s+1,r,i)}}function put(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function dut(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function mut(t,e,n){return e&&dut(t.prototype,e),n&&dut(t,n),t}var vut=function(t,e){return t.ll.x<=e.x&&e.x<=t.ur.x&&t.ll.y<=e.y&&e.y<=t.ur.y},gut=function(t,e){if(e.ur.x<t.ll.x||t.ur.x<e.ll.x||e.ur.y<t.ll.y||t.ur.y<e.ll.y)return null;var n=t.ll.x<e.ll.x?e.ll.x:t.ll.x,r=t.ur.x<e.ur.x?t.ur.x:e.ur.x;return{ll:{x:n,y:t.ll.y<e.ll.y?e.ll.y:t.ll.y},ur:{x:r,y:t.ur.y<e.ur.y?t.ur.y:e.ur.y}}},yut=Number.EPSILON;void 0===yut&&(yut=Math.pow(2,-52));var xut=yut*yut,but=function(t,e){if(-yut<t&&t<yut&&-yut<e&&e<yut)return 0;var n=t-e;return n*n<xut*t*e?0:t<e?-1:1},_ut=function(){function t(){put(this,t),this.reset()}return mut(t,[{key:"reset",value:function(){this.xRounder=new wut,this.yRounder=new wut}},{key:"round",value:function(t,e){return{x:this.xRounder.round(t),y:this.yRounder.round(e)}}}]),t}(),wut=function(){function t(){put(this,t),this.tree=new cut,this.round(0)}return mut(t,[{key:"round",value:function(t){var e=this.tree.add(t),n=this.tree.prev(e);if(null!==n&&0===but(e.key,n.key))return this.tree.remove(t),n.key;var r=this.tree.next(e);return null!==r&&0===but(e.key,r.key)?(this.tree.remove(t),r.key):t}}]),t}(),Sut=new _ut,Mut=function(t,e){return t.x*e.y-t.y*e.x},Eut=function(t,e){return t.x*e.x+t.y*e.y},Aut=function(t,e,n){var r={x:e.x-t.x,y:e.y-t.y},i={x:n.x-t.x,y:n.y-t.y},o=Mut(r,i);return but(o,0)},Tut=function(t){return Math.sqrt(Eut(t,t))},Cut=function(t,e,n){var r={x:e.x-t.x,y:e.y-t.y},i={x:n.x-t.x,y:n.y-t.y};return Eut(i,r)/Tut(i)/Tut(r)},Out=function(t,e,n){return 0===e.y?null:{x:t.x+e.x/e.y*(n-t.y),y:n}},kut=function(t,e,n){return 0===e.x?null:{x:n,y:t.y+e.y/e.x*(n-t.x)}},Put=function(){function t(e,n){put(this,t),void 0===e.events?e.events=[this]:e.events.push(this),this.point=e,this.isLeft=n}return mut(t,null,[{key:"compare",value:function(e,n){var r=t.comparePoints(e.point,n.point);return 0!==r?r:(e.point!==n.point&&e.link(n),e.isLeft!==n.isLeft?e.isLeft?1:-1:Rut.compare(e.segment,n.segment))}},{key:"comparePoints",value:function(t,e){return t.x<e.x?-1:t.x>e.x?1:t.y<e.y?-1:t.y>e.y?1:0}}]),mut(t,[{key:"link",value:function(t){if(t.point===this.point)throw new Error("Tried to link already linked events");for(var e=t.point.events,n=0,r=e.length;n<r;n++){var i=e[n];this.point.events.push(i),i.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var t=this.point.events.length,e=0;e<t;e++){var n=this.point.events[e];if(void 0===n.segment.consumedBy)for(var r=e+1;r<t;r++){var i=this.point.events[r];void 0===i.consumedBy&&(n.otherSE.point.events===i.otherSE.point.events&&n.segment.consume(i.segment))}}}},{key:"getAvailableLinkedEvents",value:function(){for(var t=[],e=0,n=this.point.events.length;e<n;e++){var r=this.point.events[e];r!==this&&!r.segment.ringOut&&r.segment.isInResult()&&t.push(r)}return t}},{key:"getLeftmostComparator",value:function(t){var e=this,n=new Map,r=function(r){var i,o,a,s,u,c=r.otherSE;n.set(r,{sine:(i=e.point,o=t.point,a=c.point,s={x:o.x-i.x,y:o.y-i.y},u={x:a.x-i.x,y:a.y-i.y},Mut(u,s)/Tut(u)/Tut(s)),cosine:Cut(e.point,t.point,c.point)})};return function(t,e){n.has(t)||r(t),n.has(e)||r(e);var i=n.get(t),o=i.sine,a=i.cosine,s=n.get(e),u=s.sine,c=s.cosine;return o>=0&&u>=0?a<c?1:a>c?-1:0:o<0&&u<0?a<c?-1:a>c?1:0:u<o?-1:u>o?1:0}}}]),t}(),Lut=0,Rut=function(){function t(e,n,r,i){put(this,t),this.id=++Lut,this.leftSE=e,e.segment=this,e.otherSE=n,this.rightSE=n,n.segment=this,n.otherSE=e,this.rings=r,this.windings=i}return mut(t,null,[{key:"compare",value:function(t,e){var n=t.leftSE.point.x,r=e.leftSE.point.x,i=t.rightSE.point.x,o=e.rightSE.point.x;if(o<n)return 1;if(i<r)return-1;var a=t.leftSE.point.y,s=e.leftSE.point.y,u=t.rightSE.point.y,c=e.rightSE.point.y;if(n<r){if(s<a&&s<u)return 1;if(s>a&&s>u)return-1;var l=t.comparePoint(e.leftSE.point);if(l<0)return 1;if(l>0)return-1;var h=e.comparePoint(t.rightSE.point);return 0!==h?h:-1}if(n>r){if(a<s&&a<c)return-1;if(a>s&&a>c)return 1;var f=e.comparePoint(t.leftSE.point);if(0!==f)return f;var p=t.comparePoint(e.rightSE.point);return p<0?1:p>0?-1:1}if(a<s)return-1;if(a>s)return 1;if(i<o){var d=e.comparePoint(t.rightSE.point);if(0!==d)return d}if(i>o){var m=t.comparePoint(e.rightSE.point);if(m<0)return 1;if(m>0)return-1}if(i!==o){var v=u-a,g=i-n,y=c-s,x=o-r;if(v>g&&y<x)return 1;if(v<g&&y>x)return-1}return i>o?1:i<o||u<c?-1:u>c?1:t.id<e.id?-1:t.id>e.id?1:0}}]),mut(t,[{key:"replaceRightSE",value:function(t){this.rightSE=t,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var t=this.leftSE.point.y,e=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:t<e?t:e},ur:{x:this.rightSE.point.x,y:t>e?t:e}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(t){return t.x===this.leftSE.point.x&&t.y===this.leftSE.point.y||t.x===this.rightSE.point.x&&t.y===this.rightSE.point.y}},{key:"comparePoint",value:function(t){if(this.isAnEndpoint(t))return 0;var e=this.leftSE.point,n=this.rightSE.point,r=this.vector();if(e.x===n.x)return t.x===e.x?0:t.x<e.x?1:-1;var i=(t.y-e.y)/r.y,o=e.x+i*r.x;if(t.x===o)return 0;var a=(t.x-e.x)/r.x,s=e.y+a*r.y;return t.y===s?0:t.y<s?-1:1}},{key:"getIntersection",value:function(t){var e=this.bbox(),n=t.bbox(),r=gut(e,n);if(null===r)return null;var i=this.leftSE.point,o=this.rightSE.point,a=t.leftSE.point,s=t.rightSE.point,u=vut(e,a)&&0===this.comparePoint(a),c=vut(n,i)&&0===t.comparePoint(i),l=vut(e,s)&&0===this.comparePoint(s),h=vut(n,o)&&0===t.comparePoint(o);if(c&&u)return h&&!l?o:!h&&l?s:null;if(c)return l&&i.x===s.x&&i.y===s.y?null:i;if(u)return h&&o.x===a.x&&o.y===a.y?null:a;if(h&&l)return null;if(h)return o;if(l)return s;var f=function(t,e,n,r){if(0===e.x)return kut(n,r,t.x);if(0===r.x)return kut(t,e,n.x);if(0===e.y)return Out(n,r,t.y);if(0===r.y)return Out(t,e,n.y);var i=Mut(e,r);if(0==i)return null;var o={x:n.x-t.x,y:n.y-t.y},a=Mut(o,e)/i,s=Mut(o,r)/i;return{x:(t.x+s*e.x+(n.x+a*r.x))/2,y:(t.y+s*e.y+(n.y+a*r.y))/2}}(i,this.vector(),a,t.vector());return null===f?null:vut(r,f)?Sut.round(f.x,f.y):null}},{key:"split",value:function(e){var n=[],r=void 0!==e.events,i=new Put(e,!0),o=new Put(e,!1),a=this.rightSE;this.replaceRightSE(o),n.push(o),n.push(i);var s=new t(i,a,this.rings.slice(),this.windings.slice());return Put.comparePoints(s.leftSE.point,s.rightSE.point)>0&&s.swapEvents(),Put.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),r&&(i.checkForConsuming(),o.checkForConsuming()),n}},{key:"swapEvents",value:function(){var t=this.rightSE;this.rightSE=this.leftSE,this.leftSE=t,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var e=0,n=this.windings.length;e<n;e++)this.windings[e]*=-1}},{key:"consume",value:function(e){for(var n=this,r=e;n.consumedBy;)n=n.consumedBy;for(;r.consumedBy;)r=r.consumedBy;var i=t.compare(n,r);if(0!==i){if(i>0){var o=n;n=r,r=o}if(n.prev===r){var a=n;n=r,r=a}for(var s=0,u=r.rings.length;s<u;s++){var c=r.rings[s],l=r.windings[s],h=n.rings.indexOf(c);-1===h?(n.rings.push(c),n.windings.push(l)):n.windings[h]+=l}r.rings=null,r.windings=null,r.consumedBy=n,r.leftSE.consumedBy=n.leftSE,r.rightSE.consumedBy=n.rightSE}}},{key:"prevInResult",value:function(){return void 0!==this._prevInResult||(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null),this._prevInResult}},{key:"beforeState",value:function(){if(void 0!==this._beforeState)return this._beforeState;if(this.prev){var t=this.prev.consumedBy||this.prev;this._beforeState=t.afterState()}else this._beforeState={rings:[],windings:[],multiPolys:[]};return this._beforeState}},{key:"afterState",value:function(){if(void 0!==this._afterState)return this._afterState;var t=this.beforeState();this._afterState={rings:t.rings.slice(0),windings:t.windings.slice(0),multiPolys:[]};for(var e=this._afterState.rings,n=this._afterState.windings,r=this._afterState.multiPolys,i=0,o=this.rings.length;i<o;i++){var a=this.rings[i],s=this.windings[i],u=e.indexOf(a);-1===u?(e.push(a),n.push(s)):n[u]+=s}for(var c=[],l=[],h=0,f=e.length;h<f;h++)if(0!==n[h]){var p=e[h],d=p.poly;if(-1===l.indexOf(d))if(p.isExterior)c.push(d);else{-1===l.indexOf(d)&&l.push(d);var m=c.indexOf(p.poly);-1!==m&&c.splice(m,1)}}for(var v=0,g=c.length;v<g;v++){var y=c[v].multiPoly;-1===r.indexOf(y)&&r.push(y)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(void 0!==this._isInResult)return this._isInResult;var t=this.beforeState().multiPolys,e=this.afterState().multiPolys;switch(Wut.type){case"union":var n=0===t.length,r=0===e.length;this._isInResult=n!==r;break;case"intersection":var i,o;t.length<e.length?(i=t.length,o=e.length):(i=e.length,o=t.length),this._isInResult=o===Wut.numMultiPolys&&i<o;break;case"xor":var a=Math.abs(t.length-e.length);this._isInResult=a%2==1;break;case"difference":var s=function(t){return 1===t.length&&t[0].isSubject};this._isInResult=s(t)!==s(e);break;default:throw new Error("Unrecognized operation type found ".concat(Wut.type))}return this._isInResult}}],[{key:"fromRing",value:function(e,n,r){var i,o,a,s=Put.comparePoints(e,n);if(s<0)i=e,o=n,a=1;else{if(!(s>0))throw new Error("Tried to create degenerate segment at [".concat(e.x,", ").concat(e.y,"]"));i=n,o=e,a=-1}return new t(new Put(i,!0),new Put(o,!1),[r],[a])}}]),t}(),Iut=function(){function t(e,n,r){if(put(this,t),!Array.isArray(e)||0===e.length)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=n,this.isExterior=r,this.segments=[],"number"!=typeof e[0][0]||"number"!=typeof e[0][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var i=Sut.round(e[0][0],e[0][1]);this.bbox={ll:{x:i.x,y:i.y},ur:{x:i.x,y:i.y}};for(var o=i,a=1,s=e.length;a<s;a++){if("number"!=typeof e[a][0]||"number"!=typeof e[a][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var u=Sut.round(e[a][0],e[a][1]);u.x===o.x&&u.y===o.y||(this.segments.push(Rut.fromRing(o,u,this)),u.x<this.bbox.ll.x&&(this.bbox.ll.x=u.x),u.y<this.bbox.ll.y&&(this.bbox.ll.y=u.y),u.x>this.bbox.ur.x&&(this.bbox.ur.x=u.x),u.y>this.bbox.ur.y&&(this.bbox.ur.y=u.y),o=u)}i.x===o.x&&i.y===o.y||this.segments.push(Rut.fromRing(o,i,this))}return mut(t,[{key:"getSweepEvents",value:function(){for(var t=[],e=0,n=this.segments.length;e<n;e++){var r=this.segments[e];t.push(r.leftSE),t.push(r.rightSE)}return t}}]),t}(),Nut=function(){function t(e,n){if(put(this,t),!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new Iut(e[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var r=1,i=e.length;r<i;r++){var o=new Iut(e[r],this,!1);o.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=o.bbox.ll.x),o.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=o.bbox.ll.y),o.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=o.bbox.ur.x),o.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=o.bbox.ur.y),this.interiorRings.push(o)}this.multiPoly=n}return mut(t,[{key:"getSweepEvents",value:function(){for(var t=this.exteriorRing.getSweepEvents(),e=0,n=this.interiorRings.length;e<n;e++)for(var r=this.interiorRings[e].getSweepEvents(),i=0,o=r.length;i<o;i++)t.push(r[i]);return t}}]),t}(),Dut=function(){function t(e,n){if(put(this,t),!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{"number"==typeof e[0][0][0]&&(e=[e])}catch(a){}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var r=0,i=e.length;r<i;r++){var o=new Nut(e[r],this);o.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=o.bbox.ll.x),o.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=o.bbox.ll.y),o.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=o.bbox.ur.x),o.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=o.bbox.ur.y),this.polys.push(o)}this.isSubject=n}return mut(t,[{key:"getSweepEvents",value:function(){for(var t=[],e=0,n=this.polys.length;e<n;e++)for(var r=this.polys[e].getSweepEvents(),i=0,o=r.length;i<o;i++)t.push(r[i]);return t}}]),t}(),Fut=function(){function t(e){put(this,t),this.events=e;for(var n=0,r=e.length;n<r;n++)e[n].segment.ringOut=this;this.poly=null}return mut(t,null,[{key:"factory",value:function(e){for(var n=[],r=0,i=e.length;r<i;r++){var o=e[r];if(o.isInResult()&&!o.ringOut){for(var a=null,s=o.leftSE,u=o.rightSE,c=[s],l=s.point,h=[];a=s,s=u,c.push(s),s.point!==l;)for(;;){var f=s.getAvailableLinkedEvents();if(0===f.length){var p=c[0].point,d=c[c.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(p.x,",")+" ".concat(p.y,"]. Last matching segment found ends at")+" [".concat(d.x,", ").concat(d.y,"]."))}if(1===f.length){u=f[0].otherSE;break}for(var m=null,v=0,g=h.length;v<g;v++)if(h[v].point===s.point){m=v;break}if(null===m){h.push({index:c.length,point:s.point});var y=s.getLeftmostComparator(a);u=f.sort(y)[0].otherSE;break}var x=h.splice(m)[0],b=c.splice(x.index);b.unshift(b[0].otherSE),n.push(new t(b.reverse()))}n.push(new t(c))}}return n}}]),mut(t,[{key:"getGeom",value:function(){for(var t=this.events[0].point,e=[t],n=1,r=this.events.length-1;n<r;n++){var i=this.events[n].point,o=this.events[n+1].point;0!==Aut(i,t,o)&&(e.push(i),t=i)}if(1===e.length)return null;var a=e[0],s=e[1];0===Aut(a,t,s)&&e.shift(),e.push(e[0]);for(var u=this.isExteriorRing()?1:-1,c=this.isExteriorRing()?0:e.length-1,l=this.isExteriorRing()?e.length:-1,h=[],f=c;f!=l;f+=u)h.push([e[f].x,e[f].y]);return h}},{key:"isExteriorRing",value:function(){if(void 0===this._isExteriorRing){var t=this.enclosingRing();this._isExteriorRing=!t||!t.isExteriorRing()}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return void 0===this._enclosingRing&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var t=this.events[0],e=1,n=this.events.length;e<n;e++){var r=this.events[e];Put.compare(t,r)>0&&(t=r)}for(var i=t.segment.prevInResult(),o=i?i.prevInResult():null;;){if(!i)return null;if(!o)return i.ringOut;if(o.ringOut!==i.ringOut)return o.ringOut.enclosingRing()!==i.ringOut?i.ringOut:i.ringOut.enclosingRing();i=o.prevInResult(),o=i?i.prevInResult():null}}}]),t}(),jut=function(){function t(e){put(this,t),this.exteriorRing=e,e.poly=this,this.interiorRings=[]}return mut(t,[{key:"addInterior",value:function(t){this.interiorRings.push(t),t.poly=this}},{key:"getGeom",value:function(){var t=[this.exteriorRing.getGeom()];if(null===t[0])return null;for(var e=0,n=this.interiorRings.length;e<n;e++){var r=this.interiorRings[e].getGeom();null!==r&&t.push(r)}return t}}]),t}(),But=function(){function t(e){put(this,t),this.rings=e,this.polys=this._composePolys(e)}return mut(t,[{key:"getGeom",value:function(){for(var t=[],e=0,n=this.polys.length;e<n;e++){var r=this.polys[e].getGeom();null!==r&&t.push(r)}return t}},{key:"_composePolys",value:function(t){for(var e=[],n=0,r=t.length;n<r;n++){var i=t[n];if(!i.poly)if(i.isExteriorRing())e.push(new jut(i));else{var o=i.enclosingRing();o.poly||e.push(new jut(o)),o.poly.addInterior(i)}}return e}}]),t}(),zut=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Rut.compare;put(this,t),this.queue=e,this.tree=new cut(n),this.segments=[]}return mut(t,[{key:"process",value:function(t){var e=t.segment,n=[];if(t.consumedBy)return t.isLeft?this.queue.remove(t.otherSE):this.tree.remove(e),n;var r=t.isLeft?this.tree.insert(e):this.tree.find(e);if(!r)throw new Error("Unable to find segment #".concat(e.id," ")+"[".concat(e.leftSE.point.x,", ").concat(e.leftSE.point.y,"] -> ")+"[".concat(e.rightSE.point.x,", ").concat(e.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var i=r,o=r,a=void 0,s=void 0;void 0===a;)null===(i=this.tree.prev(i))?a=null:void 0===i.key.consumedBy&&(a=i.key);for(;void 0===s;)null===(o=this.tree.next(o))?s=null:void 0===o.key.consumedBy&&(s=o.key);if(t.isLeft){var u=null;if(a){var c=a.getIntersection(e);if(null!==c&&(e.isAnEndpoint(c)||(u=c),!a.isAnEndpoint(c)))for(var l=this._splitSafely(a,c),h=0,f=l.length;h<f;h++)n.push(l[h])}var p=null;if(s){var d=s.getIntersection(e);if(null!==d&&(e.isAnEndpoint(d)||(p=d),!s.isAnEndpoint(d)))for(var m=this._splitSafely(s,d),v=0,g=m.length;v<g;v++)n.push(m[v])}if(null!==u||null!==p){var y=null;if(null===u)y=p;else if(null===p)y=u;else{y=Put.comparePoints(u,p)<=0?u:p}this.queue.remove(e.rightSE),n.push(e.rightSE);for(var x=e.split(y),b=0,_=x.length;b<_;b++)n.push(x[b])}n.length>0?(this.tree.remove(e),n.push(t)):(this.segments.push(e),e.prev=a)}else{if(a&&s){var w=a.getIntersection(s);if(null!==w){if(!a.isAnEndpoint(w))for(var S=this._splitSafely(a,w),M=0,E=S.length;M<E;M++)n.push(S[M]);if(!s.isAnEndpoint(w))for(var A=this._splitSafely(s,w),T=0,C=A.length;T<C;T++)n.push(A[T])}}this.tree.remove(e)}return n}},{key:"_splitSafely",value:function(t,e){this.tree.remove(t);var n=t.rightSE;this.queue.remove(n);var r=t.split(e);return r.push(n),void 0===t.consumedBy&&this.tree.insert(t),r}}]),t}(),Uut="undefined"!=typeof process&&{}.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,Vut="undefined"!=typeof process&&{}.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,Gut=function(){function t(){put(this,t)}return mut(t,[{key:"run",value:function(t,e,n){Wut.type=t,Sut.reset();for(var r=[new Dut(e,!0)],i=0,o=n.length;i<o;i++)r.push(new Dut(n[i],!1));if(Wut.numMultiPolys=r.length,"difference"===Wut.type)for(var a=r[0],s=1;s<r.length;)null!==gut(r[s].bbox,a.bbox)?s++:r.splice(s,1);if("intersection"===Wut.type)for(var u=0,c=r.length;u<c;u++)for(var l=r[u],h=u+1,f=r.length;h<f;h++)if(null===gut(l.bbox,r[h].bbox))return[];for(var p=new cut(Put.compare),d=0,m=r.length;d<m;d++)for(var v=r[d].getSweepEvents(),g=0,y=v.length;g<y;g++)if(p.insert(v[g]),p.size>Uut)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var x=new zut(p),b=p.size,_=p.pop();_;){var w=_.key;if(p.size===b){var S=w.segment;throw new Error("Unable to pop() ".concat(w.isLeft?"left":"right"," SweepEvent ")+"[".concat(w.point.x,", ").concat(w.point.y,"] from segment #").concat(S.id," ")+"[".concat(S.leftSE.point.x,", ").concat(S.leftSE.point.y,"] -> ")+"[".concat(S.rightSE.point.x,", ").concat(S.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(p.size>Uut)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(x.segments.length>Vut)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var M=x.process(w),E=0,A=M.length;E<A;E++){var T=M[E];void 0===T.consumedBy&&p.insert(T)}b=p.size,_=p.pop()}Sut.reset();var C=Fut.factory(x.segments);return new But(C).getGeom()}}]),t}(),Wut=new Gut,Hut=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return Wut.run("union",t,n)};function Yut(t,e,n){void 0===n&&(n={});var r=aZ(t),i=aZ(e),o=Hut(r.coordinates,i.coordinates);return 0===o.length?null:1===o.length?rZ(o[0],n.properties):function(t,e,n){return void 0===n&&(n={}),nZ({type:"MultiPolygon",coordinates:t},e,n)}(o,n.properties)}var Xut=function(){function t(){mZ(this,t)}return gZ(t,[{key:"getCombineFeature",value:function(t){var e=null,n=t[0];return t.map((function(t){var n=rZ(t.coordinates);e=null===e?n:Yut(e,n)})),n&&(e.properties=Jq({},n)),e}}]),t}(),qut="select",Zut="active",$ut=function(){function t(e){var n=e.layerService,r=e.tileLayerService,i=e.parent;mZ(this,t),$q(this,"tilePickID",new Map),this.layerService=n,this.tileLayerService=r,this.parent=i,this.tileSourceService=new Xut}return gZ(t,[{key:"pickRender",value:function(t){var e=this.tileLayerService.getVisibleTileBylngLat(t.lngLat);if(e){var n=e.getMainLayer();null==n||n.layerPickService.pickRender(t)}}},{key:"pick",value:function(t,e){var n=this.parent.getContainer().get(J2.IPickingService);if("RasterLayer"===t.type){var r=this.tileLayerService.getVisibleTileBylngLat(e.lngLat);if(r&&void 0!==r.getMainLayer()){var i=r.getMainLayer();return i.layerPickService.pickRasterLayer(i,e,this.parent)}return!1}return this.pickRender(e),n.pickFromPickingFBO(t,e)}},{key:"selectFeature",value:function(t){var e=lZ(t,3),n=e[0],r=e[1],i=e[2],o=this.color2PickId(n,r,i);this.tilePickID.set(qut,o),this.updateHighLight(n,r,i,qut)}},{key:"highlightPickedFeature",value:function(t){var e=lZ(t,3),n=e[0],r=e[1],i=e[2],o=this.color2PickId(n,r,i);this.tilePickID.set(Zut,o),this.updateHighLight(n,r,i,Zut)}},{key:"updateHighLight",value:function(t,e,n,r){this.tileLayerService.tiles.map((function(i){var o=i.getMainLayer();switch(r){case qut:null==o||o.hooks.beforeSelect.call([t,e,n]);break;case Zut:null==o||o.hooks.beforeHighlight.call([t,e,n])}}))}},{key:"setPickState",value:function(){var t=this.tilePickID.get(qut),e=this.tilePickID.get(Zut);if(t){var n=lZ(this.pickId2Color(t),3),r=n[0],i=n[1],o=n[2];this.updateHighLight(r,i,o,qut)}else if(e){var a=lZ(this.pickId2Color(e),3),s=a[0],u=a[1],c=a[2];this.updateHighLight(s,u,c,Zut)}else;}},{key:"color2PickId",value:function(t,e,n){return AK(new Uint8Array([t,e,n]))}},{key:"pickId2Color",value:function(t){return TK(t)}},{key:"getFeatureById",value:function(t){var e=this.tileLayerService.getTiles().filter((function(t){return t.visible})),n=[];return e.map((function(e){n.push.apply(n,Xq(e.getFeatureById(t)))})),n.length<=0?null:[]}},{key:"pickRasterLayer",value:function(t,e,n){return!1}}]),t}();var Kut=function(){function t(e,n){mZ(this,t),$q(this,"visible",!0),$q(this,"layers",[]),$q(this,"isLoaded",!1),this.parent=n,this.sourceTile=e,this.x=e.x,this.y=e.y,this.z=e.z,this.key="".concat(this.x,"_").concat(this.y,"_").concat(this.z)}var e,n;return gZ(t,[{key:"getLayers",value:function(){return this.layers}},{key:"styleUpdate",value:function(){}},{key:"lnglatInBounds",value:function(t){var e=lZ(this.sourceTile.bounds,4),n=e[0],r=e[1],i=e[2],o=e[3],a=t.lng,s=t.lat;return a>=n&&a<=i&&s>=r&&s<=o}},{key:"getLayerOptions",value:function(){var t,e=this.parent.getLayerConfig();return Jq(Jq({},e),{},{autoFit:!1,mask:(t=this.parent.type,-1!==["PolygonLayer","LineLayer"].indexOf(t)||e.mask)})}},{key:"addMask",value:(n=RK(jK.mark((function t(e,n){var r;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=_8(this.parent.sceneContainer),n.setContainer(r,this.parent.sceneContainer),t.next=4,n.init();case 4:e.addMaskLayer(n);case 5:case"end":return t.stop()}}),t,this)}))),function(t,e){return n.apply(this,arguments)})},{key:"addLayer",value:(e=RK(jK.mark((function t(e){var n;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.isTileLayer=!0,n=_8(this.parent.sceneContainer),e.setContainer(n,this.parent.sceneContainer),this.layers.push(e),t.next=6,e.init();case 6:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})},{key:"updateVisible",value:function(t){this.visible=t,this.updateOptions("visible",t)}},{key:"updateOptions",value:function(t,e){this.layers.forEach((function(n){n.updateLayerConfig($q({},t,e))}))}},{key:"getMainLayer",value:function(){return this.layers[0]}},{key:"getFeatures",value:function(t){return[]}},{key:"getFeatureById",value:function(t){return[]}},{key:"destroy",value:function(){this.layers.forEach((function(t){return t.destroy()}))}}]),t}();function Jut(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var Qut=function(t){wZ(i,Kut);var e,n,r=Jut(i);function i(){return mZ(this,i),r.apply(this,arguments)}return gZ(i,[{key:"initTileLayer",value:(n=RK(jK.mark((function t(){var e,n,r,i,o;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=this.parent.getLayerAttributeConfig(),n=this.getLayerOptions(),a=this.parent.type,r="PolygonLayer"===a?Ort:"LineLayer"===a?Ant:yrt,i=this.getSourceOption()){t.next=7;break}return this.isLoaded=!0,t.abrupt("return");case 7:if(o=new r(Jq({},n)).source(i.data,i.options),Object.keys(e).forEach((function(t){var n,r,i=t;o[i](null===(n=e[i])||void 0===n?void 0:n.field,null===(r=e[i])||void 0===r?void 0:r.values)})),!n.mask){t.next=12;break}return t.next=12,this.addTileMask(o);case 12:return t.next=14,this.addLayer(o);case 14:this.setLayerMinMaxZoom(o),this.isLoaded=!0;case 16:case"end":return t.stop()}var a}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"addTileMask",value:(e=RK(jK.mark((function t(e){var n;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new Qrt({layerType:"MaskLayer"}).source({type:"FeatureCollection",features:[this.sourceTile.bboxPolygon]},{parser:{type:"geojson",featureId:"id"}}),t.next=3,this.addMask(e,n);case 3:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})},{key:"getSourceOption",value:function(){var t=this.parent.getSource(),e=this.parent.getLayerConfig(),n=e.sourceLayer,r=void 0===n?"defaultLayer":n,i=e.featureId,o=void 0===i?"id":i;return{data:{type:"FeatureCollection",features:this.getFeatures(r)},options:{parser:{type:"geojson",featureId:o},transforms:t.transforms}}}},{key:"setLayerMinMaxZoom",value:function(t){"text"===t.getModelType()&&t.updateLayerConfig({maxZoom:this.z+1,minZoom:this.z-1})}},{key:"getFeatures",value:function(t){return this.sourceTile.data.getTileData(t)}},{key:"getFeatureById",value:function(t){var e=this.getMainLayer();return e?e.getSource().data.dataArray.filter((function(e){return e._id===t})):[]}}]),i}();function tct(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var ect=function(t){wZ(r,Kut);var e,n=tct(r);function r(){return mZ(this,r),n.apply(this,arguments)}return gZ(r,[{key:"initTileLayer",value:(e=RK(jK.mark((function t(){var e,n,r,i;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.getSourceOption(),n=e.data.features[0].properties,r=(new Ant).source(e.data,e.options).size(1).shape("line").color("red"),i=new yrt({minZoom:this.z-1,maxZoom:this.z+1}).source([n],{parser:{type:"json",x:"textLng",y:"textLat"}}).size(20).color("red").shape(this.key).style({stroke:"#fff",strokeWidth:2}),t.next=6,this.addLayer(r);case 6:return t.next=8,this.addLayer(i);case 8:this.isLoaded=!0;case 9:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"getSourceOption",value:function(){var t=this.parent.getSource();return{data:{type:"FeatureCollection",features:this.sourceTile.data.layers.testTile.features},options:{parser:{type:"geojson"},transforms:t.transforms}}}}]),r}();function nct(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var rct=function(t){wZ(r,Kut);var e,n=nct(r);function r(){return mZ(this,r),n.apply(this,arguments)}return gZ(r,[{key:"initTileLayer",value:(e=RK(jK.mark((function t(){var e,n,r,i;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.parent.getLayerAttributeConfig(),n=this.getLayerOptions(),r=this.getSourceOption(),i=new Jet(Jq({},n)).source(r.data,r.options),e&&Object.keys(e).forEach((function(t){var n,r,o=t;i[o](null===(n=e[o])||void 0===n?void 0:n.field,null===(r=e[o])||void 0===r?void 0:r.values)})),t.next=7,this.addLayer(i);case 7:this.isLoaded=!0;case 8:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"getSourceOption",value:function(){var t=this.parent.getSource();return{data:this.sourceTile.data,options:{parser:{type:"image",extent:this.sourceTile.bounds},transforms:t.transforms}}}}]),r}(),ict=["rasterData"];function oct(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var act={positions:[0,1],colors:["#000","#fff"]},sct=function(t){wZ(r,Kut);var e,n=oct(r);function r(){return mZ(this,r),n.apply(this,arguments)}return gZ(r,[{key:"initTileLayer",value:(e=RK(jK.mark((function t(){var e,n,r,i,o,a,s;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.parent.getLayerAttributeConfig(),n=this.getLayerOptions(),r=this.getSourceOption(),i=this.getLayerOptions(),o=i.rampColors,a=i.domain,this.colorTexture=this.parent.textureService.getColorTexture(o,a),s=new zrt(Jq(Jq({},n),{},{colorTexture:this.colorTexture})).source(r.data,r.options),e&&Object.keys(e).forEach((function(t){var n,r,i=t;s[i](null===(n=e[i])||void 0===n?void 0:n.field,null===(r=e[i])||void 0===r?void 0:r.values)})),t.next=9,this.addLayer(s);case 9:this.isLoaded=!0;case 10:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"getSourceOption",value:function(){var t=this.parent.getSource(),e=this.sourceTile.data.data,n=e.rasterData,r=v1(e,ict);return{data:n,options:{parser:Jq({type:"raster",extent:this.sourceTile.bounds},r),transforms:t.transforms}}}},{key:"styleUpdate",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=n,o=i.rampColors,a=void 0===o?act:o,s=i.domain;this.colorTexture=this.parent.textureService.getColorTexture(a,s||kK(a)),this.layers.forEach((function(e){return e.style({colorTexture:t.colorTexture})}))}},{key:"destroy",value:function(){this.layers.forEach((function(t){return t.destroy()}))}}]),r}(),uct=["rasterData"];function cct(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var lct=function(t){wZ(r,Kut);var e,n=cct(r);function r(){return mZ(this,r),n.apply(this,arguments)}return gZ(r,[{key:"initTileLayer",value:(e=RK(jK.mark((function t(){var e,n,r,i;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.parent.getLayerAttributeConfig(),n=this.getLayerOptions(),r=this.getSourceOption(),i=new zrt(Jq({},n)).source(r.data,r.options),e&&Object.keys(e).forEach((function(t){var n,r,o=t;i[o](null===(n=e[o])||void 0===n?void 0:n.field,null===(r=e[o])||void 0===r?void 0:r.values)})),t.next=7,this.addLayer(i);case 7:this.isLoaded=!0;case 8:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"getSourceOption",value:function(){var t=this.parent.getSource(),e=this.sourceTile.data.data,n=e.rasterData,r=v1(e,uct);return{data:n,options:{parser:Jq({type:"rasterRgb",extent:this.sourceTile.bounds},r),transforms:t.transforms}}}}]),r}();function hct(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var fct=function(t){wZ(r,Kut);var e,n=hct(r);function r(){return mZ(this,r),n.apply(this,arguments)}return gZ(r,[{key:"initTileLayer",value:(e=RK(jK.mark((function t(){var e,n,r,i;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.parent.getLayerAttributeConfig(),n=this.getLayerOptions(),r=this.getSourceOption(),i=new zrt(Jq({},n)).source(r.data,r.options),e&&Object.keys(e).forEach((function(t){var n,r,o=t;i[o](null===(n=e[o])||void 0===n?void 0:n.field,null===(r=e[o])||void 0===r?void 0:r.values)})),t.next=7,this.addLayer(i);case 7:this.isLoaded=!0;case 8:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"getSourceOption",value:function(){var t=this.parent.getSource();return{data:this.sourceTile.data,options:{parser:{type:"image",extent:this.sourceTile.bounds},transforms:t.transforms}}}}]),r}();function pct(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var dct=function(t){wZ(r,Kut);var e,n=pct(r);function r(){return mZ(this,r),n.apply(this,arguments)}return gZ(r,[{key:"initTileLayer",value:(e=RK(jK.mark((function t(){var e,n,r,i;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.parent.getLayerAttributeConfig(),n=this.getLayerOptions(),r=this.getSourceOption(),i=new Qrt(Jq({},n)).source(r.data,r.options),e&&Object.keys(e).forEach((function(t){var n,r,o=t;i[o](null===(n=e[o])||void 0===n?void 0:n.field,null===(r=e[o])||void 0===r?void 0:r.values)})),t.next=7,this.addLayer(i);case 7:this.isLoaded=!0;case 8:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"getFeatures",value:function(t){return t?this.sourceTile.data.getTileData(t):[]}},{key:"getSourceOption",value:function(){var t=this.parent.getSource(),e=this.parent.getLayerConfig(),n=e.sourceLayer,r=e.featureId;return{data:{type:"FeatureCollection",features:this.getFeatures(n)},options:{parser:{type:"geojson",featureId:r},transforms:t.transforms}}}}]),r}();function mct(t){switch(t.type){case"PolygonLayer":case"LineLayer":case"PointLayer":return Qut;case"TileDebugLayer":return ect;case"MaskLayer":return dct;case"RasterLayer":switch(t.getSource().parser.dataType){case"rgb":case"customRGB":return lct;case"arraybuffer":case"customArrayBuffer":return sct;case"terrainRGB":return fct;default:return rct}default:return Qut}}var vct,gct,yct,xct=["shape","color","size","style","animate","filter","rotate","scale","setBlend","setSelect","setActive"],bct=function(){function t(e){mZ(this,t),$q(this,"initedTileset",!1),$q(this,"viewchange",hZ.debounce(this.mapchange,24)),this.parent=e;var n=this.parent.getContainer();this.rendererService=n.get(J2.IRendererService),this.layerService=n.get(J2.ILayerService),this.mapService=n.get(J2.IMapService),this.pickingService=n.get(J2.IPickingService),this.tileLayerService=new eut({rendererService:this.rendererService,layerService:this.layerService,parent:e}),this.tilePickService=new $ut({tileLayerService:this.tileLayerService,layerService:this.layerService,parent:e}),this.parent.setLayerPickService(this.tilePickService),this.proxy(e),this.initTileSetManager()}var e;return gZ(t,[{key:"initTileSetManager",value:function(){var t,e=this.parent.getSource();this.tilesetManager=e.tileset,this.initedTileset||(this.bindTilesetEvent(),this.initedTileset=!0);var n=this.getCurrentView(),r=n.latLonBounds,i=n.zoom;null===(t=this.tilesetManager)||void 0===t||t.update(i,r)}},{key:"mapchange",value:function(){var t,e=this.getCurrentView(),n=e.latLonBounds,r=e.zoom;if("GAODE1.x"===this.mapService.version){var i=this.parent.getLayerConfig().visible;r<2&&i?(this.parent.updateLayerConfig({visible:!1}),this.layerService.reRender()):r>=2&&!i&&(this.parent.updateLayerConfig({visible:!0}),this.layerService.reRender())}this.lastViewStates&&this.lastViewStates.zoom===r&&this.lastViewStates.latLonBounds.toString()===n.toString()||(this.lastViewStates={zoom:r,latLonBounds:n},null===(t=this.tilesetManager)||void 0===t||t.throttleUpdate(r,n))}},{key:"getCurrentView",value:function(){var t=this.mapService.getBounds();return{latLonBounds:[t[0][0],t[0][1],t[1][0],t[1][1]],zoom:this.mapService.getZoom()}}},{key:"bindTilesetEvent",value:function(){var t=this;this.tilesetManager.on("tile-loaded",(function(t){})),this.tilesetManager.on("tile-unload",(function(e){t.tileUnLoad(e)})),this.tilesetManager.on("tile-error",(function(e,n){t.tileError(e)})),this.tilesetManager.on("tile-update",(function(){t.tileUpdate()})),this.mapService.on("zoomend",(function(){return t.mapchange()})),this.mapService.on("moveend",(function(){return t.viewchange()}))}},{key:"render",value:function(){this.tileLayerService.render()}},{key:"getLayers",value:function(){return this.tileLayerService.getLayers()}},{key:"getTiles",value:function(){return this.tileLayerService.getTiles()}},{key:"tileLoaded",value:function(t){}},{key:"tileError",value:function(t){}},{key:"destroy",value:function(){var t;null===(t=this.tilesetManager)||void 0===t||t.destroy(),this.tileLayerService.destroy()}},{key:"tileUnLoad",value:function(t){this.tileLayerService.removeTile(t.key)}},{key:"tileUpdate",value:(e=RK(jK.mark((function t(){var e,n,r=this;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.tilesetManager){t.next=2;break}return t.abrupt("return");case 2:return e=this.parent.getMinZoom(),n=this.parent.getMaxZoom(),t.next=6,Promise.all(this.tilesetManager.tiles.filter((function(t){return t.isLoaded})).filter((function(t){return t.isVisibleChange})).filter((function(t){return t.data})).filter((function(t){return t.z>=e&&t.z<n})).map(function(){var t=RK(jK.mark((function t(e){var n,i;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r.tileLayerService.hasTile(e.key)){t.next=9;break}return n=mct(r.parent),i=new n(e,r.parent),t.next=5,i.initTileLayer();case 5:r.tilePickService.setPickState(),0!==i.getLayers().length&&(r.tileLayerService.addTile(i),r.tileLayerService.updateTileVisible(e),r.layerService.reRender()),t.next=12;break;case 9:r.tileLayerService.updateTileVisible(e),r.tilePickService.setPickState(),r.layerService.reRender();case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 6:this.tilesetManager.isLoaded&&this.parent.emit("tiles-loaded",this.tilesetManager.currentTiles);case 7:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"setPickState",value:function(t){}},{key:"pickRender",value:function(t){this.tilePickService.pickRender(t)}},{key:"selectFeature",value:function(t){this.tilePickService.selectFeature(t)}},{key:"highlightPickedFeature",value:function(t){this.tilePickService.highlightPickedFeature(t)}},{key:"proxy",value:function(t){var e=this;xct.forEach((function(n){var r=t[n].bind(t);t[n]=function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return r.apply(void 0,o),e.getLayers().map((function(t){t[n].apply(t,o)})),"style"===n&&e.getTiles().forEach((function(t){return t.styleUpdate.apply(t,o)})),t}}))}}]),t}(),_ct=Z2()(vct=function(){function t(){mZ(this,t)}var e,n;return gZ(t,[{key:"initLayerModel",value:(n=RK(jK.mark((function t(e){return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.prepareBuildModel(),t.next=3,e.buildModels();case 3:e.styleNeedUpdate=!1;case 4:case"end":return t.stop()}}),t)}))),function(t){return n.apply(this,arguments)})},{key:"prepareLayerModel",value:(e=RK(jK.mark((function t(e){return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.prepareBuildModel(),t.next=3,e.buildModels();case 3:case"end":return t.stop()}}),t)}))),function(t){return e.apply(this,arguments)})},{key:"apply",value:function(t){var e=this;t.hooks.init.tapPromise("LayerModelPlugin",RK(jK.mark((function n(){return jK.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.getSource().isTile){n.next=4;break}return t.prepareBuildModel(),t.tileLayer=new bct(t),n.abrupt("return");case 4:return n.next=6,e.initLayerModel(t);case 6:case"end":return n.stop()}}),n)})))),t.hooks.beforeRenderData.tapPromise("LayerModelPlugin",function(){var n=RK(jK.mark((function n(r){return jK.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r){n.next=2;break}return n.abrupt("return",!1);case 2:if(!t.getSource().isTile){n.next=5;break}return t.tileLayer=new bct(t),n.abrupt("return",!1);case 5:return n.next=7,e.prepareLayerModel(t);case 7:return n.abrupt("return",!0);case 8:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}())}}]),t}())||vct,wct=Z2()(gct=function(){function t(){mZ(this,t)}return gZ(t,[{key:"apply",value:function(t){t.hooks.afterInit.tap("LayerStylePlugin",(function(){var e=t.getLayerConfig(),n=e.autoFit,r=e.fitBoundsOptions;n&&t.fitBounds(r)}))}}]),t}())||gct,Sct=["type"],Mct={directional:{lights:"u_DirectionalLights",num:"u_NumOfDirectionalLights"},spot:{lights:"u_SpotLights",num:"u_NumOfSpotLights"}},Ect={type:"directional",direction:[1,10.5,12],ambient:[.2,.2,.2],diffuse:[.6,.6,.6],specular:[.1,.1,.1]},Act={direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0]},Tct={position:[0,0,0],direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0],constant:1,linear:0,quadratic:0,angle:14,exponent:40,blur:5};var Cct,Oct,kct,Pct=Z2()(yct=function(){function t(){mZ(this,t)}return gZ(t,[{key:"apply",value:function(t){t.hooks.beforeRender.tap("LightingPlugin",(function(){t.getLayerConfig().enableLighting&&t.models.forEach((function(t){return t.addUniforms(Jq({},(n={u_DirectionalLights:new Array(3).fill(Jq({},Act)),u_NumOfDirectionalLights:0,u_SpotLights:new Array(3).fill(Jq({},Tct)),u_NumOfSpotLights:0},e&&e.length||(e=[Ect]),e.forEach((function(t){var e=t.type,r=void 0===e?"directional":e,i=v1(t,Sct),o=Mct[r].lights,a=Mct[r].num,s=n[a];n[o][s]=Jq(Jq({},n[o][s]),i),n[a]++})),n)));var e,n}))}))}}]),t}())||yct,Lct=Z2()(Cct=function(){function t(){mZ(this,t)}return gZ(t,[{key:"apply",value:function(t,e){var n=this,r=e.rendererService,i=e.postProcessingPassFactory,o=e.normalPassFactory;t.hooks.init.tapPromise("MultiPassRendererPlugin",(function(){var e=t.getLayerConfig(),r=e.enableMultiPassRenderer,a=e.passes,s=void 0===a?[]:a;n.enabled=!!r&&!1!==t.getLayerConfig().enableMultiPassRenderer,n.enabled&&(t.multiPassRenderer=Ptt(t,s,i,o),t.multiPassRenderer.setRenderFlag(!0))})),t.hooks.beforeRender.tap("MultiPassRendererPlugin",(function(){if(n.enabled){var e=r.getViewportSize(),i=e.width,o=e.height;t.multiPassRenderer.resize(i,o)}}))}}]),t}())||Cct,Rct=1,Ict=2,Nct=Z2()(Oct=function(){function t(){mZ(this,t)}return gZ(t,[{key:"apply",value:function(t,e){var n=e.styleAttributeService;t.hooks.init.tapPromise("PixelPickingPlugin",(function(){var e=t.getLayerConfig().enablePicking;n.registerStyleAttribute({name:"pickingColor",type:d8.Attribute,descriptor:{name:"a_PickingColor",buffer:{data:[],type:m4.FLOAT},size:3,update:function(t){var n=t.id;return e?TK(n):[0,0,0]}}})})),t.hooks.beforePickingEncode.tap("PixelPickingPlugin",(function(){t.getLayerConfig().enablePicking&&t.isVisible()&&t.models.forEach((function(t){return t.addUniforms({u_PickingStage:Rct})}))})),t.hooks.afterPickingEncode.tap("PixelPickingPlugin",(function(){t.getLayerConfig().enablePicking&&t.isVisible()&&t.models.forEach((function(t){return t.addUniforms({u_PickingStage:Ict})}))})),t.hooks.beforeHighlight.tap("PixelPickingPlugin",(function(e){var n=t.getLayerConfig(),r=n.highlightColor,i=n.activeMix,o=void 0===i?0:i,a="string"==typeof r?EK(r):r||[1,0,0,1];t.updateLayerConfig({pickedFeatureID:AK(new Uint8Array(e))}),t.models.forEach((function(t){return t.addUniforms({u_PickingStage:Ict,u_PickingColor:e,u_HighlightColor:a.map((function(t){return 255*t})),u_activeMix:o})}))})),t.hooks.beforeSelect.tap("PixelPickingPlugin",(function(e){var n=t.getLayerConfig(),r=n.selectColor,i=n.selectMix,o=void 0===i?0:i,a="string"==typeof r?EK(r):r||[1,0,0,1];t.updateLayerConfig({pickedFeatureID:AK(new Uint8Array(e))}),t.models.forEach((function(t){return t.addUniforms({u_PickingStage:Ict,u_PickingColor:e,u_HighlightColor:a.map((function(t){return 255*t})),u_activeMix:o,u_CurrentSelectedId:e,u_SelectColor:a.map((function(t){return 255*t})),u_EnableSelect:1})}))}))}}]),t}())||Oct,Dct=["mvt","geojsonvt","testTile"];var Fct,jct,Bct,zct,Uct,Vct,Gct,Wct,Hct,Yct,Xct,qct,Zct,$ct=Z2()(kct=function(){function t(){mZ(this,t)}return gZ(t,[{key:"apply",value:function(t,e){var n=this,r=e.styleAttributeService;t.hooks.init.tapPromise("RegisterStyleAttributePlugin",(function(){(function(t){var e=t.getSource();return Dct.includes(e.parser.type)})(t)||n.registerBuiltinAttributes(r,t)}))}},{key:"registerBuiltinAttributes",value:function(t,e){"MaskLayer"!==e.type?(this.registerPositionAttribute(t),this.registerColorAttribute(t),this.registerVertexIdAttribute(t)):this.registerPositionAttribute(t)}},{key:"registerPositionAttribute",value:function(t){t.registerStyleAttribute({name:"position",type:d8.Attribute,descriptor:{name:"a_Position",buffer:{data:[],type:m4.FLOAT},size:3,update:function(t,e,n){return 2===n.length?[n[0],n[1],0]:[n[0],n[1],n[2]]}}})}},{key:"registerFilterAttribute",value:function(t){t.registerStyleAttribute({name:"filter",type:d8.Attribute,descriptor:{name:"filter",buffer:{usage:m4.DYNAMIC_DRAW,data:[],type:m4.FLOAT},size:1,update:function(t){return t.filter?[1]:[0]}}})}},{key:"registerColorAttribute",value:function(t){t.registerStyleAttribute({name:"color",type:d8.Attribute,descriptor:{name:"a_Color",buffer:{usage:m4.DYNAMIC_DRAW,data:[],type:m4.FLOAT},size:4,update:function(t){var e=t.color;return e&&e.length?e:[1,1,1,1]}}})}},{key:"registerVertexIdAttribute",value:function(t){t.registerStyleAttribute({name:"vertexId",type:d8.Attribute,descriptor:{name:"a_vertexId",buffer:{usage:m4.DYNAMIC_DRAW,data:[],type:m4.FLOAT},size:1,update:function(t,e){return[e]}}})}}]),t}())||kct,Kct=(Fct=Z2(),jct=d2(J2.ICameraService),Bct=d2(J2.ICoordinateSystemService),zct=d2(J2.IRendererService),Uct=d2(J2.IMapService),Fct((Wct=j3((Gct=function(){function t(){mZ(this,t),F3(this,"cameraService",Wct,this),F3(this,"coordinateSystemService",Hct,this),F3(this,"rendererService",Yct,this),F3(this,"mapService",Xct,this)}return gZ(t,[{key:"apply",value:function(t){var e=this,n=this.mapService.version,r=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],i=[0,0];t.hooks.beforeRender.tap("ShaderUniformPlugin",(function(){var o=t.getLayerConfig().tileOrigin;e.coordinateSystemService.refresh(o),"GAODE2.x"===n&&(e.setLayerCenter(t),r=e.mapService.map.customCoords.getMVPMatrix(),i=e.mapService.getCustomCoordCenter());var a=e.rendererService.getViewportSize(),s=a.width,u=a.height;t.models.forEach((function(n){var o;n.addUniforms(($q(o={},S8,e.cameraService.getProjectionMatrix()),$q(o,M8,e.cameraService.getViewMatrix()),$q(o,E8,e.cameraService.getViewProjectionMatrix()),$q(o,A8,e.cameraService.getZoom()),$q(o,T8,e.cameraService.getZoomScale()),$q(o,C8,e.cameraService.getFocalDistance()),$q(o,O8,e.cameraService.getCameraPosition()),$q(o,$3,e.coordinateSystemService.getCoordinateSystem()),$q(o,K3,e.coordinateSystemService.getViewportCenter()),$q(o,J3,e.coordinateSystemService.getViewportCenterProjection()),$q(o,Q3,e.coordinateSystemService.getPixelsPerDegree()),$q(o,t4,e.coordinateSystemService.getPixelsPerDegree2()),$q(o,e4,e.coordinateSystemService.getPixelsPerMeter()),$q(o,n4,r),$q(o,"u_SceneCenterMKT",i),$q(o,"u_ViewportSize",[s,u]),$q(o,"u_ModelMatrix",e.cameraService.getModelMatrix()),$q(o,"u_DevicePixelRatio",F$.devicePixelRatio),$q(o,"u_PickingBuffer",t.getLayerConfig().pickingBuffer||0),$q(o,"u_shaderPick",Number(t.getShaderPickStat())),o))}))}))}},{key:"setLayerCenter",value:function(t){void 0===t.coordCenter&&(t.coordCenter=t.getSource().center),this.mapService.setCoordCenter&&this.mapService.setCoordCenter(t.coordCenter)}}]),t}()).prototype,"cameraService",[jct],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hct=j3(Gct.prototype,"coordinateSystemService",[Bct],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yct=j3(Gct.prototype,"rendererService",[zct],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xct=j3(Gct.prototype,"mapService",[Uct],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vct=Gct))||Vct),Jct=Z2()(qct=function(){function t(){mZ(this,t)}return gZ(t,[{key:"apply",value:function(t){t.hooks.beforeRender.tap("UpdateModelPlugin",(function(){t.layerModel&&t.layerModel.needUpdate().then((function(e){e&&t.renderLayers()}))})),t.hooks.afterRender.tap("UpdateModelPlugin",(function(){t.layerModelNeedUpdate=!1}))}}]),t}())||qct,Qct=Z2()(Zct=function(){function t(){mZ(this,t)}return gZ(t,[{key:"apply",value:function(t,e){var n=this,r=e.styleAttributeService;t.hooks.init.tapPromise("UpdateStyleAttributePlugin",(function(){n.initStyleAttribute(t,{styleAttributeService:r})})),t.hooks.beforeRender.tap("UpdateStyleAttributePlugin",(function(){t.layerModelNeedUpdate||t.inited&&n.updateStyleAttribute(t,{styleAttributeService:r})}))}},{key:"updateStyleAttribute",value:function(t,e){var n=e.styleAttributeService,r=n.getLayerStyleAttributes()||[],i=n.getLayerStyleAttribute("filter");if(i&&i.needRegenerateVertices)return t.layerModelNeedUpdate=!0,void r.forEach((function(t){return t.needRegenerateVertices=!1}));r.filter((function(t){return t.needRegenerateVertices})).forEach((function(e){n.updateAttributeByFeatureRange(e.name,t.getEncodedData(),e.featureRange.startIndex,e.featureRange.endIndex,t),e.needRegenerateVertices=!1}))}},{key:"initStyleAttribute",value:function(t,e){var n=e.styleAttributeService;(n.getLayerStyleAttributes()||[]).filter((function(t){return t.needRegenerateVertices})).forEach((function(e){n.updateAttributeByFeatureRange(e.name,t.getEncodedData(),e.featureRange.startIndex,e.featureRange.endIndex),e.needRegenerateVertices=!1}))}}]),t}())||Zct;s8.bind(J2.ILayerPlugin).to(eit).inRequestScope(),s8.bind(J2.ILayerPlugin).to($ct).inRequestScope(),s8.bind(J2.ILayerPlugin).to(Qst).inRequestScope(),s8.bind(J2.ILayerPlugin).to(tit).inRequestScope(),s8.bind(J2.ILayerPlugin).to(wct).inRequestScope(),s8.bind(J2.ILayerPlugin).to(Qct).inRequestScope(),s8.bind(J2.ILayerPlugin).to(Jct).inRequestScope(),s8.bind(J2.ILayerPlugin).to(Lct).inRequestScope(),s8.bind(J2.ILayerPlugin).to(Kct).inRequestScope(),s8.bind(J2.ILayerPlugin).to(tut).inRequestScope(),s8.bind(J2.ILayerPlugin).to(Pct).inRequestScope(),s8.bind(J2.ILayerPlugin).to(Nct).inRequestScope(),s8.bind(J2.ILayerPlugin).to(_ct).inRequestScope();var tlt={},elt={get exports(){return tlt},set exports(t){tlt=t}},nlt={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},rlt="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",ilt={5:rlt,"5module":rlt+" export import",6:rlt+" const class extends export import super"},olt=/^in(stanceof)?$/,alt="ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԯԱ-Ֆՙՠ-ֈא-תׯ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࡠ-ࡪࢠ-ࢴࢶ-ࣇऄ-हऽॐक़-ॡॱ-ঀঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱৼਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡૹଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-హఽౘ-ౚౠౡಀಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഄ-ഌഎ-ഐഒ-ഺഽൎൔ-ൖൟ-ൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄຆ-ຊຌ-ຣລວ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏽᏸ-ᏽᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛸᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡸᢀ-ᢨᢪᢰ-ᣵᤀ-ᤞᥐ-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᲀ-ᲈᲐ-ᲺᲽ-Ჿᳩ-ᳬᳮ-ᳳᳵᳶᳺᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕ℘-ℝℤΩℨK-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞ々-〇〡-〩〱-〵〸-〼ぁ-ゖ゛-ゟァ-ヺー-ヿㄅ-ㄯㄱ-ㆎㆠ-ㆿㇰ-ㇿ㐀-䶿一-鿼ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚝꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꞿꟂ-ꟊꟵ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꣽꣾꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꧠ-ꧤꧦ-ꧯꧺ-ꧾꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꩾ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭩꭰ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ",slt="‌‍·̀-ͯ·҃-֑҇-ׇֽֿׁׂׅׄؐ-ًؚ-٩ٰۖ-ۜ۟-۪ۤۧۨ-ۭ۰-۹ܑܰ-݊ަ-ް߀-߉߫-߽߳ࠖ-࠙ࠛ-ࠣࠥ-ࠧࠩ-࡙࠭-࡛࣓-ࣣ࣡-ःऺ-़ा-ॏ॑-ॗॢॣ०-९ঁ-ঃ়া-ৄেৈো-্ৗৢৣ০-৯৾ਁ-ਃ਼ਾ-ੂੇੈੋ-੍ੑ੦-ੱੵઁ-ઃ઼ા-ૅે-ૉો-્ૢૣ૦-૯ૺ-૿ଁ-ଃ଼ା-ୄେୈୋ-୍୕-ୗୢୣ୦-୯ஂா-ூெ-ைொ-்ௗ௦-௯ఀ-ఄా-ౄె-ైొ-్ౕౖౢౣ౦-౯ಁ-ಃ಼ಾ-ೄೆ-ೈೊ-್ೕೖೢೣ೦-೯ഀ-ഃ഻഼ാ-ൄെ-ൈൊ-്ൗൢൣ൦-൯ඁ-ඃ්ා-ුූෘ-ෟ෦-෯ෲෳัิ-ฺ็-๎๐-๙ັິ-ຼ່-ໍ໐-໙༘༙༠-༩༹༵༷༾༿ཱ-྄྆྇ྍ-ྗྙ-ྼ࿆ါ-ှ၀-၉ၖ-ၙၞ-ၠၢ-ၤၧ-ၭၱ-ၴႂ-ႍႏ-ႝ፝-፟፩-፱ᜒ-᜔ᜲ-᜴ᝒᝓᝲᝳ឴-៓៝០-៩᠋-᠍᠐-᠙ᢩᤠ-ᤫᤰ-᤻᥆-᥏᧐-᧚ᨗ-ᨛᩕ-ᩞ᩠-᩿᩼-᪉᪐-᪙᪰-᪽ᪿᫀᬀ-ᬄ᬴-᭄᭐-᭙᭫-᭳ᮀ-ᮂᮡ-ᮭ᮰-᮹᯦-᯳ᰤ-᰷᱀-᱉᱐-᱙᳐-᳔᳒-᳨᳭᳴᳷-᳹᷀-᷹᷻-᷿‿⁀⁔⃐-⃥⃜⃡-⃰⳯-⵿⳱ⷠ-〪ⷿ-゙゚〯꘠-꘩꙯ꙴ-꙽ꚞꚟ꛰꛱ꠂ꠆ꠋꠣ-ꠧ꠬ꢀꢁꢴ-ꣅ꣐-꣙꣠-꣱ꣿ-꤉ꤦ-꤭ꥇ-꥓ꦀ-ꦃ꦳-꧀꧐-꧙ꧥ꧰-꧹ꨩ-ꨶꩃꩌꩍ꩐-꩙ꩻ-ꩽꪰꪲ-ꪴꪷꪸꪾ꪿꫁ꫫ-ꫯꫵ꫶ꯣ-ꯪ꯬꯭꯰-꯹ﬞ︀-️︠-︯︳︴﹍-﹏０-９＿",ult=new RegExp("["+alt+"]"),clt=new RegExp("["+alt+slt+"]");alt=slt=null;var llt=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,157,310,10,21,11,7,153,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,349,41,7,1,79,28,11,0,9,21,107,20,28,22,13,52,76,44,33,24,27,35,30,0,3,0,9,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,85,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,159,52,19,3,21,2,31,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,230,43,117,63,32,7,3,0,3,7,2,1,2,23,16,0,2,0,95,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,35,56,264,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,190,0,80,921,103,110,18,195,2749,1070,4050,582,8634,568,8,30,114,29,19,47,17,3,32,20,6,18,689,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,1237,43,8,8952,286,50,2,18,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,2357,44,11,6,17,0,370,43,1301,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42717,35,4148,12,221,3,5761,15,7472,3104,541,1507,4938],hlt=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,370,1,154,10,176,2,54,14,32,9,16,3,46,10,54,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,2,11,83,11,7,0,161,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,193,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,84,14,5,9,243,14,166,9,71,5,2,1,3,3,2,0,2,1,13,9,120,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,406,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,19306,9,135,4,60,6,26,9,1014,0,2,54,8,3,82,0,12,1,19628,1,5319,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,262,6,10,9,419,13,1495,6,110,6,6,9,4759,9,787719,239];function flt(t,e){for(var n=65536,r=0;r<e.length;r+=2){if((n+=e[r])>t)return!1;if((n+=e[r+1])>=t)return!0}}function plt(t,e){return t<65?36===t:t<91||(t<97?95===t:t<123||(t<=65535?t>=170&&ult.test(String.fromCharCode(t)):!1!==e&&flt(t,llt)))}function dlt(t,e){return t<48?36===t:t<58||!(t<65)&&(t<91||(t<97?95===t:t<123||(t<=65535?t>=170&&clt.test(String.fromCharCode(t)):!1!==e&&(flt(t,llt)||flt(t,hlt)))))}var mlt=function(t,e){void 0===e&&(e={}),this.label=t,this.keyword=e.keyword,this.beforeExpr=!!e.beforeExpr,this.startsExpr=!!e.startsExpr,this.isLoop=!!e.isLoop,this.isAssign=!!e.isAssign,this.prefix=!!e.prefix,this.postfix=!!e.postfix,this.binop=e.binop||null,this.updateContext=null};function vlt(t,e){return new mlt(t,{beforeExpr:!0,binop:e})}var glt={beforeExpr:!0},ylt={startsExpr:!0},xlt={};function blt(t,e){return void 0===e&&(e={}),e.keyword=t,xlt[t]=new mlt(t,e)}var _lt={num:new mlt("num",ylt),regexp:new mlt("regexp",ylt),string:new mlt("string",ylt),name:new mlt("name",ylt),eof:new mlt("eof"),bracketL:new mlt("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new mlt("]"),braceL:new mlt("{",{beforeExpr:!0,startsExpr:!0}),braceR:new mlt("}"),parenL:new mlt("(",{beforeExpr:!0,startsExpr:!0}),parenR:new mlt(")"),comma:new mlt(",",glt),semi:new mlt(";",glt),colon:new mlt(":",glt),dot:new mlt("."),question:new mlt("?",glt),questionDot:new mlt("?."),arrow:new mlt("=>",glt),template:new mlt("template"),invalidTemplate:new mlt("invalidTemplate"),ellipsis:new mlt("...",glt),backQuote:new mlt("`",ylt),dollarBraceL:new mlt("${",{beforeExpr:!0,startsExpr:!0}),eq:new mlt("=",{beforeExpr:!0,isAssign:!0}),assign:new mlt("_=",{beforeExpr:!0,isAssign:!0}),incDec:new mlt("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new mlt("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:vlt("||",1),logicalAND:vlt("&&",2),bitwiseOR:vlt("|",3),bitwiseXOR:vlt("^",4),bitwiseAND:vlt("&",5),equality:vlt("==/!=/===/!==",6),relational:vlt("</>/<=/>=",7),bitShift:vlt("<</>>/>>>",8),plusMin:new mlt("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:vlt("%",10),star:vlt("*",10),slash:vlt("/",10),starstar:new mlt("**",{beforeExpr:!0}),coalesce:vlt("??",1),_break:blt("break"),_case:blt("case",glt),_catch:blt("catch"),_continue:blt("continue"),_debugger:blt("debugger"),_default:blt("default",glt),_do:blt("do",{isLoop:!0,beforeExpr:!0}),_else:blt("else",glt),_finally:blt("finally"),_for:blt("for",{isLoop:!0}),_function:blt("function",ylt),_if:blt("if"),_return:blt("return",glt),_switch:blt("switch"),_throw:blt("throw",glt),_try:blt("try"),_var:blt("var"),_const:blt("const"),_while:blt("while",{isLoop:!0}),_with:blt("with"),_new:blt("new",{beforeExpr:!0,startsExpr:!0}),_this:blt("this",ylt),_super:blt("super",ylt),_class:blt("class",ylt),_extends:blt("extends",glt),_export:blt("export"),_import:blt("import",ylt),_null:blt("null",ylt),_true:blt("true",ylt),_false:blt("false",ylt),_in:blt("in",{beforeExpr:!0,binop:7}),_instanceof:blt("instanceof",{beforeExpr:!0,binop:7}),_typeof:blt("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:blt("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:blt("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},wlt=/\r\n?|\n|\u2028|\u2029/,Slt=new RegExp(wlt.source,"g");function Mlt(t,e){return 10===t||13===t||!e&&(8232===t||8233===t)}var Elt=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/,Alt=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,Tlt=Object.prototype,Clt=Tlt.hasOwnProperty,Olt=Tlt.toString;function klt(t,e){return Clt.call(t,e)}var Plt=Array.isArray||function(t){return"[object Array]"===Olt.call(t)};function Llt(t){return new RegExp("^(?:"+t.replace(/ /g,"|")+")$")}var Rlt=function(t,e){this.line=t,this.column=e};Rlt.prototype.offset=function(t){return new Rlt(this.line,this.column+t)};var Ilt=function(t,e,n){this.start=e,this.end=n,null!==t.sourceFile&&(this.source=t.sourceFile)};function Nlt(t,e){for(var n=1,r=0;;){Slt.lastIndex=r;var i=Slt.exec(t);if(!(i&&i.index<e))return new Rlt(n,e-r);++n,r=i.index+i[0].length}}var Dlt={ecmaVersion:10,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:!1,allowHashBang:!1,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1};function Flt(t){var e={};for(var n in Dlt)e[n]=t&&klt(t,n)?t[n]:Dlt[n];if(e.ecmaVersion>=2015&&(e.ecmaVersion-=2009),null==e.allowReserved&&(e.allowReserved=e.ecmaVersion<5),Plt(e.onToken)){var r=e.onToken;e.onToken=function(t){return r.push(t)}}return Plt(e.onComment)&&(e.onComment=function(t,e){return function(n,r,i,o,a,s){var u={type:n?"Block":"Line",value:r,start:i,end:o};t.locations&&(u.loc=new Ilt(this,a,s)),t.ranges&&(u.range=[i,o]),e.push(u)}}(e,e.onComment)),e}function jlt(t,e){return 2|(t?4:0)|(e?8:0)}var Blt=function(t,e,n){this.options=t=Flt(t),this.sourceFile=t.sourceFile,this.keywords=Llt(ilt[t.ecmaVersion>=6?6:"module"===t.sourceType?"5module":5]);var r="";if(!0!==t.allowReserved){for(var i=t.ecmaVersion;!(r=nlt[i]);i--);"module"===t.sourceType&&(r+=" await")}this.reservedWords=Llt(r);var o=(r?r+" ":"")+nlt.strict;this.reservedWordsStrict=Llt(o),this.reservedWordsStrictBind=Llt(o+" "+nlt.strictBind),this.input=String(e),this.containsEsc=!1,n?(this.pos=n,this.lineStart=this.input.lastIndexOf("\n",n-1)+1,this.curLine=this.input.slice(0,this.lineStart).split(wlt).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=_lt.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule="module"===t.sourceType,this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.yieldPos=this.awaitPos=this.awaitIdentPos=0,this.labels=[],this.undefinedExports={},0===this.pos&&t.allowHashBang&&"#!"===this.input.slice(0,2)&&this.skipLineComment(2),this.scopeStack=[],this.enterScope(1),this.regexpState=null},zlt={inFunction:{configurable:!0},inGenerator:{configurable:!0},inAsync:{configurable:!0},allowSuper:{configurable:!0},allowDirectSuper:{configurable:!0},treatFunctionsAsVar:{configurable:!0}};Blt.prototype.parse=function(){var t=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(t)},zlt.inFunction.get=function(){return(2&this.currentVarScope().flags)>0},zlt.inGenerator.get=function(){return(8&this.currentVarScope().flags)>0},zlt.inAsync.get=function(){return(4&this.currentVarScope().flags)>0},zlt.allowSuper.get=function(){return(64&this.currentThisScope().flags)>0},zlt.allowDirectSuper.get=function(){return(128&this.currentThisScope().flags)>0},zlt.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope())},Blt.prototype.inNonArrowFunction=function(){return(2&this.currentThisScope().flags)>0},Blt.extend=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];for(var n=this,r=0;r<t.length;r++)n=t[r](n);return n},Blt.parse=function(t,e){return new this(e,t).parse()},Blt.parseExpressionAt=function(t,e,n){var r=new this(n,t,e);return r.nextToken(),r.parseExpression()},Blt.tokenizer=function(t,e){return new this(e,t)},Object.defineProperties(Blt.prototype,zlt);var Ult=Blt.prototype,Vlt=/^(?:'((?:\\.|[^'\\])*?)'|"((?:\\.|[^"\\])*?)")/;function Glt(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1}Ult.strictDirective=function(t){for(;;){Alt.lastIndex=t,t+=Alt.exec(this.input)[0].length;var e=Vlt.exec(this.input.slice(t));if(!e)return!1;if("use strict"===(e[1]||e[2])){Alt.lastIndex=t+e[0].length;var n=Alt.exec(this.input),r=n.index+n[0].length,i=this.input.charAt(r);return";"===i||"}"===i||wlt.test(n[0])&&!(/[(`.[+\-/*%<>=,?^&]/.test(i)||"!"===i&&"="===this.input.charAt(r+1))}t+=e[0].length,Alt.lastIndex=t,t+=Alt.exec(this.input)[0].length,";"===this.input[t]&&t++}},Ult.eat=function(t){return this.type===t&&(this.next(),!0)},Ult.isContextual=function(t){return this.type===_lt.name&&this.value===t&&!this.containsEsc},Ult.eatContextual=function(t){return!!this.isContextual(t)&&(this.next(),!0)},Ult.expectContextual=function(t){this.eatContextual(t)||this.unexpected()},Ult.canInsertSemicolon=function(){return this.type===_lt.eof||this.type===_lt.braceR||wlt.test(this.input.slice(this.lastTokEnd,this.start))},Ult.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0},Ult.semicolon=function(){this.eat(_lt.semi)||this.insertSemicolon()||this.unexpected()},Ult.afterTrailingComma=function(t,e){if(this.type===t)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),e||this.next(),!0},Ult.expect=function(t){this.eat(t)||this.unexpected()},Ult.unexpected=function(t){this.raise(null!=t?t:this.start,"Unexpected token")},Ult.checkPatternErrors=function(t,e){if(t){t.trailingComma>-1&&this.raiseRecoverable(t.trailingComma,"Comma is not permitted after the rest element");var n=e?t.parenthesizedAssign:t.parenthesizedBind;n>-1&&this.raiseRecoverable(n,"Parenthesized pattern")}},Ult.checkExpressionErrors=function(t,e){if(!t)return!1;var n=t.shorthandAssign,r=t.doubleProto;if(!e)return n>=0||r>=0;n>=0&&this.raise(n,"Shorthand property assignments are valid only in destructuring patterns"),r>=0&&this.raiseRecoverable(r,"Redefinition of __proto__ property")},Ult.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")},Ult.isSimpleAssignTarget=function(t){return"ParenthesizedExpression"===t.type?this.isSimpleAssignTarget(t.expression):"Identifier"===t.type||"MemberExpression"===t.type};var Wlt=Blt.prototype;Wlt.parseTopLevel=function(t){var e={};for(t.body||(t.body=[]);this.type!==_lt.eof;){var n=this.parseStatement(null,!0,e);t.body.push(n)}if(this.inModule)for(var r=0,i=Object.keys(this.undefinedExports);r<i.length;r+=1){var o=i[r];this.raiseRecoverable(this.undefinedExports[o].start,"Export '"+o+"' is not defined")}return this.adaptDirectivePrologue(t.body),this.next(),t.sourceType=this.options.sourceType,this.finishNode(t,"Program")};var Hlt={kind:"loop"},Ylt={kind:"switch"};Wlt.isLet=function(t){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;Alt.lastIndex=this.pos;var e=Alt.exec(this.input),n=this.pos+e[0].length,r=this.input.charCodeAt(n);if(91===r)return!0;if(t)return!1;if(123===r)return!0;if(plt(r,!0)){for(var i=n+1;dlt(this.input.charCodeAt(i),!0);)++i;var o=this.input.slice(n,i);if(!olt.test(o))return!0}return!1},Wlt.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;Alt.lastIndex=this.pos;var t=Alt.exec(this.input),e=this.pos+t[0].length;return!(wlt.test(this.input.slice(this.pos,e))||"function"!==this.input.slice(e,e+8)||e+8!==this.input.length&&dlt(this.input.charAt(e+8)))},Wlt.parseStatement=function(t,e,n){var r,i=this.type,o=this.startNode();switch(this.isLet(t)&&(i=_lt._var,r="let"),i){case _lt._break:case _lt._continue:return this.parseBreakContinueStatement(o,i.keyword);case _lt._debugger:return this.parseDebuggerStatement(o);case _lt._do:return this.parseDoStatement(o);case _lt._for:return this.parseForStatement(o);case _lt._function:return t&&(this.strict||"if"!==t&&"label"!==t)&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(o,!1,!t);case _lt._class:return t&&this.unexpected(),this.parseClass(o,!0);case _lt._if:return this.parseIfStatement(o);case _lt._return:return this.parseReturnStatement(o);case _lt._switch:return this.parseSwitchStatement(o);case _lt._throw:return this.parseThrowStatement(o);case _lt._try:return this.parseTryStatement(o);case _lt._const:case _lt._var:return r=r||this.value,t&&"var"!==r&&this.unexpected(),this.parseVarStatement(o,r);case _lt._while:return this.parseWhileStatement(o);case _lt._with:return this.parseWithStatement(o);case _lt.braceL:return this.parseBlock(!0,o);case _lt.semi:return this.parseEmptyStatement(o);case _lt._export:case _lt._import:if(this.options.ecmaVersion>10&&i===_lt._import){Alt.lastIndex=this.pos;var a=Alt.exec(this.input),s=this.pos+a[0].length,u=this.input.charCodeAt(s);if(40===u||46===u)return this.parseExpressionStatement(o,this.parseExpression())}return this.options.allowImportExportEverywhere||(e||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),i===_lt._import?this.parseImport(o):this.parseExport(o,n);default:if(this.isAsyncFunction())return t&&this.unexpected(),this.next(),this.parseFunctionStatement(o,!0,!t);var c=this.value,l=this.parseExpression();return i===_lt.name&&"Identifier"===l.type&&this.eat(_lt.colon)?this.parseLabeledStatement(o,c,l,t):this.parseExpressionStatement(o,l)}},Wlt.parseBreakContinueStatement=function(t,e){var n="break"===e;this.next(),this.eat(_lt.semi)||this.insertSemicolon()?t.label=null:this.type!==_lt.name?this.unexpected():(t.label=this.parseIdent(),this.semicolon());for(var r=0;r<this.labels.length;++r){var i=this.labels[r];if(null==t.label||i.name===t.label.name){if(null!=i.kind&&(n||"loop"===i.kind))break;if(t.label&&n)break}}return r===this.labels.length&&this.raise(t.start,"Unsyntactic "+e),this.finishNode(t,n?"BreakStatement":"ContinueStatement")},Wlt.parseDebuggerStatement=function(t){return this.next(),this.semicolon(),this.finishNode(t,"DebuggerStatement")},Wlt.parseDoStatement=function(t){return this.next(),this.labels.push(Hlt),t.body=this.parseStatement("do"),this.labels.pop(),this.expect(_lt._while),t.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(_lt.semi):this.semicolon(),this.finishNode(t,"DoWhileStatement")},Wlt.parseForStatement=function(t){this.next();var e=this.options.ecmaVersion>=9&&(this.inAsync||!this.inFunction&&this.options.allowAwaitOutsideFunction)&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push(Hlt),this.enterScope(0),this.expect(_lt.parenL),this.type===_lt.semi)return e>-1&&this.unexpected(e),this.parseFor(t,null);var n=this.isLet();if(this.type===_lt._var||this.type===_lt._const||n){var r=this.startNode(),i=n?"let":this.value;return this.next(),this.parseVar(r,!0,i),this.finishNode(r,"VariableDeclaration"),(this.type===_lt._in||this.options.ecmaVersion>=6&&this.isContextual("of"))&&1===r.declarations.length?(this.options.ecmaVersion>=9&&(this.type===_lt._in?e>-1&&this.unexpected(e):t.await=e>-1),this.parseForIn(t,r)):(e>-1&&this.unexpected(e),this.parseFor(t,r))}var o=new Glt,a=this.parseExpression(!0,o);return this.type===_lt._in||this.options.ecmaVersion>=6&&this.isContextual("of")?(this.options.ecmaVersion>=9&&(this.type===_lt._in?e>-1&&this.unexpected(e):t.await=e>-1),this.toAssignable(a,!1,o),this.checkLVal(a),this.parseForIn(t,a)):(this.checkExpressionErrors(o,!0),e>-1&&this.unexpected(e),this.parseFor(t,a))},Wlt.parseFunctionStatement=function(t,e,n){return this.next(),this.parseFunction(t,qlt|(n?0:Zlt),!1,e)},Wlt.parseIfStatement=function(t){return this.next(),t.test=this.parseParenExpression(),t.consequent=this.parseStatement("if"),t.alternate=this.eat(_lt._else)?this.parseStatement("if"):null,this.finishNode(t,"IfStatement")},Wlt.parseReturnStatement=function(t){return this.inFunction||this.options.allowReturnOutsideFunction||this.raise(this.start,"'return' outside of function"),this.next(),this.eat(_lt.semi)||this.insertSemicolon()?t.argument=null:(t.argument=this.parseExpression(),this.semicolon()),this.finishNode(t,"ReturnStatement")},Wlt.parseSwitchStatement=function(t){var e;this.next(),t.discriminant=this.parseParenExpression(),t.cases=[],this.expect(_lt.braceL),this.labels.push(Ylt),this.enterScope(0);for(var n=!1;this.type!==_lt.braceR;)if(this.type===_lt._case||this.type===_lt._default){var r=this.type===_lt._case;e&&this.finishNode(e,"SwitchCase"),t.cases.push(e=this.startNode()),e.consequent=[],this.next(),r?e.test=this.parseExpression():(n&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),n=!0,e.test=null),this.expect(_lt.colon)}else e||this.unexpected(),e.consequent.push(this.parseStatement(null));return this.exitScope(),e&&this.finishNode(e,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(t,"SwitchStatement")},Wlt.parseThrowStatement=function(t){return this.next(),wlt.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),t.argument=this.parseExpression(),this.semicolon(),this.finishNode(t,"ThrowStatement")};var Xlt=[];Wlt.parseTryStatement=function(t){if(this.next(),t.block=this.parseBlock(),t.handler=null,this.type===_lt._catch){var e=this.startNode();if(this.next(),this.eat(_lt.parenL)){e.param=this.parseBindingAtom();var n="Identifier"===e.param.type;this.enterScope(n?32:0),this.checkLVal(e.param,n?4:2),this.expect(_lt.parenR)}else this.options.ecmaVersion<10&&this.unexpected(),e.param=null,this.enterScope(0);e.body=this.parseBlock(!1),this.exitScope(),t.handler=this.finishNode(e,"CatchClause")}return t.finalizer=this.eat(_lt._finally)?this.parseBlock():null,t.handler||t.finalizer||this.raise(t.start,"Missing catch or finally clause"),this.finishNode(t,"TryStatement")},Wlt.parseVarStatement=function(t,e){return this.next(),this.parseVar(t,!1,e),this.semicolon(),this.finishNode(t,"VariableDeclaration")},Wlt.parseWhileStatement=function(t){return this.next(),t.test=this.parseParenExpression(),this.labels.push(Hlt),t.body=this.parseStatement("while"),this.labels.pop(),this.finishNode(t,"WhileStatement")},Wlt.parseWithStatement=function(t){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),t.object=this.parseParenExpression(),t.body=this.parseStatement("with"),this.finishNode(t,"WithStatement")},Wlt.parseEmptyStatement=function(t){return this.next(),this.finishNode(t,"EmptyStatement")},Wlt.parseLabeledStatement=function(t,e,n,r){for(var i=0,o=this.labels;i<o.length;i+=1){o[i].name===e&&this.raise(n.start,"Label '"+e+"' is already declared")}for(var a=this.type.isLoop?"loop":this.type===_lt._switch?"switch":null,s=this.labels.length-1;s>=0;s--){var u=this.labels[s];if(u.statementStart!==t.start)break;u.statementStart=this.start,u.kind=a}return this.labels.push({name:e,kind:a,statementStart:this.start}),t.body=this.parseStatement(r?-1===r.indexOf("label")?r+"label":r:"label"),this.labels.pop(),t.label=n,this.finishNode(t,"LabeledStatement")},Wlt.parseExpressionStatement=function(t,e){return t.expression=e,this.semicolon(),this.finishNode(t,"ExpressionStatement")},Wlt.parseBlock=function(t,e,n){for(void 0===t&&(t=!0),void 0===e&&(e=this.startNode()),e.body=[],this.expect(_lt.braceL),t&&this.enterScope(0);this.type!==_lt.braceR;){var r=this.parseStatement(null);e.body.push(r)}return n&&(this.strict=!1),this.next(),t&&this.exitScope(),this.finishNode(e,"BlockStatement")},Wlt.parseFor=function(t,e){return t.init=e,this.expect(_lt.semi),t.test=this.type===_lt.semi?null:this.parseExpression(),this.expect(_lt.semi),t.update=this.type===_lt.parenR?null:this.parseExpression(),this.expect(_lt.parenR),t.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(t,"ForStatement")},Wlt.parseForIn=function(t,e){var n=this.type===_lt._in;return this.next(),"VariableDeclaration"===e.type&&null!=e.declarations[0].init&&(!n||this.options.ecmaVersion<8||this.strict||"var"!==e.kind||"Identifier"!==e.declarations[0].id.type)?this.raise(e.start,(n?"for-in":"for-of")+" loop variable declaration may not have an initializer"):"AssignmentPattern"===e.type&&this.raise(e.start,"Invalid left-hand side in for-loop"),t.left=e,t.right=n?this.parseExpression():this.parseMaybeAssign(),this.expect(_lt.parenR),t.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(t,n?"ForInStatement":"ForOfStatement")},Wlt.parseVar=function(t,e,n){for(t.declarations=[],t.kind=n;;){var r=this.startNode();if(this.parseVarId(r,n),this.eat(_lt.eq)?r.init=this.parseMaybeAssign(e):"const"!==n||this.type===_lt._in||this.options.ecmaVersion>=6&&this.isContextual("of")?"Identifier"===r.id.type||e&&(this.type===_lt._in||this.isContextual("of"))?r.init=null:this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):this.unexpected(),t.declarations.push(this.finishNode(r,"VariableDeclarator")),!this.eat(_lt.comma))break}return t},Wlt.parseVarId=function(t,e){t.id=this.parseBindingAtom(),this.checkLVal(t.id,"var"===e?1:2,!1)};var qlt=1,Zlt=2;Wlt.parseFunction=function(t,e,n,r){this.initFunction(t),(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!r)&&(this.type===_lt.star&&e&Zlt&&this.unexpected(),t.generator=this.eat(_lt.star)),this.options.ecmaVersion>=8&&(t.async=!!r),e&qlt&&(t.id=4&e&&this.type!==_lt.name?null:this.parseIdent(),!t.id||e&Zlt||this.checkLVal(t.id,this.strict||t.generator||t.async?this.treatFunctionsAsVar?1:2:3));var i=this.yieldPos,o=this.awaitPos,a=this.awaitIdentPos;return this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(jlt(t.async,t.generator)),e&qlt||(t.id=this.type===_lt.name?this.parseIdent():null),this.parseFunctionParams(t),this.parseFunctionBody(t,n,!1),this.yieldPos=i,this.awaitPos=o,this.awaitIdentPos=a,this.finishNode(t,e&qlt?"FunctionDeclaration":"FunctionExpression")},Wlt.parseFunctionParams=function(t){this.expect(_lt.parenL),t.params=this.parseBindingList(_lt.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams()},Wlt.parseClass=function(t,e){this.next();var n=this.strict;this.strict=!0,this.parseClassId(t,e),this.parseClassSuper(t);var r=this.startNode(),i=!1;for(r.body=[],this.expect(_lt.braceL);this.type!==_lt.braceR;){var o=this.parseClassElement(null!==t.superClass);o&&(r.body.push(o),"MethodDefinition"===o.type&&"constructor"===o.kind&&(i&&this.raise(o.start,"Duplicate constructor in the same class"),i=!0))}return this.strict=n,this.next(),t.body=this.finishNode(r,"ClassBody"),this.finishNode(t,e?"ClassDeclaration":"ClassExpression")},Wlt.parseClassElement=function(t){var e=this;if(this.eat(_lt.semi))return null;var n=this.startNode(),r=function(t,r){void 0===r&&(r=!1);var i=e.start,o=e.startLoc;return!!e.eatContextual(t)&&(!(e.type===_lt.parenL||r&&e.canInsertSemicolon())||(n.key&&e.unexpected(),n.computed=!1,n.key=e.startNodeAt(i,o),n.key.name=t,e.finishNode(n.key,"Identifier"),!1))};n.kind="method",n.static=r("static");var i=this.eat(_lt.star),o=!1;i||(this.options.ecmaVersion>=8&&r("async",!0)?(o=!0,i=this.options.ecmaVersion>=9&&this.eat(_lt.star)):r("get")?n.kind="get":r("set")&&(n.kind="set")),n.key||this.parsePropertyName(n);var a=n.key,s=!1;return n.computed||n.static||!("Identifier"===a.type&&"constructor"===a.name||"Literal"===a.type&&"constructor"===a.value)?n.static&&"Identifier"===a.type&&"prototype"===a.name&&this.raise(a.start,"Classes may not have a static property named prototype"):("method"!==n.kind&&this.raise(a.start,"Constructor can't have get/set modifier"),i&&this.raise(a.start,"Constructor can't be a generator"),o&&this.raise(a.start,"Constructor can't be an async method"),n.kind="constructor",s=t),this.parseClassMethod(n,i,o,s),"get"===n.kind&&0!==n.value.params.length&&this.raiseRecoverable(n.value.start,"getter should have no params"),"set"===n.kind&&1!==n.value.params.length&&this.raiseRecoverable(n.value.start,"setter should have exactly one param"),"set"===n.kind&&"RestElement"===n.value.params[0].type&&this.raiseRecoverable(n.value.params[0].start,"Setter cannot use rest params"),n},Wlt.parseClassMethod=function(t,e,n,r){return t.value=this.parseMethod(e,n,r),this.finishNode(t,"MethodDefinition")},Wlt.parseClassId=function(t,e){this.type===_lt.name?(t.id=this.parseIdent(),e&&this.checkLVal(t.id,2,!1)):(!0===e&&this.unexpected(),t.id=null)},Wlt.parseClassSuper=function(t){t.superClass=this.eat(_lt._extends)?this.parseExprSubscripts():null},Wlt.parseExport=function(t,e){if(this.next(),this.eat(_lt.star))return this.options.ecmaVersion>=11&&(this.eatContextual("as")?(t.exported=this.parseIdent(!0),this.checkExport(e,t.exported.name,this.lastTokStart)):t.exported=null),this.expectContextual("from"),this.type!==_lt.string&&this.unexpected(),t.source=this.parseExprAtom(),this.semicolon(),this.finishNode(t,"ExportAllDeclaration");if(this.eat(_lt._default)){var n;if(this.checkExport(e,"default",this.lastTokStart),this.type===_lt._function||(n=this.isAsyncFunction())){var r=this.startNode();this.next(),n&&this.next(),t.declaration=this.parseFunction(r,4|qlt,!1,n)}else if(this.type===_lt._class){var i=this.startNode();t.declaration=this.parseClass(i,"nullableID")}else t.declaration=this.parseMaybeAssign(),this.semicolon();return this.finishNode(t,"ExportDefaultDeclaration")}if(this.shouldParseExportStatement())t.declaration=this.parseStatement(null),"VariableDeclaration"===t.declaration.type?this.checkVariableExport(e,t.declaration.declarations):this.checkExport(e,t.declaration.id.name,t.declaration.id.start),t.specifiers=[],t.source=null;else{if(t.declaration=null,t.specifiers=this.parseExportSpecifiers(e),this.eatContextual("from"))this.type!==_lt.string&&this.unexpected(),t.source=this.parseExprAtom();else{for(var o=0,a=t.specifiers;o<a.length;o+=1){var s=a[o];this.checkUnreserved(s.local),this.checkLocalExport(s.local)}t.source=null}this.semicolon()}return this.finishNode(t,"ExportNamedDeclaration")},Wlt.checkExport=function(t,e,n){t&&(klt(t,e)&&this.raiseRecoverable(n,"Duplicate export '"+e+"'"),t[e]=!0)},Wlt.checkPatternExport=function(t,e){var n=e.type;if("Identifier"===n)this.checkExport(t,e.name,e.start);else if("ObjectPattern"===n)for(var r=0,i=e.properties;r<i.length;r+=1){var o=i[r];this.checkPatternExport(t,o)}else if("ArrayPattern"===n)for(var a=0,s=e.elements;a<s.length;a+=1){var u=s[a];u&&this.checkPatternExport(t,u)}else"Property"===n?this.checkPatternExport(t,e.value):"AssignmentPattern"===n?this.checkPatternExport(t,e.left):"RestElement"===n?this.checkPatternExport(t,e.argument):"ParenthesizedExpression"===n&&this.checkPatternExport(t,e.expression)},Wlt.checkVariableExport=function(t,e){if(t)for(var n=0,r=e;n<r.length;n+=1){var i=r[n];this.checkPatternExport(t,i.id)}},Wlt.shouldParseExportStatement=function(){return"var"===this.type.keyword||"const"===this.type.keyword||"class"===this.type.keyword||"function"===this.type.keyword||this.isLet()||this.isAsyncFunction()},Wlt.parseExportSpecifiers=function(t){var e=[],n=!0;for(this.expect(_lt.braceL);!this.eat(_lt.braceR);){if(n)n=!1;else if(this.expect(_lt.comma),this.afterTrailingComma(_lt.braceR))break;var r=this.startNode();r.local=this.parseIdent(!0),r.exported=this.eatContextual("as")?this.parseIdent(!0):r.local,this.checkExport(t,r.exported.name,r.exported.start),e.push(this.finishNode(r,"ExportSpecifier"))}return e},Wlt.parseImport=function(t){return this.next(),this.type===_lt.string?(t.specifiers=Xlt,t.source=this.parseExprAtom()):(t.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),t.source=this.type===_lt.string?this.parseExprAtom():this.unexpected()),this.semicolon(),this.finishNode(t,"ImportDeclaration")},Wlt.parseImportSpecifiers=function(){var t=[],e=!0;if(this.type===_lt.name){var n=this.startNode();if(n.local=this.parseIdent(),this.checkLVal(n.local,2),t.push(this.finishNode(n,"ImportDefaultSpecifier")),!this.eat(_lt.comma))return t}if(this.type===_lt.star){var r=this.startNode();return this.next(),this.expectContextual("as"),r.local=this.parseIdent(),this.checkLVal(r.local,2),t.push(this.finishNode(r,"ImportNamespaceSpecifier")),t}for(this.expect(_lt.braceL);!this.eat(_lt.braceR);){if(e)e=!1;else if(this.expect(_lt.comma),this.afterTrailingComma(_lt.braceR))break;var i=this.startNode();i.imported=this.parseIdent(!0),this.eatContextual("as")?i.local=this.parseIdent():(this.checkUnreserved(i.imported),i.local=i.imported),this.checkLVal(i.local,2),t.push(this.finishNode(i,"ImportSpecifier"))}return t},Wlt.adaptDirectivePrologue=function(t){for(var e=0;e<t.length&&this.isDirectiveCandidate(t[e]);++e)t[e].directive=t[e].expression.raw.slice(1,-1)},Wlt.isDirectiveCandidate=function(t){return"ExpressionStatement"===t.type&&"Literal"===t.expression.type&&"string"==typeof t.expression.value&&('"'===this.input[t.start]||"'"===this.input[t.start])};var $lt=Blt.prototype;$lt.toAssignable=function(t,e,n){if(this.options.ecmaVersion>=6&&t)switch(t.type){case"Identifier":this.inAsync&&"await"===t.name&&this.raise(t.start,"Cannot use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"RestElement":break;case"ObjectExpression":t.type="ObjectPattern",n&&this.checkPatternErrors(n,!0);for(var r=0,i=t.properties;r<i.length;r+=1){var o=i[r];this.toAssignable(o,e),"RestElement"!==o.type||"ArrayPattern"!==o.argument.type&&"ObjectPattern"!==o.argument.type||this.raise(o.argument.start,"Unexpected token")}break;case"Property":"init"!==t.kind&&this.raise(t.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(t.value,e);break;case"ArrayExpression":t.type="ArrayPattern",n&&this.checkPatternErrors(n,!0),this.toAssignableList(t.elements,e);break;case"SpreadElement":t.type="RestElement",this.toAssignable(t.argument,e),"AssignmentPattern"===t.argument.type&&this.raise(t.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":"="!==t.operator&&this.raise(t.left.end,"Only '=' operator can be used for specifying default value."),t.type="AssignmentPattern",delete t.operator,this.toAssignable(t.left,e);case"AssignmentPattern":break;case"ParenthesizedExpression":this.toAssignable(t.expression,e,n);break;case"ChainExpression":this.raiseRecoverable(t.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":if(!e)break;default:this.raise(t.start,"Assigning to rvalue")}else n&&this.checkPatternErrors(n,!0);return t},$lt.toAssignableList=function(t,e){for(var n=t.length,r=0;r<n;r++){var i=t[r];i&&this.toAssignable(i,e)}if(n){var o=t[n-1];6===this.options.ecmaVersion&&e&&o&&"RestElement"===o.type&&"Identifier"!==o.argument.type&&this.unexpected(o.argument.start)}return t},$lt.parseSpread=function(t){var e=this.startNode();return this.next(),e.argument=this.parseMaybeAssign(!1,t),this.finishNode(e,"SpreadElement")},$lt.parseRestBinding=function(){var t=this.startNode();return this.next(),6===this.options.ecmaVersion&&this.type!==_lt.name&&this.unexpected(),t.argument=this.parseBindingAtom(),this.finishNode(t,"RestElement")},$lt.parseBindingAtom=function(){if(this.options.ecmaVersion>=6)switch(this.type){case _lt.bracketL:var t=this.startNode();return this.next(),t.elements=this.parseBindingList(_lt.bracketR,!0,!0),this.finishNode(t,"ArrayPattern");case _lt.braceL:return this.parseObj(!0)}return this.parseIdent()},$lt.parseBindingList=function(t,e,n){for(var r=[],i=!0;!this.eat(t);)if(i?i=!1:this.expect(_lt.comma),e&&this.type===_lt.comma)r.push(null);else{if(n&&this.afterTrailingComma(t))break;if(this.type===_lt.ellipsis){var o=this.parseRestBinding();this.parseBindingListItem(o),r.push(o),this.type===_lt.comma&&this.raise(this.start,"Comma is not permitted after the rest element"),this.expect(t);break}var a=this.parseMaybeDefault(this.start,this.startLoc);this.parseBindingListItem(a),r.push(a)}return r},$lt.parseBindingListItem=function(t){return t},$lt.parseMaybeDefault=function(t,e,n){if(n=n||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(_lt.eq))return n;var r=this.startNodeAt(t,e);return r.left=n,r.right=this.parseMaybeAssign(),this.finishNode(r,"AssignmentPattern")},$lt.checkLVal=function(t,e,n){switch(void 0===e&&(e=0),t.type){case"Identifier":2===e&&"let"===t.name&&this.raiseRecoverable(t.start,"let is disallowed as a lexically bound name"),this.strict&&this.reservedWordsStrictBind.test(t.name)&&this.raiseRecoverable(t.start,(e?"Binding ":"Assigning to ")+t.name+" in strict mode"),n&&(klt(n,t.name)&&this.raiseRecoverable(t.start,"Argument name clash"),n[t.name]=!0),0!==e&&5!==e&&this.declareName(t.name,e,t.start);break;case"ChainExpression":this.raiseRecoverable(t.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":e&&this.raiseRecoverable(t.start,"Binding member expression");break;case"ObjectPattern":for(var r=0,i=t.properties;r<i.length;r+=1){var o=i[r];this.checkLVal(o,e,n)}break;case"Property":this.checkLVal(t.value,e,n);break;case"ArrayPattern":for(var a=0,s=t.elements;a<s.length;a+=1){var u=s[a];u&&this.checkLVal(u,e,n)}break;case"AssignmentPattern":this.checkLVal(t.left,e,n);break;case"RestElement":this.checkLVal(t.argument,e,n);break;case"ParenthesizedExpression":this.checkLVal(t.expression,e,n);break;default:this.raise(t.start,(e?"Binding":"Assigning to")+" rvalue")}};var Klt=Blt.prototype;Klt.checkPropClash=function(t,e,n){if(!(this.options.ecmaVersion>=9&&"SpreadElement"===t.type||this.options.ecmaVersion>=6&&(t.computed||t.method||t.shorthand))){var r,i=t.key;switch(i.type){case"Identifier":r=i.name;break;case"Literal":r=String(i.value);break;default:return}var o=t.kind;if(this.options.ecmaVersion>=6)"__proto__"===r&&"init"===o&&(e.proto&&(n?n.doubleProto<0&&(n.doubleProto=i.start):this.raiseRecoverable(i.start,"Redefinition of __proto__ property")),e.proto=!0);else{var a=e[r="$"+r];if(a)("init"===o?this.strict&&a.init||a.get||a.set:a.init||a[o])&&this.raiseRecoverable(i.start,"Redefinition of property");else a=e[r]={init:!1,get:!1,set:!1};a[o]=!0}}},Klt.parseExpression=function(t,e){var n=this.start,r=this.startLoc,i=this.parseMaybeAssign(t,e);if(this.type===_lt.comma){var o=this.startNodeAt(n,r);for(o.expressions=[i];this.eat(_lt.comma);)o.expressions.push(this.parseMaybeAssign(t,e));return this.finishNode(o,"SequenceExpression")}return i},Klt.parseMaybeAssign=function(t,e,n){if(this.isContextual("yield")){if(this.inGenerator)return this.parseYield(t);this.exprAllowed=!1}var r=!1,i=-1,o=-1;e?(i=e.parenthesizedAssign,o=e.trailingComma,e.parenthesizedAssign=e.trailingComma=-1):(e=new Glt,r=!0);var a=this.start,s=this.startLoc;this.type!==_lt.parenL&&this.type!==_lt.name||(this.potentialArrowAt=this.start);var u=this.parseMaybeConditional(t,e);if(n&&(u=n.call(this,u,a,s)),this.type.isAssign){var c=this.startNodeAt(a,s);return c.operator=this.value,c.left=this.type===_lt.eq?this.toAssignable(u,!1,e):u,r||(e.parenthesizedAssign=e.trailingComma=e.doubleProto=-1),e.shorthandAssign>=c.left.start&&(e.shorthandAssign=-1),this.checkLVal(u),this.next(),c.right=this.parseMaybeAssign(t),this.finishNode(c,"AssignmentExpression")}return r&&this.checkExpressionErrors(e,!0),i>-1&&(e.parenthesizedAssign=i),o>-1&&(e.trailingComma=o),u},Klt.parseMaybeConditional=function(t,e){var n=this.start,r=this.startLoc,i=this.parseExprOps(t,e);if(this.checkExpressionErrors(e))return i;if(this.eat(_lt.question)){var o=this.startNodeAt(n,r);return o.test=i,o.consequent=this.parseMaybeAssign(),this.expect(_lt.colon),o.alternate=this.parseMaybeAssign(t),this.finishNode(o,"ConditionalExpression")}return i},Klt.parseExprOps=function(t,e){var n=this.start,r=this.startLoc,i=this.parseMaybeUnary(e,!1);return this.checkExpressionErrors(e)||i.start===n&&"ArrowFunctionExpression"===i.type?i:this.parseExprOp(i,n,r,-1,t)},Klt.parseExprOp=function(t,e,n,r,i){var o=this.type.binop;if(null!=o&&(!i||this.type!==_lt._in)&&o>r){var a=this.type===_lt.logicalOR||this.type===_lt.logicalAND,s=this.type===_lt.coalesce;s&&(o=_lt.logicalAND.binop);var u=this.value;this.next();var c=this.start,l=this.startLoc,h=this.parseExprOp(this.parseMaybeUnary(null,!1),c,l,o,i),f=this.buildBinary(e,n,t,h,u,a||s);return(a&&this.type===_lt.coalesce||s&&(this.type===_lt.logicalOR||this.type===_lt.logicalAND))&&this.raiseRecoverable(this.start,"Logical expressions and coalesce expressions cannot be mixed. Wrap either by parentheses"),this.parseExprOp(f,e,n,r,i)}return t},Klt.buildBinary=function(t,e,n,r,i,o){var a=this.startNodeAt(t,e);return a.left=n,a.operator=i,a.right=r,this.finishNode(a,o?"LogicalExpression":"BinaryExpression")},Klt.parseMaybeUnary=function(t,e){var n,r=this.start,i=this.startLoc;if(this.isContextual("await")&&(this.inAsync||!this.inFunction&&this.options.allowAwaitOutsideFunction))n=this.parseAwait(),e=!0;else if(this.type.prefix){var o=this.startNode(),a=this.type===_lt.incDec;o.operator=this.value,o.prefix=!0,this.next(),o.argument=this.parseMaybeUnary(null,!0),this.checkExpressionErrors(t,!0),a?this.checkLVal(o.argument):this.strict&&"delete"===o.operator&&"Identifier"===o.argument.type?this.raiseRecoverable(o.start,"Deleting local variable in strict mode"):e=!0,n=this.finishNode(o,a?"UpdateExpression":"UnaryExpression")}else{if(n=this.parseExprSubscripts(t),this.checkExpressionErrors(t))return n;for(;this.type.postfix&&!this.canInsertSemicolon();){var s=this.startNodeAt(r,i);s.operator=this.value,s.prefix=!1,s.argument=n,this.checkLVal(n),this.next(),n=this.finishNode(s,"UpdateExpression")}}return!e&&this.eat(_lt.starstar)?this.buildBinary(r,i,n,this.parseMaybeUnary(null,!1),"**",!1):n},Klt.parseExprSubscripts=function(t){var e=this.start,n=this.startLoc,r=this.parseExprAtom(t);if("ArrowFunctionExpression"===r.type&&")"!==this.input.slice(this.lastTokStart,this.lastTokEnd))return r;var i=this.parseSubscripts(r,e,n);return t&&"MemberExpression"===i.type&&(t.parenthesizedAssign>=i.start&&(t.parenthesizedAssign=-1),t.parenthesizedBind>=i.start&&(t.parenthesizedBind=-1)),i},Klt.parseSubscripts=function(t,e,n,r){for(var i=this.options.ecmaVersion>=8&&"Identifier"===t.type&&"async"===t.name&&this.lastTokEnd===t.end&&!this.canInsertSemicolon()&&t.end-t.start==5&&this.potentialArrowAt===t.start,o=!1;;){var a=this.parseSubscript(t,e,n,r,i,o);if(a.optional&&(o=!0),a===t||"ArrowFunctionExpression"===a.type){if(o){var s=this.startNodeAt(e,n);s.expression=a,a=this.finishNode(s,"ChainExpression")}return a}t=a}},Klt.parseSubscript=function(t,e,n,r,i,o){var a=this.options.ecmaVersion>=11,s=a&&this.eat(_lt.questionDot);r&&s&&this.raise(this.lastTokStart,"Optional chaining cannot appear in the callee of new expressions");var u=this.eat(_lt.bracketL);if(u||s&&this.type!==_lt.parenL&&this.type!==_lt.backQuote||this.eat(_lt.dot)){var c=this.startNodeAt(e,n);c.object=t,c.property=u?this.parseExpression():this.parseIdent("never"!==this.options.allowReserved),c.computed=!!u,u&&this.expect(_lt.bracketR),a&&(c.optional=s),t=this.finishNode(c,"MemberExpression")}else if(!r&&this.eat(_lt.parenL)){var l=new Glt,h=this.yieldPos,f=this.awaitPos,p=this.awaitIdentPos;this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0;var d=this.parseExprList(_lt.parenR,this.options.ecmaVersion>=8,!1,l);if(i&&!s&&!this.canInsertSemicolon()&&this.eat(_lt.arrow))return this.checkPatternErrors(l,!1),this.checkYieldAwaitInDefaultParams(),this.awaitIdentPos>0&&this.raise(this.awaitIdentPos,"Cannot use 'await' as identifier inside an async function"),this.yieldPos=h,this.awaitPos=f,this.awaitIdentPos=p,this.parseArrowExpression(this.startNodeAt(e,n),d,!0);this.checkExpressionErrors(l,!0),this.yieldPos=h||this.yieldPos,this.awaitPos=f||this.awaitPos,this.awaitIdentPos=p||this.awaitIdentPos;var m=this.startNodeAt(e,n);m.callee=t,m.arguments=d,a&&(m.optional=s),t=this.finishNode(m,"CallExpression")}else if(this.type===_lt.backQuote){(s||o)&&this.raise(this.start,"Optional chaining cannot appear in the tag of tagged template expressions");var v=this.startNodeAt(e,n);v.tag=t,v.quasi=this.parseTemplate({isTagged:!0}),t=this.finishNode(v,"TaggedTemplateExpression")}return t},Klt.parseExprAtom=function(t){this.type===_lt.slash&&this.readRegexp();var e,n=this.potentialArrowAt===this.start;switch(this.type){case _lt._super:return this.allowSuper||this.raise(this.start,"'super' keyword outside a method"),e=this.startNode(),this.next(),this.type!==_lt.parenL||this.allowDirectSuper||this.raise(e.start,"super() call outside constructor of a subclass"),this.type!==_lt.dot&&this.type!==_lt.bracketL&&this.type!==_lt.parenL&&this.unexpected(),this.finishNode(e,"Super");case _lt._this:return e=this.startNode(),this.next(),this.finishNode(e,"ThisExpression");case _lt.name:var r=this.start,i=this.startLoc,o=this.containsEsc,a=this.parseIdent(!1);if(this.options.ecmaVersion>=8&&!o&&"async"===a.name&&!this.canInsertSemicolon()&&this.eat(_lt._function))return this.parseFunction(this.startNodeAt(r,i),0,!1,!0);if(n&&!this.canInsertSemicolon()){if(this.eat(_lt.arrow))return this.parseArrowExpression(this.startNodeAt(r,i),[a],!1);if(this.options.ecmaVersion>=8&&"async"===a.name&&this.type===_lt.name&&!o)return a=this.parseIdent(!1),!this.canInsertSemicolon()&&this.eat(_lt.arrow)||this.unexpected(),this.parseArrowExpression(this.startNodeAt(r,i),[a],!0)}return a;case _lt.regexp:var s=this.value;return(e=this.parseLiteral(s.value)).regex={pattern:s.pattern,flags:s.flags},e;case _lt.num:case _lt.string:return this.parseLiteral(this.value);case _lt._null:case _lt._true:case _lt._false:return(e=this.startNode()).value=this.type===_lt._null?null:this.type===_lt._true,e.raw=this.type.keyword,this.next(),this.finishNode(e,"Literal");case _lt.parenL:var u=this.start,c=this.parseParenAndDistinguishExpression(n);return t&&(t.parenthesizedAssign<0&&!this.isSimpleAssignTarget(c)&&(t.parenthesizedAssign=u),t.parenthesizedBind<0&&(t.parenthesizedBind=u)),c;case _lt.bracketL:return e=this.startNode(),this.next(),e.elements=this.parseExprList(_lt.bracketR,!0,!0,t),this.finishNode(e,"ArrayExpression");case _lt.braceL:return this.parseObj(!1,t);case _lt._function:return e=this.startNode(),this.next(),this.parseFunction(e,0);case _lt._class:return this.parseClass(this.startNode(),!1);case _lt._new:return this.parseNew();case _lt.backQuote:return this.parseTemplate();case _lt._import:return this.options.ecmaVersion>=11?this.parseExprImport():this.unexpected();default:this.unexpected()}},Klt.parseExprImport=function(){var t=this.startNode();this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword import");var e=this.parseIdent(!0);switch(this.type){case _lt.parenL:return this.parseDynamicImport(t);case _lt.dot:return t.meta=e,this.parseImportMeta(t);default:this.unexpected()}},Klt.parseDynamicImport=function(t){if(this.next(),t.source=this.parseMaybeAssign(),!this.eat(_lt.parenR)){var e=this.start;this.eat(_lt.comma)&&this.eat(_lt.parenR)?this.raiseRecoverable(e,"Trailing comma is not allowed in import()"):this.unexpected(e)}return this.finishNode(t,"ImportExpression")},Klt.parseImportMeta=function(t){this.next();var e=this.containsEsc;return t.property=this.parseIdent(!0),"meta"!==t.property.name&&this.raiseRecoverable(t.property.start,"The only valid meta property for import is 'import.meta'"),e&&this.raiseRecoverable(t.start,"'import.meta' must not contain escaped characters"),"module"!==this.options.sourceType&&this.raiseRecoverable(t.start,"Cannot use 'import.meta' outside a module"),this.finishNode(t,"MetaProperty")},Klt.parseLiteral=function(t){var e=this.startNode();return e.value=t,e.raw=this.input.slice(this.start,this.end),110===e.raw.charCodeAt(e.raw.length-1)&&(e.bigint=e.raw.slice(0,-1).replace(/_/g,"")),this.next(),this.finishNode(e,"Literal")},Klt.parseParenExpression=function(){this.expect(_lt.parenL);var t=this.parseExpression();return this.expect(_lt.parenR),t},Klt.parseParenAndDistinguishExpression=function(t){var e,n=this.start,r=this.startLoc,i=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var o,a=this.start,s=this.startLoc,u=[],c=!0,l=!1,h=new Glt,f=this.yieldPos,p=this.awaitPos;for(this.yieldPos=0,this.awaitPos=0;this.type!==_lt.parenR;){if(c?c=!1:this.expect(_lt.comma),i&&this.afterTrailingComma(_lt.parenR,!0)){l=!0;break}if(this.type===_lt.ellipsis){o=this.start,u.push(this.parseParenItem(this.parseRestBinding())),this.type===_lt.comma&&this.raise(this.start,"Comma is not permitted after the rest element");break}u.push(this.parseMaybeAssign(!1,h,this.parseParenItem))}var d=this.start,m=this.startLoc;if(this.expect(_lt.parenR),t&&!this.canInsertSemicolon()&&this.eat(_lt.arrow))return this.checkPatternErrors(h,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=f,this.awaitPos=p,this.parseParenArrowList(n,r,u);u.length&&!l||this.unexpected(this.lastTokStart),o&&this.unexpected(o),this.checkExpressionErrors(h,!0),this.yieldPos=f||this.yieldPos,this.awaitPos=p||this.awaitPos,u.length>1?((e=this.startNodeAt(a,s)).expressions=u,this.finishNodeAt(e,"SequenceExpression",d,m)):e=u[0]}else e=this.parseParenExpression();if(this.options.preserveParens){var v=this.startNodeAt(n,r);return v.expression=e,this.finishNode(v,"ParenthesizedExpression")}return e},Klt.parseParenItem=function(t){return t},Klt.parseParenArrowList=function(t,e,n){return this.parseArrowExpression(this.startNodeAt(t,e),n)};var Jlt=[];Klt.parseNew=function(){this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword new");var t=this.startNode(),e=this.parseIdent(!0);if(this.options.ecmaVersion>=6&&this.eat(_lt.dot)){t.meta=e;var n=this.containsEsc;return t.property=this.parseIdent(!0),"target"!==t.property.name&&this.raiseRecoverable(t.property.start,"The only valid meta property for new is 'new.target'"),n&&this.raiseRecoverable(t.start,"'new.target' must not contain escaped characters"),this.inNonArrowFunction()||this.raiseRecoverable(t.start,"'new.target' can only be used in functions"),this.finishNode(t,"MetaProperty")}var r=this.start,i=this.startLoc,o=this.type===_lt._import;return t.callee=this.parseSubscripts(this.parseExprAtom(),r,i,!0),o&&"ImportExpression"===t.callee.type&&this.raise(r,"Cannot use new with import()"),this.eat(_lt.parenL)?t.arguments=this.parseExprList(_lt.parenR,this.options.ecmaVersion>=8,!1):t.arguments=Jlt,this.finishNode(t,"NewExpression")},Klt.parseTemplateElement=function(t){var e=t.isTagged,n=this.startNode();return this.type===_lt.invalidTemplate?(e||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),n.value={raw:this.value,cooked:null}):n.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,"\n"),cooked:this.value},this.next(),n.tail=this.type===_lt.backQuote,this.finishNode(n,"TemplateElement")},Klt.parseTemplate=function(t){void 0===t&&(t={});var e=t.isTagged;void 0===e&&(e=!1);var n=this.startNode();this.next(),n.expressions=[];var r=this.parseTemplateElement({isTagged:e});for(n.quasis=[r];!r.tail;)this.type===_lt.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect(_lt.dollarBraceL),n.expressions.push(this.parseExpression()),this.expect(_lt.braceR),n.quasis.push(r=this.parseTemplateElement({isTagged:e}));return this.next(),this.finishNode(n,"TemplateLiteral")},Klt.isAsyncProp=function(t){return!t.computed&&"Identifier"===t.key.type&&"async"===t.key.name&&(this.type===_lt.name||this.type===_lt.num||this.type===_lt.string||this.type===_lt.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===_lt.star)&&!wlt.test(this.input.slice(this.lastTokEnd,this.start))},Klt.parseObj=function(t,e){var n=this.startNode(),r=!0,i={};for(n.properties=[],this.next();!this.eat(_lt.braceR);){if(r)r=!1;else if(this.expect(_lt.comma),this.options.ecmaVersion>=5&&this.afterTrailingComma(_lt.braceR))break;var o=this.parseProperty(t,e);t||this.checkPropClash(o,i,e),n.properties.push(o)}return this.finishNode(n,t?"ObjectPattern":"ObjectExpression")},Klt.parseProperty=function(t,e){var n,r,i,o,a=this.startNode();if(this.options.ecmaVersion>=9&&this.eat(_lt.ellipsis))return t?(a.argument=this.parseIdent(!1),this.type===_lt.comma&&this.raise(this.start,"Comma is not permitted after the rest element"),this.finishNode(a,"RestElement")):(this.type===_lt.parenL&&e&&(e.parenthesizedAssign<0&&(e.parenthesizedAssign=this.start),e.parenthesizedBind<0&&(e.parenthesizedBind=this.start)),a.argument=this.parseMaybeAssign(!1,e),this.type===_lt.comma&&e&&e.trailingComma<0&&(e.trailingComma=this.start),this.finishNode(a,"SpreadElement"));this.options.ecmaVersion>=6&&(a.method=!1,a.shorthand=!1,(t||e)&&(i=this.start,o=this.startLoc),t||(n=this.eat(_lt.star)));var s=this.containsEsc;return this.parsePropertyName(a),!t&&!s&&this.options.ecmaVersion>=8&&!n&&this.isAsyncProp(a)?(r=!0,n=this.options.ecmaVersion>=9&&this.eat(_lt.star),this.parsePropertyName(a,e)):r=!1,this.parsePropertyValue(a,t,n,r,i,o,e,s),this.finishNode(a,"Property")},Klt.parsePropertyValue=function(t,e,n,r,i,o,a,s){if((n||r)&&this.type===_lt.colon&&this.unexpected(),this.eat(_lt.colon))t.value=e?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,a),t.kind="init";else if(this.options.ecmaVersion>=6&&this.type===_lt.parenL)e&&this.unexpected(),t.kind="init",t.method=!0,t.value=this.parseMethod(n,r);else if(e||s||!(this.options.ecmaVersion>=5)||t.computed||"Identifier"!==t.key.type||"get"!==t.key.name&&"set"!==t.key.name||this.type===_lt.comma||this.type===_lt.braceR||this.type===_lt.eq)this.options.ecmaVersion>=6&&!t.computed&&"Identifier"===t.key.type?((n||r)&&this.unexpected(),this.checkUnreserved(t.key),"await"!==t.key.name||this.awaitIdentPos||(this.awaitIdentPos=i),t.kind="init",e?t.value=this.parseMaybeDefault(i,o,t.key):this.type===_lt.eq&&a?(a.shorthandAssign<0&&(a.shorthandAssign=this.start),t.value=this.parseMaybeDefault(i,o,t.key)):t.value=t.key,t.shorthand=!0):this.unexpected();else{(n||r)&&this.unexpected(),t.kind=t.key.name,this.parsePropertyName(t),t.value=this.parseMethod(!1);var u="get"===t.kind?0:1;if(t.value.params.length!==u){var c=t.value.start;"get"===t.kind?this.raiseRecoverable(c,"getter should have no params"):this.raiseRecoverable(c,"setter should have exactly one param")}else"set"===t.kind&&"RestElement"===t.value.params[0].type&&this.raiseRecoverable(t.value.params[0].start,"Setter cannot use rest params")}},Klt.parsePropertyName=function(t){if(this.options.ecmaVersion>=6){if(this.eat(_lt.bracketL))return t.computed=!0,t.key=this.parseMaybeAssign(),this.expect(_lt.bracketR),t.key;t.computed=!1}return t.key=this.type===_lt.num||this.type===_lt.string?this.parseExprAtom():this.parseIdent("never"!==this.options.allowReserved)},Klt.initFunction=function(t){t.id=null,this.options.ecmaVersion>=6&&(t.generator=t.expression=!1),this.options.ecmaVersion>=8&&(t.async=!1)},Klt.parseMethod=function(t,e,n){var r=this.startNode(),i=this.yieldPos,o=this.awaitPos,a=this.awaitIdentPos;return this.initFunction(r),this.options.ecmaVersion>=6&&(r.generator=t),this.options.ecmaVersion>=8&&(r.async=!!e),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(64|jlt(e,r.generator)|(n?128:0)),this.expect(_lt.parenL),r.params=this.parseBindingList(_lt.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(r,!1,!0),this.yieldPos=i,this.awaitPos=o,this.awaitIdentPos=a,this.finishNode(r,"FunctionExpression")},Klt.parseArrowExpression=function(t,e,n){var r=this.yieldPos,i=this.awaitPos,o=this.awaitIdentPos;return this.enterScope(16|jlt(n,!1)),this.initFunction(t),this.options.ecmaVersion>=8&&(t.async=!!n),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,t.params=this.toAssignableList(e,!0),this.parseFunctionBody(t,!0,!1),this.yieldPos=r,this.awaitPos=i,this.awaitIdentPos=o,this.finishNode(t,"ArrowFunctionExpression")},Klt.parseFunctionBody=function(t,e,n){var r=e&&this.type!==_lt.braceL,i=this.strict,o=!1;if(r)t.body=this.parseMaybeAssign(),t.expression=!0,this.checkParams(t,!1);else{var a=this.options.ecmaVersion>=7&&!this.isSimpleParamList(t.params);i&&!a||(o=this.strictDirective(this.end))&&a&&this.raiseRecoverable(t.start,"Illegal 'use strict' directive in function with non-simple parameter list");var s=this.labels;this.labels=[],o&&(this.strict=!0),this.checkParams(t,!i&&!o&&!e&&!n&&this.isSimpleParamList(t.params)),this.strict&&t.id&&this.checkLVal(t.id,5),t.body=this.parseBlock(!1,void 0,o&&!i),t.expression=!1,this.adaptDirectivePrologue(t.body.body),this.labels=s}this.exitScope()},Klt.isSimpleParamList=function(t){for(var e=0,n=t;e<n.length;e+=1){if("Identifier"!==n[e].type)return!1}return!0},Klt.checkParams=function(t,e){for(var n={},r=0,i=t.params;r<i.length;r+=1){var o=i[r];this.checkLVal(o,1,e?null:n)}},Klt.parseExprList=function(t,e,n,r){for(var i=[],o=!0;!this.eat(t);){if(o)o=!1;else if(this.expect(_lt.comma),e&&this.afterTrailingComma(t))break;var a=void 0;n&&this.type===_lt.comma?a=null:this.type===_lt.ellipsis?(a=this.parseSpread(r),r&&this.type===_lt.comma&&r.trailingComma<0&&(r.trailingComma=this.start)):a=this.parseMaybeAssign(!1,r),i.push(a)}return i},Klt.checkUnreserved=function(t){var e=t.start,n=t.end,r=t.name;(this.inGenerator&&"yield"===r&&this.raiseRecoverable(e,"Cannot use 'yield' as identifier inside a generator"),this.inAsync&&"await"===r&&this.raiseRecoverable(e,"Cannot use 'await' as identifier inside an async function"),this.keywords.test(r)&&this.raise(e,"Unexpected keyword '"+r+"'"),this.options.ecmaVersion<6&&-1!==this.input.slice(e,n).indexOf("\\"))||(this.strict?this.reservedWordsStrict:this.reservedWords).test(r)&&(this.inAsync||"await"!==r||this.raiseRecoverable(e,"Cannot use keyword 'await' outside an async function"),this.raiseRecoverable(e,"The keyword '"+r+"' is reserved"))},Klt.parseIdent=function(t,e){var n=this.startNode();return this.type===_lt.name?n.name=this.value:this.type.keyword?(n.name=this.type.keyword,"class"!==n.name&&"function"!==n.name||this.lastTokEnd===this.lastTokStart+1&&46===this.input.charCodeAt(this.lastTokStart)||this.context.pop()):this.unexpected(),this.next(!!t),this.finishNode(n,"Identifier"),t||(this.checkUnreserved(n),"await"!==n.name||this.awaitIdentPos||(this.awaitIdentPos=n.start)),n},Klt.parseYield=function(t){this.yieldPos||(this.yieldPos=this.start);var e=this.startNode();return this.next(),this.type===_lt.semi||this.canInsertSemicolon()||this.type!==_lt.star&&!this.type.startsExpr?(e.delegate=!1,e.argument=null):(e.delegate=this.eat(_lt.star),e.argument=this.parseMaybeAssign(t)),this.finishNode(e,"YieldExpression")},Klt.parseAwait=function(){this.awaitPos||(this.awaitPos=this.start);var t=this.startNode();return this.next(),t.argument=this.parseMaybeUnary(null,!1),this.finishNode(t,"AwaitExpression")};var Qlt=Blt.prototype;Qlt.raise=function(t,e){var n=Nlt(this.input,t);e+=" ("+n.line+":"+n.column+")";var r=new SyntaxError(e);throw r.pos=t,r.loc=n,r.raisedAt=this.pos,r},Qlt.raiseRecoverable=Qlt.raise,Qlt.curPosition=function(){if(this.options.locations)return new Rlt(this.curLine,this.pos-this.lineStart)};var tht=Blt.prototype,eht=function(t){this.flags=t,this.var=[],this.lexical=[],this.functions=[]};tht.enterScope=function(t){this.scopeStack.push(new eht(t))},tht.exitScope=function(){this.scopeStack.pop()},tht.treatFunctionsAsVarInScope=function(t){return 2&t.flags||!this.inModule&&1&t.flags},tht.declareName=function(t,e,n){var r=!1;if(2===e){var i=this.currentScope();r=i.lexical.indexOf(t)>-1||i.functions.indexOf(t)>-1||i.var.indexOf(t)>-1,i.lexical.push(t),this.inModule&&1&i.flags&&delete this.undefinedExports[t]}else if(4===e){this.currentScope().lexical.push(t)}else if(3===e){var o=this.currentScope();r=this.treatFunctionsAsVar?o.lexical.indexOf(t)>-1:o.lexical.indexOf(t)>-1||o.var.indexOf(t)>-1,o.functions.push(t)}else for(var a=this.scopeStack.length-1;a>=0;--a){var s=this.scopeStack[a];if(s.lexical.indexOf(t)>-1&&!(32&s.flags&&s.lexical[0]===t)||!this.treatFunctionsAsVarInScope(s)&&s.functions.indexOf(t)>-1){r=!0;break}if(s.var.push(t),this.inModule&&1&s.flags&&delete this.undefinedExports[t],3&s.flags)break}r&&this.raiseRecoverable(n,"Identifier '"+t+"' has already been declared")},tht.checkLocalExport=function(t){-1===this.scopeStack[0].lexical.indexOf(t.name)&&-1===this.scopeStack[0].var.indexOf(t.name)&&(this.undefinedExports[t.name]=t)},tht.currentScope=function(){return this.scopeStack[this.scopeStack.length-1]},tht.currentVarScope=function(){for(var t=this.scopeStack.length-1;;t--){var e=this.scopeStack[t];if(3&e.flags)return e}},tht.currentThisScope=function(){for(var t=this.scopeStack.length-1;;t--){var e=this.scopeStack[t];if(3&e.flags&&!(16&e.flags))return e}};var nht=function(t,e,n){this.type="",this.start=e,this.end=0,t.options.locations&&(this.loc=new Ilt(t,n)),t.options.directSourceFile&&(this.sourceFile=t.options.directSourceFile),t.options.ranges&&(this.range=[e,0])},rht=Blt.prototype;function iht(t,e,n,r){return t.type=e,t.end=n,this.options.locations&&(t.loc.end=r),this.options.ranges&&(t.range[1]=n),t}rht.startNode=function(){return new nht(this,this.start,this.startLoc)},rht.startNodeAt=function(t,e){return new nht(this,t,e)},rht.finishNode=function(t,e){return iht.call(this,t,e,this.lastTokEnd,this.lastTokEndLoc)},rht.finishNodeAt=function(t,e,n,r){return iht.call(this,t,e,n,r)};var oht=function(t,e,n,r,i){this.token=t,this.isExpr=!!e,this.preserveSpace=!!n,this.override=r,this.generator=!!i},aht={b_stat:new oht("{",!1),b_expr:new oht("{",!0),b_tmpl:new oht("${",!1),p_stat:new oht("(",!1),p_expr:new oht("(",!0),q_tmpl:new oht("`",!0,!0,(function(t){return t.tryReadTemplateToken()})),f_stat:new oht("function",!1),f_expr:new oht("function",!0),f_expr_gen:new oht("function",!0,!1,null,!0),f_gen:new oht("function",!1,!1,null,!0)},sht=Blt.prototype;sht.initialContext=function(){return[aht.b_stat]},sht.braceIsBlock=function(t){var e=this.curContext();return e===aht.f_expr||e===aht.f_stat||(t!==_lt.colon||e!==aht.b_stat&&e!==aht.b_expr?t===_lt._return||t===_lt.name&&this.exprAllowed?wlt.test(this.input.slice(this.lastTokEnd,this.start)):t===_lt._else||t===_lt.semi||t===_lt.eof||t===_lt.parenR||t===_lt.arrow||(t===_lt.braceL?e===aht.b_stat:t!==_lt._var&&t!==_lt._const&&t!==_lt.name&&!this.exprAllowed):!e.isExpr)},sht.inGeneratorContext=function(){for(var t=this.context.length-1;t>=1;t--){var e=this.context[t];if("function"===e.token)return e.generator}return!1},sht.updateContext=function(t){var e,n=this.type;n.keyword&&t===_lt.dot?this.exprAllowed=!1:(e=n.updateContext)?e.call(this,t):this.exprAllowed=n.beforeExpr},_lt.parenR.updateContext=_lt.braceR.updateContext=function(){if(1!==this.context.length){var t=this.context.pop();t===aht.b_stat&&"function"===this.curContext().token&&(t=this.context.pop()),this.exprAllowed=!t.isExpr}else this.exprAllowed=!0},_lt.braceL.updateContext=function(t){this.context.push(this.braceIsBlock(t)?aht.b_stat:aht.b_expr),this.exprAllowed=!0},_lt.dollarBraceL.updateContext=function(){this.context.push(aht.b_tmpl),this.exprAllowed=!0},_lt.parenL.updateContext=function(t){var e=t===_lt._if||t===_lt._for||t===_lt._with||t===_lt._while;this.context.push(e?aht.p_stat:aht.p_expr),this.exprAllowed=!0},_lt.incDec.updateContext=function(){},_lt._function.updateContext=_lt._class.updateContext=function(t){!t.beforeExpr||t===_lt.semi||t===_lt._else||t===_lt._return&&wlt.test(this.input.slice(this.lastTokEnd,this.start))||(t===_lt.colon||t===_lt.braceL)&&this.curContext()===aht.b_stat?this.context.push(aht.f_stat):this.context.push(aht.f_expr),this.exprAllowed=!1},_lt.backQuote.updateContext=function(){this.curContext()===aht.q_tmpl?this.context.pop():this.context.push(aht.q_tmpl),this.exprAllowed=!1},_lt.star.updateContext=function(t){if(t===_lt._function){var e=this.context.length-1;this.context[e]===aht.f_expr?this.context[e]=aht.f_expr_gen:this.context[e]=aht.f_gen}this.exprAllowed=!0},_lt.name.updateContext=function(t){var e=!1;this.options.ecmaVersion>=6&&t!==_lt.dot&&("of"===this.value&&!this.exprAllowed||"yield"===this.value&&this.inGeneratorContext())&&(e=!0),this.exprAllowed=e};var uht="ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS",cht=uht+" Extended_Pictographic",lht={9:uht,10:cht,11:cht},hht="Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu",fht="Adlam Adlm Ahom Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb",pht=fht+" Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd",dht={9:fht,10:pht,11:pht+" Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho"},mht={};function vht(t){var e=mht[t]={binary:Llt(lht[t]+" "+hht),nonBinary:{General_Category:Llt(hht),Script:Llt(dht[t])}};e.nonBinary.Script_Extensions=e.nonBinary.Script,e.nonBinary.gc=e.nonBinary.General_Category,e.nonBinary.sc=e.nonBinary.Script,e.nonBinary.scx=e.nonBinary.Script_Extensions}vht(9),vht(10),vht(11);var ght=Blt.prototype,yht=function(t){this.parser=t,this.validFlags="gim"+(t.options.ecmaVersion>=6?"uy":"")+(t.options.ecmaVersion>=9?"s":""),this.unicodeProperties=mht[t.options.ecmaVersion>=11?11:t.options.ecmaVersion],this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=[],this.backReferenceNames=[]};function xht(t){return t<=65535?String.fromCharCode(t):(t-=65536,String.fromCharCode(55296+(t>>10),56320+(1023&t)))}function bht(t){return 36===t||t>=40&&t<=43||46===t||63===t||t>=91&&t<=94||t>=123&&t<=125}function _ht(t){return t>=65&&t<=90||t>=97&&t<=122}function wht(t){return _ht(t)||95===t}function Sht(t){return wht(t)||Mht(t)}function Mht(t){return t>=48&&t<=57}function Eht(t){return t>=48&&t<=57||t>=65&&t<=70||t>=97&&t<=102}function Aht(t){return t>=65&&t<=70?t-65+10:t>=97&&t<=102?t-97+10:t-48}function Tht(t){return t>=48&&t<=55}yht.prototype.reset=function(t,e,n){var r=-1!==n.indexOf("u");this.start=0|t,this.source=e+"",this.flags=n,this.switchU=r&&this.parser.options.ecmaVersion>=6,this.switchN=r&&this.parser.options.ecmaVersion>=9},yht.prototype.raise=function(t){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+t)},yht.prototype.at=function(t,e){void 0===e&&(e=!1);var n=this.source,r=n.length;if(t>=r)return-1;var i=n.charCodeAt(t);if(!e&&!this.switchU||i<=55295||i>=57344||t+1>=r)return i;var o=n.charCodeAt(t+1);return o>=56320&&o<=57343?(i<<10)+o-56613888:i},yht.prototype.nextIndex=function(t,e){void 0===e&&(e=!1);var n=this.source,r=n.length;if(t>=r)return r;var i,o=n.charCodeAt(t);return!e&&!this.switchU||o<=55295||o>=57344||t+1>=r||(i=n.charCodeAt(t+1))<56320||i>57343?t+1:t+2},yht.prototype.current=function(t){return void 0===t&&(t=!1),this.at(this.pos,t)},yht.prototype.lookahead=function(t){return void 0===t&&(t=!1),this.at(this.nextIndex(this.pos,t),t)},yht.prototype.advance=function(t){void 0===t&&(t=!1),this.pos=this.nextIndex(this.pos,t)},yht.prototype.eat=function(t,e){return void 0===e&&(e=!1),this.current(e)===t&&(this.advance(e),!0)},ght.validateRegExpFlags=function(t){for(var e=t.validFlags,n=t.flags,r=0;r<n.length;r++){var i=n.charAt(r);-1===e.indexOf(i)&&this.raise(t.start,"Invalid regular expression flag"),n.indexOf(i,r+1)>-1&&this.raise(t.start,"Duplicate regular expression flag")}},ght.validateRegExpPattern=function(t){this.regexp_pattern(t),!t.switchN&&this.options.ecmaVersion>=9&&t.groupNames.length>0&&(t.switchN=!0,this.regexp_pattern(t))},ght.regexp_pattern=function(t){t.pos=0,t.lastIntValue=0,t.lastStringValue="",t.lastAssertionIsQuantifiable=!1,t.numCapturingParens=0,t.maxBackReference=0,t.groupNames.length=0,t.backReferenceNames.length=0,this.regexp_disjunction(t),t.pos!==t.source.length&&(t.eat(41)&&t.raise("Unmatched ')'"),(t.eat(93)||t.eat(125))&&t.raise("Lone quantifier brackets")),t.maxBackReference>t.numCapturingParens&&t.raise("Invalid escape");for(var e=0,n=t.backReferenceNames;e<n.length;e+=1){var r=n[e];-1===t.groupNames.indexOf(r)&&t.raise("Invalid named capture referenced")}},ght.regexp_disjunction=function(t){for(this.regexp_alternative(t);t.eat(124);)this.regexp_alternative(t);this.regexp_eatQuantifier(t,!0)&&t.raise("Nothing to repeat"),t.eat(123)&&t.raise("Lone quantifier brackets")},ght.regexp_alternative=function(t){for(;t.pos<t.source.length&&this.regexp_eatTerm(t););},ght.regexp_eatTerm=function(t){return this.regexp_eatAssertion(t)?(t.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(t)&&t.switchU&&t.raise("Invalid quantifier"),!0):!!(t.switchU?this.regexp_eatAtom(t):this.regexp_eatExtendedAtom(t))&&(this.regexp_eatQuantifier(t),!0)},ght.regexp_eatAssertion=function(t){var e=t.pos;if(t.lastAssertionIsQuantifiable=!1,t.eat(94)||t.eat(36))return!0;if(t.eat(92)){if(t.eat(66)||t.eat(98))return!0;t.pos=e}if(t.eat(40)&&t.eat(63)){var n=!1;if(this.options.ecmaVersion>=9&&(n=t.eat(60)),t.eat(61)||t.eat(33))return this.regexp_disjunction(t),t.eat(41)||t.raise("Unterminated group"),t.lastAssertionIsQuantifiable=!n,!0}return t.pos=e,!1},ght.regexp_eatQuantifier=function(t,e){return void 0===e&&(e=!1),!!this.regexp_eatQuantifierPrefix(t,e)&&(t.eat(63),!0)},ght.regexp_eatQuantifierPrefix=function(t,e){return t.eat(42)||t.eat(43)||t.eat(63)||this.regexp_eatBracedQuantifier(t,e)},ght.regexp_eatBracedQuantifier=function(t,e){var n=t.pos;if(t.eat(123)){var r=0,i=-1;if(this.regexp_eatDecimalDigits(t)&&(r=t.lastIntValue,t.eat(44)&&this.regexp_eatDecimalDigits(t)&&(i=t.lastIntValue),t.eat(125)))return-1!==i&&i<r&&!e&&t.raise("numbers out of order in {} quantifier"),!0;t.switchU&&!e&&t.raise("Incomplete quantifier"),t.pos=n}return!1},ght.regexp_eatAtom=function(t){return this.regexp_eatPatternCharacters(t)||t.eat(46)||this.regexp_eatReverseSolidusAtomEscape(t)||this.regexp_eatCharacterClass(t)||this.regexp_eatUncapturingGroup(t)||this.regexp_eatCapturingGroup(t)},ght.regexp_eatReverseSolidusAtomEscape=function(t){var e=t.pos;if(t.eat(92)){if(this.regexp_eatAtomEscape(t))return!0;t.pos=e}return!1},ght.regexp_eatUncapturingGroup=function(t){var e=t.pos;if(t.eat(40)){if(t.eat(63)&&t.eat(58)){if(this.regexp_disjunction(t),t.eat(41))return!0;t.raise("Unterminated group")}t.pos=e}return!1},ght.regexp_eatCapturingGroup=function(t){if(t.eat(40)){if(this.options.ecmaVersion>=9?this.regexp_groupSpecifier(t):63===t.current()&&t.raise("Invalid group"),this.regexp_disjunction(t),t.eat(41))return t.numCapturingParens+=1,!0;t.raise("Unterminated group")}return!1},ght.regexp_eatExtendedAtom=function(t){return t.eat(46)||this.regexp_eatReverseSolidusAtomEscape(t)||this.regexp_eatCharacterClass(t)||this.regexp_eatUncapturingGroup(t)||this.regexp_eatCapturingGroup(t)||this.regexp_eatInvalidBracedQuantifier(t)||this.regexp_eatExtendedPatternCharacter(t)},ght.regexp_eatInvalidBracedQuantifier=function(t){return this.regexp_eatBracedQuantifier(t,!0)&&t.raise("Nothing to repeat"),!1},ght.regexp_eatSyntaxCharacter=function(t){var e=t.current();return!!bht(e)&&(t.lastIntValue=e,t.advance(),!0)},ght.regexp_eatPatternCharacters=function(t){for(var e=t.pos,n=0;-1!==(n=t.current())&&!bht(n);)t.advance();return t.pos!==e},ght.regexp_eatExtendedPatternCharacter=function(t){var e=t.current();return!(-1===e||36===e||e>=40&&e<=43||46===e||63===e||91===e||94===e||124===e)&&(t.advance(),!0)},ght.regexp_groupSpecifier=function(t){if(t.eat(63)){if(this.regexp_eatGroupName(t))return-1!==t.groupNames.indexOf(t.lastStringValue)&&t.raise("Duplicate capture group name"),void t.groupNames.push(t.lastStringValue);t.raise("Invalid group")}},ght.regexp_eatGroupName=function(t){if(t.lastStringValue="",t.eat(60)){if(this.regexp_eatRegExpIdentifierName(t)&&t.eat(62))return!0;t.raise("Invalid capture group name")}return!1},ght.regexp_eatRegExpIdentifierName=function(t){if(t.lastStringValue="",this.regexp_eatRegExpIdentifierStart(t)){for(t.lastStringValue+=xht(t.lastIntValue);this.regexp_eatRegExpIdentifierPart(t);)t.lastStringValue+=xht(t.lastIntValue);return!0}return!1},ght.regexp_eatRegExpIdentifierStart=function(t){var e=t.pos,n=this.options.ecmaVersion>=11,r=t.current(n);return t.advance(n),92===r&&this.regexp_eatRegExpUnicodeEscapeSequence(t,n)&&(r=t.lastIntValue),function(t){return plt(t,!0)||36===t||95===t}(r)?(t.lastIntValue=r,!0):(t.pos=e,!1)},ght.regexp_eatRegExpIdentifierPart=function(t){var e=t.pos,n=this.options.ecmaVersion>=11,r=t.current(n);return t.advance(n),92===r&&this.regexp_eatRegExpUnicodeEscapeSequence(t,n)&&(r=t.lastIntValue),function(t){return dlt(t,!0)||36===t||95===t||8204===t||8205===t}(r)?(t.lastIntValue=r,!0):(t.pos=e,!1)},ght.regexp_eatAtomEscape=function(t){return!!(this.regexp_eatBackReference(t)||this.regexp_eatCharacterClassEscape(t)||this.regexp_eatCharacterEscape(t)||t.switchN&&this.regexp_eatKGroupName(t))||(t.switchU&&(99===t.current()&&t.raise("Invalid unicode escape"),t.raise("Invalid escape")),!1)},ght.regexp_eatBackReference=function(t){var e=t.pos;if(this.regexp_eatDecimalEscape(t)){var n=t.lastIntValue;if(t.switchU)return n>t.maxBackReference&&(t.maxBackReference=n),!0;if(n<=t.numCapturingParens)return!0;t.pos=e}return!1},ght.regexp_eatKGroupName=function(t){if(t.eat(107)){if(this.regexp_eatGroupName(t))return t.backReferenceNames.push(t.lastStringValue),!0;t.raise("Invalid named reference")}return!1},ght.regexp_eatCharacterEscape=function(t){return this.regexp_eatControlEscape(t)||this.regexp_eatCControlLetter(t)||this.regexp_eatZero(t)||this.regexp_eatHexEscapeSequence(t)||this.regexp_eatRegExpUnicodeEscapeSequence(t,!1)||!t.switchU&&this.regexp_eatLegacyOctalEscapeSequence(t)||this.regexp_eatIdentityEscape(t)},ght.regexp_eatCControlLetter=function(t){var e=t.pos;if(t.eat(99)){if(this.regexp_eatControlLetter(t))return!0;t.pos=e}return!1},ght.regexp_eatZero=function(t){return 48===t.current()&&!Mht(t.lookahead())&&(t.lastIntValue=0,t.advance(),!0)},ght.regexp_eatControlEscape=function(t){var e=t.current();return 116===e?(t.lastIntValue=9,t.advance(),!0):110===e?(t.lastIntValue=10,t.advance(),!0):118===e?(t.lastIntValue=11,t.advance(),!0):102===e?(t.lastIntValue=12,t.advance(),!0):114===e&&(t.lastIntValue=13,t.advance(),!0)},ght.regexp_eatControlLetter=function(t){var e=t.current();return!!_ht(e)&&(t.lastIntValue=e%32,t.advance(),!0)},ght.regexp_eatRegExpUnicodeEscapeSequence=function(t,e){void 0===e&&(e=!1);var n,r=t.pos,i=e||t.switchU;if(t.eat(117)){if(this.regexp_eatFixedHexDigits(t,4)){var o=t.lastIntValue;if(i&&o>=55296&&o<=56319){var a=t.pos;if(t.eat(92)&&t.eat(117)&&this.regexp_eatFixedHexDigits(t,4)){var s=t.lastIntValue;if(s>=56320&&s<=57343)return t.lastIntValue=1024*(o-55296)+(s-56320)+65536,!0}t.pos=a,t.lastIntValue=o}return!0}if(i&&t.eat(123)&&this.regexp_eatHexDigits(t)&&t.eat(125)&&((n=t.lastIntValue)>=0&&n<=1114111))return!0;i&&t.raise("Invalid unicode escape"),t.pos=r}return!1},ght.regexp_eatIdentityEscape=function(t){if(t.switchU)return!!this.regexp_eatSyntaxCharacter(t)||!!t.eat(47)&&(t.lastIntValue=47,!0);var e=t.current();return!(99===e||t.switchN&&107===e)&&(t.lastIntValue=e,t.advance(),!0)},ght.regexp_eatDecimalEscape=function(t){t.lastIntValue=0;var e=t.current();if(e>=49&&e<=57){do{t.lastIntValue=10*t.lastIntValue+(e-48),t.advance()}while((e=t.current())>=48&&e<=57);return!0}return!1},ght.regexp_eatCharacterClassEscape=function(t){var e=t.current();if(function(t){return 100===t||68===t||115===t||83===t||119===t||87===t}(e))return t.lastIntValue=-1,t.advance(),!0;if(t.switchU&&this.options.ecmaVersion>=9&&(80===e||112===e)){if(t.lastIntValue=-1,t.advance(),t.eat(123)&&this.regexp_eatUnicodePropertyValueExpression(t)&&t.eat(125))return!0;t.raise("Invalid property name")}return!1},ght.regexp_eatUnicodePropertyValueExpression=function(t){var e=t.pos;if(this.regexp_eatUnicodePropertyName(t)&&t.eat(61)){var n=t.lastStringValue;if(this.regexp_eatUnicodePropertyValue(t)){var r=t.lastStringValue;return this.regexp_validateUnicodePropertyNameAndValue(t,n,r),!0}}if(t.pos=e,this.regexp_eatLoneUnicodePropertyNameOrValue(t)){var i=t.lastStringValue;return this.regexp_validateUnicodePropertyNameOrValue(t,i),!0}return!1},ght.regexp_validateUnicodePropertyNameAndValue=function(t,e,n){klt(t.unicodeProperties.nonBinary,e)||t.raise("Invalid property name"),t.unicodeProperties.nonBinary[e].test(n)||t.raise("Invalid property value")},ght.regexp_validateUnicodePropertyNameOrValue=function(t,e){t.unicodeProperties.binary.test(e)||t.raise("Invalid property name")},ght.regexp_eatUnicodePropertyName=function(t){var e=0;for(t.lastStringValue="";wht(e=t.current());)t.lastStringValue+=xht(e),t.advance();return""!==t.lastStringValue},ght.regexp_eatUnicodePropertyValue=function(t){var e=0;for(t.lastStringValue="";Sht(e=t.current());)t.lastStringValue+=xht(e),t.advance();return""!==t.lastStringValue},ght.regexp_eatLoneUnicodePropertyNameOrValue=function(t){return this.regexp_eatUnicodePropertyValue(t)},ght.regexp_eatCharacterClass=function(t){if(t.eat(91)){if(t.eat(94),this.regexp_classRanges(t),t.eat(93))return!0;t.raise("Unterminated character class")}return!1},ght.regexp_classRanges=function(t){for(;this.regexp_eatClassAtom(t);){var e=t.lastIntValue;if(t.eat(45)&&this.regexp_eatClassAtom(t)){var n=t.lastIntValue;!t.switchU||-1!==e&&-1!==n||t.raise("Invalid character class"),-1!==e&&-1!==n&&e>n&&t.raise("Range out of order in character class")}}},ght.regexp_eatClassAtom=function(t){var e=t.pos;if(t.eat(92)){if(this.regexp_eatClassEscape(t))return!0;if(t.switchU){var n=t.current();(99===n||Tht(n))&&t.raise("Invalid class escape"),t.raise("Invalid escape")}t.pos=e}var r=t.current();return 93!==r&&(t.lastIntValue=r,t.advance(),!0)},ght.regexp_eatClassEscape=function(t){var e=t.pos;if(t.eat(98))return t.lastIntValue=8,!0;if(t.switchU&&t.eat(45))return t.lastIntValue=45,!0;if(!t.switchU&&t.eat(99)){if(this.regexp_eatClassControlLetter(t))return!0;t.pos=e}return this.regexp_eatCharacterClassEscape(t)||this.regexp_eatCharacterEscape(t)},ght.regexp_eatClassControlLetter=function(t){var e=t.current();return!(!Mht(e)&&95!==e)&&(t.lastIntValue=e%32,t.advance(),!0)},ght.regexp_eatHexEscapeSequence=function(t){var e=t.pos;if(t.eat(120)){if(this.regexp_eatFixedHexDigits(t,2))return!0;t.switchU&&t.raise("Invalid escape"),t.pos=e}return!1},ght.regexp_eatDecimalDigits=function(t){var e=t.pos,n=0;for(t.lastIntValue=0;Mht(n=t.current());)t.lastIntValue=10*t.lastIntValue+(n-48),t.advance();return t.pos!==e},ght.regexp_eatHexDigits=function(t){var e=t.pos,n=0;for(t.lastIntValue=0;Eht(n=t.current());)t.lastIntValue=16*t.lastIntValue+Aht(n),t.advance();return t.pos!==e},ght.regexp_eatLegacyOctalEscapeSequence=function(t){if(this.regexp_eatOctalDigit(t)){var e=t.lastIntValue;if(this.regexp_eatOctalDigit(t)){var n=t.lastIntValue;e<=3&&this.regexp_eatOctalDigit(t)?t.lastIntValue=64*e+8*n+t.lastIntValue:t.lastIntValue=8*e+n}else t.lastIntValue=e;return!0}return!1},ght.regexp_eatOctalDigit=function(t){var e=t.current();return Tht(e)?(t.lastIntValue=e-48,t.advance(),!0):(t.lastIntValue=0,!1)},ght.regexp_eatFixedHexDigits=function(t,e){var n=t.pos;t.lastIntValue=0;for(var r=0;r<e;++r){var i=t.current();if(!Eht(i))return t.pos=n,!1;t.lastIntValue=16*t.lastIntValue+Aht(i),t.advance()}return!0};var Cht=function(t){this.type=t.type,this.value=t.value,this.start=t.start,this.end=t.end,t.options.locations&&(this.loc=new Ilt(t,t.startLoc,t.endLoc)),t.options.ranges&&(this.range=[t.start,t.end])},Oht=Blt.prototype;function kht(t){return"function"!=typeof BigInt?null:BigInt(t.replace(/_/g,""))}function Pht(t){return t<=65535?String.fromCharCode(t):(t-=65536,String.fromCharCode(55296+(t>>10),56320+(1023&t)))}Oht.next=function(t){!t&&this.type.keyword&&this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+this.type.keyword),this.options.onToken&&this.options.onToken(new Cht(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()},Oht.getToken=function(){return this.next(),new Cht(this)},"undefined"!=typeof Symbol&&(Oht[Symbol.iterator]=function(){var t=this;return{next:function(){var e=t.getToken();return{done:e.type===_lt.eof,value:e}}}}),Oht.curContext=function(){return this.context[this.context.length-1]},Oht.nextToken=function(){var t=this.curContext();return t&&t.preserveSpace||this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length?this.finishToken(_lt.eof):t.override?t.override(this):void this.readToken(this.fullCharCodeAtPos())},Oht.readToken=function(t){return plt(t,this.options.ecmaVersion>=6)||92===t?this.readWord():this.getTokenFromCode(t)},Oht.fullCharCodeAtPos=function(){var t=this.input.charCodeAt(this.pos);return t<=55295||t>=57344?t:(t<<10)+this.input.charCodeAt(this.pos+1)-56613888},Oht.skipBlockComment=function(){var t,e=this.options.onComment&&this.curPosition(),n=this.pos,r=this.input.indexOf("*/",this.pos+=2);if(-1===r&&this.raise(this.pos-2,"Unterminated comment"),this.pos=r+2,this.options.locations)for(Slt.lastIndex=n;(t=Slt.exec(this.input))&&t.index<this.pos;)++this.curLine,this.lineStart=t.index+t[0].length;this.options.onComment&&this.options.onComment(!0,this.input.slice(n+2,r),n,this.pos,e,this.curPosition())},Oht.skipLineComment=function(t){for(var e=this.pos,n=this.options.onComment&&this.curPosition(),r=this.input.charCodeAt(this.pos+=t);this.pos<this.input.length&&!Mlt(r);)r=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(e+t,this.pos),e,this.pos,n,this.curPosition())},Oht.skipSpace=function(){t:for(;this.pos<this.input.length;){var t=this.input.charCodeAt(this.pos);switch(t){case 32:case 160:++this.pos;break;case 13:10===this.input.charCodeAt(this.pos+1)&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break t}break;default:if(!(t>8&&t<14||t>=5760&&Elt.test(String.fromCharCode(t))))break t;++this.pos}}},Oht.finishToken=function(t,e){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var n=this.type;this.type=t,this.value=e,this.updateContext(n)},Oht.readToken_dot=function(){var t=this.input.charCodeAt(this.pos+1);if(t>=48&&t<=57)return this.readNumber(!0);var e=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&46===t&&46===e?(this.pos+=3,this.finishToken(_lt.ellipsis)):(++this.pos,this.finishToken(_lt.dot))},Oht.readToken_slash=function(){var t=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):61===t?this.finishOp(_lt.assign,2):this.finishOp(_lt.slash,1)},Oht.readToken_mult_modulo_exp=function(t){var e=this.input.charCodeAt(this.pos+1),n=1,r=42===t?_lt.star:_lt.modulo;return this.options.ecmaVersion>=7&&42===t&&42===e&&(++n,r=_lt.starstar,e=this.input.charCodeAt(this.pos+2)),61===e?this.finishOp(_lt.assign,n+1):this.finishOp(r,n)},Oht.readToken_pipe_amp=function(t){var e=this.input.charCodeAt(this.pos+1);if(e===t){if(this.options.ecmaVersion>=12)if(61===this.input.charCodeAt(this.pos+2))return this.finishOp(_lt.assign,3);return this.finishOp(124===t?_lt.logicalOR:_lt.logicalAND,2)}return 61===e?this.finishOp(_lt.assign,2):this.finishOp(124===t?_lt.bitwiseOR:_lt.bitwiseAND,1)},Oht.readToken_caret=function(){return 61===this.input.charCodeAt(this.pos+1)?this.finishOp(_lt.assign,2):this.finishOp(_lt.bitwiseXOR,1)},Oht.readToken_plus_min=function(t){var e=this.input.charCodeAt(this.pos+1);return e===t?45!==e||this.inModule||62!==this.input.charCodeAt(this.pos+2)||0!==this.lastTokEnd&&!wlt.test(this.input.slice(this.lastTokEnd,this.pos))?this.finishOp(_lt.incDec,2):(this.skipLineComment(3),this.skipSpace(),this.nextToken()):61===e?this.finishOp(_lt.assign,2):this.finishOp(_lt.plusMin,1)},Oht.readToken_lt_gt=function(t){var e=this.input.charCodeAt(this.pos+1),n=1;return e===t?(n=62===t&&62===this.input.charCodeAt(this.pos+2)?3:2,61===this.input.charCodeAt(this.pos+n)?this.finishOp(_lt.assign,n+1):this.finishOp(_lt.bitShift,n)):33!==e||60!==t||this.inModule||45!==this.input.charCodeAt(this.pos+2)||45!==this.input.charCodeAt(this.pos+3)?(61===e&&(n=2),this.finishOp(_lt.relational,n)):(this.skipLineComment(4),this.skipSpace(),this.nextToken())},Oht.readToken_eq_excl=function(t){var e=this.input.charCodeAt(this.pos+1);return 61===e?this.finishOp(_lt.equality,61===this.input.charCodeAt(this.pos+2)?3:2):61===t&&62===e&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(_lt.arrow)):this.finishOp(61===t?_lt.eq:_lt.prefix,1)},Oht.readToken_question=function(){var t=this.options.ecmaVersion;if(t>=11){var e=this.input.charCodeAt(this.pos+1);if(46===e){var n=this.input.charCodeAt(this.pos+2);if(n<48||n>57)return this.finishOp(_lt.questionDot,2)}if(63===e){if(t>=12)if(61===this.input.charCodeAt(this.pos+2))return this.finishOp(_lt.assign,3);return this.finishOp(_lt.coalesce,2)}}return this.finishOp(_lt.question,1)},Oht.getTokenFromCode=function(t){switch(t){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(_lt.parenL);case 41:return++this.pos,this.finishToken(_lt.parenR);case 59:return++this.pos,this.finishToken(_lt.semi);case 44:return++this.pos,this.finishToken(_lt.comma);case 91:return++this.pos,this.finishToken(_lt.bracketL);case 93:return++this.pos,this.finishToken(_lt.bracketR);case 123:return++this.pos,this.finishToken(_lt.braceL);case 125:return++this.pos,this.finishToken(_lt.braceR);case 58:return++this.pos,this.finishToken(_lt.colon);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(_lt.backQuote);case 48:var e=this.input.charCodeAt(this.pos+1);if(120===e||88===e)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(111===e||79===e)return this.readRadixNumber(8);if(98===e||66===e)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(t);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(t);case 124:case 38:return this.readToken_pipe_amp(t);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(t);case 60:case 62:return this.readToken_lt_gt(t);case 61:case 33:return this.readToken_eq_excl(t);case 63:return this.readToken_question();case 126:return this.finishOp(_lt.prefix,1)}this.raise(this.pos,"Unexpected character '"+Pht(t)+"'")},Oht.finishOp=function(t,e){var n=this.input.slice(this.pos,this.pos+e);return this.pos+=e,this.finishToken(t,n)},Oht.readRegexp=function(){for(var t,e,n=this.pos;;){this.pos>=this.input.length&&this.raise(n,"Unterminated regular expression");var r=this.input.charAt(this.pos);if(wlt.test(r)&&this.raise(n,"Unterminated regular expression"),t)t=!1;else{if("["===r)e=!0;else if("]"===r&&e)e=!1;else if("/"===r&&!e)break;t="\\"===r}++this.pos}var i=this.input.slice(n,this.pos);++this.pos;var o=this.pos,a=this.readWord1();this.containsEsc&&this.unexpected(o);var s=this.regexpState||(this.regexpState=new yht(this));s.reset(n,i,a),this.validateRegExpFlags(s),this.validateRegExpPattern(s);var u=null;try{u=new RegExp(i,a)}catch(c){}return this.finishToken(_lt.regexp,{pattern:i,flags:a,value:u})},Oht.readInt=function(t,e,n){for(var r=this.options.ecmaVersion>=12&&void 0===e,i=n&&48===this.input.charCodeAt(this.pos),o=this.pos,a=0,s=0,u=0,c=null==e?1/0:e;u<c;++u,++this.pos){var l=this.input.charCodeAt(this.pos),h=void 0;if(r&&95===l)i&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed in legacy octal numeric literals"),95===s&&this.raiseRecoverable(this.pos,"Numeric separator must be exactly one underscore"),0===u&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed at the first of digits"),s=l;else{if((h=l>=97?l-97+10:l>=65?l-65+10:l>=48&&l<=57?l-48:1/0)>=t)break;s=l,a=a*t+h}}return r&&95===s&&this.raiseRecoverable(this.pos-1,"Numeric separator is not allowed at the last of digits"),this.pos===o||null!=e&&this.pos-o!==e?null:a},Oht.readRadixNumber=function(t){var e=this.pos;this.pos+=2;var n=this.readInt(t);return null==n&&this.raise(this.start+2,"Expected number in radix "+t),this.options.ecmaVersion>=11&&110===this.input.charCodeAt(this.pos)?(n=kht(this.input.slice(e,this.pos)),++this.pos):plt(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(_lt.num,n)},Oht.readNumber=function(t){var e=this.pos;t||null!==this.readInt(10,void 0,!0)||this.raise(e,"Invalid number");var n=this.pos-e>=2&&48===this.input.charCodeAt(e);n&&this.strict&&this.raise(e,"Invalid number");var r=this.input.charCodeAt(this.pos);if(!n&&!t&&this.options.ecmaVersion>=11&&110===r){var i=kht(this.input.slice(e,this.pos));return++this.pos,plt(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(_lt.num,i)}n&&/[89]/.test(this.input.slice(e,this.pos))&&(n=!1),46!==r||n||(++this.pos,this.readInt(10),r=this.input.charCodeAt(this.pos)),69!==r&&101!==r||n||(43!==(r=this.input.charCodeAt(++this.pos))&&45!==r||++this.pos,null===this.readInt(10)&&this.raise(e,"Invalid number")),plt(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var o,a=(o=this.input.slice(e,this.pos),n?parseInt(o,8):parseFloat(o.replace(/_/g,"")));return this.finishToken(_lt.num,a)},Oht.readCodePoint=function(){var t;if(123===this.input.charCodeAt(this.pos)){this.options.ecmaVersion<6&&this.unexpected();var e=++this.pos;t=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,t>1114111&&this.invalidStringToken(e,"Code point out of bounds")}else t=this.readHexChar(4);return t},Oht.readString=function(t){for(var e="",n=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var r=this.input.charCodeAt(this.pos);if(r===t)break;92===r?(e+=this.input.slice(n,this.pos),e+=this.readEscapedChar(!1),n=this.pos):(Mlt(r,this.options.ecmaVersion>=10)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return e+=this.input.slice(n,this.pos++),this.finishToken(_lt.string,e)};var Lht={};Oht.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(t){if(t!==Lht)throw t;this.readInvalidTemplateToken()}this.inTemplateElement=!1},Oht.invalidStringToken=function(t,e){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw Lht;this.raise(t,e)},Oht.readTmplToken=function(){for(var t="",e=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var n=this.input.charCodeAt(this.pos);if(96===n||36===n&&123===this.input.charCodeAt(this.pos+1))return this.pos!==this.start||this.type!==_lt.template&&this.type!==_lt.invalidTemplate?(t+=this.input.slice(e,this.pos),this.finishToken(_lt.template,t)):36===n?(this.pos+=2,this.finishToken(_lt.dollarBraceL)):(++this.pos,this.finishToken(_lt.backQuote));if(92===n)t+=this.input.slice(e,this.pos),t+=this.readEscapedChar(!0),e=this.pos;else if(Mlt(n)){switch(t+=this.input.slice(e,this.pos),++this.pos,n){case 13:10===this.input.charCodeAt(this.pos)&&++this.pos;case 10:t+="\n";break;default:t+=String.fromCharCode(n)}this.options.locations&&(++this.curLine,this.lineStart=this.pos),e=this.pos}else++this.pos}},Oht.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if("{"!==this.input[this.pos+1])break;case"`":return this.finishToken(_lt.invalidTemplate,this.input.slice(this.start,this.pos))}this.raise(this.start,"Unterminated template")},Oht.readEscapedChar=function(t){var e=this.input.charCodeAt(++this.pos);switch(++this.pos,e){case 110:return"\n";case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return Pht(this.readCodePoint());case 116:return"\t";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:10===this.input.charCodeAt(this.pos)&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";case 56:case 57:if(t){var n=this.pos-1;return this.invalidStringToken(n,"Invalid escape sequence in template string"),null}default:if(e>=48&&e<=55){var r=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],i=parseInt(r,8);return i>255&&(r=r.slice(0,-1),i=parseInt(r,8)),this.pos+=r.length-1,e=this.input.charCodeAt(this.pos),"0"===r&&56!==e&&57!==e||!this.strict&&!t||this.invalidStringToken(this.pos-1-r.length,t?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode(i)}return Mlt(e)?"":String.fromCharCode(e)}},Oht.readHexChar=function(t){var e=this.pos,n=this.readInt(16,t);return null===n&&this.invalidStringToken(e,"Bad character escape sequence"),n},Oht.readWord1=function(){this.containsEsc=!1;for(var t="",e=!0,n=this.pos,r=this.options.ecmaVersion>=6;this.pos<this.input.length;){var i=this.fullCharCodeAtPos();if(dlt(i,r))this.pos+=i<=65535?1:2;else{if(92!==i)break;this.containsEsc=!0,t+=this.input.slice(n,this.pos);var o=this.pos;117!==this.input.charCodeAt(++this.pos)&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var a=this.readCodePoint();(e?plt:dlt)(a,r)||this.invalidStringToken(o,"Invalid Unicode escape"),t+=Pht(a),n=this.pos}e=!1}return t+this.input.slice(n,this.pos)},Oht.readWord=function(){var t=this.readWord1(),e=_lt.name;return this.keywords.test(t)&&(e=xlt[t]),this.finishToken(e,t)};function Rht(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}function Iht(t){var e="function"==typeof Map?new Map:void 0;return Iht=function(t){if(null===t||(n=t,-1===Function.toString.call(n).indexOf("[native code]")))return t;var n;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return Dht(t,arguments,jht(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),Fht(r,t)},Iht(t)}function Nht(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Dht(t,e,n){return(Dht=Nht()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var i=new(Function.bind.apply(t,r));return n&&Fht(i,n.prototype),i}).apply(null,arguments)}function Fht(t,e){return(Fht=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function jht(t){return(jht=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Blt.acorn={Parser:Blt,version:"7.4.1",defaultOptions:Dlt,Position:Rlt,SourceLocation:Ilt,getLineInfo:Nlt,Node:nht,TokenType:mlt,tokTypes:_lt,keywordTypes:xlt,TokContext:oht,tokContexts:aht,isIdentifierChar:dlt,isIdentifierStart:plt,Token:Cht,isNewLine:Mlt,lineBreak:wlt,lineBreakG:Slt,nonASCIIwhitespace:Elt};var Bht=function(t){function e(){return t.apply(this,arguments)||this}return Rht(e,t),e}(Iht(Error)),zht=function(t){function e(){return t.apply(this,arguments)||this}return Rht(e,t),e}(Iht(SyntaxError)),Uht=function(t){function e(){return t.apply(this,arguments)||this}return Rht(e,t),e}(Iht(ReferenceError)),Vht=function(t){function e(){return t.apply(this,arguments)||this}return Rht(e,t),e}(Iht(TypeError)),Ght=function(t){function e(){return t.apply(this,arguments)||this}return Rht(e,t),e}(Bht),Wht=function(t){function e(){return t.apply(this,arguments)||this}return Rht(e,t),e}(zht),Hht=function(t){function e(){return t.apply(this,arguments)||this}return Rht(e,t),e}(Uht),Yht={UnknownError:[3001,"%0",Ght],ExecutionTimeOutError:[3002,"Script execution timed out after %0ms",Ght],NodeTypeSyntaxError:[1001,"Unknown node type: %0",Hht],BinaryOperatorSyntaxError:[1002,"Unknown binary operator: %0",Hht],LogicalOperatorSyntaxError:[1003,"Unknown logical operator: %0",Hht],UnaryOperatorSyntaxError:[1004,"Unknown unary operator: %0",Hht],UpdateOperatorSyntaxError:[1005,"Unknown update operator: %0",Hht],ObjectStructureSyntaxError:[1006,"Unknown object structure: %0",Hht],AssignmentExpressionSyntaxError:[1007,"Unknown assignment expression: %0",Hht],VariableTypeSyntaxError:[1008,"Unknown variable type: %0",Hht],ParamTypeSyntaxError:[1009,"Unknown param type: %0",Hht],AssignmentTypeSyntaxError:[1010,"Unknown assignment type: %0",Hht],FunctionUndefinedReferenceError:[2001,"%0 is not a function",Uht],VariableUndefinedReferenceError:[2002,"%0 is not defined",Uht],IsNotConstructor:[2003,"%0 is not a constructor",Vht]};function Xht(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function qht(t,e,n){return(qht=Xht()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var i=new(Function.bind.apply(t,r));return n&&Zht(i,n.prototype),i}).apply(null,arguments)}function Zht(t,e){return(Zht=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function $ht(t,e){Object.defineProperty(t,"name",{value:e,writable:!1,enumerable:!1,configurable:!0})}var Kht=Object.prototype.hasOwnProperty,Jht=Symbol("Break"),Qht=Symbol("Continue"),tft=Symbol("DefaultCase"),eft=Symbol("EmptyStatementReturn"),nft=Symbol("WithScopeName"),rft=Symbol("SuperScopeName"),ift=Symbol("RootScopeName"),oft=Symbol("GlobalScopeName");function aft(t){return"function"==typeof t}var sft=function(){function t(t){this.interpreter=t}return t.prototype.generator=function(){var t=this.interpreter;return{getOptions:t.getOptions.bind(t),getCurrentScope:function(){return this.getCurrentScope()}.bind(t),getGlobalScope:function(){return this.getGlobalScope()}.bind(t),getCurrentContext:function(){return this.getCurrentContext()}.bind(t),getExecStartTime:t.getExecStartTime.bind(t)}},t}();function uft(t,e,n){if(void 0===n&&(n=!0),!(t instanceof sft))throw new Error("Illegal call");if("string"!=typeof e)return e;if(e){var r=t.generator(),i={timeout:r.getOptions().timeout,_initEnv:function(){n||this.setCurrentContext(r.getCurrentContext()),this.execStartTime=r.getExecStartTime(),this.execEndTime=this.execStartTime}},o=n?r.getGlobalScope():r.getCurrentScope();return new gft(o,i).evaluate(e)}}function cft(t){if(!(t instanceof sft))throw new Error("Illegal call");for(var e=t.generator(),n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];var o=r.pop(),a=new gft(e.getGlobalScope(),e.getOptions()),s="\n\t\t    (function anonymous("+r.join(",")+"){\n\t\t        "+o+"\n\t\t    });\n\t\t    ";return a.evaluate(s)}Object.defineProperty(uft,"__IS_EVAL_FUNC",{value:!0,writable:!1,enumerable:!1,configurable:!1}),Object.defineProperty(cft,"__IS_FUNCTION_FUNC",{value:!0,writable:!1,enumerable:!1,configurable:!1});var lft=function(t){this.value=t},hft=function(t){this.value=t},fft=function(t){this.value=t},pft=function(t,e,n){void 0===e&&(e=null),this.name=n,this.parent=e,this.data=t,this.labelStack=[]};function dft(){}function mft(t,e){return void 0===t&&(t=null),new pft(Object.create(null),t,e)}var vft={NaN:NaN,Infinity:1/0,undefined:void 0,Object:Object,Array:Array,String:String,Boolean:Boolean,Number:Number,Date:Date,RegExp:RegExp,Error:Error,URIError:URIError,TypeError:TypeError,RangeError:RangeError,SyntaxError:SyntaxError,ReferenceError:ReferenceError,Float32Array:Float32Array,Float64Array:Float64Array,Uint32Array:Uint32Array,Math:Math,parseInt:parseInt,parseFloat:parseFloat,isNaN:isNaN,isFinite:isFinite,decodeURI:decodeURI,decodeURIComponent:decodeURIComponent,encodeURI:encodeURI,encodeURIComponent:encodeURIComponent,escape:escape,unescape:unescape,eval:uft,Function:cft};"undefined"!=typeof JSON&&(vft.JSON=JSON),"undefined"!=typeof Promise&&(vft.Promise=Promise),"undefined"!=typeof Set&&(vft.Set=Set),"undefined"!=typeof Map&&(vft.Map=Map),"undefined"!=typeof Symbol&&(vft.Symbol=Symbol),"undefined"!=typeof Proxy&&(vft.Proxy=Proxy),"undefined"!=typeof WeakMap&&(vft.WeakMap=WeakMap),"undefined"!=typeof WeakSet&&(vft.WeakSet=WeakSet),"undefined"!=typeof Reflect&&(vft.Reflect=Reflect);var gft=function(){function t(e,n){void 0===e&&(e=t.global),void 0===n&&(n={}),this.sourceList=[],this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null),this.isVarDeclMode=!1,this.lastExecNode=null,this.isRunning=!1,this.options={ecmaVersion:n.ecmaVersion||t.ecmaVersion,timeout:n.timeout||0,rootContext:n.rootContext,globalContextInFunction:void 0===n.globalContextInFunction?t.globalContextInFunction:n.globalContextInFunction,_initEnv:n._initEnv},this.context=e||Object.create(null),this.callStack=[],this.initEnvironment(this.context)}var e=t.prototype;return e.initEnvironment=function(t){var e,n;if(t instanceof pft)e=t;else{var r=null,i=this.createSuperScope(t);this.options.rootContext&&(r=new pft((n=this.options.rootContext,Object.create(n)),i,ift)),e=new pft(t,r||i,oft)}this.globalScope=e,this.currentScope=this.globalScope,this.globalContext=e.data,this.currentContext=e.data,this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null),this.execStartTime=Date.now(),this.execEndTime=this.execStartTime;var o=this.options._initEnv;o&&o.call(this)},e.getExecStartTime=function(){return this.execStartTime},e.getExecutionTime=function(){return this.execEndTime-this.execStartTime},e.setExecTimeout=function(t){void 0===t&&(t=0),this.options.timeout=t},e.getOptions=function(){return this.options},e.getGlobalScope=function(){return this.globalScope},e.getCurrentScope=function(){return this.currentScope},e.getCurrentContext=function(){return this.currentContext},e.isInterruptThrow=function(t){return t instanceof Ght||t instanceof Hht||t instanceof Wht},e.createSuperScope=function(t){var e=Object.assign({},vft);return Object.keys(e).forEach((function(n){n in t&&delete e[n]})),new pft(e,null,rft)},e.setCurrentContext=function(t){this.currentContext=t},e.setCurrentScope=function(t){this.currentScope=t},e.evaluate=function(e){var n,r,i;if(void 0===e&&(e=""),e)return r=e,i={ranges:!0,locations:!0,ecmaVersion:this.options.ecmaVersion||t.ecmaVersion},n=Blt.parse(r,i),this.evaluateNode(n,e)},e.appendCode=function(t){return this.evaluate(t)},e.evaluateNode=function(t,e){var n=this;void 0===e&&(e=""),this.value=void 0,this.source=e,this.sourceList.push(e),this.isRunning=!0,this.execStartTime=Date.now(),this.execEndTime=this.execStartTime,this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null);var r=this.getCurrentScope(),i=this.getCurrentContext(),o=r.labelStack.concat([]),a=this.callStack.concat([]);try{var s=this.createClosure(t);this.addDeclarationsToScope(this.collectDeclVars,this.collectDeclFuncs,this.getCurrentScope()),s()}catch(u){throw u}finally{n.setCurrentScope(r),n.setCurrentContext(i),r.labelStack=o,n.callStack=a,this.execEndTime=Date.now()}return this.isRunning=!1,this.getValue()},e.createErrorMessage=function(t,e,n){var r=t[1].replace("%0",String(e));return null!==n&&(r+=this.getNodePosition(n||this.lastExecNode)),r},e.createError=function(t,e){return new e(t)},e.createThrowError=function(t,e){return this.createError(t,e)},e.createInternalThrowError=function(t,e,n){return this.createError(this.createErrorMessage(t,e,n),t[2])},e.checkTimeout=function(){if(!this.isRunning)return!1;var t=this.options.timeout||0;return Date.now()-this.execStartTime>t},e.getNodePosition=function(t){if(t){return t.loc?" ["+t.loc.start.line+":"+t.loc.start.column+"]":""}return""},e.createClosure=function(t){var e,n=this;switch(t.type){case"BinaryExpression":e=this.binaryExpressionHandler(t);break;case"LogicalExpression":e=this.logicalExpressionHandler(t);break;case"UnaryExpression":e=this.unaryExpressionHandler(t);break;case"UpdateExpression":e=this.updateExpressionHandler(t);break;case"ObjectExpression":e=this.objectExpressionHandler(t);break;case"ArrayExpression":e=this.arrayExpressionHandler(t);break;case"CallExpression":e=this.callExpressionHandler(t);break;case"NewExpression":e=this.newExpressionHandler(t);break;case"MemberExpression":e=this.memberExpressionHandler(t);break;case"ThisExpression":e=this.thisExpressionHandler(t);break;case"SequenceExpression":e=this.sequenceExpressionHandler(t);break;case"Literal":e=this.literalHandler(t);break;case"Identifier":e=this.identifierHandler(t);break;case"AssignmentExpression":e=this.assignmentExpressionHandler(t);break;case"FunctionDeclaration":e=this.functionDeclarationHandler(t);break;case"VariableDeclaration":e=this.variableDeclarationHandler(t);break;case"BlockStatement":case"Program":e=this.programHandler(t);break;case"ExpressionStatement":e=this.expressionStatementHandler(t);break;case"EmptyStatement":e=this.emptyStatementHandler(t);break;case"ReturnStatement":e=this.returnStatementHandler(t);break;case"FunctionExpression":e=this.functionExpressionHandler(t);break;case"IfStatement":e=this.ifStatementHandler(t);break;case"ConditionalExpression":e=this.conditionalExpressionHandler(t);break;case"ForStatement":e=this.forStatementHandler(t);break;case"WhileStatement":e=this.whileStatementHandler(t);break;case"DoWhileStatement":e=this.doWhileStatementHandler(t);break;case"ForInStatement":e=this.forInStatementHandler(t);break;case"WithStatement":e=this.withStatementHandler(t);break;case"ThrowStatement":e=this.throwStatementHandler(t);break;case"TryStatement":e=this.tryStatementHandler(t);break;case"ContinueStatement":e=this.continueStatementHandler(t);break;case"BreakStatement":e=this.breakStatementHandler(t);break;case"SwitchStatement":e=this.switchStatementHandler(t);break;case"LabeledStatement":e=this.labeledStatementHandler(t);break;case"DebuggerStatement":e=this.debuggerStatementHandler(t);break;default:throw this.createInternalThrowError(Yht.NodeTypeSyntaxError,t.type,t)}return function(){var r=n.options.timeout;if(r&&r>0&&n.checkTimeout())throw n.createInternalThrowError(Yht.ExecutionTimeOutError,r,null);return n.lastExecNode=t,e.apply(void 0,arguments)}},e.binaryExpressionHandler=function(t){var e=this,n=this.createClosure(t.left),r=this.createClosure(t.right);return function(){var i=n(),o=r();switch(t.operator){case"==":return i==o;case"!=":return i!=o;case"===":return i===o;case"!==":return i!==o;case"<":return i<o;case"<=":return i<=o;case">":return i>o;case">=":return i>=o;case"<<":return i<<o;case">>":return i>>o;case">>>":return i>>>o;case"+":return i+o;case"-":return i-o;case"*":return i*o;case"**":return Math.pow(i,o);case"/":return i/o;case"%":return i%o;case"|":return i|o;case"^":return i^o;case"&":return i&o;case"in":return i in o;case"instanceof":return i instanceof o;default:throw e.createInternalThrowError(Yht.BinaryOperatorSyntaxError,t.operator,t)}}},e.logicalExpressionHandler=function(t){var e=this,n=this.createClosure(t.left),r=this.createClosure(t.right);return function(){switch(t.operator){case"||":return n()||r();case"&&":return n()&&r();default:throw e.createInternalThrowError(Yht.LogicalOperatorSyntaxError,t.operator,t)}}},e.unaryExpressionHandler=function(t){var e,n=this;if("delete"===t.operator){var r=this.createObjectGetter(t.argument),i=this.createNameGetter(t.argument);return function(){return delete r()[i()]}}if("typeof"===t.operator&&"Identifier"===t.argument.type){var o=this.createObjectGetter(t.argument),a=this.createNameGetter(t.argument);e=function(){return o()[a()]}}else e=this.createClosure(t.argument);return function(){var r=e();switch(t.operator){case"-":return-r;case"+":return+r;case"!":return!r;case"~":return~r;case"void":return;case"typeof":return typeof r;default:throw n.createInternalThrowError(Yht.UnaryOperatorSyntaxError,t.operator,t)}}},e.updateExpressionHandler=function(t){var e=this,n=this.createObjectGetter(t.argument),r=this.createNameGetter(t.argument);return function(){var i=n(),o=r();switch(e.assertVariable(i,o,t),t.operator){case"++":return t.prefix?++i[o]:i[o]++;case"--":return t.prefix?--i[o]:i[o]--;default:throw e.createInternalThrowError(Yht.UpdateOperatorSyntaxError,t.operator,t)}}},e.objectExpressionHandler=function(t){var e=this,n=[];var r=Object.create(null);return t.properties.forEach((function(t){var i=t.kind,o=function(t){return"Identifier"===t.type?t.name:"Literal"===t.type?t.value:this.throwError(Yht.ObjectStructureSyntaxError,t.type,t)}(t.key);r[o]&&"init"!==i||(r[o]={}),r[o][i]=e.createClosure(t.value),n.push({key:o,property:t})})),function(){for(var t={},e=n.length,i=0;i<e;i++){var o=n[i],a=o.key,s=r[a],u=s.init?s.init():void 0,c=s.get?s.get():function(){},l=s.set?s.set():function(t){};if("set"in s||"get"in s){var h={configurable:!0,enumerable:!0,get:c,set:l};Object.defineProperty(t,a,h)}else{var f=o.property,p=f.kind;"Identifier"!==f.key.type||"FunctionExpression"!==f.value.type||"init"!==p||f.value.id||$ht(u,f.key.name),t[a]=u}}return t}},e.arrayExpressionHandler=function(t){var e=this,n=t.elements.map((function(t){return t?e.createClosure(t):t}));return function(){for(var t=n.length,e=Array(t),r=0;r<t;r++){var i=n[r];i&&(e[r]=i())}return e}},e.safeObjectGet=function(t,e,n){return t[e]},e.createCallFunctionGetter=function(t){var e=this;if("MemberExpression"===t.type){var n=this.createClosure(t.object),r=this.createMemberKeyGetter(t),i=this.source;return function(){var o=n(),a=r(),s=e.safeObjectGet(o,a,t);if(!s||!aft(s)){var u=i.slice(t.start,t.end);throw e.createInternalThrowError(Yht.FunctionUndefinedReferenceError,u,t)}return s.__IS_EVAL_FUNC?function(t){return s(new sft(e),t,!0)}:s.__IS_FUNCTION_FUNC?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return s.apply(void 0,[new sft(e)].concat(n))}:s.bind(o)}}var o=this.createClosure(t);return function(){var n="";"Identifier"===t.type&&(n=t.name);var r=o();if(!r||!aft(r))throw e.createInternalThrowError(Yht.FunctionUndefinedReferenceError,n,t);if("Identifier"===t.type&&r.__IS_EVAL_FUNC&&"eval"===n)return function(t){var i=e.getScopeFromName(n,e.getCurrentScope()),o=i.name===rft||i.name===oft||i.name===ift;return r(new sft(e),t,!o)};if(r.__IS_EVAL_FUNC)return function(t){return r(new sft(e),t,!0)};if(r.__IS_FUNCTION_FUNC)return function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return r.apply(void 0,[new sft(e)].concat(n))};var i=e.options.globalContextInFunction;if("Identifier"===t.type){var a=e.getIdentifierScope(t);a.name===nft&&(i=a.data)}return r.bind(i)}},e.callExpressionHandler=function(t){var e=this,n=this.createCallFunctionGetter(t.callee),r=t.arguments.map((function(t){return e.createClosure(t)}));return function(){return n().apply(void 0,r.map((function(t){return t()})))}},e.functionExpressionHandler=function(t){var e=this,n=this,r=this.source,i=this.collectDeclVars,o=this.collectDeclFuncs;this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null);var a=t.id?t.id.name:"",s=t.params.length,u=t.params.map((function(t){return e.createParamNameGetter(t)})),c=this.createClosure(t.body),l=this.collectDeclVars,h=this.collectDeclFuncs;return this.collectDeclVars=i,this.collectDeclFuncs=o,function(){var e=n.getCurrentScope(),i=function t(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];n.callStack.push(""+a);var s=n.getCurrentScope(),f=mft(e,"FunctionScope("+a+")");n.setCurrentScope(f),n.addDeclarationsToScope(l,h,f),a&&(f.data[a]=t),f.data.arguments=arguments,u.forEach((function(t,e){f.data[t()]=i[e]}));var p=n.getCurrentContext();n.setCurrentContext(this);var d=c();if(n.setCurrentContext(p),n.setCurrentScope(s),n.callStack.pop(),d instanceof lft)return d.value};return $ht(i,a),Object.defineProperty(i,"length",{value:s,writable:!1,enumerable:!1,configurable:!0}),Object.defineProperty(i,"toString",{value:function(){return r.slice(t.start,t.end)},writable:!0,configurable:!0,enumerable:!1}),Object.defineProperty(i,"valueOf",{value:function(){return r.slice(t.start,t.end)},writable:!0,configurable:!0,enumerable:!1}),i}},e.newExpressionHandler=function(t){var e=this,n=this.source,r=this.createClosure(t.callee),i=t.arguments.map((function(t){return e.createClosure(t)}));return function(){var o=r();if(!aft(o)||o.__IS_EVAL_FUNC){var a=t.callee,s=n.slice(a.start,a.end);throw e.createInternalThrowError(Yht.IsNotConstructor,s,t)}return o.__IS_FUNCTION_FUNC?o.apply(void 0,[new sft(e)].concat(i.map((function(t){return t()})))):qht(o,i.map((function(t){return t()})))}},e.memberExpressionHandler=function(t){var e=this.createClosure(t.object),n=this.createMemberKeyGetter(t);return function(){return e()[n()]}},e.thisExpressionHandler=function(t){var e=this;return function(){return e.getCurrentContext()}},e.sequenceExpressionHandler=function(t){var e=this,n=t.expressions.map((function(t){return e.createClosure(t)}));return function(){for(var t,e=n.length,r=0;r<e;r++){t=(0,n[r])()}return t}},e.literalHandler=function(t){return function(){return t.regex?new RegExp(t.regex.pattern,t.regex.flags):t.value}},e.identifierHandler=function(t){var e=this;return function(){var n=e.getCurrentScope(),r=e.getScopeDataFromName(t.name,n);return e.assertVariable(r,t.name,t),r[t.name]}},e.getIdentifierScope=function(t){var e=this.getCurrentScope();return this.getScopeFromName(t.name,e)},e.assignmentExpressionHandler=function(t){var e=this;"Identifier"!==t.left.type||"FunctionExpression"!==t.right.type||t.right.id||(t.right.id={type:"Identifier",name:t.left.name});var n=this.createObjectGetter(t.left),r=this.createNameGetter(t.left),i=this.createClosure(t.right);return function(){var o=n(),a=r(),s=i();switch("="!==t.operator&&e.assertVariable(o,a,t),t.operator){case"=":return o[a]=s;case"+=":return o[a]+=s;case"-=":return o[a]-=s;case"*=":return o[a]*=s;case"**=":return o[a]=Math.pow(o[a],s);case"/=":return o[a]/=s;case"%=":return o[a]%=s;case"<<=":return o[a]<<=s;case">>=":return o[a]>>=s;case">>>=":return o[a]>>>=s;case"&=":return o[a]&=s;case"^=":return o[a]^=s;case"|=":return o[a]|=s;default:throw e.createInternalThrowError(Yht.AssignmentExpressionSyntaxError,t.type,t)}}},e.functionDeclarationHandler=function(t){if(t.id){var e=this.functionExpressionHandler(t);Object.defineProperty(e,"isFunctionDeclareClosure",{value:!0,writable:!1,configurable:!1,enumerable:!1}),this.funcDeclaration(t.id.name,e)}return function(){return eft}},e.getVariableName=function(t){if("Identifier"===t.type)return t.name;throw this.createInternalThrowError(Yht.VariableTypeSyntaxError,t.type,t)},e.variableDeclarationHandler=function(t){for(var e,n=this,r=[],i=0;i<t.declarations.length;i++){var o=t.declarations[i];this.varDeclaration(this.getVariableName(o.id)),o.init&&r.push({type:"AssignmentExpression",operator:"=",left:o.id,right:o.init})}return r.length&&(e=this.createClosure({type:"BlockStatement",body:r})),function(){if(e){var t=n.isVarDeclMode;n.isVarDeclMode=!0,e(),n.isVarDeclMode=t}return eft}},e.assertVariable=function(t,e,n){if(t===this.globalScope.data&&!(e in t))throw this.createInternalThrowError(Yht.VariableUndefinedReferenceError,e,n)},e.programHandler=function(t){var e=this,n=t.body.map((function(t){return e.createClosure(t)}));return function(){for(var t=eft,r=0;r<n.length;r++){var i=n[r],o=e.setValue(i());if(o!==eft&&((t=o)instanceof lft||t instanceof hft||t instanceof fft||t===Jht||t===Qht))break}return t}},e.expressionStatementHandler=function(t){return this.createClosure(t.expression)},e.emptyStatementHandler=function(t){return function(){return eft}},e.returnStatementHandler=function(t){var e=t.argument?this.createClosure(t.argument):dft;return function(){return new lft(e())}},e.ifStatementHandler=function(t){var e=this.createClosure(t.test),n=this.createClosure(t.consequent),r=t.alternate?this.createClosure(t.alternate):
/*!important*/function(){return eft};return function(){return e()?n():r()}},e.conditionalExpressionHandler=function(t){return this.ifStatementHandler(t)},e.forStatementHandler=function(t){var e=this,n=dft,r=t.test?this.createClosure(t.test):function(){return!0},i=dft,o=this.createClosure(t.body);return"ForStatement"===t.type&&(n=t.init?this.createClosure(t.init):n,i=t.update?this.createClosure(t.update):dft),function(a){var s,u=eft,c="DoWhileStatement"===t.type;for(a&&"LabeledStatement"===a.type&&(s=a.label.name),n();c||r();i()){c=!1;var l=e.setValue(o());if(l!==eft&&l!==Qht){if(l===Jht)break;if((u=l)instanceof fft&&u.value===s)u=eft;else if(u instanceof lft||u instanceof hft||u instanceof fft)break}}return u}},e.whileStatementHandler=function(t){return this.forStatementHandler(t)},e.doWhileStatementHandler=function(t){return this.forStatementHandler(t)},e.forInStatementHandler=function(t){var e=this,n=t.left,r=this.createClosure(t.right),i=this.createClosure(t.body);return"VariableDeclaration"===t.left.type&&(this.createClosure(t.left)(),n=t.left.declarations[0].id),function(t){var o,a,s=eft;t&&"LabeledStatement"===t.type&&(o=t.label.name);var u=r();for(a in u){e.assignmentExpressionHandler({type:"AssignmentExpression",operator:"=",left:n,right:{type:"Literal",value:a}})();var c=e.setValue(i());if(c!==eft&&c!==Qht){if(c===Jht)break;if((s=c)instanceof fft&&s.value===o)s=eft;else if(s instanceof lft||s instanceof hft||s instanceof fft)break}}return s}},e.withStatementHandler=function(t){var e=this,n=this.createClosure(t.object),r=this.createClosure(t.body);return function(){var t=n(),i=e.getCurrentScope(),o=new pft(t,i,nft);e.setCurrentScope(o);var a=e.setValue(r());return e.setCurrentScope(i),a}},e.throwStatementHandler=function(t){var e=this,n=this.createClosure(t.argument);return function(){throw e.setValue(void 0),n()}},e.tryStatementHandler=function(t){var e=this,n=this.createClosure(t.block),r=t.handler?this.catchClauseHandler(t.handler):null,i=t.finalizer?this.createClosure(t.finalizer):null;return function(){var t,o,a=e.getCurrentScope(),s=e.getCurrentContext(),u=a.labelStack.concat([]),c=e.callStack.concat([]),l=eft,h=function(){e.setCurrentScope(a),e.setCurrentContext(s),a.labelStack=u,e.callStack=c};try{(l=e.setValue(n()))instanceof lft&&(t=l)}catch(f){if(h(),e.isInterruptThrow(f))throw f;if(r)try{(l=e.setValue(r(f)))instanceof lft&&(t=l)}catch(p){if(h(),e.isInterruptThrow(p))throw p;o=p}}if(i)try{(l=i())instanceof lft&&(t=l)}catch(f){if(h(),e.isInterruptThrow(f))throw f;o=f}if(o)throw o;return t||l}},e.catchClauseHandler=function(t){var e=this,n=this.createParamNameGetter(t.param),r=this.createClosure(t.body);return function(t){var i,o=e.getCurrentScope().data,a=n(),s=Kht.call(o,a),u=o[a];return o[a]=t,i=r(),s?o[a]=u:delete o[a],i}},e.continueStatementHandler=function(t){return function(){return t.label?new fft(t.label.name):Qht}},e.breakStatementHandler=function(t){return function(){return t.label?new hft(t.label.name):Jht}},e.switchStatementHandler=function(t){var e=this,n=this.createClosure(t.discriminant),r=t.cases.map((function(t){return e.switchCaseHandler(t)}));return function(){for(var t,i,o,a=n(),s=!1,u=0;u<r.length;u++){var c=r[u](),l=c.testClosure();if(l!==tft){if(s||l===a){if(s=!0,(i=e.setValue(c.bodyClosure()))===eft)continue;if(i===Jht)break;if((t=i)instanceof lft||t instanceof hft||t instanceof fft||t===Qht)break}}else o=c}!s&&o&&((i=e.setValue(o.bodyClosure()))===eft||i===Jht||i===Qht||(t=i));return t}},e.switchCaseHandler=function(t){var e=t.test?this.createClosure(t.test):function(){return tft},n=this.createClosure({type:"BlockStatement",body:t.consequent});return function(){return{testClosure:e,bodyClosure:n}}},e.labeledStatementHandler=function(t){var e=this,n=t.label.name,r=this.createClosure(t.body);return function(){var i,o=e.getCurrentScope();return o.labelStack.push(n),(i=r(t))instanceof hft&&i.value===n&&(i=eft),o.labelStack.pop(),i}},e.debuggerStatementHandler=function(t){return function(){return eft}},e.createParamNameGetter=function(t){if("Identifier"===t.type)return function(){return t.name};throw this.createInternalThrowError(Yht.ParamTypeSyntaxError,t.type,t)},e.createObjectKeyGetter=function(t){var e;return e="Identifier"===t.type?function(){return t.name}:this.createClosure(t),function(){return e()}},e.createMemberKeyGetter=function(t){return t.computed?this.createClosure(t.property):this.createObjectKeyGetter(t.property)},e.createObjectGetter=function(t){var e=this;switch(t.type){case"Identifier":return function(){return e.getScopeDataFromName(t.name,e.getCurrentScope())};case"MemberExpression":return this.createClosure(t.object);default:throw this.createInternalThrowError(Yht.AssignmentTypeSyntaxError,t.type,t)}},e.createNameGetter=function(t){switch(t.type){case"Identifier":return function(){return t.name};case"MemberExpression":return this.createMemberKeyGetter(t);default:throw this.createInternalThrowError(Yht.AssignmentTypeSyntaxError,t.type,t)}},e.varDeclaration=function(t){this.collectDeclVars[t]=void 0},e.funcDeclaration=function(t,e){this.collectDeclFuncs[t]=e},e.addDeclarationsToScope=function(t,e,n){var r=n.data;for(var i in e){var o=e[i];r[i]=o?o():o}for(var a in t)a in r||(r[a]=void 0)},e.getScopeValue=function(t,e){return this.getScopeFromName(t,e).data[t]},e.getScopeDataFromName=function(t,e){return this.getScopeFromName(t,e).data},e.getScopeFromName=function(t,e){var n=e;do{if(t in n.data)return n}while(n=n.parent);return this.globalScope},e.setValue=function(t){var e=this.callStack.length;return this.isVarDeclMode||e||t===eft||t===Jht||t===Qht||t instanceof hft||t instanceof fft||(this.value=t instanceof lft?t.value:t),t},e.getValue=function(){return this.value},t}();function yft(t,e,n){void 0===e&&(e=[]),void 0===n&&(n={});var r=n.parsingContext,i=void 0===n.timeout?0:n.timeout,o="\n    (function anonymous("+e.join(",")+"){\n         "+t+"\n    });\n    ";return new gft(r,{ecmaVersion:n.ecmaVersion,timeout:i,rootContext:n.rootContext,globalContextInFunction:n.globalContextInFunction}).evaluate(o)}function xft(t,e,n){return new gft(e,n).evaluate(t)}gft.version="0.0.3",gft.eval=uft,gft.Function=cft,gft.ecmaVersion=5,gft.globalContextInFunction=void 0,gft.global=Object.create(null);var bft=xft,_ft=function(){function t(t){this._code=t}var e=t.prototype;return e.runInContext=function(t){return xft(this._code,t)},e.runInNewContext=function(t){return xft(this._code,t)},t}();const wft=Object.freeze(Object.defineProperty({__proto__:null,Script:_ft,compileFunction:yft,createContext:function(t){return void 0===t&&(t=Object.create(null)),t},runInContext:xft,runInNewContext:bft},Symbol.toStringTag,{value:"Module"})),Sft=function(t,e,n){return xft(t,e,n)};const Mft=W(Object.freeze(Object.defineProperty({__proto__:null,Function:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=e.pop();return yft(r||"",e)},Interpreter:gft,default:Sft,evaluate:Sft,vm:wft},Symbol.toStringTag,{value:"Module"})));elt.exports=function(t){var e=function(t){return t instanceof Uint8Array||t instanceof Uint16Array||t instanceof Uint32Array||t instanceof Int8Array||t instanceof Int16Array||t instanceof Int32Array||t instanceof Float32Array||t instanceof Float64Array||t instanceof Uint8ClampedArray},n=function(t,e){for(var n=Object.keys(e),r=0;r<n.length;++r)t[n[r]]=e[n[r]];return t},r="\n";function i(t){return"undefined"!=typeof atob?atob(t):"base64:"+t}function o(t){throw new Error("(regl) "+t)}function a(t,e){t||o(e)}function s(t){return t?": "+t:""}function u(t,e,n){t in e||o("unknown parameter ("+t+")"+s(n)+". possible values: "+Object.keys(e).join())}function c(t,n){e(t)||o("invalid parameter type"+s(n)+". must be a typed array")}function l(t,e){switch(e){case"number":return"number"==typeof t;case"object":return"object"==typeof t;case"string":return"string"==typeof t;case"boolean":return"boolean"==typeof t;case"function":return"function"==typeof t;case"undefined":return void 0===t;case"symbol":return"symbol"==typeof t}}function h(t,e,n){l(t,e)||o("invalid parameter type"+s(n)+". expected "+e+", got "+typeof t)}function f(t,e){t>=0&&(0|t)===t||o("invalid parameter type, ("+t+")"+s(e)+". must be a nonnegative integer")}function p(t,e,n){e.indexOf(t)<0&&o("invalid value"+s(n)+". must be one of: "+e)}var d=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function m(t){Object.keys(t).forEach((function(t){d.indexOf(t)<0&&o('invalid regl constructor argument "'+t+'". must be one of '+d)}))}function v(t,e){for(t+="";t.length<e;)t=" "+t;return t}function g(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function y(t,e){this.number=t,this.line=e,this.errors=[]}function x(t,e,n){this.file=t,this.line=e,this.message=n}function b(){var t=new Error,e=(t.stack||t).toString(),n=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(e);if(n)return n[1];var r=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(e);return r?r[1]:"unknown"}function _(){var t=new Error,e=(t.stack||t).toString(),n=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(e);if(n)return n[1];var r=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(e);return r?r[1]:"unknown"}function w(t,e){var n=t.split("\n"),r=1,o=0,a={unknown:new g,0:new g};a.unknown.name=a[0].name=e||b(),a.unknown.lines.push(new y(0,""));for(var s=0;s<n.length;++s){var u=n[s],c=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(u);if(c)switch(c[1]){case"line":var l=/(\d+)(\s+\d+)?/.exec(c[2]);l&&(r=0|l[1],l[2]&&((o=0|l[2])in a||(a[o]=new g)));break;case"define":var h=/SHADER_NAME(_B64)?\s+(.*)$/.exec(c[2]);h&&(a[o].name=h[1]?i(h[2]):h[2])}a[o].lines.push(new y(r++,u))}return Object.keys(a).forEach((function(t){var e=a[t];e.lines.forEach((function(t){e.index[t.number]=t}))})),a}function S(t){var e=[];return t.split("\n").forEach((function(t){if(!(t.length<5)){var n=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(t);n?e.push(new x(0|n[1],0|n[2],n[3].trim())):t.length>0&&e.push(new x("unknown",0,t))}})),e}function M(t,e){e.forEach((function(e){var n=t[e.file];if(n){var r=n.index[e.line];if(r)return r.errors.push(e),void(n.hasErrors=!0)}t.unknown.hasErrors=!0,t.unknown.lines[0].errors.push(e)}))}function E(t,e,n,i,o){if(!t.getShaderParameter(e,t.COMPILE_STATUS)){var s=t.getShaderInfoLog(e),u=i===t.FRAGMENT_SHADER?"fragment":"vertex";L(n,"string",u+" shader source must be a string",o);var c=w(n,o),l=S(s);M(c,l),Object.keys(c).forEach((function(t){var e=c[t];if(e.hasErrors){var n=[""],i=[""];o("file number "+t+": "+e.name+"\n","color:red;text-decoration:underline;font-weight:bold"),e.lines.forEach((function(t){if(t.errors.length>0){o(v(t.number,4)+"|  ","background-color:yellow; font-weight:bold"),o(t.line+r,"color:red; background-color:yellow; font-weight:bold");var e=0;t.errors.forEach((function(n){var i=n.message,a=/^\s*'(.*)'\s*:\s*(.*)$/.exec(i);if(a){var s=a[1];i=a[2],"assign"===s&&(s="="),e=Math.max(t.line.indexOf(s,e),0)}else e=0;o(v("| ",6)),o(v("^^^",e+3)+r,"font-weight:bold"),o(v("| ",6)),o(i+r,"font-weight:bold")})),o(v("| ",6)+r)}else o(v(t.number,4)+"|  "),o(t.line+r,"color:red")})),"undefined"==typeof document||window.chrome||(i[0]=n.join("%c"))}function o(t,e){n.push(t),i.push(e||"")}})),a.raise("Error compiling "+u+" shader, "+c[0].name)}}function A(t,e,n,r,i){if(!t.getProgramParameter(e,t.LINK_STATUS)){t.getProgramInfoLog(e);var o=w(n,i),s='Error linking program with vertex shader, "'+w(r,i)[0].name+'", and fragment shader "'+o[0].name+'"';a.raise(s)}}function T(t){t._commandRef=b()}function C(t,e,n,r){function i(t){return t?r.id(t):0}function o(t,e){Object.keys(e).forEach((function(e){t[r.id(e)]=!0}))}T(t),t._fragId=i(t.static.frag),t._vertId=i(t.static.vert);var a=t._uniformSet={};o(a,e.static),o(a,e.dynamic);var s=t._attributeSet={};o(s,n.static),o(s,n.dynamic),t._hasCount="count"in t.static||"count"in t.dynamic||"elements"in t.static||"elements"in t.dynamic}function O(t,e){var n=_();o(t+" in command "+(e||b())+("unknown"===n?"":" called from "+n))}function k(t,e,n){t||O(e,n||b())}function P(t,e,n,r){t in e||O("unknown parameter ("+t+")"+s(n)+". possible values: "+Object.keys(e).join(),r||b())}function L(t,e,n,r){l(t,e)||O("invalid parameter type"+s(n)+". expected "+e+", got "+typeof t,r||b())}function R(t){t()}function I(t,e,n){t.texture?p(t.texture._texture.internalformat,e,"unsupported texture format for attachment"):p(t.renderbuffer._renderbuffer.format,n,"unsupported renderbuffer format for attachment")}var N=33071,D=9728,F=9984,j=9985,B=9986,z=9987,U=5121,V=5122,G=5123,W=5124,H=5125,Y=5126,X=32819,q=32820,Z=33635,$=34042,K=36193,J={};function Q(t,e){return t===q||t===X||t===Z?2:t===$?4:J[t]*e}function tt(t){return!(t&t-1||!t)}function et(t,e,n){var r,i=e.width,o=e.height,s=e.channels;a(i>0&&i<=n.maxTextureSize&&o>0&&o<=n.maxTextureSize,"invalid texture shape"),t.wrapS===N&&t.wrapT===N||a(tt(i)&&tt(o),"incompatible wrap mode for texture, both width and height must be power of 2"),1===e.mipmask?1!==i&&1!==o&&a(t.minFilter!==F&&t.minFilter!==B&&t.minFilter!==j&&t.minFilter!==z,"min filter requires mipmap"):(a(tt(i)&&tt(o),"texture must be a square power of 2 to support mipmapping"),a(e.mipmask===(i<<1)-1,"missing or incomplete mipmap data")),e.type===Y&&(n.extensions.indexOf("oes_texture_float_linear")<0&&a(t.minFilter===D&&t.magFilter===D,"filter not supported, must enable oes_texture_float_linear"),a(!t.genMipmaps,"mipmap generation not supported with float textures"));var u=e.images;for(r=0;r<16;++r)if(u[r]){var c=i>>r,l=o>>r;a(e.mipmask&1<<r,"missing mipmap data");var h=u[r];if(a(h.width===c&&h.height===l,"invalid shape for mip images"),a(h.format===e.format&&h.internalformat===e.internalformat&&h.type===e.type,"incompatible type for mip image"),h.compressed);else if(h.data){var f=Math.ceil(Q(h.type,s)*c/h.unpackAlignment)*h.unpackAlignment;a(h.data.byteLength===f*l,"invalid data for image, buffer size is inconsistent with image format")}else h.element||h.copy}else t.genMipmaps||a(0==(e.mipmask&1<<r),"extra mipmap data");e.compressed&&a(!t.genMipmaps,"mipmap generation for compressed images not supported")}function nt(t,e,n,r){var i=t.width,o=t.height,s=t.channels;a(i>0&&i<=r.maxTextureSize&&o>0&&o<=r.maxTextureSize,"invalid texture shape"),a(i===o,"cube map must be square"),a(e.wrapS===N&&e.wrapT===N,"wrap mode not supported by cube map");for(var u=0;u<n.length;++u){var c=n[u];a(c.width===i&&c.height===o,"inconsistent cube map face shape"),e.genMipmaps&&(a(!c.compressed,"can not generate mipmap for compressed textures"),a(1===c.mipmask,"can not specify mipmaps and generate mipmaps"));for(var l=c.images,h=0;h<16;++h){var f=l[h];if(f){var p=i>>h,d=o>>h;a(c.mipmask&1<<h,"missing mipmap data"),a(f.width===p&&f.height===d,"invalid shape for mip images"),a(f.format===t.format&&f.internalformat===t.internalformat&&f.type===t.type,"incompatible type for mip image"),f.compressed||(f.data?a(f.data.byteLength===p*d*Math.max(Q(f.type,s),f.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):f.element||f.copy)}}}}J[5120]=J[U]=1,J[V]=J[G]=J[K]=J[Z]=J[X]=J[q]=2,J[W]=J[H]=J[Y]=J[$]=4;var rt=n(a,{optional:R,raise:o,commandRaise:O,command:k,parameter:u,commandParameter:P,constructor:m,type:h,commandType:L,isTypedArray:c,nni:f,oneOf:p,shaderError:E,linkError:A,callSite:_,saveCommandRef:T,saveDrawInfo:C,framebufferFormat:I,guessCommand:b,texture2D:et,textureCube:nt}),it=0,ot=0,at=5,st=6;function ut(t,e){this.id=it++,this.type=t,this.data=e}function ct(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function lt(t){if(0===t.length)return[];var e=t.charAt(0),n=t.charAt(t.length-1);if(t.length>1&&e===n&&('"'===e||"'"===e))return['"'+ct(t.substr(1,t.length-2))+'"'];var r=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(t);if(r)return lt(t.substr(0,r.index)).concat(lt(r[1])).concat(lt(t.substr(r.index+r[0].length)));var i=t.split(".");if(1===i.length)return['"'+ct(t)+'"'];for(var o=[],a=0;a<i.length;++a)o=o.concat(lt(i[a]));return o}function ht(t){return"["+lt(t).join("][")+"]"}function ft(t,e){return new ut(t,ht(e+""))}function pt(t){return"function"==typeof t&&!t._reglType||t instanceof ut}function dt(t,e){return"function"==typeof t?new ut(ot,t):"number"==typeof t||"boolean"==typeof t?new ut(at,t):Array.isArray(t)?new ut(st,t.map((function(t,n){return dt(t,e+"["+n+"]")}))):t instanceof ut?t:void rt(!1,"invalid option type in uniform "+e)}var mt={DynamicVariable:ut,define:ft,isDynamic:pt,unbox:dt,accessor:ht},vt={next:"function"==typeof requestAnimationFrame?function(t){return requestAnimationFrame(t)}:function(t){return setTimeout(t,16)},cancel:"function"==typeof cancelAnimationFrame?function(t){return cancelAnimationFrame(t)}:clearTimeout},gt="undefined"!=typeof my&&my&&"function"==typeof my.showToast&&!0!==my.isFRM?function(){return+new Date}:"undefined"!=typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date};function yt(){var t={"":0},e=[""];return{id:function(n){var r=t[n];return r||(r=t[n]=e.length,e.push(n),r)},str:function(t){return e[t]}}}function xt(t,e,r){var i,o=document.createElement("canvas");function a(){var e=window.innerWidth,n=window.innerHeight;if(t!==document.body){var i=o.getBoundingClientRect();e=i.right-i.left,n=i.bottom-i.top}o.width=r*e,o.height=r*n}function s(){i?i.disconnect():window.removeEventListener("resize",a),t.removeChild(o)}return n(o.style,{border:0,margin:0,padding:0,top:0,left:0,width:"100%",height:"100%"}),t.appendChild(o),t===document.body&&(o.style.position="absolute",n(t.style,{margin:0,padding:0})),t!==document.body&&"function"==typeof ResizeObserver?(i=new ResizeObserver((function(){setTimeout(a)}))).observe(t):window.addEventListener("resize",a,!1),a(),{canvas:o,onDestroy:s}}function bt(t,e){function n(n){try{return t.getContext(n,e)}catch(r){return null}}return n("webgl")||n("experimental-webgl")||n("webgl-experimental")}function _t(t){return"string"==typeof t.nodeName&&"function"==typeof t.appendChild&&"function"==typeof t.getBoundingClientRect}function wt(t){return"function"==typeof t.drawArrays||"function"==typeof t.drawElements}function St(t){return"string"==typeof t?t.split():(rt(Array.isArray(t),"invalid extension array"),t)}function Mt(t){return"string"==typeof t?(rt("undefined"!=typeof document,"not supported outside of DOM"),document.querySelector(t)):t}function Et(t){var e,n,r,i,o=t||{},a={},s=[],u=[],c="undefined"==typeof window?1:window.devicePixelRatio,l=!1,h=function(t){t&&rt.raise(t)},f=function(){};if("string"==typeof o?(rt("undefined"!=typeof document,"selector queries only supported in DOM environments"),e=document.querySelector(o),rt(e,"invalid query string for element")):"object"==typeof o?_t(o)?e=o:wt(o)?r=(i=o).canvas:(rt.constructor(o),"gl"in o?i=o.gl:"canvas"in o?r=Mt(o.canvas):"container"in o&&(n=Mt(o.container)),"attributes"in o&&(a=o.attributes,rt.type(a,"object","invalid context attributes")),"extensions"in o&&(s=St(o.extensions)),"optionalExtensions"in o&&(u=St(o.optionalExtensions)),"onDone"in o&&(rt.type(o.onDone,"function","invalid or missing onDone callback"),h=o.onDone),"profile"in o&&(l=!!o.profile),"pixelRatio"in o&&(c=+o.pixelRatio,rt(c>0,"invalid pixel ratio"))):rt.raise("invalid arguments to regl"),e&&("canvas"===e.nodeName.toLowerCase()?r=e:n=e),!i){if(!r){rt("undefined"!=typeof document,"must manually specify webgl context outside of DOM environments");var p=xt(n||document.body,h,c);if(!p)return null;r=p.canvas,f=p.onDestroy}void 0===a.premultipliedAlpha&&(a.premultipliedAlpha=!0),i=bt(r,a)}return i?{gl:i,canvas:r,container:n,extensions:s,optionalExtensions:u,pixelRatio:c,profile:l,onDone:h,onDestroy:f}:(f(),h("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function At(t,e){var n={};function r(t){rt.type(t,"string","extension name must be string");var e,r=t.toLowerCase();try{e=n[r]=i(t)}catch(o){}return!!e}function i(e){return t.getExtension(e)?t.getExtension(e):t.getExtension(e.toLowerCase())?t.getExtension(e.toLowerCase()):null}for(var o=0;o<e.extensions.length;++o){var a=e.extensions[o];if(!r(a))return e.onDestroy(),e.onDone('"'+a+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return e.optionalExtensions.forEach(r),{extensions:n,restore:function(){Object.keys(n).forEach((function(t){if(n[t]&&!r(t))throw new Error("(regl): error restoring extension "+t)}))}}}function Tt(t,e){for(var n=Array(t),r=0;r<t;++r)n[r]=e(r);return n}var Ct=5120,Ot=5121,kt=5122,Pt=5123,Lt=5124,Rt=5125,It=5126;function Nt(t){for(var e=16;e<=1<<28;e*=16)if(t<=e)return e;return 0}function Dt(t){var e,n;return e=(t>65535)<<4,e|=n=((t>>>=e)>255)<<3,e|=n=((t>>>=n)>15)<<2,(e|=n=((t>>>=n)>3)<<1)|(t>>>=n)>>1}function Ft(){var t=Tt(8,(function(){return[]}));function e(e){var n=Nt(e),r=t[Dt(n)>>2];return r.length>0?r.pop():new ArrayBuffer(n)}function n(e){t[Dt(e.byteLength)>>2].push(e)}function r(t,n){var r=null;switch(t){case Ct:r=new Int8Array(e(n),0,n);break;case Ot:r=new Uint8Array(e(n),0,n);break;case kt:r=new Int16Array(e(2*n),0,n);break;case Pt:r=new Uint16Array(e(2*n),0,n);break;case Lt:r=new Int32Array(e(4*n),0,n);break;case Rt:r=new Uint32Array(e(4*n),0,n);break;case It:r=new Float32Array(e(4*n),0,n);break;default:return null}return r.length!==n?r.subarray(0,n):r}function i(t){n(t.buffer)}return{alloc:e,free:n,allocType:r,freeType:i}}var jt=Ft();jt.zero=Ft();var Bt=3408,zt=3410,Ut=3411,Vt=3412,Gt=3413,Wt=3414,Ht=3415,Yt=33901,Xt=33902,qt=3379,Zt=3386,$t=34921,Kt=36347,Jt=36348,Qt=35661,te=35660,ee=34930,ne=36349,re=34076,ie=34024,oe=7936,ae=7937,se=7938,ue=35724,ce=34047,le=36063,he=34852,fe=3553,pe=34067,de=34069,me=33984,ve=6408,ge=5126,ye=5121,xe=36160,be=36053,_e=36064,we=16384,Se=function(t,e){var n=1;e.ext_texture_filter_anisotropic&&(n=t.getParameter(ce));var r=1,i=1;e.webgl_draw_buffers&&(r=t.getParameter(he),i=t.getParameter(le));var o=!!e.oes_texture_float;if(o){var a=t.createTexture();t.bindTexture(fe,a),t.texImage2D(fe,0,ve,1,1,0,ve,ge,null);var s=t.createFramebuffer();if(t.bindFramebuffer(xe,s),t.framebufferTexture2D(xe,_e,fe,a,0),t.bindTexture(fe,null),t.checkFramebufferStatus(xe)!==be)o=!1;else{t.viewport(0,0,1,1),t.clearColor(1,0,0,1),t.clear(we);var u=jt.allocType(ge,4);t.readPixels(0,0,1,1,ve,ge,u),t.getError()?o=!1:(t.deleteFramebuffer(s),t.deleteTexture(a),o=1===u[0]),jt.freeType(u)}}var c=!0;if("undefined"==typeof navigator||!(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent))){var l=t.createTexture(),h=jt.allocType(ye,36);t.activeTexture(me),t.bindTexture(pe,l),t.texImage2D(de,0,ve,3,3,0,ve,ye,h),jt.freeType(h),t.bindTexture(pe,null),t.deleteTexture(l),c=!t.getError()}return{colorBits:[t.getParameter(zt),t.getParameter(Ut),t.getParameter(Vt),t.getParameter(Gt)],depthBits:t.getParameter(Wt),stencilBits:t.getParameter(Ht),subpixelBits:t.getParameter(Bt),extensions:Object.keys(e).filter((function(t){return!!e[t]})),maxAnisotropic:n,maxDrawbuffers:r,maxColorAttachments:i,pointSizeDims:t.getParameter(Yt),lineWidthDims:t.getParameter(Xt),maxViewportDims:t.getParameter(Zt),maxCombinedTextureUnits:t.getParameter(Qt),maxCubeMapSize:t.getParameter(re),maxRenderbufferSize:t.getParameter(ie),maxTextureUnits:t.getParameter(ee),maxTextureSize:t.getParameter(qt),maxAttributes:t.getParameter($t),maxVertexUniforms:t.getParameter(Kt),maxVertexTextureUnits:t.getParameter(te),maxVaryingVectors:t.getParameter(Jt),maxFragmentUniforms:t.getParameter(ne),glsl:t.getParameter(ue),renderer:t.getParameter(ae),vendor:t.getParameter(oe),version:t.getParameter(se),readFloat:o,npotTextureCube:c}};function Me(t){return!!t&&"object"==typeof t&&Array.isArray(t.shape)&&Array.isArray(t.stride)&&"number"==typeof t.offset&&t.shape.length===t.stride.length&&(Array.isArray(t.data)||e(t.data))}var Ee=function(t){return Object.keys(t).map((function(e){return t[e]}))},Ae={shape:Le,flatten:Pe};function Te(t,e,n){for(var r=0;r<e;++r)n[r]=t[r]}function Ce(t,e,n,r){for(var i=0,o=0;o<e;++o)for(var a=t[o],s=0;s<n;++s)r[i++]=a[s]}function Oe(t,e,n,r,i,o){for(var a=o,s=0;s<e;++s)for(var u=t[s],c=0;c<n;++c)for(var l=u[c],h=0;h<r;++h)i[a++]=l[h]}function ke(t,e,n,r,i){for(var o=1,a=n+1;a<e.length;++a)o*=e[a];var s=e[n];if(e.length-n==4){var u=e[n+1],c=e[n+2],l=e[n+3];for(a=0;a<s;++a)Oe(t[a],u,c,l,r,i),i+=o}else for(a=0;a<s;++a)ke(t[a],e,n+1,r,i),i+=o}function Pe(t,e,n,r){var i=1;if(e.length)for(var o=0;o<e.length;++o)i*=e[o];else i=0;var a=r||jt.allocType(n,i);switch(e.length){case 0:break;case 1:Te(t,e[0],a);break;case 2:Ce(t,e[0],e[1],a);break;case 3:Oe(t,e[0],e[1],e[2],a,0);break;default:ke(t,e,0,a,0)}return a}function Le(t){for(var e=[],n=t;n.length;n=n[0])e.push(n.length);return e}var Re={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},Ie={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},Ne={dynamic:35048,stream:35040,static:35044},De=Ae.flatten,Fe=Ae.shape,je=35044,Be=35040,ze=5121,Ue=5126,Ve=[];function Ge(t){return 0|Re[Object.prototype.toString.call(t)]}function We(t,e){for(var n=0;n<e.length;++n)t[n]=e[n]}function He(t,e,n,r,i,o,a){for(var s=0,u=0;u<n;++u)for(var c=0;c<r;++c)t[s++]=e[i*u+o*c+a]}function Ye(t,n,r,i){var o=0,a={};function s(e){this.id=o++,this.buffer=t.createBuffer(),this.type=e,this.usage=je,this.byteLength=0,this.dimension=1,this.dtype=ze,this.persistentData=null,r.profile&&(this.stats={size:0})}s.prototype.bind=function(){t.bindBuffer(this.type,this.buffer)},s.prototype.destroy=function(){p(this)};var u=[];function c(t,e){var n=u.pop();return n||(n=new s(t)),n.bind(),f(n,e,Be,0,1,!1),n}function l(t){u.push(t)}function h(e,n,r){e.byteLength=n.byteLength,t.bufferData(e.type,n,r)}function f(t,n,r,i,o,a){var s,u;if(t.usage=r,Array.isArray(n)){if(t.dtype=i||Ue,n.length>0)if(Array.isArray(n[0])){s=Fe(n);for(var c=1,l=1;l<s.length;++l)c*=s[l];t.dimension=c,h(t,u=De(n,s,t.dtype),r),a?t.persistentData=u:jt.freeType(u)}else if("number"==typeof n[0]){t.dimension=o;var f=jt.allocType(t.dtype,n.length);We(f,n),h(t,f,r),a?t.persistentData=f:jt.freeType(f)}else e(n[0])?(t.dimension=n[0].length,t.dtype=i||Ge(n[0])||Ue,h(t,u=De(n,[n.length,n[0].length],t.dtype),r),a?t.persistentData=u:jt.freeType(u)):rt.raise("invalid buffer data")}else if(e(n))t.dtype=i||Ge(n),t.dimension=o,h(t,n,r),a&&(t.persistentData=new Uint8Array(new Uint8Array(n.buffer)));else if(Me(n)){s=n.shape;var p=n.stride,d=n.offset,m=0,v=0,g=0,y=0;1===s.length?(m=s[0],v=1,g=p[0],y=0):2===s.length?(m=s[0],v=s[1],g=p[0],y=p[1]):rt.raise("invalid shape"),t.dtype=i||Ge(n.data)||Ue,t.dimension=v;var x=jt.allocType(t.dtype,m*v);He(x,n.data,m,v,g,y,d),h(t,x,r),a?t.persistentData=x:jt.freeType(x)}else n instanceof ArrayBuffer?(t.dtype=ze,t.dimension=o,h(t,n,r),a&&(t.persistentData=new Uint8Array(new Uint8Array(n)))):rt.raise("invalid buffer data")}function p(e){n.bufferCount--,i(e);var r=e.buffer;rt(r,"buffer must not be deleted already"),t.deleteBuffer(r),e.buffer=null,delete a[e.id]}function d(i,o,u,c){n.bufferCount++;var l=new s(o);function h(n){var i=je,o=null,a=0,s=0,u=1;return Array.isArray(n)||e(n)||Me(n)||n instanceof ArrayBuffer?o=n:"number"==typeof n?a=0|n:n&&(rt.type(n,"object","buffer arguments must be an object, a number or an array"),"data"in n&&(rt(null===o||Array.isArray(o)||e(o)||Me(o),"invalid data for buffer"),o=n.data),"usage"in n&&(rt.parameter(n.usage,Ne,"invalid buffer usage"),i=Ne[n.usage]),"type"in n&&(rt.parameter(n.type,Ie,"invalid buffer type"),s=Ie[n.type]),"dimension"in n&&(rt.type(n.dimension,"number","invalid dimension"),u=0|n.dimension),"length"in n&&(rt.nni(a,"buffer length must be a nonnegative integer"),a=0|n.length)),l.bind(),o?f(l,o,i,s,u,c):(a&&t.bufferData(l.type,a,i),l.dtype=s||ze,l.usage=i,l.dimension=u,l.byteLength=a),r.profile&&(l.stats.size=l.byteLength*Ve[l.dtype]),h}function d(e,n){rt(n+e.byteLength<=l.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+e.byteLength+" starting from offset "+n+" to a buffer of size "+l.byteLength),t.bufferSubData(l.type,n,e)}function m(t,n){var r,i=0|(n||0);if(l.bind(),e(t)||t instanceof ArrayBuffer)d(t,i);else if(Array.isArray(t)){if(t.length>0)if("number"==typeof t[0]){var o=jt.allocType(l.dtype,t.length);We(o,t),d(o,i),jt.freeType(o)}else if(Array.isArray(t[0])||e(t[0])){r=Fe(t);var a=De(t,r,l.dtype);d(a,i),jt.freeType(a)}else rt.raise("invalid buffer data")}else if(Me(t)){r=t.shape;var s=t.stride,u=0,c=0,f=0,p=0;1===r.length?(u=r[0],c=1,f=s[0],p=0):2===r.length?(u=r[0],c=r[1],f=s[0],p=s[1]):rt.raise("invalid shape");var m=Array.isArray(t.data)?l.dtype:Ge(t.data),v=jt.allocType(m,u*c);He(v,t.data,u,c,f,p,t.offset),d(v,i),jt.freeType(v)}else rt.raise("invalid data for buffer subdata");return h}return a[l.id]=l,u||h(i),h._reglType="buffer",h._buffer=l,h.subdata=m,r.profile&&(h.stats=l.stats),h.destroy=function(){p(l)},h}function m(){Ee(a).forEach((function(e){e.buffer=t.createBuffer(),t.bindBuffer(e.type,e.buffer),t.bufferData(e.type,e.persistentData||e.byteLength,e.usage)}))}return r.profile&&(n.getTotalBufferSize=function(){var t=0;return Object.keys(a).forEach((function(e){t+=a[e].stats.size})),t}),{create:d,createStream:c,destroyStream:l,clear:function(){Ee(a).forEach(p),u.forEach(p)},getBuffer:function(t){return t&&t._buffer instanceof s?t._buffer:null},restore:m,_initBuffer:f}}Ve[5120]=1,Ve[5122]=2,Ve[5124]=4,Ve[5121]=1,Ve[5123]=2,Ve[5125]=4,Ve[5126]=4;var Xe={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},qe=0,Ze=1,$e=4,Ke=5120,Je=5121,Qe=5122,tn=5123,en=5124,nn=5125,rn=34963,on=35040,an=35044;function sn(t,n,r,i){var o={},a=0,s={uint8:Je,uint16:tn};function u(t){this.id=a++,o[this.id]=this,this.buffer=t,this.primType=$e,this.vertCount=0,this.type=0}n.oes_element_index_uint&&(s.uint32=nn),u.prototype.bind=function(){this.buffer.bind()};var c=[];function l(t){var e=c.pop();return e||(e=new u(r.create(null,rn,!0,!1)._buffer)),f(e,t,on,-1,-1,0,0),e}function h(t){c.push(t)}function f(i,o,a,s,u,c,l){var h;if(i.buffer.bind(),o){var f=l;l||e(o)&&(!Me(o)||e(o.data))||(f=n.oes_element_index_uint?nn:tn),r._initBuffer(i.buffer,o,a,f,3)}else t.bufferData(rn,c,a),i.buffer.dtype=h||Je,i.buffer.usage=a,i.buffer.dimension=3,i.buffer.byteLength=c;if(h=l,!l){switch(i.buffer.dtype){case Je:case Ke:h=Je;break;case tn:case Qe:h=tn;break;case nn:case en:h=nn;break;default:rt.raise("unsupported type for element array")}i.buffer.dtype=h}i.type=h,rt(h!==nn||!!n.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var p=u;p<0&&(p=i.buffer.byteLength,h===tn?p>>=1:h===nn&&(p>>=2)),i.vertCount=p;var d=s;if(s<0){d=$e;var m=i.buffer.dimension;1===m&&(d=qe),2===m&&(d=Ze),3===m&&(d=$e)}i.primType=d}function p(t){i.elementsCount--,rt(null!==t.buffer,"must not double destroy elements"),delete o[t.id],t.buffer.destroy(),t.buffer=null}function d(t,n){var o=r.create(null,rn,!0),a=new u(o._buffer);function c(t){if(t)if("number"==typeof t)o(t),a.primType=$e,a.vertCount=0|t,a.type=Je;else{var n=null,r=an,i=-1,u=-1,l=0,h=0;Array.isArray(t)||e(t)||Me(t)?n=t:(rt.type(t,"object","invalid arguments for elements"),"data"in t&&(n=t.data,rt(Array.isArray(n)||e(n)||Me(n),"invalid data for element buffer")),"usage"in t&&(rt.parameter(t.usage,Ne,"invalid element buffer usage"),r=Ne[t.usage]),"primitive"in t&&(rt.parameter(t.primitive,Xe,"invalid element buffer primitive"),i=Xe[t.primitive]),"count"in t&&(rt("number"==typeof t.count&&t.count>=0,"invalid vertex count for elements"),u=0|t.count),"type"in t&&(rt.parameter(t.type,s,"invalid buffer type"),h=s[t.type]),"length"in t?l=0|t.length:(l=u,h===tn||h===Qe?l*=2:h!==nn&&h!==en||(l*=4))),f(a,n,r,i,u,l,h)}else o(),a.primType=$e,a.vertCount=0,a.type=Je;return c}return i.elementsCount++,c(t),c._reglType="elements",c._elements=a,c.subdata=function(t,e){return o.subdata(t,e),c},c.destroy=function(){p(a)},c}return{create:d,createStream:l,destroyStream:h,getElements:function(t){return"function"==typeof t&&t._elements instanceof u?t._elements:null},clear:function(){Ee(o).forEach(p)}}}var un=new Float32Array(1),cn=new Uint32Array(un.buffer),ln=5123;function hn(t){for(var e=jt.allocType(ln,t.length),n=0;n<t.length;++n)if(isNaN(t[n]))e[n]=65535;else if(t[n]===1/0)e[n]=31744;else if(t[n]===-1/0)e[n]=64512;else{un[0]=t[n];var r=cn[0],i=r>>>31<<15,o=(r<<1>>>24)-127,a=r>>13&1023;if(o<-24)e[n]=i;else if(o<-14){var s=-14-o;e[n]=i+(a+1024>>s)}else e[n]=o>15?i+31744:i+(o+15<<10)+a}return e}function fn(t){return Array.isArray(t)||e(t)}var pn=function(t){return!(t&t-1||!t)},dn=34467,mn=3553,vn=34067,gn=34069,yn=6408,xn=6406,bn=6407,_n=6409,wn=6410,Sn=32854,Mn=32855,En=36194,An=32819,Tn=32820,Cn=33635,On=34042,kn=6402,Pn=34041,Ln=35904,Rn=35906,In=36193,Nn=33776,Dn=33777,Fn=33778,jn=33779,Bn=35986,zn=35987,Un=34798,Vn=35840,Gn=35841,Wn=35842,Hn=35843,Yn=36196,Xn=5121,qn=5123,Zn=5125,$n=5126,Kn=10242,Jn=10243,Qn=10497,tr=33071,er=33648,nr=10240,rr=10241,ir=9728,or=9729,ar=9984,sr=9985,ur=9986,cr=9987,lr=33170,hr=4352,fr=4353,pr=4354,dr=34046,mr=3317,vr=37440,gr=37441,yr=37443,xr=37444,br=33984,_r=[ar,ur,sr,cr],wr=[0,_n,wn,bn,yn],Sr={};function Mr(t){return"[object "+t+"]"}Sr[_n]=Sr[xn]=Sr[kn]=1,Sr[Pn]=Sr[wn]=2,Sr[bn]=Sr[Ln]=3,Sr[yn]=Sr[Rn]=4;var Er=Mr("HTMLCanvasElement"),Ar=Mr("OffscreenCanvas"),Tr=Mr("CanvasRenderingContext2D"),Cr=Mr("ImageBitmap"),Or=Mr("HTMLImageElement"),kr=Mr("HTMLVideoElement"),Pr=Object.keys(Re).concat([Er,Ar,Tr,Cr,Or,kr]),Lr=[];Lr[Xn]=1,Lr[$n]=4,Lr[In]=2,Lr[qn]=2,Lr[Zn]=4;var Rr=[];function Ir(t){return Array.isArray(t)&&(0===t.length||"number"==typeof t[0])}function Nr(t){return!!Array.isArray(t)&&!(0===t.length||!fn(t[0]))}function Dr(t){return Object.prototype.toString.call(t)}function Fr(t){return Dr(t)===Er}function jr(t){return Dr(t)===Ar}function Br(t){return Dr(t)===Tr}function zr(t){return Dr(t)===Cr}function Ur(t){return Dr(t)===Or}function Vr(t){return Dr(t)===kr}function Gr(t){return!!("undefined"!=typeof my&&my&&"function"==typeof my.showToast&&!0!==my.isFRM&&t&&t.getContext)}function Wr(t){return!!("undefined"!=typeof my&&my&&"function"==typeof my.showToast&&!0!==my.isFRM&&t&&"src"in t&&"crossOrigin"in t)}function Hr(t){if(!t)return!1;if(Gr(t)||Wr(t))return!0;var e=Dr(t);return Pr.indexOf(e)>=0||Ir(t)||Nr(t)||Me(t)}function Yr(t){return 0|Re[Object.prototype.toString.call(t)]}function Xr(t,e){var n=e.length;switch(t.type){case Xn:case qn:case Zn:case $n:var r=jt.allocType(t.type,n);r.set(e),t.data=r;break;case In:t.data=hn(e);break;default:rt.raise("unsupported texture type, must specify a typed array")}}function qr(t,e){return jt.allocType(t.type===In?$n:t.type,e)}function Zr(t,e){t.type===In?(t.data=hn(e),jt.freeType(e)):t.data=e}function $r(t,e,n,r,i,o){for(var a=t.width,s=t.height,u=t.channels,c=qr(t,a*s*u),l=0,h=0;h<s;++h)for(var f=0;f<a;++f)for(var p=0;p<u;++p)c[l++]=e[n*f+r*h+i*p+o];Zr(t,c)}function Kr(t,e,n,r,i,o){var a;if(a=void 0!==Rr[t]?Rr[t]:Sr[t]*Lr[e],o&&(a*=6),i){for(var s=0,u=n;u>=1;)s+=a*u*u,u/=2;return s}return a*n*r}function Jr(t,r,i,o,a,s,u){var c={"don't care":hr,"dont care":hr,nice:pr,fast:fr},l={repeat:Qn,clamp:tr,mirror:er},h={nearest:ir,linear:or},f=n({mipmap:cr,"nearest mipmap nearest":ar,"linear mipmap nearest":sr,"nearest mipmap linear":ur,"linear mipmap linear":cr},h),p={none:0,browser:xr},d={uint8:Xn,rgba4:An,rgb565:Cn,"rgb5 a1":Tn},m={alpha:xn,luminance:_n,"luminance alpha":wn,rgb:bn,rgba:yn,rgba4:Sn,"rgb5 a1":Mn,rgb565:En},v={};r.ext_srgb&&(m.srgb=Ln,m.srgba=Rn),r.oes_texture_float&&(d.float32=d.float=$n),r.oes_texture_half_float&&(d.float16=d["half float"]=In),r.webgl_depth_texture&&(n(m,{depth:kn,"depth stencil":Pn}),n(d,{uint16:qn,uint32:Zn,"depth stencil":On})),r.webgl_compressed_texture_s3tc&&n(v,{"rgb s3tc dxt1":Nn,"rgba s3tc dxt1":Dn,"rgba s3tc dxt3":Fn,"rgba s3tc dxt5":jn}),r.webgl_compressed_texture_atc&&n(v,{"rgb atc":Bn,"rgba atc explicit alpha":zn,"rgba atc interpolated alpha":Un}),r.webgl_compressed_texture_pvrtc&&n(v,{"rgb pvrtc 4bppv1":Vn,"rgb pvrtc 2bppv1":Gn,"rgba pvrtc 4bppv1":Wn,"rgba pvrtc 2bppv1":Hn}),r.webgl_compressed_texture_etc1&&(v["rgb etc1"]=Yn);var g=Array.prototype.slice.call(t.getParameter(dn)||new Uint32Array(0));Object.keys(v).forEach((function(t){var e=v[t];g.indexOf(e)>=0&&(m[t]=e)}));var y=Object.keys(m);i.textureFormats=y;var x=[];Object.keys(m).forEach((function(t){var e=m[t];x[e]=t}));var b=[];Object.keys(d).forEach((function(t){var e=d[t];b[e]=t}));var _=[];Object.keys(h).forEach((function(t){var e=h[t];_[e]=t}));var w=[];Object.keys(f).forEach((function(t){var e=f[t];w[e]=t}));var S=[];Object.keys(l).forEach((function(t){var e=l[t];S[e]=t}));var M=y.reduce((function(t,e){var n=m[e];return n===_n||n===xn||n===_n||n===wn||n===kn||n===Pn||r.ext_srgb&&(n===Ln||n===Rn)?t[n]=n:n===Mn||e.indexOf("rgba")>=0?t[n]=yn:t[n]=bn,t}),{});function E(){this.internalformat=yn,this.format=yn,this.type=Xn,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=xr,this.width=0,this.height=0,this.channels=0}function A(t,e){t.internalformat=e.internalformat,t.format=e.format,t.type=e.type,t.compressed=e.compressed,t.premultiplyAlpha=e.premultiplyAlpha,t.flipY=e.flipY,t.unpackAlignment=e.unpackAlignment,t.colorSpace=e.colorSpace,t.width=e.width,t.height=e.height,t.channels=e.channels}function T(t,e){if("object"==typeof e&&e){if("premultiplyAlpha"in e&&(rt.type(e.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),t.premultiplyAlpha=e.premultiplyAlpha),"flipY"in e&&(rt.type(e.flipY,"boolean","invalid texture flip"),t.flipY=e.flipY),"alignment"in e&&(rt.oneOf(e.alignment,[1,2,4,8],"invalid texture unpack alignment"),t.unpackAlignment=e.alignment),"colorSpace"in e&&(rt.parameter(e.colorSpace,p,"invalid colorSpace"),t.colorSpace=p[e.colorSpace]),"type"in e){var n=e.type;rt(r.oes_texture_float||!("float"===n||"float32"===n),"you must enable the OES_texture_float extension in order to use floating point textures."),rt(r.oes_texture_half_float||!("half float"===n||"float16"===n),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),rt(r.webgl_depth_texture||!("uint16"===n||"uint32"===n||"depth stencil"===n),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),rt.parameter(n,d,"invalid texture type"),t.type=d[n]}var o=t.width,a=t.height,s=t.channels,u=!1;"shape"in e?(rt(Array.isArray(e.shape)&&e.shape.length>=2,"shape must be an array"),o=e.shape[0],a=e.shape[1],3===e.shape.length&&(s=e.shape[2],rt(s>0&&s<=4,"invalid number of channels"),u=!0),rt(o>=0&&o<=i.maxTextureSize,"invalid width"),rt(a>=0&&a<=i.maxTextureSize,"invalid height")):("radius"in e&&(o=a=e.radius,rt(o>=0&&o<=i.maxTextureSize,"invalid radius")),"width"in e&&(o=e.width,rt(o>=0&&o<=i.maxTextureSize,"invalid width")),"height"in e&&(a=e.height,rt(a>=0&&a<=i.maxTextureSize,"invalid height")),"channels"in e&&(s=e.channels,rt(s>0&&s<=4,"invalid number of channels"),u=!0)),t.width=0|o,t.height=0|a,t.channels=0|s;var c=!1;if("format"in e){var l=e.format;rt(r.webgl_depth_texture||!("depth"===l||"depth stencil"===l),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),rt.parameter(l,m,"invalid texture format");var h=t.internalformat=m[l];t.format=M[h],l in d&&("type"in e||(t.type=d[l])),l in v&&(t.compressed=!0),c=!0}!u&&c?t.channels=Sr[t.format]:u&&!c?t.channels!==wr[t.format]&&(t.format=t.internalformat=wr[t.channels]):c&&u&&rt(t.channels===Sr[t.format],"number of channels inconsistent with specified format")}}function C(e){t.pixelStorei(vr,e.flipY),t.pixelStorei(gr,e.premultiplyAlpha),t.pixelStorei(yr,e.colorSpace),t.pixelStorei(mr,e.unpackAlignment)}function O(){E.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function k(t,n){var r=null;if(Hr(n)?r=n:n&&(rt.type(n,"object","invalid pixel data type"),T(t,n),"x"in n&&(t.xOffset=0|n.x),"y"in n&&(t.yOffset=0|n.y),Hr(n.data)&&(r=n.data)),rt(!t.compressed||r instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),n.copy){rt(!r,"can not specify copy and data field for the same texture");var o=a.viewportWidth,s=a.viewportHeight;t.width=t.width||o-t.xOffset,t.height=t.height||s-t.yOffset,t.needsCopy=!0,rt(t.xOffset>=0&&t.xOffset<o&&t.yOffset>=0&&t.yOffset<s&&t.width>0&&t.width<=o&&t.height>0&&t.height<=s,"copy texture read out of bounds")}else if(r){if(e(r))t.channels=t.channels||4,t.data=r,"type"in n||t.type!==Xn||(t.type=Yr(r));else if(Ir(r))t.channels=t.channels||4,Xr(t,r),t.alignment=1,t.needsFree=!0;else if(Me(r)){var u=r.data;Array.isArray(u)||t.type!==Xn||(t.type=Yr(u));var c,l,h,f,p,d,m=r.shape,v=r.stride;3===m.length?(h=m[2],d=v[2]):(rt(2===m.length,"invalid ndarray pixel data, must be 2 or 3D"),h=1,d=1),c=m[0],l=m[1],f=v[0],p=v[1],t.alignment=1,t.width=c,t.height=l,t.channels=h,t.format=t.internalformat=wr[h],t.needsFree=!0,$r(t,u,f,p,d,r.offset)}else if(Gr(r)||Fr(r)||jr(r)||Br(r))Gr(r)||Fr(r)||jr(r)?t.element=r:t.element=r.canvas,t.width=t.element.width,t.height=t.element.height,t.channels=4;else if(zr(r))t.element=r,t.width=r.width,t.height=r.height,t.channels=4;else if(Ur(r))t.element=r,t.width=r.naturalWidth,t.height=r.naturalHeight,t.channels=4;else if(Wr(r))t.element=r,t.width=r.width,t.height=r.height,t.channels=4;else if(Vr(r))t.element=r,t.width=r.videoWidth,t.height=r.videoHeight,t.channels=4;else if(Nr(r)){var g=t.width||r[0].length,y=t.height||r.length,x=t.channels;x=fn(r[0][0])?x||r[0][0].length:x||1;for(var b=Ae.shape(r),_=1,w=0;w<b.length;++w)_*=b[w];var S=qr(t,_);Ae.flatten(r,b,"",S),Zr(t,S),t.alignment=1,t.width=g,t.height=y,t.channels=x,t.format=t.internalformat=wr[x],t.needsFree=!0}}else t.width=t.width||1,t.height=t.height||1,t.channels=t.channels||4;t.type===$n?rt(i.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):t.type===In&&rt(i.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function P(e,n,r){var i=e.element,a=e.data,s=e.internalformat,u=e.format,c=e.type,l=e.width,h=e.height;C(e),i?t.texImage2D(n,r,u,u,c,i):e.compressed?t.compressedTexImage2D(n,r,s,l,h,0,a):e.needsCopy?(o(),t.copyTexImage2D(n,r,u,e.xOffset,e.yOffset,l,h,0)):t.texImage2D(n,r,u,l,h,0,u,c,a||null)}function L(e,n,r,i,a){var s=e.element,u=e.data,c=e.internalformat,l=e.format,h=e.type,f=e.width,p=e.height;C(e),s?t.texSubImage2D(n,a,r,i,l,h,s):e.compressed?t.compressedTexSubImage2D(n,a,r,i,c,f,p,u):e.needsCopy?(o(),t.copyTexSubImage2D(n,a,r,i,e.xOffset,e.yOffset,f,p)):t.texSubImage2D(n,a,r,i,f,p,l,h,u)}var R=[];function I(){return R.pop()||new O}function N(t){t.needsFree&&jt.freeType(t.data),O.call(t),R.push(t)}function D(){E.call(this),this.genMipmaps=!1,this.mipmapHint=hr,this.mipmask=0,this.images=Array(16)}function F(t,e,n){var r=t.images[0]=I();t.mipmask=1,r.width=t.width=e,r.height=t.height=n,r.channels=t.channels=4}function j(t,e){var n=null;if(Hr(e))A(n=t.images[0]=I(),t),k(n,e),t.mipmask=1;else if(T(t,e),Array.isArray(e.mipmap))for(var r=e.mipmap,i=0;i<r.length;++i)A(n=t.images[i]=I(),t),n.width>>=i,n.height>>=i,k(n,r[i]),t.mipmask|=1<<i;else A(n=t.images[0]=I(),t),k(n,e),t.mipmask=1;A(t,t.images[0]),!t.compressed||t.internalformat!==Nn&&t.internalformat!==Dn&&t.internalformat!==Fn&&t.internalformat!==jn||rt(t.width%4==0&&t.height%4==0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function B(t,e){for(var n=t.images,r=0;r<n.length;++r){if(!n[r])return;P(n[r],e,r)}}var z=[];function U(){var t=z.pop()||new D;E.call(t),t.mipmask=0;for(var e=0;e<16;++e)t.images[e]=null;return t}function V(t){for(var e=t.images,n=0;n<e.length;++n)e[n]&&N(e[n]),e[n]=null;z.push(t)}function G(){this.minFilter=ir,this.magFilter=ir,this.wrapS=tr,this.wrapT=tr,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=hr}function W(t,e){if("min"in e){var n=e.min;rt.parameter(n,f),t.minFilter=f[n],_r.indexOf(t.minFilter)>=0&&!("faces"in e)&&(t.genMipmaps=!0)}if("mag"in e){var r=e.mag;rt.parameter(r,h),t.magFilter=h[r]}var o=t.wrapS,a=t.wrapT;if("wrap"in e){var s=e.wrap;"string"==typeof s?(rt.parameter(s,l),o=a=l[s]):Array.isArray(s)&&(rt.parameter(s[0],l),rt.parameter(s[1],l),o=l[s[0]],a=l[s[1]])}else{if("wrapS"in e){var u=e.wrapS;rt.parameter(u,l),o=l[u]}if("wrapT"in e){var p=e.wrapT;rt.parameter(p,l),a=l[p]}}if(t.wrapS=o,t.wrapT=a,"anisotropic"in e){var d=e.anisotropic;rt("number"==typeof d&&d>=1&&d<=i.maxAnisotropic,"aniso samples must be between 1 and "),t.anisotropic=e.anisotropic}if("mipmap"in e){var m=!1;switch(typeof e.mipmap){case"string":rt.parameter(e.mipmap,c,"invalid mipmap hint"),t.mipmapHint=c[e.mipmap],t.genMipmaps=!0,m=!0;break;case"boolean":m=t.genMipmaps=e.mipmap;break;case"object":rt(Array.isArray(e.mipmap),"invalid mipmap type"),t.genMipmaps=!1,m=!0;break;default:rt.raise("invalid mipmap type")}m&&!("min"in e)&&(t.minFilter=ar)}}function H(e,n){t.texParameteri(n,rr,e.minFilter),t.texParameteri(n,nr,e.magFilter),t.texParameteri(n,Kn,e.wrapS),t.texParameteri(n,Jn,e.wrapT),r.ext_texture_filter_anisotropic&&t.texParameteri(n,dr,e.anisotropic),e.genMipmaps&&(t.hint(lr,e.mipmapHint),t.generateMipmap(n))}var Y=0,X={},q=i.maxTextureUnits,Z=Array(q).map((function(){return null}));function $(e){E.call(this),this.mipmask=0,this.internalformat=yn,this.id=Y++,this.refCount=1,this.target=e,this.texture=t.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new G,u.profile&&(this.stats={size:0})}function K(e){t.activeTexture(br),t.bindTexture(e.target,e.texture)}function J(){var e=Z[0];e?t.bindTexture(e.target,e.texture):t.bindTexture(mn,null)}function Q(e){var n=e.texture;rt(n,"must not double destroy texture");var r=e.unit,i=e.target;r>=0&&(t.activeTexture(br+r),t.bindTexture(i,null),Z[r]=null),t.deleteTexture(n),e.texture=null,e.params=null,e.pixels=null,e.refCount=0,delete X[e.id],s.textureCount--}function tt(e,n){var r=new $(mn);function o(t,e){var n=r.texInfo;G.call(n);var a=U();return"number"==typeof t?F(a,0|t,"number"==typeof e?0|e:0|t):t?(rt.type(t,"object","invalid arguments to regl.texture"),W(n,t),j(a,t)):F(a,1,1),n.genMipmaps&&(a.mipmask=(a.width<<1)-1),r.mipmask=a.mipmask,A(r,a),rt.texture2D(n,a,i),r.internalformat=a.internalformat,o.width=a.width,o.height=a.height,K(r),B(a,mn),H(n,mn),J(),V(a),u.profile&&(r.stats.size=Kr(r.internalformat,r.type,a.width,a.height,n.genMipmaps,!1)),o.format=x[r.internalformat],o.type=b[r.type],o.mag=_[n.magFilter],o.min=w[n.minFilter],o.wrapS=S[n.wrapS],o.wrapT=S[n.wrapT],o}function a(t,e,n,i){rt(!!t,"must specify image data");var a=0|e,s=0|n,u=0|i,c=I();return A(c,r),c.width=0,c.height=0,k(c,t),c.width=c.width||(r.width>>u)-a,c.height=c.height||(r.height>>u)-s,rt(r.type===c.type&&r.format===c.format&&r.internalformat===c.internalformat,"incompatible format for texture.subimage"),rt(a>=0&&s>=0&&a+c.width<=r.width&&s+c.height<=r.height,"texture.subimage write out of bounds"),rt(r.mipmask&1<<u,"missing mipmap data"),rt(c.data||c.element||c.needsCopy,"missing image data"),K(r),L(c,mn,a,s,u),J(),N(c),o}function c(e,n){var i=0|e,a=0|n||i;if(i===r.width&&a===r.height)return o;o.width=r.width=i,o.height=r.height=a,K(r);for(var s=0;r.mipmask>>s;++s){var c=i>>s,l=a>>s;if(!c||!l)break;t.texImage2D(mn,s,r.format,c,l,0,r.format,r.type,null)}return J(),u.profile&&(r.stats.size=Kr(r.internalformat,r.type,i,a,!1,!1)),o}return X[r.id]=r,s.textureCount++,o(e,n),o.subimage=a,o.resize=c,o._reglType="texture2d",o._texture=r,u.profile&&(o.stats=r.stats),o.destroy=function(){r.decRef()},o}function et(e,n,r,o,a,c){var l=new $(vn);X[l.id]=l,s.cubeCount++;var h=new Array(6);function f(t,e,n,r,o,a){var s,c=l.texInfo;for(G.call(c),s=0;s<6;++s)h[s]=U();if("number"!=typeof t&&t)if("object"==typeof t)if(e)j(h[0],t),j(h[1],e),j(h[2],n),j(h[3],r),j(h[4],o),j(h[5],a);else if(W(c,t),T(l,t),"faces"in t){var p=t.faces;for(rt(Array.isArray(p)&&6===p.length,"cube faces must be a length 6 array"),s=0;s<6;++s)rt("object"==typeof p[s]&&!!p[s],"invalid input for cube map face"),A(h[s],l),j(h[s],p[s])}else for(s=0;s<6;++s)j(h[s],t);else rt.raise("invalid arguments to cube map");else{var d=0|t||1;for(s=0;s<6;++s)F(h[s],d,d)}for(A(l,h[0]),rt.optional((function(){i.npotTextureCube||rt(pn(l.width)&&pn(l.height),"your browser does not support non power or two texture dimensions")})),c.genMipmaps?l.mipmask=(h[0].width<<1)-1:l.mipmask=h[0].mipmask,rt.textureCube(l,c,h,i),l.internalformat=h[0].internalformat,f.width=h[0].width,f.height=h[0].height,K(l),s=0;s<6;++s)B(h[s],gn+s);for(H(c,vn),J(),u.profile&&(l.stats.size=Kr(l.internalformat,l.type,f.width,f.height,c.genMipmaps,!0)),f.format=x[l.internalformat],f.type=b[l.type],f.mag=_[c.magFilter],f.min=w[c.minFilter],f.wrapS=S[c.wrapS],f.wrapT=S[c.wrapT],s=0;s<6;++s)V(h[s]);return f}function p(t,e,n,r,i){rt(!!e,"must specify image data"),rt("number"==typeof t&&t===(0|t)&&t>=0&&t<6,"invalid face");var o=0|n,a=0|r,s=0|i,u=I();return A(u,l),u.width=0,u.height=0,k(u,e),u.width=u.width||(l.width>>s)-o,u.height=u.height||(l.height>>s)-a,rt(l.type===u.type&&l.format===u.format&&l.internalformat===u.internalformat,"incompatible format for texture.subimage"),rt(o>=0&&a>=0&&o+u.width<=l.width&&a+u.height<=l.height,"texture.subimage write out of bounds"),rt(l.mipmask&1<<s,"missing mipmap data"),rt(u.data||u.element||u.needsCopy,"missing image data"),K(l),L(u,gn+t,o,a,s),J(),N(u),f}function d(e){var n=0|e;if(n!==l.width){f.width=l.width=n,f.height=l.height=n,K(l);for(var r=0;r<6;++r)for(var i=0;l.mipmask>>i;++i)t.texImage2D(gn+r,i,l.format,n>>i,n>>i,0,l.format,l.type,null);return J(),u.profile&&(l.stats.size=Kr(l.internalformat,l.type,f.width,f.height,!1,!0)),f}}return f(e,n,r,o,a,c),f.subimage=p,f.resize=d,f._reglType="textureCube",f._texture=l,u.profile&&(f.stats=l.stats),f.destroy=function(){l.decRef()},f}function nt(){for(var e=0;e<q;++e)t.activeTexture(br+e),t.bindTexture(mn,null),Z[e]=null;Ee(X).forEach(Q),s.cubeCount=0,s.textureCount=0}function it(){for(var e=0;e<q;++e){var n=Z[e];n&&(n.bindCount=0,n.unit=-1,Z[e]=null)}Ee(X).forEach((function(e){e.texture=t.createTexture(),t.bindTexture(e.target,e.texture);for(var n=0;n<32;++n)if(0!=(e.mipmask&1<<n))if(e.target===mn)t.texImage2D(mn,n,e.internalformat,e.width>>n,e.height>>n,0,e.internalformat,e.type,null);else for(var r=0;r<6;++r)t.texImage2D(gn+r,n,e.internalformat,e.width>>n,e.height>>n,0,e.internalformat,e.type,null);H(e.texInfo,e.target)}))}function ot(){for(var e=0;e<q;++e){var n=Z[e];n&&(n.bindCount=0,n.unit=-1,Z[e]=null),t.activeTexture(br+e),t.bindTexture(mn,null),t.bindTexture(vn,null)}}return n($.prototype,{bind:function(){var e=this;e.bindCount+=1;var n=e.unit;if(n<0){for(var r=0;r<q;++r){var i=Z[r];if(i){if(i.bindCount>0)continue;i.unit=-1}Z[r]=e,n=r;break}n>=q&&rt.raise("insufficient number of texture units"),u.profile&&s.maxTextureUnits<n+1&&(s.maxTextureUnits=n+1),e.unit=n,t.activeTexture(br+n),t.bindTexture(e.target,e.texture)}return n},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&Q(this)}}),u.profile&&(s.getTotalTextureSize=function(){var t=0;return Object.keys(X).forEach((function(e){t+=X[e].stats.size})),t}),{create2D:tt,createCube:et,clear:nt,getTexture:function(t){return null},restore:it,refresh:ot}}Rr[Sn]=2,Rr[Mn]=2,Rr[En]=2,Rr[Pn]=4,Rr[Nn]=.5,Rr[Dn]=.5,Rr[Fn]=1,Rr[jn]=1,Rr[Bn]=.5,Rr[zn]=1,Rr[Un]=1,Rr[Vn]=.5,Rr[Gn]=.25,Rr[Wn]=.5,Rr[Hn]=.25,Rr[Yn]=.5;var Qr=36161,ti=32854,ei=32855,ni=36194,ri=33189,ii=36168,oi=34041,ai=35907,si=34836,ui=34842,ci=34843,li=[];function hi(t,e,n){return li[t]*e*n}li[ti]=2,li[ei]=2,li[ni]=2,li[ri]=2,li[ii]=1,li[oi]=4,li[ai]=4,li[si]=16,li[ui]=8,li[ci]=6;var fi=function(t,e,n,r,i){var o={rgba4:ti,rgb565:ni,"rgb5 a1":ei,depth:ri,stencil:ii,"depth stencil":oi};e.ext_srgb&&(o.srgba=ai),e.ext_color_buffer_half_float&&(o.rgba16f=ui,o.rgb16f=ci),e.webgl_color_buffer_float&&(o.rgba32f=si);var a=[];Object.keys(o).forEach((function(t){var e=o[t];a[e]=t}));var s=0,u={};function c(t){this.id=s++,this.refCount=1,this.renderbuffer=t,this.format=ti,this.width=0,this.height=0,i.profile&&(this.stats={size:0})}function l(e){var n=e.renderbuffer;rt(n,"must not double destroy renderbuffer"),t.bindRenderbuffer(Qr,null),t.deleteRenderbuffer(n),e.renderbuffer=null,e.refCount=0,delete u[e.id],r.renderbufferCount--}function h(e,s){var l=new c(t.createRenderbuffer());function h(e,r){var s=0,u=0,c=ti;if("object"==typeof e&&e){var f=e;if("shape"in f){var p=f.shape;rt(Array.isArray(p)&&p.length>=2,"invalid renderbuffer shape"),s=0|p[0],u=0|p[1]}else"radius"in f&&(s=u=0|f.radius),"width"in f&&(s=0|f.width),"height"in f&&(u=0|f.height);"format"in f&&(rt.parameter(f.format,o,"invalid renderbuffer format"),c=o[f.format])}else"number"==typeof e?(s=0|e,u="number"==typeof r?0|r:s):e?rt.raise("invalid arguments to renderbuffer constructor"):s=u=1;if(rt(s>0&&u>0&&s<=n.maxRenderbufferSize&&u<=n.maxRenderbufferSize,"invalid renderbuffer size"),s!==l.width||u!==l.height||c!==l.format)return h.width=l.width=s,h.height=l.height=u,l.format=c,t.bindRenderbuffer(Qr,l.renderbuffer),t.renderbufferStorage(Qr,c,s,u),rt(0===t.getError(),"invalid render buffer format"),i.profile&&(l.stats.size=hi(l.format,l.width,l.height)),h.format=a[l.format],h}function f(e,r){var o=0|e,a=0|r||o;return o===l.width&&a===l.height||(rt(o>0&&a>0&&o<=n.maxRenderbufferSize&&a<=n.maxRenderbufferSize,"invalid renderbuffer size"),h.width=l.width=o,h.height=l.height=a,t.bindRenderbuffer(Qr,l.renderbuffer),t.renderbufferStorage(Qr,l.format,o,a),rt(0===t.getError(),"invalid render buffer format"),i.profile&&(l.stats.size=hi(l.format,l.width,l.height))),h}return u[l.id]=l,r.renderbufferCount++,h(e,s),h.resize=f,h._reglType="renderbuffer",h._renderbuffer=l,i.profile&&(h.stats=l.stats),h.destroy=function(){l.decRef()},h}function f(){Ee(u).forEach((function(e){e.renderbuffer=t.createRenderbuffer(),t.bindRenderbuffer(Qr,e.renderbuffer),t.renderbufferStorage(Qr,e.format,e.width,e.height)})),t.bindRenderbuffer(Qr,null)}return c.prototype.decRef=function(){--this.refCount<=0&&l(this)},i.profile&&(r.getTotalRenderbufferSize=function(){var t=0;return Object.keys(u).forEach((function(e){t+=u[e].stats.size})),t}),{create:h,clear:function(){Ee(u).forEach(l)},restore:f}},pi=36160,di=36161,mi=3553,vi=34069,gi=36064,yi=36096,xi=36128,bi=33306,_i=36053,wi=36054,Si=36055,Mi=36057,Ei=36061,Ai=36193,Ti=5121,Ci=5126,Oi=6407,ki=6408,Pi=6402,Li=[Oi,ki],Ri=[];Ri[ki]=4,Ri[Oi]=3;var Ii=[];Ii[Ti]=1,Ii[Ci]=4,Ii[Ai]=2;var Ni=33189,Di=36168,Fi=34041,ji=[32854,32855,36194,35907,34842,34843,34836],Bi={};function zi(t,e,r,i,o,a){var s={cur:null,next:null,dirty:!1,setFBO:null},u=["rgba"],c=["rgba4","rgb565","rgb5 a1"];e.ext_srgb&&c.push("srgba"),e.ext_color_buffer_half_float&&c.push("rgba16f","rgb16f"),e.webgl_color_buffer_float&&c.push("rgba32f");var l=["uint8"];function h(t,e,n){this.target=t,this.texture=e,this.renderbuffer=n;var r=0,i=0;e?(r=e.width,i=e.height):n&&(r=n.width,i=n.height),this.width=r,this.height=i}function f(t){t&&(t.texture&&t.texture._texture.decRef(),t.renderbuffer&&t.renderbuffer._renderbuffer.decRef())}function p(t,e,n){if(t)if(t.texture){var r=t.texture._texture,i=Math.max(1,r.width),o=Math.max(1,r.height);rt(i===e&&o===n,"inconsistent width/height for supplied texture"),r.refCount+=1}else{var a=t.renderbuffer._renderbuffer;rt(a.width===e&&a.height===n,"inconsistent width/height for renderbuffer"),a.refCount+=1}}function d(e,n){n&&(n.texture?t.framebufferTexture2D(pi,e,n.target,n.texture._texture.texture,0):t.framebufferRenderbuffer(pi,e,di,n.renderbuffer._renderbuffer.renderbuffer))}function m(t){var e=mi,n=null,r=null,i=t;"object"==typeof t&&(i=t.data,"target"in t&&(e=0|t.target)),rt.type(i,"function","invalid attachment data");var o=i._reglType;return"texture2d"===o?(n=i,rt(e===mi)):"textureCube"===o?(n=i,rt(e>=vi&&e<vi+6,"invalid cube map target")):"renderbuffer"===o?(r=i,e=di):rt.raise("invalid regl object for attachment"),new h(e,n,r)}function v(t,e,n,r,a){if(n){var s=i.create2D({width:t,height:e,format:r,type:a});return s._texture.refCount=0,new h(mi,s,null)}var u=o.create({width:t,height:e,format:r});return u._renderbuffer.refCount=0,new h(di,null,u)}function g(t){return t&&(t.texture||t.renderbuffer)}function y(t,e,n){t&&(t.texture?t.texture.resize(e,n):t.renderbuffer&&t.renderbuffer.resize(e,n),t.width=e,t.height=n)}e.oes_texture_half_float&&l.push("half float","float16"),e.oes_texture_float&&l.push("float","float32");var x=0,b={};function _(){this.id=x++,b[this.id]=this,this.framebuffer=t.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function w(t){t.colorAttachments.forEach(f),f(t.depthAttachment),f(t.stencilAttachment),f(t.depthStencilAttachment)}function S(e){var n=e.framebuffer;rt(n,"must not double destroy framebuffer"),t.deleteFramebuffer(n),e.framebuffer=null,a.framebufferCount--,delete b[e.id]}function M(e){var n;t.bindFramebuffer(pi,e.framebuffer);var i=e.colorAttachments;for(n=0;n<i.length;++n)d(gi+n,i[n]);for(n=i.length;n<r.maxColorAttachments;++n)t.framebufferTexture2D(pi,gi+n,mi,null,0);t.framebufferTexture2D(pi,bi,mi,null,0),t.framebufferTexture2D(pi,yi,mi,null,0),t.framebufferTexture2D(pi,xi,mi,null,0),d(yi,e.depthAttachment),d(xi,e.stencilAttachment),d(bi,e.depthStencilAttachment);var o=t.checkFramebufferStatus(pi);t.isContextLost()||o===_i||rt.raise("framebuffer configuration not supported, status = "+Bi[o]),t.bindFramebuffer(pi,s.next?s.next.framebuffer:null),s.cur=s.next,t.getError()}function E(t,i){var o=new _;function h(t,n){var i;rt(s.next!==o,"can not update framebuffer which is currently in use");var a=0,f=0,d=!0,y=!0,x=null,b=!0,_="rgba",S="uint8",E=1,A=null,T=null,C=null,O=!1;if("number"==typeof t)a=0|t,f=0|n||a;else if(t){rt.type(t,"object","invalid arguments for framebuffer");var k=t;if("shape"in k){var P=k.shape;rt(Array.isArray(P)&&P.length>=2,"invalid shape for framebuffer"),a=P[0],f=P[1]}else"radius"in k&&(a=f=k.radius),"width"in k&&(a=k.width),"height"in k&&(f=k.height);("color"in k||"colors"in k)&&(x=k.color||k.colors,Array.isArray(x)&&rt(1===x.length||e.webgl_draw_buffers,"multiple render targets not supported")),x||("colorCount"in k&&(E=0|k.colorCount,rt(E>0,"invalid color buffer count")),"colorTexture"in k&&(b=!!k.colorTexture,_="rgba4"),"colorType"in k&&(S=k.colorType,b?(rt(e.oes_texture_float||!("float"===S||"float32"===S),"you must enable OES_texture_float in order to use floating point framebuffer objects"),rt(e.oes_texture_half_float||!("half float"===S||"float16"===S),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):"half float"===S||"float16"===S?(rt(e.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),_="rgba16f"):"float"!==S&&"float32"!==S||(rt(e.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),_="rgba32f"),rt.oneOf(S,l,"invalid color type")),"colorFormat"in k&&(_=k.colorFormat,u.indexOf(_)>=0?b=!0:c.indexOf(_)>=0?b=!1:rt.optional((function(){b?rt.oneOf(k.colorFormat,u,"invalid color format for texture"):rt.oneOf(k.colorFormat,c,"invalid color format for renderbuffer")})))),("depthTexture"in k||"depthStencilTexture"in k)&&(O=!(!k.depthTexture&&!k.depthStencilTexture),rt(!O||e.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in k&&("boolean"==typeof k.depth?d=k.depth:(A=k.depth,y=!1)),"stencil"in k&&("boolean"==typeof k.stencil?y=k.stencil:(T=k.stencil,d=!1)),"depthStencil"in k&&("boolean"==typeof k.depthStencil?d=y=k.depthStencil:(C=k.depthStencil,d=!1,y=!1))}else a=f=1;var L=null,R=null,I=null,N=null;if(Array.isArray(x))L=x.map(m);else if(x)L=[m(x)];else for(L=new Array(E),i=0;i<E;++i)L[i]=v(a,f,b,_,S);rt(e.webgl_draw_buffers||L.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),rt(L.length<=r.maxColorAttachments,"too many color attachments, not supported"),a=a||L[0].width,f=f||L[0].height,A?R=m(A):d&&!y&&(R=v(a,f,O,"depth","uint32")),T?I=m(T):y&&!d&&(I=v(a,f,!1,"stencil","uint8")),C?N=m(C):!A&&!T&&y&&d&&(N=v(a,f,O,"depth stencil","depth stencil")),rt(!!A+!!T+!!C<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var D=null;for(i=0;i<L.length;++i)if(p(L[i],a,f),rt(!L[i]||L[i].texture&&Li.indexOf(L[i].texture._texture.format)>=0||L[i].renderbuffer&&ji.indexOf(L[i].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+i+" is invalid"),L[i]&&L[i].texture){var F=Ri[L[i].texture._texture.format]*Ii[L[i].texture._texture.type];null===D?D=F:rt(D===F,"all color attachments much have the same number of bits per pixel.")}return p(R,a,f),rt(!R||R.texture&&R.texture._texture.format===Pi||R.renderbuffer&&R.renderbuffer._renderbuffer.format===Ni,"invalid depth attachment for framebuffer object"),p(I,a,f),rt(!I||I.renderbuffer&&I.renderbuffer._renderbuffer.format===Di,"invalid stencil attachment for framebuffer object"),p(N,a,f),rt(!N||N.texture&&N.texture._texture.format===Fi||N.renderbuffer&&N.renderbuffer._renderbuffer.format===Fi,"invalid depth-stencil attachment for framebuffer object"),w(o),o.width=a,o.height=f,o.colorAttachments=L,o.depthAttachment=R,o.stencilAttachment=I,o.depthStencilAttachment=N,h.color=L.map(g),h.depth=g(R),h.stencil=g(I),h.depthStencil=g(N),h.width=o.width,h.height=o.height,M(o),h}function f(t,e){rt(s.next!==o,"can not resize a framebuffer which is currently in use");var n=Math.max(0|t,1),r=Math.max(0|e||n,1);if(n===o.width&&r===o.height)return h;for(var i=o.colorAttachments,a=0;a<i.length;++a)y(i[a],n,r);return y(o.depthAttachment,n,r),y(o.stencilAttachment,n,r),y(o.depthStencilAttachment,n,r),o.width=h.width=n,o.height=h.height=r,M(o),h}return a.framebufferCount++,h(t,i),n(h,{resize:f,_reglType:"framebuffer",_framebuffer:o,destroy:function(){S(o),w(o)},use:function(t){s.setFBO({framebuffer:h},t)}})}function A(t){var o=Array(6);function a(t){var r;rt(o.indexOf(s.next)<0,"can not update framebuffer which is currently in use");var c,h={color:null},f=0,p=null,d="rgba",m="uint8",v=1;if("number"==typeof t)f=0|t;else if(t){rt.type(t,"object","invalid arguments for framebuffer");var g=t;if("shape"in g){var y=g.shape;rt(Array.isArray(y)&&y.length>=2,"invalid shape for framebuffer"),rt(y[0]===y[1],"cube framebuffer must be square"),f=y[0]}else"radius"in g&&(f=0|g.radius),"width"in g?(f=0|g.width,"height"in g&&rt(g.height===f,"must be square")):"height"in g&&(f=0|g.height);("color"in g||"colors"in g)&&(p=g.color||g.colors,Array.isArray(p)&&rt(1===p.length||e.webgl_draw_buffers,"multiple render targets not supported")),p||("colorCount"in g&&(v=0|g.colorCount,rt(v>0,"invalid color buffer count")),"colorType"in g&&(rt.oneOf(g.colorType,l,"invalid color type"),m=g.colorType),"colorFormat"in g&&(d=g.colorFormat,rt.oneOf(g.colorFormat,u,"invalid color format for texture"))),"depth"in g&&(h.depth=g.depth),"stencil"in g&&(h.stencil=g.stencil),"depthStencil"in g&&(h.depthStencil=g.depthStencil)}else f=1;if(p)if(Array.isArray(p))for(c=[],r=0;r<p.length;++r)c[r]=p[r];else c=[p];else{c=Array(v);var x={radius:f,format:d,type:m};for(r=0;r<v;++r)c[r]=i.createCube(x)}for(h.color=Array(c.length),r=0;r<c.length;++r){var b=c[r];rt("function"==typeof b&&"textureCube"===b._reglType,"invalid cube map"),f=f||b.width,rt(b.width===f&&b.height===f,"invalid cube map shape"),h.color[r]={target:vi,data:c[r]}}for(r=0;r<6;++r){for(var _=0;_<c.length;++_)h.color[_].target=vi+r;r>0&&(h.depth=o[0].depth,h.stencil=o[0].stencil,h.depthStencil=o[0].depthStencil),o[r]?o[r](h):o[r]=E(h)}return n(a,{width:f,height:f,color:c})}function c(t){var e,n=0|t;if(rt(n>0&&n<=r.maxCubeMapSize,"invalid radius for cube fbo"),n===a.width)return a;var i=a.color;for(e=0;e<i.length;++e)i[e].resize(n);for(e=0;e<6;++e)o[e].resize(n);return a.width=a.height=n,a}return a(t),n(a,{faces:o,resize:c,_reglType:"framebufferCube",destroy:function(){o.forEach((function(t){t.destroy()}))}})}function T(){s.cur=null,s.next=null,s.dirty=!0,Ee(b).forEach((function(e){e.framebuffer=t.createFramebuffer(),M(e)}))}return n(s,{getFramebuffer:function(t){if("function"==typeof t&&"framebuffer"===t._reglType){var e=t._framebuffer;if(e instanceof _)return e}return null},create:E,createCube:A,clear:function(){Ee(b).forEach(S)},restore:T})}Bi[_i]="complete",Bi[wi]="incomplete attachment",Bi[Mi]="incomplete dimensions",Bi[Si]="incomplete, missing attachment",Bi[Ei]="unsupported";var Ui=5126,Vi=34962,Gi=34963,Wi=["attributes","elements","offset","count","primitive","instances"];function Hi(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=Ui,this.offset=0,this.stride=0,this.divisor=0}function Yi(t,n,r,i,o,a,s){for(var u=r.maxAttributes,c=new Array(u),l=0;l<u;++l)c[l]=new Hi;var h=0,f={},p={Record:Hi,scope:{},state:c,currentVAO:null,targetVAO:null,restore:m()?w:function(){},createVAO:S,getVAO:g,destroyBuffer:d,setVAO:m()?y:x,clear:m()?b:function(){}};function d(e){for(var n=0;n<c.length;++n){var r=c[n];r.buffer===e&&(t.disableVertexAttribArray(n),r.buffer=null)}}function m(){return n.oes_vertex_array_object}function v(){return n.angle_instanced_arrays}function g(t){return"function"==typeof t&&t._vao?t._vao:null}function y(t){if(t!==p.currentVAO){var e=m();t?e.bindVertexArrayOES(t.vao):e.bindVertexArrayOES(null),p.currentVAO=t}}function x(e){if(e!==p.currentVAO){if(e)e.bindAttrs();else{for(var n=v(),r=0;r<c.length;++r){var i=c[r];i.buffer?(t.enableVertexAttribArray(r),i.buffer.bind(),t.vertexAttribPointer(r,i.size,i.type,i.normalized,i.stride,i.offfset),n&&i.divisor&&n.vertexAttribDivisorANGLE(r,i.divisor)):(t.disableVertexAttribArray(r),t.vertexAttrib4f(r,i.x,i.y,i.z,i.w))}s.elements?t.bindBuffer(Gi,s.elements.buffer.buffer):t.bindBuffer(Gi,null)}p.currentVAO=e}}function b(){Ee(f).forEach((function(t){t.destroy()}))}function _(){this.id=++h,this.attributes=[],this.elements=null,this.ownsElements=!1,this.count=0,this.offset=0,this.instances=-1,this.primitive=4;var t=m();this.vao=t?t.createVertexArrayOES():null,f[this.id]=this,this.buffers=[]}function w(){m()&&Ee(f).forEach((function(t){t.refresh()}))}function S(t){var r=new _;function s(t){var i;if(Array.isArray(t))i=t,r.elements&&r.ownsElements&&r.elements.destroy(),r.elements=null,r.ownsElements=!1,r.offset=0,r.count=0,r.instances=-1,r.primitive=4;else{if(rt("object"==typeof t,"invalid arguments for create vao"),rt("attributes"in t,"must specify attributes for vao"),t.elements){var c=t.elements;r.ownsElements?"function"==typeof c&&"elements"===c._reglType?(r.elements.destroy(),r.ownsElements=!1):(r.elements(c),r.ownsElements=!1):a.getElements(t.elements)?(r.elements=t.elements,r.ownsElements=!1):(r.elements=a.create(t.elements),r.ownsElements=!0)}else r.elements=null,r.ownsElements=!1;i=t.attributes,r.offset=0,r.count=-1,r.instances=-1,r.primitive=4,r.elements&&(r.count=r.elements._elements.vertCount,r.primitive=r.elements._elements.primType),"offset"in t&&(r.offset=0|t.offset),"count"in t&&(r.count=0|t.count),"instances"in t&&(r.instances=0|t.instances),"primitive"in t&&(rt(t.primitive in Xe,"bad primitive type: "+t.primitive),r.primitive=Xe[t.primitive]),rt.optional((function(){for(var e=Object.keys(t),n=0;n<e.length;++n)rt(Wi.indexOf(e[n])>=0,'invalid option for vao: "'+e[n]+'" valid options are '+Wi)})),rt(Array.isArray(i),"attributes must be an array")}rt(i.length<u,"too many attributes"),rt(i.length>0,"must specify at least one attribute");var l={},h=r.attributes;h.length=i.length;for(var f=0;f<i.length;++f){var p,d=i[f],m=h[f]=new Hi,v=d.data||d;Array.isArray(v)||e(v)||Me(v)?(r.buffers[f]&&(p=r.buffers[f],e(v)&&p._buffer.byteLength>=v.byteLength?p.subdata(v):(p.destroy(),r.buffers[f]=null)),r.buffers[f]||(p=r.buffers[f]=o.create(d,Vi,!1,!0)),m.buffer=o.getBuffer(p),m.size=0|m.buffer.dimension,m.normalized=!1,m.type=m.buffer.dtype,m.offset=0,m.stride=0,m.divisor=0,m.state=1,l[f]=1):o.getBuffer(d)?(m.buffer=o.getBuffer(d),m.size=0|m.buffer.dimension,m.normalized=!1,m.type=m.buffer.dtype,m.offset=0,m.stride=0,m.divisor=0,m.state=1):o.getBuffer(d.buffer)?(m.buffer=o.getBuffer(d.buffer),m.size=0|(+d.size||m.buffer.dimension),m.normalized=!!d.normalized||!1,"type"in d?(rt.parameter(d.type,Ie,"invalid buffer type"),m.type=Ie[d.type]):m.type=m.buffer.dtype,m.offset=0|(d.offset||0),m.stride=0|(d.stride||0),m.divisor=0|(d.divisor||0),m.state=1,rt(m.size>=1&&m.size<=4,"size must be between 1 and 4"),rt(m.offset>=0,"invalid offset"),rt(m.stride>=0&&m.stride<=255,"stride must be between 0 and 255"),rt(m.divisor>=0,"divisor must be positive"),rt(!m.divisor||!!n.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in d?(rt(f>0,"first attribute must not be a constant"),m.x=+d.x||0,m.y=+d.y||0,m.z=+d.z||0,m.w=+d.w||0,m.state=2):rt(!1,"invalid attribute spec for location "+f)}for(var g=0;g<r.buffers.length;++g)!l[g]&&r.buffers[g]&&(r.buffers[g].destroy(),r.buffers[g]=null);return r.refresh(),s}return i.vaoCount+=1,s.destroy=function(){for(var t=0;t<r.buffers.length;++t)r.buffers[t]&&r.buffers[t].destroy();r.buffers.length=0,r.ownsElements&&(r.elements.destroy(),r.elements=null,r.ownsElements=!1),r.destroy()},s._vao=r,s._reglType="vao",s(t)}return _.prototype.bindAttrs=function(){for(var e=v(),n=this.attributes,r=0;r<n.length;++r){var i=n[r];i.buffer?(t.enableVertexAttribArray(r),t.bindBuffer(Vi,i.buffer.buffer),t.vertexAttribPointer(r,i.size,i.type,i.normalized,i.stride,i.offset),e&&i.divisor&&e.vertexAttribDivisorANGLE(r,i.divisor)):(t.disableVertexAttribArray(r),t.vertexAttrib4f(r,i.x,i.y,i.z,i.w))}for(var o=n.length;o<u;++o)t.disableVertexAttribArray(o);var s=a.getElements(this.elements);s?t.bindBuffer(Gi,s.buffer.buffer):t.bindBuffer(Gi,null)},_.prototype.refresh=function(){var t=m();t&&(t.bindVertexArrayOES(this.vao),this.bindAttrs(),p.currentVAO=null,t.bindVertexArrayOES(null))},_.prototype.destroy=function(){if(this.vao){var t=m();this===p.currentVAO&&(p.currentVAO=null,t.bindVertexArrayOES(null)),t.deleteVertexArrayOES(this.vao),this.vao=null}this.ownsElements&&(this.elements.destroy(),this.elements=null,this.ownsElements=!1),f[this.id]&&(delete f[this.id],i.vaoCount-=1)},p}var Xi=35632,qi=35633,Zi=35718,$i=35721;function Ki(t,e,r,i){var o={},a={};function s(t,e,n,r){this.name=t,this.id=e,this.location=n,this.info=r}function u(t,e){for(var n=0;n<t.length;++n)if(t[n].id===e.id)return void(t[n].location=e.location);t.push(e)}function c(n,r,i){var s=n===Xi?o:a,u=s[r];if(!u){var c=e.str(r);u=t.createShader(n),t.shaderSource(u,c),t.compileShader(u),rt.shaderError(t,u,c,n,i),s[r]=u}return u}var l={},h=[],f=0;function p(t,e){this.id=f++,this.fragId=t,this.vertId=e,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,i.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function d(n,r,o){var a,l,h=c(Xi,n.fragId),f=c(qi,n.vertId),p=n.program=t.createProgram();if(t.attachShader(p,h),t.attachShader(p,f),o)for(a=0;a<o.length;++a){var d=o[a];t.bindAttribLocation(p,d[0],d[1])}t.linkProgram(p),rt.linkError(t,p,e.str(n.fragId),e.str(n.vertId),r);var m=t.getProgramParameter(p,Zi);i.profile&&(n.stats.uniformsCount=m);var v=n.uniforms;for(a=0;a<m;++a)if(l=t.getActiveUniform(p,a))if(l.size>1)for(var g=0;g<l.size;++g){var y=l.name.replace("[0]","["+g+"]");u(v,new s(y,e.id(y),t.getUniformLocation(p,y),l))}else u(v,new s(l.name,e.id(l.name),t.getUniformLocation(p,l.name),l));var x=t.getProgramParameter(p,$i);i.profile&&(n.stats.attributesCount=x);var b=n.attributes;for(a=0;a<x;++a)(l=t.getActiveAttrib(p,a))&&u(b,new s(l.name,e.id(l.name),t.getAttribLocation(p,l.name),l))}function m(){o={},a={};for(var t=0;t<h.length;++t)d(h[t],null,h[t].attributes.map((function(t){return[t.location,t.name]})))}return i.profile&&(r.getMaxUniformsCount=function(){var t=0;return h.forEach((function(e){e.stats.uniformsCount>t&&(t=e.stats.uniformsCount)})),t},r.getMaxAttributesCount=function(){var t=0;return h.forEach((function(e){e.stats.attributesCount>t&&(t=e.stats.attributesCount)})),t}),{clear:function(){var e=t.deleteShader.bind(t);Ee(o).forEach(e),o={},Ee(a).forEach(e),a={},h.forEach((function(e){t.deleteProgram(e.program)})),h.length=0,l={},r.shaderCount=0},program:function(e,i,s,u){rt.command(e>=0,"missing vertex shader",s),rt.command(i>=0,"missing fragment shader",s);var c=l[i];c||(c=l[i]={});var f=c[e];if(f&&(f.refCount++,!u))return f;var m=new p(i,e);return r.shaderCount++,d(m,s,u),f||(c[e]=m),h.push(m),n(m,{destroy:function(){if(m.refCount--,m.refCount<=0){t.deleteProgram(m.program);var e=h.indexOf(m);h.splice(e,1),r.shaderCount--}c[m.vertId].refCount<=0&&(t.deleteShader(a[m.vertId]),delete a[m.vertId],delete l[m.fragId][m.vertId]),Object.keys(l[m.fragId]).length||(t.deleteShader(o[m.fragId]),delete o[m.fragId],delete l[m.fragId])}})},restore:m,shader:c,frag:-1,vert:-1}}var Ji=6408,Qi=5121,to=3333,eo=5126;function no(t,n,r,i,o,a,s){function u(u){var c;null===n.next?(rt(o.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),c=Qi):(rt(null!==n.next.colorAttachments[0].texture,"You cannot read from a renderbuffer"),c=n.next.colorAttachments[0].texture._texture.type,rt.optional((function(){a.oes_texture_float?(rt(c===Qi||c===eo,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),c===eo&&rt(s.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):rt(c===Qi,"Reading from a framebuffer is only allowed for the type 'uint8'")})));var l=0,h=0,f=i.framebufferWidth,p=i.framebufferHeight,d=null;e(u)?d=u:u&&(rt.type(u,"object","invalid arguments to regl.read()"),l=0|u.x,h=0|u.y,rt(l>=0&&l<i.framebufferWidth,"invalid x offset for regl.read"),rt(h>=0&&h<i.framebufferHeight,"invalid y offset for regl.read"),f=0|(u.width||i.framebufferWidth-l),p=0|(u.height||i.framebufferHeight-h),d=u.data||null),d&&(c===Qi?rt(d instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):c===eo&&rt(d instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),rt(f>0&&f+l<=i.framebufferWidth,"invalid width for read pixels"),rt(p>0&&p+h<=i.framebufferHeight,"invalid height for read pixels"),r();var m=f*p*4;return d||(c===Qi?d=new Uint8Array(m):c===eo&&(d=d||new Float32Array(m))),rt.isTypedArray(d,"data buffer for regl.read() must be a typedarray"),rt(d.byteLength>=m,"data buffer for regl.read() too small"),t.pixelStorei(to,4),t.readPixels(l,h,f,p,Ji,c,d),d}function c(t){var e;return n.setFBO({framebuffer:t.framebuffer},(function(){e=u(t)})),e}function l(t){return t&&"framebuffer"in t?c(t):u(t)}return l}function ro(t){return Array.prototype.slice.call(t)}function io(t){return ro(t).join("")}function oo(){var e=0,r=[],i=[];function o(t){for(var n=0;n<i.length;++n)if(i[n]===t)return r[n];var o="g"+e++;return r.push(o),i.push(t),o}function a(){var t=[];function r(){t.push.apply(t,ro(arguments))}var i=[];function o(){var n="v"+e++;return i.push(n),arguments.length>0&&(t.push(n,"="),t.push.apply(t,ro(arguments)),t.push(";")),n}return n(r,{def:o,toString:function(){return io([i.length>0?"var "+i.join(",")+";":"",io(t)])}})}function s(){var t=a(),e=a(),r=t.toString,i=e.toString;function o(n,r){e(n,r,"=",t.def(n,r),";")}return n((function(){t.apply(t,ro(arguments))}),{def:t.def,entry:t,exit:e,save:o,set:function(e,n,r){o(e,n),t(e,n,"=",r,";")},toString:function(){return r()+i()}})}function u(){var t=io(arguments),e=s(),r=s(),i=e.toString,o=r.toString;return n(e,{then:function(){return e.apply(e,ro(arguments)),this},else:function(){return r.apply(r,ro(arguments)),this},toString:function(){var e=o();return e&&(e="else{"+e+"}"),io(["if(",t,"){",i(),"}",e])}})}var c=a(),l={};function h(t,e){var r=[];function i(){var t="a"+r.length;return r.push(t),t}e=e||0;for(var o=0;o<e;++o)i();var a=s(),u=a.toString;return l[t]=n(a,{arg:i,toString:function(){return io(["function(",r.join(),"){",u(),"}"])}})}function f(){var e=['"use strict";',c,"return {"];Object.keys(l).forEach((function(t){e.push('"',t,'":',l[t].toString(),",")})),e.push("}");var n=io(e).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return("undefined"!=typeof my&&my&&"function"==typeof my.showToast&&!0!==my.isFRM?t.Function.apply(null,r.concat(n)):Function.apply(null,r.concat(n))).apply(null,i)}return{global:c,link:o,block:a,proc:h,scope:s,cond:u,compile:f}}var ao="xyzw".split(""),so=5121,uo=1,co=2,lo=0,ho=1,fo=2,po=3,mo=4,vo=5,go=6,yo="dither",xo="blend.enable",bo="blend.color",_o="blend.equation",wo="blend.func",So="depth.enable",Mo="depth.func",Eo="depth.range",Ao="depth.mask",To="colorMask",Co="cull.enable",Oo="cull.face",ko="frontFace",Po="lineWidth",Lo="polygonOffset.enable",Ro="polygonOffset.offset",Io="sample.alpha",No="sample.enable",Do="sample.coverage",Fo="stencil.enable",jo="stencil.mask",Bo="stencil.func",zo="stencil.opFront",Uo="stencil.opBack",Vo="scissor.enable",Go="scissor.box",Wo="viewport",Ho="profile",Yo="framebuffer",Xo="vert",qo="frag",Zo="elements",$o="primitive",Ko="count",Jo="offset",Qo="instances",ta="vao",ea="Width",na="Height",ra=Yo+ea,ia=Yo+na,oa=Wo+ea,aa=Wo+na,sa="drawingBuffer",ua=sa+ea,ca=sa+na,la=[wo,_o,Bo,zo,Uo,Do,Wo,Go,Ro],ha=34962,fa=34963,pa=3553,da=34067,ma=2884,va=3042,ga=3024,ya=2960,xa=2929,ba=3089,_a=32823,wa=32926,Sa=32928,Ma=5126,Ea=35664,Aa=35665,Ta=35666,Ca=5124,Oa=35667,ka=35668,Pa=35669,La=35670,Ra=35671,Ia=35672,Na=35673,Da=35674,Fa=35675,ja=35676,Ba=35678,za=35680,Ua=4,Va=1028,Ga=1029,Wa=2304,Ha=2305,Ya=32775,Xa=32776,qa=519,Za=7680,$a=0,Ka=1,Ja=32774,Qa=513,ts=36160,es=36064,ns={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},rs=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],is={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},os={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},as={frag:35632,vert:35633},ss={cw:Wa,ccw:Ha};function us(t){return Array.isArray(t)||e(t)||Me(t)}function cs(t){return t.sort((function(t,e){return t===Wo?-1:e===Wo?1:t<e?-1:1}))}function ls(t,e,n,r){this.thisDep=t,this.contextDep=e,this.propDep=n,this.append=r}function hs(t){return t&&!(t.thisDep||t.contextDep||t.propDep)}function fs(t){return new ls(!1,!1,!1,t)}function ps(t,e){var n=t.type;if(n===lo){var r=t.data.length;return new ls(!0,r>=1,r>=2,e)}if(n===mo){var i=t.data;return new ls(i.thisDep,i.contextDep,i.propDep,e)}if(n===vo)return new ls(!1,!1,!1,e);if(n===go){for(var o=!1,a=!1,s=!1,u=0;u<t.data.length;++u){var c=t.data[u];if(c.type===ho)s=!0;else if(c.type===fo)a=!0;else if(c.type===po)o=!0;else if(c.type===lo){o=!0;var l=c.data;l>=1&&(a=!0),l>=2&&(s=!0)}else c.type===mo&&(o=o||c.data.thisDep,a=a||c.data.contextDep,s=s||c.data.propDep)}return new ls(o,a,s,e)}return new ls(n===po,n===fo,n===ho,e)}var ds=new ls(!1,!1,!1,(function(){}));function ms(t,e,r,i,o,a,s,u,c,l,h,f,p,d,m){var v=l.Record,g={add:32774,subtract:32778,"reverse subtract":32779};r.ext_blend_minmax&&(g.min=Ya,g.max=Xa);var y=r.angle_instanced_arrays,x=r.webgl_draw_buffers,b=r.oes_vertex_array_object,_={dirty:!0,profile:m.profile},w={},S=[],M={},E={};function A(t){return t.replace(".","_")}function T(t,e,n){var r=A(t);S.push(t),w[r]=_[r]=!!n,M[r]=e}function C(t,e,n){var r=A(t);S.push(t),Array.isArray(n)?(_[r]=n.slice(),w[r]=n.slice()):_[r]=w[r]=n,E[r]=e}T(yo,ga),T(xo,va),C(bo,"blendColor",[0,0,0,0]),C(_o,"blendEquationSeparate",[Ja,Ja]),C(wo,"blendFuncSeparate",[Ka,$a,Ka,$a]),T(So,xa,!0),C(Mo,"depthFunc",Qa),C(Eo,"depthRange",[0,1]),C(Ao,"depthMask",!0),C(To,To,[!0,!0,!0,!0]),T(Co,ma),C(Oo,"cullFace",Ga),C(ko,ko,Ha),C(Po,Po,1),T(Lo,_a),C(Ro,"polygonOffset",[0,0]),T(Io,wa),T(No,Sa),C(Do,"sampleCoverage",[1,!1]),T(Fo,ya),C(jo,"stencilMask",-1),C(Bo,"stencilFunc",[qa,0,-1]),C(zo,"stencilOpSeparate",[Va,Za,Za,Za]),C(Uo,"stencilOpSeparate",[Ga,Za,Za,Za]),T(Vo,ba),C(Go,"scissor",[0,0,t.drawingBufferWidth,t.drawingBufferHeight]),C(Wo,Wo,[0,0,t.drawingBufferWidth,t.drawingBufferHeight]);var O={gl:t,context:p,strings:e,next:w,current:_,draw:f,elements:a,buffer:o,shader:h,attributes:l.state,vao:l,uniforms:c,framebuffer:u,extensions:r,timer:d,isBufferArgs:us},k={primTypes:Xe,compareFuncs:is,blendFuncs:ns,blendEquations:g,stencilOps:os,glTypes:Ie,orientationType:ss};rt.optional((function(){O.isArrayLike=fn})),x&&(k.backBuffer=[Ga],k.drawBuffer=Tt(i.maxDrawbuffers,(function(t){return 0===t?[0]:Tt(t,(function(t){return es+t}))})));var P=0;function L(){var t=oo(),n=t.link,r=t.global;t.id=P++,t.batchId="0";var i=n(O),o=t.shared={props:"a0"};Object.keys(O).forEach((function(t){o[t]=r.def(i,".",t)})),rt.optional((function(){t.CHECK=n(rt),t.commandStr=rt.guessCommand(),t.command=n(t.commandStr),t.assert=function(t,e,r){t("if(!(",e,"))",this.CHECK,".commandRaise(",n(r),",",this.command,");")},k.invalidBlendCombinations=rs}));var a=t.next={},s=t.current={};Object.keys(E).forEach((function(t){Array.isArray(_[t])&&(a[t]=r.def(o.next,".",t),s[t]=r.def(o.current,".",t))}));var u=t.constants={};Object.keys(k).forEach((function(t){u[t]=r.def(JSON.stringify(k[t]))})),t.invoke=function(e,r){switch(r.type){case lo:var i=["this",o.context,o.props,t.batchId];return e.def(n(r.data),".call(",i.slice(0,Math.max(r.data.length+1,4)),")");case ho:return e.def(o.props,r.data);case fo:return e.def(o.context,r.data);case po:return e.def("this",r.data);case mo:return r.data.append(t,e),r.data.ref;case vo:return r.data.toString();case go:return r.data.map((function(n){return t.invoke(e,n)}))}},t.attribCache={};var c={};return t.scopeAttrib=function(t){var r=e.id(t);if(r in c)return c[r];var i=l.scope[r];return i||(i=l.scope[r]=new v),c[r]=n(i)},t}function R(t){var e,n=t.static,r=t.dynamic;if(Ho in n){var i=!!n[Ho];(e=fs((function(t,e){return i}))).enable=i}else if(Ho in r){var o=r[Ho];e=ps(o,(function(t,e){return t.invoke(e,o)}))}return e}function I(t,e){var n=t.static,r=t.dynamic;if(Yo in n){var i=n[Yo];return i?(i=u.getFramebuffer(i),rt.command(i,"invalid framebuffer object"),fs((function(t,e){var n=t.link(i),r=t.shared;e.set(r.framebuffer,".next",n);var o=r.context;return e.set(o,"."+ra,n+".width"),e.set(o,"."+ia,n+".height"),n}))):fs((function(t,e){var n=t.shared;e.set(n.framebuffer,".next","null");var r=n.context;return e.set(r,"."+ra,r+"."+ua),e.set(r,"."+ia,r+"."+ca),"null"}))}if(Yo in r){var o=r[Yo];return ps(o,(function(t,e){var n=t.invoke(e,o),r=t.shared,i=r.framebuffer,a=e.def(i,".getFramebuffer(",n,")");rt.optional((function(){t.assert(e,"!"+n+"||"+a,"invalid framebuffer object")})),e.set(i,".next",a);var s=r.context;return e.set(s,"."+ra,a+"?"+a+".width:"+s+"."+ua),e.set(s,"."+ia,a+"?"+a+".height:"+s+"."+ca),a}))}return null}function N(t,e,n){var r=t.static,i=t.dynamic;function o(t){if(t in r){var o=r[t];rt.commandType(o,"object","invalid "+t,n.commandStr);var a,s,u=!0,c=0|o.x,l=0|o.y;return"width"in o?(a=0|o.width,rt.command(a>=0,"invalid "+t,n.commandStr)):u=!1,"height"in o?(s=0|o.height,rt.command(s>=0,"invalid "+t,n.commandStr)):u=!1,new ls(!u&&e&&e.thisDep,!u&&e&&e.contextDep,!u&&e&&e.propDep,(function(t,e){var n=t.shared.context,r=a;"width"in o||(r=e.def(n,".",ra,"-",c));var i=s;return"height"in o||(i=e.def(n,".",ia,"-",l)),[c,l,r,i]}))}if(t in i){var h=i[t],f=ps(h,(function(e,n){var r=e.invoke(n,h);rt.optional((function(){e.assert(n,r+"&&typeof "+r+'==="object"',"invalid "+t)}));var i=e.shared.context,o=n.def(r,".x|0"),a=n.def(r,".y|0"),s=n.def('"width" in ',r,"?",r,".width|0:","(",i,".",ra,"-",o,")"),u=n.def('"height" in ',r,"?",r,".height|0:","(",i,".",ia,"-",a,")");return rt.optional((function(){e.assert(n,s+">=0&&"+u+">=0","invalid "+t)})),[o,a,s,u]}));return e&&(f.thisDep=f.thisDep||e.thisDep,f.contextDep=f.contextDep||e.contextDep,f.propDep=f.propDep||e.propDep),f}return e?new ls(e.thisDep,e.contextDep,e.propDep,(function(t,e){var n=t.shared.context;return[0,0,e.def(n,".",ra),e.def(n,".",ia)]})):null}var a=o(Wo);if(a){var s=a;a=new ls(a.thisDep,a.contextDep,a.propDep,(function(t,e){var n=s.append(t,e),r=t.shared.context;return e.set(r,"."+oa,n[2]),e.set(r,"."+aa,n[3]),n}))}return{viewport:a,scissor_box:o(Go)}}function D(t,e){var n=t.static;if("string"==typeof n[qo]&&"string"==typeof n[Xo]){if(Object.keys(e.dynamic).length>0)return null;var r=e.static,i=Object.keys(r);if(i.length>0&&"number"==typeof r[i[0]]){for(var o=[],a=0;a<i.length;++a)rt("number"==typeof r[i[a]],"must specify all vertex attribute locations when using vaos"),o.push([0|r[i[a]],i[a]]);return o}}return null}function F(t,n,r){var i=t.static,o=t.dynamic;function a(t){if(t in i){var n=e.id(i[t]);rt.optional((function(){h.shader(as[t],n,rt.guessCommand())}));var r=fs((function(){return n}));return r.id=n,r}if(t in o){var a=o[t];return ps(a,(function(e,n){var r=e.invoke(n,a),i=n.def(e.shared.strings,".id(",r,")");return rt.optional((function(){n(e.shared.shader,".shader(",as[t],",",i,",",e.command,");")})),i}))}return null}var s,u=a(qo),c=a(Xo),l=null;return hs(u)&&hs(c)?(l=h.program(c.id,u.id,null,r),s=fs((function(t,e){return t.link(l)}))):s=new ls(u&&u.thisDep||c&&c.thisDep,u&&u.contextDep||c&&c.contextDep,u&&u.propDep||c&&c.propDep,(function(t,e){var n,r=t.shared.shader;n=u?u.append(t,e):e.def(r,".",qo);var i=r+".program("+(c?c.append(t,e):e.def(r,".",Xo))+","+n;return rt.optional((function(){i+=","+t.command})),e.def(i+")")})),{frag:u,vert:c,progVar:s,program:l}}function j(t,e){var n=t.static,r=t.dynamic,i={},o=!1;function s(){if(ta in n){var t=n[ta];return null!==t&&null===l.getVAO(t)&&(t=l.createVAO(t)),o=!0,i.vao=t,fs((function(e){var n=l.getVAO(t);return n?e.link(n):"null"}))}if(ta in r){o=!0;var e=r[ta];return ps(e,(function(t,n){var r=t.invoke(n,e);return n.def(t.shared.vao+".getVAO("+r+")")}))}return null}var u=s(),c=!1;function h(){if(Zo in n){var t=n[Zo];if(i.elements=t,us(t)){var s=i.elements=a.create(t,!0);t=a.getElements(s),c=!0}else t&&(t=a.getElements(t),c=!0,rt.command(t,"invalid elements",e.commandStr));var l=fs((function(e,n){if(t){var r=e.link(t);return e.ELEMENTS=r,r}return e.ELEMENTS=null,null}));return l.value=t,l}if(Zo in r){c=!0;var h=r[Zo];return ps(h,(function(t,e){var n=t.shared,r=n.isBufferArgs,i=n.elements,o=t.invoke(e,h),a=e.def("null"),s=e.def(r,"(",o,")"),u=t.cond(s).then(a,"=",i,".createStream(",o,");").else(a,"=",i,".getElements(",o,");");return rt.optional((function(){t.assert(u.else,"!"+o+"||"+a,"invalid elements")})),e.entry(u),e.exit(t.cond(s).then(i,".destroyStream(",a,");")),t.ELEMENTS=a,a}))}return o?new ls(u.thisDep,u.contextDep,u.propDep,(function(t,e){return e.def(t.shared.vao+".currentVAO?"+t.shared.elements+".getElements("+t.shared.vao+".currentVAO.elements):null")})):null}var f=h();function p(){if($o in n){var t=n[$o];return i.primitive=t,rt.commandParameter(t,Xe,"invalid primitve",e.commandStr),fs((function(e,n){return Xe[t]}))}if($o in r){var a=r[$o];return ps(a,(function(t,e){var n=t.constants.primTypes,r=t.invoke(e,a);return rt.optional((function(){t.assert(e,r+" in "+n,"invalid primitive, must be one of "+Object.keys(Xe))})),e.def(n,"[",r,"]")}))}return c?hs(f)?f.value?fs((function(t,e){return e.def(t.ELEMENTS,".primType")})):fs((function(){return Ua})):new ls(f.thisDep,f.contextDep,f.propDep,(function(t,e){var n=t.ELEMENTS;return e.def(n,"?",n,".primType:",Ua)})):o?new ls(u.thisDep,u.contextDep,u.propDep,(function(t,e){return e.def(t.shared.vao+".currentVAO?"+t.shared.vao+".currentVAO.primitive:"+Ua)})):null}function d(t,a){if(t in n){var s=0|n[t];return a?i.offset=s:i.instances=s,rt.command(!a||s>=0,"invalid "+t,e.commandStr),fs((function(t,e){return a&&(t.OFFSET=s),s}))}if(t in r){var l=r[t];return ps(l,(function(e,n){var r=e.invoke(n,l);return a&&(e.OFFSET=r,rt.optional((function(){e.assert(n,r+">=0","invalid "+t)}))),r}))}if(a){if(c)return fs((function(t,e){return t.OFFSET=0,0}));if(o)return new ls(u.thisDep,u.contextDep,u.propDep,(function(t,e){return e.def(t.shared.vao+".currentVAO?"+t.shared.vao+".currentVAO.offset:0")}))}else if(o)return new ls(u.thisDep,u.contextDep,u.propDep,(function(t,e){return e.def(t.shared.vao+".currentVAO?"+t.shared.vao+".currentVAO.instances:-1")}));return null}var m=d(Jo,!0);function v(){if(Ko in n){var t=0|n[Ko];return i.count=t,rt.command("number"==typeof t&&t>=0,"invalid vertex count",e.commandStr),fs((function(){return t}))}if(Ko in r){var a=r[Ko];return ps(a,(function(t,e){var n=t.invoke(e,a);return rt.optional((function(){t.assert(e,"typeof "+n+'==="number"&&'+n+">=0&&"+n+"===("+n+"|0)","invalid vertex count")})),n}))}if(c){if(hs(f)){if(f)return m?new ls(m.thisDep,m.contextDep,m.propDep,(function(t,e){var n=e.def(t.ELEMENTS,".vertCount-",t.OFFSET);return rt.optional((function(){t.assert(e,n+">=0","invalid vertex offset/element buffer too small")})),n})):fs((function(t,e){return e.def(t.ELEMENTS,".vertCount")}));var s=fs((function(){return-1}));return rt.optional((function(){s.MISSING=!0})),s}var l=new ls(f.thisDep||m.thisDep,f.contextDep||m.contextDep,f.propDep||m.propDep,(function(t,e){var n=t.ELEMENTS;return t.OFFSET?e.def(n,"?",n,".vertCount-",t.OFFSET,":-1"):e.def(n,"?",n,".vertCount:-1")}));return rt.optional((function(){l.DYNAMIC=!0})),l}return o?new ls(u.thisDep,u.contextDep,u.propDep,(function(t,e){return e.def(t.shared.vao,".currentVAO?",t.shared.vao,".currentVAO.count:-1")})):null}var g=p(),y=v(),x=d(Qo,!1);return{elements:f,primitive:g,count:y,instances:x,offset:m,vao:u,vaoActive:o,elementsActive:c,static:i}}function B(t,e){var n=t.static,r=t.dynamic,o={};return S.forEach((function(t){var a=A(t);function s(e,i){if(t in n){var s=e(n[t]);o[a]=fs((function(){return s}))}else if(t in r){var u=r[t];o[a]=ps(u,(function(t,e){return i(t,e,t.invoke(e,u))}))}}switch(t){case Co:case xo:case yo:case Fo:case So:case Vo:case Lo:case Io:case No:case Ao:return s((function(n){return rt.commandType(n,"boolean",t,e.commandStr),n}),(function(e,n,r){return rt.optional((function(){e.assert(n,"typeof "+r+'==="boolean"',"invalid flag "+t,e.commandStr)})),r}));case Mo:return s((function(n){return rt.commandParameter(n,is,"invalid "+t,e.commandStr),is[n]}),(function(e,n,r){var i=e.constants.compareFuncs;return rt.optional((function(){e.assert(n,r+" in "+i,"invalid "+t+", must be one of "+Object.keys(is))})),n.def(i,"[",r,"]")}));case Eo:return s((function(t){return rt.command(fn(t)&&2===t.length&&"number"==typeof t[0]&&"number"==typeof t[1]&&t[0]<=t[1],"depth range is 2d array",e.commandStr),t}),(function(t,e,n){return rt.optional((function(){t.assert(e,t.shared.isArrayLike+"("+n+")&&"+n+".length===2&&typeof "+n+'[0]==="number"&&typeof '+n+'[1]==="number"&&'+n+"[0]<="+n+"[1]","depth range must be a 2d array")})),[e.def("+",n,"[0]"),e.def("+",n,"[1]")]}));case wo:return s((function(t){rt.commandType(t,"object","blend.func",e.commandStr);var n="srcRGB"in t?t.srcRGB:t.src,r="srcAlpha"in t?t.srcAlpha:t.src,i="dstRGB"in t?t.dstRGB:t.dst,o="dstAlpha"in t?t.dstAlpha:t.dst;return rt.commandParameter(n,ns,a+".srcRGB",e.commandStr),rt.commandParameter(r,ns,a+".srcAlpha",e.commandStr),rt.commandParameter(i,ns,a+".dstRGB",e.commandStr),rt.commandParameter(o,ns,a+".dstAlpha",e.commandStr),rt.command(-1===rs.indexOf(n+", "+i),"unallowed blending combination (srcRGB, dstRGB) = ("+n+", "+i+")",e.commandStr),[ns[n],ns[i],ns[r],ns[o]]}),(function(e,n,r){var i=e.constants.blendFuncs;function o(o,a){var s=n.def('"',o,a,'" in ',r,"?",r,".",o,a,":",r,".",o);return rt.optional((function(){e.assert(n,s+" in "+i,"invalid "+t+"."+o+a+", must be one of "+Object.keys(ns))})),s}rt.optional((function(){e.assert(n,r+"&&typeof "+r+'==="object"',"invalid blend func, must be an object")}));var a=o("src","RGB"),s=o("dst","RGB");rt.optional((function(){var t=e.constants.invalidBlendCombinations;e.assert(n,t+".indexOf("+a+'+", "+'+s+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")}));var u=n.def(i,"[",a,"]"),c=n.def(i,"[",o("src","Alpha"),"]");return[u,n.def(i,"[",s,"]"),c,n.def(i,"[",o("dst","Alpha"),"]")]}));case _o:return s((function(n){return"string"==typeof n?(rt.commandParameter(n,g,"invalid "+t,e.commandStr),[g[n],g[n]]):"object"==typeof n?(rt.commandParameter(n.rgb,g,t+".rgb",e.commandStr),rt.commandParameter(n.alpha,g,t+".alpha",e.commandStr),[g[n.rgb],g[n.alpha]]):void rt.commandRaise("invalid blend.equation",e.commandStr)}),(function(e,n,r){var i=e.constants.blendEquations,o=n.def(),a=n.def(),s=e.cond("typeof ",r,'==="string"');return rt.optional((function(){function n(t,n,r){e.assert(t,r+" in "+i,"invalid "+n+", must be one of "+Object.keys(g))}n(s.then,t,r),e.assert(s.else,r+"&&typeof "+r+'==="object"',"invalid "+t),n(s.else,t+".rgb",r+".rgb"),n(s.else,t+".alpha",r+".alpha")})),s.then(o,"=",a,"=",i,"[",r,"];"),s.else(o,"=",i,"[",r,".rgb];",a,"=",i,"[",r,".alpha];"),n(s),[o,a]}));case bo:return s((function(t){return rt.command(fn(t)&&4===t.length,"blend.color must be a 4d array",e.commandStr),Tt(4,(function(e){return+t[e]}))}),(function(t,e,n){return rt.optional((function(){t.assert(e,t.shared.isArrayLike+"("+n+")&&"+n+".length===4","blend.color must be a 4d array")})),Tt(4,(function(t){return e.def("+",n,"[",t,"]")}))}));case jo:return s((function(t){return rt.commandType(t,"number",a,e.commandStr),0|t}),(function(t,e,n){return rt.optional((function(){t.assert(e,"typeof "+n+'==="number"',"invalid stencil.mask")})),e.def(n,"|0")}));case Bo:return s((function(n){rt.commandType(n,"object",a,e.commandStr);var r=n.cmp||"keep",i=n.ref||0,o="mask"in n?n.mask:-1;return rt.commandParameter(r,is,t+".cmp",e.commandStr),rt.commandType(i,"number",t+".ref",e.commandStr),rt.commandType(o,"number",t+".mask",e.commandStr),[is[r],i,o]}),(function(t,e,n){var r=t.constants.compareFuncs;return rt.optional((function(){function i(){t.assert(e,Array.prototype.join.call(arguments,""),"invalid stencil.func")}i(n+"&&typeof ",n,'==="object"'),i('!("cmp" in ',n,")||(",n,".cmp in ",r,")")})),[e.def('"cmp" in ',n,"?",r,"[",n,".cmp]",":",Za),e.def(n,".ref|0"),e.def('"mask" in ',n,"?",n,".mask|0:-1")]}));case zo:case Uo:return s((function(n){rt.commandType(n,"object",a,e.commandStr);var r=n.fail||"keep",i=n.zfail||"keep",o=n.zpass||"keep";return rt.commandParameter(r,os,t+".fail",e.commandStr),rt.commandParameter(i,os,t+".zfail",e.commandStr),rt.commandParameter(o,os,t+".zpass",e.commandStr),[t===Uo?Ga:Va,os[r],os[i],os[o]]}),(function(e,n,r){var i=e.constants.stencilOps;function o(o){return rt.optional((function(){e.assert(n,'!("'+o+'" in '+r+")||("+r+"."+o+" in "+i+")","invalid "+t+"."+o+", must be one of "+Object.keys(os))})),n.def('"',o,'" in ',r,"?",i,"[",r,".",o,"]:",Za)}return rt.optional((function(){e.assert(n,r+"&&typeof "+r+'==="object"',"invalid "+t)})),[t===Uo?Ga:Va,o("fail"),o("zfail"),o("zpass")]}));case Ro:return s((function(t){rt.commandType(t,"object",a,e.commandStr);var n=0|t.factor,r=0|t.units;return rt.commandType(n,"number",a+".factor",e.commandStr),rt.commandType(r,"number",a+".units",e.commandStr),[n,r]}),(function(e,n,r){return rt.optional((function(){e.assert(n,r+"&&typeof "+r+'==="object"',"invalid "+t)})),[n.def(r,".factor|0"),n.def(r,".units|0")]}));case Oo:return s((function(t){var n=0;return"front"===t?n=Va:"back"===t&&(n=Ga),rt.command(!!n,a,e.commandStr),n}),(function(t,e,n){return rt.optional((function(){t.assert(e,n+'==="front"||'+n+'==="back"',"invalid cull.face")})),e.def(n,'==="front"?',Va,":",Ga)}));case Po:return s((function(t){return rt.command("number"==typeof t&&t>=i.lineWidthDims[0]&&t<=i.lineWidthDims[1],"invalid line width, must be a positive number between "+i.lineWidthDims[0]+" and "+i.lineWidthDims[1],e.commandStr),t}),(function(t,e,n){return rt.optional((function(){t.assert(e,"typeof "+n+'==="number"&&'+n+">="+i.lineWidthDims[0]+"&&"+n+"<="+i.lineWidthDims[1],"invalid line width")})),n}));case ko:return s((function(t){return rt.commandParameter(t,ss,a,e.commandStr),ss[t]}),(function(t,e,n){return rt.optional((function(){t.assert(e,n+'==="cw"||'+n+'==="ccw"',"invalid frontFace, must be one of cw,ccw")})),e.def(n+'==="cw"?'+Wa+":"+Ha)}));case To:return s((function(t){return rt.command(fn(t)&&4===t.length,"color.mask must be length 4 array",e.commandStr),t.map((function(t){return!!t}))}),(function(t,e,n){return rt.optional((function(){t.assert(e,t.shared.isArrayLike+"("+n+")&&"+n+".length===4","invalid color.mask")})),Tt(4,(function(t){return"!!"+n+"["+t+"]"}))}));case Do:return s((function(t){rt.command("object"==typeof t&&t,a,e.commandStr);var n="value"in t?t.value:1,r=!!t.invert;return rt.command("number"==typeof n&&n>=0&&n<=1,"sample.coverage.value must be a number between 0 and 1",e.commandStr),[n,r]}),(function(t,e,n){return rt.optional((function(){t.assert(e,n+"&&typeof "+n+'==="object"',"invalid sample.coverage")})),[e.def('"value" in ',n,"?+",n,".value:1"),e.def("!!",n,".invert")]}))}})),o}function z(t,e){var n=t.static,r=t.dynamic,i={};return Object.keys(n).forEach((function(t){var r,o=n[t];if("number"==typeof o||"boolean"==typeof o)r=fs((function(){return o}));else if("function"==typeof o){var a=o._reglType;"texture2d"===a||"textureCube"===a?r=fs((function(t){return t.link(o)})):"framebuffer"===a||"framebufferCube"===a?(rt.command(o.color.length>0,'missing color attachment for framebuffer sent to uniform "'+t+'"',e.commandStr),r=fs((function(t){return t.link(o.color[0])}))):rt.commandRaise('invalid data for uniform "'+t+'"',e.commandStr)}else fn(o)?r=fs((function(e){var n=e.global.def("[",Tt(o.length,(function(n){return rt.command("number"==typeof o[n]||"boolean"==typeof o[n],"invalid uniform "+t,e.commandStr),o[n]})),"]");return n})):rt.commandRaise('invalid or missing data for uniform "'+t+'"',e.commandStr);r.value=o,i[t]=r})),Object.keys(r).forEach((function(t){var e=r[t];i[t]=ps(e,(function(t,n){return t.invoke(n,e)}))})),i}function U(t,n){var r=t.static,i=t.dynamic,a={};return Object.keys(r).forEach((function(t){var i=r[t],s=e.id(t),u=new v;if(us(i))u.state=uo,u.buffer=o.getBuffer(o.create(i,ha,!1,!0)),u.type=0;else{var c=o.getBuffer(i);if(c)u.state=uo,u.buffer=c,u.type=0;else if(rt.command("object"==typeof i&&i,"invalid data for attribute "+t,n.commandStr),"constant"in i){var l=i.constant;u.buffer="null",u.state=co,"number"==typeof l?u.x=l:(rt.command(fn(l)&&l.length>0&&l.length<=4,"invalid constant for attribute "+t,n.commandStr),ao.forEach((function(t,e){e<l.length&&(u[t]=l[e])})))}else{c=us(i.buffer)?o.getBuffer(o.create(i.buffer,ha,!1,!0)):o.getBuffer(i.buffer),rt.command(!!c,'missing buffer for attribute "'+t+'"',n.commandStr);var h=0|i.offset;rt.command(h>=0,'invalid offset for attribute "'+t+'"',n.commandStr);var f=0|i.stride;rt.command(f>=0&&f<256,'invalid stride for attribute "'+t+'", must be integer betweeen [0, 255]',n.commandStr);var p=0|i.size;rt.command(!("size"in i)||p>0&&p<=4,'invalid size for attribute "'+t+'", must be 1,2,3,4',n.commandStr);var d=!!i.normalized,m=0;"type"in i&&(rt.commandParameter(i.type,Ie,"invalid type for attribute "+t,n.commandStr),m=Ie[i.type]);var g=0|i.divisor;rt.optional((function(){"divisor"in i&&(rt.command(0===g||y,'cannot specify divisor for attribute "'+t+'", instancing not supported',n.commandStr),rt.command(g>=0,'invalid divisor for attribute "'+t+'"',n.commandStr));var e=n.commandStr,r=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(i).forEach((function(n){rt.command(r.indexOf(n)>=0,'unknown parameter "'+n+'" for attribute pointer "'+t+'" (valid parameters are '+r+")",e)}))})),u.buffer=c,u.state=uo,u.size=p,u.normalized=d,u.type=m||c.dtype,u.offset=h,u.stride=f,u.divisor=g}}a[t]=fs((function(t,e){var n=t.attribCache;if(s in n)return n[s];var r={isStream:!1};return Object.keys(u).forEach((function(t){r[t]=u[t]})),u.buffer&&(r.buffer=t.link(u.buffer),r.type=r.type||r.buffer+".dtype"),n[s]=r,r}))})),Object.keys(i).forEach((function(t){var e=i[t];function n(n,r){var i=n.invoke(r,e),o=n.shared,a=n.constants,s=o.isBufferArgs,u=o.buffer;rt.optional((function(){n.assert(r,i+"&&(typeof "+i+'==="object"||typeof '+i+'==="function")&&('+s+"("+i+")||"+u+".getBuffer("+i+")||"+u+".getBuffer("+i+".buffer)||"+s+"("+i+'.buffer)||("constant" in '+i+"&&(typeof "+i+'.constant==="number"||'+o.isArrayLike+"("+i+".constant))))",'invalid dynamic attribute "'+t+'"')}));var c={isStream:r.def(!1)},l=new v;l.state=uo,Object.keys(l).forEach((function(t){c[t]=r.def(""+l[t])}));var h=c.buffer,f=c.type;function p(t){r(c[t],"=",i,".",t,"|0;")}return r("if(",s,"(",i,")){",c.isStream,"=true;",h,"=",u,".createStream(",ha,",",i,");",f,"=",h,".dtype;","}else{",h,"=",u,".getBuffer(",i,");","if(",h,"){",f,"=",h,".dtype;",'}else if("constant" in ',i,"){",c.state,"=",co,";","if(typeof "+i+'.constant === "number"){',c[ao[0]],"=",i,".constant;",ao.slice(1).map((function(t){return c[t]})).join("="),"=0;","}else{",ao.map((function(t,e){return c[t]+"="+i+".constant.length>"+e+"?"+i+".constant["+e+"]:0;"})).join(""),"}}else{","if(",s,"(",i,".buffer)){",h,"=",u,".createStream(",ha,",",i,".buffer);","}else{",h,"=",u,".getBuffer(",i,".buffer);","}",f,'="type" in ',i,"?",a.glTypes,"[",i,".type]:",h,".dtype;",c.normalized,"=!!",i,".normalized;"),p("size"),p("offset"),p("stride"),p("divisor"),r("}}"),r.exit("if(",c.isStream,"){",u,".destroyStream(",h,");","}"),c}a[t]=ps(e,n)})),a}function V(t){var e=t.static,n=t.dynamic,r={};return Object.keys(e).forEach((function(t){var n=e[t];r[t]=fs((function(t,e){return"number"==typeof n||"boolean"==typeof n?""+n:t.link(n)}))})),Object.keys(n).forEach((function(t){var e=n[t];r[t]=ps(e,(function(t,n){return t.invoke(n,e)}))})),r}function G(t,e,n,i,o){var a=t.static,s=t.dynamic;rt.optional((function(){var t=[Yo,Xo,qo,Zo,$o,Jo,Ko,Qo,Ho,ta].concat(S);function e(e){Object.keys(e).forEach((function(e){rt.command(t.indexOf(e)>=0,'unknown parameter "'+e+'"',o.commandStr)}))}e(a),e(s)}));var u=D(t,e),c=I(t),h=N(t,c,o),f=j(t,o),p=B(t,o),d=F(t,o,u);function m(t){var e=h[t];e&&(p[t]=e)}m(Wo),m(A(Go));var v=Object.keys(p).length>0,g={framebuffer:c,draw:f,shader:d,state:p,dirty:v,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(g.profile=R(t),g.uniforms=z(n,o),g.drawVAO=g.scopeVAO=f.vao,!g.drawVAO&&d.program&&!u&&r.angle_instanced_arrays&&f.static.elements){var y=!0,x=d.program.attributes.map((function(t){var n=e.static[t];return y=y&&!!n,n}));if(y&&x.length>0){var b=l.getVAO(l.createVAO({attributes:x,elements:f.static.elements}));g.drawVAO=new ls(null,null,null,(function(t,e){return t.link(b)})),g.useVAO=!0}}return u?g.useVAO=!0:g.attributes=U(e,o),g.context=V(i),g}function W(t,e,n){var r=t.shared.context,i=t.scope();Object.keys(n).forEach((function(o){e.save(r,"."+o);var a=n[o].append(t,e);Array.isArray(a)?i(r,".",o,"=[",a.join(),"];"):i(r,".",o,"=",a,";")})),e(i)}function H(t,e,n,r){var i,o=t.shared,a=o.gl,s=o.framebuffer;x&&(i=e.def(o.extensions,".webgl_draw_buffers"));var u,c=t.constants,l=c.drawBuffer,h=c.backBuffer;u=n?n.append(t,e):e.def(s,".next"),r||e("if(",u,"!==",s,".cur){"),e("if(",u,"){",a,".bindFramebuffer(",ts,",",u,".framebuffer);"),x&&e(i,".drawBuffersWEBGL(",l,"[",u,".colorAttachments.length]);"),e("}else{",a,".bindFramebuffer(",ts,",null);"),x&&e(i,".drawBuffersWEBGL(",h,");"),e("}",s,".cur=",u,";"),r||e("}")}function Y(t,e,n){var r=t.shared,i=r.gl,o=t.current,a=t.next,s=r.current,u=r.next,c=t.cond(s,".dirty");S.forEach((function(e){var r,l,h=A(e);if(!(h in n.state))if(h in a){r=a[h],l=o[h];var f=Tt(_[h].length,(function(t){return c.def(r,"[",t,"]")}));c(t.cond(f.map((function(t,e){return t+"!=="+l+"["+e+"]"})).join("||")).then(i,".",E[h],"(",f,");",f.map((function(t,e){return l+"["+e+"]="+t})).join(";"),";"))}else{r=c.def(u,".",h);var p=t.cond(r,"!==",s,".",h);c(p),h in M?p(t.cond(r).then(i,".enable(",M[h],");").else(i,".disable(",M[h],");"),s,".",h,"=",r,";"):p(i,".",E[h],"(",r,");",s,".",h,"=",r,";")}})),0===Object.keys(n.state).length&&c(s,".dirty=false;"),e(c)}function X(t,e,n,r){var i=t.shared,o=t.current,a=i.current,s=i.gl;cs(Object.keys(n)).forEach((function(i){var u=n[i];if(!r||r(u)){var c=u.append(t,e);if(M[i]){var l=M[i];hs(u)?e(s,c?".enable(":".disable(",l,");"):e(t.cond(c).then(s,".enable(",l,");").else(s,".disable(",l,");")),e(a,".",i,"=",c,";")}else if(fn(c)){var h=o[i];e(s,".",E[i],"(",c,");",c.map((function(t,e){return h+"["+e+"]="+t})).join(";"),";")}else e(s,".",E[i],"(",c,");",a,".",i,"=",c,";")}}))}function q(t,e){y&&(t.instancing=e.def(t.shared.extensions,".angle_instanced_arrays"))}function Z(t,e,n,r,i){var o,a,s,u=t.shared,c=t.stats,l=u.current,h=u.timer,f=n.profile;function p(){return"undefined"!=typeof my&&my&&"function"==typeof my.showToast&&!0!==my.isFRM||"undefined"==typeof performance?"Date.now()":"performance.now()"}function m(t){t(o=e.def(),"=",p(),";"),"string"==typeof i?t(c,".count+=",i,";"):t(c,".count++;"),d&&(r?t(a=e.def(),"=",h,".getNumPendingQueries();"):t(h,".beginQuery(",c,");"))}function v(t){t(c,".cpuTime+=",p(),"-",o,";"),d&&(r?t(h,".pushScopeStats(",a,",",h,".getNumPendingQueries(),",c,");"):t(h,".endQuery();"))}function g(t){var n=e.def(l,".profile");e(l,".profile=",t,";"),e.exit(l,".profile=",n,";")}if(f){if(hs(f))return void(f.enable?(m(e),v(e.exit),g("true")):g("false"));g(s=f.append(t,e))}else s=e.def(l,".profile");var y=t.block();m(y),e("if(",s,"){",y,"}");var x=t.block();v(x),e.exit("if(",s,"){",x,"}")}function $(t,e,n,r,i){var o=t.shared;function a(t){switch(t){case Ea:case Oa:case Ra:return 2;case Aa:case ka:case Ia:return 3;case Ta:case Pa:case Na:return 4;default:return 1}}function s(n,r,i){var a=o.gl,s=e.def(n,".location"),u=e.def(o.attributes,"[",s,"]"),c=i.state,l=i.buffer,h=[i.x,i.y,i.z,i.w],f=["buffer","normalized","offset","stride"];function p(){e("if(!",u,".buffer){",a,".enableVertexAttribArray(",s,");}");var n,o=i.type;if(n=i.size?e.def(i.size,"||",r):r,e("if(",u,".type!==",o,"||",u,".size!==",n,"||",f.map((function(t){return u+"."+t+"!=="+i[t]})).join("||"),"){",a,".bindBuffer(",ha,",",l,".buffer);",a,".vertexAttribPointer(",[s,n,o,i.normalized,i.stride,i.offset],");",u,".type=",o,";",u,".size=",n,";",f.map((function(t){return u+"."+t+"="+i[t]+";"})).join(""),"}"),y){var c=i.divisor;e("if(",u,".divisor!==",c,"){",t.instancing,".vertexAttribDivisorANGLE(",[s,c],");",u,".divisor=",c,";}")}}function d(){e("if(",u,".buffer){",a,".disableVertexAttribArray(",s,");",u,".buffer=null;","}if(",ao.map((function(t,e){return u+"."+t+"!=="+h[e]})).join("||"),"){",a,".vertexAttrib4f(",s,",",h,");",ao.map((function(t,e){return u+"."+t+"="+h[e]+";"})).join(""),"}")}c===uo?p():c===co?d():(e("if(",c,"===",uo,"){"),p(),e("}else{"),d(),e("}"))}r.forEach((function(r){var o,u=r.name,c=n.attributes[u];if(c){if(!i(c))return;o=c.append(t,e)}else{if(!i(ds))return;var l=t.scopeAttrib(u);rt.optional((function(){t.assert(e,l+".state","missing attribute "+u)})),o={},Object.keys(new v).forEach((function(t){o[t]=e.def(l,".",t)}))}s(t.link(r),a(r.info.type),o)}))}function K(t,n,r,i,o,a){for(var s,u=t.shared,c=u.gl,l=0;l<i.length;++l){var h,f=i[l],p=f.name,d=f.info.type,m=r.uniforms[p],v=t.link(f)+".location";if(m){if(!o(m))continue;if(hs(m)){var g=m.value;if(rt.command(null!=g,'missing uniform "'+p+'"',t.commandStr),d===Ba||d===za){rt.command("function"==typeof g&&(d===Ba&&("texture2d"===g._reglType||"framebuffer"===g._reglType)||d===za&&("textureCube"===g._reglType||"framebufferCube"===g._reglType)),"invalid texture for uniform "+p,t.commandStr);var y=t.link(g._texture||g.color[0]._texture);n(c,".uniform1i(",v,",",y+".bind());"),n.exit(y,".unbind();")}else if(d===Da||d===Fa||d===ja){rt.optional((function(){rt.command(fn(g),"invalid matrix for uniform "+p,t.commandStr),rt.command(d===Da&&4===g.length||d===Fa&&9===g.length||d===ja&&16===g.length,"invalid length for matrix uniform "+p,t.commandStr)}));var x=t.global.def("new Float32Array(["+Array.prototype.slice.call(g)+"])"),b=2;d===Fa?b=3:d===ja&&(b=4),n(c,".uniformMatrix",b,"fv(",v,",false,",x,");")}else{switch(d){case Ma:rt.commandType(g,"number","uniform "+p,t.commandStr),s="1f";break;case Ea:rt.command(fn(g)&&2===g.length,"uniform "+p,t.commandStr),s="2f";break;case Aa:rt.command(fn(g)&&3===g.length,"uniform "+p,t.commandStr),s="3f";break;case Ta:rt.command(fn(g)&&4===g.length,"uniform "+p,t.commandStr),s="4f";break;case La:rt.commandType(g,"boolean","uniform "+p,t.commandStr),s="1i";break;case Ca:rt.commandType(g,"number","uniform "+p,t.commandStr),s="1i";break;case Ra:case Oa:rt.command(fn(g)&&2===g.length,"uniform "+p,t.commandStr),s="2i";break;case Ia:case ka:rt.command(fn(g)&&3===g.length,"uniform "+p,t.commandStr),s="3i";break;case Na:case Pa:rt.command(fn(g)&&4===g.length,"uniform "+p,t.commandStr),s="4i"}n(c,".uniform",s,"(",v,",",fn(g)?Array.prototype.slice.call(g):g,");")}continue}h=m.append(t,n)}else{if(!o(ds))continue;h=n.def(u.uniforms,"[",e.id(p),"]")}d===Ba?(rt(!Array.isArray(h),"must specify a scalar prop for textures"),n("if(",h,"&&",h,'._reglType==="framebuffer"){',h,"=",h,".color[0];","}")):d===za&&(rt(!Array.isArray(h),"must specify a scalar prop for cube maps"),n("if(",h,"&&",h,'._reglType==="framebufferCube"){',h,"=",h,".color[0];","}")),rt.optional((function(){function e(e,r){t.assert(n,e,'bad data or missing for uniform "'+p+'".  '+r)}function r(t){rt(!Array.isArray(h),"must not specify an array type for uniform"),e("typeof "+h+'==="'+t+'"',"invalid type, expected "+t)}function i(n,r){Array.isArray(h)?rt(h.length===n,"must have length "+n):e(u.isArrayLike+"("+h+")&&"+h+".length==="+n,"invalid vector, should have length "+n,t.commandStr)}function o(n){rt(!Array.isArray(h),"must not specify a value type"),e("typeof "+h+'==="function"&&'+h+'._reglType==="texture'+(n===pa?"2d":"Cube")+'"',"invalid texture type",t.commandStr)}switch(d){case Ca:r("number");break;case Oa:i(2);break;case ka:i(3);break;case Pa:i(4);break;case Ma:r("number");break;case Ea:i(2);break;case Aa:i(3);break;case Ta:i(4);break;case La:r("boolean");break;case Ra:i(2);break;case Ia:i(3);break;case Na:case Da:i(4);break;case Fa:i(9);break;case ja:i(16);break;case Ba:o(pa);break;case za:o(da)}}));var _=1;switch(d){case Ba:case za:var w=n.def(h,"._texture");n(c,".uniform1i(",v,",",w,".bind());"),n.exit(w,".unbind();");continue;case Ca:case La:s="1i";break;case Oa:case Ra:s="2i",_=2;break;case ka:case Ia:s="3i",_=3;break;case Pa:case Na:s="4i",_=4;break;case Ma:s="1f";break;case Ea:s="2f",_=2;break;case Aa:s="3f",_=3;break;case Ta:s="4f",_=4;break;case Da:s="Matrix2fv";break;case Fa:s="Matrix3fv";break;case ja:s="Matrix4fv"}if("M"===s.charAt(0)){n(c,".uniform",s,"(",v,",");var S=Math.pow(d-Da+2,2),M=t.global.def("new Float32Array(",S,")");Array.isArray(h)?n("false,(",Tt(S,(function(t){return M+"["+t+"]="+h[t]})),",",M,")"):n("false,(Array.isArray(",h,")||",h," instanceof Float32Array)?",h,":(",Tt(S,(function(t){return M+"["+t+"]="+h+"["+t+"]"})),",",M,")"),n(");")}else if(_>1){for(var E=[],A=[],T=0;T<_;++T)Array.isArray(h)?A.push(h[T]):A.push(n.def(h+"["+T+"]")),a&&E.push(n.def());a&&n("if(!",t.batchId,"||",E.map((function(t,e){return t+"!=="+A[e]})).join("||"),"){",E.map((function(t,e){return t+"="+A[e]+";"})).join("")),n(c,".uniform",s,"(",v,",",A.join(","),");"),a&&n("}")}else{if(rt(!Array.isArray(h),"uniform value must not be an array"),a){var C=n.def();n("if(!",t.batchId,"||",C,"!==",h,"){",C,"=",h,";")}n(c,".uniform",s,"(",v,",",h,");"),a&&n("}")}}}function J(t,e,n,r){var i=t.shared,o=i.gl,a=i.draw,s=r.draw;function u(){var u,c=s.elements,l=e;return c?((c.contextDep&&r.contextDynamic||c.propDep)&&(l=n),u=c.append(t,l),s.elementsActive&&l("if("+u+")"+o+".bindBuffer("+fa+","+u+".buffer.buffer);")):(u=l.def(),l(u,"=",a,".",Zo,";","if(",u,"){",o,".bindBuffer(",fa,",",u,".buffer.buffer);}","else if(",i.vao,".currentVAO){",u,"=",t.shared.elements+".getElements("+i.vao,".currentVAO.elements);",b?"":"if("+u+")"+o+".bindBuffer("+fa+","+u+".buffer.buffer);","}")),u}function c(){var i,o=s.count,u=e;return o?((o.contextDep&&r.contextDynamic||o.propDep)&&(u=n),i=o.append(t,u),rt.optional((function(){o.MISSING&&t.assert(e,"false","missing vertex count"),o.DYNAMIC&&t.assert(u,i+">=0","missing vertex count")}))):(i=u.def(a,".",Ko),rt.optional((function(){t.assert(u,i+">=0","missing vertex count")}))),i}var l=u();function h(i){var o=s[i];return o?o.contextDep&&r.contextDynamic||o.propDep?o.append(t,n):o.append(t,e):e.def(a,".",i)}var f,p,d=h($o),m=h(Jo),v=c();if("number"==typeof v){if(0===v)return}else n("if(",v,"){"),n.exit("}");y&&(f=h(Qo),p=t.instancing);var g=l+".type",x=s.elements&&hs(s.elements)&&!s.vaoActive;function _(){function t(){n(p,".drawElementsInstancedANGLE(",[d,v,g,m+"<<(("+g+"-"+so+")>>1)",f],");")}function e(){n(p,".drawArraysInstancedANGLE(",[d,m,v,f],");")}l&&"null"!==l?x?t():(n("if(",l,"){"),t(),n("}else{"),e(),n("}")):e()}function w(){function t(){n(o+".drawElements("+[d,v,g,m+"<<(("+g+"-"+so+")>>1)"]+");")}function e(){n(o+".drawArrays("+[d,m,v]+");")}l&&"null"!==l?x?t():(n("if(",l,"){"),t(),n("}else{"),e(),n("}")):e()}y&&("number"!=typeof f||f>=0)?"string"==typeof f?(n("if(",f,">0){"),_(),n("}else if(",f,"<0){"),w(),n("}")):_():w()}function Q(t,e,n,r,i){var o=L(),a=o.proc("body",i);return rt.optional((function(){o.commandStr=e.commandStr,o.command=o.link(e.commandStr)})),y&&(o.instancing=a.def(o.shared.extensions,".angle_instanced_arrays")),t(o,a,n,r),o.compile().body}function tt(t,e,n,r){q(t,e),n.useVAO?n.drawVAO?e(t.shared.vao,".setVAO(",n.drawVAO.append(t,e),");"):e(t.shared.vao,".setVAO(",t.shared.vao,".targetVAO);"):(e(t.shared.vao,".setVAO(null);"),$(t,e,n,r.attributes,(function(){return!0}))),K(t,e,n,r.uniforms,(function(){return!0}),!1),J(t,e,e,n)}function et(t,e){var n=t.proc("draw",1);q(t,n),W(t,n,e.context),H(t,n,e.framebuffer),Y(t,n,e),X(t,n,e.state),Z(t,n,e,!1,!0);var r=e.shader.progVar.append(t,n);if(n(t.shared.gl,".useProgram(",r,".program);"),e.shader.program)tt(t,n,e,e.shader.program);else{n(t.shared.vao,".setVAO(null);");var i=t.global.def("{}"),o=n.def(r,".id"),a=n.def(i,"[",o,"]");n(t.cond(a).then(a,".call(this,a0);").else(a,"=",i,"[",o,"]=",t.link((function(n){return Q(tt,t,e,n,1)})),"(",r,");",a,".call(this,a0);"))}Object.keys(e.state).length>0&&n(t.shared.current,".dirty=true;"),t.shared.vao&&n(t.shared.vao,".setVAO(null);")}function nt(t,e,n,r){function i(){return!0}t.batchId="a1",q(t,e),$(t,e,n,r.attributes,i),K(t,e,n,r.uniforms,i,!1),J(t,e,e,n)}function it(t,e,n,r){q(t,e);var i=n.contextDep,o=e.def(),a="a0",s="a1",u=e.def();t.shared.props=u,t.batchId=o;var c=t.scope(),l=t.scope();function h(t){return t.contextDep&&i||t.propDep}function f(t){return!h(t)}if(e(c.entry,"for(",o,"=0;",o,"<",s,";++",o,"){",u,"=",a,"[",o,"];",l,"}",c.exit),n.needsContext&&W(t,l,n.context),n.needsFramebuffer&&H(t,l,n.framebuffer),X(t,l,n.state,h),n.profile&&h(n.profile)&&Z(t,l,n,!1,!0),r)n.useVAO?n.drawVAO?h(n.drawVAO)?l(t.shared.vao,".setVAO(",n.drawVAO.append(t,l),");"):c(t.shared.vao,".setVAO(",n.drawVAO.append(t,c),");"):c(t.shared.vao,".setVAO(",t.shared.vao,".targetVAO);"):(c(t.shared.vao,".setVAO(null);"),$(t,c,n,r.attributes,f),$(t,l,n,r.attributes,h)),K(t,c,n,r.uniforms,f,!1),K(t,l,n,r.uniforms,h,!0),J(t,c,l,n);else{var p=t.global.def("{}"),d=n.shader.progVar.append(t,l),m=l.def(d,".id"),v=l.def(p,"[",m,"]");l(t.shared.gl,".useProgram(",d,".program);","if(!",v,"){",v,"=",p,"[",m,"]=",t.link((function(e){return Q(nt,t,n,e,2)})),"(",d,");}",v,".call(this,a0[",o,"],",o,");")}}function ot(t,e){var n=t.proc("batch",2);t.batchId="0",q(t,n);var r=!1,i=!0;Object.keys(e.context).forEach((function(t){r=r||e.context[t].propDep})),r||(W(t,n,e.context),i=!1);var o=e.framebuffer,a=!1;function s(t){return t.contextDep&&r||t.propDep}o?(o.propDep?r=a=!0:o.contextDep&&r&&(a=!0),a||H(t,n,o)):H(t,n,null),e.state.viewport&&e.state.viewport.propDep&&(r=!0),Y(t,n,e),X(t,n,e.state,(function(t){return!s(t)})),e.profile&&s(e.profile)||Z(t,n,e,!1,"a1"),e.contextDep=r,e.needsContext=i,e.needsFramebuffer=a;var u=e.shader.progVar;if(u.contextDep&&r||u.propDep)it(t,n,e,null);else{var c=u.append(t,n);if(n(t.shared.gl,".useProgram(",c,".program);"),e.shader.program)it(t,n,e,e.shader.program);else{n(t.shared.vao,".setVAO(null);");var l=t.global.def("{}"),h=n.def(c,".id"),f=n.def(l,"[",h,"]");n(t.cond(f).then(f,".call(this,a0,a1);").else(f,"=",l,"[",h,"]=",t.link((function(n){return Q(it,t,e,n,2)})),"(",c,");",f,".call(this,a0,a1);"))}}Object.keys(e.state).length>0&&n(t.shared.current,".dirty=true;"),t.shared.vao&&n(t.shared.vao,".setVAO(null);")}function at(t,n){var r=t.proc("scope",3);t.batchId="a2";var i=t.shared,o=i.current;function a(e){var o=n.shader[e];o&&r.set(i.shader,"."+e,o.append(t,r))}W(t,r,n.context),n.framebuffer&&n.framebuffer.append(t,r),cs(Object.keys(n.state)).forEach((function(e){var o=n.state[e].append(t,r);fn(o)?o.forEach((function(n,i){r.set(t.next[e],"["+i+"]",n)})):r.set(i.next,"."+e,o)})),Z(t,r,n,!0,!0),[Zo,Jo,Ko,Qo,$o].forEach((function(e){var o=n.draw[e];o&&r.set(i.draw,"."+e,""+o.append(t,r))})),Object.keys(n.uniforms).forEach((function(o){var a=n.uniforms[o].append(t,r);Array.isArray(a)&&(a="["+a.join()+"]"),r.set(i.uniforms,"["+e.id(o)+"]",a)})),Object.keys(n.attributes).forEach((function(e){var i=n.attributes[e].append(t,r),o=t.scopeAttrib(e);Object.keys(new v).forEach((function(t){r.set(o,"."+t,i[t])}))})),n.scopeVAO&&r.set(i.vao,".targetVAO",n.scopeVAO.append(t,r)),a(Xo),a(qo),Object.keys(n.state).length>0&&(r(o,".dirty=true;"),r.exit(o,".dirty=true;")),r("a1(",t.shared.context,",a0,",t.batchId,");")}function st(t){if("object"==typeof t&&!fn(t)){for(var e=Object.keys(t),n=0;n<e.length;++n)if(mt.isDynamic(t[e[n]]))return!0;return!1}}function ut(t,e,n){var r=e.static[n];if(r&&st(r)){var i=t.global,o=Object.keys(r),a=!1,s=!1,u=!1,c=t.global.def("{}");o.forEach((function(e){var n=r[e];if(mt.isDynamic(n)){"function"==typeof n&&(n=r[e]=mt.unbox(n));var o=ps(n,null);a=a||o.thisDep,u=u||o.propDep,s=s||o.contextDep}else{switch(i(c,".",e,"="),typeof n){case"number":i(n);break;case"string":i('"',n,'"');break;case"object":Array.isArray(n)&&i("[",n.join(),"]");break;default:i(t.link(n))}i(";")}})),e.dynamic[n]=new mt.DynamicVariable(mo,{thisDep:a,contextDep:s,propDep:u,ref:c,append:l}),delete e.static[n]}function l(t,e){o.forEach((function(n){var i=r[n];if(mt.isDynamic(i)){var o=t.invoke(e,i);e(c,".",n,"=",o,";")}}))}}function ct(t,e,r,i,o){var a=L();a.stats=a.link(o),Object.keys(e.static).forEach((function(t){ut(a,e,t)})),la.forEach((function(e){ut(a,t,e)}));var s=G(t,e,r,i,a);return et(a,s),at(a,s),ot(a,s),n(a.compile(),{destroy:function(){s.shader.program.destroy()}})}return{next:w,current:_,procs:function(){var t=L(),e=t.proc("poll"),n=t.proc("refresh"),o=t.block();e(o),n(o);var a,s=t.shared,u=s.gl,c=s.next,l=s.current;o(l,".dirty=false;"),H(t,e),H(t,n,null,!0),y&&(a=t.link(y)),r.oes_vertex_array_object&&n(t.link(r.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var h=0;h<i.maxAttributes;++h){var f=n.def(s.attributes,"[",h,"]"),p=t.cond(f,".buffer");p.then(u,".enableVertexAttribArray(",h,");",u,".bindBuffer(",ha,",",f,".buffer.buffer);",u,".vertexAttribPointer(",h,",",f,".size,",f,".type,",f,".normalized,",f,".stride,",f,".offset);").else(u,".disableVertexAttribArray(",h,");",u,".vertexAttrib4f(",h,",",f,".x,",f,".y,",f,".z,",f,".w);",f,".buffer=null;"),n(p),y&&n(a,".vertexAttribDivisorANGLE(",h,",",f,".divisor);")}return n(t.shared.vao,".currentVAO=null;",t.shared.vao,".setVAO(",t.shared.vao,".targetVAO);"),Object.keys(M).forEach((function(r){var i=M[r],a=o.def(c,".",r),s=t.block();s("if(",a,"){",u,".enable(",i,")}else{",u,".disable(",i,")}",l,".",r,"=",a,";"),n(s),e("if(",a,"!==",l,".",r,"){",s,"}")})),Object.keys(E).forEach((function(r){var i,a,s=E[r],h=_[r],f=t.block();if(f(u,".",s,"("),fn(h)){var p=h.length;i=t.global.def(c,".",r),a=t.global.def(l,".",r),f(Tt(p,(function(t){return i+"["+t+"]"})),");",Tt(p,(function(t){return a+"["+t+"]="+i+"["+t+"];"})).join("")),e("if(",Tt(p,(function(t){return i+"["+t+"]!=="+a+"["+t+"]"})).join("||"),"){",f,"}")}else i=o.def(c,".",r),a=o.def(l,".",r),f(i,");",l,".",r,"=",i,";"),e("if(",i,"!==",a,"){",f,"}");n(f)})),t.compile()}(),compile:ct}}function vs(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var gs=34918,ys=34919,xs=35007,bs=function(t,e){if(!e.ext_disjoint_timer_query)return null;var n=[];function r(){return n.pop()||e.ext_disjoint_timer_query.createQueryEXT()}function i(t){n.push(t)}var o=[];function a(t){var n=r();e.ext_disjoint_timer_query.beginQueryEXT(xs,n),o.push(n),p(o.length-1,o.length,t)}function s(){e.ext_disjoint_timer_query.endQueryEXT(xs)}function u(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var c=[];function l(){return c.pop()||new u}function h(t){c.push(t)}var f=[];function p(t,e,n){var r=l();r.startQueryIndex=t,r.endQueryIndex=e,r.sum=0,r.stats=n,f.push(r)}var d=[],m=[];function v(){var t,n,r=o.length;if(0!==r){m.length=Math.max(m.length,r+1),d.length=Math.max(d.length,r+1),d[0]=0,m[0]=0;var a=0;for(t=0,n=0;n<o.length;++n){var s=o[n];e.ext_disjoint_timer_query.getQueryObjectEXT(s,ys)?(a+=e.ext_disjoint_timer_query.getQueryObjectEXT(s,gs),i(s)):o[t++]=s,d[n+1]=a,m[n+1]=t}for(o.length=t,t=0,n=0;n<f.length;++n){var u=f[n],c=u.startQueryIndex,l=u.endQueryIndex;u.sum+=d[l]-d[c];var p=m[c],v=m[l];v===p?(u.stats.gpuTime+=u.sum/1e6,h(u)):(u.startQueryIndex=p,u.endQueryIndex=v,f[t++]=u)}f.length=t}}return{beginQuery:a,endQuery:s,pushScopeStats:p,update:v,getNumPendingQueries:function(){return o.length},clear:function(){n.push.apply(n,o);for(var t=0;t<n.length;t++)e.ext_disjoint_timer_query.deleteQueryEXT(n[t]);o.length=0,n.length=0},restore:function(){o.length=0,n.length=0}}},_s=16384,ws=256,Ss=1024,Ms=34962,Es="webglcontextlost",As="webglcontextrestored",Ts=1,Cs=2,Os=3;function ks(t,e){for(var n=0;n<t.length;++n)if(t[n]===e)return n;return-1}function Ps(t){var e=Et(t);if(!e)return null;var r=e.gl,i=r.getContextAttributes(),o=r.isContextLost(),a=At(r,e);if(!a)return null;var s=yt(),u=vs(),c=a.extensions,l=bs(r,c),h=gt(),f=r.drawingBufferWidth,p=r.drawingBufferHeight,d={tick:0,time:0,viewportWidth:f,viewportHeight:p,framebufferWidth:f,framebufferHeight:p,drawingBufferWidth:f,drawingBufferHeight:p,pixelRatio:e.pixelRatio},m={},v={elements:null,primitive:4,count:-1,offset:0,instances:-1},g=Se(r,c),y=Ye(r,u,e,_),x=sn(r,c,y,u),b=Yi(r,c,g,u,y,x,v);function _(t){return b.destroyBuffer(t)}var w=Ki(r,s,u,e),S=Jr(r,c,g,(function(){A.procs.poll()}),d,u,e),M=fi(r,c,g,u,e),E=zi(r,c,g,S,M,u),A=ms(r,s,c,g,y,x,S,E,m,b,w,v,d,l,e),T=no(r,E,A.procs.poll,d,i,c,g),C=A.next,O=r.canvas,k=[],P=[],L=[],R=[e.onDestroy],I=null;function N(){if(0===k.length)return l&&l.update(),void(I=null);I=vt.next(N),q();for(var t=k.length-1;t>=0;--t){var e=k[t];e&&e(d,null,0)}r.flush(),l&&l.update()}function D(){!I&&k.length>0&&(I=vt.next(N))}function F(){I&&(vt.cancel(N),I=null)}function j(t){t.preventDefault(),o=!0,F(),P.forEach((function(t){t()}))}function B(t){r.getError(),o=!1,a.restore(),w.restore(),y.restore(),S.restore(),M.restore(),E.restore(),b.restore(),l&&l.restore(),A.procs.refresh(),D(),L.forEach((function(t){t()}))}var z="undefined"!=typeof my&&!!my&&"function"==typeof my.showToast&&!0!==my.isFRM;function U(){k.length=0,F(),!z&&O&&(O.removeEventListener(Es,j),O.removeEventListener(As,B)),w.clear(),E.clear(),M.clear(),b.clear(),S.clear(),x.clear(),y.clear(),l&&l.clear(),R.forEach((function(t){t()}))}function V(t){function e(t){var e=n({},t);function r(t){if(t in e){var n=e[t];delete e[t],Object.keys(n).forEach((function(r){e[t+"."+r]=n[r]}))}}return delete e.uniforms,delete e.attributes,delete e.context,delete e.vao,"stencil"in e&&e.stencil.op&&(e.stencil.opBack=e.stencil.opFront=e.stencil.op,delete e.stencil.op),r("blend"),r("depth"),r("cull"),r("stencil"),r("polygonOffset"),r("scissor"),r("sample"),"vao"in t&&(e.vao=t.vao),e}function r(t,e){var n={},r={};return Object.keys(t).forEach((function(i){var o=t[i];if(mt.isDynamic(o))r[i]=mt.unbox(o,i);else{if(e&&Array.isArray(o))for(var a=0;a<o.length;++a)if(mt.isDynamic(o[a]))return void(r[i]=mt.unbox(o,i));n[i]=o}})),{dynamic:r,static:n}}rt(!!t,"invalid args to regl({...})"),rt.type(t,"object","invalid args to regl({...})");var i=r(t.context||{},!0),a=r(t.uniforms||{},!0),s=r(t.attributes||{},!1),u=r(e(t),!1),c={gpuTime:0,cpuTime:0,count:0},l=A.compile(u,s,a,i,c),h=l.draw,f=l.batch,p=l.scope,d=[];function m(t){for(;d.length<t;)d.push(null);return d}function v(t,e){var n;if(o&&rt.raise("context lost"),"function"==typeof t)return p.call(this,null,t,0);if("function"==typeof e)if("number"==typeof t)for(n=0;n<t;++n)p.call(this,null,e,n);else{if(!Array.isArray(t))return p.call(this,t,e,0);for(n=0;n<t.length;++n)p.call(this,t[n],e,n)}else if("number"==typeof t){if(t>0)return f.call(this,m(0|t),0|t)}else{if(!Array.isArray(t))return h.call(this,t);if(t.length)return f.call(this,t,t.length)}}return n(v,{stats:c,destroy:function(){l.destroy()}})}!z&&O&&(O.addEventListener(Es,j,!1),O.addEventListener(As,B,!1));var G=E.setFBO=V({framebuffer:mt.define.call(null,Ts,"framebuffer")});function W(t,e){var n=0;A.procs.poll();var i=e.color;i&&(r.clearColor(+i[0]||0,+i[1]||0,+i[2]||0,+i[3]||0),n|=_s),"depth"in e&&(r.clearDepth(+e.depth),n|=ws),"stencil"in e&&(r.clearStencil(0|e.stencil),n|=Ss),rt(!!n,"called regl.clear with no buffer specified"),r.clear(n)}function H(t){if(rt("object"==typeof t&&t,"regl.clear() takes an object as input"),"framebuffer"in t)if(t.framebuffer&&"framebufferCube"===t.framebuffer_reglType)for(var e=0;e<6;++e)G(n({framebuffer:t.framebuffer.faces[e]},t),W);else G(t,W);else W(null,t)}function Y(t){function e(){var e=ks(k,t);function n(){var t=ks(k,n);k[t]=k[k.length-1],k.length-=1,k.length<=0&&F()}rt(e>=0,"cannot cancel a frame twice"),k[e]=n}return rt.type(t,"function","regl.frame() callback must be a function"),k.push(t),D(),{cancel:e}}function X(){var t=C.viewport,e=C.scissor_box;t[0]=t[1]=e[0]=e[1]=0,d.viewportWidth=d.framebufferWidth=d.drawingBufferWidth=t[2]=e[2]=r.drawingBufferWidth,d.viewportHeight=d.framebufferHeight=d.drawingBufferHeight=t[3]=e[3]=r.drawingBufferHeight}function q(){d.tick+=1,d.time=$(),X(),A.procs.poll()}function Z(){S.refresh(),X(),A.procs.refresh(),l&&l.update()}function $(){return(gt()-h)/1e3}function K(t,e){var n;switch(rt.type(e,"function","listener callback must be a function"),t){case"frame":return Y(e);case"lost":n=P;break;case"restore":n=L;break;case"destroy":n=R;break;default:rt.raise("invalid event, must be one of frame,lost,restore,destroy")}return n.push(e),{cancel:function(){for(var t=0;t<n.length;++t)if(n[t]===e)return n[t]=n[n.length-1],void n.pop()}}}Z();var J=n(V,{clear:H,prop:mt.define.bind(null,Ts),context:mt.define.bind(null,Cs),this:mt.define.bind(null,Os),draw:V({}),buffer:function(t){return y.create(t,Ms,!1,!1)},elements:function(t){return x.create(t,!1)},texture:S.create2D,cube:S.createCube,renderbuffer:M.create,framebuffer:E.create,framebufferCube:E.createCube,vao:b.createVAO,attributes:i,frame:Y,on:K,limits:g,hasExtension:function(t){return g.extensions.indexOf(t.toLowerCase())>=0},read:T,destroy:U,_gl:r,_refresh:Z,poll:function(){q(),l&&l.update()},now:$,stats:u});return e.onDone(null,J),J}return Ps}(Mft);const Eft=tlt;var Aft,Tft,Cft,Oft,kft,Pft,Lft,Rft,Ift,Nft,Dft,Fft,jft,Bft,zft,Uft=function(){function t(e,n){mZ(this,t);var r=n.buffer,i=n.offset,o=n.stride,a=n.normalized,s=n.size,u=n.divisor;this.buffer=r,this.attribute={buffer:r.get(),offset:i||0,stride:o||0,normalized:a||!1,divisor:u||0},s&&(this.attribute.size=s)}return gZ(t,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(t){this.buffer.subData(t)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),t}(),Vft=($q(Aft={},m4.POINTS,"points"),$q(Aft,m4.LINES,"lines"),$q(Aft,m4.LINE_LOOP,"line loop"),$q(Aft,m4.LINE_STRIP,"line strip"),$q(Aft,m4.TRIANGLES,"triangles"),$q(Aft,m4.TRIANGLE_FAN,"triangle fan"),$q(Aft,m4.TRIANGLE_STRIP,"triangle strip"),Aft),Gft=($q(Tft={},m4.STATIC_DRAW,"static"),$q(Tft,m4.DYNAMIC_DRAW,"dynamic"),$q(Tft,m4.STREAM_DRAW,"stream"),Tft),Wft=($q(Cft={},m4.BYTE,"int8"),$q(Cft,m4.UNSIGNED_INT,"int16"),$q(Cft,m4.INT,"int32"),$q(Cft,m4.UNSIGNED_BYTE,"uint8"),$q(Cft,m4.UNSIGNED_SHORT,"uint16"),$q(Cft,m4.UNSIGNED_INT,"uint32"),$q(Cft,m4.FLOAT,"float"),Cft),Hft=($q(Oft={},m4.ALPHA,"alpha"),$q(Oft,m4.LUMINANCE,"luminance"),$q(Oft,m4.LUMINANCE_ALPHA,"luminance alpha"),$q(Oft,m4.RGB,"rgb"),$q(Oft,m4.RGBA,"rgba"),$q(Oft,m4.RGBA4,"rgba4"),$q(Oft,m4.RGB5_A1,"rgb5 a1"),$q(Oft,m4.RGB565,"rgb565"),$q(Oft,m4.DEPTH_COMPONENT,"depth"),$q(Oft,m4.DEPTH_STENCIL,"depth stencil"),Oft),Yft=($q(kft={},m4.DONT_CARE,"dont care"),$q(kft,m4.NICEST,"nice"),$q(kft,m4.FASTEST,"fast"),kft),Xft=($q(Pft={},m4.NEAREST,"nearest"),$q(Pft,m4.LINEAR,"linear"),$q(Pft,m4.LINEAR_MIPMAP_LINEAR,"mipmap"),$q(Pft,m4.NEAREST_MIPMAP_LINEAR,"nearest mipmap linear"),$q(Pft,m4.LINEAR_MIPMAP_NEAREST,"linear mipmap nearest"),$q(Pft,m4.NEAREST_MIPMAP_NEAREST,"nearest mipmap nearest"),Pft),qft=($q(Lft={},m4.REPEAT,"repeat"),$q(Lft,m4.CLAMP_TO_EDGE,"clamp"),$q(Lft,m4.MIRRORED_REPEAT,"mirror"),Lft),Zft=($q(Rft={},m4.NONE,"none"),$q(Rft,m4.BROWSER_DEFAULT_WEBGL,"browser"),Rft),$ft=($q(Ift={},m4.NEVER,"never"),$q(Ift,m4.ALWAYS,"always"),$q(Ift,m4.LESS,"less"),$q(Ift,m4.LEQUAL,"lequal"),$q(Ift,m4.GREATER,"greater"),$q(Ift,m4.GEQUAL,"gequal"),$q(Ift,m4.EQUAL,"equal"),$q(Ift,m4.NOTEQUAL,"notequal"),Ift),Kft=($q(Nft={},m4.FUNC_ADD,"add"),$q(Nft,m4.MIN_EXT,"min"),$q(Nft,m4.MAX_EXT,"max"),$q(Nft,m4.FUNC_SUBTRACT,"subtract"),$q(Nft,m4.FUNC_REVERSE_SUBTRACT,"reverse subtract"),Nft),Jft=($q(Dft={},m4.ZERO,"zero"),$q(Dft,m4.ONE,"one"),$q(Dft,m4.SRC_COLOR,"src color"),$q(Dft,m4.ONE_MINUS_SRC_COLOR,"one minus src color"),$q(Dft,m4.SRC_ALPHA,"src alpha"),$q(Dft,m4.ONE_MINUS_SRC_ALPHA,"one minus src alpha"),$q(Dft,m4.DST_COLOR,"dst color"),$q(Dft,m4.ONE_MINUS_DST_COLOR,"one minus dst color"),$q(Dft,m4.DST_ALPHA,"dst alpha"),$q(Dft,m4.ONE_MINUS_DST_ALPHA,"one minus dst alpha"),$q(Dft,m4.CONSTANT_COLOR,"constant color"),$q(Dft,m4.ONE_MINUS_CONSTANT_COLOR,"one minus constant color"),$q(Dft,m4.CONSTANT_ALPHA,"constant alpha"),$q(Dft,m4.ONE_MINUS_CONSTANT_ALPHA,"one minus constant alpha"),$q(Dft,m4.SRC_ALPHA_SATURATE,"src alpha saturate"),Dft),Qft=($q(Fft={},m4.NEVER,"never"),$q(Fft,m4.ALWAYS,"always"),$q(Fft,m4.LESS,"less"),$q(Fft,m4.LEQUAL,"lequal"),$q(Fft,m4.GREATER,"greater"),$q(Fft,m4.GEQUAL,"gequal"),$q(Fft,m4.EQUAL,"equal"),$q(Fft,m4.NOTEQUAL,"notequal"),Fft),tpt=($q(jft={},m4.ZERO,"zero"),$q(jft,m4.KEEP,"keep"),$q(jft,m4.REPLACE,"replace"),$q(jft,m4.INVERT,"invert"),$q(jft,m4.INCR,"increment"),$q(jft,m4.DECR,"decrement"),$q(jft,m4.INCR_WRAP,"increment wrap"),$q(jft,m4.DECR_WRAP,"decrement wrap"),jft),ept=($q(Bft={},m4.FRONT,"front"),$q(Bft,m4.BACK,"back"),Bft),npt=function(){function t(e,n){mZ(this,t);var r=n.data,i=n.usage,o=n.type;this.buffer=e.buffer({data:r,usage:Gft[i||m4.STATIC_DRAW],type:Wft[o||m4.UNSIGNED_BYTE]})}return gZ(t,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){this.buffer.destroy()}},{key:"subData",value:function(t){var e=t.data,n=t.offset;this.buffer.subdata(e,n)}}]),t}(),rpt=function(){function t(e,n){mZ(this,t);var r=n.data,i=n.usage,o=n.type,a=n.count;this.elements=e.elements({data:r,usage:Gft[i||m4.STATIC_DRAW],type:Wft[o||m4.UNSIGNED_BYTE],count:a})}return gZ(t,[{key:"get",value:function(){return this.elements}},{key:"subData",value:function(t){var e=t.data;this.elements.subdata(e)}},{key:"destroy",value:function(){}}]),t}(),ipt=function(){function t(e,n){mZ(this,t);var r=n.width,i=n.height,o=n.color,a=n.colors,s={width:r,height:i};Array.isArray(a)&&(s.colors=a.map((function(t){return t.get()}))),o&&"boolean"!=typeof o&&(s.color=o.get()),this.framebuffer=e.framebuffer(s)}return gZ(t,[{key:"get",value:function(){return this.framebuffer}},{key:"destroy",value:function(){this.framebuffer.destroy()}},{key:"resize",value:function(t){var e=t.width,n=t.height;this.framebuffer.resize(e,n)}}]),t}(),opt=function(){function t(e,n){mZ(this,t),$q(this,"destroyed",!1),$q(this,"uniforms",{}),this.reGl=e;var r=n.pick,i=void 0===r||r,o=n.vs,a=n.fs,s=n.attributes,u=n.uniforms,c=n.primitive,l=n.count,h=n.elements,f=n.depth,p=n.blend,d=n.stencil,m=n.cull,v=n.instances,g={};this.options=n,u&&(this.uniforms=this.extractUniforms(u),Object.keys(u).forEach((function(t){g[t]=e.prop(t)})));var y={};Object.keys(s).forEach((function(t){y[t]=s[t].get()}));var x={attributes:y,frag:a,uniforms:g,vert:o,blend:{},primitive:Vft[void 0===c?m4.TRIANGLES:c]};if(v&&(x.instances=v),l?x.count=l:h&&(x.elements=h.get()),this.initDepthDrawParams({depth:f},x),this.initBlendDrawParams({blend:p},x),this.initStencilDrawParams({stencil:d},x),this.initCullDrawParams({cull:m},x),this.drawCommand=e(x),i){var b=hZ.cloneDeep(x);b.blend=Jq(Jq({},b.blend),{},{enable:!1}),this.drawPickCommand=e(b)}this.drawParams=x}return gZ(t,[{key:"updateAttributesAndElements",value:function(t,e){var n={};if(Object.keys(t).forEach((function(e){n[e]=t[e].get()})),this.drawParams.attributes=n,this.drawParams.elements=e.get(),this.drawCommand=this.reGl(this.drawParams),this.options.pick){var r=hZ.cloneDeep(this.drawParams);r.blend=Jq(Jq({},r.blend),{},{enable:!1}),this.drawPickCommand=this.reGl(r)}}},{key:"updateAttributes",value:function(t){var e={};if(Object.keys(t).forEach((function(n){e[n]=t[n].get()})),this.drawParams.attributes=e,this.drawCommand=this.reGl(this.drawParams),this.options.pick){var n=hZ.cloneDeep(this.drawParams);n.blend=Jq(Jq({},n.blend),{},{enable:!1}),this.drawPickCommand=this.reGl(n)}}},{key:"addUniforms",value:function(t){this.uniforms=Jq(Jq({},this.uniforms),this.extractUniforms(t))}},{key:"draw",value:function(t,e){if(!this.drawParams.attributes||0!==Object.keys(this.drawParams.attributes).length){var n=Jq(Jq({},this.uniforms),this.extractUniforms(t.uniforms||{})),r={};Object.keys(n).forEach((function(t){var e=qq(n[t]);"boolean"===e||"number"===e||Array.isArray(n[t])||n[t].BYTES_PER_ELEMENT?r[t]=n[t]:r[t]=n[t].get()})),e?this.drawPickCommand&&this.drawPickCommand(r):this.drawCommand(r)}}},{key:"destroy",value:function(){var t,e;null===(t=this.drawParams)||void 0===t||null===(e=t.elements)||void 0===e||e.destroy(),this.options.attributes&&Object.values(this.options.attributes).forEach((function(t){null==t||t.destroy()})),this.destroyed=!0}},{key:"initDepthDrawParams",value:function(t,e){var n=t.depth;n&&(e.depth={enable:void 0===n.enable||!!n.enable,mask:void 0===n.mask||!!n.mask,func:$ft[n.func||m4.LESS],range:n.range||[0,1]})}},{key:"initBlendDrawParams",value:function(t,e){var n=t.blend;if(n){var r=n.enable,i=n.func,o=n.equation,a=n.color,s=void 0===a?[0,0,0,0]:a;e.blend={enable:!!r,func:{srcRGB:Jft[i&&i.srcRGB||m4.SRC_ALPHA],srcAlpha:Jft[i&&i.srcAlpha||m4.SRC_ALPHA],dstRGB:Jft[i&&i.dstRGB||m4.ONE_MINUS_SRC_ALPHA],dstAlpha:Jft[i&&i.dstAlpha||m4.ONE_MINUS_SRC_ALPHA]},equation:{rgb:Kft[o&&o.rgb||m4.FUNC_ADD],alpha:Kft[o&&o.alpha||m4.FUNC_ADD]},color:s}}}},{key:"initStencilDrawParams",value:function(t,e){var n=t.stencil;if(n){var r=n.enable,i=n.mask,o=void 0===i?-1:i,a=n.func,s=void 0===a?{cmp:m4.ALWAYS,ref:0,mask:-1}:a,u=n.opFront,c=void 0===u?{fail:m4.KEEP,zfail:m4.KEEP,zpass:m4.KEEP}:u,l=n.opBack,h=void 0===l?{fail:m4.KEEP,zfail:m4.KEEP,zpass:m4.KEEP}:l;e.stencil={enable:!!r,mask:o,func:Jq(Jq({},s),{},{cmp:Qft[s.cmp]}),opFront:{fail:tpt[c.fail],zfail:tpt[c.zfail],zpass:tpt[c.zpass]},opBack:{fail:tpt[h.fail],zfail:tpt[h.zfail],zpass:tpt[h.zpass]}}}}},{key:"initCullDrawParams",value:function(t,e){var n=t.cull;if(n){var r=n.enable,i=n.face,o=void 0===i?m4.BACK:i;e.cull={enable:!!r,face:ept[o]}}}},{key:"extractUniforms",value:function(t){var e=this,n={};return Object.keys(t).forEach((function(r){e.extractUniformsRecursively(r,t[r],n,"")})),n}},{key:"extractUniformsRecursively",value:function(t,e,n,r){var i=this;null===e||"number"==typeof e||"boolean"==typeof e||Array.isArray(e)&&"number"==typeof e[0]||hZ.isTypedArray(e)||""===e||"resize"in e?n["".concat(r&&r+".").concat(t)]=e:(hZ.isPlainObject(e)&&Object.keys(e).forEach((function(o){i.extractUniformsRecursively(o,e[o],n,"".concat(r&&r+".").concat(t))})),Array.isArray(e)&&e.forEach((function(e,o){Object.keys(e).forEach((function(a){i.extractUniformsRecursively(a,e[a],n,"".concat(r&&r+".").concat(t,"[").concat(o,"]"))}))})))}}]),t}(),apt=function(){function t(e,n){mZ(this,t),$q(this,"isDestroy",!1);var r=n.data,i=n.type,o=void 0===i?m4.UNSIGNED_BYTE:i,a=n.width,s=n.height,u=n.flipY,c=void 0!==u&&u,l=n.format,h=void 0===l?m4.RGBA:l,f=n.mipmap,p=void 0!==f&&f,d=n.wrapS,m=void 0===d?m4.CLAMP_TO_EDGE:d,v=n.wrapT,g=void 0===v?m4.CLAMP_TO_EDGE:v,y=n.aniso,x=void 0===y?0:y,b=n.alignment,_=void 0===b?1:b,w=n.premultiplyAlpha,S=void 0!==w&&w,M=n.mag,E=void 0===M?m4.NEAREST:M,A=n.min,T=void 0===A?m4.NEAREST:A,C=n.colorSpace,O=void 0===C?m4.BROWSER_DEFAULT_WEBGL:C,k=n.x,P=void 0===k?0:k,L=n.y,R=void 0===L?0:L,I=n.copy,N=void 0!==I&&I;this.width=a,this.height=s;var D={width:a,height:s,type:Wft[o],format:Hft[h],wrapS:qft[m],wrapT:qft[g],mag:Xft[E],min:Xft[T],alignment:_,flipY:c,colorSpace:Zft[O],premultiplyAlpha:S,aniso:x,x:P,y:R,copy:N};r&&(D.data=r),"number"==typeof p?D.mipmap=Yft[p]:"boolean"==typeof p&&(D.mipmap=p),this.texture=e.texture(D)}return gZ(t,[{key:"get",value:function(){return this.texture}},{key:"update",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.texture(t)}},{key:"bind",value:function(){this.texture._texture.bind()}},{key:"resize",value:function(t){var e=t.width,n=t.height;this.texture.resize(e,n),this.width=e,this.height=n}},{key:"getSize",value:function(){return[this.width,this.height]}},{key:"destroy",value:function(){var t;this.isDestroy||(null===(t=this.texture)||void 0===t||t.destroy());this.isDestroy=!0}}]),t}(),spt=Z2()(zft=function(){function t(){var e=this;mZ(this,t),$q(this,"createModel",(function(t){return new opt(e.gl,t)})),$q(this,"createAttribute",(function(t){return new Uft(e.gl,t)})),$q(this,"createBuffer",(function(t){return new npt(e.gl,t)})),$q(this,"createElements",(function(t){return new rpt(e.gl,t)})),$q(this,"createTexture2D",(function(t){return new apt(e.gl,t)})),$q(this,"createFramebuffer",(function(t){return new ipt(e.gl,t)})),$q(this,"useFramebuffer",(function(t,n){e.gl({framebuffer:t?t.get():null})(n)})),$q(this,"clear",(function(t){var n,r=t.color,i=t.depth,o=t.stencil,a=t.framebuffer,s=void 0===a?null:a,u={color:r,depth:i,stencil:o};u.framebuffer=null===s?s:s.get(),null===(n=e.gl)||void 0===n||n.clear(u)})),$q(this,"viewport",(function(t){var n=t.x,r=t.y,i=t.width,o=t.height;e.gl._gl.viewport(n,r,i,o),e.width=i,e.height=o,e.gl._refresh()})),$q(this,"readPixels",(function(t){var n=t.framebuffer,r={x:t.x,y:t.y,width:t.width,height:t.height};return n&&(r.framebuffer=n.get()),e.gl.read(r)})),$q(this,"getViewportSize",(function(){return{width:e.gl._gl.drawingBufferWidth,height:e.gl._gl.drawingBufferHeight}})),$q(this,"getContainer",(function(){return N$?e.canvas:null===(t=e.canvas)||void 0===t?void 0:t.parentElement;var t})),$q(this,"getCanvas",(function(){return e.canvas})),$q(this,"getGLContext",(function(){return e.gl._gl})),$q(this,"destroy",(function(){var t,n,r;e.canvas=null,null===(t=e.gl)||void 0===t||null===(n=t._gl)||void 0===n||null===(r=n.getExtension("WEBGL_lose_context"))||void 0===r||r.loseContext(),e.gl.destroy(),e.gl=null}))}var e;return gZ(t,[{key:"init",value:(e=RK(jK.mark((function t(e,n,r){var i=this;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.canvas=e,!r){t.next=5;break}this.gl=r,t.next=8;break;case 5:return t.next=7,new Promise((function(t,e){Eft({canvas:i.canvas,attributes:{alpha:!0,antialias:n.antialias,premultipliedAlpha:!0,preserveDrawingBuffer:n.preserveDrawingBuffer,stencil:n.stencil},extensions:["OES_element_index_uint","OES_standard_derivatives","ANGLE_instanced_arrays"],optionalExtensions:["oes_texture_float_linear","OES_texture_float","EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture"],profile:!0,onDone:function(n,r){!n&&r||e(n),t(r)}})}));case 7:this.gl=t.sent;case 8:this.extensionObject={OES_texture_float:this.testExtension("OES_texture_float")};case 9:case"end":return t.stop()}}),t,this)}))),function(t,n,r){return e.apply(this,arguments)})},{key:"getPointSizeRange",value:function(){return this.gl._gl.getParameter(this.gl._gl.ALIASED_POINT_SIZE_RANGE)}},{key:"testExtension",value:function(t){return!!this.getGLContext().getExtension(t)}},{key:"setState",value:function(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!0,equation:"add"},framebuffer:null}),this.gl._refresh()}},{key:"setBaseState",value:function(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!1,equation:"add"},framebuffer:null}),this.gl._refresh()}},{key:"setCustomLayerDefaults",value:function(){var t=this.getGLContext();t.disable(t.CULL_FACE)}},{key:"setDirty",value:function(t){this.isDirty=t}},{key:"getDirty",value:function(){return this.isDirty}}]),t}())||zft;function upt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var cpt=["selectstart","selecting","selectend"],lpt=function(t){wZ(n,hc.EventEmitter);var e=upt(n);function n(t){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return mZ(this,n),$q(SZ(r=e.call(this)),"isEnable",!1),$q(SZ(r),"onDragStart",(function(t){r.box.style.display="block",r.startEvent=r.endEvent=t,r.syncBoxBound(),r.emit("selectstart",r.getLngLatBox(),r.startEvent,r.endEvent)})),$q(SZ(r),"onDragging",(function(t){r.endEvent=t,r.syncBoxBound(),r.emit("selecting",r.getLngLatBox(),r.startEvent,r.endEvent)})),$q(SZ(r),"onDragEnd",(function(t){r.endEvent=t,r.box.style.display="none",r.emit("selectend",r.getLngLatBox(),r.startEvent,r.endEvent)})),r.scene=t,r.options=i,r}return gZ(n,[{key:"container",get:function(){return this.scene.getMapService().getMarkerContainer()}},{key:"enable",value:function(){if(!this.isEnable){var t=this.options.className;if(this.scene.setMapStatus({dragEnable:!1}),this.container.style.cursor="crosshair",!this.box){var e=z$("div",void 0,this.container);e.classList.add("l7-select-box"),t&&e.classList.add(t),e.style.display="none",this.box=e}this.scene.on("dragstart",this.onDragStart),this.scene.on("dragging",this.onDragging),this.scene.on("dragend",this.onDragEnd),this.isEnable=!0}}},{key:"disable",value:function(){this.isEnable&&(this.scene.setMapStatus({dragEnable:!0}),this.container.style.cursor="auto",this.scene.off("dragstart",this.onDragStart),this.scene.off("dragging",this.onDragging),this.scene.off("dragend",this.onDragEnd),this.isEnable=!1)}},{key:"syncBoxBound",value:function(){var t=this.startEvent,e=t.x,n=t.y,r=this.endEvent,i=r.x,o=r.y,a=Math.min(e,i),s=Math.min(n,o),u=Math.abs(e-i),c=Math.abs(n-o);this.box.style.top="".concat(s,"px"),this.box.style.left="".concat(a,"px"),this.box.style.width="".concat(u,"px"),this.box.style.height="".concat(c,"px")}},{key:"getLngLatBox",value:function(){var t=this.startEvent.lngLat,e=t.lng,n=t.lat,r=this.endEvent.lngLat,i=r.lng,o=r.lat;return cK(function(t,e){void 0===e&&(e={});var n={type:"FeatureCollection"};return e.id&&(n.id=e.id),e.bbox&&(n.bbox=e.bbox),n.features=t,n}([iZ([[e,n],[i,o]])]))}}]),n}(),hpt=function(){function t(e){mZ(this,t);var n,r=e.id,i=e.map,o=e.canvas,a=e.hasBaseMap,s=function(){var t=new q2;return t.parent=s8,t.bind(J2.SceneID).toConstantValue("".concat(b8++)),t.bind(J2.IShaderModuleService).to(U6).inSingletonScope(),t.bind(J2.ILayerService).to(J4).inSingletonScope(),t.bind(J2.ISceneService).to(P6).inSingletonScope(),t.bind(J2.ICameraService).to(S3).inSingletonScope(),t.bind(J2.ICoordinateSystemService).to(i4).inSingletonScope(),t.bind(J2.IInteractionService).to(P4).inSingletonScope(),t.bind(J2.IPickingService).to(U4).inSingletonScope(),t.bind(J2.IControlService).to(k3).inSingletonScope(),t.bind(J2.IMarkerService).to(P3).inSingletonScope(),t.bind(J2.IIconService).to(w3).inSingletonScope(),t.bind(J2.IFontService).to(v3).inSingletonScope(),t.bind(J2.IPopupService).to(L3).inSingletonScope(),t.bind(J2.INormalPass).to(J6).whenTargetNamed("clear"),t.bind(J2.INormalPass).to(l7).whenTargetNamed("pixelPicking"),t.bind(J2.INormalPass).to(J7).whenTargetNamed("render"),t.bind(J2.INormalPass).to(a8).whenTargetNamed("taa"),t.bind(J2.IFactoryNormalPass).toFactory((function(t){return function(e){return t.container.getNamed(J2.INormalPass,e)}})),t.bind(J2.IPostProcessingPass).to(A7).whenTargetNamed("copy"),t.bind(J2.IPostProcessingPass).to(d7).whenTargetNamed("bloom"),t.bind(J2.IPostProcessingPass).to(g7).whenTargetNamed("blurH"),t.bind(J2.IPostProcessingPass).to(b7).whenTargetNamed("blurV"),t.bind(J2.IPostProcessingPass).to(N7).whenTargetNamed("noise"),t.bind(J2.IPostProcessingPass).to(W7).whenTargetNamed("sepia"),t.bind(J2.IPostProcessingPass).to(S7).whenTargetNamed("colorHalftone"),t.bind(J2.IPostProcessingPass).to(O7).whenTargetNamed("hexagonalPixelate"),t.bind(J2.IPostProcessingPass).to(L7).whenTargetNamed("ink"),t.bind(J2.IFactoryPostProcessingPass).toFactory((function(t){return function(e){var n=t.container.getNamed(J2.IPostProcessingPass,e);return n.setName(e),n}})),t}();this.container=s,i.setContainer(s,r,o,a),s.bind(J2.IRendererService).to(spt).inSingletonScope(),this.sceneService=s.get(J2.ISceneService),this.mapService=s.get(J2.IMapService),this.iconService=s.get(J2.IIconService),this.fontService=s.get(J2.IFontService),this.controlService=s.get(J2.IControlService),this.layerService=s.get(J2.ILayerService),this.markerService=s.get(J2.IMarkerService),this.interactionService=s.get(J2.IInteractionService),this.popupService=s.get(J2.IPopupService),this.boxSelect=new lpt(this,{}),n=(null==e?void 0:e.isMini)||!1,L$=n,N$?this.sceneService.initMiniScene(e):(this.initComponent(r),this.sceneService.init(e),this.initControl())}var e,n,r;return gZ(t,[{key:"map",get:function(){return this.mapService.map}},{key:"loaded",get:function(){return this.sceneService.loaded}},{key:"getServiceContainer",value:function(){return this.container}},{key:"getSize",value:function(){return this.mapService.getSize()}},{key:"getMinZoom",value:function(){return this.mapService.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.mapService.getMaxZoom()}},{key:"getType",value:function(){return this.mapService.getType()}},{key:"getMapContainer",value:function(){return this.mapService.getMapContainer()}},{key:"getMapCanvasContainer",value:function(){return this.mapService.getMapCanvasContainer()}},{key:"getMapService",value:function(){return this.mapService}},{key:"exportPng",value:(r=RK(jK.mark((function t(e){return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.sceneService.exportPng(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)}))),function(t){return r.apply(this,arguments)})},{key:"exportMap",value:(n=RK(jK.mark((function t(e){return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.sceneService.exportPng(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"registerRenderService",value:function(t){var e=this;this.sceneService.loaded?new t(this).init():this.on("loaded",(function(){new t(e).init()}))}},{key:"setBgColor",value:function(t){this.mapService.setBgColor(t)}},{key:"addLayer",value:function(t){var e=this,n=_8(this.container);if(t.setContainer(n,this.container),this.sceneService.addLayer(t),t.inited){var r=this.initMask(t);this.addMask(r,t.id)}else t.on("inited",(function(){var n=e.initMask(t);e.addMask(n,t.id)}))}},{key:"initMask",value:function(t){var e=t.getLayerConfig(),n=e.mask,r=e.maskfence,i=e.maskColor,o=void 0===i?"#000":i,a=e.maskOpacity,s=void 0===a?0:a;if(n&&r)return(new Qrt).source(r).shape("fill").style({color:o,opacity:s})}},{key:"addMask",value:function(t,e){if(t){var n=this.getLayer(e);if(n){var r=_8(this.container);t.setContainer(r,this.container),n.addMaskLayer(t),this.sceneService.addMask(t)}}}},{key:"getPickedLayer",value:function(){return this.layerService.pickedLayerId}},{key:"getLayers",value:function(){return this.layerService.getLayers()}},{key:"getLayer",value:function(t){return this.layerService.getLayer(t)}},{key:"getLayerByName",value:function(t){return this.layerService.getLayerByName(t)}},{key:"removeLayer",value:function(t,e){this.layerService.remove(t,e)}},{key:"removeAllLayer",value:function(){this.layerService.removeAllLayers()}},{key:"render",value:function(){this.sceneService.render()}},{key:"setEnableRender",value:function(t){this.layerService.setEnableRender(t)}},{key:"addIconFont",value:function(t,e){this.fontService.addIconFont(t,e)}},{key:"addIconFonts",value:function(t){var e=this;t.forEach((function(t){var n=lZ(t,2),r=n[0],i=n[1];e.fontService.addIconFont(r,i)}))}},{key:"addFontFace",value:function(t,e){var n=this;this.fontService.once("fontloaded",(function(t){n.emit("fontloaded",t)})),this.fontService.addFontFace(t,e)}},{key:"addImage",value:(e=RK(jK.mark((function t(e,n){return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(N$){t.next=5;break}return t.next=3,this.iconService.addImage(e,n);case 3:t.next=6;break;case 5:this.iconService.addImageMini(e,n,this.sceneService);case 6:case"end":return t.stop()}}),t,this)}))),function(t,n){return e.apply(this,arguments)})},{key:"hasImage",value:function(t){return this.iconService.hasImage(t)}},{key:"removeImage",value:function(t){this.iconService.removeImage(t)}},{key:"addIconFontGlyphs",value:function(t,e){this.fontService.addIconGlyphs(e)}},{key:"addControl",value:function(t){this.controlService.addControl(t,this.container)}},{key:"removeControl",value:function(t){this.controlService.removeControl(t)}},{key:"getControlByName",value:function(t){return this.controlService.getControlByName(t)}},{key:"addMarker",value:function(t){this.markerService.addMarker(t)}},{key:"addMarkerLayer",value:function(t){this.markerService.addMarkerLayer(t)}},{key:"removeMarkerLayer",value:function(t){this.markerService.removeMarkerLayer(t)}},{key:"removeAllMakers",value:function(){this.markerService.removeAllMarkers()}},{key:"addPopup",value:function(t){this.popupService.addPopup(t)}},{key:"removePopup",value:function(t){this.popupService.removePopup(t)}},{key:"on",value:function(t,e){var n;cpt.includes(t)?null===(n=this.boxSelect)||void 0===n||n.on(t,e):k8.includes(t)?this.sceneService.on(t,e):this.mapService.on(t,e)}},{key:"once",value:function(t,e){var n;cpt.includes(t)?null===(n=this.boxSelect)||void 0===n||n.once(t,e):k8.includes(t)?this.sceneService.once(t,e):this.mapService.once(t,e)}},{key:"emit",value:function(t,e){-1===k8.indexOf(t)?this.mapService.on(t,e):this.sceneService.emit(t,e)}},{key:"off",value:function(t,e){var n;cpt.includes(t)?null===(n=this.boxSelect)||void 0===n||n.off(t,e):k8.includes(t)?this.sceneService.off(t,e):this.mapService.off(t,e)}},{key:"getZoom",value:function(){return this.mapService.getZoom()}},{key:"getCenter",value:function(t){return this.mapService.getCenter(t)}},{key:"setCenter",value:function(t,e){return this.mapService.setCenter(t,e)}},{key:"getPitch",value:function(){return this.mapService.getPitch()}},{key:"setPitch",value:function(t){return this.mapService.setPitch(t)}},{key:"getRotation",value:function(){return this.mapService.getRotation()}},{key:"getBounds",value:function(){return this.mapService.getBounds()}},{key:"setRotation",value:function(t){this.mapService.setRotation(t)}},{key:"zoomIn",value:function(){this.mapService.zoomIn()}},{key:"zoomOut",value:function(){this.mapService.zoomOut()}},{key:"panTo",value:function(t){this.mapService.panTo(t)}},{key:"panBy",value:function(t,e){this.mapService.panBy(t,e)}},{key:"getContainer",value:function(){return this.mapService.getContainer()}},{key:"setZoom",value:function(t){this.mapService.setZoom(t)}},{key:"fitBounds",value:function(t,e){var n=this.sceneService.getSceneConfig(),r=n.fitBoundsOptions,i=n.animate;this.mapService.fitBounds(t,e||Jq(Jq({},r),{},{animate:i}))}},{key:"setZoomAndCenter",value:function(t,e){this.mapService.setZoomAndCenter(t,e)}},{key:"setMapStyle",value:function(t){this.mapService.setMapStyle(t)}},{key:"setMapStatus",value:function(t){this.mapService.setMapStatus(t)}},{key:"pixelToLngLat",value:function(t){return this.mapService.pixelToLngLat(t)}},{key:"lngLatToPixel",value:function(t){return this.mapService.lngLatToPixel(t)}},{key:"containerToLngLat",value:function(t){return this.mapService.containerToLngLat(t)}},{key:"lngLatToContainer",value:function(t){return this.mapService.lngLatToContainer(t)}},{key:"destroy",value:function(){this.sceneService.destroy()}},{key:"registerPostProcessingPass",value:function(t,e){this.container.bind(J2.IPostProcessingPass).to(t).whenTargetNamed(e)}},{key:"enableShaderPick",value:function(){this.layerService.enableShaderPick()}},{key:"diasbleShaderPick",value:function(){this.layerService.disableShaderPick()}},{key:"enableBoxSelect",value:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.boxSelect.enable(),e&&this.boxSelect.once("selectend",(function(){t.disableBoxSelect()}))}},{key:"disableBoxSelect",value:function(){this.boxSelect.disable()}},{key:"getPointSizeRange",value:function(){return this.sceneService.getPointSizeRange()}},{key:"initComponent",value:function(t){var e,n;this.controlService.init({container:(e=t,n=e,"string"==typeof e&&(n=F$.document.getElementById(e)),n)},this.container),this.markerService.init(this.container),this.popupService.init(this.container)}},{key:"initControl",value:function(){var t=this.sceneService.getSceneConfig(),e=t.logoVisible,n=t.logoPosition;e&&this.addControl(new f9({position:n}))}}]),t}();void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t}),void 0===Math.sign&&(Math.sign=function(t){return t<0?-1:t>0?1:+t}),"name"in Function.prototype==!1&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var r=arguments[n];if(null!=r)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e});var fpt=100,ppt=306,dpt=1e3,mpt=1001,vpt=1002,gpt=1003,ypt=1004,xpt=1005,bpt=1006,_pt=1008,wpt=1009,Spt=1012,Mpt=1014,Ept=1015,Apt=1016,Tpt=1020,Cpt=1022,Opt=1023,kpt=1026,Ppt=1027,Lpt=2300,Rpt=2301,Ipt=2302,Npt=2400,Dpt=2401,Fpt=2402,jpt=3e3,Bpt=3001,zpt=3002,Upt=7680,Vpt=35044,Gpt=35048;function Wpt(){}Object.assign(Wpt.prototype,{addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[t]&&-1!==n[t].indexOf(e)},removeEventListener:function(t,e){if(void 0!==this._listeners){var n=this._listeners[t];if(void 0!==n){var r=n.indexOf(e);-1!==r&&n.splice(r,1)}}},dispatchEvent:function(t){if(void 0!==this._listeners){var e=this._listeners[t.type];if(void 0!==e){t.target=this;for(var n=e.slice(0),r=0,i=n.length;r<i;r++)n[r].call(this,t)}}}});for(var Hpt=[],Ypt=0;Ypt<256;Ypt++)Hpt[Ypt]=(Ypt<16?"0":"")+Ypt.toString(16);var Xpt,qpt={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(Hpt[255&t]+Hpt[t>>8&255]+Hpt[t>>16&255]+Hpt[t>>24&255]+"-"+Hpt[255&e]+Hpt[e>>8&255]+"-"+Hpt[e>>16&15|64]+Hpt[e>>24&255]+"-"+Hpt[63&n|128]+Hpt[n>>8&255]+"-"+Hpt[n>>16&255]+Hpt[n>>24&255]+Hpt[255&r]+Hpt[r>>8&255]+Hpt[r>>16&255]+Hpt[r>>24&255]).toUpperCase()},clamp:function(t,e,n){return Math.max(e,Math.min(n,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,n,r,i){return r+(t-e)*(i-r)/(n-e)},lerp:function(t,e,n){return(1-n)*t+n*e},smoothstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*(3-2*t)},smootherstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*qpt.DEG2RAD},radToDeg:function(t){return t*qpt.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},setQuaternionFromProperEuler:function(t,e,n,r,i){var o=Math.cos,a=Math.sin,s=o(n/2),u=a(n/2),c=o((e+r)/2),l=a((e+r)/2),h=o((e-r)/2),f=a((e-r)/2),p=o((r-e)/2),d=a((r-e)/2);"XYX"===i?t.set(s*l,u*h,u*f,s*c):"YZY"===i?t.set(u*f,s*l,u*h,s*c):"ZXZ"===i?t.set(u*h,u*f,s*l,s*c):"XZX"===i?t.set(s*l,u*d,u*p,s*c):"YXY"===i?t.set(u*p,s*l,u*d,s*c):"ZYZ"===i&&t.set(u*d,u*p,s*l,s*c)}};function Zpt(t,e){this.x=t||0,this.y=e||0}function $pt(){this.elements=[1,0,0,0,1,0,0,0,1]}Object.defineProperties(Zpt.prototype,{width:{get:function(){return this.x},set:function(t){this.x=t}},height:{get:function(){return this.y},set:function(t){this.y=t}}}),Object.assign(Zpt.prototype,{isVector2:!0,set:function(t,e){return this.x=t,this.y=e,this},setScalar:function(t){return this.x=t,this.y=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,e){return void 0!==e?this.addVectors(t,e):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this},sub:function(t,e){return void 0!==e?this.subVectors(t,e):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){return this.multiplyScalar(1/t)},applyMatrix3:function(t){var e=this.x,n=this.y,r=t.elements;return this.x=r[0]*e+r[3]*n+r[6],this.y=r[1]*e+r[4]*n+r[7],this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this},clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},cross:function(t){return this.x*t.y-this.y*t.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){return Math.atan2(-this.y,-this.x)+Math.PI},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,n=this.y-t.y;return e*e+n*n},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t},fromBufferAttribute:function(t,e,n){return this.x=t.getX(e),this.y=t.getY(e),this},rotateAround:function(t,e){var n=Math.cos(e),r=Math.sin(e),i=this.x-t.x,o=this.y-t.y;return this.x=i*n-o*r+t.x,this.y=i*r+o*n+t.y,this}}),Object.assign($pt.prototype,{isMatrix3:!0,set:function(t,e,n,r,i,o,a,s,u){var c=this.elements;return c[0]=t,c[1]=r,c[2]=a,c[3]=e,c[4]=i,c[5]=s,c[6]=n,c[7]=o,c[8]=u,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){var e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this},extractBasis:function(t,e,n){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this},setFromMatrix4:function(t){var e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this},multiply:function(t){return this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var n=t.elements,r=e.elements,i=this.elements,o=n[0],a=n[3],s=n[6],u=n[1],c=n[4],l=n[7],h=n[2],f=n[5],p=n[8],d=r[0],m=r[3],v=r[6],g=r[1],y=r[4],x=r[7],b=r[2],_=r[5],w=r[8];return i[0]=o*d+a*g+s*b,i[3]=o*m+a*y+s*_,i[6]=o*v+a*x+s*w,i[1]=u*d+c*g+l*b,i[4]=u*m+c*y+l*_,i[7]=u*v+c*x+l*w,i[2]=h*d+f*g+p*b,i[5]=h*m+f*y+p*_,i[8]=h*v+f*x+p*w,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this},determinant:function(){var t=this.elements,e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],s=t[6],u=t[7],c=t[8];return e*o*c-e*a*u-n*i*c+n*a*s+r*i*u-r*o*s},getInverse:function(t,e){var n=t.elements,r=this.elements,i=n[0],o=n[1],a=n[2],s=n[3],u=n[4],c=n[5],l=n[6],h=n[7],f=n[8],p=f*u-c*h,d=c*l-f*s,m=h*s-u*l,v=i*p+o*d+a*m;if(0===v)return this.set(0,0,0,0,0,0,0,0,0);var g=1/v;return r[0]=p*g,r[1]=(a*h-f*o)*g,r[2]=(c*o-a*u)*g,r[3]=d*g,r[4]=(f*i-a*l)*g,r[5]=(a*s-c*i)*g,r[6]=m*g,r[7]=(o*l-h*i)*g,r[8]=(u*i-o*s)*g,this},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this},getNormalMatrix:function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},transposeIntoArray:function(t){var e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this},setUvTransform:function(t,e,n,r,i,o,a){var s=Math.cos(i),u=Math.sin(i);this.set(n*s,n*u,-n*(s*o+u*a)+o+t,-r*u,r*s,-r*(-u*o+s*a)+a+e,0,0,1)},scale:function(t,e){var n=this.elements;return n[0]*=t,n[3]*=t,n[6]*=t,n[1]*=e,n[4]*=e,n[7]*=e,this},rotate:function(t){var e=Math.cos(t),n=Math.sin(t),r=this.elements,i=r[0],o=r[3],a=r[6],s=r[1],u=r[4],c=r[7];return r[0]=e*i+n*s,r[3]=e*o+n*u,r[6]=e*a+n*c,r[1]=-n*i+e*s,r[4]=-n*o+e*u,r[7]=-n*a+e*c,this},translate:function(t,e){var n=this.elements;return n[0]+=t*n[2],n[3]+=t*n[5],n[6]+=t*n[8],n[1]+=e*n[2],n[4]+=e*n[5],n[7]+=e*n[8],this},equals:function(t){for(var e=this.elements,n=t.elements,r=0;r<9;r++)if(e[r]!==n[r])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var n=0;n<9;n++)this.elements[n]=t[n+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}});var Kpt={getDataURL:function(t){var e;if("undefined"==typeof HTMLCanvasElement)return t.src;if(t instanceof HTMLCanvasElement)e=t;else{void 0===Xpt&&(Xpt=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),Xpt.width=t.width,Xpt.height=t.height;var n=Xpt.getContext("2d");t instanceof ImageData?n.putImageData(t,0,0):n.drawImage(t,0,0,t.width,t.height),e=Xpt}return e.width>2048||e.height>2048?e.toDataURL("image/jpeg",.6):e.toDataURL("image/png")}},Jpt=0;function Qpt(t,e,n,r,i,o,a,s,u,c){Object.defineProperty(this,"id",{value:Jpt++}),this.uuid=qpt.generateUUID(),this.name="",this.image=void 0!==t?t:Qpt.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==e?e:Qpt.DEFAULT_MAPPING,this.wrapS=void 0!==n?n:mpt,this.wrapT=void 0!==r?r:mpt,this.magFilter=void 0!==i?i:bpt,this.minFilter=void 0!==o?o:_pt,this.anisotropy=void 0!==u?u:1,this.format=void 0!==a?a:Opt,this.internalFormat=null,this.type=void 0!==s?s:wpt,this.offset=new Zpt(0,0),this.repeat=new Zpt(1,1),this.center=new Zpt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new $pt,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==c?c:jpt,this.version=0,this.onUpdate=null}function tdt(t,e,n,r){this.x=t||0,this.y=e||0,this.z=n||0,this.w=void 0!==r?r:1}function edt(t,e,n){this.width=t,this.height=e,this.scissor=new tdt(0,0,t,e),this.scissorTest=!1,this.viewport=new tdt(0,0,t,e),n=n||{},this.texture=new Qpt(void 0,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.image={},this.texture.image.width=t,this.texture.image.height=e,this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:bpt,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0===n.stencilBuffer||n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null}function ndt(t,e,n){edt.call(this,t,e,n),this.samples=4}function rdt(t,e,n,r){this._x=t||0,this._y=e||0,this._z=n||0,this._w=void 0!==r?r:1}Qpt.DEFAULT_IMAGE=void 0,Qpt.DEFAULT_MAPPING=300,Qpt.prototype=Object.assign(Object.create(Wpt.prototype),{constructor:Qpt,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},toJSON:function(t){var e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];var n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){var r=this.image;if(void 0===r.uuid&&(r.uuid=qpt.generateUUID()),!e&&void 0===t.images[r.uuid]){var i;if(Array.isArray(r)){i=[];for(var o=0,a=r.length;o<a;o++)i.push(Kpt.getDataURL(r[o]))}else i=Kpt.getDataURL(r);t.images[r.uuid]={uuid:r.uuid,url:i}}n.image=r.uuid}return e||(t.textures[this.uuid]=n),n},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case dpt:t.x=t.x-Math.floor(t.x);break;case mpt:t.x=t.x<0?0:1;break;case vpt:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case dpt:t.y=t.y-Math.floor(t.y);break;case mpt:t.y=t.y<0?0:1;break;case vpt:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}}),Object.defineProperty(Qpt.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.defineProperties(tdt.prototype,{width:{get:function(){return this.z},set:function(t){this.z=t}},height:{get:function(){return this.w},set:function(t){this.w=t}}}),Object.assign(tdt.prototype,{isVector4:!0,set:function(t,e,n,r){return this.x=t,this.y=e,this.z=n,this.w=r,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this.w=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,e){return void 0!==e?this.addVectors(t,e):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this},sub:function(t,e){return void 0!==e?this.subVectors(t,e):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},applyMatrix4:function(t){var e=this.x,n=this.y,r=this.z,i=this.w,o=t.elements;return this.x=o[0]*e+o[4]*n+o[8]*r+o[12]*i,this.y=o[1]*e+o[5]*n+o[9]*r+o[13]*i,this.z=o[2]*e+o[6]*n+o[10]*r+o[14]*i,this.w=o[3]*e+o[7]*n+o[11]*r+o[15]*i,this},divideScalar:function(t){return this.multiplyScalar(1/t)},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this},setAxisAngleFromRotationMatrix:function(t){var e,n,r,i,o=.01,a=.1,s=t.elements,u=s[0],c=s[4],l=s[8],h=s[1],f=s[5],p=s[9],d=s[2],m=s[6],v=s[10];if(Math.abs(c-h)<o&&Math.abs(l-d)<o&&Math.abs(p-m)<o){if(Math.abs(c+h)<a&&Math.abs(l+d)<a&&Math.abs(p+m)<a&&Math.abs(u+f+v-3)<a)return this.set(1,0,0,0),this;e=Math.PI;var g=(u+1)/2,y=(f+1)/2,x=(v+1)/2,b=(c+h)/4,_=(l+d)/4,w=(p+m)/4;return g>y&&g>x?g<o?(n=0,r=.707106781,i=.707106781):(r=b/(n=Math.sqrt(g)),i=_/n):y>x?y<o?(n=.707106781,r=0,i=.707106781):(n=b/(r=Math.sqrt(y)),i=w/r):x<o?(n=.707106781,r=.707106781,i=0):(n=_/(i=Math.sqrt(x)),r=w/i),this.set(n,r,i,e),this}var S=Math.sqrt((m-p)*(m-p)+(l-d)*(l-d)+(h-c)*(h-c));return Math.abs(S)<.001&&(S=1),this.x=(m-p)/S,this.y=(l-d)/S,this.z=(h-c)/S,this.w=Math.acos((u+f+v-1)/2),this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this.w=Math.max(t,Math.min(e,this.w)),this},clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t},fromBufferAttribute:function(t,e,n){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}}),edt.prototype=Object.assign(Object.create(Wpt.prototype),{constructor:edt,isWebGLRenderTarget:!0,setSize:function(t,e){this.width===t&&this.height===e||(this.width=t,this.height=e,this.texture.image.width=t,this.texture.image.height=e,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.width=t.width,this.height=t.height,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),ndt.prototype=Object.assign(Object.create(edt.prototype),{constructor:ndt,isWebGLMultisampleRenderTarget:!0,copy:function(t){return edt.prototype.copy.call(this,t),this.samples=t.samples,this}}),Object.assign(rdt,{slerp:function(t,e,n,r){return n.copy(t).slerp(e,r)},slerpFlat:function(t,e,n,r,i,o,a){var s=n[r+0],u=n[r+1],c=n[r+2],l=n[r+3],h=i[o+0],f=i[o+1],p=i[o+2],d=i[o+3];if(l!==d||s!==h||u!==f||c!==p){var m=1-a,v=s*h+u*f+c*p+l*d,g=v>=0?1:-1,y=1-v*v;if(y>Number.EPSILON){var x=Math.sqrt(y),b=Math.atan2(x,v*g);m=Math.sin(m*b)/x,a=Math.sin(a*b)/x}var _=a*g;if(s=s*m+h*_,u=u*m+f*_,c=c*m+p*_,l=l*m+d*_,m===1-a){var w=1/Math.sqrt(s*s+u*u+c*c+l*l);s*=w,u*=w,c*=w,l*=w}}t[e]=s,t[e+1]=u,t[e+2]=c,t[e+3]=l}}),Object.defineProperties(rdt.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},w:{get:function(){return this._w},set:function(t){this._w=t,this._onChangeCallback()}}}),Object.assign(rdt.prototype,{isQuaternion:!0,set:function(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._w=r,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this},setFromEuler:function(t,e){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=t._x,r=t._y,i=t._z,o=t.order,a=Math.cos,s=Math.sin,u=a(n/2),c=a(r/2),l=a(i/2),h=s(n/2),f=s(r/2),p=s(i/2);return"XYZ"===o?(this._x=h*c*l+u*f*p,this._y=u*f*l-h*c*p,this._z=u*c*p+h*f*l,this._w=u*c*l-h*f*p):"YXZ"===o?(this._x=h*c*l+u*f*p,this._y=u*f*l-h*c*p,this._z=u*c*p-h*f*l,this._w=u*c*l+h*f*p):"ZXY"===o?(this._x=h*c*l-u*f*p,this._y=u*f*l+h*c*p,this._z=u*c*p+h*f*l,this._w=u*c*l-h*f*p):"ZYX"===o?(this._x=h*c*l-u*f*p,this._y=u*f*l+h*c*p,this._z=u*c*p-h*f*l,this._w=u*c*l+h*f*p):"YZX"===o?(this._x=h*c*l+u*f*p,this._y=u*f*l+h*c*p,this._z=u*c*p-h*f*l,this._w=u*c*l-h*f*p):"XZY"===o&&(this._x=h*c*l-u*f*p,this._y=u*f*l-h*c*p,this._z=u*c*p+h*f*l,this._w=u*c*l+h*f*p),!1!==e&&this._onChangeCallback(),this},setFromAxisAngle:function(t,e){var n=e/2,r=Math.sin(n);return this._x=t.x*r,this._y=t.y*r,this._z=t.z*r,this._w=Math.cos(n),this._onChangeCallback(),this},setFromRotationMatrix:function(t){var e,n=t.elements,r=n[0],i=n[4],o=n[8],a=n[1],s=n[5],u=n[9],c=n[2],l=n[6],h=n[10],f=r+s+h;return f>0?(e=.5/Math.sqrt(f+1),this._w=.25/e,this._x=(l-u)*e,this._y=(o-c)*e,this._z=(a-i)*e):r>s&&r>h?(e=2*Math.sqrt(1+r-s-h),this._w=(l-u)/e,this._x=.25*e,this._y=(i+a)/e,this._z=(o+c)/e):s>h?(e=2*Math.sqrt(1+s-r-h),this._w=(o-c)/e,this._x=(i+a)/e,this._y=.25*e,this._z=(u+l)/e):(e=2*Math.sqrt(1+h-r-s),this._w=(a-i)/e,this._x=(o+c)/e,this._y=(u+l)/e,this._z=.25*e),this._onChangeCallback(),this},setFromUnitVectors:function(t,e){var n=t.dot(e)+1;return n<1e-6?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=n):(this._x=0,this._y=-t.z,this._z=t.y,this._w=n)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=n),this.normalize()},angleTo:function(t){return 2*Math.acos(Math.abs(qpt.clamp(this.dot(t),-1,1)))},rotateTowards:function(t,e){var n=this.angleTo(t);if(0===n)return this;var r=Math.min(1,e/n);return this.slerp(t,r),this},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this},multiply:function(t,e){return void 0!==e?this.multiplyQuaternions(t,e):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,e){var n=t._x,r=t._y,i=t._z,o=t._w,a=e._x,s=e._y,u=e._z,c=e._w;return this._x=n*c+o*a+r*u-i*s,this._y=r*c+o*s+i*a-n*u,this._z=i*c+o*u+n*s-r*a,this._w=o*c-n*a-r*s-i*u,this._onChangeCallback(),this},slerp:function(t,e){if(0===e)return this;if(1===e)return this.copy(t);var n=this._x,r=this._y,i=this._z,o=this._w,a=o*t._w+n*t._x+r*t._y+i*t._z;if(a<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,a=-a):this.copy(t),a>=1)return this._w=o,this._x=n,this._y=r,this._z=i,this;var s=1-a*a;if(s<=Number.EPSILON){var u=1-e;return this._w=u*o+e*this._w,this._x=u*n+e*this._x,this._y=u*r+e*this._y,this._z=u*i+e*this._z,this.normalize(),this._onChangeCallback(),this}var c=Math.sqrt(s),l=Math.atan2(c,a),h=Math.sin((1-e)*l)/c,f=Math.sin(e*l)/c;return this._w=o*h+this._w*f,this._x=n*h+this._x*f,this._y=r*h+this._y*f,this._z=i*h+this._z*f,this._onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},fromBufferAttribute:function(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){}});var idt=new adt,odt=new rdt;function adt(t,e,n){this.x=t||0,this.y=e||0,this.z=n||0}Object.assign(adt.prototype,{isVector3:!0,set:function(t,e,n){return this.x=t,this.y=e,this.z=n,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,e){return void 0!==e?this.addVectors(t,e):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},sub:function(t,e){return void 0!==e?this.subVectors(t,e):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},multiply:function(t,e){return void 0!==e?this.multiplyVectors(t,e):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},applyEuler:function(t){return!t||t.isEuler,this.applyQuaternion(odt.setFromEuler(t))},applyAxisAngle:function(t,e){return this.applyQuaternion(odt.setFromAxisAngle(t,e))},applyMatrix3:function(t){var e=this.x,n=this.y,r=this.z,i=t.elements;return this.x=i[0]*e+i[3]*n+i[6]*r,this.y=i[1]*e+i[4]*n+i[7]*r,this.z=i[2]*e+i[5]*n+i[8]*r,this},applyNormalMatrix:function(t){return this.applyMatrix3(t).normalize()},applyMatrix4:function(t){var e=this.x,n=this.y,r=this.z,i=t.elements,o=1/(i[3]*e+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*e+i[4]*n+i[8]*r+i[12])*o,this.y=(i[1]*e+i[5]*n+i[9]*r+i[13])*o,this.z=(i[2]*e+i[6]*n+i[10]*r+i[14])*o,this},applyQuaternion:function(t){var e=this.x,n=this.y,r=this.z,i=t.x,o=t.y,a=t.z,s=t.w,u=s*e+o*r-a*n,c=s*n+a*e-i*r,l=s*r+i*n-o*e,h=-i*e-o*n-a*r;return this.x=u*s+h*-i+c*-a-l*-o,this.y=c*s+h*-o+l*-i-u*-a,this.z=l*s+h*-a+u*-o-c*-i,this},project:function(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)},unproject:function(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)},transformDirection:function(t){var e=this.x,n=this.y,r=this.z,i=t.elements;return this.x=i[0]*e+i[4]*n+i[8]*r,this.y=i[1]*e+i[5]*n+i[9]*r,this.z=i[2]*e+i[6]*n+i[10]*r,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this},clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},cross:function(t,e){return void 0!==e?this.crossVectors(t,e):this.crossVectors(this,t)},crossVectors:function(t,e){var n=t.x,r=t.y,i=t.z,o=e.x,a=e.y,s=e.z;return this.x=r*s-i*a,this.y=i*o-n*s,this.z=n*a-r*o,this},projectOnVector:function(t){var e=t.lengthSq();if(0===e)return this.set(0,0,0);var n=t.dot(this)/e;return this.copy(t).multiplyScalar(n)},projectOnPlane:function(t){return idt.copy(this).projectOnVector(t),this.sub(idt)},reflect:function(t){return this.sub(idt.copy(t).multiplyScalar(2*this.dot(t)))},angleTo:function(t){var e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;var n=this.dot(t)/e;return Math.acos(qpt.clamp(n,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,n=this.y-t.y,r=this.z-t.z;return e*e+n*n+r*r},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)},setFromSphericalCoords:function(t,e,n){var r=Math.sin(e)*t;return this.x=r*Math.sin(n),this.y=Math.cos(e)*t,this.z=r*Math.cos(n),this},setFromCylindrical:function(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)},setFromCylindricalCoords:function(t,e,n){return this.x=t*Math.sin(e),this.y=n,this.z=t*Math.cos(e),this},setFromMatrixPosition:function(t){var e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this},setFromMatrixScale:function(t){var e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),r=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=r,this},setFromMatrixColumn:function(t,e){return this.fromArray(t.elements,4*e)},setFromMatrix3Column:function(t,e){return this.fromArray(t.elements,3*e)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t},fromBufferAttribute:function(t,e,n){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}});var sdt=new adt,udt=new ddt,cdt=new adt(0,0,0),ldt=new adt(1,1,1),hdt=new adt,fdt=new adt,pdt=new adt;function ddt(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}Object.assign(ddt.prototype,{isMatrix4:!0,set:function(t,e,n,r,i,o,a,s,u,c,l,h,f,p,d,m){var v=this.elements;return v[0]=t,v[4]=e,v[8]=n,v[12]=r,v[1]=i,v[5]=o,v[9]=a,v[13]=s,v[2]=u,v[6]=c,v[10]=l,v[14]=h,v[3]=f,v[7]=p,v[11]=d,v[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new ddt).fromArray(this.elements)},copy:function(t){var e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],this},copyPosition:function(t){var e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this},extractBasis:function(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},makeBasis:function(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this},extractRotation:function(t){var e=this.elements,n=t.elements,r=1/sdt.setFromMatrixColumn(t,0).length(),i=1/sdt.setFromMatrixColumn(t,1).length(),o=1/sdt.setFromMatrixColumn(t,2).length();return e[0]=n[0]*r,e[1]=n[1]*r,e[2]=n[2]*r,e[3]=0,e[4]=n[4]*i,e[5]=n[5]*i,e[6]=n[6]*i,e[7]=0,e[8]=n[8]*o,e[9]=n[9]*o,e[10]=n[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromEuler:function(t){!t||t.isEuler;var e=this.elements,n=t.x,r=t.y,i=t.z,o=Math.cos(n),a=Math.sin(n),s=Math.cos(r),u=Math.sin(r),c=Math.cos(i),l=Math.sin(i);if("XYZ"===t.order){var h=o*c,f=o*l,p=a*c,d=a*l;e[0]=s*c,e[4]=-s*l,e[8]=u,e[1]=f+p*u,e[5]=h-d*u,e[9]=-a*s,e[2]=d-h*u,e[6]=p+f*u,e[10]=o*s}else if("YXZ"===t.order){var m=s*c,v=s*l,g=u*c,y=u*l;e[0]=m+y*a,e[4]=g*a-v,e[8]=o*u,e[1]=o*l,e[5]=o*c,e[9]=-a,e[2]=v*a-g,e[6]=y+m*a,e[10]=o*s}else if("ZXY"===t.order){m=s*c,v=s*l,g=u*c,y=u*l;e[0]=m-y*a,e[4]=-o*l,e[8]=g+v*a,e[1]=v+g*a,e[5]=o*c,e[9]=y-m*a,e[2]=-o*u,e[6]=a,e[10]=o*s}else if("ZYX"===t.order){h=o*c,f=o*l,p=a*c,d=a*l;e[0]=s*c,e[4]=p*u-f,e[8]=h*u+d,e[1]=s*l,e[5]=d*u+h,e[9]=f*u-p,e[2]=-u,e[6]=a*s,e[10]=o*s}else if("YZX"===t.order){var x=o*s,b=o*u,_=a*s,w=a*u;e[0]=s*c,e[4]=w-x*l,e[8]=_*l+b,e[1]=l,e[5]=o*c,e[9]=-a*c,e[2]=-u*c,e[6]=b*l+_,e[10]=x-w*l}else if("XZY"===t.order){x=o*s,b=o*u,_=a*s,w=a*u;e[0]=s*c,e[4]=-l,e[8]=u*c,e[1]=x*l+w,e[5]=o*c,e[9]=b*l-_,e[2]=_*l-b,e[6]=a*c,e[10]=w*l+x}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromQuaternion:function(t){return this.compose(cdt,t,ldt)},lookAt:function(t,e,n){var r=this.elements;return pdt.subVectors(t,e),0===pdt.lengthSq()&&(pdt.z=1),pdt.normalize(),hdt.crossVectors(n,pdt),0===hdt.lengthSq()&&(1===Math.abs(n.z)?pdt.x+=1e-4:pdt.z+=1e-4,pdt.normalize(),hdt.crossVectors(n,pdt)),hdt.normalize(),fdt.crossVectors(pdt,hdt),r[0]=hdt.x,r[4]=fdt.x,r[8]=pdt.x,r[1]=hdt.y,r[5]=fdt.y,r[9]=pdt.y,r[2]=hdt.z,r[6]=fdt.z,r[10]=pdt.z,this},multiply:function(t,e){return void 0!==e?this.multiplyMatrices(t,e):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var n=t.elements,r=e.elements,i=this.elements,o=n[0],a=n[4],s=n[8],u=n[12],c=n[1],l=n[5],h=n[9],f=n[13],p=n[2],d=n[6],m=n[10],v=n[14],g=n[3],y=n[7],x=n[11],b=n[15],_=r[0],w=r[4],S=r[8],M=r[12],E=r[1],A=r[5],T=r[9],C=r[13],O=r[2],k=r[6],P=r[10],L=r[14],R=r[3],I=r[7],N=r[11],D=r[15];return i[0]=o*_+a*E+s*O+u*R,i[4]=o*w+a*A+s*k+u*I,i[8]=o*S+a*T+s*P+u*N,i[12]=o*M+a*C+s*L+u*D,i[1]=c*_+l*E+h*O+f*R,i[5]=c*w+l*A+h*k+f*I,i[9]=c*S+l*T+h*P+f*N,i[13]=c*M+l*C+h*L+f*D,i[2]=p*_+d*E+m*O+v*R,i[6]=p*w+d*A+m*k+v*I,i[10]=p*S+d*T+m*P+v*N,i[14]=p*M+d*C+m*L+v*D,i[3]=g*_+y*E+x*O+b*R,i[7]=g*w+y*A+x*k+b*I,i[11]=g*S+y*T+x*P+b*N,i[15]=g*M+y*C+x*L+b*D,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},determinant:function(){var t=this.elements,e=t[0],n=t[4],r=t[8],i=t[12],o=t[1],a=t[5],s=t[9],u=t[13],c=t[2],l=t[6],h=t[10],f=t[14];return t[3]*(+i*s*l-r*u*l-i*a*h+n*u*h+r*a*f-n*s*f)+t[7]*(+e*s*f-e*u*h+i*o*h-r*o*f+r*u*c-i*s*c)+t[11]*(+e*u*l-e*a*f-i*o*l+n*o*f+i*a*c-n*u*c)+t[15]*(-r*a*c-e*s*l+e*a*h+r*o*l-n*o*h+n*s*c)},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},setPosition:function(t,e,n){var r=this.elements;return t.isVector3?(r[12]=t.x,r[13]=t.y,r[14]=t.z):(r[12]=t,r[13]=e,r[14]=n),this},getInverse:function(t,e){var n=this.elements,r=t.elements,i=r[0],o=r[1],a=r[2],s=r[3],u=r[4],c=r[5],l=r[6],h=r[7],f=r[8],p=r[9],d=r[10],m=r[11],v=r[12],g=r[13],y=r[14],x=r[15],b=p*y*h-g*d*h+g*l*m-c*y*m-p*l*x+c*d*x,_=v*d*h-f*y*h-v*l*m+u*y*m+f*l*x-u*d*x,w=f*g*h-v*p*h+v*c*m-u*g*m-f*c*x+u*p*x,S=v*p*l-f*g*l-v*c*d+u*g*d+f*c*y-u*p*y,M=i*b+o*_+a*w+s*S;if(0===M)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);var E=1/M;return n[0]=b*E,n[1]=(g*d*s-p*y*s-g*a*m+o*y*m+p*a*x-o*d*x)*E,n[2]=(c*y*s-g*l*s+g*a*h-o*y*h-c*a*x+o*l*x)*E,n[3]=(p*l*s-c*d*s-p*a*h+o*d*h+c*a*m-o*l*m)*E,n[4]=_*E,n[5]=(f*y*s-v*d*s+v*a*m-i*y*m-f*a*x+i*d*x)*E,n[6]=(v*l*s-u*y*s-v*a*h+i*y*h+u*a*x-i*l*x)*E,n[7]=(u*d*s-f*l*s+f*a*h-i*d*h-u*a*m+i*l*m)*E,n[8]=w*E,n[9]=(v*p*s-f*g*s-v*o*m+i*g*m+f*o*x-i*p*x)*E,n[10]=(u*g*s-v*c*s+v*o*h-i*g*h-u*o*x+i*c*x)*E,n[11]=(f*c*s-u*p*s-f*o*h+i*p*h+u*o*m-i*c*m)*E,n[12]=S*E,n[13]=(f*g*a-v*p*a+v*o*d-i*g*d-f*o*y+i*p*y)*E,n[14]=(v*c*a-u*g*a-v*o*l+i*g*l+u*o*y-i*c*y)*E,n[15]=(u*p*a-f*c*a+f*o*l-i*p*l-u*o*d+i*c*d)*E,this},scale:function(t){var e=this.elements,n=t.x,r=t.y,i=t.z;return e[0]*=n,e[4]*=r,e[8]*=i,e[1]*=n,e[5]*=r,e[9]*=i,e[2]*=n,e[6]*=r,e[10]*=i,e[3]*=n,e[7]*=r,e[11]*=i,this},getMaxScaleOnAxis:function(){var t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],r=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,n,r))},makeTranslation:function(t,e,n){return this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this},makeRotationX:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this},makeRotationY:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this},makeRotationZ:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,e){var n=Math.cos(e),r=Math.sin(e),i=1-n,o=t.x,a=t.y,s=t.z,u=i*o,c=i*a;return this.set(u*o+n,u*a-r*s,u*s+r*a,0,u*a+r*s,c*a+n,c*s-r*o,0,u*s-r*a,c*s+r*o,i*s*s+n,0,0,0,0,1),this},makeScale:function(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this},makeShear:function(t,e,n){return this.set(1,e,n,0,t,1,n,0,t,e,1,0,0,0,0,1),this},compose:function(t,e,n){var r=this.elements,i=e._x,o=e._y,a=e._z,s=e._w,u=i+i,c=o+o,l=a+a,h=i*u,f=i*c,p=i*l,d=o*c,m=o*l,v=a*l,g=s*u,y=s*c,x=s*l,b=n.x,_=n.y,w=n.z;return r[0]=(1-(d+v))*b,r[1]=(f+x)*b,r[2]=(p-y)*b,r[3]=0,r[4]=(f-x)*_,r[5]=(1-(h+v))*_,r[6]=(m+g)*_,r[7]=0,r[8]=(p+y)*w,r[9]=(m-g)*w,r[10]=(1-(h+d))*w,r[11]=0,r[12]=t.x,r[13]=t.y,r[14]=t.z,r[15]=1,this},decompose:function(t,e,n){var r=this.elements,i=sdt.set(r[0],r[1],r[2]).length(),o=sdt.set(r[4],r[5],r[6]).length(),a=sdt.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),t.x=r[12],t.y=r[13],t.z=r[14],udt.copy(this);var s=1/i,u=1/o,c=1/a;return udt.elements[0]*=s,udt.elements[1]*=s,udt.elements[2]*=s,udt.elements[4]*=u,udt.elements[5]*=u,udt.elements[6]*=u,udt.elements[8]*=c,udt.elements[9]*=c,udt.elements[10]*=c,e.setFromRotationMatrix(udt),n.x=i,n.y=o,n.z=a,this},makePerspective:function(t,e,n,r,i,o){var a=this.elements,s=2*i/(e-t),u=2*i/(n-r),c=(e+t)/(e-t),l=(n+r)/(n-r),h=-(o+i)/(o-i),f=-2*o*i/(o-i);return a[0]=s,a[4]=0,a[8]=c,a[12]=0,a[1]=0,a[5]=u,a[9]=l,a[13]=0,a[2]=0,a[6]=0,a[10]=h,a[14]=f,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makeOrthographic:function(t,e,n,r,i,o){var a=this.elements,s=1/(e-t),u=1/(n-r),c=1/(o-i),l=(e+t)*s,h=(n+r)*u,f=(o+i)*c;return a[0]=2*s,a[4]=0,a[8]=0,a[12]=-l,a[1]=0,a[5]=2*u,a[9]=0,a[13]=-h,a[2]=0,a[6]=0,a[10]=-2*c,a[14]=-f,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},equals:function(t){for(var e=this.elements,n=t.elements,r=0;r<16;r++)if(e[r]!==n[r])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var n=0;n<16;n++)this.elements[n]=t[n+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}});var mdt=new ddt,vdt=new rdt;function gdt(t,e,n,r){this._x=t||0,this._y=e||0,this._z=n||0,this._order=r||gdt.DefaultOrder}function ydt(){this.mask=1}gdt.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],gdt.DefaultOrder="XYZ",Object.defineProperties(gdt.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},order:{get:function(){return this._order},set:function(t){this._order=t,this._onChangeCallback()}}}),Object.assign(gdt.prototype,{isEuler:!0,set:function(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._order=r||this._order,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this},setFromRotationMatrix:function(t,e,n){var r=qpt.clamp,i=t.elements,o=i[0],a=i[4],s=i[8],u=i[1],c=i[5],l=i[9],h=i[2],f=i[6],p=i[10];return"XYZ"===(e=e||this._order)?(this._y=Math.asin(r(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-l,p),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(f,c),this._z=0)):"YXZ"===e?(this._x=Math.asin(-r(l,-1,1)),Math.abs(l)<.9999999?(this._y=Math.atan2(s,p),this._z=Math.atan2(u,c)):(this._y=Math.atan2(-h,o),this._z=0)):"ZXY"===e?(this._x=Math.asin(r(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(-h,p),this._z=Math.atan2(-a,c)):(this._y=0,this._z=Math.atan2(u,o))):"ZYX"===e?(this._y=Math.asin(-r(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(f,p),this._z=Math.atan2(u,o)):(this._x=0,this._z=Math.atan2(-a,c))):"YZX"===e?(this._z=Math.asin(r(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-l,c),this._y=Math.atan2(-h,o)):(this._x=0,this._y=Math.atan2(s,p))):"XZY"===e&&(this._z=Math.asin(-r(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(f,c),this._y=Math.atan2(s,o)):(this._x=Math.atan2(-l,p),this._y=0)),this._order=e,!1!==n&&this._onChangeCallback(),this},setFromQuaternion:function(t,e,n){return mdt.makeRotationFromQuaternion(t),this.setFromRotationMatrix(mdt,e,n)},setFromVector3:function(t,e){return this.set(t.x,t.y,t.z,e||this._order)},reorder:function(t){return vdt.setFromEuler(this),this.setFromQuaternion(vdt,t)},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new adt(this._x,this._y,this._z)},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){}}),Object.assign(ydt.prototype,{set:function(t){this.mask=1<<t|0},enable:function(t){this.mask|=1<<t|0},enableAll:function(){this.mask=-1},toggle:function(t){this.mask^=1<<t|0},disable:function(t){this.mask&=~(1<<t|0)},disableAll:function(){this.mask=0},test:function(t){return 0!=(this.mask&t.mask)}});var xdt=0,bdt=new adt,_dt=new rdt,wdt=new ddt,Sdt=new adt,Mdt=new adt,Edt=new adt,Adt=new rdt,Tdt=new adt(1,0,0),Cdt=new adt(0,1,0),Odt=new adt(0,0,1),kdt={type:"added"},Pdt={type:"removed"};function Ldt(){Object.defineProperty(this,"id",{value:xdt++}),this.uuid=qpt.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Ldt.DefaultUp.clone();var t=new adt,e=new gdt,n=new rdt,r=new adt(1,1,1);e._onChange((function(){n.setFromEuler(e,!1)})),n._onChange((function(){e.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new ddt},normalMatrix:{value:new $pt}}),this.matrix=new ddt,this.matrixWorld=new ddt,this.matrixAutoUpdate=Ldt.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new ydt,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function Rdt(){Ldt.call(this),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}Ldt.DefaultUp=new adt(0,1,0),Ldt.DefaultMatrixAutoUpdate=!0,Ldt.prototype=Object.assign(Object.create(Wpt.prototype),{constructor:Ldt,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(t){return this.quaternion.premultiply(t),this},setRotationFromAxisAngle:function(t,e){this.quaternion.setFromAxisAngle(t,e)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(t,e){return _dt.setFromAxisAngle(t,e),this.quaternion.multiply(_dt),this},rotateOnWorldAxis:function(t,e){return _dt.setFromAxisAngle(t,e),this.quaternion.premultiply(_dt),this},rotateX:function(t){return this.rotateOnAxis(Tdt,t)},rotateY:function(t){return this.rotateOnAxis(Cdt,t)},rotateZ:function(t){return this.rotateOnAxis(Odt,t)},translateOnAxis:function(t,e){return bdt.copy(t).applyQuaternion(this.quaternion),this.position.add(bdt.multiplyScalar(e)),this},translateX:function(t){return this.translateOnAxis(Tdt,t)},translateY:function(t){return this.translateOnAxis(Cdt,t)},translateZ:function(t){return this.translateOnAxis(Odt,t)},localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(t){return t.applyMatrix4(wdt.getInverse(this.matrixWorld))},lookAt:function(t,e,n){t.isVector3?Sdt.copy(t):Sdt.set(t,e,n);var r=this.parent;this.updateWorldMatrix(!0,!1),Mdt.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?wdt.lookAt(Mdt,Sdt,this.up):wdt.lookAt(Sdt,Mdt,this.up),this.quaternion.setFromRotationMatrix(wdt),r&&(wdt.extractRotation(r.matrixWorld),_dt.setFromRotationMatrix(wdt),this.quaternion.premultiply(_dt.inverse()))},add:function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this||t&&t.isObject3D&&(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(kdt)),this},remove:function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}var n=this.children.indexOf(t);return-1!==n&&(t.parent=null,this.children.splice(n,1),t.dispatchEvent(Pdt)),this},attach:function(t){return this.updateWorldMatrix(!0,!1),wdt.getInverse(this.matrixWorld),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),wdt.multiply(t.parent.matrixWorld)),t.applyMatrix4(wdt),t.updateWorldMatrix(!1,!1),this.add(t),this},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,e){if(this[t]===e)return this;for(var n=0,r=this.children.length;n<r;n++){var i=this.children[n].getObjectByProperty(t,e);if(void 0!==i)return i}},getWorldPosition:function(t){return void 0===t&&(t=new adt),this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(t){return void 0===t&&(t=new rdt),this.updateMatrixWorld(!0),this.matrixWorld.decompose(Mdt,t,Edt),t},getWorldScale:function(t){return void 0===t&&(t=new adt),this.updateMatrixWorld(!0),this.matrixWorld.decompose(Mdt,Adt,t),t},getWorldDirection:function(t){void 0===t&&(t=new adt),this.updateMatrixWorld(!0);var e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()},raycast:function(){},traverse:function(t){t(this);for(var e=this.children,n=0,r=e.length;n<r;n++)e[n].traverse(t)},traverseVisible:function(t){if(!1!==this.visible){t(this);for(var e=this.children,n=0,r=e.length;n<r;n++)e[n].traverseVisible(t)}},traverseAncestors:function(t){var e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);for(var e=this.children,n=0,r=e.length;n<r;n++)e[n].updateMatrixWorld(t)},updateWorldMatrix:function(t,e){var n=this.parent;if(!0===t&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===e)for(var r=this.children,i=0,o=r.length;i<o;i++)r[i].updateWorldMatrix(!1,!0)},toJSON:function(t){var e=void 0===t||"string"==typeof t,n={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var r={};function i(e,n){return void 0===e[n.uuid]&&(e[n.uuid]=n.toJSON(t)),n.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON()),this.isMesh||this.isLine||this.isPoints){r.geometry=i(t.geometries,this.geometry);var o=this.geometry.parameters;if(void 0!==o&&void 0!==o.shapes){var a=o.shapes;if(Array.isArray(a))for(var s=0,u=a.length;s<u;s++){var c=a[s];i(t.shapes,c)}else i(t.shapes,a)}}if(void 0!==this.material)if(Array.isArray(this.material)){var l=[];for(s=0,u=this.material.length;s<u;s++)l.push(i(t.materials,this.material[s]));r.material=l}else r.material=i(t.materials,this.material);if(this.children.length>0){r.children=[];for(s=0;s<this.children.length;s++)r.children.push(this.children[s].toJSON(t).object)}if(e){var h=m(t.geometries),f=m(t.materials),p=m(t.textures),d=m(t.images);a=m(t.shapes);h.length>0&&(n.geometries=h),f.length>0&&(n.materials=f),p.length>0&&(n.textures=p),d.length>0&&(n.images=d),a.length>0&&(n.shapes=a)}return n.object=r,n;function m(t){var e=[];for(var n in t){var r=t[n];delete r.metadata,e.push(r)}return e}},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,e){if(void 0===e&&(e=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(var n=0;n<t.children.length;n++){var r=t.children[n];this.add(r.clone())}return this}}),Rdt.prototype=Object.assign(Object.create(Ldt.prototype),{constructor:Rdt,isScene:!0,copy:function(t,e){return Ldt.prototype.copy.call(this,t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.environment&&(this.environment=t.environment.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this},toJSON:function(t){var e=Ldt.prototype.toJSON.call(this,t);return null!==this.background&&(e.object.background=this.background.toJSON(t)),null!==this.environment&&(e.object.environment=this.environment.toJSON(t)),null!==this.fog&&(e.object.fog=this.fog.toJSON()),e},dispose:function(){this.dispatchEvent({type:"dispose"})}});var Idt=[new adt,new adt,new adt,new adt,new adt,new adt,new adt,new adt],Ndt=new adt,Ddt=new Xdt,Fdt=new adt,jdt=new adt,Bdt=new adt,zdt=new adt,Udt=new adt,Vdt=new adt,Gdt=new adt,Wdt=new adt,Hdt=new adt,Ydt=new adt;function Xdt(t,e){this.min=void 0!==t?t:new adt(1/0,1/0,1/0),this.max=void 0!==e?e:new adt(-1/0,-1/0,-1/0)}function qdt(t,e,n,r,i){var o,a;for(o=0,a=t.length-3;o<=a;o+=3){Ydt.fromArray(t,o);var s=i.x*Math.abs(Ydt.x)+i.y*Math.abs(Ydt.y)+i.z*Math.abs(Ydt.z),u=e.dot(Ydt),c=n.dot(Ydt),l=r.dot(Ydt);if(Math.max(-Math.max(u,c,l),Math.min(u,c,l))>s)return!1}return!0}Object.assign(Xdt.prototype,{isBox3:!0,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromArray:function(t){for(var e=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,a=-1/0,s=0,u=t.length;s<u;s+=3){var c=t[s],l=t[s+1],h=t[s+2];c<e&&(e=c),l<n&&(n=l),h<r&&(r=h),c>i&&(i=c),l>o&&(o=l),h>a&&(a=h)}return this.min.set(e,n,r),this.max.set(i,o,a),this},setFromBufferAttribute:function(t){for(var e=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,a=-1/0,s=0,u=t.count;s<u;s++){var c=t.getX(s),l=t.getY(s),h=t.getZ(s);c<e&&(e=c),l<n&&(n=l),h<r&&(r=h),c>i&&(i=c),l>o&&(o=l),h>a&&(a=h)}return this.min.set(e,n,r),this.max.set(i,o,a),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(t,e){var n=Ndt.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this},setFromObject:function(t){return this.makeEmpty(),this.expandByObject(t)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(t){return void 0===t&&(t=new adt),this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return void 0===t&&(t=new adt),this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},expandByObject:function(t){t.updateWorldMatrix(!1,!1);var e=t.geometry;void 0!==e&&(null===e.boundingBox&&e.computeBoundingBox(),Ddt.copy(e.boundingBox),Ddt.applyMatrix4(t.matrixWorld),this.union(Ddt));for(var n=t.children,r=0,i=n.length;r<i;r++)this.expandByObject(n[r]);return this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},getParameter:function(t,e){return void 0===e&&(e=new adt),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},intersectsSphere:function(t){return this.clampPoint(t.center,Ndt),Ndt.distanceToSquared(t.center)<=t.radius*t.radius},intersectsPlane:function(t){var e,n;return t.normal.x>0?(e=t.normal.x*this.min.x,n=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,n=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),e<=-t.constant&&n>=-t.constant},intersectsTriangle:function(t){if(this.isEmpty())return!1;this.getCenter(Gdt),Wdt.subVectors(this.max,Gdt),Fdt.subVectors(t.a,Gdt),jdt.subVectors(t.b,Gdt),Bdt.subVectors(t.c,Gdt),zdt.subVectors(jdt,Fdt),Udt.subVectors(Bdt,jdt),Vdt.subVectors(Fdt,Bdt);var e=[0,-zdt.z,zdt.y,0,-Udt.z,Udt.y,0,-Vdt.z,Vdt.y,zdt.z,0,-zdt.x,Udt.z,0,-Udt.x,Vdt.z,0,-Vdt.x,-zdt.y,zdt.x,0,-Udt.y,Udt.x,0,-Vdt.y,Vdt.x,0];return!!qdt(e,Fdt,jdt,Bdt,Wdt)&&(!!qdt(e=[1,0,0,0,1,0,0,0,1],Fdt,jdt,Bdt,Wdt)&&(Hdt.crossVectors(zdt,Udt),qdt(e=[Hdt.x,Hdt.y,Hdt.z],Fdt,jdt,Bdt,Wdt)))},clampPoint:function(t,e){return void 0===e&&(e=new adt),e.copy(t).clamp(this.min,this.max)},distanceToPoint:function(t){return Ndt.copy(t).clamp(this.min,this.max).sub(t).length()},getBoundingSphere:function(t){return this.getCenter(t.center),t.radius=.5*this.getSize(Ndt).length(),t},intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:function(t){return this.isEmpty()||(Idt[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),Idt[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),Idt[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),Idt[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),Idt[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),Idt[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),Idt[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),Idt[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(Idt)),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}});var Zdt=new Xdt;function $dt(t,e){this.center=void 0!==t?t:new adt,this.radius=void 0!==e?e:0}Object.assign($dt.prototype,{set:function(t,e){return this.center.copy(t),this.radius=e,this},setFromPoints:function(t,e){var n=this.center;void 0!==e?n.copy(e):Zdt.setFromPoints(t).getCenter(n);for(var r=0,i=0,o=t.length;i<o;i++)r=Math.max(r,n.distanceToSquared(t[i]));return this.radius=Math.sqrt(r),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},empty:function(){return this.radius<=0},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){var e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e},intersectsBox:function(t){return t.intersectsSphere(this)},intersectsPlane:function(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius},clampPoint:function(t,e){var n=this.center.distanceToSquared(t);return void 0===e&&(e=new adt),e.copy(t),n>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e},getBoundingBox:function(t){return void 0===t&&(t=new Xdt),t.set(this.center,this.center),t.expandByScalar(this.radius),t},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius}});var Kdt=new adt,Jdt=new adt,Qdt=new adt,tmt=new adt,emt=new adt,nmt=new adt,rmt=new adt;function imt(t,e){this.origin=void 0!==t?t:new adt,this.direction=void 0!==e?e:new adt(0,0,-1)}Object.assign(imt.prototype,{set:function(t,e){return this.origin.copy(t),this.direction.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},at:function(t,e){return void 0===e&&(e=new adt),e.copy(this.direction).multiplyScalar(t).add(this.origin)},lookAt:function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},recast:function(t){return this.origin.copy(this.at(t,Kdt)),this},closestPointToPoint:function(t,e){void 0===e&&(e=new adt),e.subVectors(t,this.origin);var n=e.dot(this.direction);return n<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(n).add(this.origin)},distanceToPoint:function(t){return Math.sqrt(this.distanceSqToPoint(t))},distanceSqToPoint:function(t){var e=Kdt.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(Kdt.copy(this.direction).multiplyScalar(e).add(this.origin),Kdt.distanceToSquared(t))},distanceSqToSegment:function(t,e,n,r){Jdt.copy(t).add(e).multiplyScalar(.5),Qdt.copy(e).sub(t).normalize(),tmt.copy(this.origin).sub(Jdt);var i,o,a,s,u=.5*t.distanceTo(e),c=-this.direction.dot(Qdt),l=tmt.dot(this.direction),h=-tmt.dot(Qdt),f=tmt.lengthSq(),p=Math.abs(1-c*c);if(p>0)if(o=c*l-h,s=u*p,(i=c*h-l)>=0)if(o>=-s)if(o<=s){var d=1/p;a=(i*=d)*(i+c*(o*=d)+2*l)+o*(c*i+o+2*h)+f}else o=u,a=-(i=Math.max(0,-(c*o+l)))*i+o*(o+2*h)+f;else o=-u,a=-(i=Math.max(0,-(c*o+l)))*i+o*(o+2*h)+f;else o<=-s?a=-(i=Math.max(0,-(-c*u+l)))*i+(o=i>0?-u:Math.min(Math.max(-u,-h),u))*(o+2*h)+f:o<=s?(i=0,a=(o=Math.min(Math.max(-u,-h),u))*(o+2*h)+f):a=-(i=Math.max(0,-(c*u+l)))*i+(o=i>0?u:Math.min(Math.max(-u,-h),u))*(o+2*h)+f;else o=c>0?-u:u,a=-(i=Math.max(0,-(c*o+l)))*i+o*(o+2*h)+f;return n&&n.copy(this.direction).multiplyScalar(i).add(this.origin),r&&r.copy(Qdt).multiplyScalar(o).add(Jdt),a},intersectSphere:function(t,e){Kdt.subVectors(t.center,this.origin);var n=Kdt.dot(this.direction),r=Kdt.dot(Kdt)-n*n,i=t.radius*t.radius;if(r>i)return null;var o=Math.sqrt(i-r),a=n-o,s=n+o;return a<0&&s<0?null:a<0?this.at(s,e):this.at(a,e)},intersectsSphere:function(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius},distanceToPlane:function(t){var e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;var n=-(this.origin.dot(t.normal)+t.constant)/e;return n>=0?n:null},intersectPlane:function(t,e){var n=this.distanceToPlane(t);return null===n?null:this.at(n,e)},intersectsPlane:function(t){var e=t.distanceToPoint(this.origin);return 0===e||t.normal.dot(this.direction)*e<0},intersectBox:function(t,e){var n,r,i,o,a,s,u=1/this.direction.x,c=1/this.direction.y,l=1/this.direction.z,h=this.origin;return u>=0?(n=(t.min.x-h.x)*u,r=(t.max.x-h.x)*u):(n=(t.max.x-h.x)*u,r=(t.min.x-h.x)*u),c>=0?(i=(t.min.y-h.y)*c,o=(t.max.y-h.y)*c):(i=(t.max.y-h.y)*c,o=(t.min.y-h.y)*c),n>o||i>r?null:((i>n||n!=n)&&(n=i),(o<r||r!=r)&&(r=o),l>=0?(a=(t.min.z-h.z)*l,s=(t.max.z-h.z)*l):(a=(t.max.z-h.z)*l,s=(t.min.z-h.z)*l),n>s||a>r?null:((a>n||n!=n)&&(n=a),(s<r||r!=r)&&(r=s),r<0?null:this.at(n>=0?n:r,e)))},intersectsBox:function(t){return null!==this.intersectBox(t,Kdt)},intersectTriangle:function(t,e,n,r,i){emt.subVectors(e,t),nmt.subVectors(n,t),rmt.crossVectors(emt,nmt);var o,a=this.direction.dot(rmt);if(a>0){if(r)return null;o=1}else{if(!(a<0))return null;o=-1,a=-a}tmt.subVectors(this.origin,t);var s=o*this.direction.dot(nmt.crossVectors(tmt,nmt));if(s<0)return null;var u=o*this.direction.dot(emt.cross(tmt));if(u<0)return null;if(s+u>a)return null;var c=-o*tmt.dot(rmt);return c<0?null:this.at(c/a,i)},applyMatrix4:function(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this},equals:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}});var omt=new adt,amt=new adt,smt=new $pt;function umt(t,e){this.normal=void 0!==t?t:new adt(1,0,0),this.constant=void 0!==e?e:0}Object.assign(umt.prototype,{isPlane:!0,set:function(t,e){return this.normal.copy(t),this.constant=e,this},setComponents:function(t,e,n,r){return this.normal.set(t,e,n),this.constant=r,this},setFromNormalAndCoplanarPoint:function(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this},setFromCoplanarPoints:function(t,e,n){var r=omt.subVectors(n,e).cross(amt.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(r,t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(t){return this.normal.dot(t)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function(t,e){return void 0===e&&(e=new adt),e.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)},intersectLine:function(t,e){void 0===e&&(e=new adt);var n=t.delta(omt),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(t.start)?e.copy(t.start):void 0;var i=-(t.start.dot(this.normal)+this.constant)/r;return i<0||i>1?void 0:e.copy(n).multiplyScalar(i).add(t.start)},intersectsLine:function(t){var e=this.distanceToPoint(t.start),n=this.distanceToPoint(t.end);return e<0&&n>0||n<0&&e>0},intersectsBox:function(t){return t.intersectsPlane(this)},intersectsSphere:function(t){return t.intersectsPlane(this)},coplanarPoint:function(t){return void 0===t&&(t=new adt),t.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(t,e){var n=e||smt.getNormalMatrix(t),r=this.coplanarPoint(omt).applyMatrix4(t),i=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(i),this},translate:function(t){return this.constant-=t.dot(this.normal),this},equals:function(t){return t.normal.equals(this.normal)&&t.constant===this.constant}});var cmt=new adt,lmt=new adt,hmt=new adt,fmt=new adt,pmt=new adt,dmt=new adt,mmt=new adt,vmt=new adt,gmt=new adt,ymt=new adt;function xmt(t,e,n){this.a=void 0!==t?t:new adt,this.b=void 0!==e?e:new adt,this.c=void 0!==n?n:new adt}Object.assign(xmt,{getNormal:function(t,e,n,r){void 0===r&&(r=new adt),r.subVectors(n,e),cmt.subVectors(t,e),r.cross(cmt);var i=r.lengthSq();return i>0?r.multiplyScalar(1/Math.sqrt(i)):r.set(0,0,0)},getBarycoord:function(t,e,n,r,i){cmt.subVectors(r,e),lmt.subVectors(n,e),hmt.subVectors(t,e);var o=cmt.dot(cmt),a=cmt.dot(lmt),s=cmt.dot(hmt),u=lmt.dot(lmt),c=lmt.dot(hmt),l=o*u-a*a;if(void 0===i&&(i=new adt),0===l)return i.set(-2,-1,-1);var h=1/l,f=(u*s-a*c)*h,p=(o*c-a*s)*h;return i.set(1-f-p,p,f)},containsPoint:function(t,e,n,r){return xmt.getBarycoord(t,e,n,r,fmt),fmt.x>=0&&fmt.y>=0&&fmt.x+fmt.y<=1},getUV:function(t,e,n,r,i,o,a,s){return this.getBarycoord(t,e,n,r,fmt),s.set(0,0),s.addScaledVector(i,fmt.x),s.addScaledVector(o,fmt.y),s.addScaledVector(a,fmt.z),s},isFrontFacing:function(t,e,n,r){return cmt.subVectors(n,e),lmt.subVectors(t,e),cmt.cross(lmt).dot(r)<0}}),Object.assign(xmt.prototype,{set:function(t,e,n){return this.a.copy(t),this.b.copy(e),this.c.copy(n),this},setFromPointsAndIndices:function(t,e,n,r){return this.a.copy(t[e]),this.b.copy(t[n]),this.c.copy(t[r]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},getArea:function(){return cmt.subVectors(this.c,this.b),lmt.subVectors(this.a,this.b),.5*cmt.cross(lmt).length()},getMidpoint:function(t){return void 0===t&&(t=new adt),t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(t){return xmt.getNormal(this.a,this.b,this.c,t)},getPlane:function(t){return void 0===t&&(t=new umt),t.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(t,e){return xmt.getBarycoord(t,this.a,this.b,this.c,e)},getUV:function(t,e,n,r,i){return xmt.getUV(t,this.a,this.b,this.c,e,n,r,i)},containsPoint:function(t){return xmt.containsPoint(t,this.a,this.b,this.c)},isFrontFacing:function(t){return xmt.isFrontFacing(this.a,this.b,this.c,t)},intersectsBox:function(t){return t.intersectsTriangle(this)},closestPointToPoint:function(t,e){void 0===e&&(e=new adt);var n,r,i=this.a,o=this.b,a=this.c;pmt.subVectors(o,i),dmt.subVectors(a,i),vmt.subVectors(t,i);var s=pmt.dot(vmt),u=dmt.dot(vmt);if(s<=0&&u<=0)return e.copy(i);gmt.subVectors(t,o);var c=pmt.dot(gmt),l=dmt.dot(gmt);if(c>=0&&l<=c)return e.copy(o);var h=s*l-c*u;if(h<=0&&s>=0&&c<=0)return n=s/(s-c),e.copy(i).addScaledVector(pmt,n);ymt.subVectors(t,a);var f=pmt.dot(ymt),p=dmt.dot(ymt);if(p>=0&&f<=p)return e.copy(a);var d=f*u-s*p;if(d<=0&&u>=0&&p<=0)return r=u/(u-p),e.copy(i).addScaledVector(dmt,r);var m=c*p-f*l;if(m<=0&&l-c>=0&&f-p>=0)return mmt.subVectors(a,o),r=(l-c)/(l-c+(f-p)),e.copy(o).addScaledVector(mmt,r);var v=1/(m+d+h);return n=d*v,r=h*v,e.copy(i).addScaledVector(pmt,n).addScaledVector(dmt,r)},equals:function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}});var bmt={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},_mt={h:0,s:0,l:0},wmt={h:0,s:0,l:0};function Smt(t,e,n){return void 0===e&&void 0===n?this.set(t):this.setRGB(t,e,n)}function Mmt(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+6*(e-t)*(2/3-n):t}function Emt(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function Amt(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}function Tmt(t,e,n,r,i,o){this.a=t,this.b=e,this.c=n,this.normal=r&&r.isVector3?r:new adt,this.vertexNormals=Array.isArray(r)?r:[],this.color=i&&i.isColor?i:new Smt,this.vertexColors=Array.isArray(i)?i:[],this.materialIndex=void 0!==o?o:0}Object.assign(Smt.prototype,{isColor:!0,r:1,g:1,b:1,set:function(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this},setScalar:function(t){return this.r=t,this.g=t,this.b=t,this},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},setRGB:function(t,e,n){return this.r=t,this.g=e,this.b=n,this},setHSL:function(t,e,n){if(t=qpt.euclideanModulo(t,1),e=qpt.clamp(e,0,1),n=qpt.clamp(n,0,1),0===e)this.r=this.g=this.b=n;else{var r=n<=.5?n*(1+e):n+e-n*e,i=2*n-r;this.r=Mmt(i,r,t+1/3),this.g=Mmt(i,r,t),this.b=Mmt(i,r,t-1/3)}return this},setStyle:function(t){function e(t){void 0!==t&&parseFloat(t)}var n;if(n=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){var r,i=n[1],o=n[2];switch(i){case"rgb":case"rgba":if(r=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Math.min(255,parseInt(r[1],10))/255,this.g=Math.min(255,parseInt(r[2],10))/255,this.b=Math.min(255,parseInt(r[3],10))/255,e(r[5]),this;if(r=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Math.min(100,parseInt(r[1],10))/100,this.g=Math.min(100,parseInt(r[2],10))/100,this.b=Math.min(100,parseInt(r[3],10))/100,e(r[5]),this;break;case"hsl":case"hsla":if(r=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o)){var a=parseFloat(r[1])/360,s=parseInt(r[2],10)/100,u=parseInt(r[3],10)/100;return e(r[5]),this.setHSL(a,s,u)}}}else if(n=/^\#([A-Fa-f0-9]+)$/.exec(t)){var c=n[1],l=c.length;if(3===l)return this.r=parseInt(c.charAt(0)+c.charAt(0),16)/255,this.g=parseInt(c.charAt(1)+c.charAt(1),16)/255,this.b=parseInt(c.charAt(2)+c.charAt(2),16)/255,this;if(6===l)return this.r=parseInt(c.charAt(0)+c.charAt(1),16)/255,this.g=parseInt(c.charAt(2)+c.charAt(3),16)/255,this.b=parseInt(c.charAt(4)+c.charAt(5),16)/255,this}return t&&t.length>0?this.setColorName(t):this},setColorName:function(t){var e=bmt[t];return void 0!==e&&this.setHex(e),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t,e){return void 0===e&&(e=2),this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},copyLinearToGamma:function(t,e){void 0===e&&(e=2);var n=e>0?1/e:1;return this.r=Math.pow(t.r,n),this.g=Math.pow(t.g,n),this.b=Math.pow(t.b,n),this},convertGammaToLinear:function(t){return this.copyGammaToLinear(this,t),this},convertLinearToGamma:function(t){return this.copyLinearToGamma(this,t),this},copySRGBToLinear:function(t){return this.r=Emt(t.r),this.g=Emt(t.g),this.b=Emt(t.b),this},copyLinearToSRGB:function(t){return this.r=Amt(t.r),this.g=Amt(t.g),this.b=Amt(t.b),this},convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){void 0===t&&(t={h:0,s:0,l:0});var e,n,r=this.r,i=this.g,o=this.b,a=Math.max(r,i,o),s=Math.min(r,i,o),u=(s+a)/2;if(s===a)e=0,n=0;else{var c=a-s;switch(n=u<=.5?c/(a+s):c/(2-a-s),a){case r:e=(i-o)/c+(i<o?6:0);break;case i:e=(o-r)/c+2;break;case o:e=(r-i)/c+4}e/=6}return t.h=e,t.s=n,t.l=u,t},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(t,e,n){return this.getHSL(_mt),_mt.h+=t,_mt.s+=e,_mt.l+=n,this.setHSL(_mt.h,_mt.s,_mt.l),this},add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},sub:function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this},lerpHSL:function(t,e){this.getHSL(_mt),t.getHSL(wmt);var n=qpt.lerp(_mt.h,wmt.h,e),r=qpt.lerp(_mt.s,wmt.s,e),i=qpt.lerp(_mt.l,wmt.l,e);return this.setHSL(n,r,i),this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t,e){return void 0===e&&(e=0),this.r=t[e],this.g=t[e+1],this.b=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t},toJSON:function(){return this.getHex()}}),Smt.NAMES=bmt,Object.assign(Tmt.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(var e=0,n=t.vertexNormals.length;e<n;e++)this.vertexNormals[e]=t.vertexNormals[e].clone();for(e=0,n=t.vertexColors.length;e<n;e++)this.vertexColors[e]=t.vertexColors[e].clone();return this}});var Cmt=0;function Omt(){Object.defineProperty(this,"id",{value:Cmt++}),this.uuid=qpt.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=1,this.side=0,this.flatShading=!1,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=fpt,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Upt,this.stencilZFail=Upt,this.stencilZPass=Upt,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}function kmt(t){Omt.call(this),this.type="MeshBasicMaterial",this.color=new Smt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.setValues(t)}Omt.prototype=Object.assign(Object.create(Wpt.prototype),{constructor:Omt,isMaterial:!0,onBeforeCompile:function(){},setValues:function(t){if(void 0!==t)for(var e in t){var n=t[e];if(void 0!==n)if("shading"!==e){var r=this[e];void 0!==r&&(r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[e]=n)}else this.flatShading=1===n}},toJSON:function(t){var e=void 0===t||"string"==typeof t;e&&(t={textures:{},images:{}});var n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(t){var e=[];for(var n in t){var r=t[n];delete r.metadata,e.push(r)}return e}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(n.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(t).uuid),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(t).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(t).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(t).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(t).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(t).uuid,n.reflectivity=this.reflectivity,n.refractionRatio=this.refractionRatio,void 0!==this.combine&&(n.combine=this.combine),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.size&&(n.size=this.size),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(n.blending=this.blending),!0===this.flatShading&&(n.flatShading=this.flatShading),0!==this.side&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(n.morphTargets=!0),!0===this.morphNormals&&(n.morphNormals=!0),!0===this.skinning&&(n.skinning=!0),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),e){var i=r(t.textures),o=r(t.images);i.length>0&&(n.textures=i),o.length>0&&(n.images=o)}return n},clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.name=t.name,this.fog=t.fog,this.blending=t.blending,this.side=t.side,this.flatShading=t.flatShading,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;var e=t.clippingPlanes,n=null;if(null!==e){var r=e.length;n=new Array(r);for(var i=0;i!==r;++i)n[i]=e[i].clone()}return this.clippingPlanes=n,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(Omt.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),kmt.prototype=Object.create(Omt.prototype),kmt.prototype.constructor=kmt,kmt.prototype.isMeshBasicMaterial=!0,kmt.prototype.copy=function(t){return Omt.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this};var Pmt=new adt;function Lmt(t,e,n){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=!0===n,this.usage=Vpt,this.updateRange={offset:0,count:-1},this.version=0}function Rmt(t,e,n){Lmt.call(this,new Int8Array(t),e,n)}function Imt(t,e,n){Lmt.call(this,new Uint8Array(t),e,n)}function Nmt(t,e,n){Lmt.call(this,new Uint8ClampedArray(t),e,n)}function Dmt(t,e,n){Lmt.call(this,new Int16Array(t),e,n)}function Fmt(t,e,n){Lmt.call(this,new Uint16Array(t),e,n)}function jmt(t,e,n){Lmt.call(this,new Int32Array(t),e,n)}function Bmt(t,e,n){Lmt.call(this,new Uint32Array(t),e,n)}function zmt(t,e,n){Lmt.call(this,new Float32Array(t),e,n)}function Umt(t,e,n){Lmt.call(this,new Float64Array(t),e,n)}function Vmt(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function Gmt(t){if(0===t.length)return-1/0;for(var e=t[0],n=1,r=t.length;n<r;++n)t[n]>e&&(e=t[n]);return e}Object.defineProperty(Lmt.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(Lmt.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this},copyAt:function(t,e,n){t*=this.itemSize,n*=e.itemSize;for(var r=0,i=this.itemSize;r<i;r++)this.array[t+r]=e.array[n+r];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){for(var e=this.array,n=0,r=0,i=t.length;r<i;r++){var o=t[r];void 0===o&&(o=new Smt),e[n++]=o.r,e[n++]=o.g,e[n++]=o.b}return this},copyVector2sArray:function(t){for(var e=this.array,n=0,r=0,i=t.length;r<i;r++){var o=t[r];void 0===o&&(o=new Zpt),e[n++]=o.x,e[n++]=o.y}return this},copyVector3sArray:function(t){for(var e=this.array,n=0,r=0,i=t.length;r<i;r++){var o=t[r];void 0===o&&(o=new adt),e[n++]=o.x,e[n++]=o.y,e[n++]=o.z}return this},copyVector4sArray:function(t){for(var e=this.array,n=0,r=0,i=t.length;r<i;r++){var o=t[r];void 0===o&&(o=new tdt),e[n++]=o.x,e[n++]=o.y,e[n++]=o.z,e[n++]=o.w}return this},applyMatrix3:function(t){for(var e=0,n=this.count;e<n;e++)Pmt.x=this.getX(e),Pmt.y=this.getY(e),Pmt.z=this.getZ(e),Pmt.applyMatrix3(t),this.setXYZ(e,Pmt.x,Pmt.y,Pmt.z);return this},applyMatrix4:function(t){for(var e=0,n=this.count;e<n;e++)Pmt.x=this.getX(e),Pmt.y=this.getY(e),Pmt.z=this.getZ(e),Pmt.applyMatrix4(t),this.setXYZ(e,Pmt.x,Pmt.y,Pmt.z);return this},applyNormalMatrix:function(t){for(var e=0,n=this.count;e<n;e++)Pmt.x=this.getX(e),Pmt.y=this.getY(e),Pmt.z=this.getZ(e),Pmt.applyNormalMatrix(t),this.setXYZ(e,Pmt.x,Pmt.y,Pmt.z);return this},transformDirection:function(t){for(var e=0,n=this.count;e<n;e++)Pmt.x=this.getX(e),Pmt.y=this.getY(e),Pmt.z=this.getZ(e),Pmt.transformDirection(t),this.setXYZ(e,Pmt.x,Pmt.y,Pmt.z);return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,e){return this.array[t*this.itemSize]=e,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,e){return this.array[t*this.itemSize+1]=e,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,e){return this.array[t*this.itemSize+2]=e,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,e){return this.array[t*this.itemSize+3]=e,this},setXY:function(t,e,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this},setXYZ:function(t,e,n,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=r,this},setXYZW:function(t,e,n,r,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=r,this.array[t+3]=i,this},onUpload:function(t){return this.onUploadCallback=t,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}}),Rmt.prototype=Object.create(Lmt.prototype),Rmt.prototype.constructor=Rmt,Imt.prototype=Object.create(Lmt.prototype),Imt.prototype.constructor=Imt,Nmt.prototype=Object.create(Lmt.prototype),Nmt.prototype.constructor=Nmt,Dmt.prototype=Object.create(Lmt.prototype),Dmt.prototype.constructor=Dmt,Fmt.prototype=Object.create(Lmt.prototype),Fmt.prototype.constructor=Fmt,jmt.prototype=Object.create(Lmt.prototype),jmt.prototype.constructor=jmt,Bmt.prototype=Object.create(Lmt.prototype),Bmt.prototype.constructor=Bmt,zmt.prototype=Object.create(Lmt.prototype),zmt.prototype.constructor=zmt,Umt.prototype=Object.create(Lmt.prototype),Umt.prototype.constructor=Umt,Object.assign(Vmt.prototype,{computeGroups:function(t){for(var e,n=[],r=void 0,i=t.faces,o=0;o<i.length;o++){var a=i[o];a.materialIndex!==r&&(r=a.materialIndex,void 0!==e&&(e.count=3*o-e.start,n.push(e)),e={start:3*o,materialIndex:r})}void 0!==e&&(e.count=3*o-e.start,n.push(e)),this.groups=n},fromGeometry:function(t){var e,n=t.faces,r=t.vertices,i=t.faceVertexUvs,o=i[0]&&i[0].length>0,a=i[1]&&i[1].length>0,s=t.morphTargets,u=s.length;if(u>0){e=[];for(var c=0;c<u;c++)e[c]={name:s[c].name,data:[]};this.morphTargets.position=e}var l,h=t.morphNormals,f=h.length;if(f>0){l=[];for(c=0;c<f;c++)l[c]={name:h[c].name,data:[]};this.morphTargets.normal=l}var p=t.skinIndices,d=t.skinWeights,m=p.length===r.length,v=d.length===r.length;r.length>0&&n.length;for(c=0;c<n.length;c++){var g=n[c];this.vertices.push(r[g.a],r[g.b],r[g.c]);var y=g.vertexNormals;if(3===y.length)this.normals.push(y[0],y[1],y[2]);else{var x=g.normal;this.normals.push(x,x,x)}var b,_=g.vertexColors;if(3===_.length)this.colors.push(_[0],_[1],_[2]);else{var w=g.color;this.colors.push(w,w,w)}if(!0===o)void 0!==(b=i[0][c])?this.uvs.push(b[0],b[1],b[2]):this.uvs.push(new Zpt,new Zpt,new Zpt);if(!0===a)void 0!==(b=i[1][c])?this.uvs2.push(b[0],b[1],b[2]):this.uvs2.push(new Zpt,new Zpt,new Zpt);for(var S=0;S<u;S++){var M=s[S].vertices;e[S].data.push(M[g.a],M[g.b],M[g.c])}for(S=0;S<f;S++){var E=h[S].vertexNormals[c];l[S].data.push(E.a,E.b,E.c)}m&&this.skinIndices.push(p[g.a],p[g.b],p[g.c]),v&&this.skinWeights.push(d[g.a],d[g.b],d[g.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this}});var Wmt=1,Hmt=new ddt,Ymt=new Ldt,Xmt=new adt,qmt=new Xdt,Zmt=new Xdt,$mt=new adt;function Kmt(){Object.defineProperty(this,"id",{value:Wmt+=2}),this.uuid=qpt.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}Kmt.prototype=Object.assign(Object.create(Wpt.prototype),{constructor:Kmt,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){Array.isArray(t)?this.index=new(Gmt(t)>65535?Bmt:Fmt)(t,1):this.index=t},getAttribute:function(t){return this.attributes[t]},setAttribute:function(t,e){return this.attributes[t]=e,this},deleteAttribute:function(t){return delete this.attributes[t],this},addGroup:function(t,e,n){this.groups.push({start:t,count:e,materialIndex:void 0!==n?n:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,e){this.drawRange.start=t,this.drawRange.count=e},applyMatrix4:function(t){var e=this.attributes.position;void 0!==e&&(e.applyMatrix4(t),e.needsUpdate=!0);var n=this.attributes.normal;if(void 0!==n){var r=(new $pt).getNormalMatrix(t);n.applyNormalMatrix(r),n.needsUpdate=!0}var i=this.attributes.tangent;return void 0!==i&&(i.transformDirection(t),i.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(t){return Hmt.makeRotationX(t),this.applyMatrix4(Hmt),this},rotateY:function(t){return Hmt.makeRotationY(t),this.applyMatrix4(Hmt),this},rotateZ:function(t){return Hmt.makeRotationZ(t),this.applyMatrix4(Hmt),this},translate:function(t,e,n){return Hmt.makeTranslation(t,e,n),this.applyMatrix4(Hmt),this},scale:function(t,e,n){return Hmt.makeScale(t,e,n),this.applyMatrix4(Hmt),this},lookAt:function(t){return Ymt.lookAt(t),Ymt.updateMatrix(),this.applyMatrix4(Ymt.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Xmt).negate(),this.translate(Xmt.x,Xmt.y,Xmt.z),this},setFromObject:function(t){var e=t.geometry;if(t.isPoints||t.isLine){var n=new zmt(3*e.vertices.length,3),r=new zmt(3*e.colors.length,3);if(this.setAttribute("position",n.copyVector3sArray(e.vertices)),this.setAttribute("color",r.copyColorsArray(e.colors)),e.lineDistances&&e.lineDistances.length===e.vertices.length){var i=new zmt(e.lineDistances.length,1);this.setAttribute("lineDistance",i.copyArray(e.lineDistances))}null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone())}else t.isMesh&&e&&e.isGeometry&&this.fromGeometry(e);return this},setFromPoints:function(t){for(var e=[],n=0,r=t.length;n<r;n++){var i=t[n];e.push(i.x,i.y,i.z||0)}return this.setAttribute("position",new zmt(e,3)),this},updateFromObject:function(t){var e,n=t.geometry;if(t.isMesh){var r=n.__directGeometry;if(!0===n.elementsNeedUpdate&&(r=void 0,n.elementsNeedUpdate=!1),void 0===r)return this.fromGeometry(n);r.verticesNeedUpdate=n.verticesNeedUpdate,r.normalsNeedUpdate=n.normalsNeedUpdate,r.colorsNeedUpdate=n.colorsNeedUpdate,r.uvsNeedUpdate=n.uvsNeedUpdate,r.groupsNeedUpdate=n.groupsNeedUpdate,n.verticesNeedUpdate=!1,n.normalsNeedUpdate=!1,n.colorsNeedUpdate=!1,n.uvsNeedUpdate=!1,n.groupsNeedUpdate=!1,n=r}return!0===n.verticesNeedUpdate&&(void 0!==(e=this.attributes.position)&&(e.copyVector3sArray(n.vertices),e.needsUpdate=!0),n.verticesNeedUpdate=!1),!0===n.normalsNeedUpdate&&(void 0!==(e=this.attributes.normal)&&(e.copyVector3sArray(n.normals),e.needsUpdate=!0),n.normalsNeedUpdate=!1),!0===n.colorsNeedUpdate&&(void 0!==(e=this.attributes.color)&&(e.copyColorsArray(n.colors),e.needsUpdate=!0),n.colorsNeedUpdate=!1),n.uvsNeedUpdate&&(void 0!==(e=this.attributes.uv)&&(e.copyVector2sArray(n.uvs),e.needsUpdate=!0),n.uvsNeedUpdate=!1),n.lineDistancesNeedUpdate&&(void 0!==(e=this.attributes.lineDistance)&&(e.copyArray(n.lineDistances),e.needsUpdate=!0),n.lineDistancesNeedUpdate=!1),n.groupsNeedUpdate&&(n.computeGroups(t.geometry),this.groups=n.groups,n.groupsNeedUpdate=!1),this},fromGeometry:function(t){return t.__directGeometry=(new Vmt).fromGeometry(t),this.fromDirectGeometry(t.__directGeometry)},fromDirectGeometry:function(t){var e=new Float32Array(3*t.vertices.length);if(this.setAttribute("position",new Lmt(e,3).copyVector3sArray(t.vertices)),t.normals.length>0){var n=new Float32Array(3*t.normals.length);this.setAttribute("normal",new Lmt(n,3).copyVector3sArray(t.normals))}if(t.colors.length>0){var r=new Float32Array(3*t.colors.length);this.setAttribute("color",new Lmt(r,3).copyColorsArray(t.colors))}if(t.uvs.length>0){var i=new Float32Array(2*t.uvs.length);this.setAttribute("uv",new Lmt(i,2).copyVector2sArray(t.uvs))}if(t.uvs2.length>0){var o=new Float32Array(2*t.uvs2.length);this.setAttribute("uv2",new Lmt(o,2).copyVector2sArray(t.uvs2))}for(var a in this.groups=t.groups,t.morphTargets){for(var s=[],u=t.morphTargets[a],c=0,l=u.length;c<l;c++){var h=u[c],f=new zmt(3*h.data.length,3);f.name=h.name,s.push(f.copyVector3sArray(h.data))}this.morphAttributes[a]=s}if(t.skinIndices.length>0){var p=new zmt(4*t.skinIndices.length,4);this.setAttribute("skinIndex",p.copyVector4sArray(t.skinIndices))}if(t.skinWeights.length>0){var d=new zmt(4*t.skinWeights.length,4);this.setAttribute("skinWeight",d.copyVector4sArray(t.skinWeights))}return null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Xdt);var t=this.attributes.position,e=this.morphAttributes.position;if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),e)for(var n=0,r=e.length;n<r;n++){var i=e[n];qmt.setFromBufferAttribute(i),this.morphTargetsRelative?($mt.addVectors(this.boundingBox.min,qmt.min),this.boundingBox.expandByPoint($mt),$mt.addVectors(this.boundingBox.max,qmt.max),this.boundingBox.expandByPoint($mt)):(this.boundingBox.expandByPoint(qmt.min),this.boundingBox.expandByPoint(qmt.max))}}else this.boundingBox.makeEmpty();isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new $dt);var t=this.attributes.position,e=this.morphAttributes.position;if(t){var n=this.boundingSphere.center;if(qmt.setFromBufferAttribute(t),e)for(var r=0,i=e.length;r<i;r++){var o=e[r];Zmt.setFromBufferAttribute(o),this.morphTargetsRelative?($mt.addVectors(qmt.min,Zmt.min),qmt.expandByPoint($mt),$mt.addVectors(qmt.max,Zmt.max),qmt.expandByPoint($mt)):(qmt.expandByPoint(Zmt.min),qmt.expandByPoint(Zmt.max))}qmt.getCenter(n);var a=0;for(r=0,i=t.count;r<i;r++)$mt.fromBufferAttribute(t,r),a=Math.max(a,n.distanceToSquared($mt));if(e)for(r=0,i=e.length;r<i;r++){o=e[r];for(var s=this.morphTargetsRelative,u=0,c=o.count;u<c;u++)$mt.fromBufferAttribute(o,u),s&&(Xmt.fromBufferAttribute(t,u),$mt.add(Xmt)),a=Math.max(a,n.distanceToSquared($mt))}this.boundingSphere.radius=Math.sqrt(a),isNaN(this.boundingSphere.radius)}},computeFaceNormals:function(){},computeVertexNormals:function(){var t=this.index,e=this.attributes;if(e.position){var n=e.position.array;if(void 0===e.normal)this.setAttribute("normal",new Lmt(new Float32Array(n.length),3));else for(var r=e.normal.array,i=0,o=r.length;i<o;i++)r[i]=0;var a,s,u,c=e.normal.array,l=new adt,h=new adt,f=new adt,p=new adt,d=new adt;if(t){var m=t.array;for(i=0,o=t.count;i<o;i+=3)a=3*m[i+0],s=3*m[i+1],u=3*m[i+2],l.fromArray(n,a),h.fromArray(n,s),f.fromArray(n,u),p.subVectors(f,h),d.subVectors(l,h),p.cross(d),c[a]+=p.x,c[a+1]+=p.y,c[a+2]+=p.z,c[s]+=p.x,c[s+1]+=p.y,c[s+2]+=p.z,c[u]+=p.x,c[u+1]+=p.y,c[u+2]+=p.z}else for(i=0,o=n.length;i<o;i+=9)l.fromArray(n,i),h.fromArray(n,i+3),f.fromArray(n,i+6),p.subVectors(f,h),d.subVectors(l,h),p.cross(d),c[i]=p.x,c[i+1]=p.y,c[i+2]=p.z,c[i+3]=p.x,c[i+4]=p.y,c[i+5]=p.z,c[i+6]=p.x,c[i+7]=p.y,c[i+8]=p.z;this.normalizeNormals(),e.normal.needsUpdate=!0}},merge:function(t,e){if(t&&t.isBufferGeometry){void 0===e&&(e=0);var n=this.attributes;for(var r in n)if(void 0!==t.attributes[r])for(var i=n[r].array,o=t.attributes[r],a=o.array,s=o.itemSize*e,u=Math.min(a.length,i.length-s),c=0,l=s;c<u;c++,l++)i[l]=a[c];return this}},normalizeNormals:function(){for(var t=this.attributes.normal,e=0,n=t.count;e<n;e++)$mt.x=t.getX(e),$mt.y=t.getY(e),$mt.z=t.getZ(e),$mt.normalize(),t.setXYZ(e,$mt.x,$mt.y,$mt.z)},toNonIndexed:function(){function t(t,e){for(var n=t.array,r=t.itemSize,i=new n.constructor(e.length*r),o=0,a=0,s=0,u=e.length;s<u;s++){o=e[s]*r;for(var c=0;c<r;c++)i[a++]=n[o++]}return new Lmt(i,r)}if(null===this.index)return this;var e=new Kmt,n=this.index.array,r=this.attributes;for(var i in r){var o=t(r[i],n);e.setAttribute(i,o)}var a=this.morphAttributes;for(i in a){for(var s=[],u=a[i],c=0,l=u.length;c<l;c++){o=t(u[c],n);s.push(o)}e.morphAttributes[i]=s}e.morphTargetsRelative=this.morphTargetsRelative;for(var h=this.groups,f=(c=0,h.length);c<f;c++){var p=h[c];e.addGroup(p.start,p.count,p.materialIndex)}return e},toJSON:function(){var t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),void 0!==this.parameters){var e=this.parameters;for(var n in e)void 0!==e[n]&&(t[n]=e[n]);return t}t.data={attributes:{}};var r=this.index;null!==r&&(t.data.index={type:r.array.constructor.name,array:Array.prototype.slice.call(r.array)});var i=this.attributes;for(var n in i){var o=(f=i[n]).toJSON();""!==f.name&&(o.name=f.name),t.data.attributes[n]=o}var a={},s=!1;for(var n in this.morphAttributes){for(var u=this.morphAttributes[n],c=[],l=0,h=u.length;l<h;l++){var f;o=(f=u[l]).toJSON();""!==f.name&&(o.name=f.name),c.push(o)}c.length>0&&(a[n]=c,s=!0)}s&&(t.data.morphAttributes=a,t.data.morphTargetsRelative=this.morphTargetsRelative);var p=this.groups;p.length>0&&(t.data.groups=JSON.parse(JSON.stringify(p)));var d=this.boundingSphere;return null!==d&&(t.data.boundingSphere={center:d.center.toArray(),radius:d.radius}),t},clone:function(){return(new Kmt).copy(this)},copy:function(t){var e,n,r;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=t.name;var i=t.index;null!==i&&this.setIndex(i.clone());var o=t.attributes;for(e in o){var a=o[e];this.setAttribute(e,a.clone())}var s=t.morphAttributes;for(e in s){var u=[],c=s[e];for(n=0,r=c.length;n<r;n++)u.push(c[n].clone());this.morphAttributes[e]=u}this.morphTargetsRelative=t.morphTargetsRelative;var l=t.groups;for(n=0,r=l.length;n<r;n++){var h=l[n];this.addGroup(h.start,h.count,h.materialIndex)}var f=t.boundingBox;null!==f&&(this.boundingBox=f.clone());var p=t.boundingSphere;return null!==p&&(this.boundingSphere=p.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var Jmt=new ddt,Qmt=new imt,tvt=new $dt,evt=new adt,nvt=new adt,rvt=new adt,ivt=new adt,ovt=new adt,avt=new adt,svt=new adt,uvt=new adt,cvt=new adt,lvt=new Zpt,hvt=new Zpt,fvt=new Zpt,pvt=new adt,dvt=new adt;function mvt(t,e){Ldt.call(this),this.type="Mesh",this.geometry=void 0!==t?t:new Kmt,this.material=void 0!==e?e:new kmt,this.updateMorphTargets()}function vvt(t,e,n,r,i,o,a,s){if(null===(1===e.side?r.intersectTriangle(a,o,i,!0,s):r.intersectTriangle(i,o,a,2!==e.side,s)))return null;dvt.copy(s),dvt.applyMatrix4(t.matrixWorld);var u=n.ray.origin.distanceTo(dvt);return u<n.near||u>n.far?null:{distance:u,point:dvt.clone(),object:t}}function gvt(t,e,n,r,i,o,a,s,u,c,l,h){evt.fromBufferAttribute(i,c),nvt.fromBufferAttribute(i,l),rvt.fromBufferAttribute(i,h);var f=t.morphTargetInfluences;if(e.morphTargets&&o&&f){svt.set(0,0,0),uvt.set(0,0,0),cvt.set(0,0,0);for(var p=0,d=o.length;p<d;p++){var m=f[p],v=o[p];0!==m&&(ivt.fromBufferAttribute(v,c),ovt.fromBufferAttribute(v,l),avt.fromBufferAttribute(v,h),a?(svt.addScaledVector(ivt,m),uvt.addScaledVector(ovt,m),cvt.addScaledVector(avt,m)):(svt.addScaledVector(ivt.sub(evt),m),uvt.addScaledVector(ovt.sub(nvt),m),cvt.addScaledVector(avt.sub(rvt),m)))}evt.add(svt),nvt.add(uvt),rvt.add(cvt)}var g=vvt(t,e,n,r,evt,nvt,rvt,pvt);if(g){s&&(lvt.fromBufferAttribute(s,c),hvt.fromBufferAttribute(s,l),fvt.fromBufferAttribute(s,h),g.uv=xmt.getUV(pvt,evt,nvt,rvt,lvt,hvt,fvt,new Zpt)),u&&(lvt.fromBufferAttribute(u,c),hvt.fromBufferAttribute(u,l),fvt.fromBufferAttribute(u,h),g.uv2=xmt.getUV(pvt,evt,nvt,rvt,lvt,hvt,fvt,new Zpt));var y=new Tmt(c,l,h);xmt.getNormal(evt,nvt,rvt,y.normal),g.face=y}return g}mvt.prototype=Object.assign(Object.create(Ldt.prototype),{constructor:mvt,isMesh:!0,copy:function(t){return Ldt.prototype.copy.call(this,t),void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this},updateMorphTargets:function(){var t,e,n,r=this.geometry;if(r.isBufferGeometry){var i=r.morphAttributes,o=Object.keys(i);if(o.length>0){var a=i[o[0]];if(void 0!==a)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,e=a.length;t<e;t++)n=a[t].name||String(t),this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=t}}else{var s=r.morphTargets;void 0!==s&&s.length}},raycast:function(t,e){var n,r=this.geometry,i=this.material,o=this.matrixWorld;if(void 0!==i&&(null===r.boundingSphere&&r.computeBoundingSphere(),tvt.copy(r.boundingSphere),tvt.applyMatrix4(o),!1!==t.ray.intersectsSphere(tvt)&&(Jmt.getInverse(o),Qmt.copy(t.ray).applyMatrix4(Jmt),null===r.boundingBox||!1!==Qmt.intersectsBox(r.boundingBox))))if(r.isBufferGeometry){var a,s,u,c,l,h,f,p,d,m=r.index,v=r.attributes.position,g=r.morphAttributes.position,y=r.morphTargetsRelative,x=r.attributes.uv,b=r.attributes.uv2,_=r.groups,w=r.drawRange;if(null!==m)if(Array.isArray(i))for(c=0,h=_.length;c<h;c++)for(d=i[(p=_[c]).materialIndex],l=Math.max(p.start,w.start),f=Math.min(p.start+p.count,w.start+w.count);l<f;l+=3)a=m.getX(l),s=m.getX(l+1),u=m.getX(l+2),(n=gvt(this,d,t,Qmt,v,g,y,x,b,a,s,u))&&(n.faceIndex=Math.floor(l/3),n.face.materialIndex=p.materialIndex,e.push(n));else for(c=Math.max(0,w.start),h=Math.min(m.count,w.start+w.count);c<h;c+=3)a=m.getX(c),s=m.getX(c+1),u=m.getX(c+2),(n=gvt(this,i,t,Qmt,v,g,y,x,b,a,s,u))&&(n.faceIndex=Math.floor(c/3),e.push(n));else if(void 0!==v)if(Array.isArray(i))for(c=0,h=_.length;c<h;c++)for(d=i[(p=_[c]).materialIndex],l=Math.max(p.start,w.start),f=Math.min(p.start+p.count,w.start+w.count);l<f;l+=3)(n=gvt(this,d,t,Qmt,v,g,y,x,b,a=l,s=l+1,u=l+2))&&(n.faceIndex=Math.floor(l/3),n.face.materialIndex=p.materialIndex,e.push(n));else for(c=Math.max(0,w.start),h=Math.min(v.count,w.start+w.count);c<h;c+=3)(n=gvt(this,i,t,Qmt,v,g,y,x,b,a=c,s=c+1,u=c+2))&&(n.faceIndex=Math.floor(c/3),e.push(n))}else if(r.isGeometry){var S,M,E,A,T=Array.isArray(i),C=r.vertices,O=r.faces,k=r.faceVertexUvs[0];k.length>0&&(A=k);for(var P=0,L=O.length;P<L;P++){var R=O[P],I=T?i[R.materialIndex]:i;if(void 0!==I&&(S=C[R.a],M=C[R.b],E=C[R.c],n=vvt(this,I,t,Qmt,S,M,E,pvt))){if(A&&A[P]){var N=A[P];lvt.copy(N[0]),hvt.copy(N[1]),fvt.copy(N[2]),n.uv=xmt.getUV(pvt,S,M,E,lvt,hvt,fvt,new Zpt)}n.face=R,n.faceIndex=P,e.push(n)}}}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var yvt=0,xvt=new ddt,bvt=new Ldt,_vt=new adt;function wvt(){Object.defineProperty(this,"id",{value:yvt+=2}),this.uuid=qpt.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}wvt.prototype=Object.assign(Object.create(Wpt.prototype),{constructor:wvt,isGeometry:!0,applyMatrix4:function(t){for(var e=(new $pt).getNormalMatrix(t),n=0,r=this.vertices.length;n<r;n++){this.vertices[n].applyMatrix4(t)}for(n=0,r=this.faces.length;n<r;n++){var i=this.faces[n];i.normal.applyMatrix3(e).normalize();for(var o=0,a=i.vertexNormals.length;o<a;o++)i.vertexNormals[o].applyMatrix3(e).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(t){return xvt.makeRotationX(t),this.applyMatrix4(xvt),this},rotateY:function(t){return xvt.makeRotationY(t),this.applyMatrix4(xvt),this},rotateZ:function(t){return xvt.makeRotationZ(t),this.applyMatrix4(xvt),this},translate:function(t,e,n){return xvt.makeTranslation(t,e,n),this.applyMatrix4(xvt),this},scale:function(t,e,n){return xvt.makeScale(t,e,n),this.applyMatrix4(xvt),this},lookAt:function(t){return bvt.lookAt(t),bvt.updateMatrix(),this.applyMatrix4(bvt.matrix),this},fromBufferGeometry:function(t){var e=this,n=null!==t.index?t.index.array:void 0,r=t.attributes;if(void 0===r.position)return this;var i=r.position.array,o=void 0!==r.normal?r.normal.array:void 0,a=void 0!==r.color?r.color.array:void 0,s=void 0!==r.uv?r.uv.array:void 0,u=void 0!==r.uv2?r.uv2.array:void 0;void 0!==u&&(this.faceVertexUvs[1]=[]);for(var c=0;c<i.length;c+=3)e.vertices.push((new adt).fromArray(i,c)),void 0!==a&&e.colors.push((new Smt).fromArray(a,c));function l(t,n,r,i){var c=void 0===a?[]:[e.colors[t].clone(),e.colors[n].clone(),e.colors[r].clone()],l=new Tmt(t,n,r,void 0===o?[]:[(new adt).fromArray(o,3*t),(new adt).fromArray(o,3*n),(new adt).fromArray(o,3*r)],c,i);e.faces.push(l),void 0!==s&&e.faceVertexUvs[0].push([(new Zpt).fromArray(s,2*t),(new Zpt).fromArray(s,2*n),(new Zpt).fromArray(s,2*r)]),void 0!==u&&e.faceVertexUvs[1].push([(new Zpt).fromArray(u,2*t),(new Zpt).fromArray(u,2*n),(new Zpt).fromArray(u,2*r)])}var h=t.groups;if(h.length>0)for(c=0;c<h.length;c++)for(var f=h[c],p=f.start,d=p,m=p+f.count;d<m;d+=3)void 0!==n?l(n[d],n[d+1],n[d+2],f.materialIndex):l(d,d+1,d+2,f.materialIndex);else if(void 0!==n)for(c=0;c<n.length;c+=3)l(n[c],n[c+1],n[c+2]);else for(c=0;c<i.length/3;c+=3)l(c,c+1,c+2);return this.computeFaceNormals(),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(_vt).negate(),this.translate(_vt.x,_vt.y,_vt.z),this},normalize:function(){this.computeBoundingSphere();var t=this.boundingSphere.center,e=this.boundingSphere.radius,n=0===e?1:1/e,r=new ddt;return r.set(n,0,0,-n*t.x,0,n,0,-n*t.y,0,0,n,-n*t.z,0,0,0,1),this.applyMatrix4(r),this},computeFaceNormals:function(){for(var t=new adt,e=new adt,n=0,r=this.faces.length;n<r;n++){var i=this.faces[n],o=this.vertices[i.a],a=this.vertices[i.b],s=this.vertices[i.c];t.subVectors(s,a),e.subVectors(o,a),t.cross(e),t.normalize(),i.normal.copy(t)}},computeVertexNormals:function(t){var e,n,r,i,o,a;for(void 0===t&&(t=!0),a=new Array(this.vertices.length),e=0,n=this.vertices.length;e<n;e++)a[e]=new adt;if(t){var s,u,c,l=new adt,h=new adt;for(r=0,i=this.faces.length;r<i;r++)o=this.faces[r],s=this.vertices[o.a],u=this.vertices[o.b],c=this.vertices[o.c],l.subVectors(c,u),h.subVectors(s,u),l.cross(h),a[o.a].add(l),a[o.b].add(l),a[o.c].add(l)}else for(this.computeFaceNormals(),r=0,i=this.faces.length;r<i;r++)a[(o=this.faces[r]).a].add(o.normal),a[o.b].add(o.normal),a[o.c].add(o.normal);for(e=0,n=this.vertices.length;e<n;e++)a[e].normalize();for(r=0,i=this.faces.length;r<i;r++){var f=(o=this.faces[r]).vertexNormals;3===f.length?(f[0].copy(a[o.a]),f[1].copy(a[o.b]),f[2].copy(a[o.c])):(f[0]=a[o.a].clone(),f[1]=a[o.b].clone(),f[2]=a[o.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var t,e,n;for(this.computeFaceNormals(),t=0,e=this.faces.length;t<e;t++){var r=(n=this.faces[t]).vertexNormals;3===r.length?(r[0].copy(n.normal),r[1].copy(n.normal),r[2].copy(n.normal)):(r[0]=n.normal.clone(),r[1]=n.normal.clone(),r[2]=n.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var t,e,n,r,i;for(n=0,r=this.faces.length;n<r;n++)for((i=this.faces[n]).__originalFaceNormal?i.__originalFaceNormal.copy(i.normal):i.__originalFaceNormal=i.normal.clone(),i.__originalVertexNormals||(i.__originalVertexNormals=[]),t=0,e=i.vertexNormals.length;t<e;t++)i.__originalVertexNormals[t]?i.__originalVertexNormals[t].copy(i.vertexNormals[t]):i.__originalVertexNormals[t]=i.vertexNormals[t].clone();var o=new wvt;for(o.faces=this.faces,t=0,e=this.morphTargets.length;t<e;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[];var a=this.morphNormals[t].faceNormals,s=this.morphNormals[t].vertexNormals;for(n=0,r=this.faces.length;n<r;n++)u=new adt,c={a:new adt,b:new adt,c:new adt},a.push(u),s.push(c)}var u,c,l=this.morphNormals[t];for(o.vertices=this.morphTargets[t].vertices,o.computeFaceNormals(),o.computeVertexNormals(),n=0,r=this.faces.length;n<r;n++)i=this.faces[n],u=l.faceNormals[n],c=l.vertexNormals[n],u.copy(i.normal),c.a.copy(i.vertexNormals[0]),c.b.copy(i.vertexNormals[1]),c.c.copy(i.vertexNormals[2])}for(n=0,r=this.faces.length;n<r;n++)(i=this.faces[n]).normal=i.__originalFaceNormal,i.vertexNormals=i.__originalVertexNormals},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Xdt),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new $dt),this.boundingSphere.setFromPoints(this.vertices)},merge:function(t,e,n){if(t&&t.isGeometry){var r,i=this.vertices.length,o=this.vertices,a=t.vertices,s=this.faces,u=t.faces,c=this.colors,l=t.colors;void 0===n&&(n=0),void 0!==e&&(r=(new $pt).getNormalMatrix(e));for(var h=0,f=a.length;h<f;h++){var p=a[h].clone();void 0!==e&&p.applyMatrix4(e),o.push(p)}for(h=0,f=l.length;h<f;h++)c.push(l[h].clone());for(h=0,f=u.length;h<f;h++){var d,m,v,g=u[h],y=g.vertexNormals,x=g.vertexColors;(d=new Tmt(g.a+i,g.b+i,g.c+i)).normal.copy(g.normal),void 0!==r&&d.normal.applyMatrix3(r).normalize();for(var b=0,_=y.length;b<_;b++)m=y[b].clone(),void 0!==r&&m.applyMatrix3(r).normalize(),d.vertexNormals.push(m);d.color.copy(g.color);for(b=0,_=x.length;b<_;b++)v=x[b],d.vertexColors.push(v.clone());d.materialIndex=g.materialIndex+n,s.push(d)}for(h=0,f=t.faceVertexUvs.length;h<f;h++){var w=t.faceVertexUvs[h];void 0===this.faceVertexUvs[h]&&(this.faceVertexUvs[h]=[]);for(b=0,_=w.length;b<_;b++){for(var S=w[b],M=[],E=0,A=S.length;E<A;E++)M.push(S[E].clone());this.faceVertexUvs[h].push(M)}}}},mergeMesh:function(t){t&&t.isMesh&&(t.matrixAutoUpdate&&t.updateMatrix(),this.merge(t.geometry,t.matrix))},mergeVertices:function(){var t,e,n,r,i,o,a,s,u={},c=[],l=[],h=Math.pow(10,4);for(n=0,r=this.vertices.length;n<r;n++)t=this.vertices[n],void 0===u[e=Math.round(t.x*h)+"_"+Math.round(t.y*h)+"_"+Math.round(t.z*h)]?(u[e]=n,c.push(this.vertices[n]),l[n]=c.length-1):l[n]=l[u[e]];var f=[];for(n=0,r=this.faces.length;n<r;n++){(i=this.faces[n]).a=l[i.a],i.b=l[i.b],i.c=l[i.c],o=[i.a,i.b,i.c];for(var p=0;p<3;p++)if(o[p]===o[(p+1)%3]){f.push(n);break}}for(n=f.length-1;n>=0;n--){var d=f[n];for(this.faces.splice(d,1),a=0,s=this.faceVertexUvs.length;a<s;a++)this.faceVertexUvs[a].splice(d,1)}var m=this.vertices.length-c.length;return this.vertices=c,m},setFromPoints:function(t){this.vertices=[];for(var e=0,n=t.length;e<n;e++){var r=t[e];this.vertices.push(new adt(r.x,r.y,r.z||0))}return this},sortFacesByMaterialIndex:function(){for(var t=this.faces,e=t.length,n=0;n<e;n++)t[n]._id=n;t.sort((function(t,e){return t.materialIndex-e.materialIndex}));var r,i,o=this.faceVertexUvs[0],a=this.faceVertexUvs[1];o&&o.length===e&&(r=[]),a&&a.length===e&&(i=[]);for(n=0;n<e;n++){var s=t[n]._id;r&&r.push(o[s]),i&&i.push(a[s])}r&&(this.faceVertexUvs[0]=r),i&&(this.faceVertexUvs[1]=i)},toJSON:function(){var t={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),void 0!==this.parameters){var e=this.parameters;for(var n in e)void 0!==e[n]&&(t[n]=e[n]);return t}for(var r=[],i=0;i<this.vertices.length;i++){var o=this.vertices[i];r.push(o.x,o.y,o.z)}var a=[],s=[],u={},c=[],l={},h=[],f={};for(i=0;i<this.faces.length;i++){var p=this.faces[i],d=void 0!==this.faceVertexUvs[0][i],m=p.normal.length()>0,v=p.vertexNormals.length>0,g=1!==p.color.r||1!==p.color.g||1!==p.color.b,y=p.vertexColors.length>0,x=0;if(x=S(x,0,0),x=S(x,1,!0),x=S(x,2,!1),x=S(x,3,d),x=S(x,4,m),x=S(x,5,v),x=S(x,6,g),x=S(x,7,y),a.push(x),a.push(p.a,p.b,p.c),a.push(p.materialIndex),d){var b=this.faceVertexUvs[0][i];a.push(A(b[0]),A(b[1]),A(b[2]))}if(m&&a.push(M(p.normal)),v){var _=p.vertexNormals;a.push(M(_[0]),M(_[1]),M(_[2]))}if(g&&a.push(E(p.color)),y){var w=p.vertexColors;a.push(E(w[0]),E(w[1]),E(w[2]))}}function S(t,e,n){return n?t|1<<e:t&~(1<<e)}function M(t){var e=t.x.toString()+t.y.toString()+t.z.toString();return void 0!==u[e]||(u[e]=s.length/3,s.push(t.x,t.y,t.z)),u[e]}function E(t){var e=t.r.toString()+t.g.toString()+t.b.toString();return void 0!==l[e]||(l[e]=c.length,c.push(t.getHex())),l[e]}function A(t){var e=t.x.toString()+t.y.toString();return void 0!==f[e]||(f[e]=h.length/2,h.push(t.x,t.y)),f[e]}return t.data={},t.data.vertices=r,t.data.normals=s,c.length>0&&(t.data.colors=c),h.length>0&&(t.data.uvs=[h]),t.data.faces=a,t},clone:function(){return(new wvt).copy(this)},copy:function(t){var e,n,r,i,o,a;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=t.name;var s=t.vertices;for(e=0,n=s.length;e<n;e++)this.vertices.push(s[e].clone());var u=t.colors;for(e=0,n=u.length;e<n;e++)this.colors.push(u[e].clone());var c=t.faces;for(e=0,n=c.length;e<n;e++)this.faces.push(c[e].clone());for(e=0,n=t.faceVertexUvs.length;e<n;e++){var l=t.faceVertexUvs[e];for(void 0===this.faceVertexUvs[e]&&(this.faceVertexUvs[e]=[]),r=0,i=l.length;r<i;r++){var h=l[r],f=[];for(o=0,a=h.length;o<a;o++){var p=h[o];f.push(p.clone())}this.faceVertexUvs[e].push(f)}}var d=t.morphTargets;for(e=0,n=d.length;e<n;e++){var m={};if(m.name=d[e].name,void 0!==d[e].vertices)for(m.vertices=[],r=0,i=d[e].vertices.length;r<i;r++)m.vertices.push(d[e].vertices[r].clone());if(void 0!==d[e].normals)for(m.normals=[],r=0,i=d[e].normals.length;r<i;r++)m.normals.push(d[e].normals[r].clone());this.morphTargets.push(m)}var v=t.morphNormals;for(e=0,n=v.length;e<n;e++){var g={};if(void 0!==v[e].vertexNormals)for(g.vertexNormals=[],r=0,i=v[e].vertexNormals.length;r<i;r++){var y=v[e].vertexNormals[r],x={};x.a=y.a.clone(),x.b=y.b.clone(),x.c=y.c.clone(),g.vertexNormals.push(x)}if(void 0!==v[e].faceNormals)for(g.faceNormals=[],r=0,i=v[e].faceNormals.length;r<i;r++)g.faceNormals.push(v[e].faceNormals[r].clone());this.morphNormals.push(g)}var b=t.skinWeights;for(e=0,n=b.length;e<n;e++)this.skinWeights.push(b[e].clone());var _=t.skinIndices;for(e=0,n=_.length;e<n;e++)this.skinIndices.push(_[e].clone());var w=t.lineDistances;for(e=0,n=w.length;e<n;e++)this.lineDistances.push(w[e]);var S=t.boundingBox;null!==S&&(this.boundingBox=S.clone());var M=t.boundingSphere;return null!==M&&(this.boundingSphere=M.clone()),this.elementsNeedUpdate=t.elementsNeedUpdate,this.verticesNeedUpdate=t.verticesNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.lineDistancesNeedUpdate=t.lineDistancesNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});class Svt extends Kmt{constructor(t,e,n,r,i,o){super(),this.type="BoxBufferGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:r,heightSegments:i,depthSegments:o};var a=this;t=t||1,e=e||1,n=n||1,r=Math.floor(r)||1,i=Math.floor(i)||1,o=Math.floor(o)||1;var s=[],u=[],c=[],l=[],h=0,f=0;function p(t,e,n,r,i,o,p,d,m,v,g){var y,x,b=o/m,_=p/v,w=o/2,S=p/2,M=d/2,E=m+1,A=v+1,T=0,C=0,O=new adt;for(x=0;x<A;x++){var k=x*_-S;for(y=0;y<E;y++){var P=y*b-w;O[t]=P*r,O[e]=k*i,O[n]=M,u.push(O.x,O.y,O.z),O[t]=0,O[e]=0,O[n]=d>0?1:-1,c.push(O.x,O.y,O.z),l.push(y/m),l.push(1-x/v),T+=1}}for(x=0;x<v;x++)for(y=0;y<m;y++){var L=h+y+E*x,R=h+y+E*(x+1),I=h+(y+1)+E*(x+1),N=h+(y+1)+E*x;s.push(L,R,N),s.push(R,I,N),C+=6}a.addGroup(f,C,g),f+=C,h+=T}p("z","y","x",-1,-1,n,e,t,o,i,0),p("z","y","x",1,-1,n,e,-t,o,i,1),p("x","z","y",1,1,t,n,e,r,o,2),p("x","z","y",1,-1,t,n,-e,r,o,3),p("x","y","z",1,-1,t,e,n,r,i,4),p("x","y","z",-1,-1,t,e,-n,r,i,5),this.setIndex(s),this.setAttribute("position",new zmt(u,3)),this.setAttribute("normal",new zmt(c,3)),this.setAttribute("uv",new zmt(l,2))}}function Mvt(t){var e={};for(var n in t)for(var r in e[n]={},t[n]){var i=t[n][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture)?e[n][r]=i.clone():Array.isArray(i)?e[n][r]=i.slice():e[n][r]=i}return e}function Evt(t){for(var e={},n=0;n<t.length;n++){var r=Mvt(t[n]);for(var i in r)e[i]=r[i]}return e}var Avt={clone:Mvt,merge:Evt};function Tvt(t){Omt.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,void 0!==t&&(t.attributes,this.setValues(t))}function Cvt(){Ldt.call(this),this.type="Camera",this.matrixWorldInverse=new ddt,this.projectionMatrix=new ddt,this.projectionMatrixInverse=new ddt}function Ovt(t,e,n,r){Cvt.call(this),this.type="PerspectiveCamera",this.fov=void 0!==t?t:50,this.zoom=1,this.near=void 0!==n?n:.1,this.far=void 0!==r?r:2e3,this.focus=10,this.aspect=void 0!==e?e:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}Tvt.prototype=Object.create(Omt.prototype),Tvt.prototype.constructor=Tvt,Tvt.prototype.isShaderMaterial=!0,Tvt.prototype.copy=function(t){return Omt.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=Mvt(t.uniforms),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=t.extensions,this},Tvt.prototype.toJSON=function(t){var e=Omt.prototype.toJSON.call(this,t);for(var n in e.uniforms={},this.uniforms){var r=this.uniforms[n].value;r&&r.isTexture?e.uniforms[n]={type:"t",value:r.toJSON(t).uuid}:r&&r.isColor?e.uniforms[n]={type:"c",value:r.getHex()}:r&&r.isVector2?e.uniforms[n]={type:"v2",value:r.toArray()}:r&&r.isVector3?e.uniforms[n]={type:"v3",value:r.toArray()}:r&&r.isVector4?e.uniforms[n]={type:"v4",value:r.toArray()}:r&&r.isMatrix3?e.uniforms[n]={type:"m3",value:r.toArray()}:r&&r.isMatrix4?e.uniforms[n]={type:"m4",value:r.toArray()}:e.uniforms[n]={value:r}}Object.keys(this.defines).length>0&&(e.defines=this.defines),e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader;var i={};for(var o in this.extensions)!0===this.extensions[o]&&(i[o]=!0);return Object.keys(i).length>0&&(e.extensions=i),e},Cvt.prototype=Object.assign(Object.create(Ldt.prototype),{constructor:Cvt,isCamera:!0,copy:function(t,e){return Ldt.prototype.copy.call(this,t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this},getWorldDirection:function(t){void 0===t&&(t=new adt),this.updateMatrixWorld(!0);var e=this.matrixWorld.elements;return t.set(-e[8],-e[9],-e[10]).normalize()},updateMatrixWorld:function(t){Ldt.prototype.updateMatrixWorld.call(this,t),this.matrixWorldInverse.getInverse(this.matrixWorld)},updateWorldMatrix:function(t,e){Ldt.prototype.updateWorldMatrix.call(this,t,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),Ovt.prototype=Object.assign(Object.create(Cvt.prototype),{constructor:Ovt,isPerspectiveCamera:!0,copy:function(t,e){return Cvt.prototype.copy.call(this,t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this},setFocalLength:function(t){var e=.5*this.getFilmHeight()/t;this.fov=2*qpt.RAD2DEG*Math.atan(e),this.updateProjectionMatrix()},getFocalLength:function(){var t=Math.tan(.5*qpt.DEG2RAD*this.fov);return.5*this.getFilmHeight()/t},getEffectiveFOV:function(){return 2*qpt.RAD2DEG*Math.atan(Math.tan(.5*qpt.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(t,e,n,r,i,o){this.aspect=t/e,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=this.near,e=t*Math.tan(.5*qpt.DEG2RAD*this.fov)/this.zoom,n=2*e,r=this.aspect*n,i=-.5*r,o=this.view;if(null!==this.view&&this.view.enabled){var a=o.fullWidth,s=o.fullHeight;i+=o.offsetX*r/a,e-=o.offsetY*n/s,r*=o.width/a,n*=o.height/s}var u=this.filmOffset;0!==u&&(i+=t*u/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,e,e-n,t,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(t){var e=Ldt.prototype.toJSON.call(this,t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}});var kvt=90;function Pvt(t,e,n,r){Ldt.call(this),this.type="CubeCamera";var i=new Ovt(kvt,1,t,e);i.up.set(0,-1,0),i.lookAt(new adt(1,0,0)),this.add(i);var o=new Ovt(kvt,1,t,e);o.up.set(0,-1,0),o.lookAt(new adt(-1,0,0)),this.add(o);var a=new Ovt(kvt,1,t,e);a.up.set(0,0,1),a.lookAt(new adt(0,1,0)),this.add(a);var s=new Ovt(kvt,1,t,e);s.up.set(0,0,-1),s.lookAt(new adt(0,-1,0)),this.add(s);var u=new Ovt(kvt,1,t,e);u.up.set(0,-1,0),u.lookAt(new adt(0,0,1)),this.add(u);var c=new Ovt(kvt,1,t,e);c.up.set(0,-1,0),c.lookAt(new adt(0,0,-1)),this.add(c),r=r||{format:Cpt,magFilter:bpt,minFilter:bpt},this.renderTarget=new Lvt(n,r),this.renderTarget.texture.name="CubeCamera",this.update=function(t,e){null===this.parent&&this.updateMatrixWorld();var n=t.getRenderTarget(),r=this.renderTarget,l=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,t.setRenderTarget(r,0),t.render(e,i),t.setRenderTarget(r,1),t.render(e,o),t.setRenderTarget(r,2),t.render(e,a),t.setRenderTarget(r,3),t.render(e,s),t.setRenderTarget(r,4),t.render(e,u),r.texture.generateMipmaps=l,t.setRenderTarget(r,5),t.render(e,c),t.setRenderTarget(n)},this.clear=function(t,e,n,r){for(var i=t.getRenderTarget(),o=this.renderTarget,a=0;a<6;a++)t.setRenderTarget(o,a),t.clear(e,n,r);t.setRenderTarget(i)}}function Lvt(t,e,n){Number.isInteger(e)&&(e=n),edt.call(this,t,t,e)}function Rvt(t,e,n,r,i,o,a,s,u,c,l,h){Qpt.call(this,null,o,a,s,u,c,r,i,l,h),this.image={data:t||null,width:e||1,height:n||1},this.magFilter=void 0!==u?u:gpt,this.minFilter=void 0!==c?c:gpt,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}Pvt.prototype=Object.create(Ldt.prototype),Pvt.prototype.constructor=Pvt,Lvt.prototype=Object.create(edt.prototype),Lvt.prototype.constructor=Lvt,Lvt.prototype.isWebGLCubeRenderTarget=!0,Lvt.prototype.fromEquirectangularTexture=function(t,e){this.texture.type=e.type,this.texture.format=e.format,this.texture.encoding=e.encoding;var n=new Rdt,r={uniforms:{tEquirect:{value:null}},vertexShader:["varying vec3 vWorldDirection;","vec3 transformDirection( in vec3 dir, in mat4 matrix ) {","\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );","}","void main() {","\tvWorldDirection = transformDirection( position, modelMatrix );","\t#include <begin_vertex>","\t#include <project_vertex>","}"].join("\n"),fragmentShader:["uniform sampler2D tEquirect;","varying vec3 vWorldDirection;","#define RECIPROCAL_PI 0.31830988618","#define RECIPROCAL_PI2 0.15915494","void main() {","\tvec3 direction = normalize( vWorldDirection );","\tvec2 sampleUV;","\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;","\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;","\tgl_FragColor = texture2D( tEquirect, sampleUV );","}"].join("\n")},i=new Tvt({type:"CubemapFromEquirect",uniforms:Mvt(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:1,blending:0});i.uniforms.tEquirect.value=e;var o=new mvt(new Svt(5,5,5),i);n.add(o);var a=new Pvt(1,10,1);return a.renderTarget=this,a.renderTarget.texture.name="CubeCameraTexture",a.update(t,n),o.geometry.dispose(),o.material.dispose(),this},Rvt.prototype=Object.create(Qpt.prototype),Rvt.prototype.constructor=Rvt,Rvt.prototype.isDataTexture=!0;var Ivt=new $dt,Nvt=new adt;function Dvt(t,e,n,r,i,o){this.planes=[void 0!==t?t:new umt,void 0!==e?e:new umt,void 0!==n?n:new umt,void 0!==r?r:new umt,void 0!==i?i:new umt,void 0!==o?o:new umt]}Object.assign(Dvt.prototype,{set:function(t,e,n,r,i,o){var a=this.planes;return a[0].copy(t),a[1].copy(e),a[2].copy(n),a[3].copy(r),a[4].copy(i),a[5].copy(o),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){for(var e=this.planes,n=0;n<6;n++)e[n].copy(t.planes[n]);return this},setFromProjectionMatrix:function(t){var e=this.planes,n=t.elements,r=n[0],i=n[1],o=n[2],a=n[3],s=n[4],u=n[5],c=n[6],l=n[7],h=n[8],f=n[9],p=n[10],d=n[11],m=n[12],v=n[13],g=n[14],y=n[15];return e[0].setComponents(a-r,l-s,d-h,y-m).normalize(),e[1].setComponents(a+r,l+s,d+h,y+m).normalize(),e[2].setComponents(a+i,l+u,d+f,y+v).normalize(),e[3].setComponents(a-i,l-u,d-f,y-v).normalize(),e[4].setComponents(a-o,l-c,d-p,y-g).normalize(),e[5].setComponents(a+o,l+c,d+p,y+g).normalize(),this},intersectsObject:function(t){var e=t.geometry;return null===e.boundingSphere&&e.computeBoundingSphere(),Ivt.copy(e.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(Ivt)},intersectsSprite:function(t){return Ivt.center.set(0,0,0),Ivt.radius=.7071067811865476,Ivt.applyMatrix4(t.matrixWorld),this.intersectsSphere(Ivt)},intersectsSphere:function(t){for(var e=this.planes,n=t.center,r=-t.radius,i=0;i<6;i++){if(e[i].distanceToPoint(n)<r)return!1}return!0},intersectsBox:function(t){for(var e=this.planes,n=0;n<6;n++){var r=e[n];if(Nvt.x=r.normal.x>0?t.max.x:t.min.x,Nvt.y=r.normal.y>0?t.max.y:t.min.y,Nvt.z=r.normal.z>0?t.max.z:t.min.z,r.distanceToPoint(Nvt)<0)return!1}return!0},containsPoint:function(t){for(var e=this.planes,n=0;n<6;n++)if(e[n].distanceToPoint(t)<0)return!1;return!0}});var Fvt={common:{diffuse:{value:new Smt(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new $pt},uv2Transform:{value:new $pt},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Zpt(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Smt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new Smt(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new $pt}},sprite:{diffuse:{value:new Smt(15658734)},opacity:{value:1},center:{value:new Zpt(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new $pt}}};function jvt(){var t=null,e=!1,n=null;function r(i,o){!1!==e&&(n(i,o),t.requestAnimationFrame(r))}return{start:function(){!0!==e&&null!==n&&(t.requestAnimationFrame(r),e=!0)},stop:function(){e=!1},setAnimationLoop:function(t){n=t},setContext:function(e){t=e}}}function Bvt(t,e){var n=e.isWebGL2,r=new WeakMap;return{get:function(t){return t.isInterleavedBufferAttribute&&(t=t.data),r.get(t)},remove:function(e){e.isInterleavedBufferAttribute&&(e=e.data);var n=r.get(e);n&&(t.deleteBuffer(n.buffer),r.delete(e))},update:function(e,i){e.isInterleavedBufferAttribute&&(e=e.data);var o=r.get(e);void 0===o?r.set(e,function(e,n){var r=e.array,i=e.usage,o=t.createBuffer();t.bindBuffer(n,o),t.bufferData(n,r,i),e.onUploadCallback();var a=5126;return r instanceof Float32Array?a=5126:r instanceof Float64Array||(r instanceof Uint16Array?a=5123:r instanceof Int16Array?a=5122:r instanceof Uint32Array?a=5125:r instanceof Int32Array?a=5124:r instanceof Int8Array?a=5120:r instanceof Uint8Array&&(a=5121)),{buffer:o,type:a,bytesPerElement:r.BYTES_PER_ELEMENT,version:e.version}}(e,i)):o.version<e.version&&(!function(e,r,i){var o=r.array,a=r.updateRange;t.bindBuffer(i,e),-1===a.count?t.bufferSubData(i,0,o):(n?t.bufferSubData(i,a.offset*o.BYTES_PER_ELEMENT,o,a.offset,a.count):t.bufferSubData(i,a.offset*o.BYTES_PER_ELEMENT,o.subarray(a.offset,a.offset+a.count)),a.count=-1)}(o.buffer,e,i),o.version=e.version)}}}function zvt(t,e,n,r){wvt.call(this),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:r},this.fromBufferGeometry(new Uvt(t,e,n,r)),this.mergeVertices()}function Uvt(t,e,n,r){Kmt.call(this),this.type="PlaneBufferGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:r};var i,o,a=(t=t||1)/2,s=(e=e||1)/2,u=Math.floor(n)||1,c=Math.floor(r)||1,l=u+1,h=c+1,f=t/u,p=e/c,d=[],m=[],v=[],g=[];for(o=0;o<h;o++){var y=o*p-s;for(i=0;i<l;i++){var x=i*f-a;m.push(x,-y,0),v.push(0,0,1),g.push(i/u),g.push(1-o/c)}}for(o=0;o<c;o++)for(i=0;i<u;i++){var b=i+l*o,_=i+l*(o+1),w=i+1+l*(o+1),S=i+1+l*o;d.push(b,_,S),d.push(_,w,S)}this.setIndex(d),this.setAttribute("position",new zmt(m,3)),this.setAttribute("normal",new zmt(v,3)),this.setAttribute("uv",new zmt(g,2))}zvt.prototype=Object.create(wvt.prototype),zvt.prototype.constructor=zvt,Uvt.prototype=Object.create(Kmt.prototype),Uvt.prototype.constructor=Uvt;var Vvt={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\n\tvec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\n\treturn Fr * fresnel + F0;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + viewDir );\n\tfloat dotNL = saturate( dot( normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\treturn specularColor * brdf.x + brdf.y;\n}\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie(float roughness, float NoH) {\n\tfloat invAlpha  = 1.0 / roughness;\n\tfloat cos2h = NoH * NoH;\n\tfloat sin2h = max(1.0 - cos2h, 0.0078125);\treturn (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);\n}\nfloat V_Neubelt(float NoV, float NoL) {\n\treturn saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));\n}\nvec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\tvec3 H = normalize( V + L );\n\tfloat dotNH = saturate( dot( N, H ) );\n\treturn specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n  return m[ 2 ][ 3 ] == - 1.0;\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_maxMipLevel 8.0\n#define cubeUV_minMipLevel 4.0\n#define cubeUV_maxTileSize 256.0\n#define cubeUV_minTileSize 16.0\nfloat getFace(vec3 direction) {\n    vec3 absDirection = abs(direction);\n    float face = -1.0;\n    if (absDirection.x > absDirection.z) {\n      if (absDirection.x > absDirection.y)\n        face = direction.x > 0.0 ? 0.0 : 3.0;\n      else\n        face = direction.y > 0.0 ? 1.0 : 4.0;\n    } else {\n      if (absDirection.z > absDirection.y)\n        face = direction.z > 0.0 ? 2.0 : 5.0;\n      else\n        face = direction.y > 0.0 ? 1.0 : 4.0;\n    }\n    return face;\n}\nvec2 getUV(vec3 direction, float face) {\n    vec2 uv;\n    if (face == 0.0) {\n      uv = vec2(-direction.z, direction.y) / abs(direction.x);\n    } else if (face == 1.0) {\n      uv = vec2(direction.x, -direction.z) / abs(direction.y);\n    } else if (face == 2.0) {\n      uv = direction.xy / abs(direction.z);\n    } else if (face == 3.0) {\n      uv = vec2(direction.z, direction.y) / abs(direction.x);\n    } else if (face == 4.0) {\n      uv = direction.xz / abs(direction.y);\n    } else {\n      uv = vec2(-direction.x, direction.y) / abs(direction.z);\n    }\n    return 0.5 * (uv + 1.0);\n}\nvec3 bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {\n  float face = getFace(direction);\n  float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);\n  mipInt = max(mipInt, cubeUV_minMipLevel);\n  float faceSize = exp2(mipInt);\n  float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);\n  vec2 uv = getUV(direction, face) * (faceSize - 1.0);\n  vec2 f = fract(uv);\n  uv += 0.5 - f;\n  if (face > 2.0) {\n    uv.y += faceSize;\n    face -= 3.0;\n  }\n  uv.x += face * faceSize;\n  if(mipInt < cubeUV_maxMipLevel){\n    uv.y += 2.0 * cubeUV_maxTileSize;\n  }\n  uv.y += filterInt * 2.0 * cubeUV_minTileSize;\n  uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);\n  uv *= texelSize;\n  vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.x += texelSize;\n  vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.y += texelSize;\n  vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.x -= texelSize;\n  vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  vec3 tm = mix(tl, tr, f.x);\n  vec3 bm = mix(bl, br, f.x);\n  return mix(tm, bm, f.y);\n}\n#define r0 1.0\n#define v0 0.339\n#define m0 -2.0\n#define r1 0.8\n#define v1 0.276\n#define m1 -1.0\n#define r4 0.4\n#define v4 0.046\n#define m4 2.0\n#define r5 0.305\n#define v5 0.016\n#define m5 3.0\n#define r6 0.21\n#define v6 0.0038\n#define m6 4.0\nfloat roughnessToMip(float roughness) {\n  float mip = 0.0;\n  if (roughness >= r1) {\n    mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;\n  } else if (roughness >= r4) {\n    mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;\n  } else if (roughness >= r5) {\n    mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;\n  } else if (roughness >= r6) {\n    mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;\n  } else {\n    mip = -2.0 * log2(1.16 * roughness);  }\n  return mip;\n}\nvec4 textureCubeUV(sampler2D envMap, vec3 sampleDir, float roughness) {\n  float mip = clamp(roughnessToMip(roughness), m0, cubeUV_maxMipLevel);\n  float mipF = fract(mip);\n  float mipInt = floor(mip);\n  vec3 color0 = bilinearCubeUV(envMap, sampleDir, mipInt);\n  if (mipF == 0.0) {\n    return vec4(color0, 1.0);\n  } else {\n    vec3 color1 = bilinearCubeUV(envMap, sampleDir, mipInt + 1.0);\n    return vec4(mix(color0, color1, mipF), 1.0);\n  }\n}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\t\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t}  else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\treflectVec = normalize( reflectVec );\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifndef ENVMAP_TYPE_CUBE_UV\n\t\tenvColor = envMapTexelToLinear( envColor );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat sigma = PI * roughness * roughness / ( 1.0 + roughness );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + log2( sigma );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t  vec3 reflectVec = reflect( -viewDir, normal );\n\t\t  reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t#else\n\t\t  vec3 reflectVec = refract( -viewDir, normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) { \n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tfogDepth = -mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn texture2D( gradientMap, coord ).rgb;\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\treflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct ToonMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;\nmaterial.specularRoughness = min( material.specularRoughness, 1.0 );\n#ifdef REFLECTIVITY\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#endif\n#ifdef CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheen;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n#ifdef CLEARCOAT\n\tfloat clearcoat;\n\tfloat clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tvec3 sheenColor;\n#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearcoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = ccDotNL * directLight.color;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tccIrradiance *= PI;\n\t\t#endif\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t\treflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(\n\t\t\tmaterial.specularRoughness,\n\t\t\tdirectLight.direction,\n\t\t\tgeometry,\n\t\t\tmaterial.sheenColor\n\t\t);\n\t#else\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);\n\t#endif\n\treflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t\tfloat ccDotNL = ccDotNV;\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\tfloat clearcoatInv = 1.0 - clearcoatDHR;\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );\n\t#ifdef CLEARCOAT\n\t\tclearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",normal_fragment_begin:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\tbitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal, mapN );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\n\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\tvec3 N = normalize( surf_norm );\n\t\tmat3 tsn = mat3( S, T, N );\n\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( ( color * ( 2.51 * color + 0.03 ) ) / ( color * ( 2.43 * color + 0.59 ) + 0.14 ) );\n}",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV;\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define TRANSPARENCY\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef TRANSPARENCY\n\tuniform float transparency;\n#endif\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#ifdef TRANSPARENCY\n\t\tdiffuseColor.a *= saturate( 1. - transparency + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );\n\t#endif\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",shadow_vert:"#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}"},Gvt={basic:{uniforms:Evt([Fvt.common,Fvt.specularmap,Fvt.envmap,Fvt.aomap,Fvt.lightmap,Fvt.fog]),vertexShader:Vvt.meshbasic_vert,fragmentShader:Vvt.meshbasic_frag},lambert:{uniforms:Evt([Fvt.common,Fvt.specularmap,Fvt.envmap,Fvt.aomap,Fvt.lightmap,Fvt.emissivemap,Fvt.fog,Fvt.lights,{emissive:{value:new Smt(0)}}]),vertexShader:Vvt.meshlambert_vert,fragmentShader:Vvt.meshlambert_frag},phong:{uniforms:Evt([Fvt.common,Fvt.specularmap,Fvt.envmap,Fvt.aomap,Fvt.lightmap,Fvt.emissivemap,Fvt.bumpmap,Fvt.normalmap,Fvt.displacementmap,Fvt.fog,Fvt.lights,{emissive:{value:new Smt(0)},specular:{value:new Smt(1118481)},shininess:{value:30}}]),vertexShader:Vvt.meshphong_vert,fragmentShader:Vvt.meshphong_frag},standard:{uniforms:Evt([Fvt.common,Fvt.envmap,Fvt.aomap,Fvt.lightmap,Fvt.emissivemap,Fvt.bumpmap,Fvt.normalmap,Fvt.displacementmap,Fvt.roughnessmap,Fvt.metalnessmap,Fvt.fog,Fvt.lights,{emissive:{value:new Smt(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:Vvt.meshphysical_vert,fragmentShader:Vvt.meshphysical_frag},toon:{uniforms:Evt([Fvt.common,Fvt.specularmap,Fvt.aomap,Fvt.lightmap,Fvt.emissivemap,Fvt.bumpmap,Fvt.normalmap,Fvt.displacementmap,Fvt.gradientmap,Fvt.fog,Fvt.lights,{emissive:{value:new Smt(0)},specular:{value:new Smt(1118481)},shininess:{value:30}}]),vertexShader:Vvt.meshtoon_vert,fragmentShader:Vvt.meshtoon_frag},matcap:{uniforms:Evt([Fvt.common,Fvt.bumpmap,Fvt.normalmap,Fvt.displacementmap,Fvt.fog,{matcap:{value:null}}]),vertexShader:Vvt.meshmatcap_vert,fragmentShader:Vvt.meshmatcap_frag},points:{uniforms:Evt([Fvt.points,Fvt.fog]),vertexShader:Vvt.points_vert,fragmentShader:Vvt.points_frag},dashed:{uniforms:Evt([Fvt.common,Fvt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Vvt.linedashed_vert,fragmentShader:Vvt.linedashed_frag},depth:{uniforms:Evt([Fvt.common,Fvt.displacementmap]),vertexShader:Vvt.depth_vert,fragmentShader:Vvt.depth_frag},normal:{uniforms:Evt([Fvt.common,Fvt.bumpmap,Fvt.normalmap,Fvt.displacementmap,{opacity:{value:1}}]),vertexShader:Vvt.normal_vert,fragmentShader:Vvt.normal_frag},sprite:{uniforms:Evt([Fvt.sprite,Fvt.fog]),vertexShader:Vvt.sprite_vert,fragmentShader:Vvt.sprite_frag},background:{uniforms:{uvTransform:{value:new $pt},t2D:{value:null}},vertexShader:Vvt.background_vert,fragmentShader:Vvt.background_frag},cube:{uniforms:Evt([Fvt.envmap,{opacity:{value:1}}]),vertexShader:Vvt.cube_vert,fragmentShader:Vvt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Vvt.equirect_vert,fragmentShader:Vvt.equirect_frag},distanceRGBA:{uniforms:Evt([Fvt.common,Fvt.displacementmap,{referencePosition:{value:new adt},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Vvt.distanceRGBA_vert,fragmentShader:Vvt.distanceRGBA_frag},shadow:{uniforms:Evt([Fvt.lights,Fvt.fog,{color:{value:new Smt(0)},opacity:{value:1}}]),vertexShader:Vvt.shadow_vert,fragmentShader:Vvt.shadow_frag}};function Wvt(t,e,n,r){var i,o,a=new Smt(0),s=0,u=null,c=0,l=null;function h(t,n){e.buffers.color.setClear(t.r,t.g,t.b,n,r)}return{getClearColor:function(){return a},setClearColor:function(t,e){a.set(t),h(a,s=void 0!==e?e:1)},getClearAlpha:function(){return s},setClearAlpha:function(t){h(a,s=t)},render:function(e,r,f,p){var d=r.background,m=t.xr,v=m.getSession&&m.getSession();if(v&&"additive"===v.environmentBlendMode&&(d=null),null===d?h(a,s):d&&d.isColor&&(h(d,1),p=!0),(t.autoClear||p)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),d&&(d.isCubeTexture||d.isWebGLCubeRenderTarget||d.mapping===ppt)){void 0===o&&((o=new mvt(new Svt(1,1,1),new Tvt({type:"BackgroundCubeMaterial",uniforms:Mvt(Gvt.cube.uniforms),vertexShader:Gvt.cube.vertexShader,fragmentShader:Gvt.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),o.geometry.deleteAttribute("uv"),o.onBeforeRender=function(t,e,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(o.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),n.update(o));var g=d.isWebGLCubeRenderTarget?d.texture:d;o.material.uniforms.envMap.value=g,o.material.uniforms.flipEnvMap.value=g.isCubeTexture?-1:1,u===d&&c===g.version&&l===t.toneMapping||(o.material.needsUpdate=!0,u=d,c=g.version,l=t.toneMapping),e.unshift(o,o.geometry,o.material,0,0,null)}else d&&d.isTexture&&(void 0===i&&((i=new mvt(new Uvt(2,2),new Tvt({type:"BackgroundMaterial",uniforms:Mvt(Gvt.background.uniforms),vertexShader:Gvt.background.vertexShader,fragmentShader:Gvt.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),Object.defineProperty(i.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(i)),i.material.uniforms.t2D.value=d,!0===d.matrixAutoUpdate&&d.updateMatrix(),i.material.uniforms.uvTransform.value.copy(d.matrix),u===d&&c===d.version&&l===t.toneMapping||(i.material.needsUpdate=!0,u=d,c=d.version,l=t.toneMapping),e.unshift(i,i.geometry,i.material,0,0,null))}}}function Hvt(t,e,n,r){var i,o=r.isWebGL2;this.setMode=function(t){i=t},this.render=function(e,r){t.drawArrays(i,e,r),n.update(r,i)},this.renderInstances=function(r,a,s,u){if(0!==u){var c,l;if(o)c=t,l="drawArraysInstanced";else if(l="drawArraysInstancedANGLE",null===(c=e.get("ANGLE_instanced_arrays")))return;c[l](i,a,s,u),n.update(s,i,u)}}}function Yvt(t,e,n){var r;function i(e){if("highp"===e){if(t.getShaderPrecisionFormat(35633,36338).precision>0&&t.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";e="mediump"}return"mediump"===e&&t.getShaderPrecisionFormat(35633,36337).precision>0&&t.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}var o="undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&t instanceof WebGL2ComputeRenderingContext,a=void 0!==n.precision?n.precision:"highp",s=i(a);s!==a&&(a=s);var u=!0===n.logarithmicDepthBuffer,c=t.getParameter(34930),l=t.getParameter(35660),h=t.getParameter(3379),f=t.getParameter(34076),p=t.getParameter(34921),d=t.getParameter(36347),m=t.getParameter(36348),v=t.getParameter(36349),g=l>0,y=o||!!e.get("OES_texture_float");return{isWebGL2:o,getMaxAnisotropy:function(){if(void 0!==r)return r;var n=e.get("EXT_texture_filter_anisotropic");return r=null!==n?t.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:i,precision:a,logarithmicDepthBuffer:u,maxTextures:c,maxVertexTextures:l,maxTextureSize:h,maxCubemapSize:f,maxAttributes:p,maxVertexUniforms:d,maxVaryings:m,maxFragmentUniforms:v,vertexTextures:g,floatFragmentTextures:y,floatVertexTextures:g&&y,maxSamples:o?t.getParameter(36183):0}}function Xvt(){var t=this,e=null,n=0,r=!1,i=!1,o=new umt,a=new $pt,s={value:null,needsUpdate:!1};function u(){s.value!==e&&(s.value=e,s.needsUpdate=n>0),t.numPlanes=n,t.numIntersection=0}function c(e,n,r,i){var u=null!==e?e.length:0,c=null;if(0!==u){if(c=s.value,!0!==i||null===c){var l=r+4*u,h=n.matrixWorldInverse;a.getNormalMatrix(h),(null===c||c.length<l)&&(c=new Float32Array(l));for(var f=0,p=r;f!==u;++f,p+=4)o.copy(e[f]).applyMatrix4(h,a),o.normal.toArray(c,p),c[p+3]=o.constant}s.value=c,s.needsUpdate=!0}return t.numPlanes=u,t.numIntersection=0,c}this.uniform=s,this.numPlanes=0,this.numIntersection=0,this.init=function(t,i,o){var a=0!==t.length||i||0!==n||r;return r=i,e=c(t,o,0),n=t.length,a},this.beginShadows=function(){i=!0,c(null)},this.endShadows=function(){i=!1,u()},this.setState=function(t,o,a,l,h,f){if(!r||null===t||0===t.length||i&&!a)i?c(null):u();else{var p=i?0:n,d=4*p,m=h.clippingState||null;s.value=m,m=c(t,l,d,f);for(var v=0;v!==d;++v)m[v]=e[v];h.clippingState=m,this.numIntersection=o?this.numPlanes:0,this.numPlanes+=p}}}function qvt(t){var e={};return{get:function(n){if(void 0!==e[n])return e[n];var r;switch(n){case"WEBGL_depth_texture":r=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=t.getExtension(n)}return e[n]=r,r}}}function Zvt(t,e,n){var r=new WeakMap,i=new WeakMap;function o(t){var a=t.target,s=r.get(a);for(var u in null!==s.index&&e.remove(s.index),s.attributes)e.remove(s.attributes[u]);a.removeEventListener("dispose",o),r.delete(a);var c=i.get(s);c&&(e.remove(c),i.delete(s)),n.memory.geometries--}function a(t){var n=[],r=t.index,o=t.attributes.position,a=0;if(null!==r){var s=r.array;a=r.version;for(var u=0,c=s.length;u<c;u+=3){var l=s[u+0],h=s[u+1],f=s[u+2];n.push(l,h,h,f,f,l)}}else{s=o.array;a=o.version;for(u=0,c=s.length/3-1;u<c;u+=3){l=u+0,h=u+1,f=u+2;n.push(l,h,h,f,f,l)}}var p=new(Gmt(n)>65535?Bmt:Fmt)(n,1);p.version=a,e.update(p,34963);var d=i.get(t);d&&e.remove(d),i.set(t,p)}return{get:function(t,e){var i=r.get(e);return i||(e.addEventListener("dispose",o),e.isBufferGeometry?i=e:e.isGeometry&&(void 0===e._bufferGeometry&&(e._bufferGeometry=(new Kmt).setFromObject(t)),i=e._bufferGeometry),r.set(e,i),n.memory.geometries++,i)},update:function(t){var n=t.index,r=t.attributes;for(var i in null!==n&&e.update(n,34963),r)e.update(r[i],34962);var o=t.morphAttributes;for(var i in o)for(var a=o[i],s=0,u=a.length;s<u;s++)e.update(a[s],34962)},getWireframeAttribute:function(t){var e=i.get(t);if(e){var n=t.index;null!==n&&e.version<n.version&&a(t)}else a(t);return i.get(t)}}}function $vt(t,e,n,r){var i,o,a,s=r.isWebGL2;this.setMode=function(t){i=t},this.setIndex=function(t){o=t.type,a=t.bytesPerElement},this.render=function(e,r){t.drawElements(i,r,o,e*a),n.update(r,i)},this.renderInstances=function(r,u,c,l){if(0!==l){var h,f;if(s)h=t,f="drawElementsInstanced";else if(f="drawElementsInstancedANGLE",null===(h=e.get("ANGLE_instanced_arrays")))return;h[f](i,c,o,u*a,l),n.update(c,i,l)}}}function Kvt(t){var e={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:e,programs:null,autoReset:!0,reset:function(){e.frame++,e.calls=0,e.triangles=0,e.points=0,e.lines=0},update:function(t,n,r){switch(r=r||1,e.calls++,n){case 4:e.triangles+=r*(t/3);break;case 1:e.lines+=r*(t/2);break;case 3:e.lines+=r*(t-1);break;case 2:e.lines+=r*t;break;case 0:e.points+=r*t}}}}function Jvt(t,e){return Math.abs(e[1])-Math.abs(t[1])}function Qvt(t){var e={},n=new Float32Array(8);return{update:function(r,i,o,a){var s=r.morphTargetInfluences,u=void 0===s?0:s.length,c=e[i.id];if(void 0===c){c=[];for(var l=0;l<u;l++)c[l]=[l,0];e[i.id]=c}var h=o.morphTargets&&i.morphAttributes.position,f=o.morphNormals&&i.morphAttributes.normal;for(l=0;l<u;l++){0!==(d=c[l])[1]&&(h&&i.deleteAttribute("morphTarget"+l),f&&i.deleteAttribute("morphNormal"+l))}for(l=0;l<u;l++){(d=c[l])[0]=l,d[1]=s[l]}c.sort(Jvt);var p=0;for(l=0;l<8;l++){var d;if(d=c[l]){var m=d[0],v=d[1];if(v){h&&i.setAttribute("morphTarget"+l,h[m]),f&&i.setAttribute("morphNormal"+l,f[m]),n[l]=v,p+=v;continue}}n[l]=0}var g=i.morphTargetsRelative?1:1-p;a.getUniforms().setValue(t,"morphTargetBaseInfluence",g),a.getUniforms().setValue(t,"morphTargetInfluences",n)}}}function tgt(t,e,n,r){var i=new WeakMap;return{update:function(t){var o=r.render.frame,a=t.geometry,s=e.get(t,a);return i.get(s)!==o&&(a.isGeometry&&s.updateFromObject(t),e.update(s),i.set(s,o)),t.isInstancedMesh&&n.update(t.instanceMatrix,34962),s},dispose:function(){i=new WeakMap}}}function egt(t,e,n,r,i,o,a,s,u,c){t=void 0!==t?t:[],e=void 0!==e?e:301,a=void 0!==a?a:Cpt,Qpt.call(this,t,e,n,r,i,o,a,s,u,c),this.flipY=!1}function ngt(t,e,n,r){Qpt.call(this,null),this.image={data:t||null,width:e||1,height:n||1,depth:r||1},this.magFilter=gpt,this.minFilter=gpt,this.wrapR=mpt,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}function rgt(t,e,n,r){Qpt.call(this,null),this.image={data:t||null,width:e||1,height:n||1,depth:r||1},this.magFilter=gpt,this.minFilter=gpt,this.wrapR=mpt,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}Gvt.physical={uniforms:Evt([Gvt.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Zpt(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new Smt(0)},transparency:{value:0}}]),vertexShader:Vvt.meshphysical_vert,fragmentShader:Vvt.meshphysical_frag},egt.prototype=Object.create(Qpt.prototype),egt.prototype.constructor=egt,egt.prototype.isCubeTexture=!0,Object.defineProperty(egt.prototype,"images",{get:function(){return this.image},set:function(t){this.image=t}}),ngt.prototype=Object.create(Qpt.prototype),ngt.prototype.constructor=ngt,ngt.prototype.isDataTexture2DArray=!0,rgt.prototype=Object.create(Qpt.prototype),rgt.prototype.constructor=rgt,rgt.prototype.isDataTexture3D=!0;var igt=new Qpt,ogt=new ngt,agt=new rgt,sgt=new egt,ugt=[],cgt=[],lgt=new Float32Array(16),hgt=new Float32Array(9),fgt=new Float32Array(4);function pgt(t,e,n){var r=t[0];if(r<=0||r>0)return t;var i=e*n,o=ugt[i];if(void 0===o&&(o=new Float32Array(i),ugt[i]=o),0!==e){r.toArray(o,0);for(var a=1,s=0;a!==e;++a)s+=n,t[a].toArray(o,s)}return o}function dgt(t,e){if(t.length!==e.length)return!1;for(var n=0,r=t.length;n<r;n++)if(t[n]!==e[n])return!1;return!0}function mgt(t,e){for(var n=0,r=e.length;n<r;n++)t[n]=e[n]}function vgt(t,e){var n=cgt[e];void 0===n&&(n=new Int32Array(e),cgt[e]=n);for(var r=0;r!==e;++r)n[r]=t.allocateTextureUnit();return n}function ggt(t,e){var n=this.cache;n[0]!==e&&(t.uniform1f(this.addr,e),n[0]=e)}function ygt(t,e){var n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y||(t.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(dgt(n,e))return;t.uniform2fv(this.addr,e),mgt(n,e)}}function xgt(t,e){var n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z||(t.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(void 0!==e.r)n[0]===e.r&&n[1]===e.g&&n[2]===e.b||(t.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if(dgt(n,e))return;t.uniform3fv(this.addr,e),mgt(n,e)}}function bgt(t,e){var n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z&&n[3]===e.w||(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(dgt(n,e))return;t.uniform4fv(this.addr,e),mgt(n,e)}}function _gt(t,e){var n=this.cache,r=e.elements;if(void 0===r){if(dgt(n,e))return;t.uniformMatrix2fv(this.addr,!1,e),mgt(n,e)}else{if(dgt(n,r))return;fgt.set(r),t.uniformMatrix2fv(this.addr,!1,fgt),mgt(n,r)}}function wgt(t,e){var n=this.cache,r=e.elements;if(void 0===r){if(dgt(n,e))return;t.uniformMatrix3fv(this.addr,!1,e),mgt(n,e)}else{if(dgt(n,r))return;hgt.set(r),t.uniformMatrix3fv(this.addr,!1,hgt),mgt(n,r)}}function Sgt(t,e){var n=this.cache,r=e.elements;if(void 0===r){if(dgt(n,e))return;t.uniformMatrix4fv(this.addr,!1,e),mgt(n,e)}else{if(dgt(n,r))return;lgt.set(r),t.uniformMatrix4fv(this.addr,!1,lgt),mgt(n,r)}}function Mgt(t,e,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.safeSetTexture2D(e||igt,i)}function Egt(t,e,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.setTexture2DArray(e||ogt,i)}function Agt(t,e,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.setTexture3D(e||agt,i)}function Tgt(t,e,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.safeSetTextureCube(e||sgt,i)}function Cgt(t,e){var n=this.cache;n[0]!==e&&(t.uniform1i(this.addr,e),n[0]=e)}function Ogt(t,e){var n=this.cache;dgt(n,e)||(t.uniform2iv(this.addr,e),mgt(n,e))}function kgt(t,e){var n=this.cache;dgt(n,e)||(t.uniform3iv(this.addr,e),mgt(n,e))}function Pgt(t,e){var n=this.cache;dgt(n,e)||(t.uniform4iv(this.addr,e),mgt(n,e))}function Lgt(t,e){var n=this.cache;n[0]!==e&&(t.uniform1ui(this.addr,e),n[0]=e)}function Rgt(t,e){t.uniform1fv(this.addr,e)}function Igt(t,e){t.uniform1iv(this.addr,e)}function Ngt(t,e){t.uniform2iv(this.addr,e)}function Dgt(t,e){t.uniform3iv(this.addr,e)}function Fgt(t,e){t.uniform4iv(this.addr,e)}function jgt(t,e){var n=pgt(e,this.size,2);t.uniform2fv(this.addr,n)}function Bgt(t,e){var n=pgt(e,this.size,3);t.uniform3fv(this.addr,n)}function zgt(t,e){var n=pgt(e,this.size,4);t.uniform4fv(this.addr,n)}function Ugt(t,e){var n=pgt(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,n)}function Vgt(t,e){var n=pgt(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,n)}function Ggt(t,e){var n=pgt(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,n)}function Wgt(t,e,n){var r=e.length,i=vgt(n,r);t.uniform1iv(this.addr,i);for(var o=0;o!==r;++o)n.safeSetTexture2D(e[o]||igt,i[o])}function Hgt(t,e,n){var r=e.length,i=vgt(n,r);t.uniform1iv(this.addr,i);for(var o=0;o!==r;++o)n.safeSetTextureCube(e[o]||sgt,i[o])}function Ygt(t,e,n){this.id=t,this.addr=n,this.cache=[],this.setValue=function(t){switch(t){case 5126:return ggt;case 35664:return ygt;case 35665:return xgt;case 35666:return bgt;case 35674:return _gt;case 35675:return wgt;case 35676:return Sgt;case 5124:case 35670:return Cgt;case 35667:case 35671:return Ogt;case 35668:case 35672:return kgt;case 35669:case 35673:return Pgt;case 5125:return Lgt;case 35678:case 36198:case 36298:case 36306:case 35682:return Mgt;case 35679:case 36299:case 36307:return Agt;case 35680:case 36300:case 36308:case 36293:return Tgt;case 36289:case 36303:case 36311:case 36292:return Egt}}(e.type)}function Xgt(t,e,n){this.id=t,this.addr=n,this.cache=[],this.size=e.size,this.setValue=function(t){switch(t){case 5126:return Rgt;case 35664:return jgt;case 35665:return Bgt;case 35666:return zgt;case 35674:return Ugt;case 35675:return Vgt;case 35676:return Ggt;case 5124:case 35670:return Igt;case 35667:case 35671:return Ngt;case 35668:case 35672:return Dgt;case 35669:case 35673:return Fgt;case 35678:case 36198:case 36298:case 36306:case 35682:return Wgt;case 35680:case 36300:case 36308:case 36293:return Hgt}}(e.type)}function qgt(t){this.id=t,this.seq=[],this.map={}}Xgt.prototype.updateCache=function(t){var e=this.cache;t instanceof Float32Array&&e.length!==t.length&&(this.cache=new Float32Array(t.length)),mgt(e,t)},qgt.prototype.setValue=function(t,e,n){for(var r=this.seq,i=0,o=r.length;i!==o;++i){var a=r[i];a.setValue(t,e[a.id],n)}};var Zgt=/([\w\d_]+)(\])?(\[|\.)?/g;function $gt(t,e){t.seq.push(e),t.map[e.id]=e}function Kgt(t,e,n){var r=t.name,i=r.length;for(Zgt.lastIndex=0;;){var o=Zgt.exec(r),a=Zgt.lastIndex,s=o[1],u="]"===o[2],c=o[3];if(u&&(s|=0),void 0===c||"["===c&&a+2===i){$gt(n,void 0===c?new Ygt(s,t,e):new Xgt(s,t,e));break}var l=n.map[s];void 0===l&&$gt(n,l=new qgt(s)),n=l}}function Jgt(t,e){this.seq=[],this.map={};for(var n=t.getProgramParameter(e,35718),r=0;r<n;++r){var i=t.getActiveUniform(e,r);Kgt(i,t.getUniformLocation(e,i.name),this)}}function Qgt(t,e,n){var r=t.createShader(e);return t.shaderSource(r,n),t.compileShader(r),r}Jgt.prototype.setValue=function(t,e,n,r){var i=this.map[e];void 0!==i&&i.setValue(t,n,r)},Jgt.prototype.setOptional=function(t,e,n){var r=e[n];void 0!==r&&this.setValue(t,n,r)},Jgt.upload=function(t,e,n,r){for(var i=0,o=e.length;i!==o;++i){var a=e[i],s=n[a.id];!1!==s.needsUpdate&&a.setValue(t,s.value,r)}},Jgt.seqWithValue=function(t,e){for(var n=[],r=0,i=t.length;r!==i;++r){var o=t[r];o.id in e&&n.push(o)}return n};var tyt=0;function eyt(t){switch(t){case jpt:return["Linear","( value )"];case Bpt:return["sRGB","( value )"];case zpt:return["RGBE","( value )"];case 3004:return["RGBM","( value, 7.0 )"];case 3005:return["RGBM","( value, 16.0 )"];case 3006:return["RGBD","( value, 256.0 )"];case 3007:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case 3003:return["LogLuv","( value )"];default:throw new Error("unsupported encoding: "+t)}}function nyt(t,e,n){var r=t.getShaderParameter(e,35713),i=t.getShaderInfoLog(e).trim();return r&&""===i?"":"THREE.WebGLShader: gl.getShaderInfoLog() "+n+"\n"+i+function(t){for(var e=t.split("\n"),n=0;n<e.length;n++)e[n]=n+1+": "+e[n];return e.join("\n")}(t.getShaderSource(e))}function ryt(t,e){var n=eyt(e);return"vec4 "+t+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function iyt(t,e){var n;switch(e){case 1:n="Linear";break;case 2:n="Reinhard";break;case 3:n="Uncharted2";break;case 4:n="OptimizedCineon";break;case 5:n="ACESFilmic";break;default:throw new Error("unsupported toneMapping: "+e)}return"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function oyt(t){return""!==t}function ayt(t,e){return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function syt(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}var uyt=/^[ \t]*#include +<([\w\d./]+)>/gm;function cyt(t){return t.replace(uyt,lyt)}function lyt(t,e){var n=Vvt[e];if(void 0===n)throw new Error("Can not resolve #include <"+e+">");return cyt(n)}var hyt=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,fyt=/#pragma unroll_loop_start[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}[\s]+?#pragma unroll_loop_end/g;function pyt(t){return t.replace(fyt,myt).replace(hyt,dyt)}function dyt(t,e,n,r){return myt(t,e,n,r)}function myt(t,e,n,r){for(var i="",o=parseInt(e);o<parseInt(n);o++)i+=r.replace(/\[ i \]/g,"[ "+o+" ]").replace(/UNROLLED_LOOP_INDEX/g,o);return i}function vyt(t){var e="precision "+t.precision+" float;\nprecision "+t.precision+" int;";return"highp"===t.precision?e+="\n#define HIGH_PRECISION":"mediump"===t.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===t.precision&&(e+="\n#define LOW_PRECISION"),e}function gyt(t,e,n){var r,i,o,a,s,u=t.getContext(),c=n.defines,l=n.vertexShader,h=n.fragmentShader,f=function(t){var e="SHADOWMAP_TYPE_BASIC";return 1===t.shadowMapType?e="SHADOWMAP_TYPE_PCF":2===t.shadowMapType?e="SHADOWMAP_TYPE_PCF_SOFT":3===t.shadowMapType&&(e="SHADOWMAP_TYPE_VSM"),e}(n),p=function(t){var e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case 301:case 302:e="ENVMAP_TYPE_CUBE";break;case ppt:case 307:e="ENVMAP_TYPE_CUBE_UV";break;case 303:case 304:e="ENVMAP_TYPE_EQUIREC";break;case 305:e="ENVMAP_TYPE_SPHERE"}return e}(n),d=function(t){var e="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case 302:case 304:e="ENVMAP_MODE_REFRACTION"}return e}(n),m=function(t){var e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case 0:e="ENVMAP_BLENDING_MULTIPLY";break;case 1:e="ENVMAP_BLENDING_MIX";break;case 2:e="ENVMAP_BLENDING_ADD"}return e}(n),v=t.gammaFactor>0?t.gammaFactor:1,g=n.isWebGL2?"":function(t){return[t.extensionDerivatives||t.envMapCubeUV||t.bumpMap||t.tangentSpaceNormalMap||t.clearcoatNormalMap||t.flatShading||"physical"===t.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(t.extensionFragDepth||t.logarithmicDepthBuffer)&&t.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",t.extensionDrawBuffers&&t.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(t.extensionShaderTextureLOD||t.envMap)&&t.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(oyt).join("\n")}(n),y=function(t){var e=[];for(var n in t){var r=t[n];!1!==r&&e.push("#define "+n+" "+r)}return e.join("\n")}(c),x=u.createProgram();if(n.isRawShaderMaterial?((r=[y].filter(oyt).join("\n")).length>0&&(r+="\n"),(i=[g,y].filter(oyt).join("\n")).length>0&&(i+="\n")):(r=[vyt(n),"#define SHADER_NAME "+n.shaderName,y,n.instancing?"#define USE_INSTANCING":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+v,"#define MAX_BONES "+n.maxBones,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+d:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.useVertexTexture?"#define BONE_TEXTURE":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+f:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING"," attribute mat4 instanceMatrix;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(oyt).join("\n"),i=[g,vyt(n),"#define SHADER_NAME "+n.shaderName,y,n.alphaTest?"#define ALPHATEST "+n.alphaTest+(n.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+v,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+p:"",n.envMap?"#define "+d:"",n.envMap?"#define "+m:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.sheen?"#define USE_SHEEN":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+f:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(n.extensionShaderTextureLOD||n.envMap)&&n.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==n.toneMapping?"#define TONE_MAPPING":"",0!==n.toneMapping?Vvt.tonemapping_pars_fragment:"",0!==n.toneMapping?iyt("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.outputEncoding||n.mapEncoding||n.matcapEncoding||n.envMapEncoding||n.emissiveMapEncoding||n.lightMapEncoding?Vvt.encodings_pars_fragment:"",n.mapEncoding?ryt("mapTexelToLinear",n.mapEncoding):"",n.matcapEncoding?ryt("matcapTexelToLinear",n.matcapEncoding):"",n.envMapEncoding?ryt("envMapTexelToLinear",n.envMapEncoding):"",n.emissiveMapEncoding?ryt("emissiveMapTexelToLinear",n.emissiveMapEncoding):"",n.lightMapEncoding?ryt("lightMapTexelToLinear",n.lightMapEncoding):"",n.outputEncoding?(o="linearToOutputTexel",a=n.outputEncoding,s=eyt(a),"vec4 "+o+"( vec4 value ) { return LinearTo"+s[0]+s[1]+"; }"):"",n.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(oyt).join("\n")),l=syt(l=ayt(l=cyt(l),n),n),h=syt(h=ayt(h=cyt(h),n),n),l=pyt(l),h=pyt(h),n.isWebGL2&&!n.isRawShaderMaterial){var b=!1,_=/^\s*#version\s+300\s+es\s*\n/;n.isShaderMaterial&&null!==l.match(_)&&null!==h.match(_)&&(b=!0,l=l.replace(_,""),h=h.replace(_,"")),r=["#version 300 es\n","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+r,i=["#version 300 es\n","#define varying in",b?"":"out highp vec4 pc_fragColor;",b?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+i}var w,S,M=i+h,E=Qgt(u,35633,r+l),A=Qgt(u,35632,M);if(u.attachShader(x,E),u.attachShader(x,A),void 0!==n.index0AttributeName?u.bindAttribLocation(x,0,n.index0AttributeName):!0===n.morphTargets&&u.bindAttribLocation(x,0,"position"),u.linkProgram(x),t.debug.checkShaderErrors){var T=u.getProgramInfoLog(x).trim(),C=u.getShaderInfoLog(E).trim(),O=u.getShaderInfoLog(A).trim(),k=!0,P=!0;if(!1===u.getProgramParameter(x,35714)){k=!1;nyt(u,E,"vertex"),nyt(u,A,"fragment")}else""!==T||""!==C&&""!==O||(P=!1);P&&(this.diagnostics={runnable:k,programLog:T,vertexShader:{log:C,prefix:r},fragmentShader:{log:O,prefix:i}})}return u.detachShader(x,E),u.detachShader(x,A),u.deleteShader(E),u.deleteShader(A),this.getUniforms=function(){return void 0===w&&(w=new Jgt(u,x)),w},this.getAttributes=function(){return void 0===S&&(S=function(t,e){for(var n={},r=t.getProgramParameter(e,35721),i=0;i<r;i++){var o=t.getActiveAttrib(e,i).name;n[o]=t.getAttribLocation(e,o)}return n}(u,x)),S},this.destroy=function(){u.deleteProgram(x),this.program=void 0},this.name=n.shaderName,this.id=tyt++,this.cacheKey=e,this.usedTimes=1,this.program=x,this.vertexShader=E,this.fragmentShader=A,this}function yyt(t,e,n){var r=[],i=n.isWebGL2,o=n.logarithmicDepthBuffer,a=n.floatVertexTextures,s=n.precision,u=n.maxVertexUniforms,c=n.vertexTextures,l={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},h=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen"];function f(t){var e;return t?t.isTexture?e=t.encoding:t.isWebGLRenderTarget&&(e=t.texture.encoding):e=jpt,e}this.getParameters=function(r,h,p,d,m,v,g){var y=d.fog,x=r.isMeshStandardMaterial?d.environment:null,b=r.envMap||x,_=l[r.type],w=g.isSkinnedMesh?function(t){var e=t.skeleton.bones;if(a)return 1024;var n=u,r=Math.floor((n-20)/4),i=Math.min(r,e.length);return i<e.length?0:i}(g):0;null!==r.precision&&(s=n.getMaxPrecision(r.precision),r.precision);var S=function(t,e){var n;if(e){var r=Gvt[e];n={name:t.type,uniforms:Avt.clone(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader}}else n={name:t.type,uniforms:t.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader};return n}(r,_);r.onBeforeCompile(S,t);var M=t.getRenderTarget();return{isWebGL2:i,shaderID:_,shaderName:S.name,uniforms:S.uniforms,vertexShader:S.vertexShader,fragmentShader:S.fragmentShader,defines:r.defines,isRawShaderMaterial:r.isRawShaderMaterial,isShaderMaterial:r.isShaderMaterial,precision:s,instancing:!0===g.isInstancedMesh,supportsVertexTextures:c,outputEncoding:null!==M?f(M.texture):t.outputEncoding,map:!!r.map,mapEncoding:f(r.map),matcap:!!r.matcap,matcapEncoding:f(r.matcap),envMap:!!b,envMapMode:b&&b.mapping,envMapEncoding:f(b),envMapCubeUV:!!b&&(b.mapping===ppt||307===b.mapping),lightMap:!!r.lightMap,lightMapEncoding:f(r.lightMap),aoMap:!!r.aoMap,emissiveMap:!!r.emissiveMap,emissiveMapEncoding:f(r.emissiveMap),bumpMap:!!r.bumpMap,normalMap:!!r.normalMap,objectSpaceNormalMap:1===r.normalMapType,tangentSpaceNormalMap:0===r.normalMapType,clearcoatMap:!!r.clearcoatMap,clearcoatRoughnessMap:!!r.clearcoatRoughnessMap,clearcoatNormalMap:!!r.clearcoatNormalMap,displacementMap:!!r.displacementMap,roughnessMap:!!r.roughnessMap,metalnessMap:!!r.metalnessMap,specularMap:!!r.specularMap,alphaMap:!!r.alphaMap,gradientMap:!!r.gradientMap,sheen:!!r.sheen,combine:r.combine,vertexTangents:r.normalMap&&r.vertexTangents,vertexColors:r.vertexColors,vertexUvs:!!(r.map||r.bumpMap||r.normalMap||r.specularMap||r.alphaMap||r.emissiveMap||r.roughnessMap||r.metalnessMap||r.clearcoatMap||r.clearcoatRoughnessMap||r.clearcoatNormalMap||r.displacementMap),uvsVertexOnly:!(r.map||r.bumpMap||r.normalMap||r.specularMap||r.alphaMap||r.emissiveMap||r.roughnessMap||r.metalnessMap||r.clearcoatNormalMap||!r.displacementMap),fog:!!y,useFog:r.fog,fogExp2:y&&y.isFogExp2,flatShading:r.flatShading,sizeAttenuation:r.sizeAttenuation,logarithmicDepthBuffer:o,skinning:r.skinning&&w>0,maxBones:w,useVertexTexture:a,morphTargets:r.morphTargets,morphNormals:r.morphNormals,maxMorphTargets:t.maxMorphTargets,maxMorphNormals:t.maxMorphNormals,numDirLights:h.directional.length,numPointLights:h.point.length,numSpotLights:h.spot.length,numRectAreaLights:h.rectArea.length,numHemiLights:h.hemi.length,numDirLightShadows:h.directionalShadowMap.length,numPointLightShadows:h.pointShadowMap.length,numSpotLightShadows:h.spotShadowMap.length,numClippingPlanes:m,numClipIntersection:v,dithering:r.dithering,shadowMapEnabled:t.shadowMap.enabled&&p.length>0,shadowMapType:t.shadowMap.type,toneMapping:r.toneMapped?t.toneMapping:0,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:r.premultipliedAlpha,alphaTest:r.alphaTest,doubleSided:2===r.side,flipSided:1===r.side,depthPacking:void 0!==r.depthPacking&&r.depthPacking,index0AttributeName:r.index0AttributeName,extensionDerivatives:r.extensions&&r.extensions.derivatives,extensionFragDepth:r.extensions&&r.extensions.fragDepth,extensionDrawBuffers:r.extensions&&r.extensions.drawBuffers,extensionShaderTextureLOD:r.extensions&&r.extensions.shaderTextureLOD,rendererExtensionFragDepth:i||null!==e.get("EXT_frag_depth"),rendererExtensionDrawBuffers:i||null!==e.get("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:i||null!==e.get("EXT_shader_texture_lod"),onBeforeCompile:r.onBeforeCompile}},this.getProgramCacheKey=function(e){var n=[];if(e.shaderID?n.push(e.shaderID):(n.push(e.fragmentShader),n.push(e.vertexShader)),void 0!==e.defines)for(var r in e.defines)n.push(r),n.push(e.defines[r]);if(void 0===e.isRawShaderMaterial){for(var i=0;i<h.length;i++)n.push(e[h[i]]);n.push(t.outputEncoding),n.push(t.gammaFactor)}return n.push(e.onBeforeCompile.toString()),n.join()},this.acquireProgram=function(e,n){for(var i,o=0,a=r.length;o<a;o++){var s=r[o];if(s.cacheKey===n){++(i=s).usedTimes;break}}return void 0===i&&(i=new gyt(t,n,e),r.push(i)),i},this.releaseProgram=function(t){if(0==--t.usedTimes){var e=r.indexOf(t);r[e]=r[r.length-1],r.pop(),t.destroy()}},this.programs=r}function xyt(){var t=new WeakMap;return{get:function(e){var n=t.get(e);return void 0===n&&(n={},t.set(e,n)),n},remove:function(e){t.delete(e)},update:function(e,n,r){t.get(e)[n]=r},dispose:function(){t=new WeakMap}}}function byt(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.program!==e.program?t.program.id-e.program.id:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function _yt(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function wyt(){var t=[],e=0,n=[],r=[],i={id:-1};function o(n,r,o,a,s,u){var c=t[e];return void 0===c?(c={id:n.id,object:n,geometry:r,material:o,program:o.program||i,groupOrder:a,renderOrder:n.renderOrder,z:s,group:u},t[e]=c):(c.id=n.id,c.object=n,c.geometry=r,c.material=o,c.program=o.program||i,c.groupOrder=a,c.renderOrder=n.renderOrder,c.z=s,c.group=u),e++,c}return{opaque:n,transparent:r,init:function(){e=0,n.length=0,r.length=0},push:function(t,e,i,a,s,u){var c=o(t,e,i,a,s,u);(!0===i.transparent?r:n).push(c)},unshift:function(t,e,i,a,s,u){var c=o(t,e,i,a,s,u);(!0===i.transparent?r:n).unshift(c)},finish:function(){for(var n=e,r=t.length;n<r;n++){var i=t[n];if(null===i.id)break;i.id=null,i.object=null,i.geometry=null,i.material=null,i.program=null,i.group=null}},sort:function(t,e){n.length>1&&n.sort(t||byt),r.length>1&&r.sort(e||_yt)}}}function Syt(){var t=new WeakMap;function e(n){var r=n.target;r.removeEventListener("dispose",e),t.delete(r)}return{get:function(n,r){var i,o=t.get(n);return void 0===o?(i=new wyt,t.set(n,new WeakMap),t.get(n).set(r,i),n.addEventListener("dispose",e)):void 0===(i=o.get(r))&&(i=new wyt,o.set(r,i)),i},dispose:function(){t=new WeakMap}}}function Myt(){var t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];var n;switch(e.type){case"DirectionalLight":n={direction:new adt,color:new Smt};break;case"SpotLight":n={position:new adt,direction:new adt,color:new Smt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new adt,color:new Smt,distance:0,decay:0};break;case"HemisphereLight":n={direction:new adt,skyColor:new Smt,groundColor:new Smt};break;case"RectAreaLight":n={color:new Smt,position:new adt,halfWidth:new adt,halfHeight:new adt}}return t[e.id]=n,n}}}var Eyt=0;function Ayt(t,e){return(e.castShadow?1:0)-(t.castShadow?1:0)}function Tyt(){for(var t,e=new Myt,n=(t={},{get:function(e){if(void 0!==t[e.id])return t[e.id];var n;switch(e.type){case"DirectionalLight":case"SpotLight":n={shadowBias:0,shadowRadius:1,shadowMapSize:new Zpt};break;case"PointLight":n={shadowBias:0,shadowRadius:1,shadowMapSize:new Zpt,shadowCameraNear:1,shadowCameraFar:1e3}}return t[e.id]=n,n}}),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},i=0;i<9;i++)r.probe.push(new adt);var o=new adt,a=new ddt,s=new ddt;return{setup:function(t,i,u){for(var c=0,l=0,h=0,f=0;f<9;f++)r.probe[f].set(0,0,0);var p=0,d=0,m=0,v=0,g=0,y=0,x=0,b=0,_=u.matrixWorldInverse;t.sort(Ayt),f=0;for(var w=t.length;f<w;f++){var S=t[f],M=S.color,E=S.intensity,A=S.distance,T=S.shadow&&S.shadow.map?S.shadow.map.texture:null;if(S.isAmbientLight)c+=M.r*E,l+=M.g*E,h+=M.b*E;else if(S.isLightProbe)for(var C=0;C<9;C++)r.probe[C].addScaledVector(S.sh.coefficients[C],E);else if(S.isDirectionalLight){if((P=e.get(S)).color.copy(S.color).multiplyScalar(S.intensity),P.direction.setFromMatrixPosition(S.matrixWorld),o.setFromMatrixPosition(S.target.matrixWorld),P.direction.sub(o),P.direction.transformDirection(_),S.castShadow){var O=S.shadow;(k=n.get(S)).shadowBias=O.bias,k.shadowRadius=O.radius,k.shadowMapSize=O.mapSize,r.directionalShadow[p]=k,r.directionalShadowMap[p]=T,r.directionalShadowMatrix[p]=S.shadow.matrix,y++}r.directional[p]=P,p++}else if(S.isSpotLight){if((P=e.get(S)).position.setFromMatrixPosition(S.matrixWorld),P.position.applyMatrix4(_),P.color.copy(M).multiplyScalar(E),P.distance=A,P.direction.setFromMatrixPosition(S.matrixWorld),o.setFromMatrixPosition(S.target.matrixWorld),P.direction.sub(o),P.direction.transformDirection(_),P.coneCos=Math.cos(S.angle),P.penumbraCos=Math.cos(S.angle*(1-S.penumbra)),P.decay=S.decay,S.castShadow){O=S.shadow;(k=n.get(S)).shadowBias=O.bias,k.shadowRadius=O.radius,k.shadowMapSize=O.mapSize,r.spotShadow[m]=k,r.spotShadowMap[m]=T,r.spotShadowMatrix[m]=S.shadow.matrix,b++}r.spot[m]=P,m++}else if(S.isRectAreaLight){(P=e.get(S)).color.copy(M).multiplyScalar(E),P.position.setFromMatrixPosition(S.matrixWorld),P.position.applyMatrix4(_),s.identity(),a.copy(S.matrixWorld),a.premultiply(_),s.extractRotation(a),P.halfWidth.set(.5*S.width,0,0),P.halfHeight.set(0,.5*S.height,0),P.halfWidth.applyMatrix4(s),P.halfHeight.applyMatrix4(s),r.rectArea[v]=P,v++}else if(S.isPointLight){if((P=e.get(S)).position.setFromMatrixPosition(S.matrixWorld),P.position.applyMatrix4(_),P.color.copy(S.color).multiplyScalar(S.intensity),P.distance=S.distance,P.decay=S.decay,S.castShadow){var k;O=S.shadow;(k=n.get(S)).shadowBias=O.bias,k.shadowRadius=O.radius,k.shadowMapSize=O.mapSize,k.shadowCameraNear=O.camera.near,k.shadowCameraFar=O.camera.far,r.pointShadow[d]=k,r.pointShadowMap[d]=T,r.pointShadowMatrix[d]=S.shadow.matrix,x++}r.point[d]=P,d++}else if(S.isHemisphereLight){var P;(P=e.get(S)).direction.setFromMatrixPosition(S.matrixWorld),P.direction.transformDirection(_),P.direction.normalize(),P.skyColor.copy(S.color).multiplyScalar(E),P.groundColor.copy(S.groundColor).multiplyScalar(E),r.hemi[g]=P,g++}}r.ambient[0]=c,r.ambient[1]=l,r.ambient[2]=h;var L=r.hash;L.directionalLength===p&&L.pointLength===d&&L.spotLength===m&&L.rectAreaLength===v&&L.hemiLength===g&&L.numDirectionalShadows===y&&L.numPointShadows===x&&L.numSpotShadows===b||(r.directional.length=p,r.spot.length=m,r.rectArea.length=v,r.point.length=d,r.hemi.length=g,r.directionalShadow.length=y,r.directionalShadowMap.length=y,r.pointShadow.length=x,r.pointShadowMap.length=x,r.spotShadow.length=b,r.spotShadowMap.length=b,r.directionalShadowMatrix.length=y,r.pointShadowMatrix.length=x,r.spotShadowMatrix.length=b,L.directionalLength=p,L.pointLength=d,L.spotLength=m,L.rectAreaLength=v,L.hemiLength=g,L.numDirectionalShadows=y,L.numPointShadows=x,L.numSpotShadows=b,r.version=Eyt++)},state:r}}function Cyt(){var t=new Tyt,e=[],n=[];return{init:function(){e.length=0,n.length=0},state:{lightsArray:e,shadowsArray:n,lights:t},setupLights:function(r){t.setup(e,n,r)},pushLight:function(t){e.push(t)},pushShadow:function(t){n.push(t)}}}function Oyt(){var t=new WeakMap;function e(n){var r=n.target;r.removeEventListener("dispose",e),t.delete(r)}return{get:function(n,r){var i;return!1===t.has(n)?(i=new Cyt,t.set(n,new WeakMap),t.get(n).set(r,i),n.addEventListener("dispose",e)):!1===t.get(n).has(r)?(i=new Cyt,t.get(n).set(r,i)):i=t.get(n).get(r),i},dispose:function(){t=new WeakMap}}}function kyt(t){Omt.call(this),this.type="MeshDepthMaterial",this.depthPacking=3200,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(t)}function Pyt(t){Omt.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new adt,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(t)}kyt.prototype=Object.create(Omt.prototype),kyt.prototype.constructor=kyt,kyt.prototype.isMeshDepthMaterial=!0,kyt.prototype.copy=function(t){return Omt.prototype.copy.call(this,t),this.depthPacking=t.depthPacking,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},Pyt.prototype=Object.create(Omt.prototype),Pyt.prototype.constructor=Pyt,Pyt.prototype.isMeshDistanceMaterial=!0,Pyt.prototype.copy=function(t){return Omt.prototype.copy.call(this,t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this};function Lyt(t,e,n){var r=new Dvt,i=new Zpt,o=new Zpt,a=new tdt,s=[],u=[],c={},l={0:1,1:0,2:2},h=new Tvt({defines:{SAMPLE_RATE:2/8,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new Zpt},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n  float mean = 0.0;\n  float squared_mean = 0.0;\n\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy  ) / resolution ) );\n  for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {\n    #ifdef HORIZONAL_PASS\n      vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );\n      mean += distribution.x;\n      squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n    #else\n      float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0,  i )  * radius ) / resolution ) );\n      mean += depth;\n      squared_mean += depth * depth;\n    #endif\n  }\n  mean = mean * HALF_SAMPLE_RATE;\n  squared_mean = squared_mean * HALF_SAMPLE_RATE;\n  float std_dev = sqrt( squared_mean - mean * mean );\n  gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),f=h.clone();f.defines.HORIZONAL_PASS=1;var p=new Kmt;p.setAttribute("position",new Lmt(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));var d=new mvt(p,h),m=this;function v(n,r){var i=e.update(d);h.uniforms.shadow_pass.value=n.map.texture,h.uniforms.resolution.value=n.mapSize,h.uniforms.radius.value=n.radius,t.setRenderTarget(n.mapPass),t.clear(),t.renderBufferDirect(r,null,i,h,d,null),f.uniforms.shadow_pass.value=n.mapPass.texture,f.uniforms.resolution.value=n.mapSize,f.uniforms.radius.value=n.radius,t.setRenderTarget(n.map),t.clear(),t.renderBufferDirect(r,null,i,f,d,null)}function g(t,e,n){var r=t<<0|e<<1|n<<2,i=s[r];return void 0===i&&(i=new kyt({depthPacking:3201,morphTargets:t,skinning:e}),s[r]=i),i}function y(t,e,n){var r=t<<0|e<<1|n<<2,i=u[r];return void 0===i&&(i=new Pyt({morphTargets:t,skinning:e}),u[r]=i),i}function x(e,n,r,i,o,a){var s=e.geometry,u=null,h=g,f=e.customDepthMaterial;if(!0===r.isPointLight&&(h=y,f=e.customDistanceMaterial),void 0===f){var p=!1;!0===n.morphTargets&&(!0===s.isBufferGeometry?p=s.morphAttributes&&s.morphAttributes.position&&s.morphAttributes.position.length>0:!0===s.isGeometry&&(p=s.morphTargets&&s.morphTargets.length>0));var d=!1;!0===e.isSkinnedMesh&&!0===n.skinning&&(d=!0),u=h(p,d,!0===e.isInstancedMesh)}else u=f;if(t.localClippingEnabled&&!0===n.clipShadows&&0!==n.clippingPlanes.length){var m=u.uuid,v=n.uuid,x=c[m];void 0===x&&(x={},c[m]=x);var b=x[v];void 0===b&&(b=u.clone(),x[v]=b),u=b}return u.visible=n.visible,u.wireframe=n.wireframe,u.side=3===a?null!==n.shadowSide?n.shadowSide:n.side:null!==n.shadowSide?n.shadowSide:l[n.side],u.clipShadows=n.clipShadows,u.clippingPlanes=n.clippingPlanes,u.clipIntersection=n.clipIntersection,u.wireframeLinewidth=n.wireframeLinewidth,u.linewidth=n.linewidth,!0===r.isPointLight&&!0===u.isMeshDistanceMaterial&&(u.referencePosition.setFromMatrixPosition(r.matrixWorld),u.nearDistance=i,u.farDistance=o),u}function b(n,i,o,a,s){if(!1!==n.visible){if(n.layers.test(i.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&3===s)&&(!n.frustumCulled||r.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(o.matrixWorldInverse,n.matrixWorld);var u=e.update(n),c=n.material;if(Array.isArray(c))for(var l=u.groups,h=0,f=l.length;h<f;h++){var p=l[h],d=c[p.materialIndex];if(d&&d.visible){var m=x(n,d,a,o.near,o.far,s);t.renderBufferDirect(o,null,u,m,n,p)}}else if(c.visible){m=x(n,c,a,o.near,o.far,s);t.renderBufferDirect(o,null,u,m,n,null)}}for(var v=n.children,g=0,y=v.length;g<y;g++)b(v[g],i,o,a,s)}}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(e,s,u){if(!1!==m.enabled&&(!1!==m.autoUpdate||!1!==m.needsUpdate)&&0!==e.length){var c=t.getRenderTarget(),l=t.getActiveCubeFace(),h=t.getActiveMipmapLevel(),f=t.state;f.setBlending(0),f.buffers.color.setClear(1,1,1,1),f.buffers.depth.setTest(!0),f.setScissorTest(!1);for(var p=0,d=e.length;p<d;p++){var g=e[p],y=g.shadow;if(void 0!==y){i.copy(y.mapSize);var x=y.getFrameExtents();if(i.multiply(x),o.copy(y.mapSize),(i.x>n||i.y>n)&&(i.x>n&&(o.x=Math.floor(n/x.x),i.x=o.x*x.x,y.mapSize.x=o.x),i.y>n&&(o.y=Math.floor(n/x.y),i.y=o.y*x.y,y.mapSize.y=o.y)),null===y.map&&!y.isPointLightShadow&&3===this.type){var _={minFilter:bpt,magFilter:bpt,format:Opt};y.map=new edt(i.x,i.y,_),y.map.texture.name=g.name+".shadowMap",y.mapPass=new edt(i.x,i.y,_),y.camera.updateProjectionMatrix()}if(null===y.map){_={minFilter:gpt,magFilter:gpt,format:Opt};y.map=new edt(i.x,i.y,_),y.map.texture.name=g.name+".shadowMap",y.camera.updateProjectionMatrix()}t.setRenderTarget(y.map),t.clear();for(var w=y.getViewportCount(),S=0;S<w;S++){var M=y.getViewport(S);a.set(o.x*M.x,o.y*M.y,o.x*M.z,o.y*M.w),f.viewport(a),y.updateMatrices(g,S),r=y.getFrustum(),b(s,u,y.camera,g,this.type)}y.isPointLightShadow||3!==this.type||v(y,u)}}m.needsUpdate=!1,t.setRenderTarget(c,l,h)}}}function Ryt(t,e,n){var r=n.isWebGL2;var i=new function(){var e=!1,n=new tdt,r=null,i=new tdt(0,0,0,0);return{setMask:function(n){r===n||e||(t.colorMask(n,n,n,n),r=n)},setLocked:function(t){e=t},setClear:function(e,r,o,a,s){!0===s&&(e*=a,r*=a,o*=a),n.set(e,r,o,a),!1===i.equals(n)&&(t.clearColor(e,r,o,a),i.copy(n))},reset:function(){e=!1,r=null,i.set(-1,0,0,0)}}},o=new function(){var e=!1,n=null,r=null,i=null;return{setTest:function(t){t?j(2929):B(2929)},setMask:function(r){n===r||e||(t.depthMask(r),n=r)},setFunc:function(e){if(r!==e){if(e)switch(e){case 0:t.depthFunc(512);break;case 1:t.depthFunc(519);break;case 2:t.depthFunc(513);break;case 3:default:t.depthFunc(515);break;case 4:t.depthFunc(514);break;case 5:t.depthFunc(518);break;case 6:t.depthFunc(516);break;case 7:t.depthFunc(517)}else t.depthFunc(515);r=e}},setLocked:function(t){e=t},setClear:function(e){i!==e&&(t.clearDepth(e),i=e)},reset:function(){e=!1,n=null,r=null,i=null}}},a=new function(){var e=!1,n=null,r=null,i=null,o=null,a=null,s=null,u=null,c=null;return{setTest:function(t){e||(t?j(2960):B(2960))},setMask:function(r){n===r||e||(t.stencilMask(r),n=r)},setFunc:function(e,n,a){r===e&&i===n&&o===a||(t.stencilFunc(e,n,a),r=e,i=n,o=a)},setOp:function(e,n,r){a===e&&s===n&&u===r||(t.stencilOp(e,n,r),a=e,s=n,u=r)},setLocked:function(t){e=t},setClear:function(e){c!==e&&(t.clearStencil(e),c=e)},reset:function(){e=!1,n=null,r=null,i=null,o=null,a=null,s=null,u=null,c=null}}},s=t.getParameter(34921),u=new Uint8Array(s),c=new Uint8Array(s),l=new Uint8Array(s),h={},f=null,p=null,d=null,m=null,v=null,g=null,y=null,x=null,b=null,_=!1,w=null,S=null,M=null,E=null,A=null,T=t.getParameter(35661),C=!1,O=0,k=t.getParameter(7938);-1!==k.indexOf("WebGL")?(O=parseFloat(/^WebGL\ ([0-9])/.exec(k)[1]),C=O>=1):-1!==k.indexOf("OpenGL ES")&&(O=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(k)[1]),C=O>=2);var P=null,L={},R=new tdt,I=new tdt;function N(e,n,r){var i=new Uint8Array(4),o=t.createTexture();t.bindTexture(e,o),t.texParameteri(e,10241,9728),t.texParameteri(e,10240,9728);for(var a=0;a<r;a++)t.texImage2D(n+a,0,6408,1,1,0,6408,5121,i);return o}var D={};function F(n,i){(u[n]=1,0===c[n]&&(t.enableVertexAttribArray(n),c[n]=1),l[n]!==i)&&((r?t:e.get("ANGLE_instanced_arrays"))[r?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](n,i),l[n]=i)}function j(e){!0!==h[e]&&(t.enable(e),h[e]=!0)}function B(e){!1!==h[e]&&(t.disable(e),h[e]=!1)}D[3553]=N(3553,3553,1),D[34067]=N(34067,34069,6),i.setClear(0,0,0,1),o.setClear(1),a.setClear(0),j(2929),o.setFunc(3),W(!1),H(1),j(2884),G(0);var z={[fpt]:32774,101:32778,102:32779};if(r)z[103]=32775,z[104]=32776;else{var U=e.get("EXT_blend_minmax");null!==U&&(z[103]=U.MIN_EXT,z[104]=U.MAX_EXT)}var V={200:0,201:1,202:768,204:770,210:776,208:774,206:772,203:769,205:771,209:775,207:773};function G(e,n,r,i,o,a,s,u){if(0!==e){if(p||(j(3042),p=!0),5===e)o=o||n,a=a||r,s=s||i,n===m&&o===y||(t.blendEquationSeparate(z[n],z[o]),m=n,y=o),r===v&&i===g&&a===x&&s===b||(t.blendFuncSeparate(V[r],V[i],V[a],V[s]),v=r,g=i,x=a,b=s),d=e,_=null;else if(e!==d||u!==_){if(m===fpt&&y===fpt||(t.blendEquation(32774),m=fpt,y=fpt),u)switch(e){case 1:t.blendFuncSeparate(1,771,1,771);break;case 2:t.blendFunc(1,1);break;case 3:t.blendFuncSeparate(0,0,769,771);break;case 4:t.blendFuncSeparate(0,768,0,770)}else switch(e){case 1:t.blendFuncSeparate(770,771,1,771);break;case 2:t.blendFunc(770,1);break;case 3:t.blendFunc(0,769);break;case 4:t.blendFunc(0,768)}v=null,g=null,x=null,b=null,d=e,_=u}}else p&&(B(3042),p=!1)}function W(e){w!==e&&(e?t.frontFace(2304):t.frontFace(2305),w=e)}function H(e){0!==e?(j(2884),e!==S&&(1===e?t.cullFace(1029):2===e?t.cullFace(1028):t.cullFace(1032))):B(2884),S=e}function Y(e,n,r){e?(j(32823),E===n&&A===r||(t.polygonOffset(n,r),E=n,A=r)):B(32823)}function X(e){void 0===e&&(e=33984+T-1),P!==e&&(t.activeTexture(e),P=e)}return{buffers:{color:i,depth:o,stencil:a},initAttributes:function(){for(var t=0,e=u.length;t<e;t++)u[t]=0},enableAttribute:function(t){F(t,0)},enableAttributeAndDivisor:F,disableUnusedAttributes:function(){for(var e=0,n=c.length;e!==n;++e)c[e]!==u[e]&&(t.disableVertexAttribArray(e),c[e]=0)},enable:j,disable:B,useProgram:function(e){return f!==e&&(t.useProgram(e),f=e,!0)},setBlending:G,setMaterial:function(t,e){2===t.side?B(2884):j(2884);var n=1===t.side;e&&(n=!n),W(n),1===t.blending&&!1===t.transparent?G(0):G(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha),o.setFunc(t.depthFunc),o.setTest(t.depthTest),o.setMask(t.depthWrite),i.setMask(t.colorWrite);var r=t.stencilWrite;a.setTest(r),r&&(a.setMask(t.stencilWriteMask),a.setFunc(t.stencilFunc,t.stencilRef,t.stencilFuncMask),a.setOp(t.stencilFail,t.stencilZFail,t.stencilZPass)),Y(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits)},setFlipSided:W,setCullFace:H,setLineWidth:function(e){e!==M&&(C&&t.lineWidth(e),M=e)},setPolygonOffset:Y,setScissorTest:function(t){t?j(3089):B(3089)},activeTexture:X,bindTexture:function(e,n){null===P&&X();var r=L[P];void 0===r&&(r={type:void 0,texture:void 0},L[P]=r),r.type===e&&r.texture===n||(t.bindTexture(e,n||D[e]),r.type=e,r.texture=n)},unbindTexture:function(){var e=L[P];void 0!==e&&void 0!==e.type&&(t.bindTexture(e.type,null),e.type=void 0,e.texture=void 0)},compressedTexImage2D:function(){try{t.compressedTexImage2D.apply(t,arguments)}catch(e){}},texImage2D:function(){try{t.texImage2D.apply(t,arguments)}catch(e){}},texImage3D:function(){try{t.texImage3D.apply(t,arguments)}catch(e){}},scissor:function(e){!1===R.equals(e)&&(t.scissor(e.x,e.y,e.z,e.w),R.copy(e))},viewport:function(e){!1===I.equals(e)&&(t.viewport(e.x,e.y,e.z,e.w),I.copy(e))},reset:function(){for(var e=0;e<c.length;e++)1===c[e]&&(t.disableVertexAttribArray(e),c[e]=0);h={},P=null,L={},f=null,d=null,w=null,S=null,i.reset(),o.reset(),a.reset()}}}function Iyt(t,e,n,r,i,o,a){var s,u=i.isWebGL2,c=(i.maxTextures,i.maxCubemapSize),l=i.maxTextureSize,h=i.maxSamples,f=new WeakMap,p=!1;try{p="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(j){}function d(t,e){return p?new OffscreenCanvas(t,e):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function m(t,e,n,r){var i=1;if((t.width>r||t.height>r)&&(i=r/Math.max(t.width,t.height)),i<1||!0===e){if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap){var o=e?qpt.floorPowerOfTwo:Math.floor,a=o(i*t.width),u=o(i*t.height);void 0===s&&(s=d(a,u));var c=n?d(a,u):s;return c.width=a,c.height=u,c.getContext("2d").drawImage(t,0,0,a,u),c}return t}return t}function v(t){return qpt.isPowerOfTwo(t.width)&&qpt.isPowerOfTwo(t.height)}function g(t,e){return t.generateMipmaps&&e&&t.minFilter!==gpt&&t.minFilter!==bpt}function y(e,n,i,o){t.generateMipmap(e),r.get(n).__maxMipLevel=Math.log(Math.max(i,o))*Math.LOG2E}function x(n,r,i){if(!1===u)return r;if(null!==n&&void 0!==t[n])return t[n];var o=r;return 6403===r&&(5126===i&&(o=33326),5131===i&&(o=33325),5121===i&&(o=33321)),6407===r&&(5126===i&&(o=34837),5131===i&&(o=34843),5121===i&&(o=32849)),6408===r&&(5126===i&&(o=34836),5131===i&&(o=34842),5121===i&&(o=32856)),33325!==o&&33326!==o&&34842!==o&&34836!==o||e.get("EXT_color_buffer_float"),o}function b(t){return t===gpt||t===ypt||t===xpt?9728:9729}function _(e){var n=e.target;n.removeEventListener("dispose",_),function(e){var n=r.get(e);if(void 0===n.__webglInit)return;t.deleteTexture(n.__webglTexture),r.remove(e)}(n),n.isVideoTexture&&f.delete(n),a.memory.textures--}function w(e){var n=e.target;n.removeEventListener("dispose",w),function(e){var n=r.get(e),i=r.get(e.texture);if(!e)return;void 0!==i.__webglTexture&&t.deleteTexture(i.__webglTexture);e.depthTexture&&e.depthTexture.dispose();if(e.isWebGLCubeRenderTarget)for(var o=0;o<6;o++)t.deleteFramebuffer(n.__webglFramebuffer[o]),n.__webglDepthbuffer&&t.deleteRenderbuffer(n.__webglDepthbuffer[o]);else t.deleteFramebuffer(n.__webglFramebuffer),n.__webglDepthbuffer&&t.deleteRenderbuffer(n.__webglDepthbuffer),n.__webglMultisampledFramebuffer&&t.deleteFramebuffer(n.__webglMultisampledFramebuffer),n.__webglColorRenderbuffer&&t.deleteRenderbuffer(n.__webglColorRenderbuffer),n.__webglDepthRenderbuffer&&t.deleteRenderbuffer(n.__webglDepthRenderbuffer);r.remove(e.texture),r.remove(e)}(n),a.memory.textures--}var S=0;function M(t,e){var i=r.get(t);if(t.isVideoTexture&&function(t){var e=a.render.frame;f.get(t)!==e&&(f.set(t,e),t.update())}(t),t.version>0&&i.__version!==t.version){var o=t.image;if(void 0===o);else if(!1!==o.complete)return void P(i,t,e)}n.activeTexture(33984+e),n.bindTexture(3553,i.__webglTexture)}function E(e,i){if(6===e.image.length){var a=r.get(e);if(e.version>0&&a.__version!==e.version){k(a,e),n.activeTexture(33984+i),n.bindTexture(34067,a.__webglTexture),t.pixelStorei(37440,e.flipY);for(var s=e&&(e.isCompressedTexture||e.image[0].isCompressedTexture),l=e.image[0]&&e.image[0].isDataTexture,h=[],f=0;f<6;f++)h[f]=s||l?l?e.image[f].image:e.image[f]:m(e.image[f],!1,!0,c);var p,d=h[0],b=v(d)||u,_=o.convert(e.format),w=o.convert(e.type),S=x(e.internalFormat,_,w);if(O(34067,e,b),s){for(f=0;f<6;f++){p=h[f].mipmaps;for(var M=0;M<p.length;M++){var E=p[M];e.format!==Opt&&e.format!==Cpt?null!==_&&n.compressedTexImage2D(34069+f,M,S,E.width,E.height,0,E.data):n.texImage2D(34069+f,M,S,E.width,E.height,0,_,w,E.data)}}a.__maxMipLevel=p.length-1}else{p=e.mipmaps;for(f=0;f<6;f++)if(l){n.texImage2D(34069+f,0,S,h[f].width,h[f].height,0,_,w,h[f].data);for(M=0;M<p.length;M++){var A=(E=p[M]).image[f].image;n.texImage2D(34069+f,M+1,S,A.width,A.height,0,_,w,A.data)}}else{n.texImage2D(34069+f,0,S,_,w,h[f]);for(M=0;M<p.length;M++){E=p[M];n.texImage2D(34069+f,M+1,S,_,w,E.image[f])}}a.__maxMipLevel=p.length}g(e,b)&&y(34067,e,d.width,d.height),a.__version=e.version,e.onUpdate&&e.onUpdate(e)}else n.activeTexture(33984+i),n.bindTexture(34067,a.__webglTexture)}}function A(t,e){n.activeTexture(33984+e),n.bindTexture(34067,r.get(t).__webglTexture)}var T={[dpt]:10497,[mpt]:33071,[vpt]:33648},C={[gpt]:9728,[ypt]:9984,[xpt]:9986,[bpt]:9729,1007:9985,[_pt]:9987};function O(n,o,a){a?(t.texParameteri(n,10242,T[o.wrapS]),t.texParameteri(n,10243,T[o.wrapT]),32879!==n&&35866!==n||t.texParameteri(n,32882,T[o.wrapR]),t.texParameteri(n,10240,C[o.magFilter]),t.texParameteri(n,10241,C[o.minFilter])):(t.texParameteri(n,10242,33071),t.texParameteri(n,10243,33071),32879!==n&&35866!==n||t.texParameteri(n,32882,33071),o.wrapS!==mpt||o.wrapT,t.texParameteri(n,10240,b(o.magFilter)),t.texParameteri(n,10241,b(o.minFilter)),o.minFilter!==gpt&&o.minFilter);var s=e.get("EXT_texture_filter_anisotropic");if(s){if(o.type===Ept&&null===e.get("OES_texture_float_linear"))return;if(o.type===Apt&&null===(u||e.get("OES_texture_half_float_linear")))return;(o.anisotropy>1||r.get(o).__currentAnisotropy)&&(t.texParameterf(n,s.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(o.anisotropy,i.getMaxAnisotropy())),r.get(o).__currentAnisotropy=o.anisotropy)}}function k(e,n){void 0===e.__webglInit&&(e.__webglInit=!0,n.addEventListener("dispose",_),e.__webglTexture=t.createTexture(),a.memory.textures++)}function P(e,r,i){var a=3553;r.isDataTexture2DArray&&(a=35866),r.isDataTexture3D&&(a=32879),k(e,r),n.activeTexture(33984+i),n.bindTexture(a,e.__webglTexture),t.pixelStorei(37440,r.flipY),t.pixelStorei(37441,r.premultiplyAlpha),t.pixelStorei(3317,r.unpackAlignment);var s=function(t){return!u&&(t.wrapS!==mpt||t.wrapT!==mpt||t.minFilter!==gpt&&t.minFilter!==bpt)}(r)&&!1===v(r.image),c=m(r.image,s,!1,l),h=v(c)||u,f=o.convert(r.format),p=o.convert(r.type),d=x(r.internalFormat,f,p);O(a,r,h);var b,_=r.mipmaps;if(r.isDepthTexture)d=6402,u?d=r.type===Ept?36012:r.type===Mpt?33190:r.type===Tpt?35056:33189:r.type,r.format===kpt&&6402===d&&r.type!==Spt&&r.type!==Mpt&&(r.type=Spt,p=o.convert(r.type)),r.format===Ppt&&6402===d&&(d=34041,r.type!==Tpt&&(r.type=Tpt,p=o.convert(r.type))),n.texImage2D(3553,0,d,c.width,c.height,0,f,p,null);else if(r.isDataTexture)if(_.length>0&&h){for(var w=0,S=_.length;w<S;w++)b=_[w],n.texImage2D(3553,w,d,b.width,b.height,0,f,p,b.data);r.generateMipmaps=!1,e.__maxMipLevel=_.length-1}else n.texImage2D(3553,0,d,c.width,c.height,0,f,p,c.data),e.__maxMipLevel=0;else if(r.isCompressedTexture){for(w=0,S=_.length;w<S;w++)b=_[w],r.format!==Opt&&r.format!==Cpt?null!==f&&n.compressedTexImage2D(3553,w,d,b.width,b.height,0,b.data):n.texImage2D(3553,w,d,b.width,b.height,0,f,p,b.data);e.__maxMipLevel=_.length-1}else if(r.isDataTexture2DArray)n.texImage3D(35866,0,d,c.width,c.height,c.depth,0,f,p,c.data),e.__maxMipLevel=0;else if(r.isDataTexture3D)n.texImage3D(32879,0,d,c.width,c.height,c.depth,0,f,p,c.data),e.__maxMipLevel=0;else if(_.length>0&&h){for(w=0,S=_.length;w<S;w++)b=_[w],n.texImage2D(3553,w,d,f,p,b);r.generateMipmaps=!1,e.__maxMipLevel=_.length-1}else n.texImage2D(3553,0,d,f,p,c),e.__maxMipLevel=0;g(r,h)&&y(a,r,c.width,c.height),e.__version=r.version,r.onUpdate&&r.onUpdate(r)}function L(e,i,a,s){var u=o.convert(i.texture.format),c=o.convert(i.texture.type),l=x(i.texture.internalFormat,u,c);n.texImage2D(s,0,l,i.width,i.height,0,u,c,null),t.bindFramebuffer(36160,e),t.framebufferTexture2D(36160,a,s,r.get(i.texture).__webglTexture,0),t.bindFramebuffer(36160,null)}function R(e,n,r){if(t.bindRenderbuffer(36161,e),n.depthBuffer&&!n.stencilBuffer){var i=33189;if(r){var a=n.depthTexture;a&&a.isDepthTexture&&(a.type===Ept?i=36012:a.type===Mpt&&(i=33190));var s=N(n);t.renderbufferStorageMultisample(36161,s,i,n.width,n.height)}else t.renderbufferStorage(36161,i,n.width,n.height);t.framebufferRenderbuffer(36160,36096,36161,e)}else if(n.depthBuffer&&n.stencilBuffer){if(r){s=N(n);t.renderbufferStorageMultisample(36161,s,35056,n.width,n.height)}else t.renderbufferStorage(36161,34041,n.width,n.height);t.framebufferRenderbuffer(36160,33306,36161,e)}else{var u=o.convert(n.texture.format),c=o.convert(n.texture.type);i=x(n.texture.internalFormat,u,c);if(r){s=N(n);t.renderbufferStorageMultisample(36161,s,i,n.width,n.height)}else t.renderbufferStorage(36161,i,n.width,n.height)}t.bindRenderbuffer(36161,null)}function I(e){var n=r.get(e),i=!0===e.isWebGLCubeRenderTarget;if(e.depthTexture){if(i)throw new Error("target.depthTexture not supported in Cube render targets");!function(e,n){if(n&&n.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,e),!n.depthTexture||!n.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");r.get(n.depthTexture).__webglTexture&&n.depthTexture.image.width===n.width&&n.depthTexture.image.height===n.height||(n.depthTexture.image.width=n.width,n.depthTexture.image.height=n.height,n.depthTexture.needsUpdate=!0),M(n.depthTexture,0);var i=r.get(n.depthTexture).__webglTexture;if(n.depthTexture.format===kpt)t.framebufferTexture2D(36160,36096,3553,i,0);else{if(n.depthTexture.format!==Ppt)throw new Error("Unknown depthTexture format");t.framebufferTexture2D(36160,33306,3553,i,0)}}(n.__webglFramebuffer,e)}else if(i){n.__webglDepthbuffer=[];for(var o=0;o<6;o++)t.bindFramebuffer(36160,n.__webglFramebuffer[o]),n.__webglDepthbuffer[o]=t.createRenderbuffer(),R(n.__webglDepthbuffer[o],e,!1)}else t.bindFramebuffer(36160,n.__webglFramebuffer),n.__webglDepthbuffer=t.createRenderbuffer(),R(n.__webglDepthbuffer,e,!1);t.bindFramebuffer(36160,null)}function N(t){return u&&t.isWebGLMultisampleRenderTarget?Math.min(h,t.samples):0}var D=!1,F=!1;this.allocateTextureUnit=function(){var t=S;return S+=1,t},this.resetTextureUnits=function(){S=0},this.setTexture2D=M,this.setTexture2DArray=function(t,e){var i=r.get(t);t.version>0&&i.__version!==t.version?P(i,t,e):(n.activeTexture(33984+e),n.bindTexture(35866,i.__webglTexture))},this.setTexture3D=function(t,e){var i=r.get(t);t.version>0&&i.__version!==t.version?P(i,t,e):(n.activeTexture(33984+e),n.bindTexture(32879,i.__webglTexture))},this.setTextureCube=E,this.setTextureCubeDynamic=A,this.setupRenderTarget=function(e){var i=r.get(e),s=r.get(e.texture);e.addEventListener("dispose",w),s.__webglTexture=t.createTexture(),a.memory.textures++;var c=!0===e.isWebGLCubeRenderTarget,l=!0===e.isWebGLMultisampleRenderTarget,h=v(e)||u;if(!u||e.texture.format!==Cpt||e.texture.type!==Ept&&e.texture.type!==Apt||(e.texture.format=Opt),c){i.__webglFramebuffer=[];for(var f=0;f<6;f++)i.__webglFramebuffer[f]=t.createFramebuffer()}else if(i.__webglFramebuffer=t.createFramebuffer(),l&&u){i.__webglMultisampledFramebuffer=t.createFramebuffer(),i.__webglColorRenderbuffer=t.createRenderbuffer(),t.bindRenderbuffer(36161,i.__webglColorRenderbuffer);var p=o.convert(e.texture.format),d=o.convert(e.texture.type),m=x(e.texture.internalFormat,p,d),b=N(e);t.renderbufferStorageMultisample(36161,b,m,e.width,e.height),t.bindFramebuffer(36160,i.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(36160,36064,36161,i.__webglColorRenderbuffer),t.bindRenderbuffer(36161,null),e.depthBuffer&&(i.__webglDepthRenderbuffer=t.createRenderbuffer(),R(i.__webglDepthRenderbuffer,e,!0)),t.bindFramebuffer(36160,null)}if(c){n.bindTexture(34067,s.__webglTexture),O(34067,e.texture,h);for(f=0;f<6;f++)L(i.__webglFramebuffer[f],e,36064,34069+f);g(e.texture,h)&&y(34067,e.texture,e.width,e.height),n.bindTexture(34067,null)}else n.bindTexture(3553,s.__webglTexture),O(3553,e.texture,h),L(i.__webglFramebuffer,e,36064,3553),g(e.texture,h)&&y(3553,e.texture,e.width,e.height),n.bindTexture(3553,null);e.depthBuffer&&I(e)},this.updateRenderTargetMipmap=function(t){var e=t.texture;if(g(e,v(t)||u)){var i=t.isWebGLCubeRenderTarget?34067:3553,o=r.get(e).__webglTexture;n.bindTexture(i,o),y(i,e,t.width,t.height),n.bindTexture(i,null)}},this.updateMultisampleRenderTarget=function(e){if(e.isWebGLMultisampleRenderTarget&&u){var n=r.get(e);t.bindFramebuffer(36008,n.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,n.__webglFramebuffer);var i=e.width,o=e.height,a=16384;e.depthBuffer&&(a|=256),e.stencilBuffer&&(a|=1024),t.blitFramebuffer(0,0,i,o,0,0,i,o,a,9728),t.bindFramebuffer(36160,n.__webglMultisampledFramebuffer)}},this.safeSetTexture2D=function(t,e){t&&t.isWebGLRenderTarget&&(!1===D&&(D=!0),t=t.texture),M(t,e)},this.safeSetTextureCube=function(t,e){t&&t.isWebGLCubeRenderTarget&&(!1===F&&(F=!0),t=t.texture),t&&t.isCubeTexture||Array.isArray(t.image)&&6===t.image.length?E(t,e):A(t,e)}}function Nyt(t,e,n){var r=n.isWebGL2;return{convert:function(t){var n;if(t===wpt)return 5121;if(1017===t)return 32819;if(1018===t)return 32820;if(1019===t)return 33635;if(1010===t)return 5120;if(1011===t)return 5122;if(t===Spt)return 5123;if(1013===t)return 5124;if(t===Mpt)return 5125;if(t===Ept)return 5126;if(t===Apt)return r?5131:null!==(n=e.get("OES_texture_half_float"))?n.HALF_FLOAT_OES:null;if(1021===t)return 6406;if(t===Cpt)return 6407;if(t===Opt)return 6408;if(1024===t)return 6409;if(1025===t)return 6410;if(t===kpt)return 6402;if(t===Ppt)return 34041;if(1028===t)return 6403;if(1029===t)return 36244;if(1030===t)return 33319;if(1031===t)return 33320;if(1032===t)return 36248;if(1033===t)return 36249;if(33776===t||33777===t||33778===t||33779===t){if(null===(n=e.get("WEBGL_compressed_texture_s3tc")))return null;if(33776===t)return n.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===t)return n.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===t)return n.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===t)return n.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===t||35841===t||35842===t||35843===t){if(null===(n=e.get("WEBGL_compressed_texture_pvrtc")))return null;if(35840===t)return n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===t)return n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===t)return n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===t)return n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===t)return null!==(n=e.get("WEBGL_compressed_texture_etc1"))?n.COMPRESSED_RGB_ETC1_WEBGL:null;if((37492===t||37496===t)&&null!==(n=e.get("WEBGL_compressed_texture_etc"))){if(37492===t)return n.COMPRESSED_RGB8_ETC2;if(37496===t)return n.COMPRESSED_RGBA8_ETC2_EAC}return 37808===t||37809===t||37810===t||37811===t||37812===t||37813===t||37814===t||37815===t||37816===t||37817===t||37818===t||37819===t||37820===t||37821===t||37840===t||37841===t||37842===t||37843===t||37844===t||37845===t||37846===t||37847===t||37848===t||37849===t||37850===t||37851===t||37852===t||37853===t?null!==(n=e.get("WEBGL_compressed_texture_astc"))?t:null:36492===t?null!==(n=e.get("EXT_texture_compression_bptc"))?t:null:t===Tpt?r?34042:null!==(n=e.get("WEBGL_depth_texture"))?n.UNSIGNED_INT_24_8_WEBGL:null:void 0}}}function Dyt(t){Ovt.call(this),this.cameras=t||[]}function Fyt(){Ldt.call(this),this.type="Group"}function jyt(t,e){var n=this,r=null,i=1,o=null,a="local-floor",s=null,u=[],c=new Map,l=new Ovt;l.layers.enable(1),l.viewport=new tdt;var h=new Ovt;h.layers.enable(2),h.viewport=new tdt;var f=new Dyt([l,h]);f.layers.enable(1),f.layers.enable(2);var p=null,d=null;function m(t){var e=c.get(t.inputSource);e&&(e.targetRay&&e.targetRay.dispatchEvent({type:t.type}),e.grip&&e.grip.dispatchEvent({type:t.type}))}function v(){c.forEach((function(t,e){t.targetRay&&(t.targetRay.dispatchEvent({type:"disconnected",data:e}),t.targetRay.visible=!1),t.grip&&(t.grip.dispatchEvent({type:"disconnected",data:e}),t.grip.visible=!1)})),c.clear(),t.setFramebuffer(null),t.setRenderTarget(t.getRenderTarget()),S.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function g(t){o=t,S.setContext(r),S.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}function y(t){for(var e=r.inputSources,n=0;n<u.length;n++)c.set(e[n],u[n]);for(n=0;n<t.removed.length;n++){var i=t.removed[n];(o=c.get(i))&&(o.targetRay&&o.targetRay.dispatchEvent({type:"disconnected",data:i}),o.grip&&o.grip.dispatchEvent({type:"disconnected",data:i}),c.delete(i))}for(n=0;n<t.added.length;n++){var o;i=t.added[n];(o=c.get(i))&&(o.targetRay&&o.targetRay.dispatchEvent({type:"connected",data:i}),o.grip&&o.grip.dispatchEvent({type:"connected",data:i}))}}this.enabled=!1,this.isPresenting=!1,this.getController=function(t){var e=u[t];return void 0===e&&(e={},u[t]=e),void 0===e.targetRay&&(e.targetRay=new Fyt,e.targetRay.matrixAutoUpdate=!1,e.targetRay.visible=!1),e.targetRay},this.getControllerGrip=function(t){var e=u[t];return void 0===e&&(e={},u[t]=e),void 0===e.grip&&(e.grip=new Fyt,e.grip.matrixAutoUpdate=!1,e.grip.visible=!1),e.grip},this.setFramebufferScaleFactor=function(t){i=t,n.isPresenting},this.setReferenceSpaceType=function(t){a=t},this.getReferenceSpace=function(){return o},this.getSession=function(){return r},this.setSession=function(t){if(null!==(r=t)){r.addEventListener("select",m),r.addEventListener("selectstart",m),r.addEventListener("selectend",m),r.addEventListener("squeeze",m),r.addEventListener("squeezestart",m),r.addEventListener("squeezeend",m),r.addEventListener("end",v);var n=e.getContextAttributes(),o={antialias:n.antialias,alpha:n.alpha,depth:n.depth,stencil:n.stencil,framebufferScaleFactor:i},s=new XRWebGLLayer(r,e,o);r.updateRenderState({baseLayer:s}),r.requestReferenceSpace(a).then(g),r.addEventListener("inputsourceschange",y)}};var x=new adt,b=new adt;function _(t,e){null===e?t.matrixWorld.copy(t.matrix):t.matrixWorld.multiplyMatrices(e.matrixWorld,t.matrix),t.matrixWorldInverse.getInverse(t.matrixWorld)}this.getCamera=function(t){f.near=h.near=l.near=t.near,f.far=h.far=l.far=t.far,p===f.near&&d===f.far||(r.updateRenderState({depthNear:f.near,depthFar:f.far}),p=f.near,d=f.far);var e=t.parent,n=f.cameras;_(f,e);for(var i=0;i<n.length;i++)_(n[i],e);t.matrixWorld.copy(f.matrixWorld);for(var o=t.children,a=(i=0,o.length);i<a;i++)o[i].updateMatrixWorld(!0);return function(t,e,n){x.setFromMatrixPosition(e.matrixWorld),b.setFromMatrixPosition(n.matrixWorld);var r=x.distanceTo(b),i=e.projectionMatrix.elements,o=n.projectionMatrix.elements,a=i[14]/(i[10]-1),s=i[14]/(i[10]+1),u=(i[9]+1)/i[5],c=(i[9]-1)/i[5],l=(i[8]-1)/i[0],h=(o[8]+1)/o[0],f=a*l,p=a*h,d=r/(-l+h),m=d*-l;e.matrixWorld.decompose(t.position,t.quaternion,t.scale),t.translateX(m),t.translateZ(d),t.matrixWorld.compose(t.position,t.quaternion,t.scale),t.matrixWorldInverse.getInverse(t.matrixWorld);var v=a+d,g=s+d,y=f-m,_=p+(r-m),w=u*s/g*v,S=c*s/g*v;t.projectionMatrix.makePerspective(y,_,w,S,v,g)}(f,l,h),f};var w=null;var S=new jvt;S.setAnimationLoop((function(e,n){if(null!==(s=n.getViewerPose(o))){var i=s.views,a=r.renderState.baseLayer;t.setFramebuffer(a.framebuffer);for(var c=0;c<i.length;c++){var l=i[c],h=a.getViewport(l),p=f.cameras[c];p.matrix.fromArray(l.transform.matrix),p.projectionMatrix.fromArray(l.projectionMatrix),p.viewport.set(h.x,h.y,h.width,h.height),0===c&&f.matrix.copy(p.matrix)}}var d=r.inputSources;for(c=0;c<u.length;c++){var m=u[c],v=d[c],g=null,y=null;v&&(m.targetRay&&null!==(g=n.getPose(v.targetRaySpace,o))&&(m.targetRay.matrix.fromArray(g.transform.matrix),m.targetRay.matrix.decompose(m.targetRay.position,m.targetRay.rotation,m.targetRay.scale)),m.grip&&v.gripSpace&&null!==(y=n.getPose(v.gripSpace,o))&&(m.grip.matrix.fromArray(y.transform.matrix),m.grip.matrix.decompose(m.grip.position,m.grip.rotation,m.grip.scale))),m.targetRay&&(m.targetRay.visible=null!==g),m.grip&&(m.grip.visible=null!==y)}w&&w(e,n)})),this.setAnimationLoop=function(t){w=t},this.dispose=function(){}}function Byt(t){var e=void 0!==(t=t||{}).canvas?t.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),n=void 0!==t.context?t.context:null,r=void 0!==t.alpha&&t.alpha,i=void 0===t.depth||t.depth,o=void 0===t.stencil||t.stencil,a=void 0!==t.antialias&&t.antialias,s=void 0===t.premultipliedAlpha||t.premultipliedAlpha,u=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,c=void 0!==t.powerPreference?t.powerPreference:"default",l=void 0!==t.failIfMajorPerformanceCaveat&&t.failIfMajorPerformanceCaveat,h=null,f=null;this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=jpt,this.physicallyCorrectLights=!1,this.toneMapping=1,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var p,d,m,v,g,y,x,b,_,w,S,M,E,A,T,C,O,k,P=this,L=!1,R=null,I=0,N=0,D=null,F=null,j=-1,B={geometry:null,program:null,wireframe:!1},z=null,U=null,V=new tdt,G=new tdt,W=null,H=e.width,Y=e.height,X=1,q=null,Z=null,$=new tdt(0,0,H,Y),K=new tdt(0,0,H,Y),J=!1,Q=new Dvt,tt=new Xvt,et=!1,nt=!1,rt=new ddt,it=new adt;function ot(){return null===D?X:1}try{var at={alpha:r,depth:i,stencil:o,antialias:a,premultipliedAlpha:s,preserveDrawingBuffer:u,powerPreference:c,failIfMajorPerformanceCaveat:l,xrCompatible:!0};if(e.addEventListener("webglcontextlost",lt,!1),e.addEventListener("webglcontextrestored",ht,!1),null===(p=n||e.getContext("webgl",at)||e.getContext("experimental-webgl",at)))throw null!==e.getContext("webgl")?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.");void 0===p.getShaderPrecisionFormat&&(p.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Mt){throw Mt}function st(){d=new qvt(p),!1===(m=new Yvt(p,d,t)).isWebGL2&&(d.get("WEBGL_depth_texture"),d.get("OES_texture_float"),d.get("OES_texture_half_float"),d.get("OES_texture_half_float_linear"),d.get("OES_standard_derivatives"),d.get("OES_element_index_uint"),d.get("ANGLE_instanced_arrays")),d.get("OES_texture_float_linear"),k=new Nyt(p,d,m),(v=new Ryt(p,d,m)).scissor(G.copy(K).multiplyScalar(X).floor()),v.viewport(V.copy($).multiplyScalar(X).floor()),g=new Kvt,y=new xyt,x=new Iyt(p,d,v,y,m,k,g),b=new Bvt(p,m),_=new Zvt(p,b,g),w=new tgt(p,_,b,g),T=new Qvt(p),S=new yyt(P,d,m),M=new Syt,E=new Oyt,A=new Wvt(P,v,w,s),C=new Hvt(p,d,g,m),O=new $vt(p,d,g,m),g.programs=S.programs,P.capabilities=m,P.extensions=d,P.properties=y,P.renderLists=M,P.state=v,P.info=g}st();var ut=new jyt(P,p);this.xr=ut;var ct=new Lyt(P,w,m.maxTextureSize);function lt(t){t.preventDefault(),L=!0}function ht(){L=!1,st()}function ft(t){var e=t.target;e.removeEventListener("dispose",ft),function(t){pt(t),y.remove(t)}(e)}function pt(t){var e=y.get(t).program;t.program=void 0,void 0!==e&&S.releaseProgram(e)}this.shadowMap=ct,this.getContext=function(){return p},this.getContextAttributes=function(){return p.getContextAttributes()},this.forceContextLoss=function(){var t=d.get("WEBGL_lose_context");t&&t.loseContext()},this.forceContextRestore=function(){var t=d.get("WEBGL_lose_context");t&&t.restoreContext()},this.getPixelRatio=function(){return X},this.setPixelRatio=function(t){void 0!==t&&(X=t,this.setSize(H,Y,!1))},this.getSize=function(t){return void 0===t&&(t=new Zpt),t.set(H,Y)},this.setSize=function(t,n,r){ut.isPresenting||(H=t,Y=n,e.width=Math.floor(t*X),e.height=Math.floor(n*X),!1!==r&&(e.style.width=t+"px",e.style.height=n+"px"),this.setViewport(0,0,t,n))},this.getDrawingBufferSize=function(t){return void 0===t&&(t=new Zpt),t.set(H*X,Y*X).floor()},this.setDrawingBufferSize=function(t,n,r){H=t,Y=n,X=r,e.width=Math.floor(t*r),e.height=Math.floor(n*r),this.setViewport(0,0,t,n)},this.getCurrentViewport=function(t){return void 0===t&&(t=new tdt),t.copy(V)},this.getViewport=function(t){return t.copy($)},this.setViewport=function(t,e,n,r){t.isVector4?$.set(t.x,t.y,t.z,t.w):$.set(t,e,n,r),v.viewport(V.copy($).multiplyScalar(X).floor())},this.getScissor=function(t){return t.copy(K)},this.setScissor=function(t,e,n,r){t.isVector4?K.set(t.x,t.y,t.z,t.w):K.set(t,e,n,r),v.scissor(G.copy(K).multiplyScalar(X).floor())},this.getScissorTest=function(){return J},this.setScissorTest=function(t){v.setScissorTest(J=t)},this.setOpaqueSort=function(t){q=t},this.setTransparentSort=function(t){Z=t},this.getClearColor=function(){return A.getClearColor()},this.setClearColor=function(){A.setClearColor.apply(A,arguments)},this.getClearAlpha=function(){return A.getClearAlpha()},this.setClearAlpha=function(){A.setClearAlpha.apply(A,arguments)},this.clear=function(t,e,n){var r=0;(void 0===t||t)&&(r|=16384),(void 0===e||e)&&(r|=256),(void 0===n||n)&&(r|=1024),p.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",lt,!1),e.removeEventListener("webglcontextrestored",ht,!1),M.dispose(),E.dispose(),y.dispose(),w.dispose(),ut.dispose(),vt.stop(),this.forceContextLoss()},this.renderBufferImmediate=function(t,e){v.initAttributes();var n=y.get(t);t.hasPositions&&!n.position&&(n.position=p.createBuffer()),t.hasNormals&&!n.normal&&(n.normal=p.createBuffer()),t.hasUvs&&!n.uv&&(n.uv=p.createBuffer()),t.hasColors&&!n.color&&(n.color=p.createBuffer());var r=e.getAttributes();t.hasPositions&&(p.bindBuffer(34962,n.position),p.bufferData(34962,t.positionArray,35048),v.enableAttribute(r.position),p.vertexAttribPointer(r.position,3,5126,!1,0,0)),t.hasNormals&&(p.bindBuffer(34962,n.normal),p.bufferData(34962,t.normalArray,35048),v.enableAttribute(r.normal),p.vertexAttribPointer(r.normal,3,5126,!1,0,0)),t.hasUvs&&(p.bindBuffer(34962,n.uv),p.bufferData(34962,t.uvArray,35048),v.enableAttribute(r.uv),p.vertexAttribPointer(r.uv,2,5126,!1,0,0)),t.hasColors&&(p.bindBuffer(34962,n.color),p.bufferData(34962,t.colorArray,35048),v.enableAttribute(r.color),p.vertexAttribPointer(r.color,3,5126,!1,0,0)),v.disableUnusedAttributes(),p.drawArrays(4,0,t.count),t.count=0};var dt=new Rdt;this.renderBufferDirect=function(t,e,n,r,i,o){null===e&&(e=dt);var a=i.isMesh&&i.matrixWorld.determinant()<0,s=_t(t,e,r,i);v.setMaterial(r,a);var u=!1;B.geometry===n.id&&B.program===s.id&&B.wireframe===(!0===r.wireframe)||(B.geometry=n.id,B.program=s.id,B.wireframe=!0===r.wireframe,u=!0),(r.morphTargets||r.morphNormals)&&(T.update(i,n,r,s),u=!0);var c=n.index,l=n.attributes.position;if(null===c){if(void 0===l||0===l.count)return}else if(0===c.count)return;var h,f=1;!0===r.wireframe&&(c=_.getWireframeAttribute(n),f=2);var g=C;null!==c&&(h=b.get(c),(g=O).setIndex(h)),u&&(!function(t,e,n,r){if(!1===m.isWebGL2&&(t.isInstancedMesh||e.isInstancedBufferGeometry)&&null===d.get("ANGLE_instanced_arrays"))return;v.initAttributes();var i=e.attributes,o=r.getAttributes(),a=n.defaultAttributeValues;for(var s in o){var u=o[s];if(u>=0){var c=i[s];if(void 0!==c){var l=c.normalized,h=c.itemSize;if(void 0===(S=b.get(c)))continue;var f=S.buffer,g=S.type,y=S.bytesPerElement;if(c.isInterleavedBufferAttribute){var x=c.data,_=x.stride,w=c.offset;x&&x.isInstancedInterleavedBuffer?(v.enableAttributeAndDivisor(u,x.meshPerAttribute),void 0===e.maxInstancedCount&&(e.maxInstancedCount=x.meshPerAttribute*x.count)):v.enableAttribute(u),p.bindBuffer(34962,f),p.vertexAttribPointer(u,h,g,l,_*y,w*y)}else c.isInstancedBufferAttribute?(v.enableAttributeAndDivisor(u,c.meshPerAttribute),void 0===e.maxInstancedCount&&(e.maxInstancedCount=c.meshPerAttribute*c.count)):v.enableAttribute(u),p.bindBuffer(34962,f),p.vertexAttribPointer(u,h,g,l,0,0)}else if("instanceMatrix"===s){var S;if(void 0===(S=b.get(t.instanceMatrix)))continue;f=S.buffer,g=S.type;v.enableAttributeAndDivisor(u+0,1),v.enableAttributeAndDivisor(u+1,1),v.enableAttributeAndDivisor(u+2,1),v.enableAttributeAndDivisor(u+3,1),p.bindBuffer(34962,f),p.vertexAttribPointer(u+0,4,g,!1,64,0),p.vertexAttribPointer(u+1,4,g,!1,64,16),p.vertexAttribPointer(u+2,4,g,!1,64,32),p.vertexAttribPointer(u+3,4,g,!1,64,48)}else if(void 0!==a){var M=a[s];if(void 0!==M)switch(M.length){case 2:p.vertexAttrib2fv(u,M);break;case 3:p.vertexAttrib3fv(u,M);break;case 4:p.vertexAttrib4fv(u,M);break;default:p.vertexAttrib1fv(u,M)}}}}v.disableUnusedAttributes()}(i,n,r,s),null!==c&&p.bindBuffer(34963,h.buffer));var y=null!==c?c.count:l.count,x=n.drawRange.start*f,w=n.drawRange.count*f,S=null!==o?o.start*f:0,M=null!==o?o.count*f:1/0,E=Math.max(x,S),A=Math.min(y,x+w,S+M)-1,k=Math.max(0,A-E+1);if(0!==k){if(i.isMesh)!0===r.wireframe?(v.setLineWidth(r.wireframeLinewidth*ot()),g.setMode(1)):g.setMode(4);else if(i.isLine){var P=r.linewidth;void 0===P&&(P=1),v.setLineWidth(P*ot()),i.isLineSegments?g.setMode(1):i.isLineLoop?g.setMode(2):g.setMode(3)}else i.isPoints?g.setMode(0):i.isSprite&&g.setMode(4);i.isInstancedMesh?g.renderInstances(n,E,k,i.count):n.isInstancedBufferGeometry?g.renderInstances(n,E,k,n.maxInstancedCount):g.render(E,k)}},this.compile=function(t,e){(f=E.get(t,e)).init(),t.traverse((function(t){t.isLight&&(f.pushLight(t),t.castShadow&&f.pushShadow(t))})),f.setupLights(e);var n={};t.traverse((function(e){if(e.material)if(Array.isArray(e.material))for(var r=0;r<e.material.length;r++)e.material[r].uuid in n==!1&&(bt(e.material[r],t,e),n[e.material[r].uuid]=!0);else e.material.uuid in n==!1&&(bt(e.material,t,e),n[e.material.uuid]=!0)}))};var mt=null;var vt=new jvt;function gt(t,e,n,r){if(!1!==t.visible){if(t.layers.test(e.layers))if(t.isGroup)n=t.renderOrder;else if(t.isLOD)!0===t.autoUpdate&&t.update(e);else if(t.isLight)f.pushLight(t),t.castShadow&&f.pushShadow(t);else if(t.isSprite){if(!t.frustumCulled||Q.intersectsSprite(t)){r&&it.setFromMatrixPosition(t.matrixWorld).applyMatrix4(rt);var i=w.update(t);(o=t.material).visible&&h.push(t,i,o,n,it.z,null)}}else if(t.isImmediateRenderObject)r&&it.setFromMatrixPosition(t.matrixWorld).applyMatrix4(rt),h.push(t,null,t.material,n,it.z,null);else if((t.isMesh||t.isLine||t.isPoints)&&(t.isSkinnedMesh&&t.skeleton.frame!==g.render.frame&&(t.skeleton.update(),t.skeleton.frame=g.render.frame),!t.frustumCulled||Q.intersectsObject(t))){r&&it.setFromMatrixPosition(t.matrixWorld).applyMatrix4(rt);i=w.update(t);var o=t.material;if(Array.isArray(o))for(var a=i.groups,s=0,u=a.length;s<u;s++){var c=a[s],l=o[c.materialIndex];l&&l.visible&&h.push(t,i,l,n,it.z,c)}else o.visible&&h.push(t,i,o,n,it.z,null)}var p=t.children;for(s=0,u=p.length;s<u;s++)gt(p[s],e,n,r)}}function yt(t,e,n,r){for(var i=0,o=t.length;i<o;i++){var a=t[i],s=a.object,u=a.geometry,c=void 0===r?a.material:r,l=a.group;if(n.isArrayCamera){U=n;for(var h=n.cameras,p=0,d=h.length;p<d;p++){var m=h[p];s.layers.test(m.layers)&&(v.viewport(V.copy(m.viewport)),f.setupLights(m),xt(s,e,m,u,c,l))}}else U=null,xt(s,e,n,u,c,l)}}function xt(t,e,n,r,i,o){if(t.onBeforeRender(P,e,n,r,i,o),f=E.get(e,U||n),t.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix),t.isImmediateRenderObject){var a=_t(n,e,i,t);v.setMaterial(i),B.geometry=null,B.program=null,B.wireframe=!1,function(t,e){t.render((function(t){P.renderBufferImmediate(t,e)}))}(t,a)}else P.renderBufferDirect(n,e,r,i,t,o);t.onAfterRender(P,e,n,r,i,o),f=E.get(e,U||n)}function bt(t,e,n){var r=y.get(t),i=f.state.lights,o=f.state.shadowsArray,a=i.state.version,s=S.getParameters(t,i.state,o,e,tt.numPlanes,tt.numIntersection,n),u=S.getProgramCacheKey(s),c=r.program,l=!0;if(void 0===c)t.addEventListener("dispose",ft);else if(c.cacheKey!==u)pt(t);else if(r.lightsStateVersion!==a)r.lightsStateVersion=a,l=!1;else{if(void 0!==s.shaderID)return;l=!1}l&&(c=S.acquireProgram(s,u),r.program=c,r.uniforms=s.uniforms,r.environment=t.isMeshStandardMaterial?e.environment:null,r.outputEncoding=P.outputEncoding,t.program=c);var h=c.getAttributes();if(t.morphTargets){t.numSupportedMorphTargets=0;for(var p=0;p<P.maxMorphTargets;p++)h["morphTarget"+p]>=0&&t.numSupportedMorphTargets++}if(t.morphNormals){t.numSupportedMorphNormals=0;for(p=0;p<P.maxMorphNormals;p++)h["morphNormal"+p]>=0&&t.numSupportedMorphNormals++}var d=r.uniforms;(t.isShaderMaterial||t.isRawShaderMaterial)&&!0!==t.clipping||(r.numClippingPlanes=tt.numPlanes,r.numIntersection=tt.numIntersection,d.clippingPlanes=tt.uniform),r.fog=e.fog,r.needsLights=function(t){return t.isMeshLambertMaterial||t.isMeshToonMaterial||t.isMeshPhongMaterial||t.isMeshStandardMaterial||t.isShadowMaterial||t.isShaderMaterial&&!0===t.lights}(t),r.lightsStateVersion=a,r.needsLights&&(d.ambientLightColor.value=i.state.ambient,d.lightProbe.value=i.state.probe,d.directionalLights.value=i.state.directional,d.directionalLightShadows.value=i.state.directionalShadow,d.spotLights.value=i.state.spot,d.spotLightShadows.value=i.state.spotShadow,d.rectAreaLights.value=i.state.rectArea,d.pointLights.value=i.state.point,d.pointLightShadows.value=i.state.pointShadow,d.hemisphereLights.value=i.state.hemi,d.directionalShadowMap.value=i.state.directionalShadowMap,d.directionalShadowMatrix.value=i.state.directionalShadowMatrix,d.spotShadowMap.value=i.state.spotShadowMap,d.spotShadowMatrix.value=i.state.spotShadowMatrix,d.pointShadowMap.value=i.state.pointShadowMap,d.pointShadowMatrix.value=i.state.pointShadowMatrix);var m=r.program.getUniforms(),v=Jgt.seqWithValue(m.seq,d);r.uniformsList=v}function _t(t,e,n,r){x.resetTextureUnits();var i=e.fog,o=n.isMeshStandardMaterial?e.environment:null,a=y.get(n),s=f.state.lights;if(et&&(nt||t!==z)){var u=t===z&&n.id===j;tt.setState(n.clippingPlanes,n.clipIntersection,n.clipShadows,t,a,u)}n.version===a.__version?void 0===a.program||n.fog&&a.fog!==i||a.environment!==o||a.needsLights&&a.lightsStateVersion!==s.state.version?bt(n,e,r):void 0===a.numClippingPlanes||a.numClippingPlanes===tt.numPlanes&&a.numIntersection===tt.numIntersection?a.outputEncoding!==P.outputEncoding&&bt(n,e,r):bt(n,e,r):(bt(n,e,r),a.__version=n.version);var c,l,h=!1,d=!1,g=!1,b=a.program,_=b.getUniforms(),w=a.uniforms;if(v.useProgram(b.program)&&(h=!0,d=!0,g=!0),n.id!==j&&(j=n.id,d=!0),h||z!==t){if(_.setValue(p,"projectionMatrix",t.projectionMatrix),m.logarithmicDepthBuffer&&_.setValue(p,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),z!==t&&(z=t,d=!0,g=!0),n.isShaderMaterial||n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshStandardMaterial||n.envMap){var S=_.map.cameraPosition;void 0!==S&&S.setValue(p,it.setFromMatrixPosition(t.matrixWorld))}(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial)&&_.setValue(p,"isOrthographic",!0===t.isOrthographicCamera),(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial||n.skinning)&&_.setValue(p,"viewMatrix",t.matrixWorldInverse)}if(n.skinning){_.setOptional(p,r,"bindMatrix"),_.setOptional(p,r,"bindMatrixInverse");var M=r.skeleton;if(M){var E=M.bones;if(m.floatVertexTextures){if(void 0===M.boneTexture){var A=Math.sqrt(4*E.length);A=qpt.ceilPowerOfTwo(A),A=Math.max(A,4);var T=new Float32Array(A*A*4);T.set(M.boneMatrices);var C=new Rvt(T,A,A,Opt,Ept);M.boneMatrices=T,M.boneTexture=C,M.boneTextureSize=A}_.setValue(p,"boneTexture",M.boneTexture,x),_.setValue(p,"boneTextureSize",M.boneTextureSize)}else _.setOptional(p,M,"boneMatrices")}}return(d||a.receiveShadow!==r.receiveShadow)&&(a.receiveShadow=r.receiveShadow,_.setValue(p,"receiveShadow",r.receiveShadow)),d&&(_.setValue(p,"toneMappingExposure",P.toneMappingExposure),_.setValue(p,"toneMappingWhitePoint",P.toneMappingWhitePoint),a.needsLights&&(l=g,(c=w).ambientLightColor.needsUpdate=l,c.lightProbe.needsUpdate=l,c.directionalLights.needsUpdate=l,c.directionalLightShadows.needsUpdate=l,c.pointLights.needsUpdate=l,c.pointLightShadows.needsUpdate=l,c.spotLights.needsUpdate=l,c.spotLightShadows.needsUpdate=l,c.rectAreaLights.needsUpdate=l,c.hemisphereLights.needsUpdate=l),i&&n.fog&&function(t,e){t.fogColor.value.copy(e.color),e.isFog?(t.fogNear.value=e.near,t.fogFar.value=e.far):e.isFogExp2&&(t.fogDensity.value=e.density)}(w,i),n.isMeshBasicMaterial?wt(w,n):n.isMeshLambertMaterial?(wt(w,n),function(t,e){e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap)}(w,n)):n.isMeshToonMaterial?(wt(w,n),function(t,e){t.specular.value.copy(e.specular),t.shininess.value=Math.max(e.shininess,1e-4),e.gradientMap&&(t.gradientMap.value=e.gradientMap);e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap);e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,1===e.side&&(t.bumpScale.value*=-1));e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),1===e.side&&t.normalScale.value.negate());e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(w,n)):n.isMeshPhongMaterial?(wt(w,n),function(t,e){t.specular.value.copy(e.specular),t.shininess.value=Math.max(e.shininess,1e-4),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap);e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,1===e.side&&(t.bumpScale.value*=-1));e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),1===e.side&&t.normalScale.value.negate());e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(w,n)):n.isMeshStandardMaterial?(wt(w,n,o),n.isMeshPhysicalMaterial?function(t,e,n){St(t,e,n),t.reflectivity.value=e.reflectivity,t.clearcoat.value=e.clearcoat,t.clearcoatRoughness.value=e.clearcoatRoughness,e.sheen&&t.sheen.value.copy(e.sheen);e.clearcoatMap&&(t.clearcoatMap.value=e.clearcoatMap);e.clearcoatRoughnessMap&&(t.clearcoatRoughnessMap.value=e.clearcoatRoughnessMap);e.clearcoatNormalMap&&(t.clearcoatNormalScale.value.copy(e.clearcoatNormalScale),t.clearcoatNormalMap.value=e.clearcoatNormalMap,1===e.side&&t.clearcoatNormalScale.value.negate());t.transparency.value=e.transparency}(w,n,o):St(w,n,o)):n.isMeshMatcapMaterial?(wt(w,n),function(t,e){e.matcap&&(t.matcap.value=e.matcap);e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,1===e.side&&(t.bumpScale.value*=-1));e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),1===e.side&&t.normalScale.value.negate());e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(w,n)):n.isMeshDepthMaterial?(wt(w,n),function(t,e){e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(w,n)):n.isMeshDistanceMaterial?(wt(w,n),function(t,e){e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias);t.referencePosition.value.copy(e.referencePosition),t.nearDistance.value=e.nearDistance,t.farDistance.value=e.farDistance}(w,n)):n.isMeshNormalMaterial?(wt(w,n),function(t,e){e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,1===e.side&&(t.bumpScale.value*=-1));e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),1===e.side&&t.normalScale.value.negate());e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(w,n)):n.isLineBasicMaterial?(function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity}(w,n),n.isLineDashedMaterial&&function(t,e){t.dashSize.value=e.dashSize,t.totalSize.value=e.dashSize+e.gapSize,t.scale.value=e.scale}(w,n)):n.isPointsMaterial?function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.size.value=e.size*X,t.scale.value=.5*Y,e.map&&(t.map.value=e.map);e.alphaMap&&(t.alphaMap.value=e.alphaMap);var n;e.map?n=e.map:e.alphaMap&&(n=e.alphaMap);void 0!==n&&(!0===n.matrixAutoUpdate&&n.updateMatrix(),t.uvTransform.value.copy(n.matrix))}(w,n):n.isSpriteMaterial?function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.rotation.value=e.rotation,e.map&&(t.map.value=e.map);e.alphaMap&&(t.alphaMap.value=e.alphaMap);var n;e.map?n=e.map:e.alphaMap&&(n=e.alphaMap);void 0!==n&&(!0===n.matrixAutoUpdate&&n.updateMatrix(),t.uvTransform.value.copy(n.matrix))}(w,n):n.isShadowMaterial&&(w.color.value.copy(n.color),w.opacity.value=n.opacity),void 0!==w.ltc_1&&(w.ltc_1.value=Fvt.LTC_1),void 0!==w.ltc_2&&(w.ltc_2.value=Fvt.LTC_2),Jgt.upload(p,a.uniformsList,w,x),n.isShaderMaterial&&(n.uniformsNeedUpdate=!1)),n.isShaderMaterial&&!0===n.uniformsNeedUpdate&&(Jgt.upload(p,a.uniformsList,w,x),n.uniformsNeedUpdate=!1),n.isSpriteMaterial&&_.setValue(p,"center",r.center),_.setValue(p,"modelViewMatrix",r.modelViewMatrix),_.setValue(p,"normalMatrix",r.normalMatrix),_.setValue(p,"modelMatrix",r.matrixWorld),b}function wt(t,e,n){t.opacity.value=e.opacity,e.color&&t.diffuse.value.copy(e.color),e.emissive&&t.emissive.value.copy(e.emissive).multiplyScalar(e.emissiveIntensity),e.map&&(t.map.value=e.map),e.alphaMap&&(t.alphaMap.value=e.alphaMap),e.specularMap&&(t.specularMap.value=e.specularMap);var r,i,o=e.envMap||n;o&&(t.envMap.value=o,t.flipEnvMap.value=o.isCubeTexture?-1:1,t.reflectivity.value=e.reflectivity,t.refractionRatio.value=e.refractionRatio,t.maxMipLevel.value=y.get(o).__maxMipLevel),e.lightMap&&(t.lightMap.value=e.lightMap,t.lightMapIntensity.value=e.lightMapIntensity),e.aoMap&&(t.aoMap.value=e.aoMap,t.aoMapIntensity.value=e.aoMapIntensity),e.map?r=e.map:e.specularMap?r=e.specularMap:e.displacementMap?r=e.displacementMap:e.normalMap?r=e.normalMap:e.bumpMap?r=e.bumpMap:e.roughnessMap?r=e.roughnessMap:e.metalnessMap?r=e.metalnessMap:e.alphaMap?r=e.alphaMap:e.emissiveMap&&(r=e.emissiveMap),void 0!==r&&(r.isWebGLRenderTarget&&(r=r.texture),!0===r.matrixAutoUpdate&&r.updateMatrix(),t.uvTransform.value.copy(r.matrix)),e.aoMap?i=e.aoMap:e.lightMap&&(i=e.lightMap),void 0!==i&&(i.isWebGLRenderTarget&&(i=i.texture),!0===i.matrixAutoUpdate&&i.updateMatrix(),t.uv2Transform.value.copy(i.matrix))}function St(t,e,n){t.roughness.value=e.roughness,t.metalness.value=e.metalness,e.roughnessMap&&(t.roughnessMap.value=e.roughnessMap),e.metalnessMap&&(t.metalnessMap.value=e.metalnessMap),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,1===e.side&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),1===e.side&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias),(e.envMap||n)&&(t.envMapIntensity.value=e.envMapIntensity)}vt.setAnimationLoop((function(t){ut.isPresenting||mt&&mt(t)})),"undefined"!=typeof window&&vt.setContext(window),this.setAnimationLoop=function(t){mt=t,ut.setAnimationLoop(t),vt.start()},this.render=function(t,e){var n,r;if(void 0!==arguments[2]&&(n=arguments[2]),void 0!==arguments[3]&&(r=arguments[3]),e&&e.isCamera&&!L){B.geometry=null,B.program=null,B.wireframe=!1,j=-1,z=null,!0===t.autoUpdate&&t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),ut.enabled&&ut.isPresenting&&(e=ut.getCamera(e)),(f=E.get(t,e)).init(),t.onBeforeRender(P,t,e,n||D),rt.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),Q.setFromProjectionMatrix(rt),nt=this.localClippingEnabled,et=tt.init(this.clippingPlanes,nt,e),(h=M.get(t,e)).init(),gt(t,e,0,P.sortObjects),h.finish(),!0===P.sortObjects&&h.sort(q,Z),et&&tt.beginShadows();var i=f.state.shadowsArray;ct.render(i,t,e),f.setupLights(e),et&&tt.endShadows(),this.info.autoReset&&this.info.reset(),void 0!==n&&this.setRenderTarget(n),A.render(h,t,e,r);var o=h.opaque,a=h.transparent;if(t.overrideMaterial){var s=t.overrideMaterial;o.length&&yt(o,t,e,s),a.length&&yt(a,t,e,s)}else o.length&&yt(o,t,e),a.length&&yt(a,t,e);t.onAfterRender(P,t,e),null!==D&&(x.updateRenderTargetMipmap(D),x.updateMultisampleRenderTarget(D)),v.buffers.depth.setTest(!0),v.buffers.depth.setMask(!0),v.buffers.color.setMask(!0),v.setPolygonOffset(!1),h=null,f=null}},this.setFramebuffer=function(t){R!==t&&null===D&&p.bindFramebuffer(36160,t),R=t},this.getActiveCubeFace=function(){return I},this.getActiveMipmapLevel=function(){return N},this.getRenderTarget=function(){return D},this.setRenderTarget=function(t,e,n){D=t,I=e,N=n,t&&void 0===y.get(t).__webglFramebuffer&&x.setupRenderTarget(t);var r=R,i=!1;if(t){var o=y.get(t).__webglFramebuffer;t.isWebGLCubeRenderTarget?(r=o[e||0],i=!0):r=t.isWebGLMultisampleRenderTarget?y.get(t).__webglMultisampledFramebuffer:o,V.copy(t.viewport),G.copy(t.scissor),W=t.scissorTest}else V.copy($).multiplyScalar(X).floor(),G.copy(K).multiplyScalar(X).floor(),W=J;if(F!==r&&(p.bindFramebuffer(36160,r),F=r),v.viewport(V),v.scissor(G),v.setScissorTest(W),i){var a=y.get(t.texture);p.framebufferTexture2D(36160,36064,34069+(e||0),a.__webglTexture,n||0)}},this.readRenderTargetPixels=function(t,e,n,r,i,o,a){if(t&&t.isWebGLRenderTarget){var s=y.get(t).__webglFramebuffer;if(t.isWebGLCubeRenderTarget&&void 0!==a&&(s=s[a]),s){var u=!1;s!==F&&(p.bindFramebuffer(36160,s),u=!0);try{var c=t.texture,l=c.format,h=c.type;if(l!==Opt&&k.convert(l)!==p.getParameter(35739))return;if(!(h===wpt||k.convert(h)===p.getParameter(35738)||h===Ept&&(m.isWebGL2||d.get("OES_texture_float")||d.get("WEBGL_color_buffer_float"))||h===Apt&&(m.isWebGL2?d.get("EXT_color_buffer_float"):d.get("EXT_color_buffer_half_float"))))return;36053===p.checkFramebufferStatus(36160)&&e>=0&&e<=t.width-r&&n>=0&&n<=t.height-i&&p.readPixels(e,n,r,i,k.convert(l),k.convert(h),o)}finally{u&&p.bindFramebuffer(36160,F)}}}},this.copyFramebufferToTexture=function(t,e,n){void 0===n&&(n=0);var r=Math.pow(2,-n),i=Math.floor(e.image.width*r),o=Math.floor(e.image.height*r),a=k.convert(e.format);x.setTexture2D(e,0),p.copyTexImage2D(3553,n,a,t.x,t.y,i,o,0),v.unbindTexture()},this.copyTextureToTexture=function(t,e,n,r){var i=e.image.width,o=e.image.height,a=k.convert(n.format),s=k.convert(n.type);x.setTexture2D(n,0),e.isDataTexture?p.texSubImage2D(3553,r||0,t.x,t.y,i,o,a,s,e.image.data):p.texSubImage2D(3553,r||0,t.x,t.y,a,s,e.image),v.unbindTexture()},this.initTexture=function(t){x.setTexture2D(t,0),v.unbindTexture()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function zyt(t,e){this.name="",this.color=new Smt(t),this.density=void 0!==e?e:25e-5}function Uyt(t,e,n){this.name="",this.color=new Smt(t),this.near=void 0!==e?e:1,this.far=void 0!==n?n:1e3}function Vyt(t,e){this.array=t,this.stride=e,this.count=void 0!==t?t.length/e:0,this.usage=Vpt,this.updateRange={offset:0,count:-1},this.version=0}Dyt.prototype=Object.assign(Object.create(Ovt.prototype),{constructor:Dyt,isArrayCamera:!0}),Fyt.prototype=Object.assign(Object.create(Ldt.prototype),{constructor:Fyt,isGroup:!0}),Object.assign(jyt.prototype,Wpt.prototype),Object.assign(zyt.prototype,{isFogExp2:!0,clone:function(){return new zyt(this.color,this.density)},toJSON:function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}),Object.assign(Uyt.prototype,{isFog:!0,clone:function(){return new Uyt(this.color,this.near,this.far)},toJSON:function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}),Object.defineProperty(Vyt.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(Vyt.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this},copyAt:function(t,e,n){t*=this.stride,n*=e.stride;for(var r=0,i=this.stride;r<i;r++)this.array[t+r]=e.array[n+r];return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(t){return this.onUploadCallback=t,this}});var Gyt,Wyt=new adt;function Hyt(t,e,n,r){this.data=t,this.itemSize=e,this.offset=n,this.normalized=!0===r}function Yyt(t){Omt.call(this),this.type="SpriteMaterial",this.color=new Smt(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(t)}Object.defineProperties(Hyt.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(Hyt.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(t){for(var e=0,n=this.data.count;e<n;e++)Wyt.x=this.getX(e),Wyt.y=this.getY(e),Wyt.z=this.getZ(e),Wyt.applyMatrix4(t),this.setXYZ(e,Wyt.x,Wyt.y,Wyt.z);return this},setX:function(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this},setY:function(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this},setZ:function(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this},setW:function(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this},getX:function(t){return this.data.array[t*this.data.stride+this.offset]},getY:function(t){return this.data.array[t*this.data.stride+this.offset+1]},getZ:function(t){return this.data.array[t*this.data.stride+this.offset+2]},getW:function(t){return this.data.array[t*this.data.stride+this.offset+3]},setXY:function(t,e,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this},setXYZ:function(t,e,n,r){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=r,this},setXYZW:function(t,e,n,r,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=r,this.data.array[t+3]=i,this}}),Yyt.prototype=Object.create(Omt.prototype),Yyt.prototype.constructor=Yyt,Yyt.prototype.isSpriteMaterial=!0,Yyt.prototype.copy=function(t){return Omt.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.rotation=t.rotation,this.sizeAttenuation=t.sizeAttenuation,this};var Xyt=new adt,qyt=new adt,Zyt=new adt,$yt=new Zpt,Kyt=new Zpt,Jyt=new ddt,Qyt=new adt,txt=new adt,ext=new adt,nxt=new Zpt,rxt=new Zpt,ixt=new Zpt;function oxt(t){if(Ldt.call(this),this.type="Sprite",void 0===Gyt){Gyt=new Kmt;var e=new Vyt(new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5);Gyt.setIndex([0,1,2,0,2,3]),Gyt.setAttribute("position",new Hyt(e,3,0,!1)),Gyt.setAttribute("uv",new Hyt(e,2,3,!1))}this.geometry=Gyt,this.material=void 0!==t?t:new Yyt,this.center=new Zpt(.5,.5)}function axt(t,e,n,r,i,o){$yt.subVectors(t,n).addScalar(.5).multiply(r),void 0!==i?(Kyt.x=o*$yt.x-i*$yt.y,Kyt.y=i*$yt.x+o*$yt.y):Kyt.copy($yt),t.copy(e),t.x+=Kyt.x,t.y+=Kyt.y,t.applyMatrix4(Jyt)}oxt.prototype=Object.assign(Object.create(Ldt.prototype),{constructor:oxt,isSprite:!0,raycast:function(t,e){t.camera,qyt.setFromMatrixScale(this.matrixWorld),Jyt.copy(t.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(t.camera.matrixWorldInverse,this.matrixWorld),Zyt.setFromMatrixPosition(this.modelViewMatrix),t.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&qyt.multiplyScalar(-Zyt.z);var n,r,i=this.material.rotation;0!==i&&(r=Math.cos(i),n=Math.sin(i));var o=this.center;axt(Qyt.set(-.5,-.5,0),Zyt,o,qyt,n,r),axt(txt.set(.5,-.5,0),Zyt,o,qyt,n,r),axt(ext.set(.5,.5,0),Zyt,o,qyt,n,r),nxt.set(0,0),rxt.set(1,0),ixt.set(1,1);var a=t.ray.intersectTriangle(Qyt,txt,ext,!1,Xyt);if(null!==a||(axt(txt.set(-.5,.5,0),Zyt,o,qyt,n,r),rxt.set(0,1),null!==(a=t.ray.intersectTriangle(Qyt,ext,txt,!1,Xyt)))){var s=t.ray.origin.distanceTo(Xyt);s<t.near||s>t.far||e.push({distance:s,point:Xyt.clone(),uv:xmt.getUV(Xyt,Qyt,txt,ext,nxt,rxt,ixt,new Zpt),face:null,object:this})}},clone:function(){return new this.constructor(this.material).copy(this)},copy:function(t){return Ldt.prototype.copy.call(this,t),void 0!==t.center&&this.center.copy(t.center),this}});var sxt=new adt,uxt=new adt;function cxt(){Ldt.call(this),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}function lxt(t,e){t&&t.isGeometry,mvt.call(this,t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new ddt,this.bindMatrixInverse=new ddt}cxt.prototype=Object.assign(Object.create(Ldt.prototype),{constructor:cxt,isLOD:!0,copy:function(t){Ldt.prototype.copy.call(this,t,!1);for(var e=t.levels,n=0,r=e.length;n<r;n++){var i=e[n];this.addLevel(i.object.clone(),i.distance)}return this.autoUpdate=t.autoUpdate,this},addLevel:function(t,e){void 0===e&&(e=0),e=Math.abs(e);for(var n=this.levels,r=0;r<n.length&&!(e<n[r].distance);r++);return n.splice(r,0,{distance:e,object:t}),this.add(t),this},getCurrentLevel:function(){return this._currentLevel},getObjectForDistance:function(t){var e=this.levels;if(e.length>0){for(var n=1,r=e.length;n<r&&!(t<e[n].distance);n++);return e[n-1].object}return null},raycast:function(t,e){if(this.levels.length>0){sxt.setFromMatrixPosition(this.matrixWorld);var n=t.ray.origin.distanceTo(sxt);this.getObjectForDistance(n).raycast(t,e)}},update:function(t){var e=this.levels;if(e.length>1){sxt.setFromMatrixPosition(t.matrixWorld),uxt.setFromMatrixPosition(this.matrixWorld);var n=sxt.distanceTo(uxt)/t.zoom;e[0].object.visible=!0;for(var r=1,i=e.length;r<i&&n>=e[r].distance;r++)e[r-1].object.visible=!1,e[r].object.visible=!0;for(this._currentLevel=r-1;r<i;r++)e[r].object.visible=!1}},toJSON:function(t){var e=Ldt.prototype.toJSON.call(this,t);!1===this.autoUpdate&&(e.object.autoUpdate=!1),e.object.levels=[];for(var n=this.levels,r=0,i=n.length;r<i;r++){var o=n[r];e.object.levels.push({object:o.object.uuid,distance:o.distance})}return e}}),lxt.prototype=Object.assign(Object.create(mvt.prototype),{constructor:lxt,isSkinnedMesh:!0,bind:function(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.getInverse(e)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var t=new tdt,e=this.geometry.attributes.skinWeight,n=0,r=e.count;n<r;n++){t.x=e.getX(n),t.y=e.getY(n),t.z=e.getZ(n),t.w=e.getW(n);var i=1/t.manhattanLength();i!==1/0?t.multiplyScalar(i):t.set(1,0,0,0),e.setXYZW(n,t.x,t.y,t.z,t.w)}},updateMatrixWorld:function(t){mvt.prototype.updateMatrixWorld.call(this,t),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode&&this.bindMatrixInverse.getInverse(this.bindMatrix)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var hxt=new ddt,fxt=new ddt;function pxt(t,e){if(t=t||[],this.bones=t.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),this.frame=-1,void 0===e)this.calculateInverses();else if(this.bones.length===e.length)this.boneInverses=e.slice(0);else{this.boneInverses=[];for(var n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new ddt)}}function dxt(){Ldt.call(this),this.type="Bone"}Object.assign(pxt.prototype,{calculateInverses:function(){this.boneInverses=[];for(var t=0,e=this.bones.length;t<e;t++){var n=new ddt;this.bones[t]&&n.getInverse(this.bones[t].matrixWorld),this.boneInverses.push(n)}},pose:function(){var t,e,n;for(e=0,n=this.bones.length;e<n;e++)(t=this.bones[e])&&t.matrixWorld.getInverse(this.boneInverses[e]);for(e=0,n=this.bones.length;e<n;e++)(t=this.bones[e])&&(t.parent&&t.parent.isBone?(t.matrix.getInverse(t.parent.matrixWorld),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))},update:function(){for(var t=this.bones,e=this.boneInverses,n=this.boneMatrices,r=this.boneTexture,i=0,o=t.length;i<o;i++){var a=t[i]?t[i].matrixWorld:fxt;hxt.multiplyMatrices(a,e[i]),hxt.toArray(n,16*i)}void 0!==r&&(r.needsUpdate=!0)},clone:function(){return new pxt(this.bones,this.boneInverses)},getBoneByName:function(t){for(var e=0,n=this.bones.length;e<n;e++){var r=this.bones[e];if(r.name===t)return r}},dispose:function(){this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=void 0)}}),dxt.prototype=Object.assign(Object.create(Ldt.prototype),{constructor:dxt,isBone:!0});var mxt=new ddt,vxt=new ddt,gxt=[],yxt=new mvt;function xxt(t,e,n){mvt.call(this,t,e),this.instanceMatrix=new Lmt(new Float32Array(16*n),16),this.count=n,this.frustumCulled=!1}function bxt(t){Omt.call(this),this.type="LineBasicMaterial",this.color=new Smt(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(t)}xxt.prototype=Object.assign(Object.create(mvt.prototype),{constructor:xxt,isInstancedMesh:!0,getMatrixAt:function(t,e){e.fromArray(this.instanceMatrix.array,16*t)},raycast:function(t,e){var n=this.matrixWorld,r=this.count;if(yxt.geometry=this.geometry,yxt.material=this.material,void 0!==yxt.material)for(var i=0;i<r;i++)this.getMatrixAt(i,mxt),vxt.multiplyMatrices(n,mxt),yxt.matrixWorld=vxt,yxt.raycast(t,gxt),gxt.length>0&&(gxt[0].instanceId=i,gxt[0].object=this,e.push(gxt[0]),gxt.length=0)},setMatrixAt:function(t,e){e.toArray(this.instanceMatrix.array,16*t)},updateMorphTargets:function(){}}),bxt.prototype=Object.create(Omt.prototype),bxt.prototype.constructor=bxt,bxt.prototype.isLineBasicMaterial=!0,bxt.prototype.copy=function(t){return Omt.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this};var _xt=new adt,wxt=new adt,Sxt=new ddt,Mxt=new imt,Ext=new $dt;function Axt(t,e,n){Ldt.call(this),this.type="Line",this.geometry=void 0!==t?t:new Kmt,this.material=void 0!==e?e:new bxt}Axt.prototype=Object.assign(Object.create(Ldt.prototype),{constructor:Axt,isLine:!0,computeLineDistances:function(){var t=this.geometry;if(t.isBufferGeometry){if(null===t.index){for(var e=t.attributes.position,n=[0],r=1,i=e.count;r<i;r++)_xt.fromBufferAttribute(e,r-1),wxt.fromBufferAttribute(e,r),n[r]=n[r-1],n[r]+=_xt.distanceTo(wxt);t.setAttribute("lineDistance",new zmt(n,1))}}else if(t.isGeometry){var o=t.vertices;(n=t.lineDistances)[0]=0;for(r=1,i=o.length;r<i;r++)n[r]=n[r-1],n[r]+=o[r-1].distanceTo(o[r])}return this},raycast:function(t,e){var n=this.geometry,r=this.matrixWorld,i=t.params.Line.threshold;if(null===n.boundingSphere&&n.computeBoundingSphere(),Ext.copy(n.boundingSphere),Ext.applyMatrix4(r),Ext.radius+=i,!1!==t.ray.intersectsSphere(Ext)){Sxt.getInverse(r),Mxt.copy(t.ray).applyMatrix4(Sxt);var o=i/((this.scale.x+this.scale.y+this.scale.z)/3),a=o*o,s=new adt,u=new adt,c=new adt,l=new adt,h=this&&this.isLineSegments?2:1;if(n.isBufferGeometry){var f=n.index,p=n.attributes.position.array;if(null!==f)for(var d=f.array,m=0,v=d.length-1;m<v;m+=h){var g=d[m],y=d[m+1];if(s.fromArray(p,3*g),u.fromArray(p,3*y),!(Mxt.distanceSqToSegment(s,u,l,c)>a))l.applyMatrix4(this.matrixWorld),(_=t.ray.origin.distanceTo(l))<t.near||_>t.far||e.push({distance:_,point:c.clone().applyMatrix4(this.matrixWorld),index:m,face:null,faceIndex:null,object:this})}else for(m=0,v=p.length/3-1;m<v;m+=h){if(s.fromArray(p,3*m),u.fromArray(p,3*m+3),!(Mxt.distanceSqToSegment(s,u,l,c)>a))l.applyMatrix4(this.matrixWorld),(_=t.ray.origin.distanceTo(l))<t.near||_>t.far||e.push({distance:_,point:c.clone().applyMatrix4(this.matrixWorld),index:m,face:null,faceIndex:null,object:this})}}else if(n.isGeometry){var x=n.vertices,b=x.length;for(m=0;m<b-1;m+=h){var _;if(!(Mxt.distanceSqToSegment(x[m],x[m+1],l,c)>a))l.applyMatrix4(this.matrixWorld),(_=t.ray.origin.distanceTo(l))<t.near||_>t.far||e.push({distance:_,point:c.clone().applyMatrix4(this.matrixWorld),index:m,face:null,faceIndex:null,object:this})}}}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var Txt=new adt,Cxt=new adt;function Oxt(t,e){Axt.call(this,t,e),this.type="LineSegments"}function kxt(t,e){Axt.call(this,t,e),this.type="LineLoop"}function Pxt(t){Omt.call(this),this.type="PointsMaterial",this.color=new Smt(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(t)}Oxt.prototype=Object.assign(Object.create(Axt.prototype),{constructor:Oxt,isLineSegments:!0,computeLineDistances:function(){var t=this.geometry;if(t.isBufferGeometry){if(null===t.index){for(var e=t.attributes.position,n=[],r=0,i=e.count;r<i;r+=2)Txt.fromBufferAttribute(e,r),Cxt.fromBufferAttribute(e,r+1),n[r]=0===r?0:n[r-1],n[r+1]=n[r]+Txt.distanceTo(Cxt);t.setAttribute("lineDistance",new zmt(n,1))}}else if(t.isGeometry){var o=t.vertices;for(n=t.lineDistances,r=0,i=o.length;r<i;r+=2)Txt.copy(o[r]),Cxt.copy(o[r+1]),n[r]=0===r?0:n[r-1],n[r+1]=n[r]+Txt.distanceTo(Cxt)}return this}}),kxt.prototype=Object.assign(Object.create(Axt.prototype),{constructor:kxt,isLineLoop:!0}),Pxt.prototype=Object.create(Omt.prototype),Pxt.prototype.constructor=Pxt,Pxt.prototype.isPointsMaterial=!0,Pxt.prototype.copy=function(t){return Omt.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.morphTargets=t.morphTargets,this};var Lxt=new ddt,Rxt=new imt,Ixt=new $dt,Nxt=new adt;function Dxt(t,e){Ldt.call(this),this.type="Points",this.geometry=void 0!==t?t:new Kmt,this.material=void 0!==e?e:new Pxt,this.updateMorphTargets()}function Fxt(t,e,n,r,i,o,a){var s=Rxt.distanceSqToPoint(t);if(s<n){var u=new adt;Rxt.closestPointToPoint(t,u),u.applyMatrix4(r);var c=i.ray.origin.distanceTo(u);if(c<i.near||c>i.far)return;o.push({distance:c,distanceToRay:Math.sqrt(s),point:u,index:e,face:null,object:a})}}function jxt(t,e,n,r,i,o,a,s,u){Qpt.call(this,t,e,n,r,i,o,a,s,u),this.format=void 0!==a?a:Cpt,this.minFilter=void 0!==o?o:bpt,this.magFilter=void 0!==i?i:bpt,this.generateMipmaps=!1}function Bxt(t,e,n,r,i,o,a,s,u,c,l,h){Qpt.call(this,null,o,a,s,u,c,r,i,l,h),this.image={width:e,height:n},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}function zxt(t,e,n,r,i,o,a,s,u){Qpt.call(this,t,e,n,r,i,o,a,s,u),this.needsUpdate=!0}function Uxt(t,e,n,r,i,o,a,s,u,c){if((c=void 0!==c?c:kpt)!==kpt&&c!==Ppt)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&c===kpt&&(n=Spt),void 0===n&&c===Ppt&&(n=Tpt),Qpt.call(this,null,r,i,o,a,s,c,n,u),this.image={width:t,height:e},this.magFilter=void 0!==a?a:gpt,this.minFilter=void 0!==s?s:gpt,this.flipY=!1,this.generateMipmaps=!1}function Vxt(t){Kmt.call(this),this.type="WireframeGeometry";var e,n,r,i,o,a,s,u,c,l,h=[],f=[0,0],p={},d=["a","b","c"];if(t&&t.isGeometry){var m=t.faces;for(e=0,r=m.length;e<r;e++){var v=m[e];for(n=0;n<3;n++)s=v[d[n]],u=v[d[(n+1)%3]],f[0]=Math.min(s,u),f[1]=Math.max(s,u),void 0===p[c=f[0]+","+f[1]]&&(p[c]={index1:f[0],index2:f[1]})}for(c in p)a=p[c],l=t.vertices[a.index1],h.push(l.x,l.y,l.z),l=t.vertices[a.index2],h.push(l.x,l.y,l.z)}else if(t&&t.isBufferGeometry){var g,y,x,b,_,w,S;if(l=new adt,null!==t.index){for(g=t.attributes.position,y=t.index,0===(x=t.groups).length&&(x=[{start:0,count:y.count,materialIndex:0}]),i=0,o=x.length;i<o;++i)for(e=_=(b=x[i]).start,r=_+b.count;e<r;e+=3)for(n=0;n<3;n++)s=y.getX(e+n),u=y.getX(e+(n+1)%3),f[0]=Math.min(s,u),f[1]=Math.max(s,u),void 0===p[c=f[0]+","+f[1]]&&(p[c]={index1:f[0],index2:f[1]});for(c in p)a=p[c],l.fromBufferAttribute(g,a.index1),h.push(l.x,l.y,l.z),l.fromBufferAttribute(g,a.index2),h.push(l.x,l.y,l.z)}else for(e=0,r=(g=t.attributes.position).count/3;e<r;e++)for(n=0;n<3;n++)w=3*e+n,l.fromBufferAttribute(g,w),h.push(l.x,l.y,l.z),S=3*e+(n+1)%3,l.fromBufferAttribute(g,S),h.push(l.x,l.y,l.z)}this.setAttribute("position",new zmt(h,3))}function Gxt(t,e,n){wvt.call(this),this.type="ParametricGeometry",this.parameters={func:t,slices:e,stacks:n},this.fromBufferGeometry(new Wxt(t,e,n)),this.mergeVertices()}function Wxt(t,e,n){Kmt.call(this),this.type="ParametricBufferGeometry",this.parameters={func:t,slices:e,stacks:n};var r,i,o=[],a=[],s=[],u=[],c=1e-5,l=new adt,h=new adt,f=new adt,p=new adt,d=new adt;t.length;var m=e+1;for(r=0;r<=n;r++){var v=r/n;for(i=0;i<=e;i++){var g=i/e;t(g,v,h),a.push(h.x,h.y,h.z),g-c>=0?(t(g-c,v,f),p.subVectors(h,f)):(t(g+c,v,f),p.subVectors(f,h)),v-c>=0?(t(g,v-c,f),d.subVectors(h,f)):(t(g,v+c,f),d.subVectors(f,h)),l.crossVectors(p,d).normalize(),s.push(l.x,l.y,l.z),u.push(g,v)}}for(r=0;r<n;r++)for(i=0;i<e;i++){var y=r*m+i,x=r*m+i+1,b=(r+1)*m+i+1,_=(r+1)*m+i;o.push(y,x,_),o.push(x,b,_)}this.setIndex(o),this.setAttribute("position",new zmt(a,3)),this.setAttribute("normal",new zmt(s,3)),this.setAttribute("uv",new zmt(u,2))}function Hxt(t,e,n,r){wvt.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:e,radius:n,detail:r},this.fromBufferGeometry(new Yxt(t,e,n,r)),this.mergeVertices()}function Yxt(t,e,n,r){Kmt.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:t,indices:e,radius:n,detail:r},n=n||1;var i=[],o=[];function a(t,e,n,r){var i,o,a=Math.pow(2,r),u=[];for(i=0;i<=a;i++){u[i]=[];var c=t.clone().lerp(n,i/a),l=e.clone().lerp(n,i/a),h=a-i;for(o=0;o<=h;o++)u[i][o]=0===o&&i===a?c:c.clone().lerp(l,o/h)}for(i=0;i<a;i++)for(o=0;o<2*(a-i)-1;o++){var f=Math.floor(o/2);o%2==0?(s(u[i][f+1]),s(u[i+1][f]),s(u[i][f])):(s(u[i][f+1]),s(u[i+1][f+1]),s(u[i+1][f]))}}function s(t){i.push(t.x,t.y,t.z)}function u(e,n){var r=3*e;n.x=t[r+0],n.y=t[r+1],n.z=t[r+2]}function c(t,e,n,r){r<0&&1===t.x&&(o[e]=t.x-1),0===n.x&&0===n.z&&(o[e]=r/2/Math.PI+.5)}function l(t){return Math.atan2(t.z,-t.x)}!function(t){for(var n=new adt,r=new adt,i=new adt,o=0;o<e.length;o+=3)u(e[o+0],n),u(e[o+1],r),u(e[o+2],i),a(n,r,i,t)}(r=r||0),function(t){for(var e=new adt,n=0;n<i.length;n+=3)e.x=i[n+0],e.y=i[n+1],e.z=i[n+2],e.normalize().multiplyScalar(t),i[n+0]=e.x,i[n+1]=e.y,i[n+2]=e.z}(n),function(){for(var t=new adt,e=0;e<i.length;e+=3){t.x=i[e+0],t.y=i[e+1],t.z=i[e+2];var n=l(t)/2/Math.PI+.5,r=(a=t,Math.atan2(-a.y,Math.sqrt(a.x*a.x+a.z*a.z))/Math.PI+.5);o.push(n,1-r)}var a;(function(){for(var t=new adt,e=new adt,n=new adt,r=new adt,a=new Zpt,s=new Zpt,u=new Zpt,h=0,f=0;h<i.length;h+=9,f+=6){t.set(i[h+0],i[h+1],i[h+2]),e.set(i[h+3],i[h+4],i[h+5]),n.set(i[h+6],i[h+7],i[h+8]),a.set(o[f+0],o[f+1]),s.set(o[f+2],o[f+3]),u.set(o[f+4],o[f+5]),r.copy(t).add(e).add(n).divideScalar(3);var p=l(r);c(a,f+0,t,p),c(s,f+2,e,p),c(u,f+4,n,p)}})(),function(){for(var t=0;t<o.length;t+=6){var e=o[t+0],n=o[t+2],r=o[t+4],i=Math.max(e,n,r),a=Math.min(e,n,r);i>.9&&a<.1&&(e<.2&&(o[t+0]+=1),n<.2&&(o[t+2]+=1),r<.2&&(o[t+4]+=1))}}()}(),this.setAttribute("position",new zmt(i,3)),this.setAttribute("normal",new zmt(i.slice(),3)),this.setAttribute("uv",new zmt(o,2)),0===r?this.computeVertexNormals():this.normalizeNormals()}function Xxt(t,e){wvt.call(this),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new qxt(t,e)),this.mergeVertices()}function qxt(t,e){Yxt.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],t,e),this.type="TetrahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Zxt(t,e){wvt.call(this),this.type="OctahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new $xt(t,e)),this.mergeVertices()}function $xt(t,e){Yxt.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],t,e),this.type="OctahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Kxt(t,e){wvt.call(this),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Jxt(t,e)),this.mergeVertices()}function Jxt(t,e){var n=(1+Math.sqrt(5))/2,r=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1];Yxt.call(this,r,[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],t,e),this.type="IcosahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Qxt(t,e){wvt.call(this),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new tbt(t,e)),this.mergeVertices()}function tbt(t,e){var n=(1+Math.sqrt(5))/2,r=1/n,i=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r];Yxt.call(this,i,[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],t,e),this.type="DodecahedronBufferGeometry",this.parameters={radius:t,detail:e}}function ebt(t,e,n,r,i,o){wvt.call(this),this.type="TubeGeometry",this.parameters={path:t,tubularSegments:e,radius:n,radialSegments:r,closed:i};var a=new nbt(t,e,n,r,i);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals,this.fromBufferGeometry(a),this.mergeVertices()}function nbt(t,e,n,r,i){Kmt.call(this),this.type="TubeBufferGeometry",this.parameters={path:t,tubularSegments:e,radius:n,radialSegments:r,closed:i},e=e||64,n=n||1,r=r||8,i=i||!1;var o=t.computeFrenetFrames(e,i);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;var a,s,u=new adt,c=new adt,l=new Zpt,h=new adt,f=[],p=[],d=[],m=[];function v(i){h=t.getPointAt(i/e,h);var a=o.normals[i],l=o.binormals[i];for(s=0;s<=r;s++){var d=s/r*Math.PI*2,m=Math.sin(d),v=-Math.cos(d);c.x=v*a.x+m*l.x,c.y=v*a.y+m*l.y,c.z=v*a.z+m*l.z,c.normalize(),p.push(c.x,c.y,c.z),u.x=h.x+n*c.x,u.y=h.y+n*c.y,u.z=h.z+n*c.z,f.push(u.x,u.y,u.z)}}!function(){for(a=0;a<e;a++)v(a);v(!1===i?e:0),function(){for(a=0;a<=e;a++)for(s=0;s<=r;s++)l.x=a/e,l.y=s/r,d.push(l.x,l.y)}(),function(){for(s=1;s<=e;s++)for(a=1;a<=r;a++){var t=(r+1)*(s-1)+(a-1),n=(r+1)*s+(a-1),i=(r+1)*s+a,o=(r+1)*(s-1)+a;m.push(t,n,o),m.push(n,i,o)}}()}(),this.setIndex(m),this.setAttribute("position",new zmt(f,3)),this.setAttribute("normal",new zmt(p,3)),this.setAttribute("uv",new zmt(d,2))}function rbt(t,e,n,r,i,o,a){wvt.call(this),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:e,tubularSegments:n,radialSegments:r,p:i,q:o},this.fromBufferGeometry(new ibt(t,e,n,r,i,o)),this.mergeVertices()}function ibt(t,e,n,r,i,o){Kmt.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:t,tube:e,tubularSegments:n,radialSegments:r,p:i,q:o},t=t||1,e=e||.4,n=Math.floor(n)||64,r=Math.floor(r)||8,i=i||2,o=o||3;var a,s,u=[],c=[],l=[],h=[],f=new adt,p=new adt,d=new adt,m=new adt,v=new adt,g=new adt,y=new adt;for(a=0;a<=n;++a){var x=a/n*i*Math.PI*2;for(T(x,i,o,t,d),T(x+.01,i,o,t,m),g.subVectors(m,d),y.addVectors(m,d),v.crossVectors(g,y),y.crossVectors(v,g),v.normalize(),y.normalize(),s=0;s<=r;++s){var b=s/r*Math.PI*2,_=-e*Math.cos(b),w=e*Math.sin(b);f.x=d.x+(_*y.x+w*v.x),f.y=d.y+(_*y.y+w*v.y),f.z=d.z+(_*y.z+w*v.z),c.push(f.x,f.y,f.z),p.subVectors(f,d).normalize(),l.push(p.x,p.y,p.z),h.push(a/n),h.push(s/r)}}for(s=1;s<=n;s++)for(a=1;a<=r;a++){var S=(r+1)*(s-1)+(a-1),M=(r+1)*s+(a-1),E=(r+1)*s+a,A=(r+1)*(s-1)+a;u.push(S,M,A),u.push(M,E,A)}function T(t,e,n,r,i){var o=Math.cos(t),a=Math.sin(t),s=n/e*t,u=Math.cos(s);i.x=r*(2+u)*.5*o,i.y=r*(2+u)*a*.5,i.z=r*Math.sin(s)*.5}this.setIndex(u),this.setAttribute("position",new zmt(c,3)),this.setAttribute("normal",new zmt(l,3)),this.setAttribute("uv",new zmt(h,2))}function obt(t,e,n,r,i){wvt.call(this),this.type="TorusGeometry",this.parameters={radius:t,tube:e,radialSegments:n,tubularSegments:r,arc:i},this.fromBufferGeometry(new abt(t,e,n,r,i)),this.mergeVertices()}function abt(t,e,n,r,i){Kmt.call(this),this.type="TorusBufferGeometry",this.parameters={radius:t,tube:e,radialSegments:n,tubularSegments:r,arc:i},t=t||1,e=e||.4,n=Math.floor(n)||8,r=Math.floor(r)||6,i=i||2*Math.PI;var o,a,s=[],u=[],c=[],l=[],h=new adt,f=new adt,p=new adt;for(o=0;o<=n;o++)for(a=0;a<=r;a++){var d=a/r*i,m=o/n*Math.PI*2;f.x=(t+e*Math.cos(m))*Math.cos(d),f.y=(t+e*Math.cos(m))*Math.sin(d),f.z=e*Math.sin(m),u.push(f.x,f.y,f.z),h.x=t*Math.cos(d),h.y=t*Math.sin(d),p.subVectors(f,h).normalize(),c.push(p.x,p.y,p.z),l.push(a/r),l.push(o/n)}for(o=1;o<=n;o++)for(a=1;a<=r;a++){var v=(r+1)*o+a-1,g=(r+1)*(o-1)+a-1,y=(r+1)*(o-1)+a,x=(r+1)*o+a;s.push(v,g,x),s.push(g,y,x)}this.setIndex(s),this.setAttribute("position",new zmt(u,3)),this.setAttribute("normal",new zmt(c,3)),this.setAttribute("uv",new zmt(l,2))}Dxt.prototype=Object.assign(Object.create(Ldt.prototype),{constructor:Dxt,isPoints:!0,raycast:function(t,e){var n=this.geometry,r=this.matrixWorld,i=t.params.Points.threshold;if(null===n.boundingSphere&&n.computeBoundingSphere(),Ixt.copy(n.boundingSphere),Ixt.applyMatrix4(r),Ixt.radius+=i,!1!==t.ray.intersectsSphere(Ixt)){Lxt.getInverse(r),Rxt.copy(t.ray).applyMatrix4(Lxt);var o=i/((this.scale.x+this.scale.y+this.scale.z)/3),a=o*o;if(n.isBufferGeometry){var s=n.index,u=n.attributes.position.array;if(null!==s)for(var c=s.array,l=0,h=c.length;l<h;l++){var f=c[l];Nxt.fromArray(u,3*f),Fxt(Nxt,f,a,r,t,e,this)}else{l=0;for(var p=u.length/3;l<p;l++)Nxt.fromArray(u,3*l),Fxt(Nxt,l,a,r,t,e,this)}}else{var d=n.vertices;for(l=0,p=d.length;l<p;l++)Fxt(d[l],l,a,r,t,e,this)}}},updateMorphTargets:function(){var t,e,n,r=this.geometry;if(r.isBufferGeometry){var i=r.morphAttributes,o=Object.keys(i);if(o.length>0){var a=i[o[0]];if(void 0!==a)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,e=a.length;t<e;t++)n=a[t].name||String(t),this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=t}}else{var s=r.morphTargets;void 0!==s&&s.length}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),jxt.prototype=Object.assign(Object.create(Qpt.prototype),{constructor:jxt,isVideoTexture:!0,update:function(){var t=this.image;t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),Bxt.prototype=Object.create(Qpt.prototype),Bxt.prototype.constructor=Bxt,Bxt.prototype.isCompressedTexture=!0,zxt.prototype=Object.create(Qpt.prototype),zxt.prototype.constructor=zxt,zxt.prototype.isCanvasTexture=!0,Uxt.prototype=Object.create(Qpt.prototype),Uxt.prototype.constructor=Uxt,Uxt.prototype.isDepthTexture=!0,Vxt.prototype=Object.create(Kmt.prototype),Vxt.prototype.constructor=Vxt,Gxt.prototype=Object.create(wvt.prototype),Gxt.prototype.constructor=Gxt,Wxt.prototype=Object.create(Kmt.prototype),Wxt.prototype.constructor=Wxt,Hxt.prototype=Object.create(wvt.prototype),Hxt.prototype.constructor=Hxt,Yxt.prototype=Object.create(Kmt.prototype),Yxt.prototype.constructor=Yxt,Xxt.prototype=Object.create(wvt.prototype),Xxt.prototype.constructor=Xxt,qxt.prototype=Object.create(Yxt.prototype),qxt.prototype.constructor=qxt,Zxt.prototype=Object.create(wvt.prototype),Zxt.prototype.constructor=Zxt,$xt.prototype=Object.create(Yxt.prototype),$xt.prototype.constructor=$xt,Kxt.prototype=Object.create(wvt.prototype),Kxt.prototype.constructor=Kxt,Jxt.prototype=Object.create(Yxt.prototype),Jxt.prototype.constructor=Jxt,Qxt.prototype=Object.create(wvt.prototype),Qxt.prototype.constructor=Qxt,tbt.prototype=Object.create(Yxt.prototype),tbt.prototype.constructor=tbt,ebt.prototype=Object.create(wvt.prototype),ebt.prototype.constructor=ebt,nbt.prototype=Object.create(Kmt.prototype),nbt.prototype.constructor=nbt,nbt.prototype.toJSON=function(){var t=Kmt.prototype.toJSON.call(this);return t.path=this.parameters.path.toJSON(),t},rbt.prototype=Object.create(wvt.prototype),rbt.prototype.constructor=rbt,ibt.prototype=Object.create(Kmt.prototype),ibt.prototype.constructor=ibt,obt.prototype=Object.create(wvt.prototype),obt.prototype.constructor=obt,abt.prototype=Object.create(Kmt.prototype),abt.prototype.constructor=abt;var sbt=function(t,e,n){n=n||2;var r,i,o,a,s,u,c,l=e&&e.length,h=l?e[0]*n:t.length,f=ubt(t,0,h,n,!0),p=[];if(!f||f.next===f.prev)return p;if(l&&(f=function(t,e,n,r){var i,o,a,s=[];for(i=0,o=e.length;i<o;i++)(a=ubt(t,e[i]*r,i<o-1?e[i+1]*r:t.length,r,!1))===a.next&&(a.steiner=!0),s.push(ybt(a));for(s.sort(mbt),i=0;i<s.length;i++)vbt(s[i],n),n=cbt(n,n.next);return n}(t,e,f,n)),t.length>80*n){r=o=t[0],i=a=t[1];for(var d=n;d<h;d+=n)(s=t[d])<r&&(r=s),(u=t[d+1])<i&&(i=u),s>o&&(o=s),u>a&&(a=u);c=0!==(c=Math.max(o-r,a-i))?1/c:0}return lbt(f,p,n,r,i,c),p};function ubt(t,e,n,r,i){var o,a;if(i===function(t,e,n,r){for(var i=0,o=e,a=n-r;o<n;o+=r)i+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return i}(t,e,n,r)>0)for(o=e;o<n;o+=r)a=Abt(o,t[o],t[o+1],a);else for(o=n-r;o>=e;o-=r)a=Abt(o,t[o],t[o+1],a);return a&&wbt(a,a.next)&&(Tbt(a),a=a.next),a}function cbt(t,e){if(!t)return t;e||(e=t);var n,r=t;do{if(n=!1,r.steiner||!wbt(r,r.next)&&0!==_bt(r.prev,r,r.next))r=r.next;else{if(Tbt(r),(r=e=r.prev)===r.next)break;n=!0}}while(n||r!==e);return e}function lbt(t,e,n,r,i,o,a){if(t){!a&&o&&function(t,e,n,r){var i=t;do{null===i.z&&(i.z=gbt(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,n,r,i,o,a,s,u,c=1;do{for(n=t,t=null,o=null,a=0;n;){for(a++,r=n,s=0,e=0;e<c&&(s++,r=r.nextZ);e++);for(u=c;s>0||u>0&&r;)0!==s&&(0===u||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,u--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;n=r}o.nextZ=null,c*=2}while(a>1)}(i)}(t,r,i,o);for(var s,u,c=t;t.prev!==t.next;)if(s=t.prev,u=t.next,o?fbt(t,r,i,o):hbt(t))e.push(s.i/n),e.push(t.i/n),e.push(u.i/n),Tbt(t),t=u.next,c=u.next;else if((t=u)===c){a?1===a?lbt(t=pbt(t,e,n),e,n,r,i,o,2):2===a&&dbt(t,e,n,r,i,o):lbt(cbt(t),e,n,r,i,o,1);break}}}function hbt(t){var e=t.prev,n=t,r=t.next;if(_bt(e,n,r)>=0)return!1;for(var i=t.next.next;i!==t.prev;){if(xbt(e.x,e.y,n.x,n.y,r.x,r.y,i.x,i.y)&&_bt(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function fbt(t,e,n,r){var i=t.prev,o=t,a=t.next;if(_bt(i,o,a)>=0)return!1;for(var s=i.x<o.x?i.x<a.x?i.x:a.x:o.x<a.x?o.x:a.x,u=i.y<o.y?i.y<a.y?i.y:a.y:o.y<a.y?o.y:a.y,c=i.x>o.x?i.x>a.x?i.x:a.x:o.x>a.x?o.x:a.x,l=i.y>o.y?i.y>a.y?i.y:a.y:o.y>a.y?o.y:a.y,h=gbt(s,u,e,n,r),f=gbt(c,l,e,n,r),p=t.prevZ,d=t.nextZ;p&&p.z>=h&&d&&d.z<=f;){if(p!==t.prev&&p!==t.next&&xbt(i.x,i.y,o.x,o.y,a.x,a.y,p.x,p.y)&&_bt(p.prev,p,p.next)>=0)return!1;if(p=p.prevZ,d!==t.prev&&d!==t.next&&xbt(i.x,i.y,o.x,o.y,a.x,a.y,d.x,d.y)&&_bt(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(;p&&p.z>=h;){if(p!==t.prev&&p!==t.next&&xbt(i.x,i.y,o.x,o.y,a.x,a.y,p.x,p.y)&&_bt(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;d&&d.z<=f;){if(d!==t.prev&&d!==t.next&&xbt(i.x,i.y,o.x,o.y,a.x,a.y,d.x,d.y)&&_bt(d.prev,d,d.next)>=0)return!1;d=d.nextZ}return!0}function pbt(t,e,n){var r=t;do{var i=r.prev,o=r.next.next;!wbt(i,o)&&Sbt(i,r,r.next,o)&&Mbt(i,o)&&Mbt(o,i)&&(e.push(i.i/n),e.push(r.i/n),e.push(o.i/n),Tbt(r),Tbt(r.next),r=t=o),r=r.next}while(r!==t);return r}function dbt(t,e,n,r,i,o){var a=t;do{for(var s=a.next.next;s!==a.prev;){if(a.i!==s.i&&bbt(a,s)){var u=Ebt(a,s);return a=cbt(a,a.next),u=cbt(u,u.next),lbt(a,e,n,r,i,o),void lbt(u,e,n,r,i,o)}s=s.next}a=a.next}while(a!==t)}function mbt(t,e){return t.x-e.x}function vbt(t,e){if(e=function(t,e){var n,r=e,i=t.x,o=t.y,a=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var s=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&s>a){if(a=s,s===i){if(o===r.y)return r;if(o===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!n)return null;if(i===a)return n.prev;var u,c=n,l=n.x,h=n.y,f=1/0;r=n.next;for(;r!==c;)i>=r.x&&r.x>=l&&i!==r.x&&xbt(o<h?i:a,o,l,h,o<h?a:i,o,r.x,r.y)&&((u=Math.abs(o-r.y)/(i-r.x))<f||u===f&&r.x>n.x)&&Mbt(r,t)&&(n=r,f=u),r=r.next;return n}(t,e),e){var n=Ebt(e,t);cbt(n,n.next)}}function gbt(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function ybt(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function xbt(t,e,n,r,i,o,a,s){return(i-a)*(e-s)-(t-a)*(o-s)>=0&&(t-a)*(r-s)-(n-a)*(e-s)>=0&&(n-a)*(o-s)-(i-a)*(r-s)>=0}function bbt(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&Sbt(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&Mbt(t,e)&&Mbt(e,t)&&function(t,e){var n=t,r=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)}function _bt(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function wbt(t,e){return t.x===e.x&&t.y===e.y}function Sbt(t,e,n,r){return!!(wbt(t,n)&&wbt(e,r)||wbt(t,r)&&wbt(n,e))||_bt(t,e,n)>0!=_bt(t,e,r)>0&&_bt(n,r,t)>0!=_bt(n,r,e)>0}function Mbt(t,e){return _bt(t.prev,t,t.next)<0?_bt(t,e,t.next)>=0&&_bt(t,t.prev,e)>=0:_bt(t,e,t.prev)<0||_bt(t,t.next,e)<0}function Ebt(t,e){var n=new Cbt(t.i,t.x,t.y),r=new Cbt(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function Abt(t,e,n,r){var i=new Cbt(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function Tbt(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Cbt(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}var Obt={area:function(t){for(var e=t.length,n=0,r=e-1,i=0;i<e;r=i++)n+=t[r].x*t[i].y-t[i].x*t[r].y;return.5*n},isClockWise:function(t){return Obt.area(t)<0},triangulateShape:function(t,e){var n=[],r=[],i=[];kbt(t),Pbt(n,t);var o=t.length;e.forEach(kbt);for(var a=0;a<e.length;a++)r.push(o),o+=e[a].length,Pbt(n,e[a]);var s=sbt(n,r);for(a=0;a<s.length;a+=3)i.push(s.slice(a,a+3));return i}};function kbt(t){var e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function Pbt(t,e){for(var n=0;n<e.length;n++)t.push(e[n].x),t.push(e[n].y)}function Lbt(t,e){wvt.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:e},this.fromBufferGeometry(new Rbt(t,e)),this.mergeVertices()}function Rbt(t,e){Kmt.call(this),this.type="ExtrudeBufferGeometry",this.parameters={shapes:t,options:e},t=Array.isArray(t)?t:[t];for(var n=this,r=[],i=[],o=0,a=t.length;o<a;o++){s(t[o])}function s(t){var o=[],a=void 0!==e.curveSegments?e.curveSegments:12,s=void 0!==e.steps?e.steps:1,u=void 0!==e.depth?e.depth:100,c=void 0===e.bevelEnabled||e.bevelEnabled,l=void 0!==e.bevelThickness?e.bevelThickness:6,h=void 0!==e.bevelSize?e.bevelSize:l-2,f=void 0!==e.bevelOffset?e.bevelOffset:0,p=void 0!==e.bevelSegments?e.bevelSegments:3,d=e.extrudePath,m=void 0!==e.UVGenerator?e.UVGenerator:Ibt;void 0!==e.amount&&(u=e.amount);var v,g,y,x,b,_,w,S,M=!1;d&&(v=d.getSpacedPoints(s),M=!0,c=!1,g=d.computeFrenetFrames(s,!1),y=new adt,x=new adt,b=new adt),c||(p=0,l=0,h=0,f=0);var E=t.extractPoints(a),A=E.shape,T=E.holes;if(!Obt.isClockWise(A))for(A=A.reverse(),w=0,S=T.length;w<S;w++)_=T[w],Obt.isClockWise(_)&&(T[w]=_.reverse());var C=Obt.triangulateShape(A,T),O=A;for(w=0,S=T.length;w<S;w++)_=T[w],A=A.concat(_);function k(t,e,n){return e.clone().multiplyScalar(n).add(t)}var P,L,R,I,N,D,F=A.length,j=C.length;function B(t,e,n){var r,i,o,a=t.x-e.x,s=t.y-e.y,u=n.x-t.x,c=n.y-t.y,l=a*a+s*s,h=a*c-s*u;if(Math.abs(h)>Number.EPSILON){var f=Math.sqrt(l),p=Math.sqrt(u*u+c*c),d=e.x-s/f,m=e.y+a/f,v=((n.x-c/p-d)*c-(n.y+u/p-m)*u)/(a*c-s*u),g=(r=d+a*v-t.x)*r+(i=m+s*v-t.y)*i;if(g<=2)return new Zpt(r,i);o=Math.sqrt(g/2)}else{var y=!1;a>Number.EPSILON?u>Number.EPSILON&&(y=!0):a<-Number.EPSILON?u<-Number.EPSILON&&(y=!0):Math.sign(s)===Math.sign(c)&&(y=!0),y?(r=-s,i=a,o=Math.sqrt(l)):(r=a,i=s,o=Math.sqrt(l/2))}return new Zpt(r/o,i/o)}for(var z=[],U=0,V=O.length,G=V-1,W=U+1;U<V;U++,G++,W++)G===V&&(G=0),W===V&&(W=0),z[U]=B(O[U],O[G],O[W]);var H,Y,X=[],q=z.concat();for(w=0,S=T.length;w<S;w++){for(_=T[w],H=[],U=0,G=(V=_.length)-1,W=U+1;U<V;U++,G++,W++)G===V&&(G=0),W===V&&(W=0),H[U]=B(_[U],_[G],_[W]);X.push(H),q=q.concat(H)}for(P=0;P<p;P++){for(R=P/p,I=l*Math.cos(R*Math.PI/2),L=h*Math.sin(R*Math.PI/2)+f,U=0,V=O.length;U<V;U++)$((N=k(O[U],z[U],L)).x,N.y,-I);for(w=0,S=T.length;w<S;w++)for(_=T[w],H=X[w],U=0,V=_.length;U<V;U++)$((N=k(_[U],H[U],L)).x,N.y,-I)}for(L=h+f,U=0;U<F;U++)N=c?k(A[U],q[U],L):A[U],M?(x.copy(g.normals[0]).multiplyScalar(N.x),y.copy(g.binormals[0]).multiplyScalar(N.y),b.copy(v[0]).add(x).add(y),$(b.x,b.y,b.z)):$(N.x,N.y,0);for(Y=1;Y<=s;Y++)for(U=0;U<F;U++)N=c?k(A[U],q[U],L):A[U],M?(x.copy(g.normals[Y]).multiplyScalar(N.x),y.copy(g.binormals[Y]).multiplyScalar(N.y),b.copy(v[Y]).add(x).add(y),$(b.x,b.y,b.z)):$(N.x,N.y,u/s*Y);for(P=p-1;P>=0;P--){for(R=P/p,I=l*Math.cos(R*Math.PI/2),L=h*Math.sin(R*Math.PI/2)+f,U=0,V=O.length;U<V;U++)$((N=k(O[U],z[U],L)).x,N.y,u+I);for(w=0,S=T.length;w<S;w++)for(_=T[w],H=X[w],U=0,V=_.length;U<V;U++)N=k(_[U],H[U],L),M?$(N.x,N.y+v[s-1].y,v[s-1].x+I):$(N.x,N.y,u+I)}function Z(t,e){var n,r;for(U=t.length;--U>=0;){n=U,(r=U-1)<0&&(r=t.length-1);var i=0,o=s+2*p;for(i=0;i<o;i++){var a=F*i,u=F*(i+1);J(e+n+a,e+r+a,e+r+u,e+n+u)}}}function $(t,e,n){o.push(t),o.push(e),o.push(n)}function K(t,e,i){Q(t),Q(e),Q(i);var o=r.length/3,a=m.generateTopUV(n,r,o-3,o-2,o-1);tt(a[0]),tt(a[1]),tt(a[2])}function J(t,e,i,o){Q(t),Q(e),Q(o),Q(e),Q(i),Q(o);var a=r.length/3,s=m.generateSideWallUV(n,r,a-6,a-3,a-2,a-1);tt(s[0]),tt(s[1]),tt(s[3]),tt(s[1]),tt(s[2]),tt(s[3])}function Q(t){r.push(o[3*t+0]),r.push(o[3*t+1]),r.push(o[3*t+2])}function tt(t){i.push(t.x),i.push(t.y)}!function(){var t=r.length/3;if(c){var e=0,i=F*e;for(U=0;U<j;U++)K((D=C[U])[2]+i,D[1]+i,D[0]+i);for(i=F*(e=s+2*p),U=0;U<j;U++)K((D=C[U])[0]+i,D[1]+i,D[2]+i)}else{for(U=0;U<j;U++)K((D=C[U])[2],D[1],D[0]);for(U=0;U<j;U++)K((D=C[U])[0]+F*s,D[1]+F*s,D[2]+F*s)}n.addGroup(t,r.length/3-t,0)}(),function(){var t=r.length/3,e=0;for(Z(O,e),e+=O.length,w=0,S=T.length;w<S;w++)Z(_=T[w],e),e+=_.length;n.addGroup(t,r.length/3-t,1)}()}this.setAttribute("position",new zmt(r,3)),this.setAttribute("uv",new zmt(i,2)),this.computeVertexNormals()}Lbt.prototype=Object.create(wvt.prototype),Lbt.prototype.constructor=Lbt,Lbt.prototype.toJSON=function(){var t=wvt.prototype.toJSON.call(this);return Nbt(this.parameters.shapes,this.parameters.options,t)},Rbt.prototype=Object.create(Kmt.prototype),Rbt.prototype.constructor=Rbt,Rbt.prototype.toJSON=function(){var t=Kmt.prototype.toJSON.call(this);return Nbt(this.parameters.shapes,this.parameters.options,t)};var Ibt={generateTopUV:function(t,e,n,r,i){var o=e[3*n],a=e[3*n+1],s=e[3*r],u=e[3*r+1],c=e[3*i],l=e[3*i+1];return[new Zpt(o,a),new Zpt(s,u),new Zpt(c,l)]},generateSideWallUV:function(t,e,n,r,i,o){var a=e[3*n],s=e[3*n+1],u=e[3*n+2],c=e[3*r],l=e[3*r+1],h=e[3*r+2],f=e[3*i],p=e[3*i+1],d=e[3*i+2],m=e[3*o],v=e[3*o+1],g=e[3*o+2];return Math.abs(s-l)<.01?[new Zpt(a,1-u),new Zpt(c,1-h),new Zpt(f,1-d),new Zpt(m,1-g)]:[new Zpt(s,1-u),new Zpt(l,1-h),new Zpt(p,1-d),new Zpt(v,1-g)]}};function Nbt(t,e,n){if(n.shapes=[],Array.isArray(t))for(var r=0,i=t.length;r<i;r++){var o=t[r];n.shapes.push(o.uuid)}else n.shapes.push(t.uuid);return void 0!==e.extrudePath&&(n.options.extrudePath=e.extrudePath.toJSON()),n}function Dbt(t,e){wvt.call(this),this.type="TextGeometry",this.parameters={text:t,parameters:e},this.fromBufferGeometry(new Fbt(t,e)),this.mergeVertices()}function Fbt(t,e){var n=(e=e||{}).font;if(!n||!n.isFont)return new wvt;var r=n.generateShapes(t,e.size);e.depth=void 0!==e.height?e.height:50,void 0===e.bevelThickness&&(e.bevelThickness=10),void 0===e.bevelSize&&(e.bevelSize=8),void 0===e.bevelEnabled&&(e.bevelEnabled=!1),Rbt.call(this,r,e),this.type="TextBufferGeometry"}function jbt(t,e,n,r,i,o,a){wvt.call(this),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:r,phiLength:i,thetaStart:o,thetaLength:a},this.fromBufferGeometry(new Bbt(t,e,n,r,i,o,a)),this.mergeVertices()}function Bbt(t,e,n,r,i,o,a){Kmt.call(this),this.type="SphereBufferGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:r,phiLength:i,thetaStart:o,thetaLength:a},t=t||1,e=Math.max(3,Math.floor(e)||8),n=Math.max(2,Math.floor(n)||6),r=void 0!==r?r:0,i=void 0!==i?i:2*Math.PI,o=void 0!==o?o:0,a=void 0!==a?a:Math.PI;var s,u,c=Math.min(o+a,Math.PI),l=0,h=[],f=new adt,p=new adt,d=[],m=[],v=[],g=[];for(u=0;u<=n;u++){var y=[],x=u/n,b=0;for(0==u&&0==o?b=.5/e:u==n&&c==Math.PI&&(b=-.5/e),s=0;s<=e;s++){var _=s/e;f.x=-t*Math.cos(r+_*i)*Math.sin(o+x*a),f.y=t*Math.cos(o+x*a),f.z=t*Math.sin(r+_*i)*Math.sin(o+x*a),m.push(f.x,f.y,f.z),p.copy(f).normalize(),v.push(p.x,p.y,p.z),g.push(_+b,1-x),y.push(l++)}h.push(y)}for(u=0;u<n;u++)for(s=0;s<e;s++){var w=h[u][s+1],S=h[u][s],M=h[u+1][s],E=h[u+1][s+1];(0!==u||o>0)&&d.push(w,S,E),(u!==n-1||c<Math.PI)&&d.push(S,M,E)}this.setIndex(d),this.setAttribute("position",new zmt(m,3)),this.setAttribute("normal",new zmt(v,3)),this.setAttribute("uv",new zmt(g,2))}function zbt(t,e,n,r,i,o){wvt.call(this),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:n,phiSegments:r,thetaStart:i,thetaLength:o},this.fromBufferGeometry(new Ubt(t,e,n,r,i,o)),this.mergeVertices()}function Ubt(t,e,n,r,i,o){Kmt.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:n,phiSegments:r,thetaStart:i,thetaLength:o},t=t||.5,e=e||1,i=void 0!==i?i:0,o=void 0!==o?o:2*Math.PI,n=void 0!==n?Math.max(3,n):8;var a,s,u,c=[],l=[],h=[],f=[],p=t,d=(e-t)/(r=void 0!==r?Math.max(1,r):1),m=new adt,v=new Zpt;for(s=0;s<=r;s++){for(u=0;u<=n;u++)a=i+u/n*o,m.x=p*Math.cos(a),m.y=p*Math.sin(a),l.push(m.x,m.y,m.z),h.push(0,0,1),v.x=(m.x/e+1)/2,v.y=(m.y/e+1)/2,f.push(v.x,v.y);p+=d}for(s=0;s<r;s++){var g=s*(n+1);for(u=0;u<n;u++){var y=a=u+g,x=a+n+1,b=a+n+2,_=a+1;c.push(y,x,_),c.push(x,b,_)}}this.setIndex(c),this.setAttribute("position",new zmt(l,3)),this.setAttribute("normal",new zmt(h,3)),this.setAttribute("uv",new zmt(f,2))}function Vbt(t,e,n,r){wvt.call(this),this.type="LatheGeometry",this.parameters={points:t,segments:e,phiStart:n,phiLength:r},this.fromBufferGeometry(new Gbt(t,e,n,r)),this.mergeVertices()}function Gbt(t,e,n,r){Kmt.call(this),this.type="LatheBufferGeometry",this.parameters={points:t,segments:e,phiStart:n,phiLength:r},e=Math.floor(e)||12,n=n||0,r=r||2*Math.PI,r=qpt.clamp(r,0,2*Math.PI);var i,o,a,s=[],u=[],c=[],l=1/e,h=new adt,f=new Zpt;for(o=0;o<=e;o++){var p=n+o*l*r,d=Math.sin(p),m=Math.cos(p);for(a=0;a<=t.length-1;a++)h.x=t[a].x*d,h.y=t[a].y,h.z=t[a].x*m,u.push(h.x,h.y,h.z),f.x=o/e,f.y=a/(t.length-1),c.push(f.x,f.y)}for(o=0;o<e;o++)for(a=0;a<t.length-1;a++){var v=i=a+o*t.length,g=i+t.length,y=i+t.length+1,x=i+1;s.push(v,g,x),s.push(g,y,x)}if(this.setIndex(s),this.setAttribute("position",new zmt(u,3)),this.setAttribute("uv",new zmt(c,2)),this.computeVertexNormals(),r===2*Math.PI){var b=this.attributes.normal.array,_=new adt,w=new adt,S=new adt;for(i=e*t.length*3,o=0,a=0;o<t.length;o++,a+=3)_.x=b[a+0],_.y=b[a+1],_.z=b[a+2],w.x=b[i+a+0],w.y=b[i+a+1],w.z=b[i+a+2],S.addVectors(_,w).normalize(),b[a+0]=b[i+a+0]=S.x,b[a+1]=b[i+a+1]=S.y,b[a+2]=b[i+a+2]=S.z}}function Wbt(t,e){wvt.call(this),this.type="ShapeGeometry","object"==typeof e&&(e=e.curveSegments),this.parameters={shapes:t,curveSegments:e},this.fromBufferGeometry(new Hbt(t,e)),this.mergeVertices()}function Hbt(t,e){Kmt.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:t,curveSegments:e},e=e||12;var n=[],r=[],i=[],o=[],a=0,s=0;if(!1===Array.isArray(t))c(t);else for(var u=0;u<t.length;u++)c(t[u]),this.addGroup(a,s,u),a+=s,s=0;function c(t){var a,u,c,l=r.length/3,h=t.extractPoints(e),f=h.shape,p=h.holes;for(!1===Obt.isClockWise(f)&&(f=f.reverse()),a=0,u=p.length;a<u;a++)c=p[a],!0===Obt.isClockWise(c)&&(p[a]=c.reverse());var d=Obt.triangulateShape(f,p);for(a=0,u=p.length;a<u;a++)c=p[a],f=f.concat(c);for(a=0,u=f.length;a<u;a++){var m=f[a];r.push(m.x,m.y,0),i.push(0,0,1),o.push(m.x,m.y)}for(a=0,u=d.length;a<u;a++){var v=d[a],g=v[0]+l,y=v[1]+l,x=v[2]+l;n.push(g,y,x),s+=3}}this.setIndex(n),this.setAttribute("position",new zmt(r,3)),this.setAttribute("normal",new zmt(i,3)),this.setAttribute("uv",new zmt(o,2))}function Ybt(t,e){if(e.shapes=[],Array.isArray(t))for(var n=0,r=t.length;n<r;n++){var i=t[n];e.shapes.push(i.uuid)}else e.shapes.push(t.uuid);return e}function Xbt(t,e){Kmt.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:e},e=void 0!==e?e:1;var n,r,i,o,a=[],s=Math.cos(qpt.DEG2RAD*e),u=[0,0],c={},l=["a","b","c"];t.isBufferGeometry?(o=new wvt).fromBufferGeometry(t):o=t.clone(),o.mergeVertices(),o.computeFaceNormals();for(var h=o.vertices,f=o.faces,p=0,d=f.length;p<d;p++)for(var m=f[p],v=0;v<3;v++)n=m[l[v]],r=m[l[(v+1)%3]],u[0]=Math.min(n,r),u[1]=Math.max(n,r),void 0===c[i=u[0]+","+u[1]]?c[i]={index1:u[0],index2:u[1],face1:p,face2:void 0}:c[i].face2=p;for(i in c){var g=c[i];if(void 0===g.face2||f[g.face1].normal.dot(f[g.face2].normal)<=s){var y=h[g.index1];a.push(y.x,y.y,y.z),y=h[g.index2],a.push(y.x,y.y,y.z)}}this.setAttribute("position",new zmt(a,3))}function qbt(t,e,n,r,i,o,a,s){wvt.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:n,radialSegments:r,heightSegments:i,openEnded:o,thetaStart:a,thetaLength:s},this.fromBufferGeometry(new Zbt(t,e,n,r,i,o,a,s)),this.mergeVertices()}function Zbt(t,e,n,r,i,o,a,s){Kmt.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:n,radialSegments:r,heightSegments:i,openEnded:o,thetaStart:a,thetaLength:s};var u=this;t=void 0!==t?t:1,e=void 0!==e?e:1,n=n||1,r=Math.floor(r)||8,i=Math.floor(i)||1,o=void 0!==o&&o,a=void 0!==a?a:0,s=void 0!==s?s:2*Math.PI;var c=[],l=[],h=[],f=[],p=0,d=[],m=n/2,v=0;function g(n){var i,o,d,g=new Zpt,y=new adt,x=0,b=!0===n?t:e,_=!0===n?1:-1;for(o=p,i=1;i<=r;i++)l.push(0,m*_,0),h.push(0,_,0),f.push(.5,.5),p++;for(d=p,i=0;i<=r;i++){var w=i/r*s+a,S=Math.cos(w),M=Math.sin(w);y.x=b*M,y.y=m*_,y.z=b*S,l.push(y.x,y.y,y.z),h.push(0,_,0),g.x=.5*S+.5,g.y=.5*M*_+.5,f.push(g.x,g.y),p++}for(i=0;i<r;i++){var E=o+i,A=d+i;!0===n?c.push(A,A+1,E):c.push(A+1,A,E),x+=3}u.addGroup(v,x,!0===n?1:2),v+=x}!function(){var o,g,y=new adt,x=new adt,b=0,_=(e-t)/n;for(g=0;g<=i;g++){var w=[],S=g/i,M=S*(e-t)+t;for(o=0;o<=r;o++){var E=o/r,A=E*s+a,T=Math.sin(A),C=Math.cos(A);x.x=M*T,x.y=-S*n+m,x.z=M*C,l.push(x.x,x.y,x.z),y.set(T,_,C).normalize(),h.push(y.x,y.y,y.z),f.push(E,1-S),w.push(p++)}d.push(w)}for(o=0;o<r;o++)for(g=0;g<i;g++){var O=d[g][o],k=d[g+1][o],P=d[g+1][o+1],L=d[g][o+1];c.push(O,k,L),c.push(k,P,L),b+=6}u.addGroup(v,b,0),v+=b}(),!1===o&&(t>0&&g(!0),e>0&&g(!1)),this.setIndex(c),this.setAttribute("position",new zmt(l,3)),this.setAttribute("normal",new zmt(h,3)),this.setAttribute("uv",new zmt(f,2))}function $bt(t,e,n,r,i,o,a){qbt.call(this,0,t,e,n,r,i,o,a),this.type="ConeGeometry",this.parameters={radius:t,height:e,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:o,thetaLength:a}}function Kbt(t,e,n,r,i,o,a){Zbt.call(this,0,t,e,n,r,i,o,a),this.type="ConeBufferGeometry",this.parameters={radius:t,height:e,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:o,thetaLength:a}}function Jbt(t,e,n,r){wvt.call(this),this.type="CircleGeometry",this.parameters={radius:t,segments:e,thetaStart:n,thetaLength:r},this.fromBufferGeometry(new Qbt(t,e,n,r)),this.mergeVertices()}function Qbt(t,e,n,r){Kmt.call(this),this.type="CircleBufferGeometry",this.parameters={radius:t,segments:e,thetaStart:n,thetaLength:r},t=t||1,e=void 0!==e?Math.max(3,e):8,n=void 0!==n?n:0,r=void 0!==r?r:2*Math.PI;var i,o,a=[],s=[],u=[],c=[],l=new adt,h=new Zpt;for(s.push(0,0,0),u.push(0,0,1),c.push(.5,.5),o=0,i=3;o<=e;o++,i+=3){var f=n+o/e*r;l.x=t*Math.cos(f),l.y=t*Math.sin(f),s.push(l.x,l.y,l.z),u.push(0,0,1),h.x=(s[i]/t+1)/2,h.y=(s[i+1]/t+1)/2,c.push(h.x,h.y)}for(i=1;i<=e;i++)a.push(i,i+1,0);this.setIndex(a),this.setAttribute("position",new zmt(s,3)),this.setAttribute("normal",new zmt(u,3)),this.setAttribute("uv",new zmt(c,2))}Dbt.prototype=Object.create(wvt.prototype),Dbt.prototype.constructor=Dbt,Fbt.prototype=Object.create(Rbt.prototype),Fbt.prototype.constructor=Fbt,jbt.prototype=Object.create(wvt.prototype),jbt.prototype.constructor=jbt,Bbt.prototype=Object.create(Kmt.prototype),Bbt.prototype.constructor=Bbt,zbt.prototype=Object.create(wvt.prototype),zbt.prototype.constructor=zbt,Ubt.prototype=Object.create(Kmt.prototype),Ubt.prototype.constructor=Ubt,Vbt.prototype=Object.create(wvt.prototype),Vbt.prototype.constructor=Vbt,Gbt.prototype=Object.create(Kmt.prototype),Gbt.prototype.constructor=Gbt,Wbt.prototype=Object.create(wvt.prototype),Wbt.prototype.constructor=Wbt,Wbt.prototype.toJSON=function(){var t=wvt.prototype.toJSON.call(this);return Ybt(this.parameters.shapes,t)},Hbt.prototype=Object.create(Kmt.prototype),Hbt.prototype.constructor=Hbt,Hbt.prototype.toJSON=function(){var t=Kmt.prototype.toJSON.call(this);return Ybt(this.parameters.shapes,t)},Xbt.prototype=Object.create(Kmt.prototype),Xbt.prototype.constructor=Xbt,qbt.prototype=Object.create(wvt.prototype),qbt.prototype.constructor=qbt,Zbt.prototype=Object.create(Kmt.prototype),Zbt.prototype.constructor=Zbt,$bt.prototype=Object.create(qbt.prototype),$bt.prototype.constructor=$bt,Kbt.prototype=Object.create(Zbt.prototype),Kbt.prototype.constructor=Kbt,Jbt.prototype=Object.create(wvt.prototype),Jbt.prototype.constructor=Jbt,Qbt.prototype=Object.create(Kmt.prototype),Qbt.prototype.constructor=Qbt;var t_t=Object.freeze({__proto__:null,WireframeGeometry:Vxt,ParametricGeometry:Gxt,ParametricBufferGeometry:Wxt,TetrahedronGeometry:Xxt,TetrahedronBufferGeometry:qxt,OctahedronGeometry:Zxt,OctahedronBufferGeometry:$xt,IcosahedronGeometry:Kxt,IcosahedronBufferGeometry:Jxt,DodecahedronGeometry:Qxt,DodecahedronBufferGeometry:tbt,PolyhedronGeometry:Hxt,PolyhedronBufferGeometry:Yxt,TubeGeometry:ebt,TubeBufferGeometry:nbt,TorusKnotGeometry:rbt,TorusKnotBufferGeometry:ibt,TorusGeometry:obt,TorusBufferGeometry:abt,TextGeometry:Dbt,TextBufferGeometry:Fbt,SphereGeometry:jbt,SphereBufferGeometry:Bbt,RingGeometry:zbt,RingBufferGeometry:Ubt,PlaneGeometry:zvt,PlaneBufferGeometry:Uvt,LatheGeometry:Vbt,LatheBufferGeometry:Gbt,ShapeGeometry:Wbt,ShapeBufferGeometry:Hbt,ExtrudeGeometry:Lbt,ExtrudeBufferGeometry:Rbt,EdgesGeometry:Xbt,ConeGeometry:$bt,ConeBufferGeometry:Kbt,CylinderGeometry:qbt,CylinderBufferGeometry:Zbt,CircleGeometry:Jbt,CircleBufferGeometry:Qbt,BoxGeometry:class extends wvt{constructor(t,e,n,r,i,o){super(),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:r,heightSegments:i,depthSegments:o},this.fromBufferGeometry(new Svt(t,e,n,r,i,o)),this.mergeVertices()}},BoxBufferGeometry:Svt});function e_t(t){Omt.call(this),this.type="ShadowMaterial",this.color=new Smt(0),this.transparent=!0,this.setValues(t)}function n_t(t){Tvt.call(this,t),this.type="RawShaderMaterial"}function r_t(t){Omt.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Smt(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Smt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Zpt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.vertexTangents=!1,this.setValues(t)}function i_t(t){r_t.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Zpt(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,this.sheen=null,this.transparency=0,this.setValues(t)}function o_t(t){Omt.call(this),this.type="MeshPhongMaterial",this.color=new Smt(16777215),this.specular=new Smt(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Smt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Zpt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function a_t(t){Omt.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Smt(16777215),this.specular=new Smt(1118481),this.shininess=30,this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Smt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Zpt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function s_t(t){Omt.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Zpt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function u_t(t){Omt.call(this),this.type="MeshLambertMaterial",this.color=new Smt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Smt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function c_t(t){Omt.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Smt(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Zpt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function l_t(t){bxt.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}e_t.prototype=Object.create(Omt.prototype),e_t.prototype.constructor=e_t,e_t.prototype.isShadowMaterial=!0,e_t.prototype.copy=function(t){return Omt.prototype.copy.call(this,t),this.color.copy(t.color),this},n_t.prototype=Object.create(Tvt.prototype),n_t.prototype.constructor=n_t,n_t.prototype.isRawShaderMaterial=!0,r_t.prototype=Object.create(Omt.prototype),r_t.prototype.constructor=r_t,r_t.prototype.isMeshStandardMaterial=!0,r_t.prototype.copy=function(t){return Omt.prototype.copy.call(this,t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.vertexTangents=t.vertexTangents,this},i_t.prototype=Object.create(r_t.prototype),i_t.prototype.constructor=i_t,i_t.prototype.isMeshPhysicalMaterial=!0,i_t.prototype.copy=function(t){return r_t.prototype.copy.call(this,t),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=t.clearcoat,this.clearcoatMap=t.clearcoatMap,this.clearcoatRoughness=t.clearcoatRoughness,this.clearcoatRoughnessMap=t.clearcoatRoughnessMap,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.reflectivity=t.reflectivity,t.sheen?this.sheen=(this.sheen||new Smt).copy(t.sheen):this.sheen=null,this.transparency=t.transparency,this},o_t.prototype=Object.create(Omt.prototype),o_t.prototype.constructor=o_t,o_t.prototype.isMeshPhongMaterial=!0,o_t.prototype.copy=function(t){return Omt.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},a_t.prototype=Object.create(Omt.prototype),a_t.prototype.constructor=a_t,a_t.prototype.isMeshToonMaterial=!0,a_t.prototype.copy=function(t){return Omt.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.gradientMap=t.gradientMap,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},s_t.prototype=Object.create(Omt.prototype),s_t.prototype.constructor=s_t,s_t.prototype.isMeshNormalMaterial=!0,s_t.prototype.copy=function(t){return Omt.prototype.copy.call(this,t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},u_t.prototype=Object.create(Omt.prototype),u_t.prototype.constructor=u_t,u_t.prototype.isMeshLambertMaterial=!0,u_t.prototype.copy=function(t){return Omt.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},c_t.prototype=Object.create(Omt.prototype),c_t.prototype.constructor=c_t,c_t.prototype.isMeshMatcapMaterial=!0,c_t.prototype.copy=function(t){return Omt.prototype.copy.call(this,t),this.defines={MATCAP:""},this.color.copy(t.color),this.matcap=t.matcap,this.map=t.map,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},l_t.prototype=Object.create(bxt.prototype),l_t.prototype.constructor=l_t,l_t.prototype.isLineDashedMaterial=!0,l_t.prototype.copy=function(t){return bxt.prototype.copy.call(this,t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this};var h_t=Object.freeze({__proto__:null,ShadowMaterial:e_t,SpriteMaterial:Yyt,RawShaderMaterial:n_t,ShaderMaterial:Tvt,PointsMaterial:Pxt,MeshPhysicalMaterial:i_t,MeshStandardMaterial:r_t,MeshPhongMaterial:o_t,MeshToonMaterial:a_t,MeshNormalMaterial:s_t,MeshLambertMaterial:u_t,MeshDepthMaterial:kyt,MeshDistanceMaterial:Pyt,MeshBasicMaterial:kmt,MeshMatcapMaterial:c_t,LineDashedMaterial:l_t,LineBasicMaterial:bxt,Material:Omt}),f_t={arraySlice:function(t,e,n){return f_t.isTypedArray(t)?new t.constructor(t.subarray(e,void 0!==n?n:t.length)):t.slice(e,n)},convertArray:function(t,e,n){return!t||!n&&t.constructor===e?t:"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){for(var e=t.length,n=new Array(e),r=0;r!==e;++r)n[r]=r;return n.sort((function(e,n){return t[e]-t[n]})),n},sortedArray:function(t,e,n){for(var r=t.length,i=new t.constructor(r),o=0,a=0;a!==r;++o)for(var s=n[o]*e,u=0;u!==e;++u)i[a++]=t[s+u];return i},flattenJSON:function(t,e,n,r){for(var i=1,o=t[0];void 0!==o&&void 0===o[r];)o=t[i++];if(void 0!==o){var a=o[r];if(void 0!==a)if(Array.isArray(a))do{void 0!==(a=o[r])&&(e.push(o.time),n.push.apply(n,a)),o=t[i++]}while(void 0!==o);else if(void 0!==a.toArray)do{void 0!==(a=o[r])&&(e.push(o.time),a.toArray(n,n.length)),o=t[i++]}while(void 0!==o);else do{void 0!==(a=o[r])&&(e.push(o.time),n.push(a)),o=t[i++]}while(void 0!==o)}},subclip:function(t,e,n,r,i){i=i||30;var o=t.clone();o.name=e;for(var a=[],s=0;s<o.tracks.length;++s){for(var u=o.tracks[s],c=u.getValueSize(),l=[],h=[],f=0;f<u.times.length;++f){var p=u.times[f]*i;if(!(p<n||p>=r)){l.push(u.times[f]);for(var d=0;d<c;++d)h.push(u.values[f*c+d])}}0!==l.length&&(u.times=f_t.convertArray(l,u.times.constructor),u.values=f_t.convertArray(h,u.values.constructor),a.push(u))}o.tracks=a;var m=1/0;for(s=0;s<o.tracks.length;++s)m>o.tracks[s].times[0]&&(m=o.tracks[s].times[0]);for(s=0;s<o.tracks.length;++s)o.tracks[s].shift(-1*m);return o.resetDuration(),o}};function p_t(t,e,n,r){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new e.constructor(n),this.sampleValues=e,this.valueSize=n}function d_t(t,e,n,r){p_t.call(this,t,e,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function m_t(t,e,n,r){p_t.call(this,t,e,n,r)}function v_t(t,e,n,r){p_t.call(this,t,e,n,r)}function g_t(t,e,n,r){if(void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=f_t.convertArray(e,this.TimeBufferType),this.values=f_t.convertArray(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}function y_t(t,e,n){g_t.call(this,t,e,n)}function x_t(t,e,n,r){g_t.call(this,t,e,n,r)}function b_t(t,e,n,r){g_t.call(this,t,e,n,r)}function __t(t,e,n,r){p_t.call(this,t,e,n,r)}function w_t(t,e,n,r){g_t.call(this,t,e,n,r)}function S_t(t,e,n,r){g_t.call(this,t,e,n,r)}function M_t(t,e,n,r){g_t.call(this,t,e,n,r)}function E_t(t,e,n){this.name=t,this.tracks=n,this.duration=void 0!==e?e:-1,this.uuid=qpt.generateUUID(),this.duration<0&&this.resetDuration()}function A_t(t){if(void 0===t.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var e=function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return b_t;case"vector":case"vector2":case"vector3":case"vector4":return M_t;case"color":return x_t;case"quaternion":return w_t;case"bool":case"boolean":return y_t;case"string":return S_t}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}(t.type);if(void 0===t.times){var n=[],r=[];f_t.flattenJSON(t.keys,n,r,"value"),t.times=n,t.values=r}return void 0!==e.parse?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}Object.assign(p_t.prototype,{evaluate:function(t){var e=this.parameterPositions,n=this._cachedIndex,r=e[n],i=e[n-1];t:{e:{var o;n:{r:if(!(t<r)){for(var a=n+2;;){if(void 0===r){if(t<i)break r;return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,t,i)}if(n===a)break;if(i=r,t<(r=e[++n]))break e}o=e.length;break n}if(t>=i)break t;var s=e[1];t<s&&(n=2,i=s);for(a=n-2;;){if(void 0===i)return this._cachedIndex=0,this.beforeStart_(0,t,r);if(n===a)break;if(r=i,t>=(i=e[--n-1]))break e}o=n,n=0}for(;n<o;){var u=n+o>>>1;t<e[u]?o=u:n=u+1}if(r=e[n],void 0===(i=e[n-1]))return this._cachedIndex=0,this.beforeStart_(0,t,r);if(void 0===r)return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,i,t)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,t,r)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){for(var e=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=t*r,o=0;o!==r;++o)e[o]=n[i+o];return e},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(p_t.prototype,{beforeStart_:p_t.prototype.copySampleValue_,afterEnd_:p_t.prototype.copySampleValue_}),d_t.prototype=Object.assign(Object.create(p_t.prototype),{constructor:d_t,DefaultSettings_:{endingStart:Npt,endingEnd:Npt},intervalChanged_:function(t,e,n){var r=this.parameterPositions,i=t-2,o=t+1,a=r[i],s=r[o];if(void 0===a)switch(this.getSettings_().endingStart){case Dpt:i=t,a=2*e-n;break;case Fpt:a=e+r[i=r.length-2]-r[i+1];break;default:i=t,a=n}if(void 0===s)switch(this.getSettings_().endingEnd){case Dpt:o=t,s=2*n-e;break;case Fpt:o=1,s=n+r[1]-r[0];break;default:o=t-1,s=e}var u=.5*(n-e),c=this.valueSize;this._weightPrev=u/(e-a),this._weightNext=u/(s-n),this._offsetPrev=i*c,this._offsetNext=o*c},interpolate_:function(t,e,n,r){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=t*a,u=s-a,c=this._offsetPrev,l=this._offsetNext,h=this._weightPrev,f=this._weightNext,p=(n-e)/(r-e),d=p*p,m=d*p,v=-h*m+2*h*d-h*p,g=(1+h)*m+(-1.5-2*h)*d+(-.5+h)*p+1,y=(-1-f)*m+(1.5+f)*d+.5*p,x=f*m-f*d,b=0;b!==a;++b)i[b]=v*o[c+b]+g*o[u+b]+y*o[s+b]+x*o[l+b];return i}}),m_t.prototype=Object.assign(Object.create(p_t.prototype),{constructor:m_t,interpolate_:function(t,e,n,r){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=t*a,u=s-a,c=(n-e)/(r-e),l=1-c,h=0;h!==a;++h)i[h]=o[u+h]*l+o[s+h]*c;return i}}),v_t.prototype=Object.assign(Object.create(p_t.prototype),{constructor:v_t,interpolate_:function(t){return this.copySampleValue_(t-1)}}),Object.assign(g_t,{toJSON:function(t){var e,n=t.constructor;if(void 0!==n.toJSON)e=n.toJSON(t);else{e={name:t.name,times:f_t.convertArray(t.times,Array),values:f_t.convertArray(t.values,Array)};var r=t.getInterpolation();r!==t.DefaultInterpolation&&(e.interpolation=r)}return e.type=t.ValueTypeName,e}}),Object.assign(g_t.prototype,{constructor:g_t,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:Rpt,InterpolantFactoryMethodDiscrete:function(t){return new v_t(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodLinear:function(t){return new m_t(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:function(t){return new d_t(this.times,this.values,this.getValueSize(),t)},setInterpolation:function(t){var e;switch(t){case Lpt:e=this.InterpolantFactoryMethodDiscrete;break;case Rpt:e=this.InterpolantFactoryMethodLinear;break;case Ipt:e=this.InterpolantFactoryMethodSmooth}if(void 0===e){var n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return this}return this.createInterpolant=e,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Lpt;case this.InterpolantFactoryMethodLinear:return Rpt;case this.InterpolantFactoryMethodSmooth:return Ipt}},getValueSize:function(){return this.values.length/this.times.length},shift:function(t){if(0!==t)for(var e=this.times,n=0,r=e.length;n!==r;++n)e[n]+=t;return this},scale:function(t){if(1!==t)for(var e=this.times,n=0,r=e.length;n!==r;++n)e[n]*=t;return this},trim:function(t,e){for(var n=this.times,r=n.length,i=0,o=r-1;i!==r&&n[i]<t;)++i;for(;-1!==o&&n[o]>e;)--o;if(++o,0!==i||o!==r){i>=o&&(i=(o=Math.max(o,1))-1);var a=this.getValueSize();this.times=f_t.arraySlice(n,i,o),this.values=f_t.arraySlice(this.values,i*a,o*a)}return this},validate:function(){var t=!0,e=this.getValueSize();e-Math.floor(e)!=0&&(t=!1);var n=this.times,r=this.values,i=n.length;0===i&&(t=!1);for(var o=null,a=0;a!==i;a++){var s=n[a];if("number"==typeof s&&isNaN(s)){t=!1;break}if(null!==o&&o>s){t=!1;break}o=s}if(void 0!==r&&f_t.isTypedArray(r)){a=0;for(var u=r.length;a!==u;++a){var c=r[a];if(isNaN(c)){t=!1;break}}}return t},optimize:function(){for(var t=f_t.arraySlice(this.times),e=f_t.arraySlice(this.values),n=this.getValueSize(),r=this.getInterpolation()===Ipt,i=1,o=t.length-1,a=1;a<o;++a){var s=!1,u=t[a];if(u!==t[a+1]&&(1!==a||u!==u[0]))if(r)s=!0;else for(var c=a*n,l=c-n,h=c+n,f=0;f!==n;++f){var p=e[c+f];if(p!==e[l+f]||p!==e[h+f]){s=!0;break}}if(s){if(a!==i){t[i]=t[a];var d=a*n,m=i*n;for(f=0;f!==n;++f)e[m+f]=e[d+f]}++i}}if(o>0){t[i]=t[o];for(d=o*n,m=i*n,f=0;f!==n;++f)e[m+f]=e[d+f];++i}return i!==t.length?(this.times=f_t.arraySlice(t,0,i),this.values=f_t.arraySlice(e,0,i*n)):(this.times=t,this.values=e),this},clone:function(){var t=f_t.arraySlice(this.times,0),e=f_t.arraySlice(this.values,0),n=new(0,this.constructor)(this.name,t,e);return n.createInterpolant=this.createInterpolant,n}}),y_t.prototype=Object.assign(Object.create(g_t.prototype),{constructor:y_t,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:Lpt,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),x_t.prototype=Object.assign(Object.create(g_t.prototype),{constructor:x_t,ValueTypeName:"color"}),b_t.prototype=Object.assign(Object.create(g_t.prototype),{constructor:b_t,ValueTypeName:"number"}),__t.prototype=Object.assign(Object.create(p_t.prototype),{constructor:__t,interpolate_:function(t,e,n,r){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=t*a,u=(n-e)/(r-e),c=s+a;s!==c;s+=4)rdt.slerpFlat(i,0,o,s-a,o,s,u);return i}}),w_t.prototype=Object.assign(Object.create(g_t.prototype),{constructor:w_t,ValueTypeName:"quaternion",DefaultInterpolation:Rpt,InterpolantFactoryMethodLinear:function(t){return new __t(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:void 0}),S_t.prototype=Object.assign(Object.create(g_t.prototype),{constructor:S_t,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:Lpt,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),M_t.prototype=Object.assign(Object.create(g_t.prototype),{constructor:M_t,ValueTypeName:"vector"}),Object.assign(E_t,{parse:function(t){for(var e=[],n=t.tracks,r=1/(t.fps||1),i=0,o=n.length;i!==o;++i)e.push(A_t(n[i]).scale(r));return new E_t(t.name,t.duration,e)},toJSON:function(t){for(var e=[],n=t.tracks,r={name:t.name,duration:t.duration,tracks:e,uuid:t.uuid},i=0,o=n.length;i!==o;++i)e.push(g_t.toJSON(n[i]));return r},CreateFromMorphTargetSequence:function(t,e,n,r){for(var i=e.length,o=[],a=0;a<i;a++){var s=[],u=[];s.push((a+i-1)%i,a,(a+1)%i),u.push(0,1,0);var c=f_t.getKeyframeOrder(s);s=f_t.sortedArray(s,1,c),u=f_t.sortedArray(u,1,c),r||0!==s[0]||(s.push(i),u.push(u[0])),o.push(new b_t(".morphTargetInfluences["+e[a].name+"]",s,u).scale(1/n))}return new E_t(t,-1,o)},findByName:function(t,e){var n=t;if(!Array.isArray(t)){var r=t;n=r.geometry&&r.geometry.animations||r.animations}for(var i=0;i<n.length;i++)if(n[i].name===e)return n[i];return null},CreateClipsFromMorphTargetSequences:function(t,e,n){for(var r={},i=/^([\w-]*?)([\d]+)$/,o=0,a=t.length;o<a;o++){var s=t[o],u=s.name.match(i);if(u&&u.length>1){var c=r[h=u[1]];c||(r[h]=c=[]),c.push(s)}}var l=[];for(var h in r)l.push(E_t.CreateFromMorphTargetSequence(h,r[h],e,n));return l},parseAnimation:function(t,e){if(!t)return null;for(var n=function(t,e,n,r,i){if(0!==n.length){var o=[],a=[];f_t.flattenJSON(n,o,a,r),0!==o.length&&i.push(new t(e,o,a))}},r=[],i=t.name||"default",o=t.length||-1,a=t.fps||30,s=t.hierarchy||[],u=0;u<s.length;u++){var c=s[u].keys;if(c&&0!==c.length)if(c[0].morphTargets){for(var l={},h=0;h<c.length;h++)if(c[h].morphTargets)for(var f=0;f<c[h].morphTargets.length;f++)l[c[h].morphTargets[f]]=-1;for(var p in l){var d=[],m=[];for(f=0;f!==c[h].morphTargets.length;++f){var v=c[h];d.push(v.time),m.push(v.morphTarget===p?1:0)}r.push(new b_t(".morphTargetInfluence["+p+"]",d,m))}o=l.length*(a||1)}else{var g=".bones["+e[u].name+"]";n(M_t,g+".position",c,"pos",r),n(w_t,g+".quaternion",c,"rot",r),n(M_t,g+".scale",c,"scl",r)}}return 0===r.length?null:new E_t(i,o,r)}}),Object.assign(E_t.prototype,{resetDuration:function(){for(var t=0,e=0,n=this.tracks.length;e!==n;++e){var r=this.tracks[e];t=Math.max(t,r.times[r.times.length-1])}return this.duration=t,this},trim:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},validate:function(){for(var t=!0,e=0;e<this.tracks.length;e++)t=t&&this.tracks[e].validate();return t},optimize:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this},clone:function(){for(var t=[],e=0;e<this.tracks.length;e++)t.push(this.tracks[e].clone());return new E_t(this.name,this.duration,t)}});var T_t={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};function C_t(t,e,n){var r=this,i=!1,o=0,a=0,s=void 0,u=[];this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=n,this.itemStart=function(t){a++,!1===i&&void 0!==r.onStart&&r.onStart(t,o,a),i=!0},this.itemEnd=function(t){o++,void 0!==r.onProgress&&r.onProgress(t,o,a),o===a&&(i=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(t){void 0!==r.onError&&r.onError(t)},this.resolveURL=function(t){return s?s(t):t},this.setURLModifier=function(t){return s=t,this},this.addHandler=function(t,e){return u.push(t,e),this},this.removeHandler=function(t){var e=u.indexOf(t);return-1!==e&&u.splice(e,2),this},this.getHandler=function(t){for(var e=0,n=u.length;e<n;e+=2){var r=u[e],i=u[e+1];if(r.global&&(r.lastIndex=0),r.test(t))return i}return null}}var O_t=new C_t;function k_t(t){this.manager=void 0!==t?t:O_t,this.crossOrigin="anonymous",this.path="",this.resourcePath=""}Object.assign(k_t.prototype,{load:function(){},parse:function(){},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this},setResourcePath:function(t){return this.resourcePath=t,this}});var P_t={};function L_t(t){k_t.call(this,t)}function R_t(t){k_t.call(this,t)}function I_t(t){k_t.call(this,t)}function N_t(t){k_t.call(this,t)}function D_t(t){k_t.call(this,t)}function F_t(t){k_t.call(this,t)}function j_t(t){k_t.call(this,t)}function B_t(){this.type="Curve",this.arcLengthDivisions=200}function z_t(t,e,n,r,i,o,a,s){B_t.call(this),this.type="EllipseCurve",this.aX=t||0,this.aY=e||0,this.xRadius=n||1,this.yRadius=r||1,this.aStartAngle=i||0,this.aEndAngle=o||2*Math.PI,this.aClockwise=a||!1,this.aRotation=s||0}function U_t(t,e,n,r,i,o){z_t.call(this,t,e,n,n,r,i,o),this.type="ArcCurve"}function V_t(){var t=0,e=0,n=0,r=0;function i(i,o,a,s){t=i,e=a,n=-3*i+3*o-2*a-s,r=2*i-2*o+a+s}return{initCatmullRom:function(t,e,n,r,o){i(e,n,o*(n-t),o*(r-e))},initNonuniformCatmullRom:function(t,e,n,r,o,a,s){var u=(e-t)/o-(n-t)/(o+a)+(n-e)/a,c=(n-e)/a-(r-e)/(a+s)+(r-n)/s;i(e,n,u*=a,c*=a)},calc:function(i){var o=i*i;return t+e*i+n*o+r*(o*i)}}}L_t.prototype=Object.assign(Object.create(k_t.prototype),{constructor:L_t,load:function(t,e,n,r){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var i=this,o=T_t.get(t);if(void 0!==o)return i.manager.itemStart(t),setTimeout((function(){e&&e(o),i.manager.itemEnd(t)}),0),o;if(void 0===P_t[t]){var a=t.match(/^data:(.*?)(;base64)?,(.*)$/);if(a){var s=a[1],u=!!a[2],c=a[3];c=decodeURIComponent(c),u&&(c=atob(c));try{var l,h=(this.responseType||"").toLowerCase();switch(h){case"arraybuffer":case"blob":for(var f=new Uint8Array(c.length),p=0;p<c.length;p++)f[p]=c.charCodeAt(p);l="blob"===h?new Blob([f.buffer],{type:s}):f.buffer;break;case"document":var d=new DOMParser;l=d.parseFromString(c,s);break;case"json":l=JSON.parse(c);break;default:l=c}setTimeout((function(){e&&e(l),i.manager.itemEnd(t)}),0)}catch(g){setTimeout((function(){r&&r(g),i.manager.itemError(t),i.manager.itemEnd(t)}),0)}}else{P_t[t]=[],P_t[t].push({onLoad:e,onProgress:n,onError:r});var m=new XMLHttpRequest;for(var v in m.open("GET",t,!0),m.addEventListener("load",(function(e){var n=this.response,r=P_t[t];if(delete P_t[t],200===this.status||0===this.status){this.status,T_t.add(t,n);for(var o=0,a=r.length;o<a;o++){(s=r[o]).onLoad&&s.onLoad(n)}i.manager.itemEnd(t)}else{for(o=0,a=r.length;o<a;o++){var s;(s=r[o]).onError&&s.onError(e)}i.manager.itemError(t),i.manager.itemEnd(t)}}),!1),m.addEventListener("progress",(function(e){for(var n=P_t[t],r=0,i=n.length;r<i;r++){var o=n[r];o.onProgress&&o.onProgress(e)}}),!1),m.addEventListener("error",(function(e){var n=P_t[t];delete P_t[t];for(var r=0,o=n.length;r<o;r++){var a=n[r];a.onError&&a.onError(e)}i.manager.itemError(t),i.manager.itemEnd(t)}),!1),m.addEventListener("abort",(function(e){var n=P_t[t];delete P_t[t];for(var r=0,o=n.length;r<o;r++){var a=n[r];a.onError&&a.onError(e)}i.manager.itemError(t),i.manager.itemEnd(t)}),!1),void 0!==this.responseType&&(m.responseType=this.responseType),void 0!==this.withCredentials&&(m.withCredentials=this.withCredentials),m.overrideMimeType&&m.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)m.setRequestHeader(v,this.requestHeader[v]);m.send(null)}return i.manager.itemStart(t),m}P_t[t].push({onLoad:e,onProgress:n,onError:r})},setResponseType:function(t){return this.responseType=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setMimeType:function(t){return this.mimeType=t,this},setRequestHeader:function(t){return this.requestHeader=t,this}}),R_t.prototype=Object.assign(Object.create(k_t.prototype),{constructor:R_t,load:function(t,e,n,r){var i=this,o=new L_t(i.manager);o.setPath(i.path),o.load(t,(function(t){e(i.parse(JSON.parse(t)))}),n,r)},parse:function(t){for(var e=[],n=0;n<t.length;n++){var r=E_t.parse(t[n]);e.push(r)}return e}}),I_t.prototype=Object.assign(Object.create(k_t.prototype),{constructor:I_t,load:function(t,e,n,r){var i=this,o=[],a=new Bxt;a.image=o;var s=new L_t(this.manager);function u(u){s.load(t[u],(function(t){var n=i.parse(t,!0);o[u]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},6===(c+=1)&&(1===n.mipmapCount&&(a.minFilter=bpt),a.format=n.format,a.needsUpdate=!0,e&&e(a))}),n,r)}if(s.setPath(this.path),s.setResponseType("arraybuffer"),Array.isArray(t))for(var c=0,l=0,h=t.length;l<h;++l)u(l);else s.load(t,(function(t){var n=i.parse(t,!0);if(n.isCubemap)for(var r=n.mipmaps.length/n.mipmapCount,s=0;s<r;s++){o[s]={mipmaps:[]};for(var u=0;u<n.mipmapCount;u++)o[s].mipmaps.push(n.mipmaps[s*n.mipmapCount+u]),o[s].format=n.format,o[s].width=n.width,o[s].height=n.height}else a.image.width=n.width,a.image.height=n.height,a.mipmaps=n.mipmaps;1===n.mipmapCount&&(a.minFilter=bpt),a.format=n.format,a.needsUpdate=!0,e&&e(a)}),n,r);return a}}),N_t.prototype=Object.assign(Object.create(k_t.prototype),{constructor:N_t,load:function(t,e,n,r){var i=this,o=new Rvt,a=new L_t(this.manager);return a.setResponseType("arraybuffer"),a.setPath(this.path),a.load(t,(function(t){var n=i.parse(t);n&&(void 0!==n.image?o.image=n.image:void 0!==n.data&&(o.image.width=n.width,o.image.height=n.height,o.image.data=n.data),o.wrapS=void 0!==n.wrapS?n.wrapS:mpt,o.wrapT=void 0!==n.wrapT?n.wrapT:mpt,o.magFilter=void 0!==n.magFilter?n.magFilter:bpt,o.minFilter=void 0!==n.minFilter?n.minFilter:bpt,o.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.format&&(o.format=n.format),void 0!==n.type&&(o.type=n.type),void 0!==n.mipmaps&&(o.mipmaps=n.mipmaps,o.minFilter=_pt),1===n.mipmapCount&&(o.minFilter=bpt),o.needsUpdate=!0,e&&e(o,n))}),n,r),o}}),D_t.prototype=Object.assign(Object.create(k_t.prototype),{constructor:D_t,load:function(t,e,n,r){void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var i=this,o=T_t.get(t);if(void 0!==o)return i.manager.itemStart(t),setTimeout((function(){e&&e(o),i.manager.itemEnd(t)}),0),o;var a=document.createElementNS("http://www.w3.org/1999/xhtml","img");function s(){a.removeEventListener("load",s,!1),a.removeEventListener("error",u,!1),T_t.add(t,this),e&&e(this),i.manager.itemEnd(t)}function u(e){a.removeEventListener("load",s,!1),a.removeEventListener("error",u,!1),r&&r(e),i.manager.itemError(t),i.manager.itemEnd(t)}return a.addEventListener("load",s,!1),a.addEventListener("error",u,!1),"data:"!==t.substr(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),i.manager.itemStart(t),a.src=t,a}}),F_t.prototype=Object.assign(Object.create(k_t.prototype),{constructor:F_t,load:function(t,e,n,r){var i=new egt,o=new D_t(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);var a=0;function s(n){o.load(t[n],(function(t){i.images[n]=t,6===++a&&(i.needsUpdate=!0,e&&e(i))}),void 0,r)}for(var u=0;u<t.length;++u)s(u);return i}}),j_t.prototype=Object.assign(Object.create(k_t.prototype),{constructor:j_t,load:function(t,e,n,r){var i=new Qpt,o=new D_t(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(t,(function(n){i.image=n;var r=t.search(/\.jpe?g($|\?)/i)>0||0===t.search(/^data\:image\/jpeg/);i.format=r?Cpt:Opt,i.needsUpdate=!0,void 0!==e&&e(i)}),n,r),i}}),Object.assign(B_t.prototype,{getPoint:function(){return null},getPointAt:function(t,e){var n=this.getUtoTmapping(t);return this.getPoint(n,e)},getPoints:function(t){void 0===t&&(t=5);for(var e=[],n=0;n<=t;n++)e.push(this.getPoint(n/t));return e},getSpacedPoints:function(t){void 0===t&&(t=5);for(var e=[],n=0;n<=t;n++)e.push(this.getPointAt(n/t));return e},getLength:function(){var t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(void 0===t&&(t=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var e,n,r=[],i=this.getPoint(0),o=0;for(r.push(0),n=1;n<=t;n++)o+=(e=this.getPoint(n/t)).distanceTo(i),r.push(o),i=e;return this.cacheArcLengths=r,r},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,e){var n,r=this.getLengths(),i=0,o=r.length;n=e||t*r[o-1];for(var a,s=0,u=o-1;s<=u;)if((a=r[i=Math.floor(s+(u-s)/2)]-n)<0)s=i+1;else{if(!(a>0)){u=i;break}u=i-1}if(r[i=u]===n)return i/(o-1);var c=r[i];return(i+(n-c)/(r[i+1]-c))/(o-1)},getTangent:function(t){var e=1e-4,n=t-e,r=t+e;n<0&&(n=0),r>1&&(r=1);var i=this.getPoint(n);return this.getPoint(r).clone().sub(i).normalize()},getTangentAt:function(t){var e=this.getUtoTmapping(t);return this.getTangent(e)},computeFrenetFrames:function(t,e){var n,r,i,o=new adt,a=[],s=[],u=[],c=new adt,l=new ddt;for(n=0;n<=t;n++)r=n/t,a[n]=this.getTangentAt(r),a[n].normalize();s[0]=new adt,u[0]=new adt;var h=Number.MAX_VALUE,f=Math.abs(a[0].x),p=Math.abs(a[0].y),d=Math.abs(a[0].z);for(f<=h&&(h=f,o.set(1,0,0)),p<=h&&(h=p,o.set(0,1,0)),d<=h&&o.set(0,0,1),c.crossVectors(a[0],o).normalize(),s[0].crossVectors(a[0],c),u[0].crossVectors(a[0],s[0]),n=1;n<=t;n++)s[n]=s[n-1].clone(),u[n]=u[n-1].clone(),c.crossVectors(a[n-1],a[n]),c.length()>Number.EPSILON&&(c.normalize(),i=Math.acos(qpt.clamp(a[n-1].dot(a[n]),-1,1)),s[n].applyMatrix4(l.makeRotationAxis(c,i))),u[n].crossVectors(a[n],s[n]);if(!0===e)for(i=Math.acos(qpt.clamp(s[0].dot(s[t]),-1,1)),i/=t,a[0].dot(c.crossVectors(s[0],s[t]))>0&&(i=-i),n=1;n<=t;n++)s[n].applyMatrix4(l.makeRotationAxis(a[n],i*n)),u[n].crossVectors(a[n],s[n]);return{tangents:a,normals:s,binormals:u}},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this},toJSON:function(){var t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t},fromJSON:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}),z_t.prototype=Object.create(B_t.prototype),z_t.prototype.constructor=z_t,z_t.prototype.isEllipseCurve=!0,z_t.prototype.getPoint=function(t,e){for(var n=e||new Zpt,r=2*Math.PI,i=this.aEndAngle-this.aStartAngle,o=Math.abs(i)<Number.EPSILON;i<0;)i+=r;for(;i>r;)i-=r;i<Number.EPSILON&&(i=o?0:r),!0!==this.aClockwise||o||(i===r?i=-r:i-=r);var a=this.aStartAngle+t*i,s=this.aX+this.xRadius*Math.cos(a),u=this.aY+this.yRadius*Math.sin(a);if(0!==this.aRotation){var c=Math.cos(this.aRotation),l=Math.sin(this.aRotation),h=s-this.aX,f=u-this.aY;s=h*c-f*l+this.aX,u=h*l+f*c+this.aY}return n.set(s,u)},z_t.prototype.copy=function(t){return B_t.prototype.copy.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},z_t.prototype.toJSON=function(){var t=B_t.prototype.toJSON.call(this);return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t},z_t.prototype.fromJSON=function(t){return B_t.prototype.fromJSON.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},U_t.prototype=Object.create(z_t.prototype),U_t.prototype.constructor=U_t,U_t.prototype.isArcCurve=!0;var G_t=new adt,W_t=new V_t,H_t=new V_t,Y_t=new V_t;function X_t(t,e,n,r){B_t.call(this),this.type="CatmullRomCurve3",this.points=t||[],this.closed=e||!1,this.curveType=n||"centripetal",this.tension=r||.5}function q_t(t,e,n,r,i){var o=.5*(r-e),a=.5*(i-n),s=t*t;return(2*n-2*r+o+a)*(t*s)+(-3*n+3*r-2*o-a)*s+o*t+n}function Z_t(t,e,n,r){return function(t,e){var n=1-t;return n*n*e}(t,e)+function(t,e){return 2*(1-t)*t*e}(t,n)+function(t,e){return t*t*e}(t,r)}function $_t(t,e,n,r,i){return function(t,e){var n=1-t;return n*n*n*e}(t,e)+function(t,e){var n=1-t;return 3*n*n*t*e}(t,n)+function(t,e){return 3*(1-t)*t*t*e}(t,r)+function(t,e){return t*t*t*e}(t,i)}function K_t(t,e,n,r){B_t.call(this),this.type="CubicBezierCurve",this.v0=t||new Zpt,this.v1=e||new Zpt,this.v2=n||new Zpt,this.v3=r||new Zpt}function J_t(t,e,n,r){B_t.call(this),this.type="CubicBezierCurve3",this.v0=t||new adt,this.v1=e||new adt,this.v2=n||new adt,this.v3=r||new adt}function Q_t(t,e){B_t.call(this),this.type="LineCurve",this.v1=t||new Zpt,this.v2=e||new Zpt}function twt(t,e){B_t.call(this),this.type="LineCurve3",this.v1=t||new adt,this.v2=e||new adt}function ewt(t,e,n){B_t.call(this),this.type="QuadraticBezierCurve",this.v0=t||new Zpt,this.v1=e||new Zpt,this.v2=n||new Zpt}function nwt(t,e,n){B_t.call(this),this.type="QuadraticBezierCurve3",this.v0=t||new adt,this.v1=e||new adt,this.v2=n||new adt}function rwt(t){B_t.call(this),this.type="SplineCurve",this.points=t||[]}X_t.prototype=Object.create(B_t.prototype),X_t.prototype.constructor=X_t,X_t.prototype.isCatmullRomCurve3=!0,X_t.prototype.getPoint=function(t,e){var n,r,i,o,a=e||new adt,s=this.points,u=s.length,c=(u-(this.closed?0:1))*t,l=Math.floor(c),h=c-l;if(this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/u)+1)*u:0===h&&l===u-1&&(l=u-2,h=1),this.closed||l>0?n=s[(l-1)%u]:(G_t.subVectors(s[0],s[1]).add(s[0]),n=G_t),r=s[l%u],i=s[(l+1)%u],this.closed||l+2<u?o=s[(l+2)%u]:(G_t.subVectors(s[u-1],s[u-2]).add(s[u-1]),o=G_t),"centripetal"===this.curveType||"chordal"===this.curveType){var f="chordal"===this.curveType?.5:.25,p=Math.pow(n.distanceToSquared(r),f),d=Math.pow(r.distanceToSquared(i),f),m=Math.pow(i.distanceToSquared(o),f);d<1e-4&&(d=1),p<1e-4&&(p=d),m<1e-4&&(m=d),W_t.initNonuniformCatmullRom(n.x,r.x,i.x,o.x,p,d,m),H_t.initNonuniformCatmullRom(n.y,r.y,i.y,o.y,p,d,m),Y_t.initNonuniformCatmullRom(n.z,r.z,i.z,o.z,p,d,m)}else"catmullrom"===this.curveType&&(W_t.initCatmullRom(n.x,r.x,i.x,o.x,this.tension),H_t.initCatmullRom(n.y,r.y,i.y,o.y,this.tension),Y_t.initCatmullRom(n.z,r.z,i.z,o.z,this.tension));return a.set(W_t.calc(h),H_t.calc(h),Y_t.calc(h)),a},X_t.prototype.copy=function(t){B_t.prototype.copy.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++){var r=t.points[e];this.points.push(r.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},X_t.prototype.toJSON=function(){var t=B_t.prototype.toJSON.call(this);t.points=[];for(var e=0,n=this.points.length;e<n;e++){var r=this.points[e];t.points.push(r.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t},X_t.prototype.fromJSON=function(t){B_t.prototype.fromJSON.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++){var r=t.points[e];this.points.push((new adt).fromArray(r))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},K_t.prototype=Object.create(B_t.prototype),K_t.prototype.constructor=K_t,K_t.prototype.isCubicBezierCurve=!0,K_t.prototype.getPoint=function(t,e){var n=e||new Zpt,r=this.v0,i=this.v1,o=this.v2,a=this.v3;return n.set($_t(t,r.x,i.x,o.x,a.x),$_t(t,r.y,i.y,o.y,a.y)),n},K_t.prototype.copy=function(t){return B_t.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},K_t.prototype.toJSON=function(){var t=B_t.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},K_t.prototype.fromJSON=function(t){return B_t.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},J_t.prototype=Object.create(B_t.prototype),J_t.prototype.constructor=J_t,J_t.prototype.isCubicBezierCurve3=!0,J_t.prototype.getPoint=function(t,e){var n=e||new adt,r=this.v0,i=this.v1,o=this.v2,a=this.v3;return n.set($_t(t,r.x,i.x,o.x,a.x),$_t(t,r.y,i.y,o.y,a.y),$_t(t,r.z,i.z,o.z,a.z)),n},J_t.prototype.copy=function(t){return B_t.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},J_t.prototype.toJSON=function(){var t=B_t.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},J_t.prototype.fromJSON=function(t){return B_t.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},Q_t.prototype=Object.create(B_t.prototype),Q_t.prototype.constructor=Q_t,Q_t.prototype.isLineCurve=!0,Q_t.prototype.getPoint=function(t,e){var n=e||new Zpt;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n},Q_t.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},Q_t.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()},Q_t.prototype.copy=function(t){return B_t.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Q_t.prototype.toJSON=function(){var t=B_t.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Q_t.prototype.fromJSON=function(t){return B_t.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},twt.prototype=Object.create(B_t.prototype),twt.prototype.constructor=twt,twt.prototype.isLineCurve3=!0,twt.prototype.getPoint=function(t,e){var n=e||new adt;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n},twt.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},twt.prototype.copy=function(t){return B_t.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},twt.prototype.toJSON=function(){var t=B_t.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},twt.prototype.fromJSON=function(t){return B_t.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},ewt.prototype=Object.create(B_t.prototype),ewt.prototype.constructor=ewt,ewt.prototype.isQuadraticBezierCurve=!0,ewt.prototype.getPoint=function(t,e){var n=e||new Zpt,r=this.v0,i=this.v1,o=this.v2;return n.set(Z_t(t,r.x,i.x,o.x),Z_t(t,r.y,i.y,o.y)),n},ewt.prototype.copy=function(t){return B_t.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},ewt.prototype.toJSON=function(){var t=B_t.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},ewt.prototype.fromJSON=function(t){return B_t.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},nwt.prototype=Object.create(B_t.prototype),nwt.prototype.constructor=nwt,nwt.prototype.isQuadraticBezierCurve3=!0,nwt.prototype.getPoint=function(t,e){var n=e||new adt,r=this.v0,i=this.v1,o=this.v2;return n.set(Z_t(t,r.x,i.x,o.x),Z_t(t,r.y,i.y,o.y),Z_t(t,r.z,i.z,o.z)),n},nwt.prototype.copy=function(t){return B_t.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},nwt.prototype.toJSON=function(){var t=B_t.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},nwt.prototype.fromJSON=function(t){return B_t.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},rwt.prototype=Object.create(B_t.prototype),rwt.prototype.constructor=rwt,rwt.prototype.isSplineCurve=!0,rwt.prototype.getPoint=function(t,e){var n=e||new Zpt,r=this.points,i=(r.length-1)*t,o=Math.floor(i),a=i-o,s=r[0===o?o:o-1],u=r[o],c=r[o>r.length-2?r.length-1:o+1],l=r[o>r.length-3?r.length-1:o+2];return n.set(q_t(a,s.x,u.x,c.x,l.x),q_t(a,s.y,u.y,c.y,l.y)),n},rwt.prototype.copy=function(t){B_t.prototype.copy.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++){var r=t.points[e];this.points.push(r.clone())}return this},rwt.prototype.toJSON=function(){var t=B_t.prototype.toJSON.call(this);t.points=[];for(var e=0,n=this.points.length;e<n;e++){var r=this.points[e];t.points.push(r.toArray())}return t},rwt.prototype.fromJSON=function(t){B_t.prototype.fromJSON.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++){var r=t.points[e];this.points.push((new Zpt).fromArray(r))}return this};var iwt=Object.freeze({__proto__:null,ArcCurve:U_t,CatmullRomCurve3:X_t,CubicBezierCurve:K_t,CubicBezierCurve3:J_t,EllipseCurve:z_t,LineCurve:Q_t,LineCurve3:twt,QuadraticBezierCurve:ewt,QuadraticBezierCurve3:nwt,SplineCurve:rwt});function owt(){B_t.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function awt(t){owt.call(this),this.type="Path",this.currentPoint=new Zpt,t&&this.setFromPoints(t)}function swt(t){awt.call(this,t),this.uuid=qpt.generateUUID(),this.type="Shape",this.holes=[]}function uwt(t,e){Ldt.call(this),this.type="Light",this.color=new Smt(t),this.intensity=void 0!==e?e:1,this.receiveShadow=void 0}function cwt(t,e,n){uwt.call(this,t,n),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(Ldt.DefaultUp),this.updateMatrix(),this.groundColor=new Smt(e)}function lwt(t){this.camera=t,this.bias=0,this.radius=1,this.mapSize=new Zpt(512,512),this.map=null,this.mapPass=null,this.matrix=new ddt,this._frustum=new Dvt,this._frameExtents=new Zpt(1,1),this._viewportCount=1,this._viewports=[new tdt(0,0,1,1)]}function hwt(){lwt.call(this,new Ovt(50,1,.5,500))}function fwt(t,e,n,r,i,o){uwt.call(this,t,e),this.type="SpotLight",this.position.copy(Ldt.DefaultUp),this.updateMatrix(),this.target=new Ldt,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(t){this.intensity=t/Math.PI}}),this.distance=void 0!==n?n:0,this.angle=void 0!==r?r:Math.PI/3,this.penumbra=void 0!==i?i:0,this.decay=void 0!==o?o:1,this.shadow=new hwt}function pwt(){lwt.call(this,new Ovt(90,1,.5,500)),this._frameExtents=new Zpt(4,2),this._viewportCount=6,this._viewports=[new tdt(2,1,1,1),new tdt(0,1,1,1),new tdt(3,1,1,1),new tdt(1,1,1,1),new tdt(3,0,1,1),new tdt(1,0,1,1)],this._cubeDirections=[new adt(1,0,0),new adt(-1,0,0),new adt(0,0,1),new adt(0,0,-1),new adt(0,1,0),new adt(0,-1,0)],this._cubeUps=[new adt(0,1,0),new adt(0,1,0),new adt(0,1,0),new adt(0,1,0),new adt(0,0,1),new adt(0,0,-1)]}function dwt(t,e,n,r){uwt.call(this,t,e),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(t){this.intensity=t/(4*Math.PI)}}),this.distance=void 0!==n?n:0,this.decay=void 0!==r?r:1,this.shadow=new pwt}function mwt(t,e,n,r,i,o){Cvt.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=void 0!==t?t:-1,this.right=void 0!==e?e:1,this.top=void 0!==n?n:1,this.bottom=void 0!==r?r:-1,this.near=void 0!==i?i:.1,this.far=void 0!==o?o:2e3,this.updateProjectionMatrix()}function vwt(){lwt.call(this,new mwt(-5,5,5,-5,.5,500))}function gwt(t,e){uwt.call(this,t,e),this.type="DirectionalLight",this.position.copy(Ldt.DefaultUp),this.updateMatrix(),this.target=new Ldt,this.shadow=new vwt}function ywt(t,e){uwt.call(this,t,e),this.type="AmbientLight",this.castShadow=void 0}function xwt(t,e,n,r){uwt.call(this,t,e),this.type="RectAreaLight",this.width=void 0!==n?n:10,this.height=void 0!==r?r:10}function bwt(t){k_t.call(this,t),this.textures={}}owt.prototype=Object.assign(Object.create(B_t.prototype),{constructor:owt,add:function(t){this.curves.push(t)},closePath:function(){var t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new Q_t(e,t))},getPoint:function(t){for(var e=t*this.getLength(),n=this.getCurveLengths(),r=0;r<n.length;){if(n[r]>=e){var i=n[r]-e,o=this.curves[r],a=o.getLength(),s=0===a?0:1-i/a;return o.getPointAt(s)}r++}return null},getLength:function(){var t=this.getCurveLengths();return t[t.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var t=[],e=0,n=0,r=this.curves.length;n<r;n++)e+=this.curves[n].getLength(),t.push(e);return this.cacheLengths=t,t},getSpacedPoints:function(t){void 0===t&&(t=40);for(var e=[],n=0;n<=t;n++)e.push(this.getPoint(n/t));return this.autoClose&&e.push(e[0]),e},getPoints:function(t){t=t||12;for(var e,n=[],r=0,i=this.curves;r<i.length;r++)for(var o=i[r],a=o&&o.isEllipseCurve?2*t:o&&(o.isLineCurve||o.isLineCurve3)?1:o&&o.isSplineCurve?t*o.points.length:t,s=o.getPoints(a),u=0;u<s.length;u++){var c=s[u];e&&e.equals(c)||(n.push(c),e=c)}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n},copy:function(t){B_t.prototype.copy.call(this,t),this.curves=[];for(var e=0,n=t.curves.length;e<n;e++){var r=t.curves[e];this.curves.push(r.clone())}return this.autoClose=t.autoClose,this},toJSON:function(){var t=B_t.prototype.toJSON.call(this);t.autoClose=this.autoClose,t.curves=[];for(var e=0,n=this.curves.length;e<n;e++){var r=this.curves[e];t.curves.push(r.toJSON())}return t},fromJSON:function(t){B_t.prototype.fromJSON.call(this,t),this.autoClose=t.autoClose,this.curves=[];for(var e=0,n=t.curves.length;e<n;e++){var r=t.curves[e];this.curves.push((new iwt[r.type]).fromJSON(r))}return this}}),awt.prototype=Object.assign(Object.create(owt.prototype),{constructor:awt,setFromPoints:function(t){this.moveTo(t[0].x,t[0].y);for(var e=1,n=t.length;e<n;e++)this.lineTo(t[e].x,t[e].y);return this},moveTo:function(t,e){return this.currentPoint.set(t,e),this},lineTo:function(t,e){var n=new Q_t(this.currentPoint.clone(),new Zpt(t,e));return this.curves.push(n),this.currentPoint.set(t,e),this},quadraticCurveTo:function(t,e,n,r){var i=new ewt(this.currentPoint.clone(),new Zpt(t,e),new Zpt(n,r));return this.curves.push(i),this.currentPoint.set(n,r),this},bezierCurveTo:function(t,e,n,r,i,o){var a=new K_t(this.currentPoint.clone(),new Zpt(t,e),new Zpt(n,r),new Zpt(i,o));return this.curves.push(a),this.currentPoint.set(i,o),this},splineThru:function(t){var e=new rwt([this.currentPoint.clone()].concat(t));return this.curves.push(e),this.currentPoint.copy(t[t.length-1]),this},arc:function(t,e,n,r,i,o){var a=this.currentPoint.x,s=this.currentPoint.y;return this.absarc(t+a,e+s,n,r,i,o),this},absarc:function(t,e,n,r,i,o){return this.absellipse(t,e,n,n,r,i,o),this},ellipse:function(t,e,n,r,i,o,a,s){var u=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(t+u,e+c,n,r,i,o,a,s),this},absellipse:function(t,e,n,r,i,o,a,s){var u=new z_t(t,e,n,r,i,o,a,s);if(this.curves.length>0){var c=u.getPoint(0);c.equals(this.currentPoint)||this.lineTo(c.x,c.y)}this.curves.push(u);var l=u.getPoint(1);return this.currentPoint.copy(l),this},copy:function(t){return owt.prototype.copy.call(this,t),this.currentPoint.copy(t.currentPoint),this},toJSON:function(){var t=owt.prototype.toJSON.call(this);return t.currentPoint=this.currentPoint.toArray(),t},fromJSON:function(t){return owt.prototype.fromJSON.call(this,t),this.currentPoint.fromArray(t.currentPoint),this}}),swt.prototype=Object.assign(Object.create(awt.prototype),{constructor:swt,getPointsHoles:function(t){for(var e=[],n=0,r=this.holes.length;n<r;n++)e[n]=this.holes[n].getPoints(t);return e},extractPoints:function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}},copy:function(t){awt.prototype.copy.call(this,t),this.holes=[];for(var e=0,n=t.holes.length;e<n;e++){var r=t.holes[e];this.holes.push(r.clone())}return this},toJSON:function(){var t=awt.prototype.toJSON.call(this);t.uuid=this.uuid,t.holes=[];for(var e=0,n=this.holes.length;e<n;e++){var r=this.holes[e];t.holes.push(r.toJSON())}return t},fromJSON:function(t){awt.prototype.fromJSON.call(this,t),this.uuid=t.uuid,this.holes=[];for(var e=0,n=t.holes.length;e<n;e++){var r=t.holes[e];this.holes.push((new awt).fromJSON(r))}return this}}),uwt.prototype=Object.assign(Object.create(Ldt.prototype),{constructor:uwt,isLight:!0,copy:function(t){return Ldt.prototype.copy.call(this,t),this.color.copy(t.color),this.intensity=t.intensity,this},toJSON:function(t){var e=Ldt.prototype.toJSON.call(this,t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(e.object.distance=this.distance),void 0!==this.angle&&(e.object.angle=this.angle),void 0!==this.decay&&(e.object.decay=this.decay),void 0!==this.penumbra&&(e.object.penumbra=this.penumbra),void 0!==this.shadow&&(e.object.shadow=this.shadow.toJSON()),e}}),cwt.prototype=Object.assign(Object.create(uwt.prototype),{constructor:cwt,isHemisphereLight:!0,copy:function(t){return uwt.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}}),Object.assign(lwt.prototype,{_projScreenMatrix:new ddt,_lightPositionWorld:new adt,_lookTarget:new adt,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},updateMatrices:function(t){var e=this.camera,n=this.matrix,r=this._projScreenMatrix,i=this._lookTarget,o=this._lightPositionWorld;o.setFromMatrixPosition(t.matrixWorld),e.position.copy(o),i.setFromMatrixPosition(t.target.matrixWorld),e.lookAt(i),e.updateMatrixWorld(),r.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromProjectionMatrix(r),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(e.projectionMatrix),n.multiply(e.matrixWorldInverse)},getViewport:function(t){return this._viewports[t]},getFrameExtents:function(){return this._frameExtents},copy:function(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var t={};return 0!==this.bias&&(t.bias=this.bias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}),hwt.prototype=Object.assign(Object.create(lwt.prototype),{constructor:hwt,isSpotLightShadow:!0,updateMatrices:function(t){var e=this.camera,n=2*qpt.RAD2DEG*t.angle,r=this.mapSize.width/this.mapSize.height,i=t.distance||e.far;n===e.fov&&r===e.aspect&&i===e.far||(e.fov=n,e.aspect=r,e.far=i,e.updateProjectionMatrix()),lwt.prototype.updateMatrices.call(this,t)}}),fwt.prototype=Object.assign(Object.create(uwt.prototype),{constructor:fwt,isSpotLight:!0,copy:function(t){return uwt.prototype.copy.call(this,t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),pwt.prototype=Object.assign(Object.create(lwt.prototype),{constructor:pwt,isPointLightShadow:!0,updateMatrices:function(t,e){void 0===e&&(e=0);var n=this.camera,r=this.matrix,i=this._lightPositionWorld,o=this._lookTarget,a=this._projScreenMatrix;i.setFromMatrixPosition(t.matrixWorld),n.position.copy(i),o.copy(n.position),o.add(this._cubeDirections[e]),n.up.copy(this._cubeUps[e]),n.lookAt(o),n.updateMatrixWorld(),r.makeTranslation(-i.x,-i.y,-i.z),a.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(a)}}),dwt.prototype=Object.assign(Object.create(uwt.prototype),{constructor:dwt,isPointLight:!0,copy:function(t){return uwt.prototype.copy.call(this,t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}),mwt.prototype=Object.assign(Object.create(Cvt.prototype),{constructor:mwt,isOrthographicCamera:!0,copy:function(t,e){return Cvt.prototype.copy.call(this,t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this},setViewOffset:function(t,e,n,r,i,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2,i=n-t,o=n+t,a=r+e,s=r-e;if(null!==this.view&&this.view.enabled){var u=(this.right-this.left)/this.view.fullWidth/this.zoom,c=(this.top-this.bottom)/this.view.fullHeight/this.zoom;o=(i+=u*this.view.offsetX)+u*this.view.width,s=(a-=c*this.view.offsetY)-c*this.view.height}this.projectionMatrix.makeOrthographic(i,o,a,s,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(t){var e=Ldt.prototype.toJSON.call(this,t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=Object.assign({},this.view)),e}}),vwt.prototype=Object.assign(Object.create(lwt.prototype),{constructor:vwt,isDirectionalLightShadow:!0,updateMatrices:function(t){lwt.prototype.updateMatrices.call(this,t)}}),gwt.prototype=Object.assign(Object.create(uwt.prototype),{constructor:gwt,isDirectionalLight:!0,copy:function(t){return uwt.prototype.copy.call(this,t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),ywt.prototype=Object.assign(Object.create(uwt.prototype),{constructor:ywt,isAmbientLight:!0}),xwt.prototype=Object.assign(Object.create(uwt.prototype),{constructor:xwt,isRectAreaLight:!0,copy:function(t){return uwt.prototype.copy.call(this,t),this.width=t.width,this.height=t.height,this},toJSON:function(t){var e=uwt.prototype.toJSON.call(this,t);return e.object.width=this.width,e.object.height=this.height,e}}),bwt.prototype=Object.assign(Object.create(k_t.prototype),{constructor:bwt,load:function(t,e,n,r){var i=this,o=new L_t(i.manager);o.setPath(i.path),o.load(t,(function(t){e(i.parse(JSON.parse(t)))}),n,r)},parse:function(t){var e=this.textures;function n(t){return e[t],e[t]}var r=new h_t[t.type];if(void 0!==t.uuid&&(r.uuid=t.uuid),void 0!==t.name&&(r.name=t.name),void 0!==t.color&&r.color.setHex(t.color),void 0!==t.roughness&&(r.roughness=t.roughness),void 0!==t.metalness&&(r.metalness=t.metalness),void 0!==t.sheen&&(r.sheen=(new Smt).setHex(t.sheen)),void 0!==t.emissive&&r.emissive.setHex(t.emissive),void 0!==t.specular&&r.specular.setHex(t.specular),void 0!==t.shininess&&(r.shininess=t.shininess),void 0!==t.clearcoat&&(r.clearcoat=t.clearcoat),void 0!==t.clearcoatRoughness&&(r.clearcoatRoughness=t.clearcoatRoughness),void 0!==t.fog&&(r.fog=t.fog),void 0!==t.flatShading&&(r.flatShading=t.flatShading),void 0!==t.blending&&(r.blending=t.blending),void 0!==t.combine&&(r.combine=t.combine),void 0!==t.side&&(r.side=t.side),void 0!==t.opacity&&(r.opacity=t.opacity),void 0!==t.transparent&&(r.transparent=t.transparent),void 0!==t.alphaTest&&(r.alphaTest=t.alphaTest),void 0!==t.depthTest&&(r.depthTest=t.depthTest),void 0!==t.depthWrite&&(r.depthWrite=t.depthWrite),void 0!==t.colorWrite&&(r.colorWrite=t.colorWrite),void 0!==t.stencilWrite&&(r.stencilWrite=t.stencilWrite),void 0!==t.stencilWriteMask&&(r.stencilWriteMask=t.stencilWriteMask),void 0!==t.stencilFunc&&(r.stencilFunc=t.stencilFunc),void 0!==t.stencilRef&&(r.stencilRef=t.stencilRef),void 0!==t.stencilFuncMask&&(r.stencilFuncMask=t.stencilFuncMask),void 0!==t.stencilFail&&(r.stencilFail=t.stencilFail),void 0!==t.stencilZFail&&(r.stencilZFail=t.stencilZFail),void 0!==t.stencilZPass&&(r.stencilZPass=t.stencilZPass),void 0!==t.wireframe&&(r.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(r.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.wireframeLinecap&&(r.wireframeLinecap=t.wireframeLinecap),void 0!==t.wireframeLinejoin&&(r.wireframeLinejoin=t.wireframeLinejoin),void 0!==t.rotation&&(r.rotation=t.rotation),1!==t.linewidth&&(r.linewidth=t.linewidth),void 0!==t.dashSize&&(r.dashSize=t.dashSize),void 0!==t.gapSize&&(r.gapSize=t.gapSize),void 0!==t.scale&&(r.scale=t.scale),void 0!==t.polygonOffset&&(r.polygonOffset=t.polygonOffset),void 0!==t.polygonOffsetFactor&&(r.polygonOffsetFactor=t.polygonOffsetFactor),void 0!==t.polygonOffsetUnits&&(r.polygonOffsetUnits=t.polygonOffsetUnits),void 0!==t.skinning&&(r.skinning=t.skinning),void 0!==t.morphTargets&&(r.morphTargets=t.morphTargets),void 0!==t.morphNormals&&(r.morphNormals=t.morphNormals),void 0!==t.dithering&&(r.dithering=t.dithering),void 0!==t.vertexTangents&&(r.vertexTangents=t.vertexTangents),void 0!==t.visible&&(r.visible=t.visible),void 0!==t.toneMapped&&(r.toneMapped=t.toneMapped),void 0!==t.userData&&(r.userData=t.userData),void 0!==t.vertexColors&&("number"==typeof t.vertexColors?r.vertexColors=t.vertexColors>0:r.vertexColors=t.vertexColors),void 0!==t.uniforms)for(var i in t.uniforms){var o=t.uniforms[i];switch(r.uniforms[i]={},o.type){case"t":r.uniforms[i].value=n(o.value);break;case"c":r.uniforms[i].value=(new Smt).setHex(o.value);break;case"v2":r.uniforms[i].value=(new Zpt).fromArray(o.value);break;case"v3":r.uniforms[i].value=(new adt).fromArray(o.value);break;case"v4":r.uniforms[i].value=(new tdt).fromArray(o.value);break;case"m3":r.uniforms[i].value=(new $pt).fromArray(o.value);case"m4":r.uniforms[i].value=(new ddt).fromArray(o.value);break;default:r.uniforms[i].value=o.value}}if(void 0!==t.defines&&(r.defines=t.defines),void 0!==t.vertexShader&&(r.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(r.fragmentShader=t.fragmentShader),void 0!==t.extensions)for(var a in t.extensions)r.extensions[a]=t.extensions[a];if(void 0!==t.shading&&(r.flatShading=1===t.shading),void 0!==t.size&&(r.size=t.size),void 0!==t.sizeAttenuation&&(r.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(r.map=n(t.map)),void 0!==t.matcap&&(r.matcap=n(t.matcap)),void 0!==t.alphaMap&&(r.alphaMap=n(t.alphaMap)),void 0!==t.bumpMap&&(r.bumpMap=n(t.bumpMap)),void 0!==t.bumpScale&&(r.bumpScale=t.bumpScale),void 0!==t.normalMap&&(r.normalMap=n(t.normalMap)),void 0!==t.normalMapType&&(r.normalMapType=t.normalMapType),void 0!==t.normalScale){var s=t.normalScale;!1===Array.isArray(s)&&(s=[s,s]),r.normalScale=(new Zpt).fromArray(s)}return void 0!==t.displacementMap&&(r.displacementMap=n(t.displacementMap)),void 0!==t.displacementScale&&(r.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(r.displacementBias=t.displacementBias),void 0!==t.roughnessMap&&(r.roughnessMap=n(t.roughnessMap)),void 0!==t.metalnessMap&&(r.metalnessMap=n(t.metalnessMap)),void 0!==t.emissiveMap&&(r.emissiveMap=n(t.emissiveMap)),void 0!==t.emissiveIntensity&&(r.emissiveIntensity=t.emissiveIntensity),void 0!==t.specularMap&&(r.specularMap=n(t.specularMap)),void 0!==t.envMap&&(r.envMap=n(t.envMap)),void 0!==t.envMapIntensity&&(r.envMapIntensity=t.envMapIntensity),void 0!==t.reflectivity&&(r.reflectivity=t.reflectivity),void 0!==t.refractionRatio&&(r.refractionRatio=t.refractionRatio),void 0!==t.lightMap&&(r.lightMap=n(t.lightMap)),void 0!==t.lightMapIntensity&&(r.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(r.aoMap=n(t.aoMap)),void 0!==t.aoMapIntensity&&(r.aoMapIntensity=t.aoMapIntensity),void 0!==t.gradientMap&&(r.gradientMap=n(t.gradientMap)),void 0!==t.clearcoatMap&&(r.clearcoatMap=n(t.clearcoatMap)),void 0!==t.clearcoatRoughnessMap&&(r.clearcoatRoughnessMap=n(t.clearcoatRoughnessMap)),void 0!==t.clearcoatNormalMap&&(r.clearcoatNormalMap=n(t.clearcoatNormalMap)),void 0!==t.clearcoatNormalScale&&(r.clearcoatNormalScale=(new Zpt).fromArray(t.clearcoatNormalScale)),r},setTextures:function(t){return this.textures=t,this}});var _wt=function(t){var e=t.lastIndexOf("/");return-1===e?"./":t.substr(0,e+1)};function wwt(){Kmt.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function Swt(t,e,n,r){"number"==typeof n&&(r=n,n=!1),Lmt.call(this,t,e,n),this.meshPerAttribute=r||1}function Mwt(t){k_t.call(this,t)}wwt.prototype=Object.assign(Object.create(Kmt.prototype),{constructor:wwt,isInstancedBufferGeometry:!0,copy:function(t){return Kmt.prototype.copy.call(this,t),this.maxInstancedCount=t.maxInstancedCount,this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var t=Kmt.prototype.toJSON.call(this);return t.maxInstancedCount=this.maxInstancedCount,t.isInstancedBufferGeometry=!0,t}}),Swt.prototype=Object.assign(Object.create(Lmt.prototype),{constructor:Swt,isInstancedBufferAttribute:!0,copy:function(t){return Lmt.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},toJSON:function(){var t=Lmt.prototype.toJSON.call(this);return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}}),Mwt.prototype=Object.assign(Object.create(k_t.prototype),{constructor:Mwt,load:function(t,e,n,r){var i=this,o=new L_t(i.manager);o.setPath(i.path),o.load(t,(function(t){e(i.parse(JSON.parse(t)))}),n,r)},parse:function(t){var e=t.isInstancedBufferGeometry?new wwt:new Kmt,n=t.data.index;if(void 0!==n){var r=new Ewt[n.type](n.array);e.setIndex(new Lmt(r,1))}var i=t.data.attributes;for(var o in i){var a=i[o],s=(r=new Ewt[a.type](a.array),new(a.isInstancedBufferAttribute?Swt:Lmt)(r,a.itemSize,a.normalized));void 0!==a.name&&(s.name=a.name),e.setAttribute(o,s)}var u=t.data.morphAttributes;if(u)for(var o in u){for(var c=u[o],l=[],h=0,f=c.length;h<f;h++){a=c[h],s=new Lmt(r=new Ewt[a.type](a.array),a.itemSize,a.normalized);void 0!==a.name&&(s.name=a.name),l.push(s)}e.morphAttributes[o]=l}t.data.morphTargetsRelative&&(e.morphTargetsRelative=!0);var p=t.data.groups||t.data.drawcalls||t.data.offsets;if(void 0!==p){h=0;for(var d=p.length;h!==d;++h){var m=p[h];e.addGroup(m.start,m.count,m.materialIndex)}}var v=t.data.boundingSphere;if(void 0!==v){var g=new adt;void 0!==v.center&&g.fromArray(v.center),e.boundingSphere=new $dt(g,v.radius)}return t.name&&(e.name=t.name),t.userData&&(e.userData=t.userData),e}});var Ewt={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function Awt(t){k_t.call(this,t)}Awt.prototype=Object.assign(Object.create(k_t.prototype),{constructor:Awt,load:function(t,e,n,r){var i=this,o=""===this.path?_wt(t):this.path;this.resourcePath=this.resourcePath||o;var a=new L_t(i.manager);a.setPath(this.path),a.load(t,(function(t){var n=null;try{n=JSON.parse(t)}catch(a){return void(void 0!==r&&r(a))}var o=n.metadata;void 0!==o&&void 0!==o.type&&"geometry"!==o.type.toLowerCase()&&i.parse(n,e)}),n,r)},parse:function(t,e){var n=this.parseShape(t.shapes),r=this.parseGeometries(t.geometries,n),i=this.parseImages(t.images,(function(){void 0!==e&&e(s)})),o=this.parseTextures(t.textures,i),a=this.parseMaterials(t.materials,o),s=this.parseObject(t.object,r,a);return t.animations&&(s.animations=this.parseAnimations(t.animations)),void 0!==t.images&&0!==t.images.length||void 0!==e&&e(s),s},parseShape:function(t){var e={};if(void 0!==t)for(var n=0,r=t.length;n<r;n++){var i=(new swt).fromJSON(t[n]);e[i.uuid]=i}return e},parseGeometries:function(t,e){var n={};if(void 0!==t)for(var r=new Mwt,i=0,o=t.length;i<o;i++){var a,s=t[i];switch(s.type){case"PlaneGeometry":case"PlaneBufferGeometry":a=new t_t[s.type](s.width,s.height,s.widthSegments,s.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":a=new t_t[s.type](s.width,s.height,s.depth,s.widthSegments,s.heightSegments,s.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":a=new t_t[s.type](s.radius,s.segments,s.thetaStart,s.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":a=new t_t[s.type](s.radiusTop,s.radiusBottom,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":a=new t_t[s.type](s.radius,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":a=new t_t[s.type](s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":a=new t_t[s.type](s.radius,s.detail);break;case"RingGeometry":case"RingBufferGeometry":a=new t_t[s.type](s.innerRadius,s.outerRadius,s.thetaSegments,s.phiSegments,s.thetaStart,s.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":a=new t_t[s.type](s.radius,s.tube,s.radialSegments,s.tubularSegments,s.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":a=new t_t[s.type](s.radius,s.tube,s.tubularSegments,s.radialSegments,s.p,s.q);break;case"TubeGeometry":case"TubeBufferGeometry":a=new t_t[s.type]((new iwt[s.path.type]).fromJSON(s.path),s.tubularSegments,s.radius,s.radialSegments,s.closed);break;case"LatheGeometry":case"LatheBufferGeometry":a=new t_t[s.type](s.points,s.segments,s.phiStart,s.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":a=new t_t[s.type](s.vertices,s.indices,s.radius,s.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":for(var u=[],c=0,l=s.shapes.length;c<l;c++){var h=e[s.shapes[c]];u.push(h)}a=new t_t[s.type](u,s.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":for(u=[],c=0,l=s.shapes.length;c<l;c++){h=e[s.shapes[c]];u.push(h)}var f=s.options.extrudePath;void 0!==f&&(s.options.extrudePath=(new iwt[f.type]).fromJSON(f)),a=new t_t[s.type](u,s.options);break;case"BufferGeometry":case"InstancedBufferGeometry":a=r.parse(s);break;case"Geometry":break;default:continue}a.uuid=s.uuid,void 0!==s.name&&(a.name=s.name),!0===a.isBufferGeometry&&void 0!==s.userData&&(a.userData=s.userData),n[s.uuid]=a}return n},parseMaterials:function(t,e){var n={},r={};if(void 0!==t){var i=new bwt;i.setTextures(e);for(var o=0,a=t.length;o<a;o++){var s=t[o];if("MultiMaterial"===s.type){for(var u=[],c=0;c<s.materials.length;c++){var l=s.materials[c];void 0===n[l.uuid]&&(n[l.uuid]=i.parse(l)),u.push(n[l.uuid])}r[s.uuid]=u}else void 0===n[s.uuid]&&(n[s.uuid]=i.parse(s)),r[s.uuid]=n[s.uuid]}}return r},parseAnimations:function(t){for(var e=[],n=0;n<t.length;n++){var r=t[n],i=E_t.parse(r);void 0!==r.uuid&&(i.uuid=r.uuid),e.push(i)}return e},parseImages:function(t,e){var n=this,r={};function i(t){return n.manager.itemStart(t),o.load(t,(function(){n.manager.itemEnd(t)}),void 0,(function(){n.manager.itemError(t),n.manager.itemEnd(t)}))}if(void 0!==t&&t.length>0){var o=new D_t(new C_t(e));o.setCrossOrigin(this.crossOrigin);for(var a=0,s=t.length;a<s;a++){var u=t[a],c=u.url;if(Array.isArray(c)){r[u.uuid]=[];for(var l=0,h=c.length;l<h;l++){var f=c[l],p=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(f)?f:n.resourcePath+f;r[u.uuid].push(i(p))}}else{p=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(u.url)?u.url:n.resourcePath+u.url;r[u.uuid]=i(p)}}}return r},parseTextures:function(t,e){function n(t,e){return"number"==typeof t?t:e[t]}var r={};if(void 0!==t)for(var i=0,o=t.length;i<o;i++){var a,s=t[i];s.image,e[s.image],(a=Array.isArray(e[s.image])?new egt(e[s.image]):new Qpt(e[s.image])).needsUpdate=!0,a.uuid=s.uuid,void 0!==s.name&&(a.name=s.name),void 0!==s.mapping&&(a.mapping=n(s.mapping,Cwt)),void 0!==s.offset&&a.offset.fromArray(s.offset),void 0!==s.repeat&&a.repeat.fromArray(s.repeat),void 0!==s.center&&a.center.fromArray(s.center),void 0!==s.rotation&&(a.rotation=s.rotation),void 0!==s.wrap&&(a.wrapS=n(s.wrap[0],Owt),a.wrapT=n(s.wrap[1],Owt)),void 0!==s.format&&(a.format=s.format),void 0!==s.type&&(a.type=s.type),void 0!==s.encoding&&(a.encoding=s.encoding),void 0!==s.minFilter&&(a.minFilter=n(s.minFilter,kwt)),void 0!==s.magFilter&&(a.magFilter=n(s.magFilter,kwt)),void 0!==s.anisotropy&&(a.anisotropy=s.anisotropy),void 0!==s.flipY&&(a.flipY=s.flipY),void 0!==s.premultiplyAlpha&&(a.premultiplyAlpha=s.premultiplyAlpha),void 0!==s.unpackAlignment&&(a.unpackAlignment=s.unpackAlignment),r[s.uuid]=a}return r},parseObject:function(t,e,n){var r;function i(t){return e[t],e[t]}function o(t){if(void 0!==t){if(Array.isArray(t)){for(var e=[],r=0,i=t.length;r<i;r++){var o=t[r];n[o],e.push(n[o])}return e}return n[t],n[t]}}switch(t.type){case"Scene":r=new Rdt,void 0!==t.background&&Number.isInteger(t.background)&&(r.background=new Smt(t.background)),void 0!==t.fog&&("Fog"===t.fog.type?r.fog=new Uyt(t.fog.color,t.fog.near,t.fog.far):"FogExp2"===t.fog.type&&(r.fog=new zyt(t.fog.color,t.fog.density)));break;case"PerspectiveCamera":r=new Ovt(t.fov,t.aspect,t.near,t.far),void 0!==t.focus&&(r.focus=t.focus),void 0!==t.zoom&&(r.zoom=t.zoom),void 0!==t.filmGauge&&(r.filmGauge=t.filmGauge),void 0!==t.filmOffset&&(r.filmOffset=t.filmOffset),void 0!==t.view&&(r.view=Object.assign({},t.view));break;case"OrthographicCamera":r=new mwt(t.left,t.right,t.top,t.bottom,t.near,t.far),void 0!==t.zoom&&(r.zoom=t.zoom),void 0!==t.view&&(r.view=Object.assign({},t.view));break;case"AmbientLight":r=new ywt(t.color,t.intensity);break;case"DirectionalLight":r=new gwt(t.color,t.intensity);break;case"PointLight":r=new dwt(t.color,t.intensity,t.distance,t.decay);break;case"RectAreaLight":r=new xwt(t.color,t.intensity,t.width,t.height);break;case"SpotLight":r=new fwt(t.color,t.intensity,t.distance,t.angle,t.penumbra,t.decay);break;case"HemisphereLight":r=new cwt(t.color,t.groundColor,t.intensity);break;case"SkinnedMesh":case"Mesh":r=new mvt(a=i(t.geometry),s=o(t.material));break;case"InstancedMesh":var a=i(t.geometry),s=o(t.material),u=t.count,c=t.instanceMatrix;(r=new xxt(a,s,u)).instanceMatrix=new Lmt(new Float32Array(c.array),16);break;case"LOD":r=new cxt;break;case"Line":r=new Axt(i(t.geometry),o(t.material),t.mode);break;case"LineLoop":r=new kxt(i(t.geometry),o(t.material));break;case"LineSegments":r=new Oxt(i(t.geometry),o(t.material));break;case"PointCloud":case"Points":r=new Dxt(i(t.geometry),o(t.material));break;case"Sprite":r=new oxt(o(t.material));break;case"Group":r=new Fyt;break;default:r=new Ldt}if(r.uuid=t.uuid,void 0!==t.name&&(r.name=t.name),void 0!==t.matrix?(r.matrix.fromArray(t.matrix),void 0!==t.matrixAutoUpdate&&(r.matrixAutoUpdate=t.matrixAutoUpdate),r.matrixAutoUpdate&&r.matrix.decompose(r.position,r.quaternion,r.scale)):(void 0!==t.position&&r.position.fromArray(t.position),void 0!==t.rotation&&r.rotation.fromArray(t.rotation),void 0!==t.quaternion&&r.quaternion.fromArray(t.quaternion),void 0!==t.scale&&r.scale.fromArray(t.scale)),void 0!==t.castShadow&&(r.castShadow=t.castShadow),void 0!==t.receiveShadow&&(r.receiveShadow=t.receiveShadow),t.shadow&&(void 0!==t.shadow.bias&&(r.shadow.bias=t.shadow.bias),void 0!==t.shadow.radius&&(r.shadow.radius=t.shadow.radius),void 0!==t.shadow.mapSize&&r.shadow.mapSize.fromArray(t.shadow.mapSize),void 0!==t.shadow.camera&&(r.shadow.camera=this.parseObject(t.shadow.camera))),void 0!==t.visible&&(r.visible=t.visible),void 0!==t.frustumCulled&&(r.frustumCulled=t.frustumCulled),void 0!==t.renderOrder&&(r.renderOrder=t.renderOrder),void 0!==t.userData&&(r.userData=t.userData),void 0!==t.layers&&(r.layers.mask=t.layers),void 0!==t.children)for(var l=t.children,h=0;h<l.length;h++)r.add(this.parseObject(l[h],e,n));if("LOD"===t.type){void 0!==t.autoUpdate&&(r.autoUpdate=t.autoUpdate);for(var f=t.levels,p=0;p<f.length;p++){var d=f[p],m=r.getObjectByProperty("uuid",d.object);void 0!==m&&r.addLevel(m,d.distance)}}return r}});var Twt,Cwt={UVMapping:300,CubeReflectionMapping:301,CubeRefractionMapping:302,EquirectangularReflectionMapping:303,EquirectangularRefractionMapping:304,SphericalReflectionMapping:305,CubeUVReflectionMapping:ppt,CubeUVRefractionMapping:307},Owt={RepeatWrapping:dpt,ClampToEdgeWrapping:mpt,MirroredRepeatWrapping:vpt},kwt={NearestFilter:gpt,NearestMipmapNearestFilter:ypt,NearestMipmapLinearFilter:xpt,LinearFilter:bpt,LinearMipmapNearestFilter:1007,LinearMipmapLinearFilter:_pt};function Pwt(t){k_t.call(this,t),this.options=void 0}function Lwt(){this.type="ShapePath",this.color=new Smt,this.subPaths=[],this.currentPath=null}function Rwt(t){this.type="Font",this.data=t}function Iwt(t,e,n,r,i){var o=i.glyphs[t]||i.glyphs["?"];if(o){var a,s,u,c,l,h,f,p,d=new Lwt;if(o.o)for(var m=o._cachedOutline||(o._cachedOutline=o.o.split(" ")),v=0,g=m.length;v<g;){switch(m[v++]){case"m":a=m[v++]*e+n,s=m[v++]*e+r,d.moveTo(a,s);break;case"l":a=m[v++]*e+n,s=m[v++]*e+r,d.lineTo(a,s);break;case"q":u=m[v++]*e+n,c=m[v++]*e+r,l=m[v++]*e+n,h=m[v++]*e+r,d.quadraticCurveTo(l,h,u,c);break;case"b":u=m[v++]*e+n,c=m[v++]*e+r,l=m[v++]*e+n,h=m[v++]*e+r,f=m[v++]*e+n,p=m[v++]*e+r,d.bezierCurveTo(l,h,f,p,u,c)}}return{offsetX:o.ha*e,path:d}}}function Nwt(t){k_t.call(this,t)}Pwt.prototype=Object.assign(Object.create(k_t.prototype),{constructor:Pwt,setOptions:function(t){return this.options=t,this},load:function(t,e,n,r){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var i=this,o=T_t.get(t);if(void 0!==o)return i.manager.itemStart(t),setTimeout((function(){e&&e(o),i.manager.itemEnd(t)}),0),o;fetch(t).then((function(t){return t.blob()})).then((function(t){return void 0===i.options?createImageBitmap(t):createImageBitmap(t,i.options)})).then((function(n){T_t.add(t,n),e&&e(n),i.manager.itemEnd(t)})).catch((function(e){r&&r(e),i.manager.itemError(t),i.manager.itemEnd(t)})),i.manager.itemStart(t)}}),Object.assign(Lwt.prototype,{moveTo:function(t,e){return this.currentPath=new awt,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e),this},lineTo:function(t,e){return this.currentPath.lineTo(t,e),this},quadraticCurveTo:function(t,e,n,r){return this.currentPath.quadraticCurveTo(t,e,n,r),this},bezierCurveTo:function(t,e,n,r,i,o){return this.currentPath.bezierCurveTo(t,e,n,r,i,o),this},splineThru:function(t){return this.currentPath.splineThru(t),this},toShapes:function(t,e){function n(t){for(var e=[],n=0,r=t.length;n<r;n++){var i=t[n],o=new swt;o.curves=i.curves,e.push(o)}return e}function r(t,e){for(var n=e.length,r=!1,i=n-1,o=0;o<n;i=o++){var a=e[i],s=e[o],u=s.x-a.x,c=s.y-a.y;if(Math.abs(c)>Number.EPSILON){if(c<0&&(a=e[o],u=-u,s=e[i],c=-c),t.y<a.y||t.y>s.y)continue;if(t.y===a.y){if(t.x===a.x)return!0}else{var l=c*(t.x-a.x)-u*(t.y-a.y);if(0===l)return!0;if(l<0)continue;r=!r}}else{if(t.y!==a.y)continue;if(s.x<=t.x&&t.x<=a.x||a.x<=t.x&&t.x<=s.x)return!0}}return r}var i=Obt.isClockWise,o=this.subPaths;if(0===o.length)return[];if(!0===e)return n(o);var a,s,u,c=[];if(1===o.length)return s=o[0],(u=new swt).curves=s.curves,c.push(u),c;var l=!i(o[0].getPoints());l=t?!l:l;var h,f,p=[],d=[],m=[],v=0;d[v]=void 0,m[v]=[];for(var g=0,y=o.length;g<y;g++)a=i(h=(s=o[g]).getPoints()),(a=t?!a:a)?(!l&&d[v]&&v++,d[v]={s:new swt,p:h},d[v].s.curves=s.curves,l&&v++,m[v]=[]):m[v].push({h:s,p:h[0]});if(!d[0])return n(o);if(d.length>1){for(var x=!1,b=[],_=0,w=d.length;_<w;_++)p[_]=[];for(_=0,w=d.length;_<w;_++)for(var S=m[_],M=0;M<S.length;M++){for(var E=S[M],A=!0,T=0;T<d.length;T++)r(E.p,d[T].p)&&(_!==T&&b.push({froms:_,tos:T,hole:M}),A?(A=!1,p[T].push(E)):x=!0);A&&p[_].push(E)}b.length>0&&(x||(m=p))}g=0;for(var C=d.length;g<C;g++){u=d[g].s,c.push(u);for(var O=0,k=(f=m[g]).length;O<k;O++)u.holes.push(f[O].h)}return c}}),Object.assign(Rwt.prototype,{isFont:!0,generateShapes:function(t,e){void 0===e&&(e=100);for(var n=[],r=function(t,e,n){for(var r=Array.from?Array.from(t):String(t).split(""),i=e/n.resolution,o=(n.boundingBox.yMax-n.boundingBox.yMin+n.underlineThickness)*i,a=[],s=0,u=0,c=0;c<r.length;c++){var l=r[c];if("\n"===l)s=0,u-=o;else{var h=Iwt(l,i,s,u,n);s+=h.offsetX,a.push(h.path)}}return a}(t,e,this.data),i=0,o=r.length;i<o;i++)Array.prototype.push.apply(n,r[i].toShapes());return n}}),Nwt.prototype=Object.assign(Object.create(k_t.prototype),{constructor:Nwt,load:function(t,e,n,r){var i=this,o=new L_t(this.manager);o.setPath(this.path),o.load(t,(function(t){var n;try{n=JSON.parse(t)}catch(o){n=JSON.parse(t.substring(65,t.length-2))}var r=i.parse(n);e&&e(r)}),n,r)},parse:function(t){return new Rwt(t)}});var Dwt=function(){return void 0===Twt&&(Twt=new(window.AudioContext||window.webkitAudioContext)),Twt};function Fwt(t){k_t.call(this,t)}function jwt(){this.coefficients=[];for(var t=0;t<9;t++)this.coefficients.push(new adt)}function Bwt(t,e){uwt.call(this,void 0,e),this.sh=void 0!==t?t:new jwt}function zwt(t,e,n){Bwt.call(this,void 0,n);var r=(new Smt).set(t),i=(new Smt).set(e),o=new adt(r.r,r.g,r.b),a=new adt(i.r,i.g,i.b),s=Math.sqrt(Math.PI),u=s*Math.sqrt(.75);this.sh.coefficients[0].copy(o).add(a).multiplyScalar(s),this.sh.coefficients[1].copy(o).sub(a).multiplyScalar(u)}function Uwt(t,e){Bwt.call(this,void 0,e);var n=(new Smt).set(t);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}Fwt.prototype=Object.assign(Object.create(k_t.prototype),{constructor:Fwt,load:function(t,e,n,r){var i=new L_t(this.manager);i.setResponseType("arraybuffer"),i.setPath(this.path),i.load(t,(function(t){var n=t.slice(0);Dwt().decodeAudioData(n,(function(t){e(t)}))}),n,r)}}),Object.assign(jwt.prototype,{isSphericalHarmonics3:!0,set:function(t){for(var e=0;e<9;e++)this.coefficients[e].copy(t[e]);return this},zero:function(){for(var t=0;t<9;t++)this.coefficients[t].set(0,0,0);return this},getAt:function(t,e){var n=t.x,r=t.y,i=t.z,o=this.coefficients;return e.copy(o[0]).multiplyScalar(.282095),e.addScaledVector(o[1],.488603*r),e.addScaledVector(o[2],.488603*i),e.addScaledVector(o[3],.488603*n),e.addScaledVector(o[4],n*r*1.092548),e.addScaledVector(o[5],r*i*1.092548),e.addScaledVector(o[6],.315392*(3*i*i-1)),e.addScaledVector(o[7],n*i*1.092548),e.addScaledVector(o[8],.546274*(n*n-r*r)),e},getIrradianceAt:function(t,e){var n=t.x,r=t.y,i=t.z,o=this.coefficients;return e.copy(o[0]).multiplyScalar(.886227),e.addScaledVector(o[1],1.023328*r),e.addScaledVector(o[2],1.023328*i),e.addScaledVector(o[3],1.023328*n),e.addScaledVector(o[4],.858086*n*r),e.addScaledVector(o[5],.858086*r*i),e.addScaledVector(o[6],.743125*i*i-.247708),e.addScaledVector(o[7],.858086*n*i),e.addScaledVector(o[8],.429043*(n*n-r*r)),e},add:function(t){for(var e=0;e<9;e++)this.coefficients[e].add(t.coefficients[e]);return this},addScaledSH:function(t,e){for(var n=0;n<9;n++)this.coefficients[n].addScaledVector(t.coefficients[n],e);return this},scale:function(t){for(var e=0;e<9;e++)this.coefficients[e].multiplyScalar(t);return this},lerp:function(t,e){for(var n=0;n<9;n++)this.coefficients[n].lerp(t.coefficients[n],e);return this},equals:function(t){for(var e=0;e<9;e++)if(!this.coefficients[e].equals(t.coefficients[e]))return!1;return!0},copy:function(t){return this.set(t.coefficients)},clone:function(){return(new this.constructor).copy(this)},fromArray:function(t,e){void 0===e&&(e=0);for(var n=this.coefficients,r=0;r<9;r++)n[r].fromArray(t,e+3*r);return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);for(var n=this.coefficients,r=0;r<9;r++)n[r].toArray(t,e+3*r);return t}}),Object.assign(jwt,{getBasisAt:function(t,e){var n=t.x,r=t.y,i=t.z;e[0]=.282095,e[1]=.488603*r,e[2]=.488603*i,e[3]=.488603*n,e[4]=1.092548*n*r,e[5]=1.092548*r*i,e[6]=.315392*(3*i*i-1),e[7]=1.092548*n*i,e[8]=.546274*(n*n-r*r)}}),Bwt.prototype=Object.assign(Object.create(uwt.prototype),{constructor:Bwt,isLightProbe:!0,copy:function(t){return uwt.prototype.copy.call(this,t),this.sh.copy(t.sh),this.intensity=t.intensity,this},toJSON:function(t){return uwt.prototype.toJSON.call(this,t)}}),zwt.prototype=Object.assign(Object.create(Bwt.prototype),{constructor:zwt,isHemisphereLightProbe:!0,copy:function(t){return Bwt.prototype.copy.call(this,t),this},toJSON:function(t){return Bwt.prototype.toJSON.call(this,t)}}),Uwt.prototype=Object.assign(Object.create(Bwt.prototype),{constructor:Uwt,isAmbientLightProbe:!0,copy:function(t){return Bwt.prototype.copy.call(this,t),this},toJSON:function(t){return Bwt.prototype.toJSON.call(this,t)}});var Vwt=new ddt,Gwt=new ddt;function Wwt(t){this.autoStart=void 0===t||t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}Object.assign(function(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Ovt,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Ovt,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}.prototype,{update:function(t){var e=this._cache;if(e.focus!==t.focus||e.fov!==t.fov||e.aspect!==t.aspect*this.aspect||e.near!==t.near||e.far!==t.far||e.zoom!==t.zoom||e.eyeSep!==this.eyeSep){e.focus=t.focus,e.fov=t.fov,e.aspect=t.aspect*this.aspect,e.near=t.near,e.far=t.far,e.zoom=t.zoom,e.eyeSep=this.eyeSep;var n,r,i=t.projectionMatrix.clone(),o=e.eyeSep/2,a=o*e.near/e.focus,s=e.near*Math.tan(qpt.DEG2RAD*e.fov*.5)/e.zoom;Gwt.elements[12]=-o,Vwt.elements[12]=o,n=-s*e.aspect+a,r=s*e.aspect+a,i.elements[0]=2*e.near/(r-n),i.elements[8]=(r+n)/(r-n),this.cameraL.projectionMatrix.copy(i),n=-s*e.aspect-a,r=s*e.aspect-a,i.elements[0]=2*e.near/(r-n),i.elements[8]=(r+n)/(r-n),this.cameraR.projectionMatrix.copy(i)}this.cameraL.matrixWorld.copy(t.matrixWorld).multiply(Gwt),this.cameraR.matrixWorld.copy(t.matrixWorld).multiply(Vwt)}}),Object.assign(Wwt.prototype,{start:function(){this.startTime=("undefined"==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var e=("undefined"==typeof performance?Date:performance).now();t=(e-this.oldTime)/1e3,this.oldTime=e,this.elapsedTime+=t}return t}});var Hwt=new adt,Ywt=new rdt,Xwt=new adt,qwt=new adt;function Zwt(){Ldt.call(this),this.type="AudioListener",this.context=Dwt(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new Wwt}function $wt(t){Ldt.call(this),this.type="Audio",this.listener=t,this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this._startedAt=0,this._pausedAt=0,this.filters=[]}Zwt.prototype=Object.assign(Object.create(Ldt.prototype),{constructor:Zwt,getInput:function(){return this.gain},removeFilter:function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},getFilter:function(){return this.filter},setFilter:function(t){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this},updateMatrixWorld:function(t){Ldt.prototype.updateMatrixWorld.call(this,t);var e=this.context.listener,n=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Hwt,Ywt,Xwt),qwt.set(0,0,-1).applyQuaternion(Ywt),e.positionX){var r=this.context.currentTime+this.timeDelta;e.positionX.linearRampToValueAtTime(Hwt.x,r),e.positionY.linearRampToValueAtTime(Hwt.y,r),e.positionZ.linearRampToValueAtTime(Hwt.z,r),e.forwardX.linearRampToValueAtTime(qwt.x,r),e.forwardY.linearRampToValueAtTime(qwt.y,r),e.forwardZ.linearRampToValueAtTime(qwt.z,r),e.upX.linearRampToValueAtTime(n.x,r),e.upY.linearRampToValueAtTime(n.y,r),e.upZ.linearRampToValueAtTime(n.z,r)}else e.setPosition(Hwt.x,Hwt.y,Hwt.z),e.setOrientation(qwt.x,qwt.y,qwt.z,n.x,n.y,n.z)}}),$wt.prototype=Object.assign(Object.create(Ldt.prototype),{constructor:$wt,getOutput:function(){return this.gain},setNodeSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this},setMediaElementSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(t),this.connect(),this},setMediaStreamSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(t),this.connect(),this},setBuffer:function(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(t){if(void 0===t&&(t=0),!0!==this.isPlaying&&!1!==this.hasPlaybackControl){this._startedAt=this.context.currentTime+t;var e=this.context.createBufferSource();return e.buffer=this.buffer,e.loop=this.loop,e.loopStart=this.loopStart,e.loopEnd=this.loopEnd,e.onended=this.onEnded.bind(this),e.start(this._startedAt,this._pausedAt+this.offset,this.duration),this.isPlaying=!0,this.source=e,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}},pause:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._pausedAt+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.source.stop(),this.source.onended=null,this.isPlaying=!1),this},stop:function(){if(!1!==this.hasPlaybackControl)return this._pausedAt=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this},connect:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(t){return t||(t=[]),!0===this.isPlaying?(this.disconnect(),this.filters=t,this.connect()):this.filters=t,this},setDetune:function(t){if(this.detune=t,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},getDetune:function(){return this.detune},getFilter:function(){return this.getFilters()[0]},setFilter:function(t){return this.setFilters(t?[t]:[])},setPlaybackRate:function(t){if(!1!==this.hasPlaybackControl)return this.playbackRate=t,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1!==this.hasPlaybackControl&&this.loop},setLoop:function(t){if(!1!==this.hasPlaybackControl)return this.loop=t,!0===this.isPlaying&&(this.source.loop=this.loop),this},setLoopStart:function(t){return this.loopStart=t,this},setLoopEnd:function(t){return this.loopEnd=t,this},getVolume:function(){return this.gain.gain.value},setVolume:function(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}});var Kwt=new adt,Jwt=new rdt,Qwt=new adt,tSt=new adt;function eSt(t){$wt.call(this,t),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}function nSt(t,e){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=void 0!==e?e:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}function rSt(t,e,n){this.binding=t,this.valueSize=n;var r,i=Float64Array;switch(e){case"quaternion":r=this._slerp;break;case"string":case"bool":i=Array,r=this._select;break;default:r=this._lerp}this.buffer=new i(4*n),this._mixBufferRegion=r,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}eSt.prototype=Object.assign(Object.create($wt.prototype),{constructor:eSt,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(t){return this.panner.refDistance=t,this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(t){return this.panner.rolloffFactor=t,this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(t){return this.panner.distanceModel=t,this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(t){return this.panner.maxDistance=t,this},setDirectionalCone:function(t,e,n){return this.panner.coneInnerAngle=t,this.panner.coneOuterAngle=e,this.panner.coneOuterGain=n,this},updateMatrixWorld:function(t){if(Ldt.prototype.updateMatrixWorld.call(this,t),!0!==this.hasPlaybackControl||!1!==this.isPlaying){this.matrixWorld.decompose(Kwt,Jwt,Qwt),tSt.set(0,0,1).applyQuaternion(Jwt);var e=this.panner;if(e.positionX){var n=this.context.currentTime+this.listener.timeDelta;e.positionX.linearRampToValueAtTime(Kwt.x,n),e.positionY.linearRampToValueAtTime(Kwt.y,n),e.positionZ.linearRampToValueAtTime(Kwt.z,n),e.orientationX.linearRampToValueAtTime(tSt.x,n),e.orientationY.linearRampToValueAtTime(tSt.y,n),e.orientationZ.linearRampToValueAtTime(tSt.z,n)}else e.setPosition(Kwt.x,Kwt.y,Kwt.z),e.setOrientation(tSt.x,tSt.y,tSt.z)}}}),Object.assign(nSt.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var t=0,e=this.getFrequencyData(),n=0;n<e.length;n++)t+=e[n];return t/e.length}}),Object.assign(rSt.prototype,{accumulate:function(t,e){var n=this.buffer,r=this.valueSize,i=t*r+r,o=this.cumulativeWeight;if(0===o){for(var a=0;a!==r;++a)n[i+a]=n[a];o=e}else{var s=e/(o+=e);this._mixBufferRegion(n,i,0,s,r)}this.cumulativeWeight=o},apply:function(t){var e=this.valueSize,n=this.buffer,r=t*e+e,i=this.cumulativeWeight,o=this.binding;if(this.cumulativeWeight=0,i<1){var a=3*e;this._mixBufferRegion(n,r,a,1-i,e)}for(var s=e,u=e+e;s!==u;++s)if(n[s]!==n[s+e]){o.setValue(n,r);break}},saveOriginalState:function(){var t=this.binding,e=this.buffer,n=this.valueSize,r=3*n;t.getValue(e,r);for(var i=n,o=r;i!==o;++i)e[i]=e[r+i%n];this.cumulativeWeight=0},restoreOriginalState:function(){var t=3*this.valueSize;this.binding.setValue(this.buffer,t)},_select:function(t,e,n,r,i){if(r>=.5)for(var o=0;o!==i;++o)t[e+o]=t[n+o]},_slerp:function(t,e,n,r){rdt.slerpFlat(t,e,t,e,t,n,r)},_lerp:function(t,e,n,r,i){for(var o=1-r,a=0;a!==i;++a){var s=e+a;t[s]=t[s]*o+t[n+a]*r}}});var iSt="\\[\\]\\.:\\/",oSt=new RegExp("["+iSt+"]","g"),aSt="[^"+iSt+"]",sSt="[^"+iSt.replace("\\.","")+"]",uSt=/((?:WC+[\/:])*)/.source.replace("WC",aSt),cSt=/(WCOD+)?/.source.replace("WCOD",sSt),lSt=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",aSt),hSt=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",aSt),fSt=new RegExp("^"+uSt+cSt+lSt+hSt+"$"),pSt=["material","materials","bones"];function dSt(t,e,n){var r=n||mSt.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,r)}function mSt(t,e,n){this.path=e,this.parsedPath=n||mSt.parseTrackName(e),this.node=mSt.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t}function vSt(t,e,n){this._mixer=t,this._clip=e,this._localRoot=n||null;for(var r=e.tracks,i=r.length,o=new Array(i),a={endingStart:Npt,endingEnd:Npt},s=0;s!==i;++s){var u=r[s].createInterpolant(null);o[s]=u,u.settings=a}this._interpolantSettings=a,this._interpolants=o,this._propertyBindings=new Array(i),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function gSt(t){this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function ySt(t){"string"==typeof t&&(t=arguments[1]),this.value=t}function xSt(t,e,n){Vyt.call(this,t,e),this.meshPerAttribute=n||1}function bSt(t,e,n,r){this.ray=new imt(t,e),this.near=n||0,this.far=r||1/0,this.camera=null,this.layers=new ydt,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return this.Points}}})}function _St(t,e){return t.distance-e.distance}function wSt(t,e,n,r){if(t.layers.test(e.layers)&&t.raycast(e,n),!0===r)for(var i=t.children,o=0,a=i.length;o<a;o++)wSt(i[o],e,n,!0)}Object.assign(dSt.prototype,{getValue:function(t,e){this.bind();var n=this._targetGroup.nCachedObjects_,r=this._bindings[n];void 0!==r&&r.getValue(t,e)},setValue:function(t,e){for(var n=this._bindings,r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(t,e)},bind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].bind()},unbind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].unbind()}}),Object.assign(mSt,{Composite:dSt,create:function(t,e,n){return t&&t.isAnimationObjectGroup?new mSt.Composite(t,e,n):new mSt(t,e,n)},sanitizeNodeName:function(t){return t.replace(/\s/g,"_").replace(oSt,"")},parseTrackName:function(t){var e=fSt.exec(t);if(!e)throw new Error("PropertyBinding: Cannot parse trackName: "+t);var n={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){var i=n.nodeName.substring(r+1);-1!==pSt.indexOf(i)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=i)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return n},findNode:function(t,e){if(!e||""===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){var n=t.skeleton.getBoneByName(e);if(void 0!==n)return n}if(t.children){var r=function(t){for(var n=0;n<t.length;n++){var i=t[n];if(i.name===e||i.uuid===e)return i;var o=r(i.children);if(o)return o}return null},i=r(t.children);if(i)return i}return null}}),Object.assign(mSt.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,e){t[e]=this.node[this.propertyName]},function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)t[e++]=n[r]},function(t,e){t[e]=this.resolvedProperty[this.propertyIndex]},function(t,e){this.resolvedProperty.toArray(t,e)}],SetterByBindingTypeAndVersioning:[[function(t,e){this.targetObject[this.propertyName]=t[e]},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=t[e++]},function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=t[e++];this.targetObject.needsUpdate=!0},function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty[this.propertyIndex]=t[e]},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty.fromArray(t,e)},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(t,e){this.bind(),this.getValue(t,e)},setValue:function(t,e){this.bind(),this.setValue(t,e)},bind:function(){var t=this.node,e=this.parsedPath,n=e.objectName,r=e.propertyName,i=e.propertyIndex;if(t||(t=mSt.findNode(this.rootNode,e.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,t){if(n){var o=e.objectIndex;switch(n){case"materials":if(!t.material)return;if(!t.material.materials)return;t=t.material.materials;break;case"bones":if(!t.skeleton)return;t=t.skeleton.bones;for(var a=0;a<t.length;a++)if(t[a].name===o){o=a;break}break;default:if(void 0===t[n])return;t=t[n]}if(void 0!==o){if(void 0===t[o])return;t=t[o]}}var s=t[r];if(void 0!==s){var u=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?u=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(u=this.Versioning.MatrixWorldNeedsUpdate);var c=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===r){if(!t.geometry)return;if(t.geometry.isBufferGeometry){if(!t.geometry.morphAttributes)return;for(a=0;a<this.node.geometry.morphAttributes.position.length;a++)if(t.geometry.morphAttributes.position[a].name===i){i=a;break}}else{if(!t.geometry.morphTargets)return;for(a=0;a<this.node.geometry.morphTargets.length;a++)if(t.geometry.morphTargets[a].name===i){i=a;break}}}c=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=i}else void 0!==s.fromArray&&void 0!==s.toArray?(c=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(c=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=r;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][u]}else e.nodeName}},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(mSt.prototype,{_getValue_unbound:mSt.prototype.getValue,_setValue_unbound:mSt.prototype.setValue}),Object.assign(function(){this.uuid=qpt.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var t={};this._indicesByUUID=t;for(var e=0,n=arguments.length;e!==n;++e)t[arguments[e].uuid]=e;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var r=this;this.stats={objects:{get total(){return r._objects.length},get inUse(){return this.total-r.nCachedObjects_}},get bindingsPerObject(){return r._bindings.length}}}.prototype,{isAnimationObjectGroup:!0,add:function(){for(var t=this._objects,e=t.length,n=this.nCachedObjects_,r=this._indicesByUUID,i=this._paths,o=this._parsedPaths,a=this._bindings,s=a.length,u=0,c=arguments.length;u!==c;++u){var l=arguments[u],h=l.uuid,f=r[h];if(void 0===f){f=e++,r[h]=f,t.push(l);for(var p=0,d=s;p!==d;++p)a[p].push(new mSt(l,i[p],o[p]))}else if(f<n){t[f];var m=--n,v=t[m];r[v.uuid]=f,t[f]=v,r[h]=m,t[m]=l;for(p=0,d=s;p!==d;++p){var g=a[p],y=g[m],x=g[f];g[f]=y,void 0===x&&(x=new mSt(l,i[p],o[p])),g[m]=x}}else t[f]}this.nCachedObjects_=n},remove:function(){for(var t=this._objects,e=this.nCachedObjects_,n=this._indicesByUUID,r=this._bindings,i=r.length,o=0,a=arguments.length;o!==a;++o){var s=arguments[o],u=s.uuid,c=n[u];if(void 0!==c&&c>=e){var l=e++,h=t[l];n[h.uuid]=c,t[c]=h,n[u]=l,t[l]=s;for(var f=0,p=i;f!==p;++f){var d=r[f],m=d[l],v=d[c];d[c]=m,d[l]=v}}}this.nCachedObjects_=e},uncache:function(){for(var t=this._objects,e=t.length,n=this.nCachedObjects_,r=this._indicesByUUID,i=this._bindings,o=i.length,a=0,s=arguments.length;a!==s;++a){var u=arguments[a],c=u.uuid,l=r[c];if(void 0!==l)if(delete r[c],l<n){var h=--n,f=t[h],p=t[y=--e];r[f.uuid]=l,t[l]=f,r[p.uuid]=h,t[h]=p,t.pop();for(var d=0,m=o;d!==m;++d){var v=(x=i[d])[h],g=x[y];x[l]=v,x[h]=g,x.pop()}}else{var y;r[(p=t[y=--e]).uuid]=l,t[l]=p,t.pop();for(d=0,m=o;d!==m;++d){var x;(x=i[d])[l]=x[y],x.pop()}}}this.nCachedObjects_=n},subscribe_:function(t,e){var n=this._bindingsIndicesByPath,r=n[t],i=this._bindings;if(void 0!==r)return i[r];var o=this._paths,a=this._parsedPaths,s=this._objects,u=s.length,c=this.nCachedObjects_,l=new Array(u);r=i.length,n[t]=r,o.push(t),a.push(e),i.push(l);for(var h=c,f=s.length;h!==f;++h){var p=s[h];l[h]=new mSt(p,t,e)}return l},unsubscribe_:function(t){var e=this._bindingsIndicesByPath,n=e[t];if(void 0!==n){var r=this._paths,i=this._parsedPaths,o=this._bindings,a=o.length-1,s=o[a];e[t[a]]=n,o[n]=s,o.pop(),i[n]=i[a],i.pop(),r[n]=r[a],r.pop()}}}),Object.assign(vSt.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(t){return this._startTime=t,this},setLoop:function(t,e){return this.loop=t,this.repetitions=e,this},setEffectiveWeight:function(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(t){return this._scheduleFading(t,0,1)},fadeOut:function(t){return this._scheduleFading(t,1,0)},crossFadeFrom:function(t,e,n){if(t.fadeOut(e),this.fadeIn(e),n){var r=this._clip.duration,i=t._clip.duration,o=i/r,a=r/i;t.warp(1,o,e),this.warp(a,1,e)}return this},crossFadeTo:function(t,e,n){return t.crossFadeFrom(this,e,n)},stopFading:function(){var t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},setEffectiveTimeScale:function(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(t){return this.timeScale=this._clip.duration/t,this.stopWarping()},syncWith:function(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()},halt:function(t){return this.warp(this._effectiveTimeScale,0,t)},warp:function(t,e,n){var r=this._mixer,i=r.time,o=this._timeScaleInterpolant,a=this.timeScale;null===o&&(o=r._lendControlInterpolant(),this._timeScaleInterpolant=o);var s=o.parameterPositions,u=o.sampleValues;return s[0]=i,s[1]=i+n,u[0]=t/a,u[1]=e/a,this},stopWarping:function(){var t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(t,e,n,r){if(this.enabled){var i=this._startTime;if(null!==i){var o=(t-i)*n;if(o<0||0===n)return;this._startTime=null,e=n*o}e*=this._updateTimeScale(t);var a=this._updateTime(e),s=this._updateWeight(t);if(s>0)for(var u=this._interpolants,c=this._propertyBindings,l=0,h=u.length;l!==h;++l)u[l].evaluate(a),c[l].accumulate(r,s)}else this._updateWeight(t)},_updateWeight:function(t){var e=0;if(this.enabled){e=this.weight;var n=this._weightInterpolant;if(null!==n){var r=n.evaluate(t)[0];e*=r,t>n.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=e,e},_updateTimeScale:function(t){var e=0;if(!this.paused){e=this.timeScale;var n=this._timeScaleInterpolant;if(null!==n)e*=n.evaluate(t)[0],t>n.parameterPositions[1]&&(this.stopWarping(),0===e?this.paused=!0:this.timeScale=e)}return this._effectiveTimeScale=e,e},_updateTime:function(t){var e=this.time+t,n=this._clip.duration,r=this.loop,i=this._loopCount,o=2202===r;if(0===t)return-1===i?e:o&&1==(1&i)?n-e:e;if(2200===r){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));t:{if(e>=n)e=n;else{if(!(e<0)){this.time=e;break t}e=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=e,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(-1===i&&(t>=0?(i=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),e>=n||e<0){var a=Math.floor(e/n);e-=n*a,i+=Math.abs(a);var s=this.repetitions-i;if(s<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,e=t>0?n:0,this.time=e,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(1===s){var u=t<0;this._setEndings(u,!u,o)}else this._setEndings(!1,!1,o);this._loopCount=i,this.time=e,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=e;if(o&&1==(1&i))return n-e}return e},_setEndings:function(t,e,n){var r=this._interpolantSettings;n?(r.endingStart=Dpt,r.endingEnd=Dpt):(r.endingStart=t?this.zeroSlopeAtStart?Dpt:Npt:Fpt,r.endingEnd=e?this.zeroSlopeAtEnd?Dpt:Npt:Fpt)},_scheduleFading:function(t,e,n){var r=this._mixer,i=r.time,o=this._weightInterpolant;null===o&&(o=r._lendControlInterpolant(),this._weightInterpolant=o);var a=o.parameterPositions,s=o.sampleValues;return a[0]=i,s[0]=e,a[1]=i+t,s[1]=n,this}}),gSt.prototype=Object.assign(Object.create(Wpt.prototype),{constructor:gSt,_bindAction:function(t,e){var n=t._localRoot||this._root,r=t._clip.tracks,i=r.length,o=t._propertyBindings,a=t._interpolants,s=n.uuid,u=this._bindingsByRootAndName,c=u[s];void 0===c&&(c={},u[s]=c);for(var l=0;l!==i;++l){var h=r[l],f=h.name,p=c[f];if(void 0!==p)o[l]=p;else{if(void 0!==(p=o[l])){null===p._cacheIndex&&(++p.referenceCount,this._addInactiveBinding(p,s,f));continue}var d=e&&e._propertyBindings[l].binding.parsedPath;++(p=new rSt(mSt.create(n,f,d),h.ValueTypeName,h.getValueSize())).referenceCount,this._addInactiveBinding(p,s,f),o[l]=p}a[l].resultBuffer=p.buffer}},_activateAction:function(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){var e=(t._localRoot||this._root).uuid,n=t._clip.uuid,r=this._actionsByClip[n];this._bindAction(t,r&&r.knownActions[0]),this._addInactiveAction(t,n,e)}for(var i=t._propertyBindings,o=0,a=i.length;o!==a;++o){var s=i[o];0==s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(t)}},_deactivateAction:function(t){if(this._isActiveAction(t)){for(var e=t._propertyBindings,n=0,r=e.length;n!==r;++n){var i=e[n];0==--i.useCount&&(i.restoreOriginalState(),this._takeBackBinding(i))}this._takeBackAction(t)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}},_isActiveAction:function(t){var e=t._cacheIndex;return null!==e&&e<this._nActiveActions},_addInactiveAction:function(t,e,n){var r=this._actions,i=this._actionsByClip,o=i[e];if(void 0===o)o={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,i[e]=o;else{var a=o.knownActions;t._byClipCacheIndex=a.length,a.push(t)}t._cacheIndex=r.length,r.push(t),o.actionByRoot[n]=t},_removeInactiveAction:function(t){var e=this._actions,n=e[e.length-1],r=t._cacheIndex;n._cacheIndex=r,e[r]=n,e.pop(),t._cacheIndex=null;var i=t._clip.uuid,o=this._actionsByClip,a=o[i],s=a.knownActions,u=s[s.length-1],c=t._byClipCacheIndex;u._byClipCacheIndex=c,s[c]=u,s.pop(),t._byClipCacheIndex=null,delete a.actionByRoot[(t._localRoot||this._root).uuid],0===s.length&&delete o[i],this._removeInactiveBindingsForAction(t)},_removeInactiveBindingsForAction:function(t){for(var e=t._propertyBindings,n=0,r=e.length;n!==r;++n){var i=e[n];0==--i.referenceCount&&this._removeInactiveBinding(i)}},_lendAction:function(t){var e=this._actions,n=t._cacheIndex,r=this._nActiveActions++,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_takeBackAction:function(t){var e=this._actions,n=t._cacheIndex,r=--this._nActiveActions,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_addInactiveBinding:function(t,e,n){var r=this._bindingsByRootAndName,i=r[e],o=this._bindings;void 0===i&&(i={},r[e]=i),i[n]=t,t._cacheIndex=o.length,o.push(t)},_removeInactiveBinding:function(t){var e=this._bindings,n=t.binding,r=n.rootNode.uuid,i=n.path,o=this._bindingsByRootAndName,a=o[r],s=e[e.length-1],u=t._cacheIndex;s._cacheIndex=u,e[u]=s,e.pop(),delete a[i],0===Object.keys(a).length&&delete o[r]},_lendBinding:function(t){var e=this._bindings,n=t._cacheIndex,r=this._nActiveBindings++,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_takeBackBinding:function(t){var e=this._bindings,n=t._cacheIndex,r=--this._nActiveBindings,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_lendControlInterpolant:function(){var t=this._controlInterpolants,e=this._nActiveControlInterpolants++,n=t[e];return void 0===n&&((n=new m_t(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=e,t[e]=n),n},_takeBackControlInterpolant:function(t){var e=this._controlInterpolants,n=t.__cacheIndex,r=--this._nActiveControlInterpolants,i=e[r];t.__cacheIndex=r,e[r]=t,i.__cacheIndex=n,e[n]=i},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(t,e){var n=e||this._root,r=n.uuid,i="string"==typeof t?E_t.findByName(n,t):t,o=null!==i?i.uuid:t,a=this._actionsByClip[o],s=null;if(void 0!==a){var u=a.actionByRoot[r];if(void 0!==u)return u;s=a.knownActions[0],null===i&&(i=s._clip)}if(null===i)return null;var c=new vSt(this,i,e);return this._bindAction(c,s),this._addInactiveAction(c,o,r),c},existingAction:function(t,e){var n=e||this._root,r=n.uuid,i="string"==typeof t?E_t.findByName(n,t):t,o=i?i.uuid:t,a=this._actionsByClip[o];return void 0!==a&&a.actionByRoot[r]||null},stopAllAction:function(){var t=this._actions,e=this._nActiveActions,n=this._bindings,r=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var i=0;i!==e;++i)t[i].reset();for(i=0;i!==r;++i)n[i].useCount=0;return this},update:function(t){t*=this.timeScale;for(var e=this._actions,n=this._nActiveActions,r=this.time+=t,i=Math.sign(t),o=this._accuIndex^=1,a=0;a!==n;++a){e[a]._update(r,t,i,o)}var s=this._bindings,u=this._nActiveBindings;for(a=0;a!==u;++a)s[a].apply(o);return this},setTime:function(t){this.time=0;for(var e=0;e<this._actions.length;e++)this._actions[e].time=0;return this.update(t)},getRoot:function(){return this._root},uncacheClip:function(t){var e=this._actions,n=t.uuid,r=this._actionsByClip,i=r[n];if(void 0!==i){for(var o=i.knownActions,a=0,s=o.length;a!==s;++a){var u=o[a];this._deactivateAction(u);var c=u._cacheIndex,l=e[e.length-1];u._cacheIndex=null,u._byClipCacheIndex=null,l._cacheIndex=c,e[c]=l,e.pop(),this._removeInactiveBindingsForAction(u)}delete r[n]}},uncacheRoot:function(t){var e=t.uuid,n=this._actionsByClip;for(var r in n){var i=n[r].actionByRoot[e];void 0!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}var o=this._bindingsByRootAndName[e];if(void 0!==o)for(var a in o){var s=o[a];s.restoreOriginalState(),this._removeInactiveBinding(s)}},uncacheAction:function(t,e){var n=this.existingAction(t,e);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}),ySt.prototype.clone=function(){return new ySt(void 0===this.value.clone?this.value:this.value.clone())},xSt.prototype=Object.assign(Object.create(Vyt.prototype),{constructor:xSt,isInstancedInterleavedBuffer:!0,copy:function(t){return Vyt.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this}}),Object.assign(bSt.prototype,{set:function(t,e){this.ray.set(t,e)},setFromCamera:function(t,e){e&&e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize(),this.camera=e):e&&e.isOrthographicCamera&&(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld),this.camera=e)},intersectObject:function(t,e,n){var r=n||[];return wSt(t,this,r,e),r.sort(_St),r},intersectObjects:function(t,e,n){var r=n||[];if(!1===Array.isArray(t))return r;for(var i=0,o=t.length;i<o;i++)wSt(t[i],this,r,e);return r.sort(_St),r}}),Object.assign(function(t,e,n){return this.radius=void 0!==t?t:1,this.phi=void 0!==e?e:0,this.theta=void 0!==n?n:0,this}.prototype,{set:function(t,e,n){return this.radius=t,this.phi=e,this.theta=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this},makeSafe:function(){var t=1e-6;return this.phi=Math.max(t,Math.min(Math.PI-t,this.phi)),this},setFromVector3:function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},setFromCartesianCoords:function(t,e,n){return this.radius=Math.sqrt(t*t+e*e+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t,n),this.phi=Math.acos(qpt.clamp(e/this.radius,-1,1))),this}}),Object.assign(function(t,e,n){return this.radius=void 0!==t?t:1,this.theta=void 0!==e?e:0,this.y=void 0!==n?n:0,this}.prototype,{set:function(t,e,n){return this.radius=t,this.theta=e,this.y=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this},setFromVector3:function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},setFromCartesianCoords:function(t,e,n){return this.radius=Math.sqrt(t*t+n*n),this.theta=Math.atan2(t,n),this.y=e,this}});var SSt=new Zpt;function MSt(t,e){this.min=void 0!==t?t:new Zpt(1/0,1/0),this.max=void 0!==e?e:new Zpt(-1/0,-1/0)}Object.assign(MSt.prototype,{set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(t,e){var n=SSt.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(t){return void 0===t&&(t=new Zpt),this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return void 0===t&&(t=new Zpt),this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y},getParameter:function(t,e){return void 0===e&&(e=new Zpt),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)},clampPoint:function(t,e){return void 0===e&&(e=new Zpt),e.copy(t).clamp(this.min,this.max)},distanceToPoint:function(t){return SSt.copy(t).clamp(this.min,this.max).sub(t).length()},intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}});var ESt=new adt,ASt=new adt;function TSt(t,e){this.start=void 0!==t?t:new adt,this.end=void 0!==e?e:new adt}function CSt(t){Ldt.call(this),this.material=t,this.render=function(){}}Object.assign(TSt.prototype,{set:function(t,e){return this.start.copy(t),this.end.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.start.copy(t.start),this.end.copy(t.end),this},getCenter:function(t){return void 0===t&&(t=new adt),t.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(t){return void 0===t&&(t=new adt),t.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(t,e){return void 0===e&&(e=new adt),this.delta(e).multiplyScalar(t).add(this.start)},closestPointToPointParameter:function(t,e){ESt.subVectors(t,this.start),ASt.subVectors(this.end,this.start);var n=ASt.dot(ASt),r=ASt.dot(ESt)/n;return e&&(r=qpt.clamp(r,0,1)),r},closestPointToPoint:function(t,e,n){var r=this.closestPointToPointParameter(t,e);return void 0===n&&(n=new adt),this.delta(n).multiplyScalar(r).add(this.start)},applyMatrix4:function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},equals:function(t){return t.start.equals(this.start)&&t.end.equals(this.end)}}),CSt.prototype=Object.create(Ldt.prototype),CSt.prototype.constructor=CSt,CSt.prototype.isImmediateRenderObject=!0;var OSt=new adt;function kSt(t,e){Ldt.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=e;for(var n=new Kmt,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],i=0,o=1;i<32;i++,o++){var a=i/32*Math.PI*2,s=o/32*Math.PI*2;r.push(Math.cos(a),Math.sin(a),1,Math.cos(s),Math.sin(s),1)}n.setAttribute("position",new zmt(r,3));var u=new bxt({fog:!1,toneMapped:!1});this.cone=new Oxt(n,u),this.add(this.cone),this.update()}kSt.prototype=Object.create(Ldt.prototype),kSt.prototype.constructor=kSt,kSt.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},kSt.prototype.update=function(){this.light.updateMatrixWorld();var t=this.light.distance?this.light.distance:1e3,e=t*Math.tan(this.light.angle);this.cone.scale.set(e,e,t),OSt.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(OSt),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)};var PSt=new adt,LSt=new ddt,RSt=new ddt;function ISt(t){var e=[];t&&t.isBone&&e.push(t);for(var n=0;n<t.children.length;n++)e.push.apply(e,ISt(t.children[n]));return e}function NSt(t){for(var e=ISt(t),n=new Kmt,r=[],i=[],o=new Smt(0,0,1),a=new Smt(0,1,0),s=0;s<e.length;s++){var u=e[s];u.parent&&u.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),i.push(o.r,o.g,o.b),i.push(a.r,a.g,a.b))}n.setAttribute("position",new zmt(r,3)),n.setAttribute("color",new zmt(i,3));var c=new bxt({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});Oxt.call(this,n,c),this.root=t,this.bones=e,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}function DSt(t,e,n){this.light=t,this.light.updateMatrixWorld(),this.color=n;var r=new Bbt(e,4,2),i=new kmt({wireframe:!0,fog:!1,toneMapped:!1});mvt.call(this,r,i),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}NSt.prototype=Object.create(Oxt.prototype),NSt.prototype.constructor=NSt,NSt.prototype.isSkeletonHelper=!0,NSt.prototype.updateMatrixWorld=function(t){var e=this.bones,n=this.geometry,r=n.getAttribute("position");RSt.getInverse(this.root.matrixWorld);for(var i=0,o=0;i<e.length;i++){var a=e[i];a.parent&&a.parent.isBone&&(LSt.multiplyMatrices(RSt,a.matrixWorld),PSt.setFromMatrixPosition(LSt),r.setXYZ(o,PSt.x,PSt.y,PSt.z),LSt.multiplyMatrices(RSt,a.parent.matrixWorld),PSt.setFromMatrixPosition(LSt),r.setXYZ(o+1,PSt.x,PSt.y,PSt.z),o+=2)}n.getAttribute("position").needsUpdate=!0,Ldt.prototype.updateMatrixWorld.call(this,t)},DSt.prototype=Object.create(mvt.prototype),DSt.prototype.constructor=DSt,DSt.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},DSt.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)};var FSt=new adt,jSt=new Smt,BSt=new Smt;function zSt(t,e,n){Ldt.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=n;var r=new $xt(e);r.rotateY(.5*Math.PI),this.material=new kmt({wireframe:!0,fog:!1,toneMapped:!1}),void 0===this.color&&(this.material.vertexColors=!0);var i=r.getAttribute("position"),o=new Float32Array(3*i.count);r.setAttribute("color",new Lmt(o,3)),this.add(new mvt(r,this.material)),this.update()}function USt(t,e,n,r){t=t||10,e=e||10,n=new Smt(void 0!==n?n:4473924),r=new Smt(void 0!==r?r:8947848);for(var i=e/2,o=t/e,a=t/2,s=[],u=[],c=0,l=0,h=-a;c<=e;c++,h+=o){s.push(-a,0,h,a,0,h),s.push(h,0,-a,h,0,a);var f=c===i?n:r;f.toArray(u,l),l+=3,f.toArray(u,l),l+=3,f.toArray(u,l),l+=3,f.toArray(u,l),l+=3}var p=new Kmt;p.setAttribute("position",new zmt(s,3)),p.setAttribute("color",new zmt(u,3));var d=new bxt({vertexColors:!0,toneMapped:!1});Oxt.call(this,p,d)}function VSt(t,e,n,r,i,o){t=t||10,e=e||16,n=n||8,r=r||64,i=new Smt(void 0!==i?i:4473924),o=new Smt(void 0!==o?o:8947848);var a,s,u,c,l,h,f,p=[],d=[];for(c=0;c<=e;c++)u=c/e*(2*Math.PI),a=Math.sin(u)*t,s=Math.cos(u)*t,p.push(0,0,0),p.push(a,0,s),f=1&c?i:o,d.push(f.r,f.g,f.b),d.push(f.r,f.g,f.b);for(c=0;c<=n;c++)for(f=1&c?i:o,h=t-t/n*c,l=0;l<r;l++)u=l/r*(2*Math.PI),a=Math.sin(u)*h,s=Math.cos(u)*h,p.push(a,0,s),d.push(f.r,f.g,f.b),u=(l+1)/r*(2*Math.PI),a=Math.sin(u)*h,s=Math.cos(u)*h,p.push(a,0,s),d.push(f.r,f.g,f.b);var m=new Kmt;m.setAttribute("position",new zmt(p,3)),m.setAttribute("color",new zmt(d,3));var v=new bxt({vertexColors:!0,toneMapped:!1});Oxt.call(this,m,v)}zSt.prototype=Object.create(Ldt.prototype),zSt.prototype.constructor=zSt,zSt.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},zSt.prototype.update=function(){var t=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var e=t.geometry.getAttribute("color");jSt.copy(this.light.color),BSt.copy(this.light.groundColor);for(var n=0,r=e.count;n<r;n++){var i=n<r/2?jSt:BSt;e.setXYZ(n,i.r,i.g,i.b)}e.needsUpdate=!0}t.lookAt(FSt.setFromMatrixPosition(this.light.matrixWorld).negate())},USt.prototype=Object.assign(Object.create(Oxt.prototype),{constructor:USt,copy:function(t){return Oxt.prototype.copy.call(this,t),this.geometry.copy(t.geometry),this.material.copy(t.material),this},clone:function(){return(new this.constructor).copy(this)}}),VSt.prototype=Object.create(Oxt.prototype),VSt.prototype.constructor=VSt;var GSt=new adt,WSt=new adt,HSt=new adt;function YSt(t,e,n){Ldt.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,void 0===e&&(e=1);var r=new Kmt;r.setAttribute("position",new zmt([-e,e,0,e,e,0,e,-e,0,-e,-e,0,-e,e,0],3));var i=new bxt({fog:!1,toneMapped:!1});this.lightPlane=new Axt(r,i),this.add(this.lightPlane),(r=new Kmt).setAttribute("position",new zmt([0,0,0,0,0,1],3)),this.targetLine=new Axt(r,i),this.add(this.targetLine),this.update()}YSt.prototype=Object.create(Ldt.prototype),YSt.prototype.constructor=YSt,YSt.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},YSt.prototype.update=function(){GSt.setFromMatrixPosition(this.light.matrixWorld),WSt.setFromMatrixPosition(this.light.target.matrixWorld),HSt.subVectors(WSt,GSt),this.lightPlane.lookAt(WSt),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(WSt),this.targetLine.scale.z=HSt.length()};var XSt=new adt,qSt=new Cvt;function ZSt(t){var e=new Kmt,n=new bxt({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],i=[],o={},a=new Smt(16755200),s=new Smt(16711680),u=new Smt(43775),c=new Smt(16777215),l=new Smt(3355443);function h(t,e,n){f(t,n),f(e,n)}function f(t,e){r.push(0,0,0),i.push(e.r,e.g,e.b),void 0===o[t]&&(o[t]=[]),o[t].push(r.length/3-1)}h("n1","n2",a),h("n2","n4",a),h("n4","n3",a),h("n3","n1",a),h("f1","f2",a),h("f2","f4",a),h("f4","f3",a),h("f3","f1",a),h("n1","f1",a),h("n2","f2",a),h("n3","f3",a),h("n4","f4",a),h("p","n1",s),h("p","n2",s),h("p","n3",s),h("p","n4",s),h("u1","u2",u),h("u2","u3",u),h("u3","u1",u),h("c","t",c),h("p","c",l),h("cn1","cn2",l),h("cn3","cn4",l),h("cf1","cf2",l),h("cf3","cf4",l),e.setAttribute("position",new zmt(r,3)),e.setAttribute("color",new zmt(i,3)),Oxt.call(this,e,n),this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update()}function $St(t,e,n,r,i,o,a){XSt.set(i,o,a).unproject(r);var s=e[t];if(void 0!==s)for(var u=n.getAttribute("position"),c=0,l=s.length;c<l;c++)u.setXYZ(s[c],XSt.x,XSt.y,XSt.z)}ZSt.prototype=Object.create(Oxt.prototype),ZSt.prototype.constructor=ZSt,ZSt.prototype.update=function(){var t=this.geometry,e=this.pointMap;qSt.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),$St("c",e,t,qSt,0,0,-1),$St("t",e,t,qSt,0,0,1),$St("n1",e,t,qSt,-1,-1,-1),$St("n2",e,t,qSt,1,-1,-1),$St("n3",e,t,qSt,-1,1,-1),$St("n4",e,t,qSt,1,1,-1),$St("f1",e,t,qSt,-1,-1,1),$St("f2",e,t,qSt,1,-1,1),$St("f3",e,t,qSt,-1,1,1),$St("f4",e,t,qSt,1,1,1),$St("u1",e,t,qSt,.7,1.1,-1),$St("u2",e,t,qSt,-.7,1.1,-1),$St("u3",e,t,qSt,0,2,-1),$St("cf1",e,t,qSt,-1,0,1),$St("cf2",e,t,qSt,1,0,1),$St("cf3",e,t,qSt,0,-1,1),$St("cf4",e,t,qSt,0,1,1),$St("cn1",e,t,qSt,-1,0,-1),$St("cn2",e,t,qSt,1,0,-1),$St("cn3",e,t,qSt,0,-1,-1),$St("cn4",e,t,qSt,0,1,-1),t.getAttribute("position").needsUpdate=!0};var KSt=new Xdt;function JSt(t,e){this.object=t,void 0===e&&(e=16776960);var n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(24),i=new Kmt;i.setIndex(new Lmt(n,1)),i.setAttribute("position",new Lmt(r,3)),Oxt.call(this,i,new bxt({color:e,toneMapped:!1})),this.matrixAutoUpdate=!1,this.update()}function QSt(t,e){this.type="Box3Helper",this.box=t,e=e||16776960;var n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Kmt;r.setIndex(new Lmt(n,1)),r.setAttribute("position",new zmt([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),Oxt.call(this,r,new bxt({color:e,toneMapped:!1})),this.geometry.computeBoundingSphere()}function tMt(t,e,n){this.type="PlaneHelper",this.plane=t,this.size=void 0===e?1:e;var r=void 0!==n?n:16776960,i=new Kmt;i.setAttribute("position",new zmt([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),i.computeBoundingSphere(),Axt.call(this,i,new bxt({color:r,toneMapped:!1}));var o=new Kmt;o.setAttribute("position",new zmt([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),o.computeBoundingSphere(),this.add(new mvt(o,new kmt({color:r,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}JSt.prototype=Object.create(Oxt.prototype),JSt.prototype.constructor=JSt,JSt.prototype.update=function(t){if(void 0!==this.object&&KSt.setFromObject(this.object),!KSt.isEmpty()){var e=KSt.min,n=KSt.max,r=this.geometry.attributes.position,i=r.array;i[0]=n.x,i[1]=n.y,i[2]=n.z,i[3]=e.x,i[4]=n.y,i[5]=n.z,i[6]=e.x,i[7]=e.y,i[8]=n.z,i[9]=n.x,i[10]=e.y,i[11]=n.z,i[12]=n.x,i[13]=n.y,i[14]=e.z,i[15]=e.x,i[16]=n.y,i[17]=e.z,i[18]=e.x,i[19]=e.y,i[20]=e.z,i[21]=n.x,i[22]=e.y,i[23]=e.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}},JSt.prototype.setFromObject=function(t){return this.object=t,this.update(),this},JSt.prototype.copy=function(t){return Oxt.prototype.copy.call(this,t),this.object=t.object,this},JSt.prototype.clone=function(){return(new this.constructor).copy(this)},QSt.prototype=Object.create(Oxt.prototype),QSt.prototype.constructor=QSt,QSt.prototype.updateMatrixWorld=function(t){var e=this.box;e.isEmpty()||(e.getCenter(this.position),e.getSize(this.scale),this.scale.multiplyScalar(.5),Ldt.prototype.updateMatrixWorld.call(this,t))},tMt.prototype=Object.create(Axt.prototype),tMt.prototype.constructor=tMt,tMt.prototype.updateMatrixWorld=function(t){var e=-this.plane.constant;Math.abs(e)<1e-8&&(e=1e-8),this.scale.set(.5*this.size,.5*this.size,e),this.children[0].material.side=e<0?1:0,this.lookAt(this.plane.normal),Ldt.prototype.updateMatrixWorld.call(this,t)};var eMt,nMt,rMt=new adt;function iMt(t,e,n,r,i,o){Ldt.call(this),void 0===t&&(t=new adt(0,0,1)),void 0===e&&(e=new adt(0,0,0)),void 0===n&&(n=1),void 0===r&&(r=16776960),void 0===i&&(i=.2*n),void 0===o&&(o=.2*i),void 0===eMt&&((eMt=new Kmt).setAttribute("position",new zmt([0,0,0,0,1,0],3)),(nMt=new Zbt(0,.5,1,5,1)).translate(0,-.5,0)),this.position.copy(e),this.line=new Axt(eMt,new bxt({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new mvt(nMt,new kmt({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(t),this.setLength(n,i,o)}function oMt(t){var e=[0,0,0,t=t||1,0,0,0,0,0,0,t,0,0,0,0,0,0,t],n=new Kmt;n.setAttribute("position",new zmt(e,3)),n.setAttribute("color",new zmt([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));var r=new bxt({vertexColors:!0,toneMapped:!1});Oxt.call(this,n,r)}iMt.prototype=Object.create(Ldt.prototype),iMt.prototype.constructor=iMt,iMt.prototype.setDirection=function(t){if(t.y>.99999)this.quaternion.set(0,0,0,1);else if(t.y<-.99999)this.quaternion.set(1,0,0,0);else{rMt.set(t.z,0,-t.x).normalize();var e=Math.acos(t.y);this.quaternion.setFromAxisAngle(rMt,e)}},iMt.prototype.setLength=function(t,e,n){void 0===e&&(e=.2*t),void 0===n&&(n=.2*e),this.line.scale.set(1,Math.max(1e-4,t-e),1),this.line.updateMatrix(),this.cone.scale.set(n,e,n),this.cone.position.y=t,this.cone.updateMatrix()},iMt.prototype.setColor=function(t){this.line.material.color.set(t),this.cone.material.color.set(t)},iMt.prototype.copy=function(t){return Ldt.prototype.copy.call(this,t,!1),this.line.copy(t.line),this.cone.copy(t.cone),this},iMt.prototype.clone=function(){return(new this.constructor).copy(this)},oMt.prototype=Object.create(Oxt.prototype),oMt.prototype.constructor=oMt;var aMt,sMt,uMt,cMt,lMt,hMt,fMt,pMt,dMt,mMt,vMt,gMt=Math.pow(2,8),yMt=[.125,.215,.35,.446,.526,.582],xMt=5+yMt.length,bMt={[jpt]:0,[Bpt]:1,[zpt]:2,3004:3,3005:4,3006:5,3007:6},_Mt=new mwt,wMt=(aMt=20,sMt=new Float32Array(aMt),uMt=new adt(0,1,0),(cMt=new n_t({defines:{n:aMt},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:sMt},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:uMt},inputEncoding:{value:bMt[3e3]},outputEncoding:{value:bMt[3e3]}},vertexShader:HMt(),fragmentShader:`\nprecision mediump float;\nprecision mediump int;\nvarying vec3 vOutputDirection;\nuniform sampler2D envMap;\nuniform int samples;\nuniform float weights[n];\nuniform bool latitudinal;\nuniform float dTheta;\nuniform float mipInt;\nuniform vec3 poleAxis;\n\n${YMt()}\n\n#define ENVMAP_TYPE_CUBE_UV\n#include <cube_uv_reflection_fragment>\n\nvec3 getSample(float theta, vec3 axis) {\n\tfloat cosTheta = cos(theta);\n\t// Rodrigues' axis-angle rotation\n\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t+ cross(axis, vOutputDirection) * sin(theta)\n\t\t+ axis * dot(axis, vOutputDirection) * (1.0 - cosTheta);\n\treturn bilinearCubeUV(envMap, sampleDirection, mipInt);\n}\n\nvoid main() {\n\tvec3 axis = latitudinal ? poleAxis : cross(poleAxis, vOutputDirection);\n\tif (all(equal(axis, vec3(0.0))))\n\t\taxis = vec3(vOutputDirection.z, 0.0, - vOutputDirection.x);\n\taxis = normalize(axis);\n\tgl_FragColor = vec4(0.0);\n\tgl_FragColor.rgb += weights[0] * getSample(0.0, axis);\n\tfor (int i = 1; i < n; i++) {\n\t\tif (i >= samples)\n\t\t\tbreak;\n\t\tfloat theta = dTheta * float(i);\n\t\tgl_FragColor.rgb += weights[i] * getSample(-1.0 * theta, axis);\n\t\tgl_FragColor.rgb += weights[i] * getSample(theta, axis);\n\t}\n\tgl_FragColor = linearToOutputTexel(gl_FragColor);\n}\n\t\t`,blending:0,depthTest:!1,depthWrite:!1})).type="SphericalGaussianBlur",cMt),SMt=null,MMt=null,{_lodPlanes:EMt,_sizeLods:AMt,_sigmas:TMt}=function(){for(var t=[],e=[],n=[],r=8,i=0;i<xMt;i++){var o=Math.pow(2,r);e.push(o);var a=1/o;i>4?a=yMt[i-8+4-1]:0==i&&(a=0),n.push(a);for(var s=1/(o-1),u=-s/2,c=1+s/2,l=[u,u,c,u,c,c,u,u,c,c,u,c],h=new Float32Array(108),f=new Float32Array(72),p=new Float32Array(36),d=0;d<6;d++){var m=d%3*2/3-1,v=d>2?0:-1,g=[m,v,0,m+2/3,v,0,m+2/3,v+1,0,m,v,0,m+2/3,v+1,0,m,v+1,0];h.set(g,18*d),f.set(l,12*d);var y=[d,d,d,d,d,d];p.set(y,6*d)}var x=new Kmt;x.setAttribute("position",new Lmt(h,3)),x.setAttribute("uv",new Lmt(f,2)),x.setAttribute("faceIndex",new Lmt(p,1)),t.push(x),r>4&&r--}return{_lodPlanes:t,_sizeLods:e,_sigmas:n}}(),CMt=null,OMt=null,kMt=null,PMt=(1+Math.sqrt(5))/2,LMt=1/PMt,RMt=[new adt(1,1,1),new adt(-1,1,1),new adt(1,1,-1),new adt(-1,1,-1),new adt(0,PMt,LMt),new adt(0,PMt,-LMt),new adt(LMt,0,PMt),new adt(-LMt,0,PMt),new adt(PMt,LMt,0),new adt(-PMt,LMt,0)];function IMt(t){OMt=t,FMt(wMt)}function NMt(t){var e={magFilter:gpt,minFilter:gpt,generateMipmaps:!1,type:t?t.type:wpt,format:t?t.format:1023,encoding:t?t.encoding:zpt,depthBuffer:!1,stencilBuffer:!1},n=jMt(e);return n.depthBuffer=!t,CMt=jMt(e),n}function DMt(t){CMt.dispose(),OMt.setRenderTarget(kMt),t.scissorTest=!1,t.setSize(t.width,t.height)}function FMt(t){var e=new Rdt;e.add(new mvt(EMt[0],t)),OMt.compile(e,_Mt)}function jMt(t){var e=new edt(3*gMt,3*gMt,t);return e.texture.mapping=ppt,e.texture.name="PMREM.cubeUv",e.scissorTest=!0,e}function BMt(t,e,n,r,i){t.viewport.set(e,n,r,i),t.scissor.set(e,n,r,i)}function zMt(t){var e=OMt.autoClear;OMt.autoClear=!1;for(var n=1;n<xMt;n++){UMt(t,n-1,n,Math.sqrt(TMt[n]*TMt[n]-TMt[n-1]*TMt[n-1]),RMt[(n-1)%RMt.length])}OMt.autoClear=e}function UMt(t,e,n,r,i){VMt(t,CMt,e,n,r,"latitudinal",i),VMt(CMt,t,n,n,r,"longitudinal",i)}function VMt(t,e,n,r,i,o,a){var s=new Rdt;s.add(new mvt(EMt[r],wMt));for(var u=wMt.uniforms,c=AMt[n]-1,l=isFinite(i)?Math.PI/(2*c):2*Math.PI/39,h=i/l,f=isFinite(i)?1+Math.floor(3*h):20,p=[],d=0,m=0;m<20;++m){var v=m/h,g=Math.exp(-v*v/2);p.push(g),0==m?d+=g:m<f&&(d+=2*g)}for(m=0;m<p.length;m++)p[m]=p[m]/d;u.envMap.value=t.texture,u.samples.value=f,u.weights.value=p,u.latitudinal.value="latitudinal"===o,a&&(u.poleAxis.value=a),u.dTheta.value=l,u.mipInt.value=8-n,u.inputEncoding.value=bMt[t.texture.encoding],u.outputEncoding.value=bMt[t.texture.encoding];var y=AMt[r];BMt(e,v=3*Math.max(0,gMt-2*y),(0===r?0:2*gMt)+2*y*(r>4?r-8+4:0),3*y,2*y),OMt.setRenderTarget(e),OMt.render(s,_Mt)}function GMt(){var t=new n_t({uniforms:{envMap:{value:null},texelSize:{value:new Zpt(1,1)},inputEncoding:{value:bMt[3e3]},outputEncoding:{value:bMt[3e3]}},vertexShader:HMt(),fragmentShader:`\nprecision mediump float;\nprecision mediump int;\nvarying vec3 vOutputDirection;\nuniform sampler2D envMap;\nuniform vec2 texelSize;\n\n${YMt()}\n\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n\nvoid main() {\n\tgl_FragColor = vec4(0.0);\n\tvec3 outputDirection = normalize(vOutputDirection);\n\tvec2 uv;\n\tuv.y = asin(clamp(outputDirection.y, -1.0, 1.0)) * RECIPROCAL_PI + 0.5;\n\tuv.x = atan(outputDirection.z, outputDirection.x) * RECIPROCAL_PI2 + 0.5;\n\tvec2 f = fract(uv / texelSize - 0.5);\n\tuv -= f * texelSize;\n\tvec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tuv.x += texelSize.x;\n\tvec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tuv.y += texelSize.y;\n\tvec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tuv.x -= texelSize.x;\n\tvec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tvec3 tm = mix(tl, tr, f.x);\n\tvec3 bm = mix(bl, br, f.x);\n\tgl_FragColor.rgb = mix(tm, bm, f.y);\n\tgl_FragColor = linearToOutputTexel(gl_FragColor);\n}\n\t\t`,blending:0,depthTest:!1,depthWrite:!1});return t.type="EquirectangularToCubeUV",t}function WMt(){var t=new n_t({uniforms:{envMap:{value:null},inputEncoding:{value:bMt[3e3]},outputEncoding:{value:bMt[3e3]}},vertexShader:HMt(),fragmentShader:`\nprecision mediump float;\nprecision mediump int;\nvarying vec3 vOutputDirection;\nuniform samplerCube envMap;\n\n${YMt()}\n\nvoid main() {\n\tgl_FragColor = vec4(0.0);\n\tgl_FragColor.rgb = envMapTexelToLinear(textureCube(envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ))).rgb;\n\tgl_FragColor = linearToOutputTexel(gl_FragColor);\n}\n\t\t`,blending:0,depthTest:!1,depthWrite:!1});return t.type="CubemapToCubeUV",t}function HMt(){return"\nprecision mediump float;\nprecision mediump int;\nattribute vec3 position;\nattribute vec2 uv;\nattribute float faceIndex;\nvarying vec3 vOutputDirection;\nvec3 getDirection(vec2 uv, float face) {\n\tuv = 2.0 * uv - 1.0;\n\tvec3 direction = vec3(uv, 1.0);\n\tif (face == 0.0) {\n\t\tdirection = direction.zyx;\n\t\tdirection.z *= -1.0;\n\t} else if (face == 1.0) {\n\t\tdirection = direction.xzy;\n\t\tdirection.z *= -1.0;\n\t} else if (face == 3.0) {\n\t\tdirection = direction.zyx;\n\t\tdirection.x *= -1.0;\n\t} else if (face == 4.0) {\n\t\tdirection = direction.xzy;\n\t\tdirection.y *= -1.0;\n\t} else if (face == 5.0) {\n\t\tdirection.xz *= -1.0;\n\t}\n\treturn direction;\n}\nvoid main() {\n\tvOutputDirection = getDirection(uv, faceIndex);\n\tgl_Position = vec4( position, 1.0 );\n}\n\t"}function YMt(){return"\nuniform int inputEncoding;\nuniform int outputEncoding;\n\n#include <encodings_pars_fragment>\n\nvec4 inputTexelToLinear(vec4 value){\n\tif(inputEncoding == 0){\n\t\treturn value;\n\t}else if(inputEncoding == 1){\n\t\treturn sRGBToLinear(value);\n\t}else if(inputEncoding == 2){\n\t\treturn RGBEToLinear(value);\n\t}else if(inputEncoding == 3){\n\t\treturn RGBMToLinear(value, 7.0);\n\t}else if(inputEncoding == 4){\n\t\treturn RGBMToLinear(value, 16.0);\n\t}else if(inputEncoding == 5){\n\t\treturn RGBDToLinear(value, 256.0);\n\t}else{\n\t\treturn GammaToLinear(value, 2.2);\n\t}\n}\n\nvec4 linearToOutputTexel(vec4 value){\n\tif(outputEncoding == 0){\n\t\treturn value;\n\t}else if(outputEncoding == 1){\n\t\treturn LinearTosRGB(value);\n\t}else if(outputEncoding == 2){\n\t\treturn LinearToRGBE(value);\n\t}else if(outputEncoding == 3){\n\t\treturn LinearToRGBM(value, 7.0);\n\t}else if(outputEncoding == 4){\n\t\treturn LinearToRGBM(value, 16.0);\n\t}else if(outputEncoding == 5){\n\t\treturn LinearToRGBD(value, 256.0);\n\t}else{\n\t\treturn LinearToGamma(value, 2.2);\n\t}\n}\n\nvec4 envMapTexelToLinear(vec4 color) {\n\treturn inputTexelToLinear(color);\n}\n\t"}function XMt(t){X_t.call(this,t),this.type="catmullrom"}IMt.prototype={constructor:IMt,fromScene:function(t,e=0,n=.1,r=100){kMt=OMt.getRenderTarget();var i=NMt();return function(t,e,n,r){var i=new Ovt(90,1,e,n),o=[1,1,1,1,-1,1],a=[1,1,-1,-1,-1,1],s=OMt.outputEncoding,u=OMt.toneMapping,c=OMt.toneMappingExposure,l=OMt.getClearColor(),h=OMt.getClearAlpha();OMt.toneMapping=1,OMt.toneMappingExposure=1,OMt.outputEncoding=jpt,t.scale.z*=-1;var f=t.background;if(f&&f.isColor){f.convertSRGBToLinear();var p=Math.max(f.r,f.g,f.b),d=Math.min(Math.max(Math.ceil(Math.log2(p)),-128),127);f=f.multiplyScalar(Math.pow(2,-d));var m=(d+128)/255;OMt.setClearColor(f,m),t.background=null}for(var v=0;v<6;v++){var g=v%3;0==g?(i.up.set(0,o[v],0),i.lookAt(a[v],0,0)):1==g?(i.up.set(0,0,o[v]),i.lookAt(0,a[v],0)):(i.up.set(0,o[v],0),i.lookAt(0,0,a[v])),BMt(r,g*gMt,v>2?gMt:0,gMt,gMt),OMt.setRenderTarget(r),OMt.render(t,i)}OMt.toneMapping=u,OMt.toneMappingExposure=c,OMt.outputEncoding=s,OMt.setClearColor(l,h),t.scale.z*=-1}(t,n,r,i),e>0&&UMt(i,0,0,e),zMt(i),DMt(i),i},fromEquirectangular:function(t){return t.magFilter=gpt,t.minFilter=gpt,t.generateMipmaps=!1,this.fromCubemap(t)},fromCubemap:function(t){kMt=OMt.getRenderTarget();var e=NMt(t);return function(t,e){var n=new Rdt;t.isCubeTexture?null==MMt&&(MMt=WMt()):null==SMt&&(SMt=GMt());var r=t.isCubeTexture?MMt:SMt;n.add(new mvt(EMt[0],r));var i=r.uniforms;i.envMap.value=t,t.isCubeTexture||i.texelSize.value.set(1/t.image.width,1/t.image.height);i.inputEncoding.value=bMt[t.encoding],i.outputEncoding.value=bMt[t.encoding],BMt(e,0,0,3*gMt,2*gMt),OMt.setRenderTarget(e),OMt.render(n,_Mt)}(t,e),zMt(e),DMt(e),e},compileCubemapShader:function(){null==MMt&&FMt(MMt=WMt())},compileEquirectangularShader:function(){null==SMt&&FMt(SMt=GMt())},dispose:function(){wMt.dispose(),null!=MMt&&MMt.dispose(),null!=SMt&&SMt.dispose();for(var t=0;t<EMt.length;t++)EMt[t].dispose()}},B_t.create=function(t,e){return t.prototype=Object.create(B_t.prototype),t.prototype.constructor=t,t.prototype.getPoint=e,t},Object.assign(owt.prototype,{createPointsGeometry:function(t){var e=this.getPoints(t);return this.createGeometry(e)},createSpacedPointsGeometry:function(t){var e=this.getSpacedPoints(t);return this.createGeometry(e)},createGeometry:function(t){for(var e=new wvt,n=0,r=t.length;n<r;n++){var i=t[n];e.vertices.push(new adt(i.x,i.y,i.z||0))}return e}}),Object.assign(awt.prototype,{fromPoints:function(t){return this.setFromPoints(t)}}),Object.create(X_t.prototype),Object.create(X_t.prototype),XMt.prototype=Object.create(X_t.prototype),Object.assign(XMt.prototype,{initFromArray:function(){},getControlPointsArray:function(){},reparametrizeByArcLength:function(){}}),USt.prototype.setColors=function(){},NSt.prototype.update=function(){},Object.assign(k_t.prototype,{extractUrlBase:function(t){return _wt(t)}}),k_t.Handlers={add:function(){},get:function(){}},Object.assign(Awt.prototype,{setTexturePath:function(t){return this.setResourcePath(t)}}),Object.assign(MSt.prototype,{center:function(t){return this.getCenter(t)},empty:function(){return this.isEmpty()},isIntersectionBox:function(t){return this.intersectsBox(t)},size:function(t){return this.getSize(t)}}),Object.assign(Xdt.prototype,{center:function(t){return this.getCenter(t)},empty:function(){return this.isEmpty()},isIntersectionBox:function(t){return this.intersectsBox(t)},isIntersectionSphere:function(t){return this.intersectsSphere(t)},size:function(t){return this.getSize(t)}}),Dvt.prototype.setFromMatrix=function(t){return this.setFromProjectionMatrix(t)},TSt.prototype.center=function(t){return this.getCenter(t)},Object.assign(qpt,{random16:function(){return Math.random()},nearestPowerOfTwo:function(t){return qpt.floorPowerOfTwo(t)},nextPowerOfTwo:function(t){return qpt.ceilPowerOfTwo(t)}}),Object.assign($pt.prototype,{flattenToArrayOffset:function(t,e){return this.toArray(t,e)},multiplyVector3:function(t){return t.applyMatrix3(this)},multiplyVector3Array:function(){},applyToBufferAttribute:function(t){return t.applyMatrix3(this)},applyToVector3Array:function(){}}),Object.assign(ddt.prototype,{extractPosition:function(t){return this.copyPosition(t)},flattenToArrayOffset:function(t,e){return this.toArray(t,e)},getPosition:function(){return(new adt).setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(t){return this.makeRotationFromQuaternion(t)},multiplyToArray:function(){},multiplyVector3:function(t){return t.applyMatrix4(this)},multiplyVector4:function(t){return t.applyMatrix4(this)},multiplyVector3Array:function(){},rotateAxis:function(t){t.transformDirection(this)},crossVector:function(t){return t.applyMatrix4(this)},translate:function(){},rotateX:function(){},rotateY:function(){},rotateZ:function(){},rotateByAxis:function(){},applyToBufferAttribute:function(t){return t.applyMatrix4(this)},applyToVector3Array:function(){},makeFrustum:function(t,e,n,r,i,o){return this.makePerspective(t,e,r,n,i,o)}}),umt.prototype.isIntersectionLine=function(t){return this.intersectsLine(t)},rdt.prototype.multiplyVector3=function(t){return t.applyQuaternion(this)},Object.assign(imt.prototype,{isIntersectionBox:function(t){return this.intersectsBox(t)},isIntersectionPlane:function(t){return this.intersectsPlane(t)},isIntersectionSphere:function(t){return this.intersectsSphere(t)}}),Object.assign(xmt.prototype,{area:function(){return this.getArea()},barycoordFromPoint:function(t,e){return this.getBarycoord(t,e)},midpoint:function(t){return this.getMidpoint(t)},normal:function(t){return this.getNormal(t)},plane:function(t){return this.getPlane(t)}}),Object.assign(xmt,{barycoordFromPoint:function(t,e,n,r,i){return xmt.getBarycoord(t,e,n,r,i)},normal:function(t,e,n,r){return xmt.getNormal(t,e,n,r)}}),Object.assign(swt.prototype,{extractAllPoints:function(t){return this.extractPoints(t)},extrude:function(t){return new Lbt(this,t)},makeGeometry:function(t){return new Wbt(this,t)}}),Object.assign(Zpt.prototype,{fromAttribute:function(t,e,n){return this.fromBufferAttribute(t,e,n)},distanceToManhattan:function(t){return this.manhattanDistanceTo(t)},lengthManhattan:function(){return this.manhattanLength()}}),Object.assign(adt.prototype,{setEulerFromRotationMatrix:function(){},setEulerFromQuaternion:function(){},getPositionFromMatrix:function(t){return this.setFromMatrixPosition(t)},getScaleFromMatrix:function(t){return this.setFromMatrixScale(t)},getColumnFromMatrix:function(t,e){return this.setFromMatrixColumn(e,t)},applyProjection:function(t){return this.applyMatrix4(t)},fromAttribute:function(t,e,n){return this.fromBufferAttribute(t,e,n)},distanceToManhattan:function(t){return this.manhattanDistanceTo(t)},lengthManhattan:function(){return this.manhattanLength()}}),Object.assign(tdt.prototype,{fromAttribute:function(t,e,n){return this.fromBufferAttribute(t,e,n)},lengthManhattan:function(){return this.manhattanLength()}}),Object.assign(wvt.prototype,{computeTangents:function(){},computeLineDistances:function(){},applyMatrix:function(t){return this.applyMatrix4(t)}}),Object.assign(Ldt.prototype,{getChildByName:function(t){return this.getObjectByName(t)},renderDepth:function(){},translate:function(t,e){return this.translateOnAxis(e,t)},getWorldRotation:function(){},applyMatrix:function(t){return this.applyMatrix4(t)}}),Object.defineProperties(Ldt.prototype,{eulerOrder:{get:function(){return this.rotation.order},set:function(t){this.rotation.order=t}},useQuaternion:{get:function(){},set:function(){}}}),Object.assign(mvt.prototype,{setDrawMode:function(){}}),Object.defineProperties(mvt.prototype,{drawMode:{get:function(){return 0},set:function(){}}}),Object.defineProperties(cxt.prototype,{objects:{get:function(){return this.levels}}}),Object.defineProperty(pxt.prototype,"useVertexTexture",{get:function(){},set:function(){}}),lxt.prototype.initBones=function(){},Object.defineProperty(B_t.prototype,"__arcLengthDivisions",{get:function(){return this.arcLengthDivisions},set:function(t){this.arcLengthDivisions=t}}),Ovt.prototype.setLens=function(t,e){void 0!==e&&(this.filmGauge=e),this.setFocalLength(t)},Object.defineProperties(uwt.prototype,{onlyShadow:{set:function(){}},shadowCameraFov:{set:function(t){this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){this.shadow.camera.far=t}},shadowCameraVisible:{set:function(){}},shadowBias:{set:function(t){this.shadow.bias=t}},shadowDarkness:{set:function(){}},shadowMapWidth:{set:function(t){this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){this.shadow.mapSize.height=t}}}),Object.defineProperties(Lmt.prototype,{length:{get:function(){return this.array.length}},dynamic:{get:function(){return this.usage===Gpt},set:function(){this.setUsage(Gpt)}}}),Object.assign(Lmt.prototype,{setDynamic:function(t){return this.setUsage(!0===t?Gpt:Vpt),this},copyIndicesArray:function(){},setArray:function(){}}),Object.assign(Kmt.prototype,{addIndex:function(t){this.setIndex(t)},addAttribute:function(t,e){return e&&e.isBufferAttribute||e&&e.isInterleavedBufferAttribute?"index"===t?(this.setIndex(e),this):this.setAttribute(t,e):this.setAttribute(t,new Lmt(arguments[1],arguments[2]))},addDrawCall:function(t,e,n){this.addGroup(t,e)},clearDrawCalls:function(){this.clearGroups()},computeTangents:function(){},computeOffsets:function(){},removeAttribute:function(t){return this.deleteAttribute(t)},applyMatrix:function(t){return this.applyMatrix4(t)}}),Object.defineProperties(Kmt.prototype,{drawcalls:{get:function(){return this.groups}},offsets:{get:function(){return this.groups}}}),Object.defineProperties(bSt.prototype,{linePrecision:{get:function(){return this.params.Line.threshold},set:function(t){this.params.Line.threshold=t}}}),Object.defineProperties(Vyt.prototype,{dynamic:{get:function(){return this.usage===Gpt},set:function(t){this.setUsage(t)}}}),Object.assign(Vyt.prototype,{setDynamic:function(t){return this.setUsage(!0===t?Gpt:Vpt),this},setArray:function(){}}),Object.assign(Rbt.prototype,{getArrays:function(){},addShapeList:function(){},addShape:function(){}}),Object.defineProperties(ySt.prototype,{dynamic:{set:function(){}},onUpdate:{value:function(){return this}}}),Object.defineProperties(Omt.prototype,{wrapAround:{get:function(){},set:function(){}},overdraw:{get:function(){},set:function(){}},wrapRGB:{get:function(){return new Smt}},shading:{get:function(){},set:function(t){this.flatShading=1===t}},stencilMask:{get:function(){return this.stencilFuncMask},set:function(t){this.stencilFuncMask=t}}}),Object.defineProperties(o_t.prototype,{metal:{get:function(){return!1},set:function(){}}}),Object.defineProperties(Tvt.prototype,{derivatives:{get:function(){return this.extensions.derivatives},set:function(t){this.extensions.derivatives=t}}}),Object.assign(Byt.prototype,{clearTarget:function(t,e,n,r){this.setRenderTarget(t),this.clear(e,n,r)},animate:function(t){this.setAnimationLoop(t)},getCurrentRenderTarget:function(){return this.getRenderTarget()},getMaxAnisotropy:function(){return this.capabilities.getMaxAnisotropy()},getPrecision:function(){return this.capabilities.precision},resetGLState:function(){return this.state.reset()},supportsFloatTextures:function(){return this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return this.capabilities.vertexTextures},supportsInstancedArrays:function(){return this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(t){this.setScissorTest(t)},initMaterial:function(){},addPrePlugin:function(){},addPostPlugin:function(){},updateShadowMap:function(){},setFaceCulling:function(){},allocTextureUnit:function(){},setTexture:function(){},setTexture2D:function(){},setTextureCube:function(){},getActiveMipMapLevel:function(){return this.getActiveMipmapLevel()}}),Object.defineProperties(Byt.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){this.shadowMap.type=t}},shadowMapCullFace:{get:function(){},set:function(){}},context:{get:function(){return this.getContext()}},vr:{get:function(){return this.xr}},gammaInput:{get:function(){return!1},set:function(){}},gammaOutput:{get:function(){return!1},set:function(t){this.outputEncoding=!0===t?Bpt:jpt}}}),Object.defineProperties(Lyt.prototype,{cullFace:{get:function(){},set:function(){}},renderReverseSided:{get:function(){},set:function(){}},renderSingleSided:{get:function(){},set:function(){}}}),Object.defineProperties(edt.prototype,{wrapS:{get:function(){return this.texture.wrapS},set:function(t){this.texture.wrapS=t}},wrapT:{get:function(){return this.texture.wrapT},set:function(t){this.texture.wrapT=t}},magFilter:{get:function(){return this.texture.magFilter},set:function(t){this.texture.magFilter=t}},minFilter:{get:function(){return this.texture.minFilter},set:function(t){this.texture.minFilter=t}},anisotropy:{get:function(){return this.texture.anisotropy},set:function(t){this.texture.anisotropy=t}},offset:{get:function(){return this.texture.offset},set:function(t){this.texture.offset=t}},repeat:{get:function(){return this.texture.repeat},set:function(t){this.texture.repeat=t}},format:{get:function(){return this.texture.format},set:function(t){this.texture.format=t}},type:{get:function(){return this.texture.type},set:function(t){this.texture.type=t}},generateMipmaps:{get:function(){return this.texture.generateMipmaps},set:function(t){this.texture.generateMipmaps=t}}}),Object.defineProperties($wt.prototype,{load:{value:function(t){var e=this;return(new Fwt).load(t,(function(t){e.setBuffer(t)})),this}},startTime:{set:function(){}}}),nSt.prototype.getData=function(){return this.getFrequencyData()},Pvt.prototype.updateCubeMap=function(t,e){return this.update(t,e)},Kpt.crossOrigin=void 0,Kpt.loadTexture=function(t,e,n,r){var i=new j_t;i.setCrossOrigin(this.crossOrigin);var o=i.load(t,n,void 0,r);return e&&(o.mapping=e),o},Kpt.loadTextureCube=function(t,e,n,r){var i=new F_t;i.setCrossOrigin(this.crossOrigin);var o=i.load(t,n,void 0,r);return e&&(o.mapping=e),o},Kpt.loadCompressedTexture=function(){},Kpt.loadCompressedTextureCube=function(){},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"115"}}));var qMt=Math.PI/180,ZMt=Symbol.for("ThreeJSRenderService"),$Mt=(lMt=Z2(),hMt=d2(J2.IRendererService),fMt=d2(J2.IMapService),lMt((dMt=function(){function t(){mZ(this,t),F3(this,"rendererService",mMt,this),F3(this,"mapService",vMt,this)}return gZ(t,[{key:"init",value:function(){var t=this.rendererService.getCanvas(),e=this.rendererService.getGLContext();if(t&&e){var n=this.mapService.getCenter();this.center=this.mapService.lngLatToMercator([n.lng,n.lat],0)}var r=this.center,i=r.x,o=r.y,a=r.z;this.cameraTransform=(new ddt).makeTranslation(i,o,a),this.renderer=new Byt({canvas:t,context:e,antialias:!0}),this.renderer.autoClear=!1,this.renderer.gammaFactor=2.2,this.renderer.shadowMap.enabled=!0,this.scene=new Rdt,this.aspect=e.drawingBufferWidth/e.drawingBufferHeight,this.camera=new Ovt(45,this.aspect,1,2e7)}},{key:"getRenderCamera",value:function(){switch(this.mapService.version){case"GAODE1.x":default:return this.AMapCamera();case"GAODE2.x":return this.AMap2Camera();case"MAPBOX":case"DEFAULTMAP":return this.mapboxCamera()}}},{key:"mapboxCamera",value:function(){var t=(new ddt).fromArray(this.mapService.map.transform.customLayerMatrix());return this.camera.projectionMatrix=t.multiply(this.cameraTransform),this.camera}},{key:"AMapCamera",value:function(){var t=this.mapService.map.getCameraState(),e=this.camera,n=t.pitch,r=t.rotation,i=t.fov,o=t.near,a=t.far,s=t.height,u=t.aspect;return n*=qMt,r*=qMt,e.fov=180*i/Math.PI,e.aspect=u,e.near=o,e.far=a,e.updateProjectionMatrix(),e.position.z=s*Math.cos(n),e.position.x=s*Math.sin(n)*Math.sin(r),e.position.y=-s*Math.sin(n)*Math.cos(r),e.up.x=-Math.cos(n)*Math.sin(r),e.up.y=Math.cos(n)*Math.cos(r),e.up.z=Math.sin(n),e.lookAt(0,0,0),e.position.x+=t.position.x,e.position.y+=-t.position.y,e}},{key:"AMap2Camera",value:function(){var t,e,n=this.mapService.map.customCoords;n.getCenter();var r=this.camera,i=n.getCameraParams(),o=i.near,a=i.far,s=i.fov,u=i.up,c=i.lookAt,l=i.position;return r.near=o,r.far=a,r.fov=s,(t=r.position).set.apply(t,Xq(l)),(e=r.up).set.apply(e,Xq(u)),r.lookAt.apply(r,Xq(c)),r.updateProjectionMatrix(),r}}]),t}(),mMt=j3(dMt.prototype,"rendererService",[hMt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vMt=j3(dMt.prototype,"mapService",[fMt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pMt=dMt))||pMt);function KMt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=EZ(t);if(e){var i=EZ(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return MZ(this,n)}}var JMt=function(t){wZ(r,Ytt);var e,n=KMt(r);function r(){var t;mZ(this,r);for(var e=arguments.length,i=new Array(e),o=0;o<e;o++)i[o]=arguments[o];return $q(SZ(t=n.call.apply(n,[this].concat(i))),"type","custom"),$q(SZ(t),"isUpdate",!1),$q(SZ(t),"update",null),$q(SZ(t),"scene",new Rdt),$q(SZ(t),"animateMixer",[]),$q(SZ(t),"defaultSourceConfig",{data:{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"Point",coordinates:[0,0]}}]},options:{parser:{type:"geojson"}}}),$q(SZ(t),"forceRender",!0),t}return gZ(r,[{key:"setUpdate",value:function(t){this.update=t,this.isUpdate=!0}},{key:"getModelMatrix",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0,0],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1,1];return(new ddt).fromArray(this.mapService.getModelMatrix(t,e,n,r,this.threeRenderService.center))}},{key:"getTranslateMatrix",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.getModelMatrix(t,e,[0,0,0],[1,1,1])}},{key:"applyObjectLngLat",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=this.getTranslateMatrix(e,n);t.applyMatrix4(r)}},{key:"setObjectLngLat",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=this.lnglatToCoord(e),i=lZ(r,2),o=i[0],a=i[1];t.position.set(o,a,n)}},{key:"lnglatToCoord",value:function(t){var e,n=lZ(null===(e=this.mapService)||void 0===e?void 0:e.lngLatToCoord(t,this.threeRenderService.center),2);return[n[0],n[1]]}},{key:"getObjectLngLat",value:function(t){return[0,0]}},{key:"adjustMeshToMap",value:function(t){t.up=new adt(0,0,1);var e=this.mapService.getCenter(),n=this.getModelMatrix([e.lng,e.lat],0,[Math.PI/2,-Math.PI,0],[1,1,1]);t.applyMatrix4(n)}},{key:"setMeshScale",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=new ddt;i.scale(new adt(e,n,r)),t.applyMatrix4(i)}},{key:"buildModels",value:(e=RK(jK.mark((function t(){var e;return jK.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.threeRenderService=this.getContainer().get(ZMt),(e=this.getLayerConfig())&&e.onAddMeshes&&e.onAddMeshes(this.scene,this);case 3:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"renderModels",value:function(){var t=this;if(!this.threeRenderService)return this;this.isUpdate&&this.update&&this.update();var e=this.rendererService.getGLContext();this.rendererService.setCustomLayerDefaults();var n="AMapService"===this.mapService.constructor.name?e.BACK:e.FRONT;e.cullFace(n);var r=this.threeRenderService.renderer;r.state.reset(),r.autoClear=!1;var i=this.threeRenderService.getRenderCamera();return r.render(this.scene,i),this.rendererService.setState(),this.animateMixer.forEach((function(e){e.update(t.getTime())})),this.rendererService.setState(),this.rendererService.setDirty(!0),this}},{key:"renderAMapModels",value:function(){var t=this;this.rendererService.setCustomLayerDefaults();var e=this.threeRenderService.renderer;return e.state.reset(),e.autoClear=!1,e.render(this.scene,this.threeRenderService.getRenderCamera()),this.animateMixer.forEach((function(e){e.update(t.getTime())})),this.rendererService.setBaseState(),this.rendererService.setDirty(!0),this}},{key:"getRenderCamera",value:function(){return this.threeRenderService.getRenderCamera()}},{key:"addAnimateMixer",value:function(t){this.animateMixer.push(t)}}]),r}(),QMt=function(){function t(e){mZ(this,t);var n=e.getServiceContainer();n.bind(ZMt).to($Mt).inSingletonScope(),this.threeRenderService=n.get(ZMt)}return gZ(t,[{key:"init",value:function(){this.threeRenderService.init()}}]),t}();
/**
 * @license
 * Copyright 2010-2022 Three.js Authors
 * SPDX-License-Identifier: MIT
 */
const tEt=1e3,eEt=1001,nEt=1002,rEt=1003,iEt=1006,oEt=1008,aEt=2300,sEt=2301,uEt=2302,cEt=2400,lEt=2401,hEt=2402,fEt=2500,pEt=3001,dEt="srgb",mEt="srgb-linear",vEt=7680,gEt=35044;class yEt{addEventListener(t,e){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)}hasEventListener(t,e){if(void 0===this._listeners)return!1;const n=this._listeners;return void 0!==n[t]&&-1!==n[t].indexOf(e)}removeEventListener(t,e){if(void 0===this._listeners)return;const n=this._listeners[t];if(void 0!==n){const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}dispatchEvent(t){if(void 0===this._listeners)return;const e=this._listeners[t.type];if(void 0!==e){t.target=this;const n=e.slice(0);for(let e=0,r=n.length;e<r;e++)n[e].call(this,t);t.target=null}}}const xEt=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let bEt=1234567;const _Et=Math.PI/180,wEt=180/Math.PI;function SEt(){const t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(xEt[255&t]+xEt[t>>8&255]+xEt[t>>16&255]+xEt[t>>24&255]+"-"+xEt[255&e]+xEt[e>>8&255]+"-"+xEt[e>>16&15|64]+xEt[e>>24&255]+"-"+xEt[63&n|128]+xEt[n>>8&255]+"-"+xEt[n>>16&255]+xEt[n>>24&255]+xEt[255&r]+xEt[r>>8&255]+xEt[r>>16&255]+xEt[r>>24&255]).toLowerCase()}function MEt(t,e,n){return Math.max(e,Math.min(n,t))}function EEt(t,e){return(t%e+e)%e}function AEt(t,e,n){return(1-n)*t+n*e}function TEt(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function CEt(t,e){switch(e.constructor){case Float32Array:return t;case Uint16Array:return t/65535;case Uint8Array:return t/255;case Int16Array:return Math.max(t/32767,-1);case Int8Array:return Math.max(t/127,-1);default:throw new Error("Invalid component type.")}}function OEt(t,e){switch(e.constructor){case Float32Array:return t;case Uint16Array:return Math.round(65535*t);case Uint8Array:return Math.round(255*t);case Int16Array:return Math.round(32767*t);case Int8Array:return Math.round(127*t);default:throw new Error("Invalid component type.")}}var kEt=Object.freeze({__proto__:null,DEG2RAD:_Et,RAD2DEG:wEt,generateUUID:SEt,clamp:MEt,euclideanModulo:EEt,mapLinear:function(t,e,n,r,i){return r+(t-e)*(i-r)/(n-e)},inverseLerp:function(t,e,n){return t!==e?(n-t)/(e-t):0},lerp:AEt,damp:function(t,e,n,r){return AEt(t,e,1-Math.exp(-n*r))},pingpong:function(t,e=1){return e-Math.abs(EEt(t,2*e)-e)},smoothstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*(3-2*t)},smootherstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},seededRandom:function(t){void 0!==t&&(bEt=t);let e=bEt+=1831565813;return e=Math.imul(e^e>>>15,1|e),e^=e+Math.imul(e^e>>>7,61|e),((e^e>>>14)>>>0)/4294967296},degToRad:function(t){return t*_Et},radToDeg:function(t){return t*wEt},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:TEt,floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},setQuaternionFromProperEuler:function(t,e,n,r,i){const o=Math.cos,a=Math.sin,s=o(n/2),u=a(n/2),c=o((e+r)/2),l=a((e+r)/2),h=o((e-r)/2),f=a((e-r)/2),p=o((r-e)/2),d=a((r-e)/2);switch(i){case"XYX":t.set(s*l,u*h,u*f,s*c);break;case"YZY":t.set(u*f,s*l,u*h,s*c);break;case"ZXZ":t.set(u*h,u*f,s*l,s*c);break;case"XZX":t.set(s*l,u*d,u*p,s*c);break;case"YXY":t.set(u*p,s*l,u*d,s*c);break;case"ZYZ":t.set(u*d,u*p,s*l,s*c)}},normalize:OEt,denormalize:CEt});class PEt{constructor(t=0,e=0){PEt.prototype.isVector2=!0,this.x=t,this.y=e}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,e){return this.x=t,this.y=e,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t){return this.x+=t.x,this.y+=t.y,this}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){const e=this.x,n=this.y,r=t.elements;return this.x=r[0]*e+r[3]*n+r[6],this.y=r[1]*e+r[4]*n+r[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y;return e*e+n*n}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this}rotateAround(t,e){const n=Math.cos(e),r=Math.sin(e),i=this.x-t.x,o=this.y-t.y;return this.x=i*n-o*r+t.x,this.y=i*r+o*n+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class LEt{constructor(){LEt.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(t,e,n,r,i,o,a,s,u){const c=this.elements;return c[0]=t,c[1]=r,c[2]=a,c[3]=e,c[4]=i,c[5]=s,c[6]=n,c[7]=o,c[8]=u,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this}extractBasis(t,e,n){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(t){const e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,r=e.elements,i=this.elements,o=n[0],a=n[3],s=n[6],u=n[1],c=n[4],l=n[7],h=n[2],f=n[5],p=n[8],d=r[0],m=r[3],v=r[6],g=r[1],y=r[4],x=r[7],b=r[2],_=r[5],w=r[8];return i[0]=o*d+a*g+s*b,i[3]=o*m+a*y+s*_,i[6]=o*v+a*x+s*w,i[1]=u*d+c*g+l*b,i[4]=u*m+c*y+l*_,i[7]=u*v+c*x+l*w,i[2]=h*d+f*g+p*b,i[5]=h*m+f*y+p*_,i[8]=h*v+f*x+p*w,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],s=t[6],u=t[7],c=t[8];return e*o*c-e*a*u-n*i*c+n*a*s+r*i*u-r*o*s}invert(){const t=this.elements,e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],s=t[6],u=t[7],c=t[8],l=c*o-a*u,h=a*s-c*i,f=u*i-o*s,p=e*l+n*h+r*f;if(0===p)return this.set(0,0,0,0,0,0,0,0,0);const d=1/p;return t[0]=l*d,t[1]=(r*u-c*n)*d,t[2]=(a*n-r*o)*d,t[3]=h*d,t[4]=(c*e-r*s)*d,t[5]=(r*i-a*e)*d,t[6]=f*d,t[7]=(n*s-u*e)*d,t[8]=(o*e-n*i)*d,this}transpose(){let t;const e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){const e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this}setUvTransform(t,e,n,r,i,o,a){const s=Math.cos(i),u=Math.sin(i);return this.set(n*s,n*u,-n*(s*o+u*a)+o+t,-r*u,r*s,-r*(-u*o+s*a)+a+e,0,0,1),this}scale(t,e){return this.premultiply(REt.makeScale(t,e)),this}rotate(t){return this.premultiply(REt.makeRotation(-t)),this}translate(t,e){return this.premultiply(REt.makeTranslation(t,e)),this}makeTranslation(t,e){return this.set(1,0,t,0,1,e,0,0,1),this}makeRotation(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,n,e,0,0,0,1),this}makeScale(t,e){return this.set(t,0,0,0,e,0,0,0,1),this}equals(t){const e=this.elements,n=t.elements;for(let r=0;r<9;r++)if(e[r]!==n[r])return!1;return!0}fromArray(t,e=0){for(let n=0;n<9;n++)this.elements[n]=t[n+e];return this}toArray(t=[],e=0){const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}clone(){return(new this.constructor).fromArray(this.elements)}}const REt=new LEt;function IEt(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}function NEt(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function DEt(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}const FEt={[dEt]:{[mEt]:NEt},[mEt]:{[dEt]:DEt}},jEt={legacyMode:!0,get workingColorSpace(){return mEt},set workingColorSpace(t){},convert:function(t,e,n){if(this.legacyMode||e===n||!e||!n)return t;if(FEt[e]&&void 0!==FEt[e][n]){const r=FEt[e][n];return t.r=r(t.r),t.g=r(t.g),t.b=r(t.b),t}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(t,e){return this.convert(t,this.workingColorSpace,e)},toWorkingColorSpace:function(t,e){return this.convert(t,e,this.workingColorSpace)}},BEt={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},zEt={r:0,g:0,b:0},UEt={h:0,s:0,l:0},VEt={h:0,s:0,l:0};function GEt(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+6*(e-t)*(2/3-n):t}function WEt(t,e){return e.r=t.r,e.g=t.g,e.b=t.b,e}class HEt{constructor(t,e,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,void 0===e&&void 0===n?this.set(t):this.setRGB(t,e,n)}set(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t,e=dEt){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,jEt.toWorkingColorSpace(this,e),this}setRGB(t,e,n,r=jEt.workingColorSpace){return this.r=t,this.g=e,this.b=n,jEt.toWorkingColorSpace(this,r),this}setHSL(t,e,n,r=jEt.workingColorSpace){if(t=EEt(t,1),e=MEt(e,0,1),n=MEt(n,0,1),0===e)this.r=this.g=this.b=n;else{const r=n<=.5?n*(1+e):n+e-n*e,i=2*n-r;this.r=GEt(i,r,t+1/3),this.g=GEt(i,r,t),this.b=GEt(i,r,t-1/3)}return jEt.toWorkingColorSpace(this,r),this}setStyle(t,e=dEt){function n(t){void 0!==t&&parseFloat(t)}let r;if(r=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(t)){let t;const i=r[1],o=r[2];switch(i){case"rgb":case"rgba":if(t=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.r=Math.min(255,parseInt(t[1],10))/255,this.g=Math.min(255,parseInt(t[2],10))/255,this.b=Math.min(255,parseInt(t[3],10))/255,jEt.toWorkingColorSpace(this,e),n(t[4]),this;if(t=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.r=Math.min(100,parseInt(t[1],10))/100,this.g=Math.min(100,parseInt(t[2],10))/100,this.b=Math.min(100,parseInt(t[3],10))/100,jEt.toWorkingColorSpace(this,e),n(t[4]),this;break;case"hsl":case"hsla":if(t=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o)){const r=parseFloat(t[1])/360,i=parseFloat(t[2])/100,o=parseFloat(t[3])/100;return n(t[4]),this.setHSL(r,i,o,e)}}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(t)){const t=r[1],n=t.length;if(3===n)return this.r=parseInt(t.charAt(0)+t.charAt(0),16)/255,this.g=parseInt(t.charAt(1)+t.charAt(1),16)/255,this.b=parseInt(t.charAt(2)+t.charAt(2),16)/255,jEt.toWorkingColorSpace(this,e),this;if(6===n)return this.r=parseInt(t.charAt(0)+t.charAt(1),16)/255,this.g=parseInt(t.charAt(2)+t.charAt(3),16)/255,this.b=parseInt(t.charAt(4)+t.charAt(5),16)/255,jEt.toWorkingColorSpace(this,e),this}return t&&t.length>0?this.setColorName(t,e):this}setColorName(t,e=dEt){const n=BEt[t.toLowerCase()];return void 0!==n&&this.setHex(n,e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=NEt(t.r),this.g=NEt(t.g),this.b=NEt(t.b),this}copyLinearToSRGB(t){return this.r=DEt(t.r),this.g=DEt(t.g),this.b=DEt(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(t=dEt){return jEt.fromWorkingColorSpace(WEt(this,zEt),t),MEt(255*zEt.r,0,255)<<16^MEt(255*zEt.g,0,255)<<8^MEt(255*zEt.b,0,255)<<0}getHexString(t=dEt){return("000000"+this.getHex(t).toString(16)).slice(-6)}getHSL(t,e=jEt.workingColorSpace){jEt.fromWorkingColorSpace(WEt(this,zEt),e);const n=zEt.r,r=zEt.g,i=zEt.b,o=Math.max(n,r,i),a=Math.min(n,r,i);let s,u;const c=(a+o)/2;if(a===o)s=0,u=0;else{const t=o-a;switch(u=c<=.5?t/(o+a):t/(2-o-a),o){case n:s=(r-i)/t+(r<i?6:0);break;case r:s=(i-n)/t+2;break;case i:s=(n-r)/t+4}s/=6}return t.h=s,t.s=u,t.l=c,t}getRGB(t,e=jEt.workingColorSpace){return jEt.fromWorkingColorSpace(WEt(this,zEt),e),t.r=zEt.r,t.g=zEt.g,t.b=zEt.b,t}getStyle(t=dEt){return jEt.fromWorkingColorSpace(WEt(this,zEt),t),t!==dEt?`color(${t} ${zEt.r} ${zEt.g} ${zEt.b})`:`rgb(${255*zEt.r|0},${255*zEt.g|0},${255*zEt.b|0})`}offsetHSL(t,e,n){return this.getHSL(UEt),UEt.h+=t,UEt.s+=e,UEt.l+=n,this.setHSL(UEt.h,UEt.s,UEt.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this}lerpColors(t,e,n){return this.r=t.r+(e.r-t.r)*n,this.g=t.g+(e.g-t.g)*n,this.b=t.b+(e.b-t.b)*n,this}lerpHSL(t,e){this.getHSL(UEt),t.getHSL(VEt);const n=AEt(UEt.h,VEt.h,e),r=AEt(UEt.s,VEt.s,e),i=AEt(UEt.l,VEt.l,e);return this.setHSL(n,r,i),this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,e=0){return this.r=t[e],this.g=t[e+1],this.b=t[e+2],this}toArray(t=[],e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}fromBufferAttribute(t,e){return this.r=t.getX(e),this.g=t.getY(e),this.b=t.getZ(e),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}let YEt;HEt.NAMES=BEt;class XEt{static getDataURL(t){if(/^data:/i.test(t.src))return t.src;if("undefined"==typeof HTMLCanvasElement)return t.src;let e;if(t instanceof HTMLCanvasElement)e=t;else{void 0===YEt&&(YEt=IEt("canvas")),YEt.width=t.width,YEt.height=t.height;const n=YEt.getContext("2d");t instanceof ImageData?n.putImageData(t,0,0):n.drawImage(t,0,0,t.width,t.height),e=YEt}return e.width>2048||e.height>2048?e.toDataURL("image/jpeg",.6):e.toDataURL("image/png")}static sRGBToLinear(t){if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap){const e=IEt("canvas");e.width=t.width,e.height=t.height;const n=e.getContext("2d");n.drawImage(t,0,0,t.width,t.height);const r=n.getImageData(0,0,t.width,t.height),i=r.data;for(let t=0;t<i.length;t++)i[t]=255*NEt(i[t]/255);return n.putImageData(r,0,0),e}if(t.data){const e=t.data.slice(0);for(let t=0;t<e.length;t++)e instanceof Uint8Array||e instanceof Uint8ClampedArray?e[t]=Math.floor(255*NEt(e[t]/255)):e[t]=NEt(e[t]);return{data:e,width:t.width,height:t.height}}return t}}class qEt{constructor(t=null){this.isSource=!0,this.uuid=SEt(),this.data=t,this.version=0}set needsUpdate(t){!0===t&&this.version++}toJSON(t){const e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.images[this.uuid])return t.images[this.uuid];const n={uuid:this.uuid,url:""},r=this.data;if(null!==r){let t;if(Array.isArray(r)){t=[];for(let e=0,n=r.length;e<n;e++)r[e].isDataTexture?t.push(ZEt(r[e].image)):t.push(ZEt(r[e]))}else t=ZEt(r);n.url=t}return e||(t.images[this.uuid]=n),n}}function ZEt(t){return"undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap?XEt.getDataURL(t):t.data?{data:Array.from(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:{}}let $Et=0;class KEt extends yEt{constructor(t=KEt.DEFAULT_IMAGE,e=KEt.DEFAULT_MAPPING,n=1001,r=1001,i=1006,o=1008,a=1023,s=1009,u=KEt.DEFAULT_ANISOTROPY,c=3e3){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:$Et++}),this.uuid=SEt(),this.name="",this.source=new qEt(t),this.mipmaps=[],this.mapping=e,this.wrapS=n,this.wrapT=r,this.magFilter=i,this.minFilter=o,this.anisotropy=u,this.format=a,this.internalFormat=null,this.type=s,this.offset=new PEt(0,0),this.repeat=new PEt(1,1),this.center=new PEt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new LEt,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=c,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),e||(t.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case tEt:t.x=t.x-Math.floor(t.x);break;case eEt:t.x=t.x<0?0:1;break;case nEt:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case tEt:t.y=t.y-Math.floor(t.y);break;case eEt:t.y=t.y<0?0:1;break;case nEt:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}}KEt.DEFAULT_IMAGE=null,KEt.DEFAULT_MAPPING=300,KEt.DEFAULT_ANISOTROPY=1;class JEt{constructor(t=0,e=0,n=0,r=1){JEt.prototype.isVector4=!0,this.x=t,this.y=e,this.z=n,this.w=r}get width(){return this.z}set width(t){this.z=t}get height(){return this.w}set height(t){this.w=t}set(t,e,n,r){return this.x=t,this.y=e,this.z=n,this.w=r,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this.w=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setW(t){return this.w=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}applyMatrix4(t){const e=this.x,n=this.y,r=this.z,i=this.w,o=t.elements;return this.x=o[0]*e+o[4]*n+o[8]*r+o[12]*i,this.y=o[1]*e+o[5]*n+o[9]*r+o[13]*i,this.z=o[2]*e+o[6]*n+o[10]*r+o[14]*i,this.w=o[3]*e+o[7]*n+o[11]*r+o[15]*i,this}divideScalar(t){return this.multiplyScalar(1/t)}setAxisAngleFromQuaternion(t){this.w=2*Math.acos(t.w);const e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this}setAxisAngleFromRotationMatrix(t){let e,n,r,i;const o=.01,a=.1,s=t.elements,u=s[0],c=s[4],l=s[8],h=s[1],f=s[5],p=s[9],d=s[2],m=s[6],v=s[10];if(Math.abs(c-h)<o&&Math.abs(l-d)<o&&Math.abs(p-m)<o){if(Math.abs(c+h)<a&&Math.abs(l+d)<a&&Math.abs(p+m)<a&&Math.abs(u+f+v-3)<a)return this.set(1,0,0,0),this;e=Math.PI;const t=(u+1)/2,s=(f+1)/2,g=(v+1)/2,y=(c+h)/4,x=(l+d)/4,b=(p+m)/4;return t>s&&t>g?t<o?(n=0,r=.707106781,i=.707106781):(n=Math.sqrt(t),r=y/n,i=x/n):s>g?s<o?(n=.707106781,r=0,i=.707106781):(r=Math.sqrt(s),n=y/r,i=b/r):g<o?(n=.707106781,r=.707106781,i=0):(i=Math.sqrt(g),n=x/i,r=b/i),this.set(n,r,i,e),this}let g=Math.sqrt((m-p)*(m-p)+(l-d)*(l-d)+(h-c)*(h-c));return Math.abs(g)<.001&&(g=1),this.x=(m-p)/g,this.y=(l-d)/g,this.z=(h-c)/g,this.w=Math.acos((u+f+v-1)/2),this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this.w=Math.max(t,Math.min(e,this.w)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this.w=t.w+(e.w-t.w)*n,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class QEt{constructor(t=0,e=0,n=0,r=1){this.isQuaternion=!0,this._x=t,this._y=e,this._z=n,this._w=r}static slerpFlat(t,e,n,r,i,o,a){let s=n[r+0],u=n[r+1],c=n[r+2],l=n[r+3];const h=i[o+0],f=i[o+1],p=i[o+2],d=i[o+3];if(0===a)return t[e+0]=s,t[e+1]=u,t[e+2]=c,void(t[e+3]=l);if(1===a)return t[e+0]=h,t[e+1]=f,t[e+2]=p,void(t[e+3]=d);if(l!==d||s!==h||u!==f||c!==p){let t=1-a;const e=s*h+u*f+c*p+l*d,n=e>=0?1:-1,r=1-e*e;if(r>Number.EPSILON){const i=Math.sqrt(r),o=Math.atan2(i,e*n);t=Math.sin(t*o)/i,a=Math.sin(a*o)/i}const i=a*n;if(s=s*t+h*i,u=u*t+f*i,c=c*t+p*i,l=l*t+d*i,t===1-a){const t=1/Math.sqrt(s*s+u*u+c*c+l*l);s*=t,u*=t,c*=t,l*=t}}t[e]=s,t[e+1]=u,t[e+2]=c,t[e+3]=l}static multiplyQuaternionsFlat(t,e,n,r,i,o){const a=n[r],s=n[r+1],u=n[r+2],c=n[r+3],l=i[o],h=i[o+1],f=i[o+2],p=i[o+3];return t[e]=a*p+c*l+s*f-u*h,t[e+1]=s*p+c*h+u*l-a*f,t[e+2]=u*p+c*f+a*h-s*l,t[e+3]=c*p-a*l-s*h-u*f,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,e){const n=t._x,r=t._y,i=t._z,o=t._order,a=Math.cos,s=Math.sin,u=a(n/2),c=a(r/2),l=a(i/2),h=s(n/2),f=s(r/2),p=s(i/2);switch(o){case"XYZ":this._x=h*c*l+u*f*p,this._y=u*f*l-h*c*p,this._z=u*c*p+h*f*l,this._w=u*c*l-h*f*p;break;case"YXZ":this._x=h*c*l+u*f*p,this._y=u*f*l-h*c*p,this._z=u*c*p-h*f*l,this._w=u*c*l+h*f*p;break;case"ZXY":this._x=h*c*l-u*f*p,this._y=u*f*l+h*c*p,this._z=u*c*p+h*f*l,this._w=u*c*l-h*f*p;break;case"ZYX":this._x=h*c*l-u*f*p,this._y=u*f*l+h*c*p,this._z=u*c*p-h*f*l,this._w=u*c*l+h*f*p;break;case"YZX":this._x=h*c*l+u*f*p,this._y=u*f*l+h*c*p,this._z=u*c*p-h*f*l,this._w=u*c*l-h*f*p;break;case"XZY":this._x=h*c*l-u*f*p,this._y=u*f*l-h*c*p,this._z=u*c*p+h*f*l,this._w=u*c*l+h*f*p}return!1!==e&&this._onChangeCallback(),this}setFromAxisAngle(t,e){const n=e/2,r=Math.sin(n);return this._x=t.x*r,this._y=t.y*r,this._z=t.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(t){const e=t.elements,n=e[0],r=e[4],i=e[8],o=e[1],a=e[5],s=e[9],u=e[2],c=e[6],l=e[10],h=n+a+l;if(h>0){const t=.5/Math.sqrt(h+1);this._w=.25/t,this._x=(c-s)*t,this._y=(i-u)*t,this._z=(o-r)*t}else if(n>a&&n>l){const t=2*Math.sqrt(1+n-a-l);this._w=(c-s)/t,this._x=.25*t,this._y=(r+o)/t,this._z=(i+u)/t}else if(a>l){const t=2*Math.sqrt(1+a-n-l);this._w=(i-u)/t,this._x=(r+o)/t,this._y=.25*t,this._z=(s+c)/t}else{const t=2*Math.sqrt(1+l-n-a);this._w=(o-r)/t,this._x=(i+u)/t,this._y=(s+c)/t,this._z=.25*t}return this._onChangeCallback(),this}setFromUnitVectors(t,e){let n=t.dot(e)+1;return n<Number.EPSILON?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=n):(this._x=0,this._y=-t.z,this._z=t.y,this._w=n)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=n),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(MEt(this.dot(t),-1,1)))}rotateTowards(t,e){const n=this.angleTo(t);if(0===n)return this;const r=Math.min(1,e/n);return this.slerp(t,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t){return this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){const n=t._x,r=t._y,i=t._z,o=t._w,a=e._x,s=e._y,u=e._z,c=e._w;return this._x=n*c+o*a+r*u-i*s,this._y=r*c+o*s+i*a-n*u,this._z=i*c+o*u+n*s-r*a,this._w=o*c-n*a-r*s-i*u,this._onChangeCallback(),this}slerp(t,e){if(0===e)return this;if(1===e)return this.copy(t);const n=this._x,r=this._y,i=this._z,o=this._w;let a=o*t._w+n*t._x+r*t._y+i*t._z;if(a<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,a=-a):this.copy(t),a>=1)return this._w=o,this._x=n,this._y=r,this._z=i,this;const s=1-a*a;if(s<=Number.EPSILON){const t=1-e;return this._w=t*o+e*this._w,this._x=t*n+e*this._x,this._y=t*r+e*this._y,this._z=t*i+e*this._z,this.normalize(),this._onChangeCallback(),this}const u=Math.sqrt(s),c=Math.atan2(u,a),l=Math.sin((1-e)*c)/u,h=Math.sin(e*c)/u;return this._w=o*l+this._w*h,this._x=n*l+this._x*h,this._y=r*l+this._y*h,this._z=i*l+this._z*h,this._onChangeCallback(),this}slerpQuaternions(t,e,n){return this.copy(t).slerp(e,n)}random(){const t=Math.random(),e=Math.sqrt(1-t),n=Math.sqrt(t),r=2*Math.PI*Math.random(),i=2*Math.PI*Math.random();return this.set(e*Math.cos(r),n*Math.sin(i),n*Math.cos(i),e*Math.sin(r))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,e=0){return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}fromBufferAttribute(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class tAt{constructor(t=0,e=0,n=0){tAt.prototype.isVector3=!0,this.x=t,this.y=e,this.z=n}set(t,e,n){return void 0===n&&(n=this.z),this.x=t,this.y=e,this.z=n,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}applyEuler(t){return this.applyQuaternion(nAt.setFromEuler(t))}applyAxisAngle(t,e){return this.applyQuaternion(nAt.setFromAxisAngle(t,e))}applyMatrix3(t){const e=this.x,n=this.y,r=this.z,i=t.elements;return this.x=i[0]*e+i[3]*n+i[6]*r,this.y=i[1]*e+i[4]*n+i[7]*r,this.z=i[2]*e+i[5]*n+i[8]*r,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const e=this.x,n=this.y,r=this.z,i=t.elements,o=1/(i[3]*e+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*e+i[4]*n+i[8]*r+i[12])*o,this.y=(i[1]*e+i[5]*n+i[9]*r+i[13])*o,this.z=(i[2]*e+i[6]*n+i[10]*r+i[14])*o,this}applyQuaternion(t){const e=this.x,n=this.y,r=this.z,i=t.x,o=t.y,a=t.z,s=t.w,u=s*e+o*r-a*n,c=s*n+a*e-i*r,l=s*r+i*n-o*e,h=-i*e-o*n-a*r;return this.x=u*s+h*-i+c*-a-l*-o,this.y=c*s+h*-o+l*-i-u*-a,this.z=l*s+h*-a+u*-o-c*-i,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const e=this.x,n=this.y,r=this.z,i=t.elements;return this.x=i[0]*e+i[4]*n+i[8]*r,this.y=i[1]*e+i[5]*n+i[9]*r,this.z=i[2]*e+i[6]*n+i[10]*r,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this}cross(t){return this.crossVectors(this,t)}crossVectors(t,e){const n=t.x,r=t.y,i=t.z,o=e.x,a=e.y,s=e.z;return this.x=r*s-i*a,this.y=i*o-n*s,this.z=n*a-r*o,this}projectOnVector(t){const e=t.lengthSq();if(0===e)return this.set(0,0,0);const n=t.dot(this)/e;return this.copy(t).multiplyScalar(n)}projectOnPlane(t){return eAt.copy(this).projectOnVector(t),this.sub(eAt)}reflect(t){return this.sub(eAt.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;const n=this.dot(t)/e;return Math.acos(MEt(n,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y,r=this.z-t.z;return e*e+n*n+r*r}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,e,n){const r=Math.sin(e)*t;return this.x=r*Math.sin(n),this.y=Math.cos(e)*t,this.z=r*Math.cos(n),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,e,n){return this.x=t*Math.sin(e),this.y=n,this.z=t*Math.cos(e),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}setFromMatrixScale(t){const e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),r=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=r,this}setFromMatrixColumn(t,e){return this.fromArray(t.elements,4*e)}setFromMatrix3Column(t,e){return this.fromArray(t.elements,3*e)}setFromEuler(t){return this.x=t._x,this.y=t._y,this.z=t._z,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const t=2*(Math.random()-.5),e=Math.random()*Math.PI*2,n=Math.sqrt(1-t**2);return this.x=n*Math.cos(e),this.y=n*Math.sin(e),this.z=t,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const eAt=new tAt,nAt=new QEt;class rAt{constructor(t=new tAt(1/0,1/0,1/0),e=new tAt(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromArray(t){let e=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,a=-1/0;for(let s=0,u=t.length;s<u;s+=3){const u=t[s],c=t[s+1],l=t[s+2];u<e&&(e=u),c<n&&(n=c),l<r&&(r=l),u>i&&(i=u),c>o&&(o=c),l>a&&(a=l)}return this.min.set(e,n,r),this.max.set(i,o,a),this}setFromBufferAttribute(t){let e=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,a=-1/0;for(let s=0,u=t.count;s<u;s++){const u=t.getX(s),c=t.getY(s),l=t.getZ(s);u<e&&(e=u),c<n&&(n=c),l<r&&(r=l),u>i&&(i=u),c>o&&(o=c),l>a&&(a=l)}return this.min.set(e,n,r),this.max.set(i,o,a),this}setFromPoints(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const n=oAt.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}setFromObject(t,e=!1){return this.makeEmpty(),this.expandByObject(t,e)}clone(){return(new this.constructor).copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t,e=!1){t.updateWorldMatrix(!1,!1);const n=t.geometry;if(void 0!==n)if(e&&null!=n.attributes&&void 0!==n.attributes.position){const e=n.attributes.position;for(let n=0,r=e.count;n<r;n++)oAt.fromBufferAttribute(e,n).applyMatrix4(t.matrixWorld),this.expandByPoint(oAt)}else null===n.boundingBox&&n.computeBoundingBox(),aAt.copy(n.boundingBox),aAt.applyMatrix4(t.matrixWorld),this.union(aAt);const r=t.children;for(let i=0,o=r.length;i<o;i++)this.expandByObject(r[i],e);return this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)}intersectsSphere(t){return this.clampPoint(t.center,oAt),oAt.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let e,n;return t.normal.x>0?(e=t.normal.x*this.min.x,n=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,n=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),e<=-t.constant&&n>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(pAt),dAt.subVectors(this.max,pAt),sAt.subVectors(t.a,pAt),uAt.subVectors(t.b,pAt),cAt.subVectors(t.c,pAt),lAt.subVectors(uAt,sAt),hAt.subVectors(cAt,uAt),fAt.subVectors(sAt,cAt);let e=[0,-lAt.z,lAt.y,0,-hAt.z,hAt.y,0,-fAt.z,fAt.y,lAt.z,0,-lAt.x,hAt.z,0,-hAt.x,fAt.z,0,-fAt.x,-lAt.y,lAt.x,0,-hAt.y,hAt.x,0,-fAt.y,fAt.x,0];return!!gAt(e,sAt,uAt,cAt,dAt)&&(e=[1,0,0,0,1,0,0,0,1],!!gAt(e,sAt,uAt,cAt,dAt)&&(mAt.crossVectors(lAt,hAt),e=[mAt.x,mAt.y,mAt.z],gAt(e,sAt,uAt,cAt,dAt)))}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return oAt.copy(t).clamp(this.min,this.max).sub(t).length()}getBoundingSphere(t){return this.getCenter(t.center),t.radius=.5*this.getSize(oAt).length(),t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()||(iAt[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),iAt[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),iAt[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),iAt[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),iAt[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),iAt[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),iAt[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),iAt[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(iAt)),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}const iAt=[new tAt,new tAt,new tAt,new tAt,new tAt,new tAt,new tAt,new tAt],oAt=new tAt,aAt=new rAt,sAt=new tAt,uAt=new tAt,cAt=new tAt,lAt=new tAt,hAt=new tAt,fAt=new tAt,pAt=new tAt,dAt=new tAt,mAt=new tAt,vAt=new tAt;function gAt(t,e,n,r,i){for(let o=0,a=t.length-3;o<=a;o+=3){vAt.fromArray(t,o);const a=i.x*Math.abs(vAt.x)+i.y*Math.abs(vAt.y)+i.z*Math.abs(vAt.z),s=e.dot(vAt),u=n.dot(vAt),c=r.dot(vAt);if(Math.max(-Math.max(s,u,c),Math.min(s,u,c))>a)return!1}return!0}const yAt=new rAt,xAt=new tAt,bAt=new tAt;class _At{constructor(t=new tAt,e=-1){this.center=t,this.radius=e}set(t,e){return this.center.copy(t),this.radius=e,this}setFromPoints(t,e){const n=this.center;void 0!==e?n.copy(e):yAt.setFromPoints(t).getCenter(n);let r=0;for(let i=0,o=t.length;i<o;i++)r=Math.max(r,n.distanceToSquared(t[i]));return this.radius=Math.sqrt(r),this}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){const e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,e){const n=this.center.distanceToSquared(t);return e.copy(t),n>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e}getBoundingBox(t){return this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}expandByPoint(t){if(this.isEmpty())return this.center.copy(t),this.radius=0,this;xAt.subVectors(t,this.center);const e=xAt.lengthSq();if(e>this.radius*this.radius){const t=Math.sqrt(e),n=.5*(t-this.radius);this.center.addScaledVector(xAt,n/t),this.radius+=n}return this}union(t){return t.isEmpty()?this:this.isEmpty()?(this.copy(t),this):(!0===this.center.equals(t.center)?this.radius=Math.max(this.radius,t.radius):(bAt.subVectors(t.center,this.center).setLength(t.radius),this.expandByPoint(xAt.copy(t.center).add(bAt)),this.expandByPoint(xAt.copy(t.center).sub(bAt))),this)}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const wAt=new tAt,SAt=new tAt,MAt=new tAt,EAt=new tAt,AAt=new tAt,TAt=new tAt,CAt=new tAt;class OAt{constructor(t=new tAt,e=new tAt(0,0,-1)){this.origin=t,this.direction=e}set(t,e){return this.origin.copy(t),this.direction.copy(e),this}copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}at(t,e){return e.copy(this.direction).multiplyScalar(t).add(this.origin)}lookAt(t){return this.direction.copy(t).sub(this.origin).normalize(),this}recast(t){return this.origin.copy(this.at(t,wAt)),this}closestPointToPoint(t,e){e.subVectors(t,this.origin);const n=e.dot(this.direction);return n<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(n).add(this.origin)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){const e=wAt.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(wAt.copy(this.direction).multiplyScalar(e).add(this.origin),wAt.distanceToSquared(t))}distanceSqToSegment(t,e,n,r){SAt.copy(t).add(e).multiplyScalar(.5),MAt.copy(e).sub(t).normalize(),EAt.copy(this.origin).sub(SAt);const i=.5*t.distanceTo(e),o=-this.direction.dot(MAt),a=EAt.dot(this.direction),s=-EAt.dot(MAt),u=EAt.lengthSq(),c=Math.abs(1-o*o);let l,h,f,p;if(c>0)if(l=o*s-a,h=o*a-s,p=i*c,l>=0)if(h>=-p)if(h<=p){const t=1/c;l*=t,h*=t,f=l*(l+o*h+2*a)+h*(o*l+h+2*s)+u}else h=i,l=Math.max(0,-(o*h+a)),f=-l*l+h*(h+2*s)+u;else h=-i,l=Math.max(0,-(o*h+a)),f=-l*l+h*(h+2*s)+u;else h<=-p?(l=Math.max(0,-(-o*i+a)),h=l>0?-i:Math.min(Math.max(-i,-s),i),f=-l*l+h*(h+2*s)+u):h<=p?(l=0,h=Math.min(Math.max(-i,-s),i),f=h*(h+2*s)+u):(l=Math.max(0,-(o*i+a)),h=l>0?i:Math.min(Math.max(-i,-s),i),f=-l*l+h*(h+2*s)+u);else h=o>0?-i:i,l=Math.max(0,-(o*h+a)),f=-l*l+h*(h+2*s)+u;return n&&n.copy(this.direction).multiplyScalar(l).add(this.origin),r&&r.copy(MAt).multiplyScalar(h).add(SAt),f}intersectSphere(t,e){wAt.subVectors(t.center,this.origin);const n=wAt.dot(this.direction),r=wAt.dot(wAt)-n*n,i=t.radius*t.radius;if(r>i)return null;const o=Math.sqrt(i-r),a=n-o,s=n+o;return a<0&&s<0?null:a<0?this.at(s,e):this.at(a,e)}intersectsSphere(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){const e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(t.normal)+t.constant)/e;return n>=0?n:null}intersectPlane(t,e){const n=this.distanceToPlane(t);return null===n?null:this.at(n,e)}intersectsPlane(t){const e=t.distanceToPoint(this.origin);if(0===e)return!0;return t.normal.dot(this.direction)*e<0}intersectBox(t,e){let n,r,i,o,a,s;const u=1/this.direction.x,c=1/this.direction.y,l=1/this.direction.z,h=this.origin;return u>=0?(n=(t.min.x-h.x)*u,r=(t.max.x-h.x)*u):(n=(t.max.x-h.x)*u,r=(t.min.x-h.x)*u),c>=0?(i=(t.min.y-h.y)*c,o=(t.max.y-h.y)*c):(i=(t.max.y-h.y)*c,o=(t.min.y-h.y)*c),n>o||i>r?null:((i>n||isNaN(n))&&(n=i),(o<r||isNaN(r))&&(r=o),l>=0?(a=(t.min.z-h.z)*l,s=(t.max.z-h.z)*l):(a=(t.max.z-h.z)*l,s=(t.min.z-h.z)*l),n>s||a>r?null:((a>n||n!=n)&&(n=a),(s<r||r!=r)&&(r=s),r<0?null:this.at(n>=0?n:r,e)))}intersectsBox(t){return null!==this.intersectBox(t,wAt)}intersectTriangle(t,e,n,r,i){AAt.subVectors(e,t),TAt.subVectors(n,t),CAt.crossVectors(AAt,TAt);let o,a=this.direction.dot(CAt);if(a>0){if(r)return null;o=1}else{if(!(a<0))return null;o=-1,a=-a}EAt.subVectors(this.origin,t);const s=o*this.direction.dot(TAt.crossVectors(EAt,TAt));if(s<0)return null;const u=o*this.direction.dot(AAt.cross(EAt));if(u<0)return null;if(s+u>a)return null;const c=-o*EAt.dot(CAt);return c<0?null:this.at(c/a,i)}applyMatrix4(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class kAt{constructor(){kAt.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(t,e,n,r,i,o,a,s,u,c,l,h,f,p,d,m){const v=this.elements;return v[0]=t,v[4]=e,v[8]=n,v[12]=r,v[1]=i,v[5]=o,v[9]=a,v[13]=s,v[2]=u,v[6]=c,v[10]=l,v[14]=h,v[3]=f,v[7]=p,v[11]=d,v[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new kAt).fromArray(this.elements)}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],this}copyPosition(t){const e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this}setFromMatrix3(t){const e=t.elements;return this.set(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1),this}extractBasis(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this}extractRotation(t){const e=this.elements,n=t.elements,r=1/PAt.setFromMatrixColumn(t,0).length(),i=1/PAt.setFromMatrixColumn(t,1).length(),o=1/PAt.setFromMatrixColumn(t,2).length();return e[0]=n[0]*r,e[1]=n[1]*r,e[2]=n[2]*r,e[3]=0,e[4]=n[4]*i,e[5]=n[5]*i,e[6]=n[6]*i,e[7]=0,e[8]=n[8]*o,e[9]=n[9]*o,e[10]=n[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromEuler(t){const e=this.elements,n=t.x,r=t.y,i=t.z,o=Math.cos(n),a=Math.sin(n),s=Math.cos(r),u=Math.sin(r),c=Math.cos(i),l=Math.sin(i);if("XYZ"===t.order){const t=o*c,n=o*l,r=a*c,i=a*l;e[0]=s*c,e[4]=-s*l,e[8]=u,e[1]=n+r*u,e[5]=t-i*u,e[9]=-a*s,e[2]=i-t*u,e[6]=r+n*u,e[10]=o*s}else if("YXZ"===t.order){const t=s*c,n=s*l,r=u*c,i=u*l;e[0]=t+i*a,e[4]=r*a-n,e[8]=o*u,e[1]=o*l,e[5]=o*c,e[9]=-a,e[2]=n*a-r,e[6]=i+t*a,e[10]=o*s}else if("ZXY"===t.order){const t=s*c,n=s*l,r=u*c,i=u*l;e[0]=t-i*a,e[4]=-o*l,e[8]=r+n*a,e[1]=n+r*a,e[5]=o*c,e[9]=i-t*a,e[2]=-o*u,e[6]=a,e[10]=o*s}else if("ZYX"===t.order){const t=o*c,n=o*l,r=a*c,i=a*l;e[0]=s*c,e[4]=r*u-n,e[8]=t*u+i,e[1]=s*l,e[5]=i*u+t,e[9]=n*u-r,e[2]=-u,e[6]=a*s,e[10]=o*s}else if("YZX"===t.order){const t=o*s,n=o*u,r=a*s,i=a*u;e[0]=s*c,e[4]=i-t*l,e[8]=r*l+n,e[1]=l,e[5]=o*c,e[9]=-a*c,e[2]=-u*c,e[6]=n*l+r,e[10]=t-i*l}else if("XZY"===t.order){const t=o*s,n=o*u,r=a*s,i=a*u;e[0]=s*c,e[4]=-l,e[8]=u*c,e[1]=t*l+i,e[5]=o*c,e[9]=n*l-r,e[2]=r*l-n,e[6]=a*c,e[10]=i*l+t}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromQuaternion(t){return this.compose(RAt,t,IAt)}lookAt(t,e,n){const r=this.elements;return FAt.subVectors(t,e),0===FAt.lengthSq()&&(FAt.z=1),FAt.normalize(),NAt.crossVectors(n,FAt),0===NAt.lengthSq()&&(1===Math.abs(n.z)?FAt.x+=1e-4:FAt.z+=1e-4,FAt.normalize(),NAt.crossVectors(n,FAt)),NAt.normalize(),DAt.crossVectors(FAt,NAt),r[0]=NAt.x,r[4]=DAt.x,r[8]=FAt.x,r[1]=NAt.y,r[5]=DAt.y,r[9]=FAt.y,r[2]=NAt.z,r[6]=DAt.z,r[10]=FAt.z,this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,r=e.elements,i=this.elements,o=n[0],a=n[4],s=n[8],u=n[12],c=n[1],l=n[5],h=n[9],f=n[13],p=n[2],d=n[6],m=n[10],v=n[14],g=n[3],y=n[7],x=n[11],b=n[15],_=r[0],w=r[4],S=r[8],M=r[12],E=r[1],A=r[5],T=r[9],C=r[13],O=r[2],k=r[6],P=r[10],L=r[14],R=r[3],I=r[7],N=r[11],D=r[15];return i[0]=o*_+a*E+s*O+u*R,i[4]=o*w+a*A+s*k+u*I,i[8]=o*S+a*T+s*P+u*N,i[12]=o*M+a*C+s*L+u*D,i[1]=c*_+l*E+h*O+f*R,i[5]=c*w+l*A+h*k+f*I,i[9]=c*S+l*T+h*P+f*N,i[13]=c*M+l*C+h*L+f*D,i[2]=p*_+d*E+m*O+v*R,i[6]=p*w+d*A+m*k+v*I,i[10]=p*S+d*T+m*P+v*N,i[14]=p*M+d*C+m*L+v*D,i[3]=g*_+y*E+x*O+b*R,i[7]=g*w+y*A+x*k+b*I,i[11]=g*S+y*T+x*P+b*N,i[15]=g*M+y*C+x*L+b*D,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[4],r=t[8],i=t[12],o=t[1],a=t[5],s=t[9],u=t[13],c=t[2],l=t[6],h=t[10],f=t[14];return t[3]*(+i*s*l-r*u*l-i*a*h+n*u*h+r*a*f-n*s*f)+t[7]*(+e*s*f-e*u*h+i*o*h-r*o*f+r*u*c-i*s*c)+t[11]*(+e*u*l-e*a*f-i*o*l+n*o*f+i*a*c-n*u*c)+t[15]*(-r*a*c-e*s*l+e*a*h+r*o*l-n*o*h+n*s*c)}transpose(){const t=this.elements;let e;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(t,e,n){const r=this.elements;return t.isVector3?(r[12]=t.x,r[13]=t.y,r[14]=t.z):(r[12]=t,r[13]=e,r[14]=n),this}invert(){const t=this.elements,e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],s=t[6],u=t[7],c=t[8],l=t[9],h=t[10],f=t[11],p=t[12],d=t[13],m=t[14],v=t[15],g=l*m*u-d*h*u+d*s*f-a*m*f-l*s*v+a*h*v,y=p*h*u-c*m*u-p*s*f+o*m*f+c*s*v-o*h*v,x=c*d*u-p*l*u+p*a*f-o*d*f-c*a*v+o*l*v,b=p*l*s-c*d*s-p*a*h+o*d*h+c*a*m-o*l*m,_=e*g+n*y+r*x+i*b;if(0===_)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const w=1/_;return t[0]=g*w,t[1]=(d*h*i-l*m*i-d*r*f+n*m*f+l*r*v-n*h*v)*w,t[2]=(a*m*i-d*s*i+d*r*u-n*m*u-a*r*v+n*s*v)*w,t[3]=(l*s*i-a*h*i-l*r*u+n*h*u+a*r*f-n*s*f)*w,t[4]=y*w,t[5]=(c*m*i-p*h*i+p*r*f-e*m*f-c*r*v+e*h*v)*w,t[6]=(p*s*i-o*m*i-p*r*u+e*m*u+o*r*v-e*s*v)*w,t[7]=(o*h*i-c*s*i+c*r*u-e*h*u-o*r*f+e*s*f)*w,t[8]=x*w,t[9]=(p*l*i-c*d*i-p*n*f+e*d*f+c*n*v-e*l*v)*w,t[10]=(o*d*i-p*a*i+p*n*u-e*d*u-o*n*v+e*a*v)*w,t[11]=(c*a*i-o*l*i-c*n*u+e*l*u+o*n*f-e*a*f)*w,t[12]=b*w,t[13]=(c*d*r-p*l*r+p*n*h-e*d*h-c*n*m+e*l*m)*w,t[14]=(p*a*r-o*d*r-p*n*s+e*d*s+o*n*m-e*a*m)*w,t[15]=(o*l*r-c*a*r+c*n*s-e*l*s-o*n*h+e*a*h)*w,this}scale(t){const e=this.elements,n=t.x,r=t.y,i=t.z;return e[0]*=n,e[4]*=r,e[8]*=i,e[1]*=n,e[5]*=r,e[9]*=i,e[2]*=n,e[6]*=r,e[10]*=i,e[3]*=n,e[7]*=r,e[11]*=i,this}getMaxScaleOnAxis(){const t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],r=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,n,r))}makeTranslation(t,e,n){return this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this}makeRotationX(t){const e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this}makeRotationY(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this}makeRotationZ(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,e){const n=Math.cos(e),r=Math.sin(e),i=1-n,o=t.x,a=t.y,s=t.z,u=i*o,c=i*a;return this.set(u*o+n,u*a-r*s,u*s+r*a,0,u*a+r*s,c*a+n,c*s-r*o,0,u*s-r*a,c*s+r*o,i*s*s+n,0,0,0,0,1),this}makeScale(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this}makeShear(t,e,n,r,i,o){return this.set(1,n,i,0,t,1,o,0,e,r,1,0,0,0,0,1),this}compose(t,e,n){const r=this.elements,i=e._x,o=e._y,a=e._z,s=e._w,u=i+i,c=o+o,l=a+a,h=i*u,f=i*c,p=i*l,d=o*c,m=o*l,v=a*l,g=s*u,y=s*c,x=s*l,b=n.x,_=n.y,w=n.z;return r[0]=(1-(d+v))*b,r[1]=(f+x)*b,r[2]=(p-y)*b,r[3]=0,r[4]=(f-x)*_,r[5]=(1-(h+v))*_,r[6]=(m+g)*_,r[7]=0,r[8]=(p+y)*w,r[9]=(m-g)*w,r[10]=(1-(h+d))*w,r[11]=0,r[12]=t.x,r[13]=t.y,r[14]=t.z,r[15]=1,this}decompose(t,e,n){const r=this.elements;let i=PAt.set(r[0],r[1],r[2]).length();const o=PAt.set(r[4],r[5],r[6]).length(),a=PAt.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),t.x=r[12],t.y=r[13],t.z=r[14],LAt.copy(this);const s=1/i,u=1/o,c=1/a;return LAt.elements[0]*=s,LAt.elements[1]*=s,LAt.elements[2]*=s,LAt.elements[4]*=u,LAt.elements[5]*=u,LAt.elements[6]*=u,LAt.elements[8]*=c,LAt.elements[9]*=c,LAt.elements[10]*=c,e.setFromRotationMatrix(LAt),n.x=i,n.y=o,n.z=a,this}makePerspective(t,e,n,r,i,o){const a=this.elements,s=2*i/(e-t),u=2*i/(n-r),c=(e+t)/(e-t),l=(n+r)/(n-r),h=-(o+i)/(o-i),f=-2*o*i/(o-i);return a[0]=s,a[4]=0,a[8]=c,a[12]=0,a[1]=0,a[5]=u,a[9]=l,a[13]=0,a[2]=0,a[6]=0,a[10]=h,a[14]=f,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(t,e,n,r,i,o){const a=this.elements,s=1/(e-t),u=1/(n-r),c=1/(o-i),l=(e+t)*s,h=(n+r)*u,f=(o+i)*c;return a[0]=2*s,a[4]=0,a[8]=0,a[12]=-l,a[1]=0,a[5]=2*u,a[9]=0,a[13]=-h,a[2]=0,a[6]=0,a[10]=-2*c,a[14]=-f,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(t){const e=this.elements,n=t.elements;for(let r=0;r<16;r++)if(e[r]!==n[r])return!1;return!0}fromArray(t,e=0){for(let n=0;n<16;n++)this.elements[n]=t[n+e];return this}toArray(t=[],e=0){const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}}const PAt=new tAt,LAt=new kAt,RAt=new tAt(0,0,0),IAt=new tAt(1,1,1),NAt=new tAt,DAt=new tAt,FAt=new tAt,jAt=new kAt,BAt=new QEt;class zAt{constructor(t=0,e=0,n=0,r=zAt.DefaultOrder){this.isEuler=!0,this._x=t,this._y=e,this._z=n,this._order=r}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,e,n,r=this._order){return this._x=t,this._y=e,this._z=n,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,e=this._order,n=!0){const r=t.elements,i=r[0],o=r[4],a=r[8],s=r[1],u=r[5],c=r[9],l=r[2],h=r[6],f=r[10];switch(e){case"XYZ":this._y=Math.asin(MEt(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,f),this._z=Math.atan2(-o,i)):(this._x=Math.atan2(h,u),this._z=0);break;case"YXZ":this._x=Math.asin(-MEt(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(a,f),this._z=Math.atan2(s,u)):(this._y=Math.atan2(-l,i),this._z=0);break;case"ZXY":this._x=Math.asin(MEt(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-l,f),this._z=Math.atan2(-o,u)):(this._y=0,this._z=Math.atan2(s,i));break;case"ZYX":this._y=Math.asin(-MEt(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(h,f),this._z=Math.atan2(s,i)):(this._x=0,this._z=Math.atan2(-o,u));break;case"YZX":this._z=Math.asin(MEt(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-c,u),this._y=Math.atan2(-l,i)):(this._x=0,this._y=Math.atan2(a,f));break;case"XZY":this._z=Math.asin(-MEt(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(h,u),this._y=Math.atan2(a,i)):(this._x=Math.atan2(-c,f),this._y=0)}return this._order=e,!0===n&&this._onChangeCallback(),this}setFromQuaternion(t,e,n){return jAt.makeRotationFromQuaternion(t),this.setFromRotationMatrix(jAt,e,n)}setFromVector3(t,e=this._order){return this.set(t.x,t.y,t.z,e)}reorder(t){return BAt.setFromEuler(this),this.setFromQuaternion(BAt,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}toVector3(){}}zAt.DefaultOrder="XYZ",zAt.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class UAt{constructor(){this.mask=1}set(t){this.mask=(1<<t|0)>>>0}enable(t){this.mask|=1<<t|0}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t|0}disable(t){this.mask&=~(1<<t|0)}disableAll(){this.mask=0}test(t){return 0!=(this.mask&t.mask)}isEnabled(t){return 0!=(this.mask&(1<<t|0))}}let VAt=0;const GAt=new tAt,WAt=new QEt,HAt=new kAt,YAt=new tAt,XAt=new tAt,qAt=new tAt,ZAt=new QEt,$At=new tAt(1,0,0),KAt=new tAt(0,1,0),JAt=new tAt(0,0,1),QAt={type:"added"},tTt={type:"removed"};class eTt extends yEt{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:VAt++}),this.uuid=SEt(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=eTt.DefaultUp.clone();const t=new tAt,e=new zAt,n=new QEt,r=new tAt(1,1,1);e._onChange((function(){n.setFromEuler(e,!1)})),n._onChange((function(){e.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new kAt},normalMatrix:{value:new LEt}}),this.matrix=new kAt,this.matrixWorld=new kAt,this.matrixAutoUpdate=eTt.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=eTt.DefaultMatrixWorldAutoUpdate,this.layers=new UAt,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,e){this.quaternion.setFromAxisAngle(t,e)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,e){return WAt.setFromAxisAngle(t,e),this.quaternion.multiply(WAt),this}rotateOnWorldAxis(t,e){return WAt.setFromAxisAngle(t,e),this.quaternion.premultiply(WAt),this}rotateX(t){return this.rotateOnAxis($At,t)}rotateY(t){return this.rotateOnAxis(KAt,t)}rotateZ(t){return this.rotateOnAxis(JAt,t)}translateOnAxis(t,e){return GAt.copy(t).applyQuaternion(this.quaternion),this.position.add(GAt.multiplyScalar(e)),this}translateX(t){return this.translateOnAxis($At,t)}translateY(t){return this.translateOnAxis(KAt,t)}translateZ(t){return this.translateOnAxis(JAt,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(HAt.copy(this.matrixWorld).invert())}lookAt(t,e,n){t.isVector3?YAt.copy(t):YAt.set(t,e,n);const r=this.parent;this.updateWorldMatrix(!0,!1),XAt.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?HAt.lookAt(XAt,YAt,this.up):HAt.lookAt(YAt,XAt,this.up),this.quaternion.setFromRotationMatrix(HAt),r&&(HAt.extractRotation(r.matrixWorld),WAt.setFromRotationMatrix(HAt),this.quaternion.premultiply(WAt.invert()))}add(t){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return t===this||t&&t.isObject3D&&(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(QAt)),this}remove(t){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}const e=this.children.indexOf(t);return-1!==e&&(t.parent=null,this.children.splice(e,1),t.dispatchEvent(tTt)),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){for(let t=0;t<this.children.length;t++){const e=this.children[t];e.parent=null,e.dispatchEvent(tTt)}return this.children.length=0,this}attach(t){return this.updateWorldMatrix(!0,!1),HAt.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),HAt.multiply(t.parent.matrixWorld)),t.applyMatrix4(HAt),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,e){if(this[t]===e)return this;for(let n=0,r=this.children.length;n<r;n++){const r=this.children[n].getObjectByProperty(t,e);if(void 0!==r)return r}}getObjectsByProperty(t,e){let n=[];this[t]===e&&n.push(this);for(let r=0,i=this.children.length;r<i;r++){const i=this.children[r].getObjectsByProperty(t,e);i.length>0&&(n=n.concat(i))}return n}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(XAt,t,qAt),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(XAt,ZAt,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()}raycast(){}traverse(t){t(this);const e=this.children;for(let n=0,r=e.length;n<r;n++)e[n].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const e=this.children;for(let n=0,r=e.length;n<r;n++)e[n].traverseVisible(t)}traverseAncestors(t){const e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const e=this.children;for(let n=0,r=e.length;n<r;n++){const r=e[n];!0!==r.matrixWorldAutoUpdate&&!0!==t||r.updateMatrixWorld(t)}}updateWorldMatrix(t,e){const n=this.parent;if(!0===t&&null!==n&&!0===n.matrixWorldAutoUpdate&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===e){const t=this.children;for(let e=0,n=t.length;e<n;e++){const n=t[e];!0===n.matrixWorldAutoUpdate&&n.updateWorldMatrix(!1,!0)}}}toJSON(t){const e=void 0===t||"string"==typeof t,n={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const r={};function i(e,n){return void 0===e[n.uuid]&&(e[n.uuid]=n.toJSON(t)),n.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(r.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(r.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=i(t.geometries,this.geometry);const e=this.geometry.parameters;if(void 0!==e&&void 0!==e.shapes){const n=e.shapes;if(Array.isArray(n))for(let e=0,r=n.length;e<r;e++){const r=n[e];i(t.shapes,r)}else i(t.shapes,n)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(i(t.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const e=[];for(let n=0,r=this.material.length;n<r;n++)e.push(i(t.materials,this.material[n]));r.material=e}else r.material=i(t.materials,this.material);if(this.children.length>0){r.children=[];for(let e=0;e<this.children.length;e++)r.children.push(this.children[e].toJSON(t).object)}if(this.animations.length>0){r.animations=[];for(let e=0;e<this.animations.length;e++){const n=this.animations[e];r.animations.push(i(t.animations,n))}}if(e){const e=o(t.geometries),r=o(t.materials),i=o(t.textures),a=o(t.images),s=o(t.shapes),u=o(t.skeletons),c=o(t.animations),l=o(t.nodes);e.length>0&&(n.geometries=e),r.length>0&&(n.materials=r),i.length>0&&(n.textures=i),a.length>0&&(n.images=a),s.length>0&&(n.shapes=s),u.length>0&&(n.skeletons=u),c.length>0&&(n.animations=c),l.length>0&&(n.nodes=l)}return n.object=r,n;function o(t){const e=[];for(const n in t){const r=t[n];delete r.metadata,e.push(r)}return e}}clone(t){return(new this.constructor).copy(this,t)}copy(t,e=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(let n=0;n<t.children.length;n++){const e=t.children[n];this.add(e.clone())}return this}}eTt.DefaultUp=new tAt(0,1,0),eTt.DefaultMatrixAutoUpdate=!0,eTt.DefaultMatrixWorldAutoUpdate=!0;const nTt=new tAt,rTt=new tAt,iTt=new tAt,oTt=new tAt,aTt=new tAt,sTt=new tAt,uTt=new tAt,cTt=new tAt,lTt=new tAt,hTt=new tAt;class fTt{constructor(t=new tAt,e=new tAt,n=new tAt){this.a=t,this.b=e,this.c=n}static getNormal(t,e,n,r){r.subVectors(n,e),nTt.subVectors(t,e),r.cross(nTt);const i=r.lengthSq();return i>0?r.multiplyScalar(1/Math.sqrt(i)):r.set(0,0,0)}static getBarycoord(t,e,n,r,i){nTt.subVectors(r,e),rTt.subVectors(n,e),iTt.subVectors(t,e);const o=nTt.dot(nTt),a=nTt.dot(rTt),s=nTt.dot(iTt),u=rTt.dot(rTt),c=rTt.dot(iTt),l=o*u-a*a;if(0===l)return i.set(-2,-1,-1);const h=1/l,f=(u*s-a*c)*h,p=(o*c-a*s)*h;return i.set(1-f-p,p,f)}static containsPoint(t,e,n,r){return this.getBarycoord(t,e,n,r,oTt),oTt.x>=0&&oTt.y>=0&&oTt.x+oTt.y<=1}static getUV(t,e,n,r,i,o,a,s){return this.getBarycoord(t,e,n,r,oTt),s.set(0,0),s.addScaledVector(i,oTt.x),s.addScaledVector(o,oTt.y),s.addScaledVector(a,oTt.z),s}static isFrontFacing(t,e,n,r){return nTt.subVectors(n,e),rTt.subVectors(t,e),nTt.cross(rTt).dot(r)<0}set(t,e,n){return this.a.copy(t),this.b.copy(e),this.c.copy(n),this}setFromPointsAndIndices(t,e,n,r){return this.a.copy(t[e]),this.b.copy(t[n]),this.c.copy(t[r]),this}setFromAttributeAndIndices(t,e,n,r){return this.a.fromBufferAttribute(t,e),this.b.fromBufferAttribute(t,n),this.c.fromBufferAttribute(t,r),this}clone(){return(new this.constructor).copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return nTt.subVectors(this.c,this.b),rTt.subVectors(this.a,this.b),.5*nTt.cross(rTt).length()}getMidpoint(t){return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return fTt.getNormal(this.a,this.b,this.c,t)}getPlane(t){return t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,e){return fTt.getBarycoord(t,this.a,this.b,this.c,e)}getUV(t,e,n,r,i){return fTt.getUV(t,this.a,this.b,this.c,e,n,r,i)}containsPoint(t){return fTt.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return fTt.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,e){const n=this.a,r=this.b,i=this.c;let o,a;aTt.subVectors(r,n),sTt.subVectors(i,n),cTt.subVectors(t,n);const s=aTt.dot(cTt),u=sTt.dot(cTt);if(s<=0&&u<=0)return e.copy(n);lTt.subVectors(t,r);const c=aTt.dot(lTt),l=sTt.dot(lTt);if(c>=0&&l<=c)return e.copy(r);const h=s*l-c*u;if(h<=0&&s>=0&&c<=0)return o=s/(s-c),e.copy(n).addScaledVector(aTt,o);hTt.subVectors(t,i);const f=aTt.dot(hTt),p=sTt.dot(hTt);if(p>=0&&f<=p)return e.copy(i);const d=f*u-s*p;if(d<=0&&u>=0&&p<=0)return a=u/(u-p),e.copy(n).addScaledVector(sTt,a);const m=c*p-f*l;if(m<=0&&l-c>=0&&f-p>=0)return uTt.subVectors(i,r),a=(l-c)/(l-c+(f-p)),e.copy(r).addScaledVector(uTt,a);const v=1/(m+d+h);return o=d*v,a=h*v,e.copy(n).addScaledVector(aTt,o).addScaledVector(sTt,a)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}let pTt=0;class dTt extends yEt{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:pTt++}),this.uuid=SEt(),this.name="",this.type="Material",this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=vEt,this.stencilZFail=vEt,this.stencilZPass=vEt,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(t){this._alphaTest>0!=t>0&&this.version++,this._alphaTest=t}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(void 0!==t)for(const e in t){const n=t[e];if(void 0===n)continue;const r=this[e];void 0!==r&&(r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[e]=n)}}toJSON(t){const e=void 0===t||"string"==typeof t;e&&(t={textures:{},images:{}});const n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(t){const e=[];for(const n in t){const r=t[n];delete r.metadata,e.push(r)}return e}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(n.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(n.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(t).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(t).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(t).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(t).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(t).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(t).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(t).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(t).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(t).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(t).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(t).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(t).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(n.blending=this.blending),0!==this.side&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(n.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=this.flatShading),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),!1===this.fog&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData),e){const e=r(t.textures),i=r(t.images);e.length>0&&(n.textures=e),i.length>0&&(n.images=i)}return n}clone(){return(new this.constructor).copy(this)}copy(t){this.name=t.name,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;const e=t.clippingPlanes;let n=null;if(null!==e){const t=e.length;n=new Array(t);for(let r=0;r!==t;++r)n[r]=e[r].clone()}return this.clippingPlanes=n,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){!0===t&&this.version++}}class mTt extends dTt{constructor(t){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new HEt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.fog=t.fog,this}}const vTt=new tAt,gTt=new PEt;class yTt{constructor(t,e,n=!1){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=n,this.usage=gEt,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(t){!0===t&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this}copyAt(t,e,n){t*=this.itemSize,n*=e.itemSize;for(let r=0,i=this.itemSize;r<i;r++)this.array[t+r]=e.array[n+r];return this}copyArray(t){return this.array.set(t),this}applyMatrix3(t){if(2===this.itemSize)for(let e=0,n=this.count;e<n;e++)gTt.fromBufferAttribute(this,e),gTt.applyMatrix3(t),this.setXY(e,gTt.x,gTt.y);else if(3===this.itemSize)for(let e=0,n=this.count;e<n;e++)vTt.fromBufferAttribute(this,e),vTt.applyMatrix3(t),this.setXYZ(e,vTt.x,vTt.y,vTt.z);return this}applyMatrix4(t){for(let e=0,n=this.count;e<n;e++)vTt.fromBufferAttribute(this,e),vTt.applyMatrix4(t),this.setXYZ(e,vTt.x,vTt.y,vTt.z);return this}applyNormalMatrix(t){for(let e=0,n=this.count;e<n;e++)vTt.fromBufferAttribute(this,e),vTt.applyNormalMatrix(t),this.setXYZ(e,vTt.x,vTt.y,vTt.z);return this}transformDirection(t){for(let e=0,n=this.count;e<n;e++)vTt.fromBufferAttribute(this,e),vTt.transformDirection(t),this.setXYZ(e,vTt.x,vTt.y,vTt.z);return this}set(t,e=0){return this.array.set(t,e),this}getX(t){let e=this.array[t*this.itemSize];return this.normalized&&(e=CEt(e,this.array)),e}setX(t,e){return this.normalized&&(e=OEt(e,this.array)),this.array[t*this.itemSize]=e,this}getY(t){let e=this.array[t*this.itemSize+1];return this.normalized&&(e=CEt(e,this.array)),e}setY(t,e){return this.normalized&&(e=OEt(e,this.array)),this.array[t*this.itemSize+1]=e,this}getZ(t){let e=this.array[t*this.itemSize+2];return this.normalized&&(e=CEt(e,this.array)),e}setZ(t,e){return this.normalized&&(e=OEt(e,this.array)),this.array[t*this.itemSize+2]=e,this}getW(t){let e=this.array[t*this.itemSize+3];return this.normalized&&(e=CEt(e,this.array)),e}setW(t,e){return this.normalized&&(e=OEt(e,this.array)),this.array[t*this.itemSize+3]=e,this}setXY(t,e,n){return t*=this.itemSize,this.normalized&&(e=OEt(e,this.array),n=OEt(n,this.array)),this.array[t+0]=e,this.array[t+1]=n,this}setXYZ(t,e,n,r){return t*=this.itemSize,this.normalized&&(e=OEt(e,this.array),n=OEt(n,this.array),r=OEt(r,this.array)),this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=r,this}setXYZW(t,e,n,r,i){return t*=this.itemSize,this.normalized&&(e=OEt(e,this.array),n=OEt(n,this.array),r=OEt(r,this.array),i=OEt(i,this.array)),this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=r,this.array[t+3]=i,this}onUpload(t){return this.onUploadCallback=t,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const t={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(t.name=this.name),this.usage!==gEt&&(t.usage=this.usage),0===this.updateRange.offset&&-1===this.updateRange.count||(t.updateRange=this.updateRange),t}copyColorsArray(){}copyVector2sArray(){}copyVector3sArray(){}copyVector4sArray(){}}class xTt extends yTt{constructor(t,e,n){super(new Uint16Array(t),e,n)}}class bTt extends yTt{constructor(t,e,n){super(new Uint32Array(t),e,n)}}class _Tt extends yTt{constructor(t,e,n){super(new Float32Array(t),e,n)}}let wTt=0;const STt=new kAt,MTt=new eTt,ETt=new tAt,ATt=new rAt,TTt=new rAt,CTt=new tAt;class OTt extends yEt{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:wTt++}),this.uuid=SEt(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(t){return Array.isArray(t)?this.index=new(function(t){for(let e=t.length-1;e>=0;--e)if(t[e]>=65535)return!0;return!1}(t)?bTt:xTt)(t,1):this.index=t,this}getAttribute(t){return this.attributes[t]}setAttribute(t,e){return this.attributes[t]=e,this}deleteAttribute(t){return delete this.attributes[t],this}hasAttribute(t){return void 0!==this.attributes[t]}addGroup(t,e,n=0){this.groups.push({start:t,count:e,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(t,e){this.drawRange.start=t,this.drawRange.count=e}applyMatrix4(t){const e=this.attributes.position;void 0!==e&&(e.applyMatrix4(t),e.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const e=(new LEt).getNormalMatrix(t);n.applyNormalMatrix(e),n.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(t),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(t){return STt.makeRotationFromQuaternion(t),this.applyMatrix4(STt),this}rotateX(t){return STt.makeRotationX(t),this.applyMatrix4(STt),this}rotateY(t){return STt.makeRotationY(t),this.applyMatrix4(STt),this}rotateZ(t){return STt.makeRotationZ(t),this.applyMatrix4(STt),this}translate(t,e,n){return STt.makeTranslation(t,e,n),this.applyMatrix4(STt),this}scale(t,e,n){return STt.makeScale(t,e,n),this.applyMatrix4(STt),this}lookAt(t){return MTt.lookAt(t),MTt.updateMatrix(),this.applyMatrix4(MTt.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(ETt).negate(),this.translate(ETt.x,ETt.y,ETt.z),this}setFromPoints(t){const e=[];for(let n=0,r=t.length;n<r;n++){const r=t[n];e.push(r.x,r.y,r.z||0)}return this.setAttribute("position",new _Tt(e,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new rAt);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)this.boundingBox.set(new tAt(-1/0,-1/0,-1/0),new tAt(1/0,1/0,1/0));else{if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),e)for(let t=0,n=e.length;t<n;t++){const n=e[t];ATt.setFromBufferAttribute(n),this.morphTargetsRelative?(CTt.addVectors(this.boundingBox.min,ATt.min),this.boundingBox.expandByPoint(CTt),CTt.addVectors(this.boundingBox.max,ATt.max),this.boundingBox.expandByPoint(CTt)):(this.boundingBox.expandByPoint(ATt.min),this.boundingBox.expandByPoint(ATt.max))}}else this.boundingBox.makeEmpty();isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z)}}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new _At);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)this.boundingSphere.set(new tAt,1/0);else if(t){const n=this.boundingSphere.center;if(ATt.setFromBufferAttribute(t),e)for(let t=0,i=e.length;t<i;t++){const n=e[t];TTt.setFromBufferAttribute(n),this.morphTargetsRelative?(CTt.addVectors(ATt.min,TTt.min),ATt.expandByPoint(CTt),CTt.addVectors(ATt.max,TTt.max),ATt.expandByPoint(CTt)):(ATt.expandByPoint(TTt.min),ATt.expandByPoint(TTt.max))}ATt.getCenter(n);let r=0;for(let e=0,i=t.count;e<i;e++)CTt.fromBufferAttribute(t,e),r=Math.max(r,n.distanceToSquared(CTt));if(e)for(let i=0,o=e.length;i<o;i++){const o=e[i],a=this.morphTargetsRelative;for(let e=0,i=o.count;e<i;e++)CTt.fromBufferAttribute(o,e),a&&(ETt.fromBufferAttribute(t,e),CTt.add(ETt)),r=Math.max(r,n.distanceToSquared(CTt))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)}}computeTangents(){const t=this.index,e=this.attributes;if(null===t||void 0===e.position||void 0===e.normal||void 0===e.uv)return;const n=t.array,r=e.position.array,i=e.normal.array,o=e.uv.array,a=r.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new yTt(new Float32Array(4*a),4));const s=this.getAttribute("tangent").array,u=[],c=[];for(let E=0;E<a;E++)u[E]=new tAt,c[E]=new tAt;const l=new tAt,h=new tAt,f=new tAt,p=new PEt,d=new PEt,m=new PEt,v=new tAt,g=new tAt;function y(t,e,n){l.fromArray(r,3*t),h.fromArray(r,3*e),f.fromArray(r,3*n),p.fromArray(o,2*t),d.fromArray(o,2*e),m.fromArray(o,2*n),h.sub(l),f.sub(l),d.sub(p),m.sub(p);const i=1/(d.x*m.y-m.x*d.y);isFinite(i)&&(v.copy(h).multiplyScalar(m.y).addScaledVector(f,-d.y).multiplyScalar(i),g.copy(f).multiplyScalar(d.x).addScaledVector(h,-m.x).multiplyScalar(i),u[t].add(v),u[e].add(v),u[n].add(v),c[t].add(g),c[e].add(g),c[n].add(g))}let x=this.groups;0===x.length&&(x=[{start:0,count:n.length}]);for(let E=0,A=x.length;E<A;++E){const t=x[E],e=t.start;for(let r=e,i=e+t.count;r<i;r+=3)y(n[r+0],n[r+1],n[r+2])}const b=new tAt,_=new tAt,w=new tAt,S=new tAt;function M(t){w.fromArray(i,3*t),S.copy(w);const e=u[t];b.copy(e),b.sub(w.multiplyScalar(w.dot(e))).normalize(),_.crossVectors(S,e);const n=_.dot(c[t])<0?-1:1;s[4*t]=b.x,s[4*t+1]=b.y,s[4*t+2]=b.z,s[4*t+3]=n}for(let E=0,A=x.length;E<A;++E){const t=x[E],e=t.start;for(let r=e,i=e+t.count;r<i;r+=3)M(n[r+0]),M(n[r+1]),M(n[r+2])}}computeVertexNormals(){const t=this.index,e=this.getAttribute("position");if(void 0!==e){let n=this.getAttribute("normal");if(void 0===n)n=new yTt(new Float32Array(3*e.count),3),this.setAttribute("normal",n);else for(let t=0,e=n.count;t<e;t++)n.setXYZ(t,0,0,0);const r=new tAt,i=new tAt,o=new tAt,a=new tAt,s=new tAt,u=new tAt,c=new tAt,l=new tAt;if(t)for(let h=0,f=t.count;h<f;h+=3){const f=t.getX(h+0),p=t.getX(h+1),d=t.getX(h+2);r.fromBufferAttribute(e,f),i.fromBufferAttribute(e,p),o.fromBufferAttribute(e,d),c.subVectors(o,i),l.subVectors(r,i),c.cross(l),a.fromBufferAttribute(n,f),s.fromBufferAttribute(n,p),u.fromBufferAttribute(n,d),a.add(c),s.add(c),u.add(c),n.setXYZ(f,a.x,a.y,a.z),n.setXYZ(p,s.x,s.y,s.z),n.setXYZ(d,u.x,u.y,u.z)}else for(let t=0,h=e.count;t<h;t+=3)r.fromBufferAttribute(e,t+0),i.fromBufferAttribute(e,t+1),o.fromBufferAttribute(e,t+2),c.subVectors(o,i),l.subVectors(r,i),c.cross(l),n.setXYZ(t+0,c.x,c.y,c.z),n.setXYZ(t+1,c.x,c.y,c.z),n.setXYZ(t+2,c.x,c.y,c.z);this.normalizeNormals(),n.needsUpdate=!0}}merge(){return this}normalizeNormals(){const t=this.attributes.normal;for(let e=0,n=t.count;e<n;e++)CTt.fromBufferAttribute(t,e),CTt.normalize(),t.setXYZ(e,CTt.x,CTt.y,CTt.z)}toNonIndexed(){function t(t,e){const n=t.array,r=t.itemSize,i=t.normalized,o=new n.constructor(e.length*r);let a=0,s=0;for(let u=0,c=e.length;u<c;u++){a=t.isInterleavedBufferAttribute?e[u]*t.data.stride+t.offset:e[u]*r;for(let t=0;t<r;t++)o[s++]=n[a++]}return new yTt(o,r,i)}if(null===this.index)return this;const e=new OTt,n=this.index.array,r=this.attributes;for(const a in r){const i=t(r[a],n);e.setAttribute(a,i)}const i=this.morphAttributes;for(const a in i){const r=[],o=i[a];for(let e=0,i=o.length;e<i;e++){const i=t(o[e],n);r.push(i)}e.morphAttributes[a]=r}e.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,s=o.length;a<s;a++){const t=o[a];e.addGroup(t.start,t.count,t.materialIndex)}return e}toJSON(){const t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),void 0!==this.parameters){const e=this.parameters;for(const n in e)void 0!==e[n]&&(t[n]=e[n]);return t}t.data={attributes:{}};const e=this.index;null!==e&&(t.data.index={type:e.array.constructor.name,array:Array.prototype.slice.call(e.array)});const n=this.attributes;for(const s in n){const e=n[s];t.data.attributes[s]=e.toJSON(t.data)}const r={};let i=!1;for(const s in this.morphAttributes){const e=this.morphAttributes[s],n=[];for(let r=0,i=e.length;r<i;r++){const i=e[r];n.push(i.toJSON(t.data))}n.length>0&&(r[s]=n,i=!0)}i&&(t.data.morphAttributes=r,t.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(t.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return null!==a&&(t.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),t}clone(){return(new this.constructor).copy(this)}copy(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const e={};this.name=t.name;const n=t.index;null!==n&&this.setIndex(n.clone(e));const r=t.attributes;for(const u in r){const t=r[u];this.setAttribute(u,t.clone(e))}const i=t.morphAttributes;for(const u in i){const t=[],n=i[u];for(let r=0,i=n.length;r<i;r++)t.push(n[r].clone(e));this.morphAttributes[u]=t}this.morphTargetsRelative=t.morphTargetsRelative;const o=t.groups;for(let u=0,c=o.length;u<c;u++){const t=o[u];this.addGroup(t.start,t.count,t.materialIndex)}const a=t.boundingBox;null!==a&&(this.boundingBox=a.clone());const s=t.boundingSphere;return null!==s&&(this.boundingSphere=s.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,void 0!==t.parameters&&(this.parameters=Object.assign({},t.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}const kTt=new kAt,PTt=new OAt,LTt=new _At,RTt=new tAt,ITt=new tAt,NTt=new tAt,DTt=new tAt,FTt=new tAt,jTt=new PEt,BTt=new PEt,zTt=new PEt,UTt=new tAt,VTt=new tAt;class GTt extends eTt{constructor(t=new OTt,e=new mTt){super(),this.isMesh=!0,this.type="Mesh",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t,e){return super.copy(t,e),void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=t.material,this.geometry=t.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,e=Object.keys(t);if(e.length>0){const n=t[e[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,e=n.length;t<e;t++){const e=n[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[e]=t}}}}getVertexPosition(t,e){const n=this.geometry,r=n.attributes.position,i=n.morphAttributes.position,o=n.morphTargetsRelative;e.fromBufferAttribute(r,t);const a=this.morphTargetInfluences;if(i&&a){FTt.set(0,0,0);for(let n=0,r=i.length;n<r;n++){const r=a[n],s=i[n];0!==r&&(DTt.fromBufferAttribute(s,t),o?FTt.addScaledVector(DTt,r):FTt.addScaledVector(DTt.sub(e),r))}e.add(FTt)}return this.isSkinnedMesh&&this.boneTransform(t,e),e}raycast(t,e){const n=this.geometry,r=this.material,i=this.matrixWorld;if(void 0===r)return;if(null===n.boundingSphere&&n.computeBoundingSphere(),LTt.copy(n.boundingSphere),LTt.applyMatrix4(i),!1===t.ray.intersectsSphere(LTt))return;if(kTt.copy(i).invert(),PTt.copy(t.ray).applyMatrix4(kTt),null!==n.boundingBox&&!1===PTt.intersectsBox(n.boundingBox))return;let o;const a=n.index,s=n.attributes.position,u=n.attributes.uv,c=n.attributes.uv2,l=n.groups,h=n.drawRange;if(null!==a)if(Array.isArray(r))for(let f=0,p=l.length;f<p;f++){const n=l[f],i=r[n.materialIndex];for(let r=Math.max(n.start,h.start),s=Math.min(a.count,Math.min(n.start+n.count,h.start+h.count));r<s;r+=3){const s=a.getX(r),l=a.getX(r+1),h=a.getX(r+2);o=WTt(this,i,t,PTt,u,c,s,l,h),o&&(o.faceIndex=Math.floor(r/3),o.face.materialIndex=n.materialIndex,e.push(o))}}else{for(let n=Math.max(0,h.start),i=Math.min(a.count,h.start+h.count);n<i;n+=3){const i=a.getX(n),s=a.getX(n+1),l=a.getX(n+2);o=WTt(this,r,t,PTt,u,c,i,s,l),o&&(o.faceIndex=Math.floor(n/3),e.push(o))}}else if(void 0!==s)if(Array.isArray(r))for(let f=0,p=l.length;f<p;f++){const n=l[f],i=r[n.materialIndex];for(let r=Math.max(n.start,h.start),a=Math.min(s.count,Math.min(n.start+n.count,h.start+h.count));r<a;r+=3){o=WTt(this,i,t,PTt,u,c,r,r+1,r+2),o&&(o.faceIndex=Math.floor(r/3),o.face.materialIndex=n.materialIndex,e.push(o))}}else{for(let n=Math.max(0,h.start),i=Math.min(s.count,h.start+h.count);n<i;n+=3){o=WTt(this,r,t,PTt,u,c,n,n+1,n+2),o&&(o.faceIndex=Math.floor(n/3),e.push(o))}}}}function WTt(t,e,n,r,i,o,a,s,u){t.getVertexPosition(a,RTt),t.getVertexPosition(s,ITt),t.getVertexPosition(u,NTt);const c=function(t,e,n,r,i,o,a,s){let u;if(u=1===e.side?r.intersectTriangle(a,o,i,!0,s):r.intersectTriangle(i,o,a,0===e.side,s),null===u)return null;VTt.copy(s),VTt.applyMatrix4(t.matrixWorld);const c=n.ray.origin.distanceTo(VTt);return c<n.near||c>n.far?null:{distance:c,point:VTt.clone(),object:t}}(t,e,n,r,RTt,ITt,NTt,UTt);if(c){i&&(jTt.fromBufferAttribute(i,a),BTt.fromBufferAttribute(i,s),zTt.fromBufferAttribute(i,u),c.uv=fTt.getUV(UTt,RTt,ITt,NTt,jTt,BTt,zTt,new PEt)),o&&(jTt.fromBufferAttribute(o,a),BTt.fromBufferAttribute(o,s),zTt.fromBufferAttribute(o,u),c.uv2=fTt.getUV(UTt,RTt,ITt,NTt,jTt,BTt,zTt,new PEt));const t={a:a,b:s,c:u,normal:new tAt,materialIndex:0};fTt.getNormal(RTt,ITt,NTt,t.normal),c.face=t}return c}class HTt extends eTt{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new kAt,this.projectionMatrix=new kAt,this.projectionMatrixInverse=new kAt}copy(t,e){return super.copy(t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(-e[8],-e[9],-e[10]).normalize()}updateMatrixWorld(t){super.updateMatrixWorld(t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(t,e){super.updateWorldMatrix(t,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}class YTt extends HTt{constructor(t=50,e=1,n=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=t,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=e,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this}setFocalLength(t){const e=.5*this.getFilmHeight()/t;this.fov=2*wEt*Math.atan(e),this.updateProjectionMatrix()}getFocalLength(){const t=Math.tan(.5*_Et*this.fov);return.5*this.getFilmHeight()/t}getEffectiveFOV(){return 2*wEt*Math.atan(Math.tan(.5*_Et*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(t,e,n,r,i,o){this.aspect=t/e,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=this.near;let e=t*Math.tan(.5*_Et*this.fov)/this.zoom,n=2*e,r=this.aspect*n,i=-.5*r;const o=this.view;if(null!==this.view&&this.view.enabled){const t=o.fullWidth,a=o.fullHeight;i+=o.offsetX*r/t,e-=o.offsetY*n/a,r*=o.width/t,n*=o.height/a}const a=this.filmOffset;0!==a&&(i+=t*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,e,e-n,t,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const e=super.toJSON(t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}}const XTt=new tAt,qTt=new tAt,ZTt=new LEt;class $Tt{constructor(t=new tAt(1,0,0),e=0){this.isPlane=!0,this.normal=t,this.constant=e}set(t,e){return this.normal.copy(t),this.constant=e,this}setComponents(t,e,n,r){return this.normal.set(t,e,n),this.constant=r,this}setFromNormalAndCoplanarPoint(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this}setFromCoplanarPoints(t,e,n){const r=XTt.subVectors(n,e).cross(qTt.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(r,t),this}copy(t){return this.normal.copy(t.normal),this.constant=t.constant,this}normalize(){const t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(t){return this.normal.dot(t)+this.constant}distanceToSphere(t){return this.distanceToPoint(t.center)-t.radius}projectPoint(t,e){return e.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)}intersectLine(t,e){const n=t.delta(XTt),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(t.start)?e.copy(t.start):null;const i=-(t.start.dot(this.normal)+this.constant)/r;return i<0||i>1?null:e.copy(n).multiplyScalar(i).add(t.start)}intersectsLine(t){const e=this.distanceToPoint(t.start),n=this.distanceToPoint(t.end);return e<0&&n>0||n<0&&e>0}intersectsBox(t){return t.intersectsPlane(this)}intersectsSphere(t){return t.intersectsPlane(this)}coplanarPoint(t){return t.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(t,e){const n=e||ZTt.getNormalMatrix(t),r=this.coplanarPoint(XTt).applyMatrix4(t),i=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(i),this}translate(t){return this.constant-=t.dot(this.normal),this}equals(t){return t.normal.equals(this.normal)&&t.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const KTt=new _At,JTt=new tAt;class QTt{constructor(t=new $Tt,e=new $Tt,n=new $Tt,r=new $Tt,i=new $Tt,o=new $Tt){this.planes=[t,e,n,r,i,o]}set(t,e,n,r,i,o){const a=this.planes;return a[0].copy(t),a[1].copy(e),a[2].copy(n),a[3].copy(r),a[4].copy(i),a[5].copy(o),this}copy(t){const e=this.planes;for(let n=0;n<6;n++)e[n].copy(t.planes[n]);return this}setFromProjectionMatrix(t){const e=this.planes,n=t.elements,r=n[0],i=n[1],o=n[2],a=n[3],s=n[4],u=n[5],c=n[6],l=n[7],h=n[8],f=n[9],p=n[10],d=n[11],m=n[12],v=n[13],g=n[14],y=n[15];return e[0].setComponents(a-r,l-s,d-h,y-m).normalize(),e[1].setComponents(a+r,l+s,d+h,y+m).normalize(),e[2].setComponents(a+i,l+u,d+f,y+v).normalize(),e[3].setComponents(a-i,l-u,d-f,y-v).normalize(),e[4].setComponents(a-o,l-c,d-p,y-g).normalize(),e[5].setComponents(a+o,l+c,d+p,y+g).normalize(),this}intersectsObject(t){const e=t.geometry;return null===e.boundingSphere&&e.computeBoundingSphere(),KTt.copy(e.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(KTt)}intersectsSprite(t){return KTt.center.set(0,0,0),KTt.radius=.7071067811865476,KTt.applyMatrix4(t.matrixWorld),this.intersectsSphere(KTt)}intersectsSphere(t){const e=this.planes,n=t.center,r=-t.radius;for(let i=0;i<6;i++){if(e[i].distanceToPoint(n)<r)return!1}return!0}intersectsBox(t){const e=this.planes;for(let n=0;n<6;n++){const r=e[n];if(JTt.x=r.normal.x>0?t.max.x:t.min.x,JTt.y=r.normal.y>0?t.max.y:t.min.y,JTt.z=r.normal.z>0?t.max.z:t.min.z,r.distanceToPoint(JTt)<0)return!1}return!0}containsPoint(t){const e=this.planes;for(let n=0;n<6;n++)if(e[n].distanceToPoint(t)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}class tCt extends HTt{constructor(t=-1,e=1,n=1,r=-1,i=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=e,this.top=n,this.bottom=r,this.near=i,this.far=o,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this}setViewOffset(t,e,n,r,i,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let i=n-t,o=n+t,a=r+e,s=r-e;if(null!==this.view&&this.view.enabled){const t=(this.right-this.left)/this.view.fullWidth/this.zoom,e=(this.top-this.bottom)/this.view.fullHeight/this.zoom;i+=t*this.view.offsetX,o=i+t*this.view.width,a-=e*this.view.offsetY,s=a-e*this.view.height}this.projectionMatrix.makeOrthographic(i,o,a,s,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const e=super.toJSON(t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=Object.assign({},this.view)),e}}class eCt extends eTt{constructor(){super(),this.isGroup=!0,this.type="Group"}}class nCt{constructor(t,e){this.isInterleavedBuffer=!0,this.array=t,this.stride=e,this.count=void 0!==t?t.length/e:0,this.usage=gEt,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=SEt()}onUploadCallback(){}set needsUpdate(t){!0===t&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this}copyAt(t,e,n){t*=this.stride,n*=e.stride;for(let r=0,i=this.stride;r<i;r++)this.array[t+r]=e.array[n+r];return this}set(t,e=0){return this.array.set(t,e),this}clone(t){void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=SEt()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const e=new this.array.constructor(t.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(e,this.stride);return n.setUsage(this.usage),n}onUpload(t){return this.onUploadCallback=t,this}toJSON(t){return void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=SEt()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const rCt=new tAt;class iCt{constructor(t,e,n,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=t,this.itemSize=e,this.offset=n,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(t){this.data.needsUpdate=t}applyMatrix4(t){for(let e=0,n=this.data.count;e<n;e++)rCt.fromBufferAttribute(this,e),rCt.applyMatrix4(t),this.setXYZ(e,rCt.x,rCt.y,rCt.z);return this}applyNormalMatrix(t){for(let e=0,n=this.count;e<n;e++)rCt.fromBufferAttribute(this,e),rCt.applyNormalMatrix(t),this.setXYZ(e,rCt.x,rCt.y,rCt.z);return this}transformDirection(t){for(let e=0,n=this.count;e<n;e++)rCt.fromBufferAttribute(this,e),rCt.transformDirection(t),this.setXYZ(e,rCt.x,rCt.y,rCt.z);return this}setX(t,e){return this.normalized&&(e=OEt(e,this.array)),this.data.array[t*this.data.stride+this.offset]=e,this}setY(t,e){return this.normalized&&(e=OEt(e,this.array)),this.data.array[t*this.data.stride+this.offset+1]=e,this}setZ(t,e){return this.normalized&&(e=OEt(e,this.array)),this.data.array[t*this.data.stride+this.offset+2]=e,this}setW(t,e){return this.normalized&&(e=OEt(e,this.array)),this.data.array[t*this.data.stride+this.offset+3]=e,this}getX(t){let e=this.data.array[t*this.data.stride+this.offset];return this.normalized&&(e=CEt(e,this.array)),e}getY(t){let e=this.data.array[t*this.data.stride+this.offset+1];return this.normalized&&(e=CEt(e,this.array)),e}getZ(t){let e=this.data.array[t*this.data.stride+this.offset+2];return this.normalized&&(e=CEt(e,this.array)),e}getW(t){let e=this.data.array[t*this.data.stride+this.offset+3];return this.normalized&&(e=CEt(e,this.array)),e}setXY(t,e,n){return t=t*this.data.stride+this.offset,this.normalized&&(e=OEt(e,this.array),n=OEt(n,this.array)),this.data.array[t+0]=e,this.data.array[t+1]=n,this}setXYZ(t,e,n,r){return t=t*this.data.stride+this.offset,this.normalized&&(e=OEt(e,this.array),n=OEt(n,this.array),r=OEt(r,this.array)),this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=r,this}setXYZW(t,e,n,r,i){return t=t*this.data.stride+this.offset,this.normalized&&(e=OEt(e,this.array),n=OEt(n,this.array),r=OEt(r,this.array),i=OEt(i,this.array)),this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=r,this.data.array[t+3]=i,this}clone(t){if(void 0===t){const t=[];for(let e=0;e<this.count;e++){const n=e*this.data.stride+this.offset;for(let e=0;e<this.itemSize;e++)t.push(this.data.array[n+e])}return new yTt(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.clone(t)),new iCt(t.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(t){if(void 0===t){const t=[];for(let e=0;e<this.count;e++){const n=e*this.data.stride+this.offset;for(let e=0;e<this.itemSize;e++)t.push(this.data.array[n+e])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.toJSON(t)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}const oCt=new tAt,aCt=new JEt,sCt=new JEt,uCt=new tAt,cCt=new kAt;class lCt extends GTt{constructor(t,e){super(t,e),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new kAt,this.bindMatrixInverse=new kAt}copy(t,e){return super.copy(t,e),this.bindMode=t.bindMode,this.bindMatrix.copy(t.bindMatrix),this.bindMatrixInverse.copy(t.bindMatrixInverse),this.skeleton=t.skeleton,this}bind(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.copy(e).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const t=new JEt,e=this.geometry.attributes.skinWeight;for(let n=0,r=e.count;n<r;n++){t.fromBufferAttribute(e,n);const r=1/t.manhattanLength();r!==1/0?t.multiplyScalar(r):t.set(1,0,0,0),e.setXYZW(n,t.x,t.y,t.z,t.w)}}updateMatrixWorld(t){super.updateMatrixWorld(t),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode&&this.bindMatrixInverse.copy(this.bindMatrix).invert()}boneTransform(t,e){const n=this.skeleton,r=this.geometry;aCt.fromBufferAttribute(r.attributes.skinIndex,t),sCt.fromBufferAttribute(r.attributes.skinWeight,t),oCt.copy(e).applyMatrix4(this.bindMatrix),e.set(0,0,0);for(let i=0;i<4;i++){const t=sCt.getComponent(i);if(0!==t){const r=aCt.getComponent(i);cCt.multiplyMatrices(n.bones[r].matrixWorld,n.boneInverses[r]),e.addScaledVector(uCt.copy(oCt).applyMatrix4(cCt),t)}}return e.applyMatrix4(this.bindMatrixInverse)}}class hCt extends eTt{constructor(){super(),this.isBone=!0,this.type="Bone"}}class fCt extends KEt{constructor(t=null,e=1,n=1,r,i,o,a,s,u=1003,c=1003,l,h){super(null,o,a,s,u,c,r,i,l,h),this.isDataTexture=!0,this.image={data:t,width:e,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const pCt=new kAt,dCt=new kAt;class mCt{constructor(t=[],e=[]){this.uuid=SEt(),this.bones=t.slice(0),this.boneInverses=e,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const t=this.bones,e=this.boneInverses;if(this.boneMatrices=new Float32Array(16*t.length),0===e.length)this.calculateInverses();else if(t.length!==e.length){this.boneInverses=[];for(let t=0,e=this.bones.length;t<e;t++)this.boneInverses.push(new kAt)}}calculateInverses(){this.boneInverses.length=0;for(let t=0,e=this.bones.length;t<e;t++){const e=new kAt;this.bones[t]&&e.copy(this.bones[t].matrixWorld).invert(),this.boneInverses.push(e)}}pose(){for(let t=0,e=this.bones.length;t<e;t++){const e=this.bones[t];e&&e.matrixWorld.copy(this.boneInverses[t]).invert()}for(let t=0,e=this.bones.length;t<e;t++){const e=this.bones[t];e&&(e.parent&&e.parent.isBone?(e.matrix.copy(e.parent.matrixWorld).invert(),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))}}update(){const t=this.bones,e=this.boneInverses,n=this.boneMatrices,r=this.boneTexture;for(let i=0,o=t.length;i<o;i++){const r=t[i]?t[i].matrixWorld:dCt;pCt.multiplyMatrices(r,e[i]),pCt.toArray(n,16*i)}null!==r&&(r.needsUpdate=!0)}clone(){return new mCt(this.bones,this.boneInverses)}computeBoneTexture(){let t=Math.sqrt(4*this.bones.length);t=TEt(t),t=Math.max(t,4);const e=new Float32Array(t*t*4);e.set(this.boneMatrices);const n=new fCt(e,t,t,1023,1015);return n.needsUpdate=!0,this.boneMatrices=e,this.boneTexture=n,this.boneTextureSize=t,this}getBoneByName(t){for(let e=0,n=this.bones.length;e<n;e++){const n=this.bones[e];if(n.name===t)return n}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(t,e){this.uuid=t.uuid;for(let n=0,r=t.bones.length;n<r;n++){let r=e[t.bones[n]];void 0===r&&(r=new hCt),this.bones.push(r),this.boneInverses.push((new kAt).fromArray(t.boneInverses[n]))}return this.init(),this}toJSON(){const t={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};t.uuid=this.uuid;const e=this.bones,n=this.boneInverses;for(let r=0,i=e.length;r<i;r++){const i=e[r];t.bones.push(i.uuid);const o=n[r];t.boneInverses.push(o.toArray())}return t}}class vCt extends yTt{constructor(t,e,n,r=1){super(t,e,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(t){return super.copy(t),this.meshPerAttribute=t.meshPerAttribute,this}toJSON(){const t=super.toJSON();return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}}const gCt=new kAt,yCt=new kAt,xCt=[],bCt=new kAt,_Ct=new GTt;class wCt extends GTt{constructor(t,e,n){super(t,e),this.isInstancedMesh=!0,this.instanceMatrix=new vCt(new Float32Array(16*n),16),this.instanceColor=null,this.count=n,this.frustumCulled=!1;for(let r=0;r<n;r++)this.setMatrixAt(r,bCt)}copy(t,e){return super.copy(t,e),this.instanceMatrix.copy(t.instanceMatrix),null!==t.instanceColor&&(this.instanceColor=t.instanceColor.clone()),this.count=t.count,this}getColorAt(t,e){e.fromArray(this.instanceColor.array,3*t)}getMatrixAt(t,e){e.fromArray(this.instanceMatrix.array,16*t)}raycast(t,e){const n=this.matrixWorld,r=this.count;if(_Ct.geometry=this.geometry,_Ct.material=this.material,void 0!==_Ct.material)for(let i=0;i<r;i++){this.getMatrixAt(i,gCt),yCt.multiplyMatrices(n,gCt),_Ct.matrixWorld=yCt,_Ct.raycast(t,xCt);for(let t=0,n=xCt.length;t<n;t++){const n=xCt[t];n.instanceId=i,n.object=this,e.push(n)}xCt.length=0}}setColorAt(t,e){null===this.instanceColor&&(this.instanceColor=new vCt(new Float32Array(3*this.instanceMatrix.count),3)),e.toArray(this.instanceColor.array,3*t)}setMatrixAt(t,e){e.toArray(this.instanceMatrix.array,16*t)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class SCt extends dTt{constructor(t){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new HEt(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this.fog=t.fog,this}}const MCt=new tAt,ECt=new tAt,ACt=new kAt,TCt=new OAt,CCt=new _At;class OCt extends eTt{constructor(t=new OTt,e=new SCt){super(),this.isLine=!0,this.type="Line",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t,e){return super.copy(t,e),this.material=t.material,this.geometry=t.geometry,this}computeLineDistances(){const t=this.geometry;if(null===t.index){const e=t.attributes.position,n=[0];for(let t=1,r=e.count;t<r;t++)MCt.fromBufferAttribute(e,t-1),ECt.fromBufferAttribute(e,t),n[t]=n[t-1],n[t]+=MCt.distanceTo(ECt);t.setAttribute("lineDistance",new _Tt(n,1))}return this}raycast(t,e){const n=this.geometry,r=this.matrixWorld,i=t.params.Line.threshold,o=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),CCt.copy(n.boundingSphere),CCt.applyMatrix4(r),CCt.radius+=i,!1===t.ray.intersectsSphere(CCt))return;ACt.copy(r).invert(),TCt.copy(t.ray).applyMatrix4(ACt);const a=i/((this.scale.x+this.scale.y+this.scale.z)/3),s=a*a,u=new tAt,c=new tAt,l=new tAt,h=new tAt,f=this.isLineSegments?2:1,p=n.index,d=n.attributes.position;if(null!==p){for(let n=Math.max(0,o.start),r=Math.min(p.count,o.start+o.count)-1;n<r;n+=f){const r=p.getX(n),i=p.getX(n+1);u.fromBufferAttribute(d,r),c.fromBufferAttribute(d,i);if(TCt.distanceSqToSegment(u,c,h,l)>s)continue;h.applyMatrix4(this.matrixWorld);const o=t.ray.origin.distanceTo(h);o<t.near||o>t.far||e.push({distance:o,point:l.clone().applyMatrix4(this.matrixWorld),index:n,face:null,faceIndex:null,object:this})}}else{for(let n=Math.max(0,o.start),r=Math.min(d.count,o.start+o.count)-1;n<r;n+=f){u.fromBufferAttribute(d,n),c.fromBufferAttribute(d,n+1);if(TCt.distanceSqToSegment(u,c,h,l)>s)continue;h.applyMatrix4(this.matrixWorld);const r=t.ray.origin.distanceTo(h);r<t.near||r>t.far||e.push({distance:r,point:l.clone().applyMatrix4(this.matrixWorld),index:n,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const t=this.geometry.morphAttributes,e=Object.keys(t);if(e.length>0){const n=t[e[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,e=n.length;t<e;t++){const e=n[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[e]=t}}}}}const kCt=new tAt,PCt=new tAt;class LCt extends OCt{constructor(t,e){super(t,e),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const t=this.geometry;if(null===t.index){const e=t.attributes.position,n=[];for(let t=0,r=e.count;t<r;t+=2)kCt.fromBufferAttribute(e,t),PCt.fromBufferAttribute(e,t+1),n[t]=0===t?0:n[t-1],n[t+1]=n[t]+kCt.distanceTo(PCt);t.setAttribute("lineDistance",new _Tt(n,1))}return this}}class RCt extends OCt{constructor(t,e){super(t,e),this.isLineLoop=!0,this.type="LineLoop"}}class ICt extends dTt{constructor(t){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new HEt(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.fog=t.fog,this}}const NCt=new kAt,DCt=new OAt,FCt=new _At,jCt=new tAt;class BCt extends eTt{constructor(t=new OTt,e=new ICt){super(),this.isPoints=!0,this.type="Points",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t,e){return super.copy(t,e),this.material=t.material,this.geometry=t.geometry,this}raycast(t,e){const n=this.geometry,r=this.matrixWorld,i=t.params.Points.threshold,o=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),FCt.copy(n.boundingSphere),FCt.applyMatrix4(r),FCt.radius+=i,!1===t.ray.intersectsSphere(FCt))return;NCt.copy(r).invert(),DCt.copy(t.ray).applyMatrix4(NCt);const a=i/((this.scale.x+this.scale.y+this.scale.z)/3),s=a*a,u=n.index,c=n.attributes.position;if(null!==u){for(let n=Math.max(0,o.start),i=Math.min(u.count,o.start+o.count);n<i;n++){const i=u.getX(n);jCt.fromBufferAttribute(c,i),zCt(jCt,i,s,r,t,e,this)}}else{for(let n=Math.max(0,o.start),i=Math.min(c.count,o.start+o.count);n<i;n++)jCt.fromBufferAttribute(c,n),zCt(jCt,n,s,r,t,e,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,e=Object.keys(t);if(e.length>0){const n=t[e[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,e=n.length;t<e;t++){const e=n[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[e]=t}}}}}function zCt(t,e,n,r,i,o,a){const s=DCt.distanceSqToPoint(t);if(s<n){const n=new tAt;DCt.closestPointToPoint(t,n),n.applyMatrix4(r);const u=i.ray.origin.distanceTo(n);if(u<i.near||u>i.far)return;o.push({distance:u,distanceToRay:Math.sqrt(s),point:n,index:e,face:null,object:a})}}class UCt extends dTt{constructor(t){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new HEt(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new HEt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new PEt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this.fog=t.fog,this}}class VCt extends UCt{constructor(t){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new PEt(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return MEt(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new HEt(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new HEt(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new HEt(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._iridescence=0,this._transmission=0,this.setValues(t)}get sheen(){return this._sheen}set sheen(t){this._sheen>0!=t>0&&this.version++,this._sheen=t}get clearcoat(){return this._clearcoat}set clearcoat(t){this._clearcoat>0!=t>0&&this.version++,this._clearcoat=t}get iridescence(){return this._iridescence}set iridescence(t){this._iridescence>0!=t>0&&this.version++,this._iridescence=t}get transmission(){return this._transmission}set transmission(t){this._transmission>0!=t>0&&this.version++,this._transmission=t}copy(t){return super.copy(t),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=t.clearcoat,this.clearcoatMap=t.clearcoatMap,this.clearcoatRoughness=t.clearcoatRoughness,this.clearcoatRoughnessMap=t.clearcoatRoughnessMap,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.ior=t.ior,this.iridescence=t.iridescence,this.iridescenceMap=t.iridescenceMap,this.iridescenceIOR=t.iridescenceIOR,this.iridescenceThicknessRange=[...t.iridescenceThicknessRange],this.iridescenceThicknessMap=t.iridescenceThicknessMap,this.sheen=t.sheen,this.sheenColor.copy(t.sheenColor),this.sheenColorMap=t.sheenColorMap,this.sheenRoughness=t.sheenRoughness,this.sheenRoughnessMap=t.sheenRoughnessMap,this.transmission=t.transmission,this.transmissionMap=t.transmissionMap,this.thickness=t.thickness,this.thicknessMap=t.thicknessMap,this.attenuationDistance=t.attenuationDistance,this.attenuationColor.copy(t.attenuationColor),this.specularIntensity=t.specularIntensity,this.specularIntensityMap=t.specularIntensityMap,this.specularColor.copy(t.specularColor),this.specularColorMap=t.specularColorMap,this}}function GCt(t,e,n){return HCt(t)?new t.constructor(t.subarray(e,void 0!==n?n:t.length)):t.slice(e,n)}function WCt(t,e,n){return!t||!n&&t.constructor===e?t:"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)}function HCt(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function YCt(t){const e=t.length,n=new Array(e);for(let r=0;r!==e;++r)n[r]=r;return n.sort((function(e,n){return t[e]-t[n]})),n}function XCt(t,e,n){const r=t.length,i=new t.constructor(r);for(let o=0,a=0;a!==r;++o){const r=n[o]*e;for(let n=0;n!==e;++n)i[a++]=t[r+n]}return i}function qCt(t,e,n,r){let i=1,o=t[0];for(;void 0!==o&&void 0===o[r];)o=t[i++];if(void 0===o)return;let a=o[r];if(void 0!==a)if(Array.isArray(a))do{a=o[r],void 0!==a&&(e.push(o.time),n.push.apply(n,a)),o=t[i++]}while(void 0!==o);else if(void 0!==a.toArray)do{a=o[r],void 0!==a&&(e.push(o.time),a.toArray(n,n.length)),o=t[i++]}while(void 0!==o);else do{a=o[r],void 0!==a&&(e.push(o.time),n.push(a)),o=t[i++]}while(void 0!==o)}class ZCt{constructor(t,e,n,r){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new e.constructor(n),this.sampleValues=e,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(t){const e=this.parameterPositions;let n=this._cachedIndex,r=e[n],i=e[n-1];t:{e:{let o;n:{r:if(!(t<r)){for(let o=n+2;;){if(void 0===r){if(t<i)break r;return n=e.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===o)break;if(i=r,r=e[++n],t<r)break e}o=e.length;break n}if(t>=i)break t;{const a=e[1];t<a&&(n=2,i=a);for(let o=n-2;;){if(void 0===i)return this._cachedIndex=0,this.copySampleValue_(0);if(n===o)break;if(r=i,i=e[--n-1],t>=i)break e}o=n,n=0}}for(;n<o;){const r=n+o>>>1;t<e[r]?o=r:n=r+1}if(r=e[n],i=e[n-1],void 0===i)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===r)return n=e.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,t,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(t){const e=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=t*r;for(let o=0;o!==r;++o)e[o]=n[i+o];return e}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class $Ct extends ZCt{constructor(t,e,n,r){super(t,e,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:cEt,endingEnd:cEt}}intervalChanged_(t,e,n){const r=this.parameterPositions;let i=t-2,o=t+1,a=r[i],s=r[o];if(void 0===a)switch(this.getSettings_().endingStart){case lEt:i=t,a=2*e-n;break;case hEt:i=r.length-2,a=e+r[i]-r[i+1];break;default:i=t,a=n}if(void 0===s)switch(this.getSettings_().endingEnd){case lEt:o=t,s=2*n-e;break;case hEt:o=1,s=n+r[1]-r[0];break;default:o=t-1,s=e}const u=.5*(n-e),c=this.valueSize;this._weightPrev=u/(e-a),this._weightNext=u/(s-n),this._offsetPrev=i*c,this._offsetNext=o*c}interpolate_(t,e,n,r){const i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=t*a,u=s-a,c=this._offsetPrev,l=this._offsetNext,h=this._weightPrev,f=this._weightNext,p=(n-e)/(r-e),d=p*p,m=d*p,v=-h*m+2*h*d-h*p,g=(1+h)*m+(-1.5-2*h)*d+(-.5+h)*p+1,y=(-1-f)*m+(1.5+f)*d+.5*p,x=f*m-f*d;for(let b=0;b!==a;++b)i[b]=v*o[c+b]+g*o[u+b]+y*o[s+b]+x*o[l+b];return i}}class KCt extends ZCt{constructor(t,e,n,r){super(t,e,n,r)}interpolate_(t,e,n,r){const i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=t*a,u=s-a,c=(n-e)/(r-e),l=1-c;for(let h=0;h!==a;++h)i[h]=o[u+h]*l+o[s+h]*c;return i}}class JCt extends ZCt{constructor(t,e,n,r){super(t,e,n,r)}interpolate_(t){return this.copySampleValue_(t-1)}}class QCt{constructor(t,e,n,r){if(void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=WCt(e,this.TimeBufferType),this.values=WCt(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(t){const e=t.constructor;let n;if(e.toJSON!==this.toJSON)n=e.toJSON(t);else{n={name:t.name,times:WCt(t.times,Array),values:WCt(t.values,Array)};const e=t.getInterpolation();e!==t.DefaultInterpolation&&(n.interpolation=e)}return n.type=t.ValueTypeName,n}InterpolantFactoryMethodDiscrete(t){return new JCt(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodLinear(t){return new KCt(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodSmooth(t){return new $Ct(this.times,this.values,this.getValueSize(),t)}setInterpolation(t){let e;switch(t){case aEt:e=this.InterpolantFactoryMethodDiscrete;break;case sEt:e=this.InterpolantFactoryMethodLinear;break;case uEt:e=this.InterpolantFactoryMethodSmooth}if(void 0===e){const e="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(e);this.setInterpolation(this.DefaultInterpolation)}return this}return this.createInterpolant=e,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return aEt;case this.InterpolantFactoryMethodLinear:return sEt;case this.InterpolantFactoryMethodSmooth:return uEt}}getValueSize(){return this.values.length/this.times.length}shift(t){if(0!==t){const e=this.times;for(let n=0,r=e.length;n!==r;++n)e[n]+=t}return this}scale(t){if(1!==t){const e=this.times;for(let n=0,r=e.length;n!==r;++n)e[n]*=t}return this}trim(t,e){const n=this.times,r=n.length;let i=0,o=r-1;for(;i!==r&&n[i]<t;)++i;for(;-1!==o&&n[o]>e;)--o;if(++o,0!==i||o!==r){i>=o&&(o=Math.max(o,1),i=o-1);const t=this.getValueSize();this.times=GCt(n,i,o),this.values=GCt(this.values,i*t,o*t)}return this}validate(){let t=!0;const e=this.getValueSize();e-Math.floor(e)!=0&&(t=!1);const n=this.times,r=this.values,i=n.length;0===i&&(t=!1);let o=null;for(let a=0;a!==i;a++){const e=n[a];if("number"==typeof e&&isNaN(e)){t=!1;break}if(null!==o&&o>e){t=!1;break}o=e}if(void 0!==r&&HCt(r))for(let a=0,s=r.length;a!==s;++a){const e=r[a];if(isNaN(e)){t=!1;break}}return t}optimize(){const t=GCt(this.times),e=GCt(this.values),n=this.getValueSize(),r=this.getInterpolation()===uEt,i=t.length-1;let o=1;for(let a=1;a<i;++a){let i=!1;const s=t[a];if(s!==t[a+1]&&(1!==a||s!==t[0]))if(r)i=!0;else{const t=a*n,r=t-n,o=t+n;for(let a=0;a!==n;++a){const n=e[t+a];if(n!==e[r+a]||n!==e[o+a]){i=!0;break}}}if(i){if(a!==o){t[o]=t[a];const r=a*n,i=o*n;for(let t=0;t!==n;++t)e[i+t]=e[r+t]}++o}}if(i>0){t[o]=t[i];for(let t=i*n,r=o*n,a=0;a!==n;++a)e[r+a]=e[t+a];++o}return o!==t.length?(this.times=GCt(t,0,o),this.values=GCt(e,0,o*n)):(this.times=t,this.values=e),this}clone(){const t=GCt(this.times,0),e=GCt(this.values,0),n=new(0,this.constructor)(this.name,t,e);return n.createInterpolant=this.createInterpolant,n}}QCt.prototype.TimeBufferType=Float32Array,QCt.prototype.ValueBufferType=Float32Array,QCt.prototype.DefaultInterpolation=sEt;class tOt extends QCt{}tOt.prototype.ValueTypeName="bool",tOt.prototype.ValueBufferType=Array,tOt.prototype.DefaultInterpolation=aEt,tOt.prototype.InterpolantFactoryMethodLinear=void 0,tOt.prototype.InterpolantFactoryMethodSmooth=void 0;class eOt extends QCt{}eOt.prototype.ValueTypeName="color";class nOt extends QCt{}nOt.prototype.ValueTypeName="number";class rOt extends ZCt{constructor(t,e,n,r){super(t,e,n,r)}interpolate_(t,e,n,r){const i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=(n-e)/(r-e);let u=t*a;for(let c=u+a;u!==c;u+=4)QEt.slerpFlat(i,0,o,u-a,o,u,s);return i}}class iOt extends QCt{InterpolantFactoryMethodLinear(t){return new rOt(this.times,this.values,this.getValueSize(),t)}}iOt.prototype.ValueTypeName="quaternion",iOt.prototype.DefaultInterpolation=sEt,iOt.prototype.InterpolantFactoryMethodSmooth=void 0;class oOt extends QCt{}oOt.prototype.ValueTypeName="string",oOt.prototype.ValueBufferType=Array,oOt.prototype.DefaultInterpolation=aEt,oOt.prototype.InterpolantFactoryMethodLinear=void 0,oOt.prototype.InterpolantFactoryMethodSmooth=void 0;class aOt extends QCt{}aOt.prototype.ValueTypeName="vector";class sOt{constructor(t,e=-1,n,r=2500){this.name=t,this.tracks=n,this.duration=e,this.blendMode=r,this.uuid=SEt(),this.duration<0&&this.resetDuration()}static parse(t){const e=[],n=t.tracks,r=1/(t.fps||1);for(let o=0,a=n.length;o!==a;++o)e.push(uOt(n[o]).scale(r));const i=new this(t.name,t.duration,e,t.blendMode);return i.uuid=t.uuid,i}static toJSON(t){const e=[],n=t.tracks,r={name:t.name,duration:t.duration,tracks:e,uuid:t.uuid,blendMode:t.blendMode};for(let i=0,o=n.length;i!==o;++i)e.push(QCt.toJSON(n[i]));return r}static CreateFromMorphTargetSequence(t,e,n,r){const i=e.length,o=[];for(let a=0;a<i;a++){let t=[],s=[];t.push((a+i-1)%i,a,(a+1)%i),s.push(0,1,0);const u=YCt(t);t=XCt(t,1,u),s=XCt(s,1,u),r||0!==t[0]||(t.push(i),s.push(s[0])),o.push(new nOt(".morphTargetInfluences["+e[a].name+"]",t,s).scale(1/n))}return new this(t,-1,o)}static findByName(t,e){let n=t;if(!Array.isArray(t)){const e=t;n=e.geometry&&e.geometry.animations||e.animations}for(let r=0;r<n.length;r++)if(n[r].name===e)return n[r];return null}static CreateClipsFromMorphTargetSequences(t,e,n){const r={},i=/^([\w-]*?)([\d]+)$/;for(let a=0,s=t.length;a<s;a++){const e=t[a],n=e.name.match(i);if(n&&n.length>1){const t=n[1];let i=r[t];i||(r[t]=i=[]),i.push(e)}}const o=[];for(const a in r)o.push(this.CreateFromMorphTargetSequence(a,r[a],e,n));return o}static parseAnimation(t,e){if(!t)return null;const n=function(t,e,n,r,i){if(0!==n.length){const o=[],a=[];qCt(n,o,a,r),0!==o.length&&i.push(new t(e,o,a))}},r=[],i=t.name||"default",o=t.fps||30,a=t.blendMode;let s=t.length||-1;const u=t.hierarchy||[];for(let c=0;c<u.length;c++){const t=u[c].keys;if(t&&0!==t.length)if(t[0].morphTargets){const e={};let n;for(n=0;n<t.length;n++)if(t[n].morphTargets)for(let r=0;r<t[n].morphTargets.length;r++)e[t[n].morphTargets[r]]=-1;for(const i in e){const e=[],o=[];for(let r=0;r!==t[n].morphTargets.length;++r){const r=t[n];e.push(r.time),o.push(r.morphTarget===i?1:0)}r.push(new nOt(".morphTargetInfluence["+i+"]",e,o))}s=e.length*o}else{const i=".bones["+e[c].name+"]";n(aOt,i+".position",t,"pos",r),n(iOt,i+".quaternion",t,"rot",r),n(aOt,i+".scale",t,"scl",r)}}if(0===r.length)return null;return new this(i,s,r,a)}resetDuration(){let t=0;for(let e=0,n=this.tracks.length;e!==n;++e){const n=this.tracks[e];t=Math.max(t,n.times[n.times.length-1])}return this.duration=t,this}trim(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this}validate(){let t=!0;for(let e=0;e<this.tracks.length;e++)t=t&&this.tracks[e].validate();return t}optimize(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this}clone(){const t=[];for(let e=0;e<this.tracks.length;e++)t.push(this.tracks[e].clone());return new this.constructor(this.name,this.duration,t,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function uOt(t){if(void 0===t.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return nOt;case"vector":case"vector2":case"vector3":case"vector4":return aOt;case"color":return eOt;case"quaternion":return iOt;case"bool":case"boolean":return tOt;case"string":return oOt}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}(t.type);if(void 0===t.times){const e=[],n=[];qCt(t.keys,e,n,"value"),t.times=e,t.values=n}return void 0!==e.parse?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}const cOt={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};class lOt{constructor(t,e,n){const r=this;let i,o=!1,a=0,s=0;const u=[];this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=n,this.itemStart=function(t){s++,!1===o&&void 0!==r.onStart&&r.onStart(t,a,s),o=!0},this.itemEnd=function(t){a++,void 0!==r.onProgress&&r.onProgress(t,a,s),a===s&&(o=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(t){void 0!==r.onError&&r.onError(t)},this.resolveURL=function(t){return i?i(t):t},this.setURLModifier=function(t){return i=t,this},this.addHandler=function(t,e){return u.push(t,e),this},this.removeHandler=function(t){const e=u.indexOf(t);return-1!==e&&u.splice(e,2),this},this.getHandler=function(t){for(let e=0,n=u.length;e<n;e+=2){const n=u[e],r=u[e+1];if(n.global&&(n.lastIndex=0),n.test(t))return r}return null}}}const hOt=new lOt;class fOt{constructor(t){this.manager=void 0!==t?t:hOt,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,e){const n=this;return new Promise((function(r,i){n.load(t,r,e,i)}))}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}}const pOt={};class dOt extends Error{constructor(t,e){super(t),this.response=e}}class mOt extends fOt{constructor(t){super(t)}load(t,e,n,r){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const i=cOt.get(t);if(void 0!==i)return this.manager.itemStart(t),setTimeout((()=>{e&&e(i),this.manager.itemEnd(t)}),0),i;if(void 0!==pOt[t])return void pOt[t].push({onLoad:e,onProgress:n,onError:r});pOt[t]=[],pOt[t].push({onLoad:e,onProgress:n,onError:r});const o=new Request(t,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,s=this.responseType;fetch(o).then((e=>{if(200===e.status||0===e.status){if(e.status,"undefined"==typeof ReadableStream||void 0===e.body||void 0===e.body.getReader)return e;const n=pOt[t],r=e.body.getReader(),i=e.headers.get("Content-Length")||e.headers.get("X-File-Size"),o=i?parseInt(i):0,a=0!==o;let s=0;const u=new ReadableStream({start(t){!function e(){r.read().then((({done:r,value:i})=>{if(r)t.close();else{s+=i.byteLength;const r=new ProgressEvent("progress",{lengthComputable:a,loaded:s,total:o});for(let t=0,e=n.length;t<e;t++){const e=n[t];e.onProgress&&e.onProgress(r)}t.enqueue(i),e()}}))}()}});return new Response(u)}throw new dOt(`fetch for "${e.url}" responded with ${e.status}: ${e.statusText}`,e)})).then((t=>{switch(s){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"document":return t.text().then((t=>(new DOMParser).parseFromString(t,a)));case"json":return t.json();default:if(void 0===a)return t.text();{const e=/charset="?([^;"\s]*)"?/i.exec(a),n=e&&e[1]?e[1].toLowerCase():void 0,r=new TextDecoder(n);return t.arrayBuffer().then((t=>r.decode(t)))}}})).then((e=>{cOt.add(t,e);const n=pOt[t];delete pOt[t];for(let t=0,r=n.length;t<r;t++){const r=n[t];r.onLoad&&r.onLoad(e)}})).catch((e=>{const n=pOt[t];if(void 0===n)throw this.manager.itemError(t),e;delete pOt[t];for(let t=0,r=n.length;t<r;t++){const r=n[t];r.onError&&r.onError(e)}this.manager.itemError(t)})).finally((()=>{this.manager.itemEnd(t)})),this.manager.itemStart(t)}setResponseType(t){return this.responseType=t,this}setMimeType(t){return this.mimeType=t,this}}class vOt extends fOt{constructor(t){super(t)}load(t,e,n,r){void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const i=this,o=cOt.get(t);if(void 0!==o)return i.manager.itemStart(t),setTimeout((function(){e&&e(o),i.manager.itemEnd(t)}),0),o;const a=IEt("img");function s(){c(),cOt.add(t,this),e&&e(this),i.manager.itemEnd(t)}function u(e){c(),r&&r(e),i.manager.itemError(t),i.manager.itemEnd(t)}function c(){a.removeEventListener("load",s,!1),a.removeEventListener("error",u,!1)}return a.addEventListener("load",s,!1),a.addEventListener("error",u,!1),"data:"!==t.slice(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),i.manager.itemStart(t),a.src=t,a}}class gOt extends fOt{constructor(t){super(t)}load(t,e,n,r){const i=new KEt,o=new vOt(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(t,(function(t){i.image=t,i.needsUpdate=!0,void 0!==e&&e(i)}),n,r),i}}class yOt extends eTt{constructor(t,e=1){super(),this.isLight=!0,this.type="Light",this.color=new HEt(t),this.intensity=e}dispose(){}copy(t,e){return super.copy(t,e),this.color.copy(t.color),this.intensity=t.intensity,this}toJSON(t){const e=super.toJSON(t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(e.object.distance=this.distance),void 0!==this.angle&&(e.object.angle=this.angle),void 0!==this.decay&&(e.object.decay=this.decay),void 0!==this.penumbra&&(e.object.penumbra=this.penumbra),void 0!==this.shadow&&(e.object.shadow=this.shadow.toJSON()),e}}const xOt=new kAt,bOt=new tAt,_Ot=new tAt;class wOt{constructor(t){this.camera=t,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new PEt(512,512),this.map=null,this.mapPass=null,this.matrix=new kAt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new QTt,this._frameExtents=new PEt(1,1),this._viewportCount=1,this._viewports=[new JEt(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(t){const e=this.camera,n=this.matrix;bOt.setFromMatrixPosition(t.matrixWorld),e.position.copy(bOt),_Ot.setFromMatrixPosition(t.target.matrixWorld),e.lookAt(_Ot),e.updateMatrixWorld(),xOt.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromProjectionMatrix(xOt),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(xOt)}getViewport(t){return this._viewports[t]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const t={};return 0!==this.bias&&(t.bias=this.bias),0!==this.normalBias&&(t.normalBias=this.normalBias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}class SOt extends wOt{constructor(){super(new YTt(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(t){const e=this.camera,n=2*wEt*t.angle*this.focus,r=this.mapSize.width/this.mapSize.height,i=t.distance||e.far;n===e.fov&&r===e.aspect&&i===e.far||(e.fov=n,e.aspect=r,e.far=i,e.updateProjectionMatrix()),super.updateMatrices(t)}copy(t){return super.copy(t),this.focus=t.focus,this}}class MOt extends yOt{constructor(t,e,n=0,r=Math.PI/3,i=0,o=2){super(t,e),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(eTt.DefaultUp),this.updateMatrix(),this.target=new eTt,this.distance=n,this.angle=r,this.penumbra=i,this.decay=o,this.map=null,this.shadow=new SOt}get power(){return this.intensity*Math.PI}set power(t){this.intensity=t/Math.PI}dispose(){this.shadow.dispose()}copy(t,e){return super.copy(t,e),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}const EOt=new kAt,AOt=new tAt,TOt=new tAt;class COt extends wOt{constructor(){super(new YTt(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new PEt(4,2),this._viewportCount=6,this._viewports=[new JEt(2,1,1,1),new JEt(0,1,1,1),new JEt(3,1,1,1),new JEt(1,1,1,1),new JEt(3,0,1,1),new JEt(1,0,1,1)],this._cubeDirections=[new tAt(1,0,0),new tAt(-1,0,0),new tAt(0,0,1),new tAt(0,0,-1),new tAt(0,1,0),new tAt(0,-1,0)],this._cubeUps=[new tAt(0,1,0),new tAt(0,1,0),new tAt(0,1,0),new tAt(0,1,0),new tAt(0,0,1),new tAt(0,0,-1)]}updateMatrices(t,e=0){const n=this.camera,r=this.matrix,i=t.distance||n.far;i!==n.far&&(n.far=i,n.updateProjectionMatrix()),AOt.setFromMatrixPosition(t.matrixWorld),n.position.copy(AOt),TOt.copy(n.position),TOt.add(this._cubeDirections[e]),n.up.copy(this._cubeUps[e]),n.lookAt(TOt),n.updateMatrixWorld(),r.makeTranslation(-AOt.x,-AOt.y,-AOt.z),EOt.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(EOt)}}class OOt extends yOt{constructor(t,e,n=0,r=2){super(t,e),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new COt}get power(){return 4*this.intensity*Math.PI}set power(t){this.intensity=t/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(t,e){return super.copy(t,e),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}class kOt extends wOt{constructor(){super(new tCt(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class POt extends yOt{constructor(t,e){super(t,e),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(eTt.DefaultUp),this.updateMatrix(),this.target=new eTt,this.shadow=new kOt}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}class LOt extends yOt{constructor(t,e){super(t,e),this.isAmbientLight=!0,this.type="AmbientLight"}}class ROt{static decodeText(t){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(t);let e="";for(let r=0,i=t.length;r<i;r++)e+=String.fromCharCode(t[r]);try{return decodeURIComponent(escape(e))}catch(n){return e}}static extractUrlBase(t){const e=t.lastIndexOf("/");return-1===e?"./":t.slice(0,e+1)}static resolveURL(t,e){return"string"!=typeof t||""===t?"":(/^https?:\/\//i.test(e)&&/^\//.test(t)&&(e=e.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(t)||/^data:.*,.*$/i.test(t)||/^blob:.*$/i.test(t)?t:e+t)}}class IOt extends fOt{constructor(t){super(t),this.isImageBitmapLoader=!0,this.options={premultiplyAlpha:"none"}}setOptions(t){return this.options=t,this}load(t,e,n,r){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const i=this,o=cOt.get(t);if(void 0!==o)return i.manager.itemStart(t),setTimeout((function(){e&&e(o),i.manager.itemEnd(t)}),0),o;const a={};a.credentials="anonymous"===this.crossOrigin?"same-origin":"include",a.headers=this.requestHeader,fetch(t,a).then((function(t){return t.blob()})).then((function(t){return createImageBitmap(t,Object.assign(i.options,{colorSpaceConversion:"none"}))})).then((function(n){cOt.add(t,n),e&&e(n),i.manager.itemEnd(t)})).catch((function(e){r&&r(e),i.manager.itemError(t),i.manager.itemEnd(t)})),i.manager.itemStart(t)}}class NOt{constructor(t,e,n){let r,i,o;switch(this.binding=t,this.valueSize=n,e){case"quaternion":r=this._slerp,i=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*n),this._workIndex=5;break;case"string":case"bool":r=this._select,i=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(5*n);break;default:r=this._lerp,i=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*n)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=i,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(t,e){const n=this.buffer,r=this.valueSize,i=t*r+r;let o=this.cumulativeWeight;if(0===o){for(let t=0;t!==r;++t)n[i+t]=n[t];o=e}else{o+=e;const t=e/o;this._mixBufferRegion(n,i,0,t,r)}this.cumulativeWeight=o}accumulateAdditive(t){const e=this.buffer,n=this.valueSize,r=n*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(e,r,0,t,n),this.cumulativeWeightAdditive+=t}apply(t){const e=this.valueSize,n=this.buffer,r=t*e+e,i=this.cumulativeWeight,o=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,i<1){const t=e*this._origIndex;this._mixBufferRegion(n,r,t,1-i,e)}o>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*e,1,e);for(let s=e,u=e+e;s!==u;++s)if(n[s]!==n[s+e]){a.setValue(n,r);break}}saveOriginalState(){const t=this.binding,e=this.buffer,n=this.valueSize,r=n*this._origIndex;t.getValue(e,r);for(let i=n,o=r;i!==o;++i)e[i]=e[r+i%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const t=3*this.valueSize;this.binding.setValue(this.buffer,t)}_setAdditiveIdentityNumeric(){const t=this._addIndex*this.valueSize,e=t+this.valueSize;for(let n=t;n<e;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const t=this._origIndex*this.valueSize,e=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[e+n]=this.buffer[t+n]}_select(t,e,n,r,i){if(r>=.5)for(let o=0;o!==i;++o)t[e+o]=t[n+o]}_slerp(t,e,n,r){QEt.slerpFlat(t,e,t,e,t,n,r)}_slerpAdditive(t,e,n,r,i){const o=this._workIndex*i;QEt.multiplyQuaternionsFlat(t,o,t,e,t,n),QEt.slerpFlat(t,e,t,e,t,o,r)}_lerp(t,e,n,r,i){const o=1-r;for(let a=0;a!==i;++a){const i=e+a;t[i]=t[i]*o+t[n+a]*r}}_lerpAdditive(t,e,n,r,i){for(let o=0;o!==i;++o){const i=e+o;t[i]=t[i]+t[n+o]*r}}}const DOt="\\[\\]\\.:\\/",FOt=new RegExp("["+DOt+"]","g"),jOt="[^"+DOt+"]",BOt="[^"+DOt.replace("\\.","")+"]",zOt=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",jOt)+/(WCOD+)?/.source.replace("WCOD",BOt)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",jOt)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",jOt)+"$"),UOt=["material","materials","bones","map"];class VOt{constructor(t,e,n){this.path=e,this.parsedPath=n||VOt.parseTrackName(e),this.node=VOt.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,e,n){return t&&t.isAnimationObjectGroup?new VOt.Composite(t,e,n):new VOt(t,e,n)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(FOt,"")}static parseTrackName(t){const e=zOt.exec(t);if(null===e)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const n={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){const t=n.nodeName.substring(r+1);-1!==UOt.indexOf(t)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=t)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return n}static findNode(t,e){if(void 0===e||""===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){const n=t.skeleton.getBoneByName(e);if(void 0!==n)return n}if(t.children){const n=function(t){for(let r=0;r<t.length;r++){const i=t[r];if(i.name===e||i.uuid===e)return i;const o=n(i.children);if(o)return o}return null},r=n(t.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,e){t[e]=this.targetObject[this.propertyName]}_getValue_array(t,e){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)t[e++]=n[r]}_getValue_arrayElement(t,e){t[e]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,e){this.resolvedProperty.toArray(t,e)}_setValue_direct(t,e){this.targetObject[this.propertyName]=t[e]}_setValue_direct_setNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,e){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=t[e++]}_setValue_array_setNeedsUpdate(t,e){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=t[e++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,e){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,e){this.resolvedProperty[this.propertyIndex]=t[e]}_setValue_arrayElement_setNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,e){this.resolvedProperty.fromArray(t,e)}_setValue_fromArray_setNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,e){this.bind(),this.getValue(t,e)}_setValue_unbound(t,e){this.bind(),this.setValue(t,e)}bind(){let t=this.node;const e=this.parsedPath,n=e.objectName,r=e.propertyName;let i=e.propertyIndex;if(t||(t=VOt.findNode(this.rootNode,e.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return;if(n){let r=e.objectIndex;switch(n){case"materials":if(!t.material)return;if(!t.material.materials)return;t=t.material.materials;break;case"bones":if(!t.skeleton)return;t=t.skeleton.bones;for(let e=0;e<t.length;e++)if(t[e].name===r){r=e;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material)return;if(!t.material.map)return;t=t.material.map;break;default:if(void 0===t[n])return;t=t[n]}if(void 0!==r){if(void 0===t[r])return;t=t[r]}}const o=t[r];if(void 0===o){e.nodeName;return}let a=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?a=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(a=this.Versioning.MatrixWorldNeedsUpdate);let s=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===r){if(!t.geometry)return;if(!t.geometry.morphAttributes)return;void 0!==t.morphTargetDictionary[i]&&(i=t.morphTargetDictionary[i])}s=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=i}else void 0!==o.fromArray&&void 0!==o.toArray?(s=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(s=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=r;this.getValue=this.GetterByBindingType[s],this.setValue=this.SetterByBindingTypeAndVersioning[s][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}VOt.Composite=class{constructor(t,e,n){const r=n||VOt.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,r)}getValue(t,e){this.bind();const n=this._targetGroup.nCachedObjects_,r=this._bindings[n];void 0!==r&&r.getValue(t,e)}setValue(t,e){const n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(t,e)}bind(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].bind()}unbind(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].unbind()}},VOt.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},VOt.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},VOt.prototype.GetterByBindingType=[VOt.prototype._getValue_direct,VOt.prototype._getValue_array,VOt.prototype._getValue_arrayElement,VOt.prototype._getValue_toArray],VOt.prototype.SetterByBindingTypeAndVersioning=[[VOt.prototype._setValue_direct,VOt.prototype._setValue_direct_setNeedsUpdate,VOt.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[VOt.prototype._setValue_array,VOt.prototype._setValue_array_setNeedsUpdate,VOt.prototype._setValue_array_setMatrixWorldNeedsUpdate],[VOt.prototype._setValue_arrayElement,VOt.prototype._setValue_arrayElement_setNeedsUpdate,VOt.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[VOt.prototype._setValue_fromArray,VOt.prototype._setValue_fromArray_setNeedsUpdate,VOt.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class GOt{constructor(t,e,n=null,r=e.blendMode){this._mixer=t,this._clip=e,this._localRoot=n,this.blendMode=r;const i=e.tracks,o=i.length,a=new Array(o),s={endingStart:cEt,endingEnd:cEt};for(let u=0;u!==o;++u){const t=i[u].createInterpolant(null);a[u]=t,t.settings=s}this._interpolantSettings=s,this._interpolants=a,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(t){return this._startTime=t,this}setLoop(t,e){return this.loop=t,this.repetitions=e,this}setEffectiveWeight(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(t){return this._scheduleFading(t,0,1)}fadeOut(t){return this._scheduleFading(t,1,0)}crossFadeFrom(t,e,n){if(t.fadeOut(e),this.fadeIn(e),n){const n=this._clip.duration,r=t._clip.duration,i=r/n,o=n/r;t.warp(1,i,e),this.warp(o,1,e)}return this}crossFadeTo(t,e,n){return t.crossFadeFrom(this,e,n)}stopFading(){const t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}setEffectiveTimeScale(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(t){return this.timeScale=this._clip.duration/t,this.stopWarping()}syncWith(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()}halt(t){return this.warp(this._effectiveTimeScale,0,t)}warp(t,e,n){const r=this._mixer,i=r.time,o=this.timeScale;let a=this._timeScaleInterpolant;null===a&&(a=r._lendControlInterpolant(),this._timeScaleInterpolant=a);const s=a.parameterPositions,u=a.sampleValues;return s[0]=i,s[1]=i+n,u[0]=t/o,u[1]=e/o,this}stopWarping(){const t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(t,e,n,r){if(!this.enabled)return void this._updateWeight(t);const i=this._startTime;if(null!==i){const r=(t-i)*n;r<0||0===n?e=0:(this._startTime=null,e=n*r)}e*=this._updateTimeScale(t);const o=this._updateTime(e),a=this._updateWeight(t);if(a>0){const t=this._interpolants,e=this._propertyBindings;if(2501===this.blendMode)for(let n=0,r=t.length;n!==r;++n)t[n].evaluate(o),e[n].accumulateAdditive(a);else for(let n=0,i=t.length;n!==i;++n)t[n].evaluate(o),e[n].accumulate(r,a)}}_updateWeight(t){let e=0;if(this.enabled){e=this.weight;const n=this._weightInterpolant;if(null!==n){const r=n.evaluate(t)[0];e*=r,t>n.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=e,e}_updateTimeScale(t){let e=0;if(!this.paused){e=this.timeScale;const n=this._timeScaleInterpolant;if(null!==n){e*=n.evaluate(t)[0],t>n.parameterPositions[1]&&(this.stopWarping(),0===e?this.paused=!0:this.timeScale=e)}}return this._effectiveTimeScale=e,e}_updateTime(t){const e=this._clip.duration,n=this.loop;let r=this.time+t,i=this._loopCount;const o=2202===n;if(0===t)return-1===i?r:o&&1==(1&i)?e-r:r;if(2200===n){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));t:{if(r>=e)r=e;else{if(!(r<0)){this.time=r;break t}r=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(-1===i&&(t>=0?(i=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),r>=e||r<0){const n=Math.floor(r/e);r-=e*n,i+=Math.abs(n);const a=this.repetitions-i;if(a<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=t>0?e:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(1===a){const e=t<0;this._setEndings(e,!e,o)}else this._setEndings(!1,!1,o);this._loopCount=i,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:n})}}else this.time=r;if(o&&1==(1&i))return e-r}return r}_setEndings(t,e,n){const r=this._interpolantSettings;n?(r.endingStart=lEt,r.endingEnd=lEt):(r.endingStart=t?this.zeroSlopeAtStart?lEt:cEt:hEt,r.endingEnd=e?this.zeroSlopeAtEnd?lEt:cEt:hEt)}_scheduleFading(t,e,n){const r=this._mixer,i=r.time;let o=this._weightInterpolant;null===o&&(o=r._lendControlInterpolant(),this._weightInterpolant=o);const a=o.parameterPositions,s=o.sampleValues;return a[0]=i,s[0]=e,a[1]=i+t,s[1]=n,this}}const WOt=new Float32Array(1);class HOt extends yEt{constructor(t){super(),this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(t,e){const n=t._localRoot||this._root,r=t._clip.tracks,i=r.length,o=t._propertyBindings,a=t._interpolants,s=n.uuid,u=this._bindingsByRootAndName;let c=u[s];void 0===c&&(c={},u[s]=c);for(let l=0;l!==i;++l){const t=r[l],i=t.name;let u=c[i];if(void 0!==u)++u.referenceCount,o[l]=u;else{if(u=o[l],void 0!==u){null===u._cacheIndex&&(++u.referenceCount,this._addInactiveBinding(u,s,i));continue}const r=e&&e._propertyBindings[l].binding.parsedPath;u=new NOt(VOt.create(n,i,r),t.ValueTypeName,t.getValueSize()),++u.referenceCount,this._addInactiveBinding(u,s,i),o[l]=u}a[l].resultBuffer=u.buffer}}_activateAction(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){const e=(t._localRoot||this._root).uuid,n=t._clip.uuid,r=this._actionsByClip[n];this._bindAction(t,r&&r.knownActions[0]),this._addInactiveAction(t,n,e)}const e=t._propertyBindings;for(let t=0,n=e.length;t!==n;++t){const n=e[t];0==n.useCount++&&(this._lendBinding(n),n.saveOriginalState())}this._lendAction(t)}}_deactivateAction(t){if(this._isActiveAction(t)){const e=t._propertyBindings;for(let t=0,n=e.length;t!==n;++t){const n=e[t];0==--n.useCount&&(n.restoreOriginalState(),this._takeBackBinding(n))}this._takeBackAction(t)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}}_isActiveAction(t){const e=t._cacheIndex;return null!==e&&e<this._nActiveActions}_addInactiveAction(t,e,n){const r=this._actions,i=this._actionsByClip;let o=i[e];if(void 0===o)o={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,i[e]=o;else{const e=o.knownActions;t._byClipCacheIndex=e.length,e.push(t)}t._cacheIndex=r.length,r.push(t),o.actionByRoot[n]=t}_removeInactiveAction(t){const e=this._actions,n=e[e.length-1],r=t._cacheIndex;n._cacheIndex=r,e[r]=n,e.pop(),t._cacheIndex=null;const i=t._clip.uuid,o=this._actionsByClip,a=o[i],s=a.knownActions,u=s[s.length-1],c=t._byClipCacheIndex;u._byClipCacheIndex=c,s[c]=u,s.pop(),t._byClipCacheIndex=null;delete a.actionByRoot[(t._localRoot||this._root).uuid],0===s.length&&delete o[i],this._removeInactiveBindingsForAction(t)}_removeInactiveBindingsForAction(t){const e=t._propertyBindings;for(let n=0,r=e.length;n!==r;++n){const t=e[n];0==--t.referenceCount&&this._removeInactiveBinding(t)}}_lendAction(t){const e=this._actions,n=t._cacheIndex,r=this._nActiveActions++,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i}_takeBackAction(t){const e=this._actions,n=t._cacheIndex,r=--this._nActiveActions,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i}_addInactiveBinding(t,e,n){const r=this._bindingsByRootAndName,i=this._bindings;let o=r[e];void 0===o&&(o={},r[e]=o),o[n]=t,t._cacheIndex=i.length,i.push(t)}_removeInactiveBinding(t){const e=this._bindings,n=t.binding,r=n.rootNode.uuid,i=n.path,o=this._bindingsByRootAndName,a=o[r],s=e[e.length-1],u=t._cacheIndex;s._cacheIndex=u,e[u]=s,e.pop(),delete a[i],0===Object.keys(a).length&&delete o[r]}_lendBinding(t){const e=this._bindings,n=t._cacheIndex,r=this._nActiveBindings++,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i}_takeBackBinding(t){const e=this._bindings,n=t._cacheIndex,r=--this._nActiveBindings,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i}_lendControlInterpolant(){const t=this._controlInterpolants,e=this._nActiveControlInterpolants++;let n=t[e];return void 0===n&&(n=new KCt(new Float32Array(2),new Float32Array(2),1,WOt),n.__cacheIndex=e,t[e]=n),n}_takeBackControlInterpolant(t){const e=this._controlInterpolants,n=t.__cacheIndex,r=--this._nActiveControlInterpolants,i=e[r];t.__cacheIndex=r,e[r]=t,i.__cacheIndex=n,e[n]=i}clipAction(t,e,n){const r=e||this._root,i=r.uuid;let o="string"==typeof t?sOt.findByName(r,t):t;const a=null!==o?o.uuid:t,s=this._actionsByClip[a];let u=null;if(void 0===n&&(n=null!==o?o.blendMode:fEt),void 0!==s){const t=s.actionByRoot[i];if(void 0!==t&&t.blendMode===n)return t;u=s.knownActions[0],null===o&&(o=u._clip)}if(null===o)return null;const c=new GOt(this,o,e,n);return this._bindAction(c,u),this._addInactiveAction(c,a,i),c}existingAction(t,e){const n=e||this._root,r=n.uuid,i="string"==typeof t?sOt.findByName(n,t):t,o=i?i.uuid:t,a=this._actionsByClip[o];return void 0!==a&&a.actionByRoot[r]||null}stopAllAction(){const t=this._actions;for(let e=this._nActiveActions-1;e>=0;--e)t[e].stop();return this}update(t){t*=this.timeScale;const e=this._actions,n=this._nActiveActions,r=this.time+=t,i=Math.sign(t),o=this._accuIndex^=1;for(let u=0;u!==n;++u){e[u]._update(r,t,i,o)}const a=this._bindings,s=this._nActiveBindings;for(let u=0;u!==s;++u)a[u].apply(o);return this}setTime(t){this.time=0;for(let e=0;e<this._actions.length;e++)this._actions[e].time=0;return this.update(t)}getRoot(){return this._root}uncacheClip(t){const e=this._actions,n=t.uuid,r=this._actionsByClip,i=r[n];if(void 0!==i){const t=i.knownActions;for(let n=0,r=t.length;n!==r;++n){const r=t[n];this._deactivateAction(r);const i=r._cacheIndex,o=e[e.length-1];r._cacheIndex=null,r._byClipCacheIndex=null,o._cacheIndex=i,e[i]=o,e.pop(),this._removeInactiveBindingsForAction(r)}delete r[n]}}uncacheRoot(t){const e=t.uuid,n=this._actionsByClip;for(const i in n){const t=n[i].actionByRoot[e];void 0!==t&&(this._deactivateAction(t),this._removeInactiveAction(t))}const r=this._bindingsByRootAndName[e];if(void 0!==r)for(const i in r){const t=r[i];t.restoreOriginalState(),this._removeInactiveBinding(t)}}uncacheAction(t,e){const n=this.existingAction(t,e);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"148"}})),"undefined"!=typeof window&&(window.__THREE__||(window.__THREE__="148"));class YOt extends fOt{constructor(t){super(t),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register((function(t){return new JOt(t)})),this.register((function(t){return new okt(t)})),this.register((function(t){return new akt(t)})),this.register((function(t){return new tkt(t)})),this.register((function(t){return new ekt(t)})),this.register((function(t){return new nkt(t)})),this.register((function(t){return new rkt(t)})),this.register((function(t){return new KOt(t)})),this.register((function(t){return new ikt(t)})),this.register((function(t){return new QOt(t)})),this.register((function(t){return new ZOt(t)})),this.register((function(t){return new skt(t)})),this.register((function(t){return new ukt(t)}))}load(t,e,n,r){const i=this;let o;o=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:ROt.extractUrlBase(t),this.manager.itemStart(t);const a=function(e){r&&r(e),i.manager.itemError(t),i.manager.itemEnd(t)},s=new mOt(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(t,(function(n){try{i.parse(n,o,(function(n){e(n),i.manager.itemEnd(t)}),a)}catch(r){a(r)}}),n,a)}setDRACOLoader(t){return this.dracoLoader=t,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(t){return this.ktx2Loader=t,this}setMeshoptDecoder(t){return this.meshoptDecoder=t,this}register(t){return-1===this.pluginCallbacks.indexOf(t)&&this.pluginCallbacks.push(t),this}unregister(t){return-1!==this.pluginCallbacks.indexOf(t)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(t),1),this}parse(t,e,n,r){let i;const o={},a={};if("string"==typeof t)i=JSON.parse(t);else if(t instanceof ArrayBuffer){if(ROt.decodeText(new Uint8Array(t,0,4))===ckt){try{o[qOt.KHR_BINARY_GLTF]=new fkt(t)}catch(u){return void(r&&r(u))}i=JSON.parse(o[qOt.KHR_BINARY_GLTF].content)}else i=JSON.parse(ROt.decodeText(new Uint8Array(t)))}else i=t;if(void 0===i.asset||i.asset.version[0]<2)return void(r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const s=new jkt(i,{path:e||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});s.fileLoader.setRequestHeader(this.requestHeader);for(let c=0;c<this.pluginCallbacks.length;c++){const t=this.pluginCallbacks[c](s);a[t.name]=t,o[t.name]=!0}if(i.extensionsUsed)for(let c=0;c<i.extensionsUsed.length;++c){const t=i.extensionsUsed[c],e=i.extensionsRequired||[];switch(t){case qOt.KHR_MATERIALS_UNLIT:o[t]=new $Ot;break;case qOt.KHR_DRACO_MESH_COMPRESSION:o[t]=new pkt(i,this.dracoLoader);break;case qOt.KHR_TEXTURE_TRANSFORM:o[t]=new dkt;break;case qOt.KHR_MESH_QUANTIZATION:o[t]=new mkt;break;default:e.indexOf(t)>=0&&a[t]}}s.setExtensions(o),s.setPlugins(a),s.parse(n,r)}parseAsync(t,e){const n=this;return new Promise((function(r,i){n.parse(t,e,r,i)}))}}function XOt(){let t={};return{get:function(e){return t[e]},add:function(e,n){t[e]=n},remove:function(e){delete t[e]},removeAll:function(){t={}}}}const qOt={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class ZOt{constructor(t){this.parser=t,this.name=qOt.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const t=this.parser,e=this.parser.json.nodes||[];for(let n=0,r=e.length;n<r;n++){const r=e[n];r.extensions&&r.extensions[this.name]&&void 0!==r.extensions[this.name].light&&t._addNodeRef(this.cache,r.extensions[this.name].light)}}_loadLight(t){const e=this.parser,n="light:"+t;let r=e.cache.get(n);if(r)return r;const i=e.json,o=((i.extensions&&i.extensions[this.name]||{}).lights||[])[t];let a;const s=new HEt(16777215);void 0!==o.color&&s.fromArray(o.color);const u=void 0!==o.range?o.range:0;switch(o.type){case"directional":a=new POt(s),a.target.position.set(0,0,-1),a.add(a.target);break;case"point":a=new OOt(s),a.distance=u;break;case"spot":a=new MOt(s),a.distance=u,o.spot=o.spot||{},o.spot.innerConeAngle=void 0!==o.spot.innerConeAngle?o.spot.innerConeAngle:0,o.spot.outerConeAngle=void 0!==o.spot.outerConeAngle?o.spot.outerConeAngle:Math.PI/4,a.angle=o.spot.outerConeAngle,a.penumbra=1-o.spot.innerConeAngle/o.spot.outerConeAngle,a.target.position.set(0,0,-1),a.add(a.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+o.type)}return a.position.set(0,0,0),a.decay=2,Lkt(a,o),void 0!==o.intensity&&(a.intensity=o.intensity),a.name=e.createUniqueName(o.name||"light_"+t),r=Promise.resolve(a),e.cache.add(n,r),r}getDependency(t,e){if("light"===t)return this._loadLight(e)}createNodeAttachment(t){const e=this,n=this.parser,r=n.json.nodes[t],i=(r.extensions&&r.extensions[this.name]||{}).light;return void 0===i?null:this._loadLight(i).then((function(t){return n._getNodeRef(e.cache,i,t)}))}}class $Ot{constructor(){this.name=qOt.KHR_MATERIALS_UNLIT}getMaterialType(){return mTt}extendParams(t,e,n){const r=[];t.color=new HEt(1,1,1),t.opacity=1;const i=e.pbrMetallicRoughness;if(i){if(Array.isArray(i.baseColorFactor)){const e=i.baseColorFactor;t.color.fromArray(e),t.opacity=e[3]}void 0!==i.baseColorTexture&&r.push(n.assignTexture(t,"map",i.baseColorTexture,pEt))}return Promise.all(r)}}class KOt{constructor(t){this.parser=t,this.name=qOt.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(t,e){const n=this.parser.json.materials[t];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const r=n.extensions[this.name].emissiveStrength;return void 0!==r&&(e.emissiveIntensity=r),Promise.resolve()}}class JOt{constructor(t){this.parser=t,this.name=qOt.KHR_MATERIALS_CLEARCOAT}getMaterialType(t){const e=this.parser.json.materials[t];return e.extensions&&e.extensions[this.name]?VCt:null}extendMaterialParams(t,e){const n=this.parser,r=n.json.materials[t];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const i=[],o=r.extensions[this.name];if(void 0!==o.clearcoatFactor&&(e.clearcoat=o.clearcoatFactor),void 0!==o.clearcoatTexture&&i.push(n.assignTexture(e,"clearcoatMap",o.clearcoatTexture)),void 0!==o.clearcoatRoughnessFactor&&(e.clearcoatRoughness=o.clearcoatRoughnessFactor),void 0!==o.clearcoatRoughnessTexture&&i.push(n.assignTexture(e,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),void 0!==o.clearcoatNormalTexture&&(i.push(n.assignTexture(e,"clearcoatNormalMap",o.clearcoatNormalTexture)),void 0!==o.clearcoatNormalTexture.scale)){const t=o.clearcoatNormalTexture.scale;e.clearcoatNormalScale=new PEt(t,t)}return Promise.all(i)}}class QOt{constructor(t){this.parser=t,this.name=qOt.KHR_MATERIALS_IRIDESCENCE}getMaterialType(t){const e=this.parser.json.materials[t];return e.extensions&&e.extensions[this.name]?VCt:null}extendMaterialParams(t,e){const n=this.parser,r=n.json.materials[t];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const i=[],o=r.extensions[this.name];return void 0!==o.iridescenceFactor&&(e.iridescence=o.iridescenceFactor),void 0!==o.iridescenceTexture&&i.push(n.assignTexture(e,"iridescenceMap",o.iridescenceTexture)),void 0!==o.iridescenceIor&&(e.iridescenceIOR=o.iridescenceIor),void 0===e.iridescenceThicknessRange&&(e.iridescenceThicknessRange=[100,400]),void 0!==o.iridescenceThicknessMinimum&&(e.iridescenceThicknessRange[0]=o.iridescenceThicknessMinimum),void 0!==o.iridescenceThicknessMaximum&&(e.iridescenceThicknessRange[1]=o.iridescenceThicknessMaximum),void 0!==o.iridescenceThicknessTexture&&i.push(n.assignTexture(e,"iridescenceThicknessMap",o.iridescenceThicknessTexture)),Promise.all(i)}}class tkt{constructor(t){this.parser=t,this.name=qOt.KHR_MATERIALS_SHEEN}getMaterialType(t){const e=this.parser.json.materials[t];return e.extensions&&e.extensions[this.name]?VCt:null}extendMaterialParams(t,e){const n=this.parser,r=n.json.materials[t];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const i=[];e.sheenColor=new HEt(0,0,0),e.sheenRoughness=0,e.sheen=1;const o=r.extensions[this.name];return void 0!==o.sheenColorFactor&&e.sheenColor.fromArray(o.sheenColorFactor),void 0!==o.sheenRoughnessFactor&&(e.sheenRoughness=o.sheenRoughnessFactor),void 0!==o.sheenColorTexture&&i.push(n.assignTexture(e,"sheenColorMap",o.sheenColorTexture,pEt)),void 0!==o.sheenRoughnessTexture&&i.push(n.assignTexture(e,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(i)}}class ekt{constructor(t){this.parser=t,this.name=qOt.KHR_MATERIALS_TRANSMISSION}getMaterialType(t){const e=this.parser.json.materials[t];return e.extensions&&e.extensions[this.name]?VCt:null}extendMaterialParams(t,e){const n=this.parser,r=n.json.materials[t];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const i=[],o=r.extensions[this.name];return void 0!==o.transmissionFactor&&(e.transmission=o.transmissionFactor),void 0!==o.transmissionTexture&&i.push(n.assignTexture(e,"transmissionMap",o.transmissionTexture)),Promise.all(i)}}class nkt{constructor(t){this.parser=t,this.name=qOt.KHR_MATERIALS_VOLUME}getMaterialType(t){const e=this.parser.json.materials[t];return e.extensions&&e.extensions[this.name]?VCt:null}extendMaterialParams(t,e){const n=this.parser,r=n.json.materials[t];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const i=[],o=r.extensions[this.name];e.thickness=void 0!==o.thicknessFactor?o.thicknessFactor:0,void 0!==o.thicknessTexture&&i.push(n.assignTexture(e,"thicknessMap",o.thicknessTexture)),e.attenuationDistance=o.attenuationDistance||1/0;const a=o.attenuationColor||[1,1,1];return e.attenuationColor=new HEt(a[0],a[1],a[2]),Promise.all(i)}}class rkt{constructor(t){this.parser=t,this.name=qOt.KHR_MATERIALS_IOR}getMaterialType(t){const e=this.parser.json.materials[t];return e.extensions&&e.extensions[this.name]?VCt:null}extendMaterialParams(t,e){const n=this.parser.json.materials[t];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const r=n.extensions[this.name];return e.ior=void 0!==r.ior?r.ior:1.5,Promise.resolve()}}class ikt{constructor(t){this.parser=t,this.name=qOt.KHR_MATERIALS_SPECULAR}getMaterialType(t){const e=this.parser.json.materials[t];return e.extensions&&e.extensions[this.name]?VCt:null}extendMaterialParams(t,e){const n=this.parser,r=n.json.materials[t];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const i=[],o=r.extensions[this.name];e.specularIntensity=void 0!==o.specularFactor?o.specularFactor:1,void 0!==o.specularTexture&&i.push(n.assignTexture(e,"specularIntensityMap",o.specularTexture));const a=o.specularColorFactor||[1,1,1];return e.specularColor=new HEt(a[0],a[1],a[2]),void 0!==o.specularColorTexture&&i.push(n.assignTexture(e,"specularColorMap",o.specularColorTexture,pEt)),Promise.all(i)}}class okt{constructor(t){this.parser=t,this.name=qOt.KHR_TEXTURE_BASISU}loadTexture(t){const e=this.parser,n=e.json,r=n.textures[t];if(!r.extensions||!r.extensions[this.name])return null;const i=r.extensions[this.name],o=e.options.ktx2Loader;if(!o){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return e.loadTextureImage(t,i.source,o)}}class akt{constructor(t){this.parser=t,this.name=qOt.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(t){const e=this.name,n=this.parser,r=n.json,i=r.textures[t];if(!i.extensions||!i.extensions[e])return null;const o=i.extensions[e],a=r.images[o.source];let s=n.textureLoader;if(a.uri){const t=n.options.manager.getHandler(a.uri);null!==t&&(s=t)}return this.detectSupport().then((function(i){if(i)return n.loadTextureImage(t,o.source,s);if(r.extensionsRequired&&r.extensionsRequired.indexOf(e)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(t)}))}detectSupport(){return this.isSupported||(this.isSupported=new Promise((function(t){const e=new Image;e.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",e.onload=e.onerror=function(){t(1===e.height)}}))),this.isSupported}}class skt{constructor(t){this.name=qOt.EXT_MESHOPT_COMPRESSION,this.parser=t}loadBufferView(t){const e=this.parser.json,n=e.bufferViews[t];if(n.extensions&&n.extensions[this.name]){const t=n.extensions[this.name],r=this.parser.getDependency("buffer",t.buffer),i=this.parser.options.meshoptDecoder;if(!i||!i.supported){if(e.extensionsRequired&&e.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return r.then((function(e){const n=t.byteOffset||0,r=t.byteLength||0,o=t.count,a=t.byteStride,s=new Uint8Array(e,n,r);return i.decodeGltfBufferAsync?i.decodeGltfBufferAsync(o,a,s,t.mode,t.filter).then((function(t){return t.buffer})):i.ready.then((function(){const e=new ArrayBuffer(o*a);return i.decodeGltfBuffer(new Uint8Array(e),o,a,s,t.mode,t.filter),e}))}))}return null}}class ukt{constructor(t){this.name=qOt.EXT_MESH_GPU_INSTANCING,this.parser=t}createNodeMesh(t){const e=this.parser.json,n=e.nodes[t];if(!n.extensions||!n.extensions[this.name]||void 0===n.mesh)return null;const r=e.meshes[n.mesh];for(const s of r.primitives)if(s.mode!==xkt.TRIANGLES&&s.mode!==xkt.TRIANGLE_STRIP&&s.mode!==xkt.TRIANGLE_FAN&&void 0!==s.mode)return null;const i=n.extensions[this.name].attributes,o=[],a={};for(const s in i)o.push(this.parser.getDependency("accessor",i[s]).then((t=>(a[s]=t,a[s]))));return o.length<1?null:(o.push(this.parser.createNodeMesh(t)),Promise.all(o).then((t=>{const e=t.pop(),n=e.isGroup?e.children:[e],r=t[0].count,i=[];for(const o of n){const t=new kAt,e=new tAt,n=new QEt,s=new tAt(1,1,1),u=new wCt(o.geometry,o.material,r);for(let i=0;i<r;i++)a.TRANSLATION&&e.fromBufferAttribute(a.TRANSLATION,i),a.ROTATION&&n.fromBufferAttribute(a.ROTATION,i),a.SCALE&&s.fromBufferAttribute(a.SCALE,i),u.setMatrixAt(i,t.compose(e,n,s));for(const r in a)"TRANSLATION"!==r&&"ROTATION"!==r&&"SCALE"!==r&&o.geometry.setAttribute(r,a[r]);eTt.prototype.copy.call(u,o),u.frustumCulled=!1,this.parser.assignFinalMaterial(u),i.push(u)}return e.isGroup?(e.clear(),e.add(...i),e):i[0]})))}}const ckt="glTF",lkt=1313821514,hkt=5130562;class fkt{constructor(t){this.name=qOt.KHR_BINARY_GLTF,this.content=null,this.body=null;const e=new DataView(t,0,12);if(this.header={magic:ROt.decodeText(new Uint8Array(t.slice(0,4))),version:e.getUint32(4,!0),length:e.getUint32(8,!0)},this.header.magic!==ckt)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const n=this.header.length-12,r=new DataView(t,12);let i=0;for(;i<n;){const e=r.getUint32(i,!0);i+=4;const n=r.getUint32(i,!0);if(i+=4,n===lkt){const n=new Uint8Array(t,12+i,e);this.content=ROt.decodeText(n)}else if(n===hkt){const n=12+i;this.body=t.slice(n,n+e)}i+=e}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class pkt{constructor(t,e){if(!e)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=qOt.KHR_DRACO_MESH_COMPRESSION,this.json=t,this.dracoLoader=e,this.dracoLoader.preload()}decodePrimitive(t,e){const n=this.json,r=this.dracoLoader,i=t.extensions[this.name].bufferView,o=t.extensions[this.name].attributes,a={},s={},u={};for(const c in o){const t=Mkt[c]||c.toLowerCase();a[t]=o[c]}for(const c in t.attributes){const e=Mkt[c]||c.toLowerCase();if(void 0!==o[c]){const r=n.accessors[t.attributes[c]],i=bkt[r.componentType];u[e]=i.name,s[e]=!0===r.normalized}}return e.getDependency("bufferView",i).then((function(t){return new Promise((function(e){r.decodeDracoFile(t,(function(t){for(const e in t.attributes){const n=t.attributes[e],r=s[e];void 0!==r&&(n.normalized=r)}e(t)}),a,u)}))}))}}class dkt{constructor(){this.name=qOt.KHR_TEXTURE_TRANSFORM}extendTexture(t,e){return e.texCoord,void 0===e.offset&&void 0===e.rotation&&void 0===e.scale||(t=t.clone(),void 0!==e.offset&&t.offset.fromArray(e.offset),void 0!==e.rotation&&(t.rotation=e.rotation),void 0!==e.scale&&t.repeat.fromArray(e.scale),t.needsUpdate=!0),t}}class mkt{constructor(){this.name=qOt.KHR_MESH_QUANTIZATION}}class vkt extends ZCt{constructor(t,e,n,r){super(t,e,n,r)}copySampleValue_(t){const e=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=t*r*3+r;for(let o=0;o!==r;o++)e[o]=n[i+o];return e}interpolate_(t,e,n,r){const i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=2*a,u=3*a,c=r-e,l=(n-e)/c,h=l*l,f=h*l,p=t*u,d=p-u,m=-2*f+3*h,v=f-h,g=1-m,y=v-h+l;for(let x=0;x!==a;x++){const t=o[d+x+a],e=o[d+x+s]*c,n=o[p+x+a],r=o[p+x]*c;i[x]=g*t+y*e+m*n+v*r}return i}}const gkt=new QEt;class ykt extends vkt{interpolate_(t,e,n,r){const i=super.interpolate_(t,e,n,r);return gkt.fromArray(i).normalize().toArray(i),i}}const xkt={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},bkt={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},_kt={9728:rEt,9729:iEt,9984:1004,9985:1007,9986:1005,9987:oEt},wkt={33071:eEt,33648:nEt,10497:tEt},Skt={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Mkt={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Ekt={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},Akt={CUBICSPLINE:void 0,LINEAR:sEt,STEP:aEt},Tkt="OPAQUE",Ckt="MASK",Okt="BLEND";function kkt(t){return void 0===t.DefaultMaterial&&(t.DefaultMaterial=new UCt({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:0})),t.DefaultMaterial}function Pkt(t,e,n){for(const r in n.extensions)void 0===t[r]&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[r]=n.extensions[r])}function Lkt(t,e){void 0!==e.extras&&"object"==typeof e.extras&&Object.assign(t.userData,e.extras)}function Rkt(t,e){if(t.updateMorphTargets(),void 0!==e.weights)for(let n=0,r=e.weights.length;n<r;n++)t.morphTargetInfluences[n]=e.weights[n];if(e.extras&&Array.isArray(e.extras.targetNames)){const n=e.extras.targetNames;if(t.morphTargetInfluences.length===n.length){t.morphTargetDictionary={};for(let e=0,r=n.length;e<r;e++)t.morphTargetDictionary[n[e]]=e}}}function Ikt(t){const e=t.extensions&&t.extensions[qOt.KHR_DRACO_MESH_COMPRESSION];let n;return n=e?"draco:"+e.bufferView+":"+e.indices+":"+Nkt(e.attributes):t.indices+":"+Nkt(t.attributes)+":"+t.mode,n}function Nkt(t){let e="";const n=Object.keys(t).sort();for(let r=0,i=n.length;r<i;r++)e+=n[r]+":"+t[n[r]]+";";return e}function Dkt(t){switch(t){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}const Fkt=new kAt;class jkt{constructor(t={},e={}){this.json=t,this.extensions={},this.plugins={},this.options=e,this.cache=new XOt,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let n=!1,r=!1,i=-1;"undefined"!=typeof navigator&&(n=!0===/^((?!chrome|android).)*safari/i.test(navigator.userAgent),r=navigator.userAgent.indexOf("Firefox")>-1,i=r?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),"undefined"==typeof createImageBitmap||n||r&&i<98?this.textureLoader=new gOt(this.options.manager):this.textureLoader=new IOt(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new mOt(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(t){this.extensions=t}setPlugins(t){this.plugins=t}parse(t,e){const n=this,r=this.json,i=this.extensions;this.cache.removeAll(),this._invokeAll((function(t){return t._markDefs&&t._markDefs()})),Promise.all(this._invokeAll((function(t){return t.beforeRoot&&t.beforeRoot()}))).then((function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])})).then((function(e){const o={scene:e[0][r.scene||0],scenes:e[0],animations:e[1],cameras:e[2],asset:r.asset,parser:n,userData:{}};Pkt(i,o,r),Lkt(o,r),Promise.all(n._invokeAll((function(t){return t.afterRoot&&t.afterRoot(o)}))).then((function(){t(o)}))})).catch(e)}_markDefs(){const t=this.json.nodes||[],e=this.json.skins||[],n=this.json.meshes||[];for(let r=0,i=e.length;r<i;r++){const n=e[r].joints;for(let e=0,r=n.length;e<r;e++)t[n[e]].isBone=!0}for(let r=0,i=t.length;r<i;r++){const e=t[r];void 0!==e.mesh&&(this._addNodeRef(this.meshCache,e.mesh),void 0!==e.skin&&(n[e.mesh].isSkinnedMesh=!0)),void 0!==e.camera&&this._addNodeRef(this.cameraCache,e.camera)}}_addNodeRef(t,e){void 0!==e&&(void 0===t.refs[e]&&(t.refs[e]=t.uses[e]=0),t.refs[e]++)}_getNodeRef(t,e,n){if(t.refs[e]<=1)return n;const r=n.clone(),i=(t,e)=>{const n=this.associations.get(t);null!=n&&this.associations.set(e,n);for(const[r,o]of t.children.entries())i(o,e.children[r])};return i(n,r),r.name+="_instance_"+t.uses[e]++,r}_invokeOne(t){const e=Object.values(this.plugins);e.push(this);for(let n=0;n<e.length;n++){const r=t(e[n]);if(r)return r}return null}_invokeAll(t){const e=Object.values(this.plugins);e.unshift(this);const n=[];for(let r=0;r<e.length;r++){const i=t(e[r]);i&&n.push(i)}return n}getDependency(t,e){const n=t+":"+e;let r=this.cache.get(n);if(!r){switch(t){case"scene":r=this.loadScene(e);break;case"node":r=this._invokeOne((function(t){return t.loadNode&&t.loadNode(e)}));break;case"mesh":r=this._invokeOne((function(t){return t.loadMesh&&t.loadMesh(e)}));break;case"accessor":r=this.loadAccessor(e);break;case"bufferView":r=this._invokeOne((function(t){return t.loadBufferView&&t.loadBufferView(e)}));break;case"buffer":r=this.loadBuffer(e);break;case"material":r=this._invokeOne((function(t){return t.loadMaterial&&t.loadMaterial(e)}));break;case"texture":r=this._invokeOne((function(t){return t.loadTexture&&t.loadTexture(e)}));break;case"skin":r=this.loadSkin(e);break;case"animation":r=this._invokeOne((function(t){return t.loadAnimation&&t.loadAnimation(e)}));break;case"camera":r=this.loadCamera(e);break;default:if(r=this._invokeOne((function(n){return n!=this&&n.getDependency&&n.getDependency(t,e)})),!r)throw new Error("Unknown type: "+t)}this.cache.add(n,r)}return r}getDependencies(t){let e=this.cache.get(t);if(!e){const n=this,r=this.json[t+("mesh"===t?"es":"s")]||[];e=Promise.all(r.map((function(e,r){return n.getDependency(t,r)}))),this.cache.add(t,e)}return e}loadBuffer(t){const e=this.json.buffers[t],n=this.fileLoader;if(e.type&&"arraybuffer"!==e.type)throw new Error("THREE.GLTFLoader: "+e.type+" buffer type is not supported.");if(void 0===e.uri&&0===t)return Promise.resolve(this.extensions[qOt.KHR_BINARY_GLTF].body);const r=this.options;return new Promise((function(t,i){n.load(ROt.resolveURL(e.uri,r.path),t,void 0,(function(){i(new Error('THREE.GLTFLoader: Failed to load buffer "'+e.uri+'".'))}))}))}loadBufferView(t){const e=this.json.bufferViews[t];return this.getDependency("buffer",e.buffer).then((function(t){const n=e.byteLength||0,r=e.byteOffset||0;return t.slice(r,r+n)}))}loadAccessor(t){const e=this,n=this.json,r=this.json.accessors[t];if(void 0===r.bufferView&&void 0===r.sparse){const t=Skt[r.type],e=bkt[r.componentType],n=!0===r.normalized,i=new e(r.count*t);return Promise.resolve(new yTt(i,t,n))}const i=[];return void 0!==r.bufferView?i.push(this.getDependency("bufferView",r.bufferView)):i.push(null),void 0!==r.sparse&&(i.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),i.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(i).then((function(t){const i=t[0],o=Skt[r.type],a=bkt[r.componentType],s=a.BYTES_PER_ELEMENT,u=s*o,c=r.byteOffset||0,l=void 0!==r.bufferView?n.bufferViews[r.bufferView].byteStride:void 0,h=!0===r.normalized;let f,p;if(l&&l!==u){const t=Math.floor(c/l),n="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+t+":"+r.count;let u=e.cache.get(n);u||(f=new a(i,t*l,r.count*l/s),u=new nCt(f,l/s),e.cache.add(n,u)),p=new iCt(u,o,c%l/s,h)}else f=null===i?new a(r.count*o):new a(i,c,r.count*o),p=new yTt(f,o,h);if(void 0!==r.sparse){const e=Skt.SCALAR,n=bkt[r.sparse.indices.componentType],s=r.sparse.indices.byteOffset||0,u=r.sparse.values.byteOffset||0,c=new n(t[1],s,r.sparse.count*e),l=new a(t[2],u,r.sparse.count*o);null!==i&&(p=new yTt(p.array.slice(),p.itemSize,p.normalized));for(let t=0,r=c.length;t<r;t++){const e=c[t];if(p.setX(e,l[t*o]),o>=2&&p.setY(e,l[t*o+1]),o>=3&&p.setZ(e,l[t*o+2]),o>=4&&p.setW(e,l[t*o+3]),o>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return p}))}loadTexture(t){const e=this.json,n=this.options,r=e.textures[t].source,i=e.images[r];let o=this.textureLoader;if(i.uri){const t=n.manager.getHandler(i.uri);null!==t&&(o=t)}return this.loadTextureImage(t,r,o)}loadTextureImage(t,e,n){const r=this,i=this.json,o=i.textures[t],a=i.images[e],s=(a.uri||a.bufferView)+":"+o.sampler;if(this.textureCache[s])return this.textureCache[s];const u=this.loadImageSource(e,n).then((function(e){e.flipY=!1,e.name=o.name||a.name||"";const n=(i.samplers||{})[o.sampler]||{};return e.magFilter=_kt[n.magFilter]||iEt,e.minFilter=_kt[n.minFilter]||oEt,e.wrapS=wkt[n.wrapS]||tEt,e.wrapT=wkt[n.wrapT]||tEt,r.associations.set(e,{textures:t}),e})).catch((function(){return null}));return this.textureCache[s]=u,u}loadImageSource(t,e){const n=this,r=this.json,i=this.options;if(void 0!==this.sourceCache[t])return this.sourceCache[t].then((t=>t.clone()));const o=r.images[t],a=self.URL||self.webkitURL;let s=o.uri||"",u=!1;if(void 0!==o.bufferView)s=n.getDependency("bufferView",o.bufferView).then((function(t){u=!0;const e=new Blob([t],{type:o.mimeType});return s=a.createObjectURL(e),s}));else if(void 0===o.uri)throw new Error("THREE.GLTFLoader: Image "+t+" is missing URI and bufferView");const c=Promise.resolve(s).then((function(t){return new Promise((function(n,r){let o=n;!0===e.isImageBitmapLoader&&(o=function(t){const e=new KEt(t);e.needsUpdate=!0,n(e)}),e.load(ROt.resolveURL(t,i.path),o,void 0,r)}))})).then((function(t){var e;return!0===u&&a.revokeObjectURL(s),t.userData.mimeType=o.mimeType||((e=o.uri).search(/\.jpe?g($|\?)/i)>0||0===e.search(/^data\:image\/jpeg/)?"image/jpeg":e.search(/\.webp($|\?)/i)>0||0===e.search(/^data\:image\/webp/)?"image/webp":"image/png"),t})).catch((function(t){throw t}));return this.sourceCache[t]=c,c}assignTexture(t,e,n,r){const i=this;return this.getDependency("texture",n.index).then((function(o){if(!o)return null;if(void 0!==n.texCoord&&0!=n.texCoord&&("aoMap"!==e||n.texCoord),i.extensions[qOt.KHR_TEXTURE_TRANSFORM]){const t=void 0!==n.extensions?n.extensions[qOt.KHR_TEXTURE_TRANSFORM]:void 0;if(t){const e=i.associations.get(o);o=i.extensions[qOt.KHR_TEXTURE_TRANSFORM].extendTexture(o,t),i.associations.set(o,e)}}return void 0!==r&&(o.encoding=r),t[e]=o,o}))}assignFinalMaterial(t){const e=t.geometry;let n=t.material;const r=void 0===e.attributes.tangent,i=void 0!==e.attributes.color,o=void 0===e.attributes.normal;if(t.isPoints){const t="PointsMaterial:"+n.uuid;let e=this.cache.get(t);e||(e=new ICt,dTt.prototype.copy.call(e,n),e.color.copy(n.color),e.map=n.map,e.sizeAttenuation=!1,this.cache.add(t,e)),n=e}else if(t.isLine){const t="LineBasicMaterial:"+n.uuid;let e=this.cache.get(t);e||(e=new SCt,dTt.prototype.copy.call(e,n),e.color.copy(n.color),this.cache.add(t,e)),n=e}if(r||i||o){let t="ClonedMaterial:"+n.uuid+":";r&&(t+="derivative-tangents:"),i&&(t+="vertex-colors:"),o&&(t+="flat-shading:");let e=this.cache.get(t);e||(e=n.clone(),i&&(e.vertexColors=!0),o&&(e.flatShading=!0),r&&(e.normalScale&&(e.normalScale.y*=-1),e.clearcoatNormalScale&&(e.clearcoatNormalScale.y*=-1)),this.cache.add(t,e),this.associations.set(e,this.associations.get(n))),n=e}n.aoMap&&void 0===e.attributes.uv2&&void 0!==e.attributes.uv&&e.setAttribute("uv2",e.attributes.uv),t.material=n}getMaterialType(){return UCt}loadMaterial(t){const e=this,n=this.json,r=this.extensions,i=n.materials[t];let o;const a={},s=[];if((i.extensions||{})[qOt.KHR_MATERIALS_UNLIT]){const t=r[qOt.KHR_MATERIALS_UNLIT];o=t.getMaterialType(),s.push(t.extendParams(a,i,e))}else{const n=i.pbrMetallicRoughness||{};if(a.color=new HEt(1,1,1),a.opacity=1,Array.isArray(n.baseColorFactor)){const t=n.baseColorFactor;a.color.fromArray(t),a.opacity=t[3]}void 0!==n.baseColorTexture&&s.push(e.assignTexture(a,"map",n.baseColorTexture,pEt)),a.metalness=void 0!==n.metallicFactor?n.metallicFactor:1,a.roughness=void 0!==n.roughnessFactor?n.roughnessFactor:1,void 0!==n.metallicRoughnessTexture&&(s.push(e.assignTexture(a,"metalnessMap",n.metallicRoughnessTexture)),s.push(e.assignTexture(a,"roughnessMap",n.metallicRoughnessTexture))),o=this._invokeOne((function(e){return e.getMaterialType&&e.getMaterialType(t)})),s.push(Promise.all(this._invokeAll((function(e){return e.extendMaterialParams&&e.extendMaterialParams(t,a)}))))}!0===i.doubleSided&&(a.side=2);const u=i.alphaMode||Tkt;if(u===Okt?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,u===Ckt&&(a.alphaTest=void 0!==i.alphaCutoff?i.alphaCutoff:.5)),void 0!==i.normalTexture&&o!==mTt&&(s.push(e.assignTexture(a,"normalMap",i.normalTexture)),a.normalScale=new PEt(1,1),void 0!==i.normalTexture.scale)){const t=i.normalTexture.scale;a.normalScale.set(t,t)}return void 0!==i.occlusionTexture&&o!==mTt&&(s.push(e.assignTexture(a,"aoMap",i.occlusionTexture)),void 0!==i.occlusionTexture.strength&&(a.aoMapIntensity=i.occlusionTexture.strength)),void 0!==i.emissiveFactor&&o!==mTt&&(a.emissive=(new HEt).fromArray(i.emissiveFactor)),void 0!==i.emissiveTexture&&o!==mTt&&s.push(e.assignTexture(a,"emissiveMap",i.emissiveTexture,pEt)),Promise.all(s).then((function(){const n=new o(a);return i.name&&(n.name=i.name),Lkt(n,i),e.associations.set(n,{materials:t}),i.extensions&&Pkt(r,n,i),n}))}createUniqueName(t){const e=VOt.sanitizeNodeName(t||"");let n=e;for(let r=1;this.nodeNamesUsed[n];++r)n=e+"_"+r;return this.nodeNamesUsed[n]=!0,n}loadGeometries(t){const e=this,n=this.extensions,r=this.primitiveCache;function i(t){return n[qOt.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(t,e).then((function(n){return Bkt(n,t,e)}))}const o=[];for(let a=0,s=t.length;a<s;a++){const n=t[a],s=Ikt(n),u=r[s];if(u)o.push(u.promise);else{let t;t=n.extensions&&n.extensions[qOt.KHR_DRACO_MESH_COMPRESSION]?i(n):Bkt(new OTt,n,e),r[s]={primitive:n,promise:t},o.push(t)}}return Promise.all(o)}loadMesh(t){const e=this,n=this.json,r=this.extensions,i=n.meshes[t],o=i.primitives,a=[];for(let s=0,u=o.length;s<u;s++){const t=void 0===o[s].material?kkt(this.cache):this.getDependency("material",o[s].material);a.push(t)}return a.push(e.loadGeometries(o)),Promise.all(a).then((function(n){const a=n.slice(0,n.length-1),s=n[n.length-1],u=[];for(let l=0,h=s.length;l<h;l++){const n=s[l],c=o[l];let h;const f=a[l];if(c.mode===xkt.TRIANGLES||c.mode===xkt.TRIANGLE_STRIP||c.mode===xkt.TRIANGLE_FAN||void 0===c.mode)h=!0===i.isSkinnedMesh?new lCt(n,f):new GTt(n,f),!0!==h.isSkinnedMesh||h.geometry.attributes.skinWeight.normalized||h.normalizeSkinWeights(),c.mode===xkt.TRIANGLE_STRIP?h.geometry=zkt(h.geometry,1):c.mode===xkt.TRIANGLE_FAN&&(h.geometry=zkt(h.geometry,2));else if(c.mode===xkt.LINES)h=new LCt(n,f);else if(c.mode===xkt.LINE_STRIP)h=new OCt(n,f);else if(c.mode===xkt.LINE_LOOP)h=new RCt(n,f);else{if(c.mode!==xkt.POINTS)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+c.mode);h=new BCt(n,f)}Object.keys(h.geometry.morphAttributes).length>0&&Rkt(h,i),h.name=e.createUniqueName(i.name||"mesh_"+t),Lkt(h,i),c.extensions&&Pkt(r,h,c),e.assignFinalMaterial(h),u.push(h)}for(let r=0,i=u.length;r<i;r++)e.associations.set(u[r],{meshes:t,primitives:r});if(1===u.length)return u[0];const c=new eCt;e.associations.set(c,{meshes:t});for(let t=0,e=u.length;t<e;t++)c.add(u[t]);return c}))}loadCamera(t){let e;const n=this.json.cameras[t],r=n[n.type];if(r)return"perspective"===n.type?e=new YTt(kEt.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):"orthographic"===n.type&&(e=new tCt(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),n.name&&(e.name=this.createUniqueName(n.name)),Lkt(e,n),Promise.resolve(e)}loadSkin(t){const e=this.json.skins[t],n=[];for(let r=0,i=e.joints.length;r<i;r++)n.push(this.getDependency("node",e.joints[r]));return void 0!==e.inverseBindMatrices?n.push(this.getDependency("accessor",e.inverseBindMatrices)):n.push(null),Promise.all(n).then((function(t){const e=t.pop(),n=t,r=[],i=[];for(let o=0,a=n.length;o<a;o++){const t=n[o];if(t){r.push(t);const n=new kAt;null!==e&&n.fromArray(e.array,16*o),i.push(n)}}return new mCt(r,i)}))}loadAnimation(t){const e=this.json.animations[t],n=[],r=[],i=[],o=[],a=[];for(let s=0,u=e.channels.length;s<u;s++){const t=e.channels[s],u=e.samplers[t.sampler],c=t.target,l=c.node,h=void 0!==e.parameters?e.parameters[u.input]:u.input,f=void 0!==e.parameters?e.parameters[u.output]:u.output;n.push(this.getDependency("node",l)),r.push(this.getDependency("accessor",h)),i.push(this.getDependency("accessor",f)),o.push(u),a.push(c)}return Promise.all([Promise.all(n),Promise.all(r),Promise.all(i),Promise.all(o),Promise.all(a)]).then((function(n){const r=n[0],i=n[1],o=n[2],a=n[3],s=n[4],u=[];for(let t=0,e=r.length;t<e;t++){const e=r[t],n=i[t],c=o[t],l=a[t],h=s[t];if(void 0===e)continue;let f;switch(e.updateMatrix(),Ekt[h.path]){case Ekt.weights:f=nOt;break;case Ekt.rotation:f=iOt;break;default:f=aOt}const p=e.name?e.name:e.uuid,d=void 0!==l.interpolation?Akt[l.interpolation]:sEt,m=[];Ekt[h.path]===Ekt.weights?e.traverse((function(t){t.morphTargetInfluences&&m.push(t.name?t.name:t.uuid)})):m.push(p);let v=c.array;if(c.normalized){const t=Dkt(v.constructor),e=new Float32Array(v.length);for(let n=0,r=v.length;n<r;n++)e[n]=v[n]*t;v=e}for(let t=0,r=m.length;t<r;t++){const e=new f(m[t]+"."+Ekt[h.path],n.array,v,d);"CUBICSPLINE"===l.interpolation&&(e.createInterpolant=function(t){return new(this instanceof iOt?ykt:vkt)(this.times,this.values,this.getValueSize()/3,t)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),u.push(e)}}const c=e.name?e.name:"animation_"+t;return new sOt(c,void 0,u)}))}createNodeMesh(t){const e=this.json,n=this,r=e.nodes[t];return void 0===r.mesh?null:n.getDependency("mesh",r.mesh).then((function(t){const e=n._getNodeRef(n.meshCache,r.mesh,t);return void 0!==r.weights&&e.traverse((function(t){if(t.isMesh)for(let e=0,n=r.weights.length;e<n;e++)t.morphTargetInfluences[e]=r.weights[e]})),e}))}loadNode(t){const e=this.json,n=this.extensions,r=this,i=e.nodes[t],o=i.name?r.createUniqueName(i.name):"";return function(){const e=[],n=r._invokeOne((function(e){return e.createNodeMesh&&e.createNodeMesh(t)}));n&&e.push(n),void 0!==i.camera&&e.push(r.getDependency("camera",i.camera).then((function(t){return r._getNodeRef(r.cameraCache,i.camera,t)}))),r._invokeAll((function(e){return e.createNodeAttachment&&e.createNodeAttachment(t)})).forEach((function(t){e.push(t)}));const o=[],a=i.children||[];for(let t=0,i=a.length;t<i;t++)o.push(r.getDependency("node",a[t]));const s=void 0===i.skin?Promise.resolve(null):r.getDependency("skin",i.skin);return Promise.all([Promise.all(e),Promise.all(o),s])}().then((function(e){const a=e[0],s=e[1],u=e[2];let c;if(c=!0===i.isBone?new hCt:a.length>1?new eCt:1===a.length?a[0]:new eTt,c!==a[0])for(let t=0,n=a.length;t<n;t++)c.add(a[t]);if(i.name&&(c.userData.name=i.name,c.name=o),Lkt(c,i),i.extensions&&Pkt(n,c,i),void 0!==i.matrix){const t=new kAt;t.fromArray(i.matrix),c.applyMatrix4(t)}else void 0!==i.translation&&c.position.fromArray(i.translation),void 0!==i.rotation&&c.quaternion.fromArray(i.rotation),void 0!==i.scale&&c.scale.fromArray(i.scale);r.associations.has(c)||r.associations.set(c,{}),r.associations.get(c).nodes=t,null!==u&&c.traverse((function(t){t.isSkinnedMesh&&t.bind(u,Fkt)}));for(let t=0,n=s.length;t<n;t++)c.add(s[t]);return c}))}loadScene(t){const e=this.extensions,n=this.json.scenes[t],r=this,i=new eCt;n.name&&(i.name=r.createUniqueName(n.name)),Lkt(i,n),n.extensions&&Pkt(e,i,n);const o=n.nodes||[],a=[];for(let s=0,u=o.length;s<u;s++)a.push(r.getDependency("node",o[s]));return Promise.all(a).then((function(t){for(let e=0,n=t.length;e<n;e++)i.add(t[e]);return r.associations=(t=>{const e=new Map;for(const[n,i]of r.associations)(n instanceof dTt||n instanceof KEt)&&e.set(n,i);return t.traverse((t=>{const n=r.associations.get(t);null!=n&&e.set(t,n)})),e})(i),i}))}}function Bkt(t,e,n){const r=e.attributes,i=[];function o(e,r){return n.getDependency("accessor",e).then((function(e){t.setAttribute(r,e)}))}for(const a in r){const e=Mkt[a]||a.toLowerCase();e in t.attributes||i.push(o(r[a],e))}if(void 0!==e.indices&&!t.index){const r=n.getDependency("accessor",e.indices).then((function(e){t.setIndex(e)}));i.push(r)}return Lkt(t,e),function(t,e,n){const r=e.attributes,i=new rAt;if(void 0===r.POSITION)return;{const t=n.json.accessors[r.POSITION],e=t.min,o=t.max;if(void 0===e||void 0===o)return;if(i.set(new tAt(e[0],e[1],e[2]),new tAt(o[0],o[1],o[2])),t.normalized){const e=Dkt(bkt[t.componentType]);i.min.multiplyScalar(e),i.max.multiplyScalar(e)}}const o=e.targets;if(void 0!==o){const t=new tAt,e=new tAt;for(let r=0,i=o.length;r<i;r++){const i=o[r];if(void 0!==i.POSITION){const r=n.json.accessors[i.POSITION],o=r.min,a=r.max;if(void 0!==o&&void 0!==a){if(e.setX(Math.max(Math.abs(o[0]),Math.abs(a[0]))),e.setY(Math.max(Math.abs(o[1]),Math.abs(a[1]))),e.setZ(Math.max(Math.abs(o[2]),Math.abs(a[2]))),r.normalized){const t=Dkt(bkt[r.componentType]);e.multiplyScalar(t)}t.max(e)}}}i.expandByVector(t)}t.boundingBox=i;const a=new _At;i.getCenter(a.center),a.radius=i.min.distanceTo(i.max)/2,t.boundingSphere=a}(t,e,n),Promise.all(i).then((function(){return void 0!==e.targets?function(t,e,n){let r=!1,i=!1,o=!1;for(let c=0,l=e.length;c<l;c++){const t=e[c];if(void 0!==t.POSITION&&(r=!0),void 0!==t.NORMAL&&(i=!0),void 0!==t.COLOR_0&&(o=!0),r&&i&&o)break}if(!r&&!i&&!o)return Promise.resolve(t);const a=[],s=[],u=[];for(let c=0,l=e.length;c<l;c++){const l=e[c];if(r){const e=void 0!==l.POSITION?n.getDependency("accessor",l.POSITION):t.attributes.position;a.push(e)}if(i){const e=void 0!==l.NORMAL?n.getDependency("accessor",l.NORMAL):t.attributes.normal;s.push(e)}if(o){const e=void 0!==l.COLOR_0?n.getDependency("accessor",l.COLOR_0):t.attributes.color;u.push(e)}}return Promise.all([Promise.all(a),Promise.all(s),Promise.all(u)]).then((function(e){const n=e[0],a=e[1],s=e[2];return r&&(t.morphAttributes.position=n),i&&(t.morphAttributes.normal=a),o&&(t.morphAttributes.color=s),t.morphTargetsRelative=!0,t}))}(t,e.targets,n):t}))}function zkt(t,e){let n=t.getIndex();if(null===n){const e=[],r=t.getAttribute("position");if(void 0===r)return t;for(let t=0;t<r.count;t++)e.push(t);t.setIndex(e),n=t.getIndex()}const r=n.count-2,i=[];if(2===e)for(let a=1;a<=r;a++)i.push(n.getX(0)),i.push(n.getX(a)),i.push(n.getX(a+1));else for(let a=0;a<r;a++)a%2==0?(i.push(n.getX(a)),i.push(n.getX(a+1)),i.push(n.getX(a+2))):(i.push(n.getX(a+2)),i.push(n.getX(a+1)),i.push(n.getX(a)));i.length;const o=t.clone();return o.setIndex(i),o}function Ukt(){w((()=>{function t(e){e.children&&e.children.length&&e.children.length>0?e.children.map((e=>t(e))):e.material&&(e.material.wireframe=!0,e.material.opacity=.6)}const e={lng2:111.616049,lat2:26.335053},n=[{name:"常德桃花源机场",lng:111.641101,lat:28.91165,...e},{name:"芷江机场",lng:109.709699,lat:27.442172,...e},{name:"铜仁凤凰机场",lng:109.313971,lat:27.880629,...e},{name:"桂林两江国际机场",lng:110.049256,lat:25.210065,...e},{name:"长沙黄花国际机场",lng:113.216412,lat:28.183613,...e},{name:"井冈山机场",lng:114.745845,lat:26.852646,...e}],r=new hpt({id:"map",map:new Ttt({center:[113,29],pitch:70,zoom:7.5,rotation:170,style:"blank"})});r.setBgColor("#000"),r.registerRenderService(QMt),new JMt({enableMultiPassRenderer:!1,onAddMeshes:(e,n)=>{e.add(new LOt(16777215));const r=new POt(16777215,.25);r.position.set(0,8e5,1e6),r.matrixWorldNeedsUpdate=!0,e.add(r);(new YOt).load("https://gw.alipayobjects.com/os/bmw-prod/3ca0a546-92d8-4ba0-a89c-017c218d5bea.gltf",(r=>{const i=r.scene;t(i),n.adjustMeshToMap(i),n.setMeshScale(i,2e3,2e3,2e3),n.setObjectLngLat(i,[113,29],0);const{animations:o}=r;if(o&&o.length){const t=new HOt(i),e=o[1],r=t.clipAction(e);r.timeScale=1,r.play(),n.addAnimateMixer(t)}return i.rotation.y=Math.PI,e.add(i),n.render(),""}))},zIndex:1}),r.addImage("plane","https://gw.alipayobjects.com/zos/bmw-prod/96327aa6-7fc5-4b5b-b1d8-65771e05afd8.svg"),(new yrt).source([{name:"常德桃花源机场",lng:111.641101,lat:28.91165},{name:"芷江机场",lng:109.709699,lat:27.442172},{name:"铜仁凤凰机场",lng:109.313971,lat:27.880629},{name:"永州零陵机场",lng:111.616049,lat:26.335053},{name:"桂林两江国际机场",lng:110.049256,lat:25.210065},{name:"长沙黄花国际机场",lng:113.216412,lat:28.183613},{name:"井冈山机场",lng:114.745845,lat:26.852646}],{parser:{type:"json",x:"lng",y:"lat"}}).shape("name","text").color("rgb(22,119,255)").size(10);const i=new Ant({blend:"normal"}).source(n,{parser:{type:"json",x:"lng",y:"lat",x1:"lng2",y1:"lat2"}}).shape("arc3d").size(1).color("#f00").style({sourceColor:"rgb(22,119,255)",targetColor:"rgba(242,246,250,0.1)"}),o=new Ant({blend:"normal",zIndex:1}).source(n,{parser:{type:"json",x:"lng2",y:"lat2",x1:"lng",y1:"lat"}}).shape("arc3d").texture("plane").size(30).color("#f00").animate({duration:.2,interval:.2,trailLength:.2}).style({textureBlend:"replace",lineTexture:!0,iconStep:6});fetch("https://gw.alipayobjects.com/os/bmw-prod/ec5351c9-d22b-4918-ad6c-1838064d3a64.json").then((t=>t.json())).then((t=>{const e=new Ant({}).source(t).size(1e4).shape("wall").style({opacity:.4,sourceColor:"#0DCCFF",targetColor:"rbga(255,255,255, 0)",heightfixed:!0});r.addLayer(e);const n=new yrt({zIndex:3}).source(t).color("rgb(22,119,255)").size(15).shape("name","text");r.addLayer(n)}));const a=new Image;a.crossOrigin="none",a.src="https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*UkvYRYS5jTAAAAAAAAAAAAAAARQnAQ",a.onload=function(){const t=function(t){const e=[];for(let n=0;n<t.length;n+=4)e.push(t[n]);return e}(function(t){const e=document.createElement("canvas"),n=e.getContext("2d"),{width:r,height:i}=t;return e.width=r,e.height=i,n.drawImage(t,0,0,r,i),n.getImageData(0,0,r,i)}(a).data),e=function(t){const e=Math.floor(Math.sqrt(t.length)),n=[],r=5/(e-1),i=-5/(e-1);for(let o=0;o<e;o++){const a=[];for(let n=0;n<e;n++){const s=o*e+n,u=110+r*n,c=30+i*o;a.push([u,c,t[s]])}n.push(a)}return n}(t),n=function(t){const e=Math.floor(Math.sqrt(t.length)),n=[],r=5/(e-1),i=-5/(e-1);for(let o=0;o<e;o++){const a=[];for(let n=0;n<e;n++){const s=o+n*e,u=110+r*o,c=30+i*n;a.push([u,c,t[s]])}n.push(a)}return n}(t),i={type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"MultiLineString",coordinates:e}},{type:"Feature",properties:{},geometry:{type:"MultiLineString",coordinates:n}}]},o=new Ant({}).source(i).size(1).shape("simple").color("rgb(22, 119, 255)").style({vertexHeightScale:2e3,opacity:.4});r.addLayer(o)};const s=[{lng:113,lat:29,size:1e4},{lng:113.5,lat:29.5,size:3e4},{lng:110.23681640625,lat:29.64509464986076,size:74020.50373907911},{lng:115.01586914062499,lat:26.88777988202911,size:22908.885529976185},{lng:111.181640625,lat:28.724313406473463,size:73359.37302978932},{lng:112.686767578125,lat:29.257648503615542,size:18500.90838085843},{lng:114.664306640625,lat:28.98892237190413,size:20293.183968726793},{lng:113.90075683593749,lat:28.17855984939698,size:18051.412077639496},{lng:111.51123046875,lat:27.45466493898314,size:37645.94186119526},{lng:110.67626953125,lat:28.004101830368654,size:4214.588023703825},{lng:114.43359375,lat:29.477861195816843,size:61722.01580332115},{lng:110.445556640625,lat:26.96124577052697,size:70806.75519747598},{lng:113.75244140624999,lat:27.88278388425912,size:70930.24993464859}],u=new yrt({zIndex:2,blend:"additive"}).source(s,{parser:{type:"json",x:"lng",y:"lat"}}).shape("circle").color("rgb(22, 119, 255)").size("size",(t=>t)).animate(!0).style({unit:"meter"}),c=new yrt({zIndex:2,depth:!1}).source(s,{parser:{type:"json",x:"lng",y:"lat"}}).shape("cylinder").color("rgb(22, 119, 255)").size("size",(t=>[5,5,t/350])).animate(!0).style({opacityLinear:{enable:!0,dir:"up"},lightEnable:!1});r.on("loaded",(()=>{r.addLayer(u),r.addLayer(c),r.addLayer(i),r.addLayer(o)}))}))}const Vkt=t=>(H("data-v-d67d9a79"),t=t(),Y(),t),Gkt={class:"biz-wrap"},Wkt=Vkt((()=>p("div",{class:"biz-wrap-left"},[p("div",{id:"bar"})],-1))),Hkt=Vkt((()=>p("div",{class:"biz-wrap-center"},[p("div",{id:"map"})],-1))),Ykt={class:"biz-wrap-right"},Xkt=Vkt((()=>p("div",{id:"rose"},null,-1))),qkt=Vkt((()=>p("div",null,"博客二维码",-1))),Zkt=U(a({__name:"BizWrap",setup:t=>(w((()=>{const t=new Pq({container:"bar",autoFit:!0});t.theme({type:"dark"}),t.data([{time:"10:10",call:4,waiting:2,people:2},{time:"10:15",call:2,waiting:6,people:3},{time:"10:20",call:13,waiting:2,people:5},{time:"10:25",call:9,waiting:9,people:1},{time:"10:30",call:5,waiting:2,people:3},{time:"10:35",call:8,waiting:2,people:1},{time:"10:40",call:13,waiting:1,people:2}]),t.interval().encode("x","time").encode("y","waiting").axis("y",{titleFill:"#5B8FF9",title:"Waiting"}),t.line().encode("x","time").encode("y","people").encode("shape","smooth").style("stroke","#fdae6b").style("lineWidth",2).scale("y",{independent:!0}).axis("y",{position:"right",grid:null,title:"People",titleFill:"#fdae6b"}),t.render()})),w((()=>{const t=new Pq({container:"rose",autoFit:!0});t.theme({type:"dark"}),t.coordinate({type:"polar"}),t.interval().data({value:[{Month:"Jan",Type:"Other",Death:324},{Month:"Jan",Type:"Wounds",Death:83},{Month:"Jan",Type:"Disease",Death:2761},{Month:"Feb",Type:"Other",Death:361},{Month:"Feb",Type:"Wounds",Death:42},{Month:"Feb",Type:"Disease",Death:2120},{Month:"Mar",Type:"Other",Death:172},{Month:"Mar",Type:"Wounds",Death:32},{Month:"Mar",Type:"Disease",Death:1205},{Month:"Apr",Type:"Other",Death:57},{Month:"Apr",Type:"Wounds",Death:48},{Month:"Apr",Type:"Disease",Death:477},{Month:"May",Type:"Other",Death:37},{Month:"May",Type:"Wounds",Death:49},{Month:"May",Type:"Disease",Death:508},{Month:"Jun",Type:"Other",Death:31},{Month:"Jun",Type:"Wounds",Death:209},{Month:"Jun",Type:"Disease",Death:802},{Month:"Jul",Type:"Other",Death:33},{Month:"Jul",Type:"Wounds",Death:134},{Month:"Jul",Type:"Disease",Death:382},{Month:"Aug",Type:"Other",Death:25},{Month:"Aug",Type:"Wounds",Death:164},{Month:"Aug",Type:"Disease",Death:483},{Month:"Sep",Type:"Other",Death:20},{Month:"Sep",Type:"Wounds",Death:276},{Month:"Sep",Type:"Disease",Death:189},{Month:"Oct",Type:"Other",Death:18},{Month:"Oct",Type:"Wounds",Death:53},{Month:"Oct",Type:"Disease",Death:128},{Month:"Nov",Type:"Other",Death:32},{Month:"Nov",Type:"Wounds",Death:33},{Month:"Nov",Type:"Disease",Death:178},{Month:"Dec",Type:"Other",Death:28},{Month:"Dec",Type:"Wounds",Death:18},{Month:"Dec",Type:"Disease",Death:91}]}).transform({type:"stackY"}).transform({type:"stackEnter",groupBy:["color","x"],duration:2e3}).encode("x","Month").encode("y","Death").encode("color","Type").scale("y",{type:"sqrt"}).animate("enterType","waveIn").axis("y",!1),t.render()})),Ukt(),(t,e)=>{const n=zi;return s(),u("div",Gkt,[Wkt,Hkt,p("div",Ykt,[Xkt,qkt,l(n,{src:"https://quliangen.github.io/blog/"})])])})}),[["__scopeId","data-v-d67d9a79"]]),$kt=(t=>(H("data-v-ef8fb788"),t=t(),Y(),t))((()=>p("div",{class:"title"},"宽度自适应大屏-曲董",-1))),Kkt=U(a({name:"HomePage",setup:t=>(t,e)=>{const n=cr;return s(),S(n,null,{default:h((()=>[$kt,l(Zkt,{class:"content"})])),_:1})}}),[["__scopeId","data-v-ef8fb788"]]);export{Kkt as default};
